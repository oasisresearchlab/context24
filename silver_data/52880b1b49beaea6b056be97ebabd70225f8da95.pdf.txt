a r X i v : c ond - m a t / 0302375v5 [ c ond - m a t . s t a t - m ec h ] 26 A ug 2003 Subgraphs in random networks S . Itzkovitz 1 , 2 , R . Milo 1 , 2 , N . Kashtan 2 , 3 , G . Ziv 1 , U . Alon 1 , 2 1 Department of Physics of Complex Systems , Weizmann Institute of Science , Rehovot , Israel 76100 2 Department of Molecular Cell Biology , Weizmann Institute of Science , Rehovot , Israel 76100 3 Department of Computer Science and Applied Mathematics , Weizmann Institute of Science , Rehovot , Israel 76100 Understanding the subgraph distribution in random networks is important for modelling complex systems . In classic Erd˝os networks , which exhibit a Poissonian degree distribution , the number of appearances of a subgraph G with n nodes and g edges scales with network size as h G i ∼ N n − g . However , many natural networks have a non - Poissonian degree distribution . Here we present approximate equations for the average number of subgraphs in an ensemble of random sparse directed networks , characterized by an arbitrary degree sequence . We ﬁnd new scaling rules for the commonly occurring case of directed scale - free networks , in which the outgoing degree distribution scales as P ( k ) ∼ k − γ . Considering the power exponent of the degree distribution , γ , as a control parameter , we show that random networks exhibit transitions between three regimes . In each regime the subgraph number of appearances follows a diﬀerent scaling law , h G i ∼ N α , where α = n − g + s − 1 for γ < 2 , α = n − g + s + 1 − γ for 2 < γ < γ c , and α = n − g for γ > γ c , s is the maximal outdegree in the subgraph , and γ c = s + 1 . We ﬁnd that certain subgraphs appear much more frequently than in Erd˝os networks . These results are in very good agreement with numerical simulations . This has implications for detecting network motifs , subgraphs that occur in natural networks signiﬁcantly more than in their randomized counterparts . PACS numbers : 05 , 89 . 75 I . INTRODUCTION Many natural systems are described as networks of in - teracting components ( [ 1 ] - [ 9 ] ) . Random networks have been studied as models of these complex systems . The classic model for a random network is the Erd˝os model ( [ 10 ] - [ 13 ] ) , in which each of the possible edges in the net - work exists with probability p . There exists an analyti - cal solution to many of the properties of Erd˝os networks , such as the diameter , clustering coeﬃcient , component size distributions , and subgraph distributions ( [ 10 ] - [ 13 ] ) . The average number of appearances G of a subgraph with n nodes and g edges in a directed network of N nodes is h G i = λ (cid:18) N n (cid:19) p g ( 1 − p ) n ( n − 1 ) − g ∼ λN n (cid:18) h K i N (cid:19) g h G i∼ N n − g ( 1 ) assuming a ﬁxed mean connectivity h K i = pN . λ is a term of order 1 which stems from the symmetry of each subgraph . Erd˝os networks have been extensively used as models for analyzing real networks . An excellent example is the work of Davis , Holland and Leinhardt on subgraphs in social networks ( [ 14 ] - [ 17 ] ) . Erd˝os networks exhibit a Poissonian degree distribu - tion : the distribution of the number of edges per node is P ( k ) = h k i k e −h k i / k ! . Nodes with a number of edges much higher than the mean are exponentially rare . Many naturally occurring networks , on the other hand , obey a long - tailed degree sequence , often described as a power law , P ( k ) ∼ k − γ , with γ often between 2 and 3 ( [ 18 ] - [ 29 ] ) . These networks , termed scale - free networks , are characterized by the existence of nodes with high de - ( a ) ( b ) FIG . 1 : Example of ( a ) Erd¨os network and ( b ) Scale - free network ( γ = 2 ) . Mean connectivity is 1 . 85 in both . Notice the hub in the scale - free network . gree , termed hubs ( Fig1 ) . The existence of hubs dramat - ically inﬂuences the properties of these networks . Some of the global properties of random networks with arbi - trary degree distribution , and speciﬁcally scale - free net - works , have been calculated . These include sizes of con - nected components ( [ 3 ] , [ 30 ] , [ 31 ] ) , distances ( [ 34 ] ) , per - colation thresholds ( [ 35 ] - [ 37 ] ) and clustering coeﬃcients ( [ 38 ] , [ 41 ] , [ 42 ] ) . There is much current interest in the local structure of networks ( [ 5 ] , [ 7 ] - [ 9 ] , [ 38 ] - [ 40 ] , [ 43 ] - [ 49 ] ) . Recently sub - graph structure was analyzed in biological and techno - logical networks ( [ 7 ] , [ 8 ] ) . It was found that these natural or designed networks contain network motifs , subgraphs that occur much more often than in an ensemble of ran - domized networks with the same degree sequence . In biological networks , the network motifs were suggested to be elementary building blocks which carry out key 2 information processing functions ( [ 7 ] , [ 8 ] ) . In these stud - ies , random networks generation and the enumeration of their subgraphs were performed numerically . To comple - ment this numerical work , it would be important to the - oretically characterize the subgraph distribution of ran - dom networks . Here we present approximate formulas for the average number of subgraphs in an ensemble of random networks with an arbitrary degree sequence . In the random ensemble each node has a speciﬁed indegree , outdegree , and mutual degree . These formulas give a very good approximation for random networks which al - low for multiple edges between nodes ( more than one edge in a given direction ) , as in the well - studied conﬁg - uration model ( [ 13 ] , [ 31 ] - [ 34 ] ) . We also show that they provide a reasonable approximation for networks where multiple edges are not allowed , which represent more re - alistically many naturally occurring networks . We apply these formulas to arrive at new scaling laws for networks with a scale - free degree distribution . We ﬁnd that each subgraph has its own scaling exponent , inﬂuenced by its topology . Considering the power exponent of the degree distribution , γ , as a control parameter , we show that the random networks exhibit transitions between 3 regimes . In each regime the subgraph number of appearances fol - lows a diﬀerent scaling law . We ﬁnd that certain sub - graphs appear much more frequently than in Erd˝os net - works . II . NUMBER OF SUBGRAPHS , APPROXIMATE SOLUTION The following approximation assumes sparse networks ( h K i≪ N ) . The network degree sequence is given by the outdegree { K i } Ni = 1 ( the number of edges outgoing from each node ) , indegree { R i } Ni = 1 ( the number of incoming edges at each node ) , and mutual degree { M i } Ni = 1 ( the number of mutual edges at each node ) . Mutual edges are cases where there is a pair of edges in both directions between two nodes . This property has been studied in so - cial networks ( [ 14 ] - [ 17 ] ) and in the world wide web ( [ 39 ] ) . We begin by computing the probability of obtaining an n - node subgraph with g a single edges , g m mutual edges , subgraph outdegree sequence { k j } nj = 1 , subgraph indegree sequence { r j } nj = 1 and subgraph mutual degree sequence { m j } nj = 1 in a given set of nodes . Consider the example of ( Fig 2 ) . The probability of obtaining a directed edge from node 1 to node 2 is approximately P ( edge 1 ) = K 1 R 2 N h K i ( 2 ) assuming K 1 R 2 ≪ N h K i ( see Appendix A ) . The proba - bility of obtaining a second edge from node 1 to node 3 is : P ( edge 2 | edge 1 ) = ( K 1 − 1 ) R 3 N h K i ( 3 ) node 1 k 1 = 2 , r 1 = 0 , m 1 = 1 K 1 , R 1 , M 1 node 2 k 2 = 1 , r 2 = 1 , m 2 = 0 K 2 , R 2 M 2 K 1 R 2 / N < K > K 2 R 4 / N < K > K 3 ( R 4 - 1 ) / N < K > node 3 k 3 = 1 , r 3 = 1 , m 3 = 0 K 3 , R 3 , M 3 node 4 k 4 = 0 , r 4 = 2 , m 4 = 1 K 4 , R 4 , M 4 ( K 1 - 1 ) R 3 / N < K > e d g e 2 edge1 M 1 M 4 / N < M > n = 4 g a = 4 g m = 1 a 0 = 2 FIG . 2 : A subgraph with one mutual edge and 4 single edges . The subgraph degree sequences { k i , r i , m i } and node degrees { K i , R i , M i } are displayed in bold . Edge probabilities are displayed in plain . Using Eq . ( 5 ) , the mean subgraph number of appearances in an ensemble of random networks is h G i = 2 h K ( K − 1 ) M i h R ( R − 1 ) M i h RK i 2 / N h K i 4 h M i This reasoning applies to all the subgraph edges . The mean number of appearances of a subgraph is found by taking the average of the resulting expression with re - spect to all choices of n distinct nodes { σ 1 . . . σ n } , and multiplying by the number of possible choices of n nodes out of N : h G i = aN n − g a − g m h K i g a h M i g m * n Y j = 1 (cid:18) K σ j k j (cid:19)(cid:18) R σ j r j (cid:19)(cid:18) M σ j m j (cid:19) + { σ } ( 4 ) Where h K i is the average outdegree ( equals the aver - age indegree h R i ) , and h M i is the average mutual edge degree . The symmetry factor a is a − 1 0 Q nj = 1 k j ! r j ! m j ! , where a 0 is the number of diﬀerent permutations of the nodes that give an isomorphic subgraph . The average ( 4 ) reduces to a product of moments of diﬀerent orders of the indegree , outdegree and mutual degree distributions : h G i = aN n − g a − g m h K i g a h M i g m n Y j = 1 (cid:28)(cid:18) K i k j (cid:19)(cid:18) R i r j (cid:19)(cid:18) M i m j (cid:19)(cid:29) i ( 5 ) where the fact that each node should participate in the summation of only one term j introduces higher order corrections which we neglect . For example , subgraph id102 ( Table I ) , has n = 3 nodes , g a = 2 single edges and g m = 1 mutual edge . The subgraph degree sequences are k j = { 1 , 1 , 0 } , r j = { 0 , 1 , 1 } , and m j = { 1 , 0 , 1 } . Using 3 subgraph id equation transcription neurons www 6 * N h K ( K − 1 ) i / 2 1 . 2 × 10 4 ( − 0 . 16 % / − 0 . 02 % ) 4 . 3 × 10 2 ( + 2 % / + 8 % ) 4 . 7 × 10 7 ( + 0 . 06 % / + 0 . 5 % ) 12 * N h KR i 3 . 6 × 10 2 ( + 0 . 16 % / − 0 . 1 % ) 8 . 7 × 10 2 ( + 2 . 7 % / + 3 . 0 % ) 2 . 5 × 10 6 ( + 9 % / + 10 % ) 14 * N h KM i 1 . 9 × 10 1 ( − 0 . 06 % / − 0 . 06 % ) 8 . 7 × 10 1 ( − 0 . 15 % / + 1 . 9 % ) 3 . 8 × 10 6 ( − 0 . 2 % / − 0 . 3 % ) 36 * N h R ( R − 1 ) i / 2 9 . 6 × 10 2 ( − 2 % / − 0 . 03 % ) 6 . 0 × 10 3 ( − 0 . 4 % / + 0 . 7 % ) 2 . 2 × 10 8 ( + 0 . 01 % / + 0 . 1 % ) 38 h K ( K − 1 ) ih RK ih R ( R − 1 ) i / h K i 3 1 . 3 × 10 1 ( + 1 . 6 % / + 2 . 1 % ) 1 . 2 × 10 2 ( + 0 . 6 % / − 28 % ) 3 . 4 × 10 5 ( + 0 . 7 % / − 74 % ) 46 h KM i 2 h R ( R − 1 ) i / 2 h K i 2 h M i 0 ( 0 % / 0 % ) 9 . 3 ( − 10 % / − 57 % ) 8 . 5 × 10 3 ( − 0 . 02 % / + 8 . 8 % ) 74 * N h RM i 2 . 9 ( − 1 . 2 % / − 1 . 8 % ) 1 . 3 × 10 2 ( + 1 . 1 % / + 1 . 2 % ) 4 . 8 × 10 6 ( − 0 . 01 % / − 0 . 01 % ) 78 * N h M ( M − 1 ) i / 2 0 ( 0 % / 0 % ) 6 . 6 ( − 0 . 2 % / − 0 . 5 % ) 2 . 5 × 10 7 ( − 0 . 4 % / − 0 . 4 % ) 98 h KR i 3 / 3 h K i 3 0 ( 0 % / 0 % ) 4 . 5 ( − 40 % / − 39 % ) 3 . 3 × 10 1 ( − 31 % / − 26 % ) 102 h KM i h RM i h RK i / h K i 2 h M i 0 ( 0 % / 0 % ) 2 ( − 22 % / − 15 % ) 1 . 4 × 10 2 ( − 11 % / − 4 % ) 108 h RM i 2 h K ( K − 1 ) i / 2 h K i 2 h M i 0 ( 0 % / 0 % ) 1 . 4 ( − 18 % / − 6 % ) 2 . 9 × 10 3 ( − 11 % / − 44 % ) 110 h KM ih RM ih M ( M − 1 ) i / h K ih M i 2 0 ( 0 % / 0 % ) 0 ( 0 % / 0 % ) 2 . 3 × 10 3 ( − 1 . 8 % / − 4 % ) 238 h M ( M − 1 ) i 3 / 6 h M i 3 0 ( 0 % / 0 % ) 0 ( 0 % / 0 % ) 5 × 10 4 ( − 0 . 04 % / − 3 . 6 % ) TABLE I : Mean numbers of the thirteen connected directed subgraphs in an ensemble of random networks with a given degree distribution3 . The degree distributions are those of transcription in the yeast S . cerevisiae ( [ 8 ] ) , synaptic connections between neurons in C . elegans ( [ 51 ] ) , and world - wide - web hyperlinks between web pages in a single domain ( [ 18 ] ) . Shown are the theoretical values ( Eq . 5 ) . The values in parentheses are the percent deviations of the direct enumeration results - using the algorithms described in [ 8 ] , where 1000 random networks with the same degree distributions as those of the real networks were generated and all subgraphs were counted . The left value is the percent deviation in an ensemble which allows for multiple edges , and the right value shows the deviation for an ensemble which does not allow multiple edges . Values below 0 . 5 were rounded to zero . In subgraphs marked with * , the theoretical values shown were obtained using the correction of Appendix B to the table equations . Subgraph id is determined by concatenating the rows of the subgraph adjacency matrix and representing the resulting vector as a binary number . The id is the minimal number obtained from all the isomorphic versions of the subgraph . ( 5 ) we ﬁnd : h G i = h id 102 i = h KM i h RM i h RK i h K i 2 h M i ( 6 ) The approximation ( Eq . 5 ) is exact in the case of Erd˝os networks . In Erd˝os networks , both indegree and outde - gree are Poisson distributed and independent , and Eq . ( 5 ) reduces to Eq . ( 1 ) . For non - sparse networks , a more accurate approximation takes into account the probabilities of a non - existent edge between two nodes ( see Appendix B ) . We tested the equations on random networks taken with the degree sequence of real world networks - transcrip - tion interactions in the yeast S . cerevisiae ( [ 8 ] ) , synap - tic connections between neurons in C . elegans ( [ 51 ] ) and world - wide - web hyperlinks between web pages in a sin - gle domain ( [ 18 ] ) . When multiple edges in the same di - rection are allowed , as in the conﬁguration model , the equations ( 5 ) are within a few percent of the numeri - cal simulation results ( Table I ) . We have also simulated random networks in which only one edge was allowed in each direction between any two nodes . As can be seen in Table I , the equations ( 5 ) are still within a few percent of the numerical simulation results for most subgraphs . There are some discrepancies ( most notably a factor of almost 4 for subgraph id38 in the randomized world wide web network ) . In addition , we ﬁnd good agreement be - tween our approximation and numerical enumeration of subgraphs in simulated random networks with scale - free outdegree ( Fig . 3 ) . III . SCALE - FREE NETWORKS Scale - free networks have degree distributions that fol - low P ( k ) ∼ k − γ at large k ( [ 18 ] - [ 29 ] ) . We consider di - 4 10 0 10 2 10 4 10 0 10 1 10 2 10 3 10 4 10 0 10 2 10 4 10 0 10 1 10 2 10 3 10 4 subgraph numbers direct enumeration s ubg r aph nu m be r s − t heo r y s ubg r aph nu m be r s − t heo r y subgraph numbers direct enumeration FIG . 3 : Subgraph numbers in 1000 random networks with N = 2000 nodes , with scale - free outdegree and compact inde - gree . The outdegree of each node , K i was picked from the distribution ( 7 ) , with γ = 2 . The networks were constructed using the algorithm of Newman , Strogatz and Watts [ 3 ] mod - iﬁed so that only a single edge in a given direction is allowed between any two nodes . Theoretical number of appearance were computed using the degree sequences of each network ( equations in Table I ) . rected networks in which the outgoing edge degree is scale - free , while the incoming edge degree distribution is Poissonian . Our results can be easily extended to scale - free indegree . For simplicity we choose the following form for the outgoing degree distribution for a network with N nodes ( this function was used in [ 3 ] to ﬁt world - wide web data ) : P ( k ) = γ − 1 k 1 − γ 0 ( k + k 0 ) − γ k < N ( 7 ) The mean connectivity h K i is determined by k 0 . The hub is the node with the maximal number of out - going edges , T . The hub size distribution ( Fig . 4 ) is : P ( T ) = NP ( k = T ) [ P ( k ≤ T ) ] N − 1 = N ( γ − 1 ) k 0 ( T / k 0 ) − γ (cid:16) 1 − ( T / k 0 ) − γ + 1 (cid:17) N − 1 ( 8 ) assuming T ≫ k 0 . For 2 < γ < 3 , the mean hub scales as : h T i = Z N − 1 1 T P ( T ) dT ∼ N 1 γ − 1 ( 9 ) where the mean is over an ensemble of random networks with the same γ and mean connectivity ( see also [ 28 ] , [ 36 ] for an alternative method of deriving this result ) . At γ ≤ 2 , there is a condensation eﬀect [ 50 ] , where a ﬁnite fraction of the nodes have outdegree ≤ 1 , and the mean hub size becomes proportional to N . Using ( 5 ) , and as - suming a compact distribution for the number of mutual edges , we ﬁnd that the subgraph distribution is domi - nated by the hubs , and that the dominant term is that 0 50 100 150 200 250 300 0 0 . 005 0 . 01 0 . 015 0 . 02 0 . 025 0 . 03 hub size p r obab ili t y den s i t y γ = 2 . 2 γ = 2 . 8 FIG . 4 : Simulated and theoretical hub distribution for net - works with N = 3000 nodes , γ = 2 . 2 ( O ) or γ = 2 . 8 ( (cid:3) ) , and mean connectivity h K i = 1 . 2 . Lines : theoretical calculations , Eq . ( 8 ) . of the subgraph node with maximal outdegree , s . The number of appearances of each subgraph can be shown to scale as : h G i ∼ aN n − g − 1 h K i g − s N X i = 1 (cid:18) K i s (cid:19) ∼ N α ( 10 ) where g = g a + 2 g m is the total number of edges in the subgraph [ 53 ] . We derive the scaling exponent α in the following section . IV . TRANSITIONS AT DIFFERENT γ The subgraph numbers scale as h G i ∼ N α ( 11 ) We ﬁnd three diﬀerent regimes , in each of which the scal - ing exponent α behaves diﬀerently . Taking an ensemble average by integrating the largest term in Eq . ( 10 ) over the hub distribution ( 8 ) we get : h G i ∼ N n − g − 1 Z N − 1 1 T s P ( T ) dT ( 12 ) For γ ≤ 2 the network is in a condensed regime , where the hub T = O ( N ) . In this regime : h G i ∼ N n − g + s − 1 ( 13 ) 5 subgraph id n g s α erdos α sf α cond γ c nodes edges γ > γ c 2 < γ < γ c γ ≤ 2 6 3 2 2 1 4 − γ 2 3 12 3 2 1 1 1 1 2 14 3 3 2 0 3 − γ 1 3 36 3 2 1 1 1 1 2 38 3 3 2 0 3 − γ 1 3 46 3 4 2 - 1 2 − γ 0 3 74 3 3 1 0 0 0 2 78 3 4 2 - 1 2 − γ 0 3 98 3 3 1 0 0 0 2 102 3 4 2 - 1 2 − γ 0 3 108 3 4 2 - 1 2 − γ 0 3 110 3 5 2 - 2 1 − γ - 1 3 238 3 6 2 - 3 − γ - 2 3 subgraph id n g s α erdos α sf α cond γ c nodes edges γ > γ c 2 < γ < γ c γ ≤ 2 14 4 3 3 1 5 − γ 3 4 204 4 4 2 0 3 − γ 1 3 206 4 5 3 - 1 3 − γ 1 4 2190 4 5 3 - 1 3 − γ 1 4 TABLE II : the scaling exponent α of subgraph numbers for random scale - free networks with outgoing degree exponent γ . The subgraph numbers scale as h G i ∼ N α . Shown are all thir - teen 3 - node connected directed subgraphs and 4 examples of 4 node subgraphs . n is the number of nodes in the subgraph , g , the number of edges and s , the maximal degree within the subgraph . The exponent α has 3 regimes : α erdos in the ”Erd˝os regime” , when γ > γ c , α sf in the ”scale - free regime” , when 2 < γ < γ c , and α cond in the ”condensed regime” , when γ ≤ 2 . For 2 < γ < γ c substituting Eq . 8 in Eq . 12 yields : h G i ∼ N n − g + s − γ + 1 ( 14 ) In this regime , the tail of P ( T ) is the dominant contri - bution to the integral . Finally at values above a critical γ , another transition occurs , where α equals the scaling exponent in Erd˝os networks , α = n − g = α erdos . The 1 1 . 5 2 2 . 5 3 3 . 5 4 4 . 5 −0 . 5 0 0 . 5 1 1 . 5 2 2 . 5 α γ α cond α sf erdos α ( a ) 1 2 3 4 5 6 −2 −1 0 1 2 3 4 α α α γ cond sf erdos α ( b ) FIG . 5 : Scaling exponent of 3 - node subgraphs ( a ) and 4 - node subgraphs ( b ) as a function of γ . The exponent α was obtained from the slope of a log - log ﬁt of the num - ber of subgraphs vs . network size , for 9 diﬀerent net - work sizes ( 30 , 100 , 300 , 500 , 1000 , 1500 , 2000 , 2500 , 3000 ) aver - aged over 5000 randomized networks for each size and out - degree powerlaw γ . All the networks had mean connectivity h K i = 1 . 2 . The exponent α displays three regimes , γ < 2 ( the condensed regime ) , 2 < γ < γ c ( the scale - free regime ) , γ > γ c ( Erd˝os regime ) . critical γ is γ c : γ c = s + 1 ( 15 ) In this regime , the hubs no longer contribute signiﬁcantly to the subgraph distribution . In summary , h G i ∼ N α , where α is : α =   n − g + s − 1 γ ≤ 2 n − g + s − γ + 1 2 < γ < s + 1 n − g γ ≥ s + 1 ( 16 ) 6 Table II shows the expected scaling exponent for the 13 connected directed 3 - node subgraphs , as well as for sev - eral 4 - node subgraphs . The scaling laws agree very well with numerical results ( Fig . 5 ) . The three regimes of scaling are clearly seen . Note that the topology of each subgraph eﬀects its scaling , through the subgraph maxi - mal outdegree , s . These results can be easily extended to the case of scale - free indegree and non - directed networks . For loops of any size in non - directed networks the crit - ical γ is γ c = 3 . At γ > 3 , loop numbers scale as N 0 . This is consistent with [ 47 ] , which showed logarithmic corrections for the number of loops in Barabasi - Albert scale - free networks , which have γ = 3 . V . DISCUSSION To summarize , we have presented an approximate so - lution for the average number of directed connected sub - graphs in an ensemble of random networks with arbitrary degree sequence . We have presented scaling formulas for the number of subgraphs in scale - free random networks , and showed that the subgraph numbers can be very dif - ferent from those in Erd˝os random networks . Whereas in Erd˝os random networks the scaling exponent is strictly determined by the number of nodes and edges of the sub - graph , in scale - free random networks , the exact topology of the subgraph determines the scaling exponent . We showed that the scaling exponent α exhibits three dif - ferent scaling laws in three regimes , depending on the control parameter γ ( the power of the degree distribu - tion ) . In the common case of scale - free networks with γ between 2 and 3 , there are many more subgraphs which contain a node connected to more than one other node than in the corresponding Erd˝os networks with the same mean connectivity . For example , the feed - forward loop , ( id38 in Table I ) is much more common for γ < 3 . At γ = 2 . 5 , the number of feed - forward - loops scales as N 0 . 5 , as opposed to N 0 in Erd˝os networks . On the other hand , subgraphs such as the 3 - node cycle ( id98 in Table I ) have the same scaling , N 0 , as in Erd˝os networks . This study adds to our understanding of the random network models to which real - world networks are com - pared . It highlights the importance of using random networks that preserve the single and mutual degree se - quence of the real network . Our approach may be read - ily extended to networks with multiple colors of edges . The present results may be useful for enumerating sub - graphs in very large random networks which are beyond the reach of current numerical algorithms . APPENDIX A : EDGE PROBABILITIES Here we give a more detailed derivation for the edge probabilities used in Eq . ( 2 , 3 ) . Without loss of generality we treat a network with no mutual edges . We denote by E = N h K i the total number of edges . We begin by calculating the probability that no edge connects a source node with K outgoing edges and a target node with R incoming edges . This happens when all K edges connect to a set of nodes { σ i } ki = 1 which does not contain the target node : p ( no edge | { σ i } ) = K − 1 Y k = 0 1 − R E − R ′ − P ki = 1 R σ i ! ( A1 ) where R ′ is the indegree of the source node ( we do not allow self edges ) . The probability of having no edge is obtained by summing over all possible sets { σ i } ki = 1 : p ( no edge ) = 1 K ! (cid:0) N − 2 K (cid:1) X { σ } K − 1 Y k = 0 1 − R E − R ′ − P ki = 1 R σ i ! ( A2 ) Assuming max P ki = 1 R σ i ≪ E , and taking the comple - ment as the probability of an edge existing , we obtain : p ( edge ) = 1 − ( 1 − R N h K i ) K = 1 − e − KR / N h K i ∼ KR N h K i ( A3 ) where our last approximation assumes KR ≪ N h K i . In - tuitively , this result can be understood as K attempts for the source node to connect to the target node with a probability of R / N h K i at each attempt . R / N h K i is the probability of an arbitrary edge connecting into the target node . Pairs of nodes in which KR is of the order of N h K i will contribute multiple edges in the same di - rection in the approximation , leading to over - estimation of subgraph numbers in the simulated networks where multiple edges are not allowed ( Table I ) . APPENDIX B : NON - SPARSE NETWORKS In calculating the number of appearances of subgraphs in non - sparse networks , a more accurate approximation takes into account the probabilities of a non - existent edge between two nodes . For such subgraphs , in addition to the speciﬁed subgraph , Eq . ( 5 ) counts a set of subgraphs , with the null edges replaced by single or mutual edges . The corrections for the 3 - node subgraphs are : h id 6 ∗i = h id 6 i − h id 38 i − h id 108 i h id 12 ∗i = h id 12 i − h id 38 i − h id 102 i h id 14 ∗i = h id 14 i − h id 46 i − h id 102 i − h id 110 i h id 36 ∗i = h id 36 i − h id 38 i − h id 46 i h id 74 ∗i = h id 74 i − h id 102 i − h id 108 i − h id 110 i h id 78 ∗i = h id 78 i − h id 110 i − h id 238 i ( B1 ) 7 subgraph id formula 6 ( P A ′ A · f M · f M ′ − trA ′ A ) / 2 12 P A 2 · f M · f M ′ 14 P SA · f M · f M ′ 36 ( P AA ′ · f M · f M ′ − trAA ′ ) / 2 38 P A 2 · A 46 ( P AA ′ · S ) / 2 74 P SA ′ · f M · f M ′ 78 ( P S 2 · f M · f M ′ − trS 2 ) / 2 98 ( P A ′ 2 · A ) / 3 102 P A 2 · S 108 ( P A ′ A · S ) / 2 110 P S 2 · A 238 ( P S 2 · S ) / 6 TABLE III : Matrix formulas for the numbers of all 3 - node connected directed subgraphs . M is the adjacency matrix , S is its symmetric component , and A its asymmetric compo - nent . A ′ is the transposed matrix , e A is the logical inverse of matrix A , trA is the matrix trace . where h G i represents the values obtained from Eq . ( 5 ) , and h G ∗i is the corrected value . Generally , for larger subgraphs the corrections made will be of an inclusion - exclusion type . APPENDIX C : SUBGRAPH ENUMERATION In numerically enumerating the subgraphs we combine a dynamic programming method ( [ 8 ] ) , which is applied generally for n - node subgraphs with n ≥ 4 , and a more rapid calculation , based on adjacency matrix operations , used for 3 - node subgraphs . The method generalizes the results of ( [ 52 ] ) . Here we give formulas for the thirteen 3 - node connected directed subgraphs based on the adja - cency matrix . The network adjacency matrix is denoted by M , where M ij = 1 if a directed edge exists from node i to node j . We begin by dividing the network into a net - work containing only antisymmetric arrows , whose adja - cency matrix will be denoted by A , and a network con - taining only mutual arrows , whose symmetric adjacency matrix will be denoted as S . M = A + S ( C1 ) We denote by AB the matrix multiplication of matrices A and B , and by A · B the dot multiplication . e A is the logical inverse of matrix A , where the 0 elements of A are the 1 of e A and vice - versa . A ′ is the transpose matrix of A . A summation denotes summation of all the matrix indices . The matrix formulas for the 13 directed connected 3 - node subgraphs are given in Table III . For example id38 has two nodes which are connected by a path of 2 edges and a path of one edge . A 2 ij is the number of length 2 paths between node i and node j . Dot - multiplication with matrix A and summation of the terms of the resultant matrix gives the correct count . In some of the subgraphs a correction is made for the terms on the diagonal ( id6 , id36 , id78 ) . ACKNOWLEDGMENTS We thank S . Maslov , R . Cohen , A . Mayo , A . Natan , M . Itzkovitz and all members of our lab for valuable discus - sions . We acknowledge support from the Israel Science Foundation , the Human Frontier Science Program , and the Minerva Foundation . [ 1 ] S . H . Strogatz , ”Exploring complex networks” , Nature 410 , 268 - 76 . ( 2001 ) . [ 2 ] R . Albert & A . L . Barabasi , ”Statistical mechanics of complex networks” , Reviews of Modern Physics 74 , 47 ( 2002 ) . [ 3 ] M . Newman , S . Strogatz & D . Watts , ”Random graphs with arbitrary degree distribution and their applica - tions” , Phys Rev E 64 , 6118 - 6123 ( 2001 ) . [ 4 ] S . N . Dorogovtsev , J . F . F Mendes & A . N . Samukhin , ”Principles of Statistical Mechanics of Random Net - works” , cond - mat / 0204111 . [ 5 ] D . Watts , S . Strogatz , ”Collective dynamics of ’small - world’ networks” , Nature 393 , 440 - 442 ( 1998 ) . [ 6 ] L . Amaral , A . Scala , M . Barthelemy , H . Stanley , ”Classes of small world networks” , Proc . Natl . Acad . Sci . U . S . A . 97 , 11149 - 11152 ( 2000 ) . [ 7 ] S . Shen - Orr , R . Milo , S . Mangan & U . Alon , ”Network motifs in the transcriptional regulation network of Es - cherichia coli” , Nature Genetics , 31 : 64 - 68 ( 2002 ) . [ 8 ] R . Milo , S . Shen - Orr , S . Itzkovitz , N . Kashtan . , D . Chklovskii & U . Alon , ”Network Motifs : Simple Build - ing Blocks of Complex Networks” , Science 298 , 824 - 827 ( 2002 ) . [ 9 ] S . Maslov , K . Sneppen , ”Speciﬁcity and Stability in Topology of Protein Networks” , Science 296 , 910 - 3 ( May 3 , 2002 ) [ 10 ] P . Erd˝os & A . R´enyi , ”On random graphs” , Publicationes Mathematicae 6 , 290 - 297 ( 1959 ) . [ 11 ] P . Erd˝os & A . R´enyi , ”On the evolution of random graphs” , Publications of the Mathematical Institute of the Hungarian Academy of Sciences 5 , 17 - 61 ( 1960 ) . [ 12 ] P . Erd˝os & A . R´enyi , ”On the strength of connectedness 8 of a random graph” , Acta Mathematica Scientia Hungary 12 , 261 - 267 ( 1961 ) . [ 13 ] B . Bollobas , ”Random Graphs” , Academic Press , New York ( 1985 ) . [ 14 ] P . W . Holland , S . Leinhardt , D . Heise , ”Local struc - ture in social networks” , ”Sociological Methodology” Ed . ( Jossey - Bass , San Fransisco , 1975 ) pp . 1 - 45 . [ 15 ] J . A . Davis , S . Leinhardt , ”The Structure of Positive Interpersonal Relations in Small Groups . ” In Joseph Berger , Morris Zelditch , Jr . , and Bo Anderson ( eds . ) , Sociological Theories In Progress Volume 2 , Boston : Houghton Miﬄin ( 1972 ) , pp . 218 - 251 . [ 16 ] P . W . Holland , S . Leinhardt , ”A Method for Detecting Structure in Sociometric Data” American Journal of So - ciology 70 ( 1970 ) : 492 - 513 [ 17 ] S . Wasserman & K . Faust , ”Social Network Analysis : Methods and Applications” , Cambridge University Press , Cambridge , England , ( 1994 ) . [ 18 ] A . L . Barabasi & R . Albert , ”Emergence of scaling in random networks” , Science 286 , 509 - 12 ( 1999 ) . [ 19 ] S . Redner , ”How Popular is your paper ? An empirical study of the citation distribution” , European Phys . J . B 4 , 131 ( 1998 ) . [ 20 ] M . Faloutsos , P . Faloutsos , C . Faloutsos , ”On power - law relationships of the internet topology” , Comp . Comm . Rev . 29 , 251 - 262 ( 1999 ) . [ 21 ] B . A . Huberman , L . A . Adamic , ”Internet : Growth dy - namics of the World - Wide Web” , Nature 401 , 131 ( Sep 1999 ) . [ 22 ] Z . Burda , J . D . Correia , A . Krzywicki , ”Statistical ensem - ble of scale - free random graphs” , Phys . Rev . E64 ( 2001 ) 046118 . [ 23 ] A . Krzywicki , ”Deﬁning statistical ensembles of random graphs” , cond - mat / 0110574 [ 24 ] P . L . Krapivsky , G . J . Rodgers , S . Redner , ”Degree Dis - tributions of Growing Networks” , Phys . Rev . Lett . 86 , 5401 - 5404 ( 2001 ) . [ 25 ] R . Ferrer i Cancho , R . V . Sol´e , ”The small world of human language” , Proc . R . Soc . Lond . B . 268 , 2261 - 2266 ( 2001 ) . [ 26 ] S . Valverde , R . Ferrer i Cancho , R . V . Sole , ”Scale - free Networks from Optimal Design” , cond - mat / 0204344 ( 2002 ) [ 27 ] S . N . Dorogovtsev , J . F . F . Mendes , , ”Evolution of net - works” , Adv . Phys . 51 , 1079 - 1187 ( 2002 ) [ 28 ] S . N . Dorogovtsev , A . N . Samukhin , ”Mesoscopics and ﬂuctuations in networks” , Phys . Rev . E 67 , 037103 ( 2001 ) [ 29 ] R . Ferrer i Cancho , C . Janssen & R . V . Sole , , ”Topology of technology graphs : small world patterns in electronic circuits” . Physical Review E , 64 , 046119 , ( 2001 ) . [ 30 ] W . Aiello , F . Chung & L . Lu , ”A random graph model for power law graphs” , Experiment . Math . 10 ( 2001 ) , 53 - 66 . [ 31 ] M . Molloy & B . Reed , ”The size of the giant compo - nent of a random graph with a given degree sequence” , Combinatorics , Probability and Computing 7 , 295 - 305 ( 1998 ) . [ 32 ] M . Molloy & B . Reed , ”A critical point for random graphs with a given degree sequence” , Random Structures and Algorithms 6 , 161 - 179 ( 1995 ) . [ 33 ] E . Bender , E . Canﬁeld , ”The asymptotic number of la - belled graphs with given degree sequences” , J . Combin . Theory Ser . A 24 , 296 - 307 ( 1978 ) . [ 34 ] F . Chung , L . Lu , ”The average distances in random graphs with given expected degrees” , Proc . Natl . Acad . Sci . U . S . A . , 99 , 15879 - 15882 ( 2002 ) . [ 35 ] R . Cohen , D . Ben - Avraham , S . Havlin , ”Percolation Critical Exponents in Scale - Free Networks” , Phys . Rev . E 66 , 036113 ( 2002 ) [ 36 ] R . Cohen , K . Erez , D . ben - Avraham , S . Havlin , ”Re - silience of the Internet to Random Breakdowns” , Phys . Rev . Lett . 85 , 4626 ( 2000 ) [ 37 ] M . Newman , ”Scaling and percolation in the small - world network model” , Phys . Rev . E 60 , 7332 - 7342 ( 1999 ) [ 38 ] M . Newman , ”Random graphs as models of networks” , Handbook of Graphs and Networks , edited by S . Born - Holdt & G . Schuster ( Wiley - VCH , Berlin 2002 ) . [ 39 ] J . Eckmann , E . Moses , ”Curvature of co - links uncovers hidden thematic layers in the World Wide Web” , Proc . Natl . Acad . Sci . U . S . A . 99 , 5825 - 5829 ( 2002 ) [ 40 ] P . Collet , J . Eckmann , ”The Number of Large Graphs with a Positive Density of Triangles” , Journal of Statis - tical Physics , 2002 , Vol . 108 , n . 5 - 6 , p . 1107 - 24 . [ 41 ] S . N . Dorogovtsev , J . F . F Mendes & A . N . Samukhin , ”Modern architecture of random graphs : Constructions and correlations ” , cond - mat / 0206467 . [ 42 ] E . Ravasz , A . L . Barabasi , ”Hierarchical Organization in Complex Networks” , Physical Review E ( in press ) . [ 43 ] S . Maslov , K . Sneppen , A . Zaliznyak , ”Pattern Detection in Complex Networks : Correlation Proﬁle of the Inter - net” , cond - mat / 0205379 ( 2002 ) [ 44 ] C . A . Ouzounis , P . D . Karp , ”Global properties of the metabolic map of Escherichia coli” , Genome Research 10 , 568 - 576 ( 2000 ) [ 45 ] A . Wagner , D . Fell , ”The small world inside large metabolic networks” , Proc . R . Soc . Lond . B . 2001 Sep 7 ; 268 ( 1478 ) : 1803 - 10 . [ 46 ] N . Guelzim , S . Bottani , P . Bourgine , F . K´ep ` es , ”Topo - logical and causal structure of the yeast transcriptional regulatory network” , Nature Genet . 31 , 60 ( 2002 ) . [ 47 ] G . Bianconi , A . Capocci , ”Number of Loops of Size h in Growing Scale - Free Networks” Phys . Rev . Lett . 90 , 078701 ( 2003 ) . [ 48 ] J . Berg , M . L¨assig , ”Correlated Random Networks” , Phys . Rev . Lett . 89 ( 22 ) , 228701 ( 2002 ) [ 49 ] M . Newman , ”Assortative mixing in networks” , Phys . Rev . Lett . 89 , 208701 ( 2002 ) . [ 50 ] G . Bianconi , A . L . Barabasi , ”Bose - Einstein condensation in complex networks” Physical Review Letters 86 , 5632 - 5635 ( 2001 ) . P . [ 51 ] J . G . White , E . Southgate , J . N . Thomson & S . Brenner , ”The structure of the nervous system of the nematode Caenorhabditis elegans” , Phil . Trans . Roy . Soc . London Ser . B , 314 , 1 - 340 ( 1986 ) . [ 52 ] F . Harary , H . J . Kommel , ” Matrix measures for transitiv - ity and balance” , Journal of Mathematical Sociology , Vol 6 . : 199 - 210 ( 1979 ) . [ 53 ] In subgraphs which have several nodes with the maxi - mal degree , this approximation should still give correct scaling results as long as the probability of obtaining sev - eral large hubs in one subgraph is low . In obtaining the scaling relations , we replace the number of mutual edges with their average value h K i 2 / N . This gives an incor - rect value for the exact number of appearances ( compare id14 vs . id38 in Table 1 ) , but is valid for obtaining scaling relations .
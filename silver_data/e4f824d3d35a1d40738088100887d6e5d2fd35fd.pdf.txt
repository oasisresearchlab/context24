Robust subgraph counting with distribution - free random graph analysis Johan S . H . van Leeuwaarden Tilburg University Clara Stegehuis University of Twente ( Dated : July 22 , 2021 ) Subgraphs such as cliques , loops and stars form crucial connections in the topologies of real - world networks . Random graph models provide estimates for how often certain subgraphs appear , which in turn can be tested against real - world networks . These subgraph counts , however , crucially depend on the assumed degree distribution . Fitting a degree distribution to network data is challenging , in particular for scale - free networks with power - law degrees . In this paper we develop robust subgraph counts that do not depend on the entire degree distribution , but only on the mean and mean absolute deviation ( MAD ) , summary statistics that are easy to obtain for most real - world networks . By solving an optimization problem , we provide tight ( the sharpest possible ) bounds for the subgraph counts , for all possible subgraphs , and for all networks with degree distributions that share the same mean and MAD . We identify the extremal random graph that attains the tight bounds as the graph with a speciﬁc three - point degree distribution . We leverage the bounds to obtain robust scaling laws for how the numbers of subgraphs grow as function of the network size . The scaling laws indicate that sparse power - law networks are not the most extreme networks in terms of subgraph counts , but dense power - law networks are . The robust bounds are also shown to hold for several real - world data sets . I . INTRODUCTION The occurrence of speciﬁc subgraphs like cliques , loops and stars have been proven important for understand - ing and classifying complex networks , such as social , bi - ological and technological networks . The triangle is a much studied subgraph , because it describes local cluster - ing and signals community structure . Other subgraphs such as larger cliques are also important for understand - ing network organization . Counting how often certain subgraphs appear , in partical in large - scale networks , is therefore a central topic in network science . Indeed , subgraph counts might vary considerably across diﬀerent networks [ 23 , 27 , 31 , 35 ] and any given network has a set of statistically signiﬁcant subgraphs ( also called motifs ) . Subgraphs in complex networks are broadly studied through random graphs , mathematically tractable mod - els that can generate random samples of a graph in which nodes have i . i . d . degrees [ 4 , 17 – 19 , 34 ] . Random graph models take the degree distribution as input . Conditional on the degree distribution , random graph properties such as average distance , clustering and clique formation can often be characterized and in turn be tested against mea - surements from real - world network data with the same degree distribution . Classical choices for degree distri - butions include the Poisson distribution and power - law distributions . The latter also often arises in analyzing real - world networks , as their degree distributions can of - ten be approximated with a power - law distribution . A random variable obeys a power law if it is drawn from a probability distribution P ( h ) ∝ h − τ , h ≥ 0 , ( 1 ) with τ > 0 a constant known as the power law expo - nent . Many real - world networks were shown to be ap - proximated by a power - law degree distribution with an exponent in the range 2 < τ < 3 [ 16 , 21 , 37 ] . Fitting a power law to real - world data , however , is statistically challenging [ 9 , 12 , 38 ] . For small values , a power law is usually not a good ﬁt . Therefore , one typically assumes that it only holds for values greater than some minimum h min . Alternatively , one can consider a family of distri - butions of the form P ( h ) ∝ L ( h ) h − τ , h ≥ 0 , ( 2 ) where L ( h ) is some slowly varying function , so that L ( ch ) / L ( h ) → 1 for any c > 0 as h → ∞ . The func - tion L ( h ) can then account for deviations from the pure power law caused by smaller values of the distribution . Hence , both h min and L ( h ) are ways to deal with imper - fection in data for smaller degree values . However , both h min and L ( h ) create extra parameters that make ﬁtting the distribution to real - world data more diﬃcult . Larger values of the power law also present challenges . Most real - world data sets only follow a power law up to some maximal degree , which is often modeled by an exponential cutoﬀ [ 14 , 24 , 25 ] . Real - world networks are in fact ﬁnite by deﬁnition , while a power law allows in - ﬁnitely large values . One way to link ﬁnite networks with the possibly inﬁnite power - law values is to scale the maximum degree , called cutoﬀ , as function of the net - work size . We will use this mathematical approach of scaling the cutoﬀ as function of the network size also in this paper . Network properties claimed to be universal should not be overly sensitive to the assumed degree distribution , especially when this distribution is hard to justify statis - tically . For power laws as in ( 2 ) for instance , the exact a r X i v : 2107 . 10089v1 [ c s . S I ] 21 J u l 2021 2 shape of L ( h ) is often not crucial , while the tail expo - nent τ implies vastly diﬀerent network properties . One reason for this is the variance of the degree distribution . When the number of nodes n becomes large , the variance grows to inﬁnity for τ < 3 , while the variance remains ﬁnite for τ > 3 . This diﬀerence in variance growth cru - cially inﬂuences network structure and subgraph forma - tion [ 19 , 28 , 34 ] . In this paper , we characterize subgraph counts in ran - dom graphs that only require partial information about the degree distribution . Inspired by the example of the complicated assessment of power laws , we assume that we only know the mean , range and mean absolute de - viation ( MAD ) of the degree distribution . The MAD is an alternative to variance for measuring dispersion around the mean , and may be more appropriate in case of heavy tails . Indeed , MAD can deal with distributions that do not possess a ﬁnite variance , in particular the class of power - law distribution with τ ∈ ( 2 , 3 ) , for which MAD remains ﬁnite while variance becomes inﬁnite in the large - network limit when n → ∞ . We shall identify the maximal subgraph count that can be achieved by all degree distributions that have the same mean , range and MAD . Consider a subgraph H and the subgraph count E P [ N H ] deﬁned as the ex - pected number of subgraphs H that appear in a random graph . By constructing a maximization problem we de - termine the extremal degree distribution P that maxi - mizes the subgraph count E P [ N H ] and will refer to the random graph with the extremal degree distribution as the extremal random graph . We solve this maximiza - tion problem for the hidden - variable model [ 6 , 11 ] , a random graph model that generates graphs with degrees that approximately follow some given distribution . The hidden - variable model is a widely applied model due to generality and tractability : many network properties of the model have been investigated , such as degree - degree correlations , clustering , typical distances and epidemic spreading [ 5 , 6 , 13 , 17 , 30 ] . Typically , these properties depend strongly on the input distribution of the hidden variables . For example , whether or not the second mo - ment of the input distribution diverges , strongly inﬂu - ences the degree - correlations , distances and behavior un - der epidemic processes . We therefore provide bounds on the subgraph counts that hold for all input distributions with the same mean and MAD . For the hidden - variable model we ﬁrst show that E P [ N H ] is a convex function of the hidden variables . We then employ a method from distributionally robust op - timization for maximizing a convex function under cer - tain constraints . We seek for the maximum of E P [ N H ] , given the constraints on the degree distribution in terms of the mean , range and MAD . This gives rise to a semi - inﬁnite linear program with as solution the robust sub - graph bounds . Here are the main contributions of this paper : ( i ) We show that for all subgraphs H the expected number of subgraphs E P [ N H ] is maximized for the extremal graph model with a three - point degree distribution . This maximal number of subgraphs only depends on the mean , MAD and range of the degree distribution , and therefore does not need further detailed assumptions on the degree distri - bution . In particular , we show that this extremal graph model is the same for all possible subgraphs H and network sizes . ( ii ) We derive scaling laws for E P [ N H ] when the net - work size n grows to inﬁnity . These scaling laws provide an inherent order over all subgraphs in terms of the maximal number of copies of such sub - graphs in any hidden - variable model , and provide a method to compare the denseness of subgraphs cre - ated by any degree distribution to its absolute max - imum provided by our bounds . We also show that the Chung - Lu model achieves the maximal number of all types of subgraphs among all hidden - variable models . ( iii ) We compare the extremal graph model that pro - vides the highest subgraph counts to existing re - sults for power - law random graphs . We show that for all subgraphs , a power - law degree distribution with τ ≤ 2 achieves the maximal subgraph scaling predicted by our bounds . This shows that power - laws with τ ≤ 2 are densest networks in terms of subgraph counts among all networks with the same average degree and MAD . Power laws with larger exponents ( τ > 2 ) do not achieve the maximal scaling , and the subgraph counts scale at a slower rate . This shows that in the sparse setting ( τ > 2 ) , where the average degree does not grow , power - law networks are not ‘optimal’ in terms of subgraph counts , whereas in the dense setting ( τ ≤ 2 ) they are . ( iv ) We demonstrate that the robust bounds indeed bound the number of subgraphs in nine real - world data sets . This analysis does not require any as - sumption on the degree distribution of these data sets ; only knowledge of the average degree , the MAD , and the maximal degree is required . In par - ticular , the robust bounds work for both power - law and non power - law distributed data . We introduce the hidden - variable model and assump - tions on the degree distribution in Section II . We then solve the maximization problem that ﬁnds the extremal random graph that generates the maximal subgraph counts in Section III . The scaling laws for subgraph counts as function of the network size are presented in Section IV . In Section V we obtain some results for the setting when the variance instead of the MAD is known . In Section VI , we compare this extremal random graph and tight subgraph bounds with existing results for scale - free networks with power - law degrees . Section VII shows subgraph counts and bounds for nine real - world net - 3 works . The paper is concluded in Section VIII with a discussion and outlook . II . HIDDEN - VARIABLE MODEL As a random graph model , we employ the hidden - variable model , in which every vertex i ∈ [ n ] has a weight h i . Traditionally , one then assumes that the weights h 1 , . . . , h n are independent and follow some given dis - tribution . In this paper , however , we only specify partial information about the weight ( i . e . degree ) distribution . We will assume that for the weights we know the minimal and maximal value , the mean and the mean absolute de - viation ( MAD ) . Let h denote a generic weight . Then we assume that the weights are sampled independently from a degree distribution such that ( i ) h = h i has support supp ( h ) = [ a , h c ] with −∞ < a ≤ h c < ∞ , ( ii ) E [ h ] = µ and ( iii ) E [ | h − µ | ] = d . This deﬁnes the ambiguity set P ( µ , d ) = { P : supp ( h ) ⊆ [ a , h c ] , E [ h ] = µ , E [ | h − µ | ] = d } . ( 3 ) Hence , when we now analyze the hidden - variable model under the assumption that the weight distribution be - longs to P ( µ , d ) we perform a distribution - free analysis of the random graph model . We further assume that every pair of vertices is con - nected independently with probability p ( h i , h j ) = f ( h i h j / h 2 s ) . ( 4 ) where h s is the structural cutoﬀ . This shape of the con - nection probability ensures that the weight of a vertex is close to its degree [ 33 ] . The structural cutoﬀ de - scribes the maximal degree of vertices that are not prone to degree - degree correlations [ 6 ] . As soon as the de - gree of a vertex becomes larger than the structural cut - oﬀ , it is forced to connect to lower degree vertices , as only few high degree vertices can be present while keep - ing the average degree ﬁxed . The structural cutoﬀ has mainly been investigated for power - law networks , where h s ∼ √ µn [ 6 , 10 , 13 ] . The natural cutoﬀ describes the constraint on the largest possible network degree . If the objective is to generate uncorrelated networks , this nat - ural cutoﬀ should be smaller than the structural cutoﬀ , as larger vertices experience degree - correlations . There - fore , the natural cutoﬀ is often assumed to be equal to the structural cutoﬀ of √ µn [ 5 , 10 , 11 ] . In this setting , many network properties can be related to moments of the hidden variable distribution , which makes it possi - ble to investigate subgraph counts [ 5 ] , distances [ 11 ] and clustering [ 13 ] . We henceforth assume the setting where h s = h c , equal structural and natural cutoﬀ , so that the generated networks are uncorrelated [ 6 ] . For the connection function f we make the following assumption : Assumption A . f ( x ) ≥ 0 is non - decreasing and convex for x ∈ [ 0 , 1 ] . The class of hidden - variable models satisfying Assump - tion A is very rich . In particular , it contains the follow - ing three frequently used connection probabilities : The Chung - Lu model [ 7 , 11 , 17 ] f ( u ) = min { u , 1 } , ( 5 ) the Poisson random graph [ 3 , 7 , 26 ] f ( u ) = 1 − e − u ( 6 ) and the generalized random graph [ 8 , 13 , 29 , 32 ] f ( u ) = u 1 + u . ( 7 ) III . EXTREMAL RANDOM GRAPH We now investigate the maximal subgraph counts in hidden - variable models over all probability distributions of the weights that satisfy ( 3 ) . We thus investigate the number of copies N H of a given subgraph H = ( V H , E H ) on k vertices . Let the degrees of the vertices in H be denoted by d 1 , d 2 , . . . , d k . Then , the expected number of copies of H becomes E [ N H | ( h i ) i ∈ [ n ] ] = (cid:88) i 1 < i 2 < ··· < i k (cid:89) { u , v } ∈ E H p ( h i u , h i v ) = 1 Aut ( H ) n (cid:88) i 1 = 1 n (cid:88) i 2 = 1 · · · n (cid:88) i k = 1 (cid:89) { u , v } ∈ E H f (cid:16) h i u h i v h 2 s (cid:17) ( 8 ) where Aut ( H ) denotes the number of automorphisms of H . Therefore , E P [ N H ] = n k Aut ( H ) E P   (cid:89) { u , v } ∈ E H f (cid:16) h u h v h 2 s (cid:17) , ( 9 ) where h i denote independent copies of the random vari - able h . Lemma III . 1 . Under Assumption A , the function (cid:81) { u , v } ∈E H f ( h u h v h 2 s ) is convex in all h i . Proof . The function f is convex , non - decreasing and pos - itive on [ 0 , 1 ] , so a product of these f - functions is also convex . Hence , under the assumptions made for the hidden - variable model , the subgraph count E P [ N H ] viewed as function of the hidden variables is convex in ( h 1 , . . . , h n ) . This convexity can be leveraged to employ a method from distributionally robust optimization for maximiz - ing a convex function under certain mean - MAD - range constraints : Theorem III . 2 ( Extremal graph model ) . Under As - sumption A , the extremal distribution that solves 4 max P ∈P ( µ , d ) E P [ N H ] consists for each h i of a three - point distribution with values a , µ , h c and probabilities p a = d 2 ( µ − a ) , p µ = 1 − d 2 ( µ − a ) − d 2 ( h c − µ ) , p h c = d 2 ( h c − µ ) . ( 10 ) Theorem III . 2 follows from the the general upper bound in [ 1 ] on the expectation of a convex function of independent random variables with mean - MAD - range information . The proof of Theorem III . 2 crucially relies on the fact that the solution of the univariate case can be straightforwardly extended to the multivariate case . Consider a univariate convex function x (cid:55)→ g ( x ) and con - sider the maximum E P [ g ( h ) ] with h a random variable on [ a , h c ] with mean µ and MAD d . In this univariate setting we can formulate this maximization problem as max P ( x ) ≥ 0 (cid:90) x g ( x ) d P ( x ) s . t . (cid:90) x | x − µ | d P ( x ) = d , (cid:90) x x d P ( x ) = µ , (cid:90) x d P ( x ) = 1 , ( 11 ) a semi - inﬁnite linear program with three equality con - straints , and as solution for P = P ( x ) the three - point distribution on { a , µ , h c } . Notice that this solution does not depends on the speciﬁc shape of the convex func - tion g ( x ) , which makes the multivariate counterpart of ( 11 ) equally tractable . Take as an example the func - tion g ( h 1 , . . . , h n ) : = E P [ N H ] , and formulate the maxi - mal subgraph count as max P ( x ) ≥ 0 (cid:90) x g ( x 1 , . . . , x n ) d P ( x 1 ) · · · d P ( x n ) s . t . (cid:90) x | x − µ | d P ( x ) = d , (cid:90) x x d P ( x ) = µ , (cid:90) x d P ( x ) = 1 . ( 12 ) Indeed , to deal with this multivariate case , we can re - cursively apply the univariate result . Suppose we ﬁrst apply this result to h 1 . Then the worst - case distribu - tion is as in Theorem III . 2 , independent of the values for h 2 , . . . , h n . Moreover , the maximal expectation becomes a convex function in h 2 , . . . , h n , since the extremal prob - abilities for h 1 are nonnegative . Hence , we can apply the result above for the univariate case to h 2 , and so on , which then establishes Theorem III . 2 . The theorem thus shows that the extremal random graph for all possible subgraphs and all possible hidden - variable models satis - fying Assumption A consists of vertices with only three degrees : a , µ and h c = h s . Under the canonical choice h s = √ µn , p a = d 2 ( µ − a ) , p µ ≈ 1 − d 2 ( µ − a ) , p √ µn ≈ d 2 √ µn . FIG . 1 . Illustration of the extremal Chung - Lu random graph : a clique of size O ( √ n ) ( green ) , and O ( n ) vertices of weights µ or a with small expected degree ( orange ) . As p a and p µ are constant in n , the extremal random graph contains O ( n ) vertices of low degrees a and µ . Furthermore , p √ µn scales as 1 / √ n , creating on average d √ n / ( 2 µ ) vertices with degrees as large as √ µn . The connection probability ( 4 ) shows that p ( h s , h s ) = f ( 1 ) , which does not depend on n . This means that the √ µn weight vertices form a dense subgraph . The denseness is controlled by the parameter f ( 1 ) . When f ( 1 ) = 1 , these vertices form a clique , and for f ( 1 ) = p < 1 , these high - degree vertices form a dense Erd˝os - R´enyi random graph with probability p . On the other hand , vertices with weight a or µ in the extremal random graph have ﬁnite average degree . This shape of extremal random graph is illustrated in Figure 1 for the case f ( 1 ) = 1 . IV . SCALING LAWS FOR LARGE NETWORKS A direct consequence of Theorem III . 2 is that the tight bound on the subgraph count is obtained by enumerating over all 3 n permutations of the outcomes { a , µ , h c } for all weight h 1 , . . . , h n . This gives the following result : Corollary IV . 1 . Under Assumption A , the tight bound on the subgraph count can be expressed as max P ∈P ( µ , d ) E P [ N H ] = n k Aut ( H ) × (cid:88) i 1 ∈ { a , µ , h c } . . . (cid:88) i k ∈ { a , µ , h c } k (cid:89) j = 1 p i j (cid:89) { s , t } ∈ E H f (cid:16) i s i t h 2 c (cid:17) . ( 13 ) We next show how the maximal subgraph counts scale as function of the network size . To obtain these scaling relations , we employ ( 13 ) and make an additional as - sumption next to Assumption A on the connection prob - abilities : Assumption B . f ( x ) = xr ( x ) where r ( 0 ) = 1 and r ( x ) decreases in x . 5 While Assumption B is a more detailed assumption on the connection probabilities than Assumption A , it still contains the three classical examples of hidden - variable models in ( 5 ) - ( 7 ) . We now investigate the behavior of ( 13 ) when f satis - ﬁes Assumption B . In that case , when h s = h c , E P [ N H ] = n k Aut ( H ) × (cid:88) i 1 ∈ { a , µ , h c } . . . (cid:88) i k ∈ { a , µ , h c } k (cid:89) j = 1 p i j (cid:89) { s , t } ∈ E H i s i t h 2 c r (cid:16) i s i t h 2 c (cid:17) = n k Aut ( H ) h 2 E H s × (cid:88) i 1 ∈ { a , µ , h c } . . . (cid:88) i k ∈ { a , µ , h c } k (cid:89) j = 1 p i j i d j j (cid:89) { s , t } ∈ E H r (cid:16) i s i t h 2 c (cid:17) . ( 14 ) We show in Appendix A that for every vertex j with d j ≥ 2 , the summation over i j ∈ { a , µ , h c } is dominated by the term containing h c , so that the other terms may be ignored . Therefore , for subgraphs with minimal degree at least 2 , we can ignore the terms in ( 14 ) with i j = a or i j = µ , yielding E P [ N H ] ∼ n k Aut ( H ) h 2 E H s k (cid:89) j = 1 d 2 ( h c − µ ) h d j c (cid:89) { s , t } ∈ E H r ( 1 ) = n k d k h 2 E H − k c h 2 E H c 2 k Aut ( H ) r ( 1 ) E H . ( 15 ) When d j = 1 , the contributions of i j = a , µ , h c in ( 14 ) are of similar order of magnitude . In Appendix A we show that this yields the following result : Theorem IV . 2 ( Core structure ) . Let H = ( V H , E H ) be a connected subgraph on k vertices and make Assump - tion A and Assumption B . ( i ) When d H > 1 for all v ∈ V H , h s = h c and h c → ∞ as n → ∞ , max P ∈P ( µ , d ) E P [ N H ] n k h − k c → d k 2 k Aut ( H ) r ( 1 ) | E H | . ( 16 ) ( ii ) When k ≥ 3 and h c → ∞ and h s = h c as n → ∞ , max P ∈P ( µ , d ) E P [ N H ] n k h − k c → d k − n 1 Aut ( H ) 2 k − n 1 (cid:18) d 2 ( r ( 1 ) − 1 ) + µ (cid:19) n 1 r ( 1 ) E H − n 1 , ( 17 ) where n 1 denotes the number of degree - 1 vertices in H . This theorem shows subgraphs with minimal degree at least 2 predominantly appear in the core of the extremal random graph containing all vertices of weight h c . Other FIG . 2 . Subgraphs with minimal degree at least 2 asymp - totically appear on the √ nµ degree vertices ( pink triangle ) , while degree - 1 vertices inside a subgraph typically appear at the degree - µ , a or h c vertices ( yellow 4 - path ) . subgraphs that contain degree - one vertices , asymptoti - cally have their degree - one vertices everywhere in the ex - tremal random graph , while the other subgraph vertices typically still only appear in the core of the extremal random graph , see Figure 2 . Furthermore , ( 17 ) reveals the interesting property that the scaling in n and h c is the same for all possible sub - graphs of size k . The eﬀect of the precise subgraph struc - ture is only visible in the leading order constant . Also , if we compare all subgraphs of a given size k with mini - mal degree at least 2 , ( 16 ) shows that this leading order constant only depends on the subgraph through its num - ber of automorphisms . Therefore , we can easily order all such subgraphs based on the maximal number of times they appear in any hidden - variable model . For exam - ple , among all subgraphs of a given size , cliques have the largest number of automorphisms . Thus , k - cliques ap - pear the least often among all subgraphs of size k in the extremal random graph , and therefore have the lowest upper bound on their count among all size - k subgraphs . The rest of the ordering in terms of maximal number of subgraphs , is only determined by the number of subgraph automorphisms in decreasing order . When degree - one vertices are contained in the sub - graph , ( 17 ) shows that a combination of the number of subgraph automorphisms , a term containing the ﬁxed pa - rameters d and µ , the model - speciﬁc term r ( 1 ) and the number of degree - one vertices in the subgraph . When we take the speciﬁc case r ( 1 ) = 1 and h s = h c = √ µn , ( 17 ) simpliﬁes to E P [ N H ] ∼ n k / 2 d k − n 1 Aut ( H ) 2 k − n 1 µ k / 2 − n 1 . ( 18 ) Equation ( 18 ) shows that for all subgraphs of size k the only eﬀect of the graph structure of H is determined by the number of automorphisms of H and the constant ( 2 µ / d ) n 1 . Figure 3 illustrates the ordering in terms of maximal frequency of all subgraphs of size 4 by showing 6 K 4 : 1 / 12 cycle : 1 / 8 diamond : 1 / 4 paw : c / 2 path : c 2 / 2 claw : c 3 / 6 FIG . 3 . The leading constant c n 1 / Aut ( H ) for the maximal scaling of the number of subgraphs in n for all subgraphs on 4 vertices , where c = 2 µ / d . the leading order constant of ( 18 ) . A lower constant in Figure 3 therefore indicates that this particular subgraph appears less frequently than a subgraph with a higher constant . Thus , the clique is the least frequently occur - ring subgraph . The most frequently appearing subgraph depends on the constant c = 2 µ / d > 1 , and is either the path or the claw . A similar ordering for size 5 subgraphs is provided in Appendix C . We now apply Theorem IV . 2 to the three classical hidden - variable models mentioned in Section II . In par - ticular , we show that the Chung - Lu model can generate the largest amount of cliques . Proposition IV . 3 . Suppose h s = h c = √ µn . The Chung - Lu model can generate the maximal number of cliques among all connection probabilities that fall under Assumption A , scaling as max P ∈P ( µ , d ) E P [ N K k ] n k / 2 → d k k ! 2 k µ k / 2 , ( 19 ) Furthermore , all three classical hidden - variable models ( 5 ) - ( 7 ) satisfy max P ∈P ( µ , d ) E P [ N K k ] n k / 2 → d k r ( 1 ) k ( k − 1 ) / 2 k ! 2 k µ k / 2 . ( 20 ) Proof . When taking h s = h c = √ µn , for all connection probabilities satisfying Assumption A , ( 16 ) gives for the expected number of k - cliques max P ∈P ( µ , d ) E P [ N K k ] ≈ d k n k / 2 k ! 2 k µ k / 2 r ( 1 ) k ( k − 1 ) / 2 , ( 21 ) proving the second part of the statement . Further - more , from ( 21 ) it is not diﬃcult to see that the Chung - Lu model can generate the maximal number of cliques among all connection probabilities that fall under As - sumption A . Indeed , the function r ( x ) = 1 is the max - imal possible function under Assumption A , and ( 21 ) is increasing in r ( 1 ) , proving the ﬁrst part of the state - ment . V . FIXING VARIANCE INSTEAD OF MAD We have shown that under mean - MAD - range infor - mation , the search for the extremal random graph that maximizes subgraph counts was tantamount to solving the optimization problem in ( 12 ) . The three - point so - lution of the 1 - dimensional problem in ( 11 ) carried over directly to the n - dimensional problem in ( 12 ) . We now ask what happens when we replace the MAD information with variance information . We then ﬁrst solve the 1 - dimensional counterpart of ( 11 ) , but now optimizing over all distributions with known range , mean and variance ( instead of MAD ) . As it turns out , the solution ( the extremal distribution ) will depend on the convex function g ( x ) , which has severe consequences for the multivariate case , i . e . , when we con - sider g ( h 1 , . . . , h n ) . In that case , the extremal distribu - tion depends on the values of h 2 , . . . , h n , and calculating ( in closed form ) the extremal distribution as a function of h 2 , . . . , h n seems to be impossible . This means that for each n , a new n - dimensional problem needs to be solved , implying that the extremal random graph is diﬀerent for every value of n . We now show how the key result for mean - MAD am - biguity , Theorem III . 2 , can be used to obtain results for mean - variance ambiguity . In general , MAD and variance are related as [ 2 , 15 ] d min : = 2 σ 2 h c − a ≤ d ≤ σ = : d max . Let P ∗ ( µ , σ ) denote the ambiguity set that contains all dis - tributions with known range , mean and variance , i . e . , P ∗ ( µ , σ ) = (cid:8) P : supp ( X ) ⊆ [ a , h c ] , E P ( X ) = µ , E P ( X − µ ) 2 = σ 2 (cid:9) . Since max P ∈P ( µ , d ) E P [ g ( h 1 , . . . , h n ) ] is non - decreasing in d , see [ 15 ] , we obtain for ﬁxed σ the bounds max P ∈P ( µ , d min ) E P [ g ( h 1 , . . . , h n ) ] ≤ max P ∈P ∗ ( µ , σ ) E P [ g ( h 1 , . . . , h n ) ] ≤ max P ∈P ( µ , d max ) E P [ g ( h 1 , . . . , h n ) ] . ( 22 ) Thus , when ﬁxing the variance at σ 2 , we need to consider the range of d ∈ [ 2 σ 2 / ( h c − a ) , σ ] . For the extremal random graph of ( 10 ) , σ 2 = da 2 2 ( µ − a ) − dµ 2 2 ( µ − a ) − dµ 2 2 ( h c − µ ) + dh 2 c 2 ( h c − µ ) = d ( h c − a ) / 2 . ( 23 ) Thus , the lower bound , d min = 2 σ 2 / ( h c − a ) ensures that the extremal graph has the desired variance σ 2 . In this section we therefore set d = 2 σ 2 / ( h c − a ) . Then , the MAD extremal random graph with this value of d gives the desired variance , and provides a lower bound on the maximal number of subgraphs with given variance . In 7 particular , we are interested in the setting where σ 2 → ∞ as n → ∞ but σ 2 / h c → 0 , similar to observations in many real - world networks . In Appendix B , we again consider ( 14 ) , and investigate which of the three terms in the summation ( a , µ or h c ) has the dominant contribution for large n . The dominat - ing terms are slightly diﬀerent compared to the ﬁxed d setting : when d j ≥ 3 , the contribution from i j = h c dom - inates , whereas for d j = 2 , the contribution from i j = h c and from i j = µ have the same order of magnitude . Fi - nally , when d j = 1 , the contribution to ( 14 ) from i j = µ dominates the other contributions . Appendix B shows that this gives the following result : Theorem V . 1 ( Diminishing d ) . Let H = ( V H , E H ) be a connected subgraph on k vertices . Let d = 2 σ 2 / ( h c − a ) where h s = h c → ∞ and σ 2 / h c → 0 . Then , under Assumption A and B , max P ∈P ( µ , d ) E P [ N H ] n k h − 2 k + n 1 c → r ( 1 ) E ≥ 3 , ≥ 3 Aut ( H ) (cid:0) σ 2 r ( 1 ) + µ 2 (cid:1) n 2 , 1 × (cid:0) σ 2 r ( 1 ) 2 + µ 2 (cid:1) n 2 − n 2 , 1 µ n 1 σ 2 n ≥ 3 , ( 24 ) where n i and n ≥ i denote the number of vertices of de - gree i or degree at least i in H , and E ≥ 3 , ≥ 3 denotes the number of edges between vertices of degree at least 3 in H . Furthermore , n 2 , 1 denotes the number of degree - 2 vertices in H that are connected to a degree - 1 vertex . This theorem again shows that in the extremal random graph with d = 2 σ 2 / ( h c − a ) subgraphs counts are dom - inated by subgraph counts in speciﬁc formations of the extremal random graph . For example , subgraphs with minimal degree at least three almost exclusively appear in the core of √ µn vertices . Degree - one vertices in a sub - graph on the other hand , typically appear at the vertices of degree µ . As an example , take the Chung - Lu model with h s = √ µn , a = 1 and p ( h , h (cid:48) ) = min ( hh (cid:48) / ( µn ) , 1 ) . Then ( 24 ) gives for k > 3 , E P [ N K 3 ] ≈ 1 6 µ 3 (cid:0) µ 2 + σ 2 (cid:1) 3 , E P [ N K k ] ≈ σ 2 k k ! µ k , k > 3 . ( 25 ) This is an intuitive result , because when maximizing E [ X 2 ] while keeping the variance and the mean degree ﬁxed , we expect to end up with some function of E [ X 2 ] . For other subgraphs H we can obtain similar results . When H has s 1 vertices of degree 1 , s 2 of degree 2 and denote s ≥ 3 vertices with degree at least 3 , ( 24 ) becomes E P [ N H ] ≈ n s 1 / 2 Aut ( H ) µ k − 3 / 2 s 1 (cid:0) µ 2 + σ 2 (cid:1) s 2 σ 2 s ≥ 3 . ( 26 ) Thus , the more degree - 1 vertices a subgraph has , the more often it appears , as a scaling in n . When the num - ber of degree - 1 vertices remains unchanged , the scaling in n of the subgraph count remains the same . However , having more degree - 2 vertices increases the leading order term of the subgraph count . And as before , subgraphs with more automorphisms appear less often . VI . POWER - LAW RANDOM GRAPHS We now compare the results on the maximal clique counts among all weight distributions with the subgraph counts in the frequently - used power - law weights , to an - swer the question of how close power - law degrees are to the extremal random graph . Thus , we assume a power - law distribution with cutoﬀ for the weights P ( h ) = Ch − τ , ( 27 ) for h ∈ [ 1 , h c ] and some τ and C . Then , d = C ( 2 µ 2 − τ − 1 − h 2 − τ c ) ) τ − 2 + Cµ ( − 2 µ 1 − τ + 1 + h 1 − τ c ) ) τ − 1 . ( 28 ) Observe that for τ > 2 , d is approximately constant , whereas for τ < 2 it grows as h 2 − τ c ( as there µ also grows as h 2 − τ c ) . We split the comparison into two classes for τ : so called sparse ( 2 < τ < 3 ) and dense ( 1 < τ < 2 ) scale - free networks . Sparse scale - free networks . We now compare the num - ber of subgraphs in power - law random graphs in the regime 2 < τ < 3 with the extremal number of subgraphs among all random graphs with equal mean and MAD . When 2 < τ < 3 , under a cutoﬀ at h s = h c = √ µn , the expected number of cliques in a power - law random graph with degree - exponent τ equals [ 20 , Eq . ( 1 . 7 ) ] E pl [ N K k ] ≈ n k / 2 ( 3 − τ ) µ k / 2 ( 1 − τ ) k ! (cid:18) C k − τ (cid:19) k . ( 29 ) The MAD - maximizer with the same µ and d as this power - law distribution for 2 < τ < 3 becomes accord - ing to ( 19 ) max P ∈P ( µ , d ) E P [ N K k ] ≈ n k / 2 k ! 2 k µ k / 2 (cid:16) C ( 2 µ 2 − τ − 1 ) τ − 2 − C ( 2 µ 2 − τ − µ ) τ − 1 (cid:17) k . ( 30 ) This scaling in n of n k / 2 is much larger than the scaling of n k / 2 ( 3 − τ ) in power - law random graphs . Thus , the ex - tremal random graph is asymptotically much more dense than power - law random graphs in terms of cliques . Let us then compare the expected number of cliques in a power - law random graph ( 29 ) with the extremal num - ber of subgraphs with d = 2 σ 2 / ( √ µn − 1 ) , where µ and σ 2 denote the mean and variance of the power - law dis - tribution . This ensures that the variance of the MAD extremal random graph is equal to the variance of the power - law distribution . The variance of power - laws with 8 10 2 10 3 10 4 10 5 10 0 10 5 n N 4 MAD σ 2 power - law ( a ) τ = 2 . 5 10 3 10 4 10 5 10 0 10 2 10 4 10 6 10 8 n N 4 MAD σ 2 power - law ( b ) τ = 1 . 5 FIG . 4 . The number of triangles against the network size n in : a power - law random graph , an MAD - optimal model with same µ and d as the power - law model , an MAD - optimal model with equal µ and σ 2 as the power - law model . Dots are simulated values , whereas the blue and the orange curves are the MAD - optimal predictions from ( 19 ) and ( 25 ) , respectively . cutoﬀ at √ µn equals σ 2 = C 3 − τ √ µn 3 − τ . Then , ( 25 ) yields for the variance - maximal number of cliques that max P ∈P ( µ , σ 2 √ µn − 1 ) E P [ N K k ] = n k / 2 ( 3 − τ ) µ k / 2 ( 1 − τ ) k ! (cid:18) C 3 − τ (cid:19) k . ( 31 ) When comparing the leading order constant to the one computed for power - law random graphs with cutoﬀ at √ µn , it exactly agrees for k = 3 , so for triangles . There - fore , ( 31 ) suggests that power - law random graphs contain the maximal amount of triangles among all Chung - Lu models with the same variance . In other words : power - law random graphs are the most clustered random graphs among all Chung - Lu models with given variance . For larger cliques , the constant in ( 31 ) is higher than the one for the power - law random graph with cutoﬀ . Thus , power - law random graphs do not contain the maximal amount of larger cliques among all Chung - Lu random graphs with the same variance in terms of leading or - der constant . The scaling in n , n k / 2 ( 3 − τ ) however , still agrees between the power - law number of cliques and the variance - extremal random graph , so that in order of mag - nitude , power - law random graphs achieve the largest pos - sible number of cliques among all graphs with the same variance . Proving this however , needs the proof of equal - ity in the lower bound of ( 31 ) , which is an open prob - lem due to the diﬃculties that arise when switching from ﬁxed MAD to ﬁxed variance . Figure 4a illustrates these observations : The MAD - extremal random graph contains a number of triangles that grows signiﬁcantly faster in n than the power - law random graph . The MAD - extremal graph with equal variance as the power - law distribution on the other hand , contains the same number of triangles as the power - law random graph . Dense scale - free networks . In the regime 1 < τ < 2 , setting h s is not as straightforward as in the previous regime . Taking h s = h c = √ µn gives a convex connec - tion probability , but µ grows in h s as well . This results in h s = h c ∼ n 1 / τ and µ ∼ n 2 / τ − 1 [ 5 ] . Under this cutoﬀ [ 5 ] , the expected number of cliques in a power - law random graph scales as E pl [ K k ] ∼ n k / τ ( 32 ) Now for 1 < τ < 2 , ( 28 ) yields d ∝ µ ∝ n 2 / τ − 1 . Then , ( 19 ) gives that the maximal number of cliques among all subgraphs with the same MAD as the power - law distribution with exponent τ ∈ ( 1 , 2 ) scales as max P ∈P ( µ , d ) E P [ N K k ] ∼ n k / 2 µ − k / 2 k ! 2 k ∼ n k / τ , ( 33 ) which has the same scaling in n as ( 32 ) . Thus , under the MAD framework , power - law random graphs with 1 < τ < 2 achieve the maximal clique scaling in the network size n , and power - law networks are the densest possible networks in terms of cliques . As in the 2 < τ < 3 regime , σ 2 ∼ h 3 − τ s , so that σ 2 / h s ∼ h 2 − τ s ∼ d . With µ ∝ d ( 25 ) yields max P ∈P ( µ , σ 2 hs − 1 ) E P [ K k ] ∝ ( dh s ) k d k ∝ n k / τ , ( 34 ) which again has the same scaling as the number of cliques in the corresponding power - law random graph obtained from ( 32 ) . Thus , this suggests that power - law random graphs contain the maximal amount of triangles among all Chung - Lu models with the same variance , similarly to the 2 < τ < 3 case . Figure 4b indeed illustrates that the MAD extremal random graph contains a larger number of triangles than a power - law with the same MAD and average degree , but that these numbers scale the same in n . The extremal random graph with equal variance as the power - law ran - dom graph contains the same number of triangles . For 2 < τ < 3 on the other hand , power - laws do not achieve the maximal triangle count scaling under ﬁxed MAD . 9 1 1 . 5 2 2 . 5 3 0 1 2 3 4 τ s c a li n g E [ K 4 ] pl E [ K 4 ] d E [ K 4 ] σ FIG . 5 . Scaling of the expected number of 4 - cliques in n . E [ K 4 ] pl denotes the number of cliques of a power - law ran - dom graph with speciﬁed degree exponent τ . E [ K 4 ] d denotes the maximal number of cliques in a Chung - Lu network with the same MAD as a power - law random graph with speciﬁed degree exponent τ . E [ K 4 ] σ denotes the maximal number of cliques in a Chung - Lu network with d = 2 σ 2 / ( h s − 1 ) , where σ 2 is the variance of a power - law random graph with speciﬁed degree exponent τ . Figure 5 summarizes our ﬁndings . For 1 < τ < 2 , power - law Chung - Lu random graphs achieve the maxi - mal clique scaling among all Chung - Lu random graphs with the same MAD or variance . For 2 < τ < 3 , Chung - Lu power - law random graphs achieve a lower number of k - cliques than the maximal number of k - cliques among all Chung - Lu random graphs with the same MAD . In fact , the maximal number cliques among all Chung - Lu random graphs with the same MAD as power - laws with 2 < τ < 3 scales as the number of cliques in a power - law Chung - Lu random graph for τ = 2 . Furthermore , Figure 5 suggests that for 1 < τ < 3 , power - law random graphs achieve the maximal number of cliques among all weight distributions with the same variance . However , this is only based on a lower - bound technique . VII . DATA We now investigate the performance of the predicted upper bounds on subgraph counts for nine network data sets that have cutoﬀ below √ µn [ 22 ] . The data summary statistics are described in Table I . Using only these sum - mary statistics , we can compute the bound on the max - imal number of subgraphs in networks with the same µ , d and n using Theorem IV . 2 . In Figure 6a , we plot the ratio between the actual sub - graph counts in the data sets and this bound on the maximal number of subgraphs for all subgraphs of size four . All subgraphs appear signiﬁcantly less than the bound predicted by Theorem IV . 2 . For the collabora - tion network in network science , the subgraph counts Name n µ d h max σ 2 Amazon 334863 5 . 53 3 . 01 549 33 . 19 Douban 154908 4 . 22 5 . 07 287 138 . 02 DBLP 317080 6 . 62 5 . 3 343 100 . 15 PGP 10680 4 . 55 4 . 18 205 65 . 24 Yeast 1870 2 . 44 1 . 72 56 10 . 01 Gnutella31 62586 4 . 73 4 . 49 95 32 . 5 US power grid 4941 2 . 67 1 . 28 19 3 . 21 Netscience 1461 3 . 75 2 . 28 34 11 . 96 airtraﬃc 1226 4 . 27 2 . 82 37 18 . 72 TABLE I . Summary statistics of the network data . h max de - notes the maximal network degree . are the closest to the MAD - maximizer , most other sub - graphs appear signiﬁcantly less than the largest MAD bound . Thus , this ratio shows that 4 - point subgraphs in the collaboration network of network scientists are closer to maximal than in the other data sets . In Figure 6b , we now compare the number of subgraphs with the lower bound on the maximal subgraph count under ﬁxed variance instead of ﬁxed MAD that we ob - tain from Theorem V . 1 . Again , this ﬁgure plots the ratio between the actual subgraph counts and the predicted bound from Theorem V . 1 . We see that most clustered subgraphs typically appear more often than the predicted bound : the ratios signiﬁcantly exceed one for several data sets and several subgraphs . One reason for this deviation is that Thoerem V . 1 assumes that the largest degree in these networks is equal to √ µn . However , Table I shows that for all data sets , this assumption does not hold . We therefore again compare the number of subgraphs with the bounds from Theorem IV . 2 and IV . 2 , but now using h c = h max instead , where h max is the maximal degree of the data set . This yields Figure 7a , which shows that in - deed , using the correct cutoﬀ in those networks explains a large part of these large values : now almost all sub - graph counts are below the predicted maximal bounds , also for the variance - based lower bound in Figure 7b . Still , in three networks , some subgraphs appear more of - ten than the MAD - variance based maximizer . In par - ticular , this happens for the more clustered subgraphs , such as the complete graph on 4 vertices . This therefore shows that indeed , these networks are not generated by hidden - variable models , and are more clustered in terms of their numbers of complete graphs and cycles . VIII . DISCUSSION AND OUTLOOK We have established distribution - free bounds on sub - graph counts , using an optimization method that needs as input only the mean , MAD and range of the degrees . The bounds do not depend on detailed assumptions on a particular network degree distribution , and in fact hold for a wide class of degree distributions . 10 10 − 6 10 − 4 10 − 2 10 0 airtra(cid:30)cnetsciencepowergridgnutella31DBLPyeastpgpamazondouban ratio clawpathpawcyclediamondK4 ( a ) MAD - based 10 − 1 10 0 10 1 10 2 10 3 airtra(cid:30)cnetsciencepowergridgnutella31DBLPyeastpgpamazondouban ratio clawpathpawcyclediamondK4 ( b ) MAD - based with d = σ 2 / ( 2 ( √ µn − 1 ) ) FIG . 6 . Ratio of the number of subgraphs of size 4 in nine data sets and the Chung - Lu maximal value of ( 18 ) and ( 26 ) . The red line indicates the MAD maximal bound . 10 − 6 10 − 4 10 − 2 10 0 airtra(cid:30)cnetsciencepowergridgnutella31DBLPyeastpgpamazondouban ratio clawpathpawcyclediamondK4 ( a ) MAD - based 10 − 6 10 − 4 10 − 2 10 0 10 2 airtra(cid:30)cnetsciencepowergridgnutella31DBLPyeastpgpamazondouban ratio clawpathpawcyclediamondK4 ( b ) MAD - based with d = σ 2 / ( 2 ( h max − 1 ) ) FIG . 7 . Ratio of the number of subgraphs of size 4 in nine data sets and the Chung - Lu maximal value of ( 18 ) and ( 26 ) . The red line indicates the MAD maximal bound . In these plots , instead of the default choice of h c = √ µn , h c is set to h max , the largest degree of the corresponding data set . The bounds are the sharpest possible and attained by an extremal random graph with a three - point degree dis - tribution . This extremal random graph contains more subgraphs than the popular sparse graphs with power - law degree distributions with τ > 2 . For dense graphs with τ < 2 on the other hand , power - law random graphs match the subgraph bounds . This implies that dense power - law random graphs have the highest possible sub - graph counts among all possible degree distributions with the same mean and MAD . Furthermore , our bounds indeed bound the subgraph counts of nine real - world data sets , even though these data contain power - law and non power - law degree distri - butions , and are not generated by hidden - variable mod - els , demonstrating the robustness of our approach . We believe that the optimization methid in this pa - per can be employed for robust analysis of other network statistics as well , such as clustering coeﬃcients and de - gree correlations . Another avenue concerns the relation of the MAD extremal random graph to the maximal pos - sible eigenvalue of graphs with given mean degree and MAD . Cycle counts can be linked to the maximal eigen - value of the adjacency matrix [ 36 ] . Therefore , our results on bounds on the maximal number of subgraphs may also provide bounds on the maximal possible eigenvalue of a network with given average degree and MAD . Investigat - ing these eigenvalue bounds further would be an worth - while topic for further research , especially as the largest eigenvalue of an adjacency matrix is strongly linked to epidemic properties on the network [ 30 ] . While hidden - variable models have proven useful for modeling many types of networks , one of their disadvan - tages is that they often lead to locally tree - like networks with little clustering . However , this paper shows that when maximizing over all possible hidden - variable dis - tributions , they may contain more clustered subgraphs than real - world networks . Several extensions of hidden - variable models to include clustering exist , including those that add geometry , or higher - order interactions . It would be interesting to apply the MAD framework to these types of models as well . For geometric hidden - variable models , this would lead to diﬃcult optimization problems , as it contains two sources of randomness : the hidden variables and their geometric positions . Investi - gating if these generally more clustered models also lead to more clustering when maximizing over the variables is an interesting question for further research . 11 [ 1 ] B . - T . A . and E . Hochman . More bounds on the expecta - tion of a convex function of a random variable . Journal of Applied Probability , 9 ( 4 ) : 803 – 812 , dec 1972 . [ 2 ] A . Ben - Tal and E . Hochman . Approximation of expected returns and optimal decisions under uncertainty using mean and mean absolute deviation . Zeitschrift f¨ur Oper - ations Research , 29 ( 7 ) : 285 – 300 , dec 1985 . [ 3 ] S . Bhamidi , R . van der Hofstad , and J . S . H . van Leeuwaarden . Scaling limits for critical inhomogeneous random graphs with ﬁnite third moments . Electron . J . Probab . , 15 : no . 54 , 1682 – 1702 , 2010 . [ 4 ] G . Bianconi and M . Marsili . Loops of any size and hamilton cycles in random scale - free networks . Jour - nal of Statistical Mechanics : Theory and Experiment , 2005 ( 06 ) : P06005 , 2005 . [ 5 ] G . Bianconi and M . Marsili . Number of cliques in ran - dom scale - free network ensembles . Physica D : Nonlinear Phenomena , 224 ( 1 - 2 ) : 1 – 6 , 2006 . [ 6 ] M . Bogun´a , R . Pastor - Satorras , and A . Vespignani . Cut - oﬀs and ﬁnite size eﬀects in scale - free networks . The European Physical Journal B , 38 ( 2 ) : 205 – 209 , 2004 . [ 7 ] B . Bollob´as , S . Janson , and O . Riordan . The phase tran - sition in inhomogeneous random graphs . Random Struc - tures & Algorithms , 31 ( 1 ) : 3 – 122 , 2007 . [ 8 ] T . Britton , M . Deijfen , and A . Martin - L¨of . Generating simple random graphs with prescribed degree distribu - tion . J . Stat . Phys . , 124 ( 6 ) : 1377 – 1397 , 2006 . [ 9 ] A . D . Broido and A . Clauset . Scale - free networks are rare . Nature Communications , 10 ( 1 ) , mar 2019 . [ 10 ] M . Catanzaro , M . Bogu˜n´a , and R . Pastor - Satorras . Gen - eration of uncorrelated random scale - free networks . Phys . Rev . E , 71 : 027103 , Feb 2005 . [ 11 ] F . Chung and L . Lu . The average distances in random graphs with given expected degrees . Proc . Natl . Acad . Sci . USA , 99 ( 25 ) : 15879 – 15882 , 2002 . [ 12 ] A . Clauset , C . R . Shalizi , and M . E . J . Newman . Power - law distributions in empirical data . SIAM Rev . , 51 ( 4 ) : 661 – 703 , 2009 . [ 13 ] P . Colomer - de Simon and M . Bogu˜n´a . Clustering of ran - dom scale - free networks . Phys . Rev . E , 86 : 026120 , 2012 . [ 14 ] H . Ebel , L . - I . Mielsch , and S . Bornholdt . Scale - free topol - ogy of e - mail networks . Physical Review E , 66 ( 3 ) , sep 2002 . [ 15 ] W . van Eekelen , D . den Hertog , and J . S . H . van Leeuwaarden . MAD dispersion measure makes extremal queue analysis simple . arXiv : 1907 . 13019v2 , 2019 . [ 16 ] M . Faloutsos , P . Faloutsos , and C . Faloutsos . On power - law relationships of the internet topology . In ACM SIG - COMM Computer Communication Review , volume 29 , pages 251 – 262 . ACM , 1999 . [ 17 ] R . van der Hofstad , A . J . E . M . Janssen , J . S . H . van Leeuwaarden , and C . Stegehuis . Local clustering in scale - free networks with hidden variables . Phys . Rev . E , 95 ( 2 ) : 022307 , 2017 . [ 18 ] R . van der Hofstad , J . S . H . van Leeuwaarden , and C . Stegehuis . Optimal subgraph structures in scale - free conﬁguration models . The Annals of Applied Probability , 31 ( 2 ) : 501 – 537 , 2021 . [ 19 ] S . Itzkovitz , R . Milo , N . Kashtan , G . Ziv , and U . Alon . Subgraphs in random networks . Physical review E , 68 ( 2 ) : 026127 , 2003 . [ 20 ] A . J . E . M . Janssen , J . S . H . van Leeuwaarden , and S . Shneer . Counting cliques and cycles in scale - free inhomogeneous random graphs . Journal of Statistical Physics , 175 ( 1 ) : 161 – 184 , feb 2019 . [ 21 ] H . Jeong , B . Tombor , R . Albert , Z . N . Oltvai , and A . - L . Barab´asi . The large - scale organization of metabolic networks . Nature , 407 ( 6804 ) : 651 – 654 , 2000 . [ 22 ] J . Kunegis . Konect : The Koblenz network collection . In Proceedings of the 22Nd International Conference on World Wide Web , WWW ’13 Companion , pages 1343 – 1350 , New York , NY , USA , 2013 . ACM . [ 23 ] R . Milo , S . Shen - Orr , S . Itzkovitz , N . Kashtan , D . Chklovskii , and U . Alon . Network motifs : Sim - ple building blocks of complex networks . Science , 298 ( 5594 ) : 824 – 827 , 2002 . [ 24 ] S . Mossa , M . Barth´el´emy , H . E . Stanley , and L . A . N . Amaral . Truncation of power law behavior in “scale - free” network models due to information ﬁltering . Physical Review Letters , 88 ( 13 ) , mar 2002 . [ 25 ] M . E . J . Newman . The structure of scientiﬁc collabora - tion networks . Proceedings of the National Academy of Sciences , 98 ( 2 ) : 404 – 409 , jan 2001 . [ 26 ] I . Norros and H . Reittu . On a conditionally poissonian graph process . Adv . Appl . Probab . , 38 ( 01 ) : 59 – 75 , 2006 . [ 27 ] J . - P . Onnela , J . Saram¨aki , J . Kert´esz , and K . Kaski . In - tensity and coherence of motifs in weighted complex net - works . Phys . Rev . E , 71 : 065103 , 2005 . [ 28 ] M . Ostilli . Fluctuation analysis in complex networks modeled by hidden - variable models : Necessity of a large cutoﬀ in hidden - variable models . Phys . Rev . E , 89 : 022807 , Feb 2014 . [ 29 ] J . Park and M . E . J . Newman . Statistical mechanics of networks . Phys . Rev . E , 70 : 066117 , 2004 . [ 30 ] R . Pastor - Satorras , C . Castellano , P . Van Mieghem , and A . Vespignani . Epidemic processes in complex networks . Rev . Mod . Phys . , 87 : 925 – 979 , 2015 . [ 31 ] S . S . Shen - Orr , R . Milo , S . Mangan , and U . Alon . Net - work motifs in the transcriptional regulation network of escherichia coli . Nat . Genet . , 31 ( 1 ) : 64 – 68 , 2002 . [ 32 ] T . Squartini and D . Garlaschelli . Analytical maximum - likelihood method to detect patterns in real networks . New J . Phys . , 13 ( 8 ) : 083001 , 2011 . [ 33 ] C . Stegehuis . Degree correlations in scale - free ran - dom graph models . Journal of Applied Probability , 56 ( 3 ) : 672 – 700 , 2019 . [ 34 ] C . Stegehuis , R . van der Hofstad , and J . S . H . van Leeuwaarden . Variational principle for scale - free network motifs . Scientiﬁc Reports , 9 ( 1 ) : 6762 , 2019 . [ 35 ] N . H . Tran , K . P . Choi , and L . Zhang . Counting motifs in the human interactome . Nat . Commun . , 4 : 2241 , 2013 . [ 36 ] C . E . Tsourakakis . Fast counting of triangles in large real networks without counting : Algorithms and laws . In 2008 Eighth IEEE International Conference on Data Mining . IEEE , 2008 . [ 37 ] A . V´azquez , R . Pastor - Satorras , and A . Vespignani . Large - scale topological and dynamical properties of the internet . Phys . Rev . E , 65 : 066130 , 2002 . [ 38 ] I . Voitalov , P . van der Hoorn , R . van der Hofstad , and D . Krioukov . Scale - free networks well done . Physical Review Research , 1 ( 3 ) : 033034 , 2019 . 12 Appendix A : Dominating contributions in the extremal random graph We now investigate the behavior of ( 13 ) when f satis - ﬁes Assumption B . In that case , when h s = h c , E P [ N H ] = n k Aut ( H ) × (cid:88) i 1 ∈ { a , µ , h c } . . . (cid:88) i k ∈ { a , µ , h c } k (cid:89) j = 1 p i j (cid:89) { s , t } ∈ E H i s i t h 2 c r (cid:16) i s i t h 2 c (cid:17) = n k Aut ( H ) h 2 E H s × (cid:88) i 1 ∈ { a , µ , h c } . . . (cid:88) i k ∈ { a , µ , h c } k (cid:89) j = 1 p i j i d j j (cid:89) { s , t } ∈ E H r (cid:16) i s i t h 2 c (cid:17) . ( A1 ) We then show that for every vertex j , the summation over i j ∈ { a , µ , h c } is dominated by the term containing h c , so that the other terms may be ignored . Writing out this sum over i j ∈ { a , µ , h c } and plugging in ( 10 ) gives (cid:88) i j ∈ { a , µ , h c } p i j i d j j (cid:89) { j , t } ∈ E H r (cid:16) i j i t h 2 c (cid:17) = d 2 ( µ − a ) a d j (cid:89) { j , t } ∈ E H r (cid:16) ai t h 2 c (cid:17) + (cid:16) 1 − d 2 ( µ − a ) − d 2 ( h c − µ ) (cid:17) µ d j (cid:89) { j , t } ∈ E H r (cid:16) µi t h 2 c (cid:17) + d 2 ( h c − µ ) h d j c (cid:89) { j , t } ∈ E H r (cid:16) i t h c (cid:17) . ( A2 ) This is an equation with three terms . We now investigate the scaling of these three terms in n , and show that the last term , containing h c , dominates . Indeed , for the ﬁrst two terms we obtain d 2 ( µ − a ) a d j (cid:89) { j , t } ∈ E H r (cid:16) ai t h 2 c (cid:17) = O ( 1 ) ( A3 ) and (cid:16) 1 − d 2 ( µ − a ) − d 2 ( h c − µ ) (cid:17) µ d j (cid:89) { j , t } ∈ E H r (cid:16) µi t h 2 c (cid:17) = O ( 1 ) , ( A4 ) as r ( x ) ≤ 1 under Assumption B . We now show that the third term on the other hand , grows in n . There we obtain d 2 ( h c − µ ) h d j c (cid:89) { j , t } ∈ E H r (cid:16) i t h c (cid:17) ∼ dh d j − 1 c 2 . ( A5 ) Indeed , as h c → ∞ and h c (cid:29) µ , ( h c − µ ) ∼ h c . Further - more , by our assumptions on r ( x ) , r ( c / h s ) = 1 + o ( 1 ) , while r ( 1 ) is constant , so that the product term does not contribute to the scaling . Thus , when d j ≥ 2 , the con - tribution to ( A1 ) from i j = h c grows in n , and therefore dominates the contributions from i j = a , µ . Therefore , for subgraphs with minimal degree at least 2 , we can ignore the terms in ( A1 ) with i j = a or i j = µ , yielding E P [ N H ] ∼ n k Aut ( H ) h 2 E H s k (cid:89) j = 1 d 2 ( h c − µ ) h d j c (cid:89) { s , t } ∈ E H r ( 1 ) = n k d k h 2 E H − k c h 2 E H c 2 k Aut ( H ) r ( 1 ) E H . ( A6 ) When d j = 1 , all contributions in ( A3 ) - ( A5 ) have con - stant order of magnitude in n . Therefore , for those ver - tices , all terms in the summations in ( A1 ) have to be included , which gives E P [ N H ] ∼ n k Aut ( H ) h 2 E H c (cid:89) j : d j ≥ 2 d 2 h c h d j c × (cid:89) j : d j = 1 (cid:18) dh c 2 h c r ( 1 ) + (cid:16) 1 − d 2 ( µ − a ) (cid:17) µ + da 2 ( µ − a ) (cid:19) × (cid:89) { s , t } : d s , d t ≥ 1 ∈ E H r ( 1 ) = n k d n − n 1 h 2 E H − k c Aut ( H ) h 2 E H c 2 n − n 1 (cid:18) d 2 ( r ( 1 ) − 1 ) + µ (cid:19) n 1 r ( 1 ) E H − n 1 . ( A7 ) Taken together , we obtain Theorem IV . 2 . Appendix B : Dominating contribution for diminishing d We start from ( A2 ) , and assume that σ 2 / h c → 0 . Again , we investigate which of the three terms in the summation over a , µ , h c dominates . We therefore inves - tigate the scaling in n of all three terms , and start with the terms containing a and µ . Because r ( x ) ≤ 1 under Assumption B , d 2 ( µ − a ) a d j (cid:89) { j , t } ∈ E H r (cid:16) ai t h 2 c (cid:17) = O (cid:18) σ 2 h c (cid:19) ( B1 ) and again (cid:16) 1 − d 2 ( µ − a ) − d 2 ( h c − µ ) (cid:17) µ d j (cid:89) { j , t } ∈ E H r (cid:16) µi t h 2 c (cid:17) = O ( 1 ) . ( B2 ) We now turn to the term containing h c . Because h c → ∞ and r ( x ) is continuous , we have that r ( 0 ) = 1 , r ( c / h s ) = 1 + o ( 1 ) , while r ( 1 ) is constant . Therefore , d 2 ( h c − µ ) h d j c (cid:89) { j , t } ∈ E H r (cid:16) i t h c (cid:17) = Θ (cid:0) σ 2 h d j − 2 c (cid:1) . ( B3 ) 13 This shows that when d j ≥ 3 , the contribution to ( 14 ) from i j = h c dominates the contributions from i j = a , µ . On the other hand , when d j = 2 , the contribution from i j = h c and from i j = µ have the same order of mag - nitude . Finally , when d j = 1 , the contribution to ( 14 ) from i j = µ dominates the other contributions . Using that r ( µ 2 / h 2 c ) = 1 + o ( 1 ) and r ( µ / h c ) = 1 + o ( 1 ) , ( 14 ) becomes E P [ N H ] ∼ n k r ( 1 ) E ≥ 3 , ≥ 3 Aut ( H ) h 2 E H c (cid:89) j : d j ≥ 3 σ 2 h 2 c h d j c × (cid:89) j : d j = 2 (cid:0) σ 2 r ( 1 ) n j , ≥ 3 + µ 2 (cid:1) (cid:89) j : d j = 1 µ = n k r ( 1 ) E ≥ 3 , ≥ 3 Aut ( H ) h 2 E H c (cid:0) σ 2 r ( 1 ) + µ 2 (cid:1) n 2 , 1 (cid:0) σ 2 r ( 1 ) 2 + µ 2 (cid:1) n 2 − n 2 , 1 × µ n 1 σ 2 n ≥ 3 h (cid:80) j : dj ≥ 2 ( d j − 2 ) c = n k h 2 E H − 2 k + n 1 c r ( 1 ) E ≥ 3 , ≥ 3 Aut ( H ) h 2 E H c (cid:0) σ 2 r ( 1 ) + µ 2 (cid:1) n 2 , 1 × (cid:0) σ 2 r ( 1 ) 2 + µ 2 (cid:1) n 2 − n 2 , 1 µ n 1 σ 2 n ≥ 3 ( 1 + o ( 1 ) ) , ( B4 ) where n i and n ≥ i denote the number of vertices of de - gree i or degree at least i in H , and E ≥ 3 , ≥ 3 denotes the number of edges between vertices of degree at least 3 in H . Appendix C : Ordering of subgraphs of size 5 14 ( a ) 1 / 120 ( b ) 1 / 24 ( c ) 1 / 12 ( d ) 1 / 12 ( e ) 1 / 10 ( f ) 1 / 8 ( g ) 1 / 4 ( h ) 1 / 4 ( i ) 1 / 4 ( j ) 1 / 2 ( k ) 1 / 2 ( l ) c / 6 ( m ) c / 2 ( n ) c / 2 ( o ) c / 2 ( p ) c / 2 ( q ) c 2 / 2 ( r ) c 2 / 2 ( s ) c 2 / 4 ( t ) c 3 / 2 ( u ) c 4 / 24 FIG . 8 . The leading constant c n 1 / Aut ( H ) for the maximal scaling of the number of subgraphs in n for all subgraphs on 5 vertices , where c = 2 µ / d .
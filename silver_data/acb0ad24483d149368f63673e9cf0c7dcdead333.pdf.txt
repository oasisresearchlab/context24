nature | methods Fast , single - molecule localization that achieves theoretically minimum uncertainty Carlas S Smith , Nikolai Joseph , Bernd Rieger & Keith A Lidke Supplementary figures and text : Supplementary Figure 1 Fits to the astigmatic model of the PSF on beads . Supplementary Figure 2 Fits to the astigmatic model on synthetic data . Supplementary Figure 3 The standard deviation of found z - positions . Supplementary Figure 4 Estimated z - positions versus piezo stage z - position . Supplementary Figure 5 Images of simulated single molecules with emission and background rates ( in photons ) that corresponds with σ PSF / 2 Supplementary Figure 6 Localization accuracy versus fit region size . Supplementary Figure 7 Convergence speed of the iterative method . Supplementary Figure 8 Analysis of 2D single molecule experiments . Supplementary Table 1 Comparison of total processing time for CPU and GPU . Supplementary Note 1 Supplementary Data Note : Supplementary Software 1 is available on the Nature Methods website . Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 1 −0 . 5 −0 . 4 −0 . 3 −0 . 2 −0 . 1 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 1 1 . 5 2 2 . 5 σ ( P i x e l s ) z−position ( microns ) σ x σ y fit σ x fit σ x Supplementary Figure 1 . Fitting σ x ( z ) and σ y ( z ) to the astigmatic model of the PSF . Beads were used as calibration markers which were moved in steps of 50 nm by a piezo stage . 1 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 2 −0 . 5 −0 . 4 −0 . 3 −0 . 2 −0 . 1 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 5 10 15 20 25 30 35 40 45 50 σ ( n m ) z−position ( microns ) σ z CRLB σ z CRLB reported σ z found Supplementary Figure 2 . Simultaneous ﬁts to x , y , z , the emission and background rates synthetic data . Shown is only the precision in z . The reported values of the CRLB of the algorithm are shown as circles whereas the found standard deviation is indicated with crosses . 2 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 3 −0 . 5 −0 . 4 −0 . 3 −0 . 2 −0 . 1 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 5 10 15 20 25 30 35 40 45 50 σ ( n m ) z−position ( microns ) σ z CRLB reported σ z found Supplementary Figure 3 . The standard deviation of found z - positions . Found standard deviations do not match that reported from CRLB calculations because of aberrations present in experimental images that are not accounted for in the imaging model . 3 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 4 −0 . 5 0 0 . 5 −0 . 5 −0 . 4 −0 . 3 −0 . 2 −0 . 1 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 f ound z − po s i t i on ( m i c r on s ) stage z−position ( microns ) foundstage position Supplementary Figure 4 . Experimental bead data . Estimated z - positions versus piezo stage z position . The line has slope one . 4 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 5 Supplementary Figure 5 . Example images of simulated single molecules with emission and background rates ( in photons ) that corresponds with the σ PSF / 2 border . Here the iterative method is still able to both estimate the CRLB and ﬁnd the position with CRLB accuracy . We show a 7 × 7 area with σ PSF = 1 . From left to right : background rates 0 , 1 and 10 . The shown photon counts are 10 , 30 and 50 . 5 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 6 0 2 4 6 8 10 12 14 16 18 20 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 1 . 4 1 . 6 1 . 8 2 Iterations N o r m a li z ed V a l ue < x known −x found > + 1 ( Pixels ) Emission Rate ( found / expected ) Background ( found / expected ) Supplementary Figure 6 . Convergence of the Iterative Method . The convergence of position ( red ) intensity ( green ) and background rate ( blue ) to known , correct values are shown . Calculation were made using σ PSF = 3 and a square ﬁtting region of linear size and 2 × 3 σ PSF + 1 = 19 , which represents the slowest convergence of any combination of σ PSF and box size used . 6 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 7 4 6 8 10 12 14 16 18 20 22 24 10 −2 10 −1 10 0 Box Size ( Pixels ) σ x ( P i x e l s ) σ = 1 ( CRLB ) σ = 2 ( CRLB ) σ = 3 ( CRLB ) σ = 1 ( GPU Fit ) σ = 2 ( GPU Fit ) σ = 3 ( GPU Fit ) 2 × 3 σ + 1 Supplementary Figure 7 . Localization Accuracy versus Fit Region Size . The best localization accuracy is calculated using the CRLB and compared to the standard deviation of x - position error in simulated data stacks for I 0 = 1000 and bg = 0 . The improvement of localization accuracy diminishes beyond a linear box size of ( 2 × 3 σ + 1 ) . 7 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Figure 8 100 200 300 400 500 600 700 800 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 Intensity ( Average Total Photons / Frame ) Lo c a li z a t i on A cc u r a cy ( P i x e l s ) Found σ x Mean Reported σ x Supplementary Figure 8 . Analysis of Single Molecule Experiments . The standard deviation of the x - positions found in repeated measurements of single , immobilized Cy5 molecules ( green ) are compared with the average accuracy calculated frame by frame using the CRLB ( red ) . Found background rates ( not shown ) vary between single molecules giving a range of possible localization accuracy values for each intensity . 8 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Table 1 Processor Total Time Segmentation ROI collection Fitting Reconstruction 10 4 frames , 10 5 localizations GPU 8 . 8 s 90 % 1 % 8 . 5 % 0 . 5 % CPU 41 s 19 . 4 % 0 . 2 % 80 . 3 % 0 . 1 % 10 4 frames , 10 6 localizations GPU 14 s 57 . 8 % 2 . 7 % 38 . 9 % 0 . 6 % CPU 300 s 2 . 8 % 0 . 1 % 97 % 0 . 1 % Supplementary Table 1 . Comparison of total processing time for 10 , 000 frames of 128x128 pixels . Fitting corre - sponds to σ PSF = 1 and 7 × 7 pixel ﬁtting areas . 9 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Supplementary Note The Image Formation Model In the paraxial limit , the microscope point spread function ( PSF ) can be taken as the Airy pattern PSF ( r ) = J 1 ( αr ) 2 ( αr ) 2 , where α = 2 π NA λ and J 1 is the Bessel function of ﬁrst kind . However , in ﬂuorescence microscopy , objective lenses with numerical apertures ( NAs ) of 1 . 2 or greater are most often used when imaging single ﬂuorescent molecules in order to collect as many emitted photons as possible ; the collection efﬁciency is ∝ ( 1 − cos θ ) , where θ is related the NA by NA = n sin θ . A proper calculation of PSFs for these high NA objectives must include vectorial effects , aberrations in the optical system and apodization in the objective lens [ 1 , 2 ] . In lieu of such a detailed measurement and description of the PSF , often a two - dimensional Gaussian shape is used as a compact and good expression of the PSF [ 3 ] . We use the two - dimensional Gaussian approximation of the PSF to greatly simplify the proceeding analysis . This also holds for extension to 3D confocal laser scanning PSFs [ 3 ] . The simpliﬁed form of the PSF is then PSF ( x , y ) = 1 2 πσ 2 e − ( x − θx ) 2 − ( y − θy ) 2 2 σ 2 , ( 1 ) where θ x , y is the position of the emitter . PSF approximations also often neglect the ﬁnite size of the detector pixels . In this work , the imaging model , denoted by µ k ( x , y ) , will always include the integration over ﬁnite pixels which is given by : µ k ( x , y ) = θ I 0 (cid:90) A k PSF ( u , v ) d u d v + θ bg , ( 2 ) where µ k ( x , y ) denotes the expected value in the k th pixel , θ bg the expected background count , θ I 0 the expected photon count and the integral is over the ﬁnite area A k of the k th pixel , which is centered at ( x , y ) . The Gaussian approximation allows the results to be expressed in terms of error functions ( which simplify the implementation as they are supported in CUDA [ 4 ] ) . If we assume uniform pixels with unit size , the imaging model is given as : µ k ( x , y ) = θ I 0 ∆E x ( x , y ) ∆E y ( x , y ) + θ bg , ( 3 ) where the expressions ∆E x ( x , y ) ≡ 1 2erf (cid:18) x − θ x + 12 2 σ 2 (cid:19) − 1 2erf (cid:18) x − θ x − 12 2 σ 2 (cid:19) , ( 4a ) ∆E y ( x , y ) ≡ 1 2erf (cid:18) y − θ y + 12 2 σ 2 (cid:19) − 1 2erf (cid:18) y − θ y − 12 2 σ 2 (cid:19) , ( 4b ) are used to shorten notation . The Gaussian standard deviation , σ , is determined in practice by ﬁtting to images of small beads or single molecules under the operating conditions of the microscope . It can also be computed directly from a theoretical PSF and its FHWM [ 3 ] . Eq . 3 will be used as the imaging model for the parameter estimation in the following . Cram´er Rao Lower Bound The Cram´er Rao Lower Bound ( CRLB ) is the limiting lower bound of the variance for any unbiased parameter esti - mator [ 5 ] . The general expression for the CRLB is given by the inverse of the Fisher information matrix var ( ˆ θ ) ≥ I ( θ ) − 1 , ( 5 ) where var ( ˆ θ ) is the variance of an estimator and I ( θ ) is the Fisher information matrix . The equal sign is the minimum of that estimation and is referred to as the CRLB . 10 Nature Methods : doi : 10 . 1038 / nmeth . 1449 The Fisher Information Matrix for the imaging model µ The elements of the Fisher information matrix are given by the expectation of the log - likelihood : I ij ( θ ) = E (cid:20) ∂ ln ( L ( (cid:126)x | θ ) ) ∂θ i ∂ ln ( L ( (cid:126)x | θ ) ) ∂θ j (cid:21) , ( 6 ) where θ is the set of parameters being estimated θ = [ θ 1 . . . θ N ] and L ( (cid:126)x | θ ) is the likelihood of the data set (cid:126)x given the model generated by θ . Here the parameters are θ = [ θ x , θ y , θ I 0 , θ bg ] . For a Poisson process the likelihood is given by L ( (cid:126)x | θ ) = (cid:89) k µ k ( x , y ) x k e − µ k ( x , y ) x k ! . ( 7 ) Using Eq . 6 , Eq . 7 and the Stirling approximation ( ln n ! ≈ n ln n − n for large n ) it is straightforward to show that I ij ( θ ) = E (cid:34)(cid:88) k ( x k − µ k ( x , y ) ) 2 1 µ k ( x , y ) 2 ∂µ k ( x , y ) ∂θ i ∂µ k ( x , y ) ∂θ j (cid:35) . ( 8 ) Using the fact that ( x k − µ k ( x , y ) ) 2 is the variance and equal to the expected value for a Poisson process , we obtain I ij ( θ ) = (cid:88) k 1 µ k ( x , y ) ∂µ k ( x , y ) ∂θ i ∂µ k ( x , y ) ∂θ j . ( 9 ) The partial derivatives with respect to the parameters are given by ∂µ k ( x , y ) ∂θ x = θ I 0 2 σ 2 (cid:90) A k ( θ x − u ) PSF ( u , v ) d u d v ( 10a ) ∂µ k ( x , y ) ∂θ y = θ I 0 2 σ 2 (cid:90) A k ( θ y − v ) PSF ( u , v ) d u d v ( 10b ) ∂µ k ( x , y ) ∂θ I 0 = (cid:90) A k PSF ( u , v ) d u d v ( 10c ) ∂µ k ( x , y ) ∂θ bg = 1 , ( 10d ) which upon performing the integration become ∂µ k ( x , y ) ∂θ x = θ I 0 √ 2 πσ (cid:18) e − ( xk − θx − 12 ) 2 2 σ 2 − e − ( xk − θx + 12 ) 2 2 σ 2 (cid:19) ∆E y ( x , y ) ( 11a ) ∂µ k ( x , y ) ∂θ y = θ I 0 √ 2 πσ (cid:18) e − ( yk − θ y − 1 2 ) 2 2 σ 2 − e − ( yk − θ y + 1 2 ) 2 2 σ 2 (cid:19) ∆E x ( x , y ) ( 11b ) ∂µ k ( x , y ) ∂θ I 0 = ∆E x ( x , y ) ∆E y ( x , y ) ( 11c ) ∂µ k ( x , y ) ∂θ bg = 1 . ( 11d ) Note that Eq . 9 is general , whereas the Gaussian PSF model allows the simple expressions in Eqs . 10 and 11 . Simul - taneous ﬁtting of the position , intensity and background leads to off - diagonal elements in I ( θ ) . The CRLBs for the estimation of θ are equal to the diagonal elements of the matrix inversion of I ( θ ) , i . e . var ( θ i ) = ( I − 1 ) ii . 11 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Iterative Method We employ essentially a Newton - Raphson method [ 6 ] to ﬁnd the parameters θ that maximize ln ( L ( (cid:126)x | θ ) ) . This is equal to the maximum likelihood estimate of the parameters θ ML = arg max θ L ( (cid:126)x | θ ) . The derivatives required for the iterative updates are calculated in a straightforward manner from Eq . 7 ∂ ln ( L ( (cid:126)x | θ ) ) ∂θ i = (cid:88) k ∂µ k ( x , y ) ∂θ i (cid:18) x k µ k ( x , y ) − 1 (cid:19) . ( 12 ) Given an adequate guess of starting parameters , the parameters are updated according to : θ i → θ i + (cid:34)(cid:88) k ∂µ k ( x , y ) ∂θ i ( x k µ k ( x , y ) − 1 ) (cid:35) × (cid:34)(cid:88) k ∂ 2 µ k ( x , y ) ∂θ 2 i ( x k µ k ( x , y ) − 1 ) − ∂µ k ( x , y ) ∂θ i 2 x k µ k ( x , y ) 2 (cid:35) − 1 . ( 13 ) The ﬁrst derivatives are given in the previous section , ( see Eqs 11 ) and the second derivatives are given by ∂ 2 µ k ( x , y ) ∂θ 2 x = θ I 0 √ 2 πσ 3 (cid:18) ( x k − θ x − 1 2 ) e − ( xk − θx − 12 ) 2 2 σ 2 − ( x k − θ x + 1 2 ) e − ( xk − θx + 12 ) 2 2 σ 2 (cid:19) ∆E y ( x , y ) , ( 14a ) ∂ 2 µ k ( x , y ) ∂θ 2 y = θ I 0 √ 2 πσ 3 (cid:18) ( y k − θ y − 1 2 ) e − ( yk − θy − 12 ) 2 2 σ 2 − ( y k − θ y + 1 2 ) e − ( yk − θy + 12 ) 2 2 σ 2 (cid:19) ∆E x ( x , y ) , ( 14b ) ∂ 2 µ k ( x , y ) ∂θ 2 θ I 0 = ∂ 2 µ k ( x , y ) ∂θ 2 bg = 0 . ( 14c ) Extension to 3D Astigmatic Imaging Following Holtzer [ 7 ] and using σ 0 as usual the PSF near focus can be described by a 2D Gaussian with a z - dependent standard deviation σ ( z ) = σ 0 (cid:114) 1 + z 2 d 2 + Az 3 d 2 + B z 4 d 2 , ( 15 ) where σ 0 is the in focus standard deviation , d is the depth of focus ( a constant for a particular objective ) , A and B are empirical constants ( B ≈ 0 for our experiments , see Results ) . Introducing an elliptical lens in the beam path splits the focal plane into two perpendicular focal planes at different depth giving an asymmetric PSF . The form of the PSF on the detector is then approximated by PSF ( x , y ) = 1 2 πσ x ( θ z ) σ y ( θ z ) e − ( x − θx ) 2 2 σ x ( θ z ) 2 − ( y − θy ) 2 2 σ y ( θ z ) 2 , ( 16 ) where θ x , y , z is the position of the emitter . Half way between the two focal planes we have ( assuming Gaussian optics at the disk of least confusion ) σ x = σ y and σ x , σ y ≥ σ 0 ; here we deﬁne z = 0 . Focal planes for each direction are above and below z = 0 . Assuming the x - direction is focused above and using Eq . 15 , z → z − γ for the x - direction , z → z + γ for the y - direction σ x ( z ) = σ 0 x (cid:114) 1 + ( z − γ ) 2 d 2 + A x ( z − γ ) 3 d 2 + B x ( z − γ ) 4 d 2 , ( 17a ) σ y ( z ) = σ 0 y (cid:114) 1 + ( z + γ ) 2 d 2 + A y ( z + γ ) 3 d 2 + B y ( z + γ ) 4 d 2 . ( 17b ) 12 Nature Methods : doi : 10 . 1038 / nmeth . 1449 The x , y - directions have the same form so we continue only with y . Eq . 13 requires the ﬁrst and second derivatives ∂µ ( x k , y k ) ∂θ z and ∂ 2 µ ( x k , y k ) ∂θ 2 z to ﬁt the z position . These are calculated from ∂µ ( x k , y k ) ∂θ z = ∂µ ∂σ x ∂σ x ∂θ z + ∂µ ∂σ y ∂σ y ∂θ z , ( 18a ) ∂ 2 µ ( x k , y k ) ∂θ 2 z = ∂ 2 µ ∂σ 2 x (cid:18) ∂σ x ∂θ z (cid:19) 2 + ∂µ ∂σ x ∂ 2 σ x ∂θ 2 z ( 18b ) + ∂ 2 µ ∂σ 2 y (cid:18) ∂σ y ∂θ z (cid:19) 2 + ∂µ ∂σ y ∂ 2 σ y ∂θ 2 z . ( 18c ) The ﬁrst and second derivatives σ y to θ z are given by ∂σ y ∂θ z = σ 0 ( 2 zd 2 + A 3 z 2 d 2 + B 4 z 3 d 2 ) 2 (cid:113) 1 + z 2 d 2 + A z 3 d 2 + B z 4 d 2 , ( 19a ) ∂ 2 σ y ∂θ 2 z = σ 0 ( 2 d 2 + A 6 zd 2 + B 12 z 2 d 2 ) 2 (cid:113) 1 + z 2 d 2 + A z 3 d 2 + B z 4 d 2 − σ 0 ( 2 zd 2 + A 3 z 2 d 2 + B 4 z 3 d 2 ) 2 4 ( 1 + z 2 d 2 + A z 3 d 2 + B z 4 d 2 ) 3 2 . ( 19b ) It does not matter for the result of the differentiation if the substitution z → z ± γ is done before or after , so ∂ 2 σ x , y ∂θ 2 z is obtained by substituting z → z ± γ in the derivatives Eqs . 19b . Using the expressions G nmx ( x k ) ≡ 1 √ 2 πσ x ( θ z ) n (cid:32) ( x k − θ x − 1 2 ) m e − ( xk − θx − 12 ) 2 2 σx ( θz ) 2 − ( x k − θ y + 1 2 ) m e − ( xk − θy + 12 ) 2 2 σx ( θz ) 2 (cid:33) ( 20a ) G nmy ( y k ) ≡ 1 √ 2 πσ y ( θ z ) n (cid:32) ( y k − θ y − 1 2 ) m e − ( yk − θy − 12 ) 2 2 σy ( θz ) 2 − ( y k − θ y + 1 2 ) m e − ( yk − θy + 12 ) 2 2 σy ( θz ) 2 (cid:33) ( 20b ) to shorten notation , we obtain for the derivatives of µ to σ y ∂µ ( x k , y k ) ∂σ y = θ I 0 ∆E x ( x k ) G 21y ( y k ) , ( 21a ) ∂ 2 µ ( x k , y k ) ∂σ 2 y = θ I 0 ∆E x ( x k ) ( G 53y ( y k ) − 2G 31y ( y k ) ) . ( 21b ) Supplementary Data Performance on Synthetic Data Sets Supplementary Fig . 7 shows the CRLB determined best accuracy as a function of a linear box size as well as the results from GPU ﬁts . The results suggest a ’rule of thumb’ ﬁtting region size of 2 × 3 σ + 1 , which gives near optimal results while keeping computational time down and reducing the probability of including nearby emitters in the ﬁtted region . All further results are shown with ﬁts using this box size . This limit is a direct consequence of the fact that 99 % of the volume of a Gaussian is enclosed within 3 σ . Increasing the box size effectively only includes more background . Supplementary Fig . 6 shows the convergence of the iterative algorithm for x - position , background and ﬂuo - rophore intensity . The position estimate converges quickly , whereas the background and ﬂuorophore rates , which are required for calculating the localization accuracy require nearly 10 iterations . The shown example is for σ PSF = 3 and a box size of 19 , which was found to require the most iterations for convergence of all parameter combinations . All subsequent analyses shown were the result of 10 iterations , independent of σ PSF or ﬁt region size . In Supplementary Fig . 5 we show example images of simulated single molecules with emission and background rates ( in photons ) that corresponds with the σ PSF / 2 as discussed in the main text . We ﬁnd that in all conditions , when the reported CRLB is less than σ PSF / 2 ( here 0 . 5 ) , the reported CRLB matches the theoretical position , and the routine achieves the CRLB . 13 Nature Methods : doi : 10 . 1038 / nmeth . 1449 Performance on Experimental Single Molecule Data 2D Imaging Imaging of single Cy5 ﬂuorescent molecules was used to demonstrate the performance of the iterative method under typical single molecule imaging conditions . Since the position , intensity and background rate were not known a - priori , we analyzed a set of single molecules that had a steady emission rate over at least one hundred continuous frames . The found standard deviation of the x - position was compared to the mean value of the reported x - dimension localization accuracy , which is calculated for each image that made up a single particle ’trajectory’ . As can be seen in Supplementary Fig . 8 , the reported accuracy gives a good estimate of the actual localization accuracy over a wide range of ﬂuorophore intensities . The results also demonstrate that the Gaussian PSF and pure Poisson noise model with neglection of read noise are appropriate approximations for single molecule localization in two dimensions . 3D Astigmatic Imaging With the found ﬁt parameters on the calibration set ( Methods , Astigmatic Imaging Section ) a synthetic data series was generated using 1000 expected photons per frame for the ﬂuorophore , and one expected background count per pixel per frame . 1000 frames for each z - position were generated and analyzed . Supplementary Fig . 2 shows the ﬁtting result of the iterative algorithm , which performs a simultaneous ﬁt to x , y , z , and the emission and background rates . The z - position ﬁts both achieve the CRLB value and the CRLB is correctly reported . For ﬁts that include z - position estimates , 20 iterations of the routine were required for convergence . An analysis of the experimental bead data is shown in Supplementary Fig . 3 and 4 . In contrast to ﬁtting simulated 3D data , and all 2D data , the ﬁtting of experimental data does not reach the CRLB . This is attributed to the fact for the CRLB to be justiﬁed , the model must be correct . In 3D imaging , the out - of - focus images are more prone to shape changes of the PSF due to aberrations such as coma and spherical aberration . Therefore , these images do not exactly match the simple astigmatic model . We note , however , that our algorithm does perform a fast MLE given this model , and , as shown with analysis of simulated data , if aberrations can by minimized or eliminated , our routine will also correctly report z - position accuracies . Small amounts of spherical aberration already give rise to a small asymmetry between the two focal lines . Misalignment of the cylinder lens by ∆ x with respect to optical axis of the tube lens has the effect of a shift of the center of mass of the spot and will result in two different σ 0 ﬁts for x and y as observed in Supplementary Fig . 1 . The focal line along the cylinder axis is then displaced by ∼ ( f tub / f cyl ) ∆ x = ( 180 / 500 ) ∆ x = 0 . 36∆ x which translates to a shift of ∼ 1 / 3 pixel at a ∆ x = 10 µ m and a CCD pixel size of 10 µ m . If aberrations cannot be sufﬁciently reduced and alignment manually adjusted by a micrometer screw , optimal position precision may require ﬁtting to a measured PSF [ 8 ] , at the expense of speed . References [ 1 ] Hanser , B . M . , Gustafsson , M . G . L . , Agard , D . A . & Sedat , J . W . Phase - retrieved pupil functions in wide - ﬁeld ﬂuorescence microscopy . Journal of Microscopy - Oxford 216 , 32 – 48 ( 2004 ) . [ 2 ] Sch¨onle , A . & Hell , S . Calculation of vectorial three - dimensional transfer functions in large angle focusing systems . Journal of the Optical Society of America A 19 , 2121 – 2126 ( 2002 ) . [ 3 ] Zhang , B . , Zerubia , J . & Olivo - Marin , J . C . Gaussian approximations of ﬂuorescence microscope point - spread function models . Applied Optics 46 , 1819 – 1829 ( 2007 ) . [ 4 ] NVIDIA . Compute uniﬁed device architecture ( cuda ) ( 2007 ) . http : / / www . nvidia . com . [ 5 ] Kay , S . M . Fundamentals of statistical signal processing : estimation theory ( Prentice - Hall , 1993 ) . [ 6 ] Press , W . , Teukolsky , S . , Vetterling , W . & Flannery , B . Numerical Recipes in C : The Art of Scientiﬁc Computing ( Cambridge University Press , Cambridge , 1992 ) , 2 edn . [ 7 ] Holtzer , L . , Meckel , T . & Schmidt , T . Nanometric three - dimensional tracking of individual quantum dots in cells . Applied Physics Letters 90 , 1 – 3 ( 2007 ) . [ 8 ] Mlodzianoski , M . J . , Juette , M . F . , Beane , G . L . & Bewersdorf , J . Experimental characterization of 3d localization techniques for particle - tracking and super - resolution microscopy . Optics Express 17 , 8264 – 8277 ( 2009 ) . 14 Nature Methods : doi : 10 . 1038 / nmeth . 1449
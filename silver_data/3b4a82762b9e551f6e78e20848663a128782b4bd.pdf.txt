Likelihood - based inference for partially observed stochastic epidemics with individual heterogeneity Fan Bu ∗1 , Allison E . Aiello 2 , Alexander Volfovsky 1 † k , and Jason Xu 1 † 1 Department of Statistical Science , Duke University 2 Gillings School of Global Public Health , University of North Carolina , Chapel Hill † Joint last authors ; k Corresponding author . Abstract We develop a stochastic epidemic model progressing over dynamic networks , where infection rates are heterogeneous and may vary with individual - level covariates . The joint dynamics are modeled as a continuous - time Markov chain such that disease transmission is constrained by the contact network structure , and network evolution is in turn inﬂuenced by individual disease statuses . To accommodate partial epidemic observations commonly seen in real - world data , we propose a likelihood - based inference method based on the stochastic EM algorithm , introducing key innovations that include eﬃcient conditional samplers for imputing missing infection and recovery times which respect the dynamic contact network . Experiments on both synthetic and real datasets demonstrate that our inference method can accurately and eﬃciently recover model parameters and provide valuable insight at the presence of unobserved disease episodes in epidemic data . 1 Introduction Modern epidemiological studies seek to understand disease dynamics , evaluate intervention strategies and diﬀerentiate between population level and individual level eﬀects . A tradi - tional approach to the modeling of infectious disease relies on mechanistic compartmental models , where only the summary of disease statuses of individuals in the population plays a role in understanding the disease dynamics . Examples of such mechanistic compartmental models abound in the epidemiology and mathematical biology literature , e . g . the susceptible - infectious - recovered ( SIR ) model ( Kermack and McKendrick , 1927 ) . The majority of these simplify disease transmission to a population level event — as such these models are posed to answer population level questions about disease outbreaks ( e . g . , “will the outbreak end ? ” ) , but cannot resolve those at the individual level ( e . g . , “what is my risk of infection ? ” ) . This is exempliﬁed by the “random mixing” assumption that underpins many of these models . Under this assumption any infectious individual can transmit the disease to any other susceptible individual with equal chances . However , it is clear that the contact network of individuals plays an integral role in disease transmission and that interventions on individual behavior ∗ Now at Department of Human Genetics , University of California , Los Angeles . Partially supported by DMS - 2030355 , DMS - 2046880 , NIH 1R01EB025021 . 1 a r X i v : 2112 . 07892v1 [ s t a t . M E ] 15 D ec 2021 can change the overall dynamics of an outbreak ( Eames and Keeling , 2003 ; Kiss et al . , 2006 ; Lunz et al . , 2021 ) . The literature on epidemics diﬀusing through networks has been greatly bolstered during the SARS - COV - 2 pandemic , and a myriad of mechanistic models attempting to capture both the network and disease characteristics have been proposed ( Ferguson et al . , 2020 ; Cencetti et al . , 2020 ; Nielsen et al . , 2021 ; Small and Cavanagh , 2020 ; Skums et al . , 2020 ; Lee et al . , 2020 ; Soriano - Arandes et al . , 2021 ) . While a number of these make use of available mobility data collected through powered mobile devices , they still largely operate on the population level with disease dynamics considered at the county or zip - code level . At the same time , high - resolution data collected at the individual level are becoming available , requiring new model development . For example , in Figure 1 we plot the transmission and interaction dynamics of individuals on a college campus , a snippet from the eX - FLU data we analyze in detail in Section 6 . 2 . A number of approaches to individual - level modeling have been introduced in the literature . Several papers have introduced a graph - coupled Hidden Markov Model to account for changes in the infectiousness state of individuals ( Dong et al . , 2012 ; Fan et al . , 2015 , 2016 ) , and there have been developments in agent - based disease transmission models that consider covariates associated with infections ( Touloupou et al . , 2020 ; Ju et al . , 2021 ) . Such individual - level inference is very computationally challenging and becomes intractable for even moderately sized datasets with few predictors of interest . Bu et al . ( 2020 ) introduced an individual level framework for stochastic epidemic processes , where contact information about infections and individual - to - individual interactions are nearly - completely observed . Speciﬁcally , the proposed approach introduced an exact sampler when exact recovery times are unobserved that relies on fully observing the infection times , building on earlier versions of individual - level stochastic models that do not model the network ( Auranen et al . , 2000 ; Cauchemez et al . , 2006 ; Hoti et al . , 2009 ; Britton , 2010 ) . We note that many of these prior approaches assume that the epidemic process is fully and exactly observed , so inference may proceed via the likelihood of the complete data . However , available epidemic data typically only provide a partial view on exposure , infection and recov - ery times — the exposure time is often “latent” because of the incubation or latency period , and infection and recovery times are often not fully kept track of due to limited resolution of data collection or failure of follow - up . Even in considerably rich and high - throughput modern datasets such as the eX - FLU study that we analyze in this paper ( Aiello et al . , 2016 ) , the true exposure times are not observed even though infections can be inferred via daily symptom reporting , and the exact recovery times are not available because only weekly updates were obtained for inﬂuenza recoveries . Recent work carries out inference from partial epidemic data using the marginal likelihood under simpler SIR or SIS models ( Ho et al . , 2018 , ? ; Ju et al . , 2021 ) , but the techniques are computationally intensive and diﬃcult to extend to account for the factors ( e . g . , the contact network structure ) we seek to model . Many infectious diseases such as inﬂuenza and COVID - 19 have a substantial incubation or latency period ; our contri - butions both incorporate a latency period and propose an inference procedure to account for the unknown infection and recovery times through latent variables . Lastly , contemporary studies collect information on covariates such as hygiene habits , vaccination statuses , and preventative measures and disease control , which go beyond the simple infection states and contact tracing information that were previously available . The model and procedure of Bu et al . ( 2020 ) consider the binary contact status between individuals 2 for modeling infection rates but more ﬂexibility is needed to accommodate heterogeneity in epidemic rate parameters as a function of multiple covariates . As a concrete example , consider the role of hygiene habits on disease spread . Previous studies have shown that good hygiene habits such as frequent hand - washing can help reduce the transmission of infectious diseases ( Aiello et al . , 2010 ; Hübner et al . , 2013 ; Hovi et al . , 2017 ; Thompson and Rew , 2015 ) . These studies are mostly randomized trials without closed and interacting populations and have thus been analyzed using simple two - sample t - tests or randomization tests ( Stedman - Smith et al . , 2015 ; Arbogast et al . , 2016 ; Stedman - Smith et al . , 2015 ; Savolainen - Kopra et al . , 2012 ) . While this allows us to get a sense of whether hygiene is important overall , it does not quantify the eﬀect of individual hygiene behavior on disease transmission within a joint inference procedure . In our motivating dataset , the eX - FLU study of inﬂuenza - like - illnesses on a college campus ( Aiello et al . , 2016 ) , raw counts of hand - washers and infection cases suggest that 37 % of those who did not optimally ∗ wash their hands experienced ﬂu - like - illnesses , while only 24 % of those who did became sick during the study . However , a Fisher’s exact test of proportions does not detect this as a signiﬁcant diﬀerence , which is unsurprising as many of the observations are dependent through a network . Inspecting the local network of an infected individual and ( manually ) tracing the disease transmission over a few weeks ( see an illustration in Figure 1 ) suggests that optimal hand - washers are indeed less likely to contract the disease , even after contact with infectious individuals . This exploration illustrates how individual - level informa - tion aﬀects the complex dependencies between the epidemic process and the contact network in a way that goes undetected in population - level summaries , motivating a framework that directly models individual covariates into the transmission mechanism . 19 7 17 23 34 43 55 62 76 11 13 14 16 82 99 week 4 19 7 17 23 34 43 55 62 76 11 13 14 16 82 99 week 5 19 7 17 23 34 43 55 62 76 11 13 14 16 82 99 week 6 19 7 17 23 34 43 55 62 76 11 13 14 16 82 99 week 7 Figure 1 : Weekly aggregated contact networks for select participants in the eX - FLU study . Healthy and sick individuals are marked in blue and red respectively . Individuals who wash their hands optimally are marked by squares , while those who don’t are marked by circles . Here we present the contact networks centered at person 19 from week 4 to week 7 of the study . In week 4 , person 19 is infectious , and by week 5 four of his neighbors are infected ; later on person 23 and person 7 keep infecting their neighbors and thus spread the disease onto person 99 and 14 by week 7 . It is notable that all subsequent infections after 19 are for those who do not wash their hands optimally . Moreover , it appears that an individual tends to lose previous contacts after getting sick . ∗ In the eX - FLU study “optimal hand - washers” were identiﬁed through survey questions on the frequency and duration of hand - washing . 3 The model proposed in Section 2 extends the literature on continuous - time Markov pro - cesses to accommodate a contact network , latency period , more missingness in epidemic obser - vations , and individual - level covariates for heterogeneous disease transmission dynamics . We choose to build on the stochastic SEIR model , a variation on the widely used SIR model that explicitly considers the latency period . This ﬂexibility comes at a cost — exact inference be - comes intractable because of the complex dependencies between the covariates , disease process and missingness mechanism . To address this , we derive a stochastic expectation - maximization ( stEM ) algorithm that can exploit the complete data likelihood while augmenting the data through exact conditional sampling ( Nielsen et al . , 2000 ) . This approach is made computa - tionally tractable due to three key realizations : many of the required computations can be cast as oﬀset Poisson regressions which can be solved eﬃciently , a rejection sampler for missing exposure times can be deployed naively in parallel , and an exact sampler for missing recovery times can be adapted from Bu et al . ( 2020 ) . We further leverage the theoretical guarantees for stEM to compute conservative asymptotic variance estimates . The remainder of this paper is organized as follows : In the next section , we introduce our model framework . Sections 3 and 4 discuss our proposed inference procedures for complete data and partial data . We evaluate the performance of the proposed inference methods through simulation experiments in Section 5 , and ﬁnally apply our model to analyzing the eX - FLU dataset in Section 6 . 2 Model framework We adopt a stochastic compartmental model for epidemics , where all members of the target population are divided into non - overlapping subsets related to their disease statuses , and the mechanism of disease spread is described by the transition between disease statuses for each individual . We base our epidemic model on the SEIR model with four disease statuses : S ( susceptible ) , E ( exposed ) , I ( infectious ) , and R ( recovered or removed ) . An S individual may get exposed ( and thus become an E person ) upon contact with an I individual , and an infectious ( I ) person will eventually recover and transition to the R status . In this model , the E status resembles a latency period and does not entail any transmissibility , and a recovered person enjoys immunity to the disease and therefore no longer contributes to the contagion process . These disease spread dynamics evolve as a continuous - time Markov chain ( CTMC ) deﬁned through exponentially distributed waiting times between consecutive events ( Guttorp , 2018 ) . This implies that the disease process progresses as a series of competing Poisson processes at the individual level . For example , suppose β ij is the rate of exposure between an infectious person i and an susceptible person j who are in contact at time t . Then the probability of j getting exposed ( thus becoming an E person ) at time t + h for small h > 0 is P r ( j gets exposed by i by t + h | i , j in contact at t ) = β ij h + o ( h ) . ( 1 ) Given that the contact structure of the population is subject to change in time as well , we extend the CTMC model to the dynamics of the contact network . For any pair of in - dividuals i and j , they either share an undirected contact link ( “connected” ) or they do not ( “disconnected” ) ; the contact network can thus be represented by a binary symmetric matrix W called the adjacency matrix . Its dynamics are described at the pairwise level , where each 4 entry W ij evolves as a CTMC that takes values in { 0 , 1 } . For example , if individuals i and j are disconnected at time t , with link creation rate α ij , the probability of them engaging in contact by time t + h for small h > 0 is P r ( W ij = 1 at time t + h | W ij = 0 at time t ) = α ij h + o ( h ) . ( 2 ) We will consider heterogeneous exposure rates , allowing individual characteristics and net - work information to play a substantive role in transmission probabilities . Moreover , we con - sider two types of infectious individuals — these can be thought of as symptomatic and asymp - tomatic caseswho exert diﬀerent transmission forces on the population . This is summarized in Figure 2 . 𝑆 𝐼 ! 𝐸 𝑅 𝐼 " 𝛽 ! " 𝜑𝑝 # 𝜑 ( 1 − 𝑝 # ) 𝛾 𝛾 Figure 2 : Diagram of the epidemic process : an extension of the stochastic SEIR model , with heterogeneous exposure rates and two sub - types of infectives . Disease transmission ( exposure ) is conditioned on pairwise contact status in the dynamic contact network . Model Speciﬁcation . Our goal is to construct an individualized framework that can capture the interplay between the epidemic process and the evolution of the contact network . Disease transmission relies on contact between individuals , while the change in contacts , in turn , depends on individual disease statuses . To do so , we model the joint evolution of the epidemic and network processes as the combination of continuous - time Markov chains for individuals ( or pairs of individuals ) in the population . At any time point t in the process , conditioned on the current status of the process Z t , ﬁve types of events may occur for an individual or a pair of individuals : exposure ( an S person becomes exposed by an I person ) , manifestation ( an E person becomes infectious after a latency period ) , recovery ( an I person recovers and becomes a R person ) , link activation ( a previously disconnected pair get connected in the network ) , and link termination ( a previously connected pair break oﬀ their contact ) . We accommodate diﬀerent types of individual heterogeneity in the disease transmission dynamics : ( 1 ) people may exhibit diﬀerent levels of susceptibility that can be explained by individual characteristics such as health conditions , hygiene habits , and behavioral choices ; ( 2 ) those who are infectious might not be equally contagious to the susceptible population ( e . g . , symptomatic and asymptomatic cases for COVID - 19 ) ; ( 3 ) contact rates in the network may vary in time to reﬂect phases of social intervention and / or behavioral changes as response to an epidemic ( e . g . , a pre - and post - lockdown period denoted by T 0 and T 1 , respectively ) ; ( 4 ) contact rates in the network may vary between pairs of individuals based on their healthy ( denoted by H , the collection of S , E , and R statuses ) versus infectious ( denoted by I ) status . Combining the above descriptions , we design the model framework as follows . For any members i and j in the target population , given the current system state Z t at time t > 0 , 5 one of the following ﬁve events may occur after an exponentially distributed waiting time with the associated rate ( see Figure 2 for a summary of the epidemic process ) : • Exposure . If i is infectious , j is susceptible , and they are in contact at time t , then i exposes j with instantaneous rate β ijt that can be decomposed as log β ijt = log β + η i ( t ) + b TS x j , ( 3 ) where β is the baseline exposure rate , η i ( t ) represents i ’s contagiousness level at time t ( details in the next item ) , and b S are the regression coeﬃcients on j ’s individual char - acteristics x j that account for additional heterogeneous eﬀects of susceptibility . ( For example , x j can characterize if person j has been vaccinated , washes their hands fre - quently and / or wears a mask during the ﬂu season , which may reduce j ’s exposure risk . ) • Manifestation . If i ( or j ) is exposed , then he or she becomes infectious with rate ϕ . For additional generality we assume that any infective ( status I person ) gets assigned to one of two categories with diﬀerent levels of contagiousness : I s ( “symptomatic” ) or I a ( “asymptomatic” or “less symptomatic” ) . Individuals are assigned to the ﬁrst category with probability p s and to the second with probability ( 1 − p s ) . † With the two - type infective setup , the η i ( t ) term in Eq . ( 3 ) can be written as η i ( t ) = η 1 ( i is I s at t ) , ( 4 ) which means that an I s person is on average e η times more infectious than an I a indi - vidual . • Recovery . If i ( or j ) is infectious , then he or she recovers with rate γ . • Link activation . If i and j are not in contact , then they get into contact with rate α ijt , where α ijt = α A it A jt 0 1 ( t ∈ T 0 ) + α A it A jt 1 1 ( t ∈ T 1 ) , ( 5 ) where A it is the healthy or infectious status of person i at time t and α ABk stands for the activation rate of link type A − B in phase T k ( A , B ∈ { H , I } and k ∈ { 0 , 1 } ) . • Link termination . If i and j are in contact , then they break oﬀ the contact with rate ω ijt , where ω ijt = ω A it A jt 0 1 ( t ∈ T 0 ) + ω A it A jt 1 1 ( t ∈ T 1 ) , ( 6 ) and ω ABk stands for the termination rate of link type A − B in phase T k . Here T 0 and T 1 represent two time phases of diﬀerent social behaviors that partition the entire observation time window ( 0 , T ) ( e . g . , T 0 and T 1 can be intermittent lockdown and no - lockdown phases ) . The link rates are dependent on the individual disease statuses H or I since we wish to characterize the social adaptation behavior in response of an epidemic – for instance , a healthy - infectious ( H − I ) pair that are in contact might be more likely to disconnect from each other † Note that it is straightfoward to introduce more sub - types of infectives or include continuous and even time - varying explanatory variables for the function η i ( t ) , if more intricate modeling of heterogeneous transmissibility is necessary . 6 than a pair of healthy individuals to avoid disease transmission . Further , since we assume the contact network is symmetric and only dependent on healthy or infectious statuses , the link rates satisfy α HI k = α IH k and ω HI k = ω IH k for k = 0 , 1 . Note that we can also include individual - level covariates in the link activation and ter - mination rates ( α ijt and ω ijt ) to allow for more heterogeneity in the network dynamics , but choose to focus on individual variability in the epidemic process in the main text , and relegate details of heterogeneous network link rates to Section S1 of the Supplementary Material ( Bu et al . , 2021 ) . 3 Inference In this section , we demonstrate how to learn model parameters in the missing data setting . Though our focus will be on inference in the partially observed regime , we begin by describing key inferential terms related to the complete data setting as these quantities will play a role in our stochastic EM algorithm . 3 . 1 Inference with complete data A complete dataset refers to the fullly observed event sequence between time 0 and maximum time T ( > 0 ) of one realization from the generative model . In particular , if we were to continuously observe an epidemic as it progresses under this model , we would have access to ( 1 ) exact times of exposure ( t ( E ) i ) , manifestation ( t ( I ) i ) , recovery , and link activation and termination ; ( 2 ) the identities of the individuals involved in each event ; ( 3 ) the I s or I a subtype allocation for each infectious individual at the time of their manifestation event ; and ( 4 ) the contact network structure as well as initial disease statuses of all individuals at time 0 . Given the complete data ( or equivalently , suﬃcient statistics summarizing the data ) and all individual characteristics { x i } , we can write down the complete data likelihood with re - spect to the parameters of the model Θ = { β , ϕ , γ , η , b S , α , ω } . Here the vectors denote α = { α ABk } k ∈ { 0 , 1 } , ( A , B ) ∈S , ω = { ω ABk } k ∈ { 0 , 1 } , ( A , B ) ∈S , and we index by S = { ( H , H ) , ( H , I ) , ( I , I ) } the set of all pair types . The likelihood takes the form L ( Θ ; complete data ) ( 7 ) = β n E γ n R ϕ n I p n Is s ( 1 − p s ) n Ia Y i : i got exposed e b TS x i h I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η i × Y k = 0 , 1 Y ( A , B ) ∈S h ( α ABk ) C ABk ( ω ABk ) D ABk i × exp − Z T 0 " β N X i = 1 e b T S x i [ I ai ( t ) + I si ( t ) e η ] 1 ( i is susceptible at t ) + γ ( I a ( t ) + I s ( t ) ) + ϕE ( t ) # dt ! × exp   − Z T 0 X k = 0 , 1 X ( A , B ) ∈S h α ABk M dAB ( t ) + ω ABk M cAB ( t ) i 1 ( t ∈ T k ) dt   . Table 1 summarizes the notation used in the expressions above . Since the generative model is a CTMC comprised of individual - level Poisson processes , the above likelihood can be decomposed into epidemic - related components ( 1st and 3rd lines 7 above ) and network - related components ( 2nd and 4th lines ) , where each component is simply the product of all the exponential rates for inter - event times . Some of those inter - event rates can be considered at the population level , and so only require bookkeeping of aggregated counts ( e . g . , n E = total number of exposed cases , E ( t ) = number of E people at time t , and C HI 0 = number of link activation events for H - I pairs in phase T 0 ) . Other inter - event rates , however , depend on individual - level information , and so require tracking terms such as the time - varying neighborhood structure and the exposure and manifestation times for each individual . Note that , for consistency , we set individual i ’s exposure time t ( E ) i and manifestation time t ( I ) i to T if i has never been exposed or manifested . Table 1 : Explanation of notation Notation Explanation N total population size ( assumed ﬁxed ) n I s , n I a , n E , n I , n R total number of I s , I a , exposed ( E ) , infectious ( I ) and recovered ( R ) cases I ai ( t ) , I si ( t ) total number of I a and I s neighbors of i at time t I a ( t ) , I s ( t ) , E ( t ) total number of status I a , I s , and E individuals in the population at time t t ( E ) i , t ( I ) i exposure time and manifestation time for individual i ( set to T if never exposed / manifested ) C ABk , D ABk total number of link activation & termination events among type A − B pairs in phase T k M cAB ( t ) , M dAB ( t ) number of connected & disconnected type A − B pairs at time t Despite a lengthy likelihood expression , parameter estimation is straightforward when complete data are available . We can obtain closed - form maximum likelihood estimates ( MLEs ) for most of the parameters , and ﬁnd the remaining MLEs for parameters β , η and b S through a simple numerical procedure . This suggests that likelihood - based inference given completely observed data is easily implementable through a few lines of code , and can be modularized toward inference when some data are missing ( discussed in the next section ) . The MLEs of all parameters can be obtained by taking partial derivatives of the log - 8 likelihood ( denoted by ‘ ) as follows and setting them all to zero : ∂‘ ∂β = n E β − N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # , ( 8 ) ∂‘ ∂b S = X i : i got exposed x i − β N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # x i , ( 9 ) ∂‘ ∂e η = X i : i got exposed I si ( t ( E ) i ) I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η − β N X i = 1 e x Ti b S Z t ( E ) i 0 I si ( t ) dt , ( 10 ) ∂‘ ∂ϕ = n I ϕ − Z T 0 E ( t ) dt , ( 11 ) ∂‘ ∂p s = n I s p s − n I a 1 − p s , ( 12 ) ∂‘ ∂γ = n R γ − Z T 0 I ( t ) dt , ( 13 ) ∂‘ ∂α ABk = C ABk α ABk − Z T k M dAB ( t ) dt ( for k = 0 , 1 , ( A , B ) ∈ S ) , ( 14 ) ∂‘ ∂ω ABk = D ABk ω ABk − Z T k M cAB ( t ) dt ( for k = 0 , 1 , ( A , B ) ∈ S ) . ( 15 ) The MLEs for parameters ϕ , p s , γ and α ABk , ω ABk ( k = 0 , 1 , ( A , B ) ∈ S ) have closed - form expressions ˆ ϕ = n I R T 0 E ( t ) dt , ˆ p s = n I s n I , ˆ γ = n R R T 0 I ( t ) dt , ˆ α ABk = C ABk R T k M dAB ( t ) dt , ˆ ω ABk = D ABk R T k M cAB ( t ) dt , while the MLEs for β , η and b S can be solved from equations ( 8 ) - ( 10 ) numerically . An eﬃcient iterative procedure is detailed in Section S2 of the Supplementary Material ( Bu et al . , 2021 ) ; in particular , steps for solving the MLE of b S can be largely simpliﬁed based on the observation that it is equivalent to solving for the linear coeﬃcient of a Poisson regression model with individual oﬀset . 3 . 2 Inference with partial epidemic observations As demonstrated in the previous subsection , parameter estimation is relatively straightforward when the full event sequence is observed . However , as discussed in the introduction , real - world epidemic data rarely rarely include measurements of each epidemic event . In the case of the eX - FLU study , true exposure times are not available even though the data contain daily symptom reports . This is because there is typically an incubation period for people who contract the ﬂu . Similarly , exact recovery times are not available in the eX - FLU study , with recoveries discernible only at a weekly resolution from epidemic surveys . Therefore , we need to consider inference with partially observed epidemic data , in particular with exposure times and recovery times unknown . 9 To this end , we derive a method based on the stochastic expectation - maximization ( stEM ) algorithm ( Celeux , 1985 ) . Expectation maximization ( EM ) oﬀers an approach to eﬃciently carry out maximum likelihood estimation for continuous - time Markov chain models in missing data settings ( Doss et al . , 2013 ; Xu et al . , 2015 ; Guttorp , 2018 ) . Imputing the missing data in the E - step requires access to the conditional expectation , and stEM is a variant that builds an approximation to the conditional expectation using augmented data obtained via conditional simulation . To be more precise , let X denote the observed data and Z be the missing data ; a general outline of the stochastic EM algorithm for estimating θ is as follows : For s = 1 : maxIter , do • ( E - step ) draw one sample of missing data , Z ( s ) from its conditional distribution p ( Z | X , θ ( s − 1 ) ) , and then let Q ( θ | θ ( s − 1 ) ) = log L ( θ ; X , Z ( s ) ) ; • ( M - step ) maximize with respect to target function Q ( θ | θ ( s ) ) to update θ : θ ( s ) = arg max θ Q ( θ | θ ( s − 1 ) ) . There are two advantages of this approach . First , in the E - step , integrating to obtain an expected log - likelihood ( as in the traditional EM algorithm ) is replaced by sampling , which avoids the often intractable marginalization step in the case of complex models ( Renshaw , 2015 ; Xu and Minin , 2015 ; Stutz et al . , 2021 ) . Second , the M - step simply requires solving for the MLEs given a version of the complete data , which is often straightforward , and has been discussed in the previous subsection for the present setting . These advantages come at the cost of a potential challenge : we have to conditionally sample the missing data given our observed data and current parameter estimates . In our framework , this is equivalent to sampling event times of a continuous - time Markov chain conditioned on end - points , a notably diﬃcult problem ( Hobolth and Stone , 2009 ; Rao and Teg , 2013 ) . The following section will focus on the conditional sampling ( or “imputing” ) of missing data , i . e . , missing exposure and recovery times . 4 Stochastic EM approach Let t ( E ) and t ( R ) denote all missing exposure times and recovery times , respectively . We assume that all manifestation times { t ( I ) i } are observed , ‡ and there is no missingness in the contact network events given high - resolution contact - tracing . Thus , our inference procedure with partial epidemic observations can be outlined as follows . For s = 1 : maxIter , do 1 . sample missing exposure times t ( E ) ( s ) from their joint conditional distribution p ( t ( E ) | observed events , t ( R ) ( s − 1 ) , Θ ( s − 1 ) ) ; ‡ This assumption is reasonable as manifestation times can be collected via daily symptom monitoring or frequent screening or testing . 10 2 . sample missing recovery times t ( R ) ( s ) from their joint conditional distribution p ( t ( R ) | observed events , t ( E ) ( s ) , Θ ( s − 1 ) ) ; 3 . combine the sampled event times in Steps 1 and 2 with observed data to form an aug - mented dataset , then solve for the MLEs with the augmented dataset to get updated parameter estimates Θ ( s ) . Since Step 3 is already addressed in Section 3 . 1 , we now address Steps 1 and 2 separately . 4 . 1 Step 1 : conditional sampling of missing exposure times Inspecting the complete data likelihood in Eq . ( 7 ) reveals that given all the other event times , person i ’s exposure time t is independent from other individuals’ exposure times , and thus the joint conditional density for t ( E ) can be factorized into individual density components of exposure . Thus , it suﬃces to derive the conditional density for i ’s exposure time t ( E ) i , which is assumed to lie within a “plausible” latency interval L i = ( t i min , t i max ) . Note it is always valid to choose this interval as L i = ( 0 , t ( I ) i ) , meaning that i ’s exposure time may occur any time after time 0 and before i ’s manifestation time . In practice , one may alternatively specify a shorter plausible interval based on prior knowledge about latency duration , which can improve computational eﬃciency . § Then , i ’s instantaneous risk function of exposure and contracting the disease during L i can be written as ( here let δ i = b TS x i ) λ i ( t ) = βe δ i ( I ai ( t ) + e η I si ( t ) ) , t ∈ L i . ( 16 ) This exposure hazard is a step function with change points occurring when either ( 1 ) i activates a link with an I s or I a person , ( 2 ) i deactivates a link with an I s or I a person , ( 3 ) one of i ’s contacts enters status I s or I a , or ( 4 ) one of i ’s contacts exits status I s or I a . For person i , denote this set of change points { t j } n i j = 0 , with t 0 = t i min , t n i = t i max ¶ . This set deﬁnes a partition A i of the latency interval L i such that on each sub - interval A j = ( t j − 1 , t j ) ∈ A i , λ i ( t ) ≡ λ j is constant . Thus , the conditional density for i ’s exposure time t can be expressed as p i ( t | t ( I ) i , β , δ i , η , ϕ , network events ) = λ i ( t ) exp (cid:16) − R tt i min λ i ( u ) du (cid:17) × ϕ exp ( − ϕ ( t ( I ) i − t ) ) 1 ( t i min < t < t i max ) C i ( t i min , t i max ) , ( 17 ) where the normalizing constant C i ( t i min , t i max ) can be explicitly evaluated since λ i ( t ) is a step function . We derive a rejection sampler for the missing exposure time t ( E ) i from p i ( t ) , with the “plausible interval” L i set as ( 0 , t ( I ) i ) . Consider the following proposal density q i ( t ) = λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) 1 ( 0 < t < t ( I ) i ) 1 − exp (cid:18) − R t ( I ) i 0 λ i ( u ) du (cid:19) , ( 18 ) § For example , if we believe that latency should be longer than 2 days but shorter than 2 weeks , then we may set t i min = max ( 0 , t ( I ) i − 14 ) and t i max = max ( 0 , t ( I ) i − 2 ) . ¶ Here we suppress the notation that t j is associated with individual i to avoid double subscripts , focusing on one individual during exposition . 11 which is the density function of a truncated inhomogeneous Exponential distribution with rate λ i ( t ) . A rejection sampler for t ( E ) i runs in two steps : 1 . Sample t from q i ( t ) , an inhomogeneous Exponential with rate λ i ( t ) truncated on L i : ( a ) sample an interval A j ( recall that the risk function is constant on each interval ) via Pr ( t ∈ A j | λ i ( t ) ) = exp (cid:16) − P k < j λ k len ( A k ) (cid:17) − exp (cid:16) − P k ≤ j λ k len ( A k ) (cid:17) 1 − exp (cid:0)P n i k = 1 λ k len ( A k ) (cid:1) , where we denote the length of A j by len ( A j ) . ( b ) within interval A j , sample t ∼ Exp ( λ j ) truncated on interval ( t j − 1 , t j ) . 2 . Compute the acceptance probability for t by ( here M > 1 is a constant ) p i ( t ) Mq i ( t ) = exp ( − ϕ ( t ( I ) i − t ) ) , ( 19 ) and draw U ∼ Unif ( 0 , 1 ) ; accept t as a sample of t ( E ) i if U < exp ( − ϕ ( t ( I ) i − t ) ) , and otherwise go back to Step 1 and repeat . A full derivation of the above ( importantly showing that M > 1 ) is provided in Section S3 of the Supplementary Material ( Bu et al . , 2021 ) . Note that it is easy to generalize to a setting with other choices of the plausible interval bounds t i min and t i max , which simply entails changing the limits of integration in the above derivations . Step 1 of the stEM procedure can be carried out by running the rejection sampler above , and we may further speed up computation by running the sampler for each person i in parallel . In the simulations in Section 5 . 2 , the rejection sampler accepts approximately 45 % of proposals . 4 . 2 Step 2 : conditional sampling of missing recovery times Every infectious individual recovers with rate γ independently of other members in the pop - ulation , but when conditionally sampling missing recovery times , we have to make sure that the imputed timepoints are compatible with observed data and the sampled exposure times ( Cauchemez and Ferguson , 2008 ; Fintzi et al . , 2017 ) . The conditional samples of missing re - covery times should satisfy two conditions : ﬁrst of all , an individual q cannot recover before a time t if q is known to be still infectious by t ; and more importantly , if another individual p gets exposed during his contact with q , then the recovery time for q cannot leave p with no possible infection source . Sampling missing recovery times , therefore , amounts to conditionally sampling event times with endpoints restricted by count and contact data . This challenging task was addressed by the DARCI algorithm developed in Bu et al . ( 2020 ) ( Proposition 4 . 2 ) for a simpler epidemic model with only one type of infectives . Here , we cannot directly use DARCI because the diﬀerent transmissibility levels of I a and I s individuals must be taken into account when we consider the possible ranges of recovery times to ensure the existence of viable infection sources for those exposed . Instead , we adapt the DARCI algorithm to accommodate our two types of infectives . Below we discuss the details of the modiﬁed DARCI procedure . 12 Utilizing the Markov property , this algorithm ﬁrst segments the observation window ( 0 , T ] into contiguous , non - overlapping time intervals . On each time interval ( u , v ] , the disease statuses of all people are known at endpoints u and v , and thus we know the set of people Q who should recover during ( u , v ] . ‖ Further , conditioned on the sampled exposure times , we also know the infection / exposure cases and their exposure times during ( u , v ] and let these individuals be P . We sample the missing recovery times { t ( R ) q } q ∈Q in the following steps : 1 . Initialize a vector of “feasible lower - bounds” LB of length | Q | with LB q = u for every q ∈ Q ; for any p ∈ P ∩ Q , further set LB p = i p , where i p is p ’s exposure time ; 2 . Arrange the set of exposed individuals P in the order of { p 1 , p 2 , . . . , p | P | } such that their exposure times i p 1 < i p 2 < . . . < i p | P | , and for each p ∈ P ( chosen in the arranged order ) , examine p ’s “potential infectious neighborhood” I p = N p ( i p ) ∩ ( I ( i p ) ∪ Q ) , where N p ( t ) is the set of p ’s neighbors at time t , and I ( t ) is the set of known infectious individuals at time t . If I p ⊂ Q ( i . e . , potential infection sources are all members of Q ) , then select one q ∈ I p , with probability 1 ( q is I a at i p ) + e η 1 ( q is I s at i p ) P q 0 ∈I p 1 ( q 0 is I a at i p ) + e η 1 ( q 0 is I s at i p ) , ( 20 ) and set LB q = i p . 3 . Draw recovery times t ( R ) q ind ∼ TEXP ( γ , LB q , v ) , where TEXP ( γ , s , t ) is a truncated Ex - ponential distribution with rate γ and truncated on the interval ( s , t ) . Despite the dense notation , the intuition of this sampling algorithm is straightforward : if person q is the only possible infection source of person p , then q should wait until p gets exposed before he or she recovers , so that the resulting augmented data are consistent with the observed data . We note that the conditional sampling of recovery times is parallelizable as well , since operations on each interval ( u , v ] are independent and thus can be run in parallel . 4 . 3 Uncertainty quantiﬁcation and improving eﬃciency via averaging While the algorithm proposed above provides a way to estimate Θ , we may further quan - tify uncertainty in our estimates by leveraging expressions for their asymptotic variances by appealing to results established in Nielsen et al . ( 2000 ) . Let ˆΘ denote the parameter estimates from the stochastic EM algorithm , and Θ 0 be the true parameter values . Then the asymptotic variance matrix of ˆΘ is I ( Θ 0 ) − 1 + I ( Θ 0 ) − 1 [ I p − ( I p + F ( Θ 0 ) ) − 1 ] , ( 21 ) where I ( Θ 0 ) is the information matrix of the observed data evaluated at the true parameter values , F ( Θ 0 ) is a matrix representing the fraction of missing information due to partial ‖ For example , in the eX - FLU study , weekly epidemic surveys would provide information on if someone felt sick during each week . 13 observations , and I p is the p - dimensional identity matrix . We may decompose Eq . ( 21 ) into two parts : the ﬁrst term is the asymptotic variance of the observed data MLE , while the second term accounts for the additional variance arising from stochastic simulations ( i . e . , the conditional sampling ) . It can be shown that the latter contribution increases the variance by no more than 50 % over the observed data MLE ( Proposition 4 in Nielsen et al . ( 2000 ) ) . Moreover , the ﬁrst term in the asymptotic variance formula can be regarded as a constant given a model and a ﬁxed sample size , but the second term can be reduced by averaging over either across iterations in one run , or over multiple runs of the algorithm . That is , to improve eﬃciency , we may adopt two strategies : 1 . Take the average of the last m iterations and take the averaged parameter values as the ﬁnal estimates ; denote such estimates by ˆΘ ( it ) ( m ) , and then its asymptotic variance is ( see Proposition 5 in Nielsen et al . ( 2000 ) ) I ( Θ 0 ) − 1 + 1 mI ( Θ 0 ) − 1 [ I p − ( I p + F ( Θ 0 ) ) − 1 ] + 1 mI ( Θ 0 ) − 1 [ I p − ( I p + F ( Θ 0 ) ) − 1 ] F ( Θ 0 ) ( 1 − F ( Θ 0 ) ) − 1 + o ( 1 m ) . ( 22 ) 2 . Take m independent runs of the stochastic EM algorithm and take the average of the m estimates produced by each run ; denote such estimates by ˆΘ ( ind ) ( m ) , and then its asymptotic variance is ( see Section 4 . 2 . 2 in Nielsen et al . ( 2000 ) ) I ( Θ 0 ) − 1 + 1 mI ( Θ 0 ) − 1 [ I p − ( I p + F ( Θ 0 ) ) − 1 ] . ( 23 ) For instance , if we run the stochastic - EM procedure m = 10 times in parallel and take the average of the estimates produced by those 10 independent runs , then the asymptotic variance of these estimates is bounded above by ( 1 + 110 × 0 . 5 ) I ( Θ 0 ) − 1 = 1 . 05 I ( Θ 0 ) − 1 . We can further plug in the estimates ˆΘ ( ind ) ( 10 ) for Θ 0 to get a variance estimate of 1 . 05 I (cid:16) ˆΘ ( ind ) ( 10 ) (cid:17) − 1 . In the simulations in Section 5 . 2 these approximations to the variance are conservative , but not for all parameters . While the Wald - type intervals for most parameters cover the truth nearly 100 % of the time , the β and η in our simulations are covered 93 % and 81 % of the time , respectively . Because the marginal likelihood of observed data isn’t available , the observed data infor - mation matrix I ( · ) is not immediately obtainable . However , we can nonetheless estimate I ( · ) using the Louis identity ( Louis , 1982 ) − ∂ 2 ‘ obs ∂ Θ 2 = E Θ (cid:18) − ∂ 2 ‘ ∂ Θ 2 (cid:19) − cov Θ (cid:18) ∂‘ ∂ Θ (cid:19) , ( 24 ) where ‘ obs is the ( marginal ) log - likelihood of the observed data , and ‘ is the log - likelihood of the complete data . Both terms of the right - hand side only involve the complete data likelihood and can be estimated via Monte Carlo approximation using the augmented data samples generated across the iterations of our inference procedure ( Diebolt and Ip , 1995 ) . That is , these samples are already available from the estimation process , and so evaluating Eq . ( 24 ) does not require additional sampling . 14 5 Simulation experiments We now turn to validate the methods of inference via simulation experiments . Synthetic data are simulated using the Gillespie algorithm ( Gillespie , 1977 ) according to the generative process described in Section 2 . A generated complete dataset includes the initial contact network G 0 , the initial exposed / infectious individual ( s ) I 0 , and the full event sequence { e ‘ } , where each event e ‘ consists of the event time , the identities of the individuals involved in this event , as well as the event type ( exposure , manifestation , recovery , link activation and termination ) . In addition , we assume that for each person i in the target population , we observe a vector x i of covariates , which in simulation experiments are randomly sampled binary and standard normal variables . The full set of parameters to estimate is Θ = { β , b S , η , ϕ , γ , α , ω } . For simplicity , through - out this section , we use the following ground - truth setting for the link rates : α T = ( α HH 0 , α HI 0 , α II 0 , α HH 1 , α HI 1 , α II 1 ) = ( 6 , 6 , 6 , 6 , 2 , 6 ) × 10 − 4 ; ω T = ( ω HH 0 , ω HI 0 , ω II 0 , ω HH 1 , ω HI 1 , ω II 1 ) = ( 5 , 5 , 5 , 5 , 50 , 5 ) × 10 − 3 . That is , we assume that in the second social behavior stage T 1 , α HI ( link activation for H − I pair ) is reduced and ω HI ( link termination for H − I pair ) is increased , mimicking a “quarantine” or “lockdown” phase . The initial network G 0 is a random Erdős – Rényi graph with edge density 0 . 05 . Parameters for the epidemic process are chosen as follows : β = 0 . 2 , η = 0 . 2 , γ = 0 . 1 , ϕ = 0 . 2 , p s = 0 . 6 . These values are chosen to ensure a low probability of epidemic extinction at the beginning and so that a fair proportion ( at least 50 % ) of the population has been exposed by the end of the outbreak . 5 . 1 Inference with complete data We ﬁrst validate our iterative inference procedure for complete data , as derived in Section 3 . 1 . Table 2 presents the mean absolute errors ( MAEs ) , variances and mean square errors ( MSEs ) for all model parameters across 40 simulations on N = 200 - sized populations . Here we present results for e η ( true value ≈ 1 . 22 ) instead of η as e η is the quantity that we directly solve for in inference . In the simulation results presented below , the regression coeﬃcient b S is set as ( 1 , 1 ) T . We can see from Table 2 that when the complete event sequence is available , the derived inference method can estimate model parameters quite accurately . The most challenging parameters to estimate are η ( shown in terms of e η in the table ) and b S , largely because we have to resort to numerical optimization procedures to solve for their MLEs . 5 . 2 Inference with partial observations Our inference method can accommodate two types of missingness in epidemic observations : ( 1 ) exposure times and ( 2 ) recovery times . Between these two types of missingness , the former is more diﬃcult to handle as it requires the conditional sampling step derived in Section 4 . 1 . First , we test out the central part of our inference procedure . To do this , we hold out all the exposure times ( i . e . , every t ( E ) i for each person i who ever got infected ) from each simulated 15 Table 2 : MLE estimates on complete data . For each parameter , we present the mean absolute error ( MAE ) , variance and mean square error ( MSE ) across 40 independent simulations . For multi - dimensional parameters ( b S , α and ω ) , the metrics are averaged over all entries . Parameter MAE Variance MSE β 0 . 0359 0 . 0021 0 . 0042 e η 0 . 2799 0 . 1217 0 . 2493 b S 0 . 2213 0 . 0721 0 . 1654 γ 0 . 0071 8 . 17 × 10 − 5 1 . 77 × 10 − 4 p s 0 . 0353 0 . 0013 0 . 0030 ϕ 0 . 0158 4 . 80 × 10 − 4 0 . 0010 α 0 . 0007 4 . 13 × 10 − 7 1 . 17 × 10 − 6 ω 0 . 0086 6 . 64 × 10 − 6 2 . 18 × 10 − 4 dataset and treat those time points as unobserved while considering all other information as observed . We then run the proposed stochastic EM algorithm ( without the “sampling recovery times” step ) on each partial dataset . Columns 2 - 4 in Table 3 ( under “Missing expo . times” ) summarize the estimation results for some of the model parameters across 40 independent simulations . Same as in Table 2 , we provide the MAE , variance and MSE for the estimates . Next , on the same simulated data , we hold out all the recovery times ( i . e . , t ( R ) i for each person i who ever became infectious ) and treat both t ( E ) i and t ( R ) i for each infected person i as unobserved . Now the full stochastic EM inference algorithm is applied to each partial dataset , and the results are summarized in columns 5 - 7 in Table 3 ( under “Missing both” ) . As one might expect , compared to inference based on complete data , there is some de - crease in accuracy , in particular for e η , b S and β . This decrease in performance is largely due to the variability in the sequential samples of individual local neighborhoods . That is , when the exposure time t ( E ) i is unknown and has to be conditionally sampled , the local neighbor - hood structure for each person i ( i . e . , I ai ( t ( E ) i ) and I si ( t ( E ) i ) ) is also unknown and ﬂuctuates throughout the rest of the sampler . This would greatly impact the numerical optimization procedure for these three parameters , as they either directly depend on I ai ( t ( E ) i ) and I si ( t ( E ) i ) or involve the function F i ( e η ) = Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt , which changes whenever t ( E ) i gets updated . Moreover , when the exposure times are unknown , the accumulated amount of infection forces exerted on each susceptible person is also un - available , which would make solving for β and b S more challenging ( see Section S2 of the Supplementary Material ( Bu et al . , 2021 ) for details on the numerical optimization ) . We also note that when recovery times are missing in addition to exposure times , there tends to be more variability in the parameter estimates , since more missingness in the data should tend to induce increased uncertainty . Much of the additional uncertainty is reﬂected in the estimation of exposure - and latency - related parameters ( e . g . , e η , b S and ϕ ) , as the con - ditional samplers for exposure times and recovery times are co - dependent , and the complexity in estimating those parameters is more vulnerable to the loss of more information . We further investigate the estimation of these more diﬃcult parameters and note that 16 Table 3 : Performance of the stochastic EM inference procedure for simulated datasets with all exposure times missing ( columns 2 - 4 ) and will both exposure and recovery times missing . The estimate of each parameter is obtain by averaging over the last 20 iterations of the parameter sample chain produced by running the inference algorithm . For each missingness scenario , we present the MAE , variance and MSE for the parameter estimates across 40 independent simulations . Parameter Missing expo . times Missing both MAE Variance MSE MAE Variance MSE β 0 . 0483 0 . 0035 0 . 0069 0 . 0590 0 . 0434 0 . 0581 e η 0 . 3035 0 . 6719 0 . 2635 0 . 3109 0 . 1976 0 . 3093 b S 0 . 3493 0 . 2038 0 . 3477 0 . 3697 0 . 1549 0 . 3693 γ 0 . 0061 5 . 61 × 10 − 5 1 . 15 × 10 − 4 0 . 0088 1 . 16 × 10 − 4 2 . 408 × 10 − 4 p s 0 . 0479 0 . 0021 0 . 0045 0 . 0353 0 . 0013 0 . 0030 ϕ 0 . 0136 0 . 0003 0 . 0005 0 . 0197 0 . 0003 0 . 0009 α 0 . 0005 2 . 50 × 10 − 8 3 . 37 × 10 − 7 0 . 0006 4 . 76 × 10 − 8 5 . 33 × 10 − 7 ω 0 . 0088 2 . 00 × 10 − 6 2 . 22 × 10 − 4 0 . 0089 7 . 58 × 10 − 6 2 . 70 × 10 − 4 estimation accuracy increases when more data are available . We demonstrate this by conduct - ing simulation experiments for diﬀerent population sizes ( N = 100 , 200 and 300 ) . Since the number of epidemic events increases approximately linearly in N , more events can be observed with a larger population size . For each simulated dataset , we take out both the exposure and recovery times and run the inference algorithm , but in Step 3 ( solving for the MLEs ) we ﬁx all other parameters at the true values and only estimate e η and b S . Moreover , we run a separate set of experiments where we only estimate e η ( i . e . , ﬁxing b S at the truth as well ) . In Figure 3 we present the MSEs of the produced estimates for e η and b S when ﬁxing other parameters ( shown as “b _ S” and “exp ( eta ) ” in red circles and green triangles ) , and for e η only while ﬁxing all other parameters ( shown as “exp ( eta ) only” in blue squares ) . We can see that with increased population size , which yields more observed events , the error in estimating these parameters decreases . 6 Case study : ﬂu season on a university campus We now return to the study of transmission of inﬂuenza - like illnesses among students on a university campus , where high - resolution contact tracing was conducted to track physical proximity between study subjects . This dataset was collected over a 10 - week epidemiological study , eX - FLU ( Aiello et al . , 2016 ) , where inter - personal physical contacts of study participants were surveyed to inves - tigate the eﬀect of social intervention on respiratory infection transmissions . 590 university students enrolled in the study and were asked to respond to weekly surveys on inﬂuenza - like illness symptoms and social interactions ; they also completed a comprehensive entry survey about demographic information , lifestyles , immunization history , health - related habits , and tendencies of behavioral changes during a ﬂu season or a hypothetical pandemic . 103 indi - viduals among the study population were further recruited to participate in a sub - study in which each study subject was provided a smartphone equipped with an application , iEpi . This 17 0 . 25 0 . 50 0 . 75 1 . 00 100 150 200 250 300 pop . size N M SE parameter b _ S exp ( eta ) exp ( eta ) ( only ) Figure 3 : The MSEs for estimating e η and b S with missing exposure and recovery times for diﬀerent population sizes ( N = 100 , 200 , 300 ) . Here , when running Step 3 of the inference algorithm , we ﬁx all other parameters at the true values and only estimate e η and b S ( shown in red circles and green triangles ) ; moreover , we run similar estimation procedures but only focus on e η ( i . e . , b S is ﬁxed at the truth , shown in blue squares ) . It is clear that when the population size increases and more events are observed , e η and b S are estimated more accurately . application pairs smartphones with other nearby study devices via Bluetooth and thus can record individual - level contacts ( i . e . , physical proximity ) at ﬁve - minute intervals . The iEpi sub - study took place from January 28 , 2013 to April 15 , 2013 ( that is , from week 2 until after week 10 in the main study ) . Between weeks 6 and 7 , there was a one - week spring break ( March 1 to March 7 ) , during which epidemic data collection was paused and volume of recorded contacts also dropped considerably . In our application case study , we use data obtained on the N = 103 sub - study population from January 28 to April 4 ( week 2 to week 10 ) , and treat the two periods before and after the spring break as two diﬀerent social behavior phases . That is , we regard weeks 2 - 6 as T 0 and weeks 7 - 10 as T 1 in our analysis . Furthermore , we consider two types of “infectious” ( status I ) members within the study population : ( 1 ) multi - symptomatic and ( 2 ) uni - symptomatic . To maintain notation consis - tency , we label the former by I s and the latter by I a . They are deﬁned as follows . 1 . multi - symptomatic ( I s ) , a case with a cough AND one of these three symptoms : fever or feverishness , chills , or body aches . ∗∗ 2 . uni - symptomatic ( I a ) , a case with a cough , which is an important symptom for inﬂuenza . For each infection case , we set the reported symptom onset time as the manifestation time ( denoted by t ( I ) i in previous sections ) , and treat the exposure time ( t ( E ) i ) and recovery time ( t ( R ) i ) as unobserved . Since t ( E ) i < t ( I ) i ( as dictated by the design of the assumed epidemic mechanism ) , we set the plausible latency interval as L i = ( 0 , t ( I ) i ) . Using weekly surveys ( which asked each participant if they felt sick in the past week ) , we know that the missing recovery times must lie within a 7 - day interval for each individual , where the lower and upper bounds ∗∗ This is the deﬁnition of “inﬂuenza - like - illnesses” . 18 are the start and end of a week . Moreover , we assume that all the contact network events are fully observed , as the high - resolution contact tracing can provide timepoints of initiation and termination of all individual - level contacts . †† This suggests that the proposed inference procedure in Section 4 is applicable to this dataset . In the rest of this section , we ﬁrst address a realistic concern of possible external infection sources for the sub - study population , and then present details and discuss results of our data analysis . 6 . 1 Inference with external infection sources Since the 103 individuals in the dataset are sub - sampled from the 590 study participants , which are also sub - sampled from the entire university campus population , we have to treat the data as observed in an open population instead of a closed one . Therefore , some slight modiﬁcations should be made to the model . Speciﬁcally , individuals in our target population may get infected by people who are outside of the N = 103 small population , and we call those people “external infectors” . For simplicity , we represent the joint forces of all external infectors by a single infector that exists outside of the population and exhibits a constant level of transmissibility over time , and this external force of infection is exerted uniformly on all members of the target population . For each susceptible individual j , let the rate of disease onset ( i . e . , manifestation ) due to external infectors be ξ j , and let this onset rate depend on individual characteristics x j , similar to our treatment of the internal exposure rate β ij : log ξ j = log ξ + x Tj b E , ( 25 ) where ξ denotes the population average external onset rate , and coeﬃcients b E represent the eﬀects of individual characteristics x j on subject j ’s deviation of susceptibility from the average level . Here ξ j is the rate of moving from status S directly to either I a or I s , rather than from S to E , and that’s why we are naming it the “external onset rate” instead of “external ex - posure / infection rate” . We are not introducing both an exposure rate ( like β ij ) and a mani - festation rate ( like ϕ ) for external infection cases because of identiﬁability concerns : since all susceptible people are exposed to the same external infector with time - invariant transmissibil - ity , the exposure rate and manifestation rate would not be identiﬁable at the same time when the exposure times are not observed . Thus , to ensure identiﬁcation , we choose to include only one rate instead of two , and the “onset rate” can be thought of as the rate of any susceptible individual developing contagiousness due to external infection forces . Now the set of parameters is extended to ˜Θ = { β , ϕ , γ , η , b S , ξ , b E , α , ω } , and we can write down a complete data likelihood by slightly modifying Eq . ( 7 ) , where the term related to the new parameters ξ and b E are separate from the other terms . This means that introducing external cases wouldn’t aﬀect parameter estimation of the other parameters at all , and that we can still use the partial data inference procedure detailed in Section 4 to analyze the real data . We include details on complete data inference with external cases in Section S4 . 1 of the Supplementary Material ( Bu et al . , 2021 ) . †† The timepoints of link activation and termination events are obtained from processing the Bluetooth signals that indicate close proximity of smartphones equipped to the study participants . Technical details in processing the Bluetooth signals are provided in Supplement S6 . 1 in Bu et al . ( 2020 ) . 19 6 . 2 Data analysis Before applying our model framework to the data , we ﬁrst discuss how we identify internal and external infection cases and describe the individual characteristics used in the analysis . We adopt the following labeling criteria for internal and external infection cases : if an infected person had any infectious contact ( within the 103 - person population ) up to 2 weeks prior to symptom onset , then we label this case as “internal” , and otherwise this case is labelled as “external” . This procedure gives us 18 internal cases and 16 external cases in total . Moreover , among all 34 cases , 13 are multi - symptomatic ( I s ) and 21 are uni - symptomatic ( I a ) . We provide a summary of the breakdown of all infection cases in Table 4 . Table 4 : Summary of infection case in the iEpi sub - study data . I s I a Total Internal 8 10 18 External 5 11 16 Total 13 21 34 We consider the following four individual - level characteristics ( all collected from the entry survey ) that have previously been linked to disease transmission risk : ‡‡ 1 . ﬂushot : a binary indicator of whether or not the study subject has taken a ﬂu shot for this year . 2 . wash _ opt : a binary indicator of whether or not the study subject’s hand - washing habit is considered “optimal” , which is derived from survey questions about how long and how frequently one usually washes their hands . 3 . change _ behavior : a derived score that measures how willingly the study subject would change their lifestyle during a hypothetical pandemic ; this is calculated by standardizing the numeric sum of the 0 / 1 scores of 13 Yes / No questions ( Yes = 1 , No = 0 ) about voluntary behavioral changes that essentially translate to reduced social activities or isolation in a lockdown ; a higher score represents more willingness in changing one’s lifestyle in response to a pandemic . 4 . prevention : a derived score that measures one’s belief in the eﬀectiveness of diﬀerent preventative practices in reducing the risk of catching the ﬂu ; this is calculated by standardizing the numeric sum of response scores ( ranging from 1 to 5 , 1 = strongly disagree , 5 = strongly agree ) to 6 questions regarding potential preventative measures against ﬂu transmission ; a high score represents stronger belief in the eﬀectiveness of preventative practices . We perform 20 independent runs of the stochastic - EM inference procedure on the dataset , each time with a diﬀerent random initialization and 60 burn - in steps . For each run , we take the average of the last 20 iterations ( after burn - in ) and then average over the 20 averages ( across runs ) to produce estimates of the parameters . Asymptotic standard errors are obtained using ‡‡ We have included the original survey questions used to calculate the derived covariates “change _ behavior” and “prevention” in Sections S4 . 2 and S4 . 3 of the Supplementary Material ( Bu et al . , 2021 ) . 20 the method described in Section 4 . 3 ; here we obtain a conservative estimate of standard errors by setting m = 20 and upper - bounding the asymptotic variance matrix by 1 . 025 I ( ˆ˜Θ ) − 1 , where ˆ˜Θ are the ﬁnal parameter estimates produced by averaging . Tables 5 and 6 present estimates of select parameters of interest . Note that here we take one day as 1 unit of time . From the epidemic parameter estimates , we can see that for this population , the baseline exposure rate is quite high , indicating fast disease exposure upon contact ( it takes approximately 0 . 22 days on average for an H − I contact to lead to infec - tion if the susceptible individual is not vaccinated and does not wash hands properly ) ; the latency period lasts slightly less than 5 days on average , while recovery from symptoms and contagiousness takes about 6 days on average . The total external infection force experienced by the entire N = 103 - person population is on the scale of 0 . 00445 × 103 ≈ 0 . 458 , indicating that on average there would be a disease onset due to external sources every other day if no - body in the study population had a ﬂu shot or washed their hands optimally . In terms of the eﬀects of individual - level covariates , we note that the estimates are associated with relatively large standard errors ( indicated in the parentheses ) , and this is potentially due to the small sample size ( in particular , the limited number of infection cases ) . Nevertheless , the eﬀect of hand - washing ( “wash _ opt” ) seems to be considerable , given that there is a 11 - fold reduction ( 1 / e − 2 . 42 ≈ 11 . 2 ) in the exposure risk if one washes their hands optimally compared to sub - optimal hand - washing ; this eﬀect appears signiﬁcant , in that the 95 % Wald - type conﬁdence interval constructed using the conservative standard error estimate is ( − 4 . 054 , − 0 . 786 ) , which does not cover zero . In Table 7 we include estimates of several parameters related to the contact network process . Here we emphasize the diﬀerence between the change rates of H − H ( healthy - healthy ) links and H − I ( healthy - ill ) links , as well as the diﬀerence between the two phases ( T 0 before spring break and T 1 after ) . We can clearly see that the link deletion rates for H − I links are higher than those of H − H links in both phases , suggesting that the duration of contact between a healthy person and an infectious person is on average shorter than the contact between two healthy people , probably because the students were cutting meetings short with peers who seemed sick in order to avoid getting infected during the ﬂu season . Moreover , we can clearly see that the level of network activity is much higher ( both in terms of establishing and breaking contact ) in T 0 ( weeks 2 to 6 , before spring break ) compared to T 1 ( weeks 7 to 10 , after spring break ) when we compare the rates for phase T 0 and phase T 1 . Such ﬁndings are enabled by our model design which allows for diﬀerent levels of network activities by introducing diﬀerent time phases . Table 5 : Estimates of key epidemic parameters , with conservative estimates of asymptotic standard errors . Parameter Estimate Standard error β ( internal exposure ) 4 . 497 2 . 005 ξ ( external onset ) 0 . 00445 0 . 00114 ϕ ( latency ) 0 . 221 0 . 0591 γ ( recovery ) 0 . 161 0 . 0279 e η ( I s v . s . I a infectiousness ) 0 . 0622 0 . 0526 p s ( proportion of I s ) 0 . 382 0 . 0854 21 Table 6 : Estimates of epidemic coeﬃcients on individual characteristics , with conservative asymptotic standard deviations in the parentheses . ( ﬂushot ) ( wash _ opt ) ( change _ behavior ) ( prevention ) b S ( internal exposure ) - 0 . 105 ( 0 . 671 ) - 2 . 42 ( 0 . 817 ) - 0 . 201 ( 0 . 326 ) - 0 . 0541 ( 0 . 273 ) b E ( external onset ) - 0 . 805 ( 0 . 597 ) - 0 . 139 ( 0 . 471 ) 0 . 257 ( 0 . 263 ) - 0 . 0362 ( 0 . 273 ) Table 7 : Estimates of link activation and deletion rates for diﬀerent link types in the two phases ( T 0 spans from week 2 to week 6 , and T 1 from week 7 to week 10 ) . Link type T 0 act . T 1 act . T 0 del . T 1 del . H - H 0 . 0181 0 . 000868 11 . 62 5 . 27 H - I 0 . 0153 0 . 000653 16 . 62 8 . 71 Through our data analysis , we have found that proper hand - washing is signiﬁcantly as - sociated with reduced risk of ﬂu infection , and that there is a considerable external force of infection for the study population . Moreover , study participants exhibit adaptive contact be - havior to ﬂu transmission in that contact between healthy and infectious individuals is less frequent and also lasts less time compared to contact between healthy individuals . Our model has also identiﬁed diﬀerential inter - personal contact patterns in the two observational periods before and after the school break . These ﬁndings are consistent with our intuition and are now quantiﬁed statistically within a joint inferential framework . 7 Discussion In this paper , we present a continuous - time Markov chain model for infectious diseases that accounts for individual - level heterogeneity and a dynamic contact structure . Our proposed model can capture the interplay between the epidemic process and network changes , and , more importantly , can describe heterogeneous susceptibility and transmissibility through individual covariates . To accommodate unobserved exposure times and recovery times in real epidemic data , we develop a data - augmented inference procedure based on the stochastic EM algorithm so that we can make use of the complete data likelihood . We also design an eﬃcient method to conditionally sample missing exposure times that are compatible with observed data and respect the dynamic contact network structure . Experiments show that the developed inference procedure performs well on partial data and is able to uncover notable phenomena from modern epidemic data with high - resolution contact tracing . It is important to note that the modeling framework we propose is ﬂexible beyond our choice of underlying compartments . That is , our approach can be easily adapted to incorporate notions of reinfection ( by allowing some individuals to reenter the susceptible population ) or to distinguish between more than two types of infections . In pursuing generalizations of the methodology , introducing additional parameters requires careful consideration of the uncertainty quantiﬁcation from the stochastic EM algorithm . Although we are able to show that in our setting , the estimated conﬁdence intervals perform well empirically compared to their nominal coverage , they rely on variance approximation formulas , and it is crucial to conduct similar validations in more complex models . 22 Finally , our analysis of the iEpi data provides conﬁrmation of the importance of hand - washing on the reduction of the spread of inﬂuenza - like - illness . Unlike previous claims in this area , we are able to measure the actual eﬀect on the transmission rate of a disease in an ac - tive population with dynamically changing contact patterns . We hope that this development encourages greater data collection of observational high - frequency individual - level data in this area to gain better understanding of other pharmaceutical and non - pharmaceutical interven - tions . For example , future studies will be able to estimate the eﬀectiveness of vaccination in preventing transmission under diﬀerent social interaction rates and population densities , as well as validate claims about the eﬃcacy of mask - wearing and active social distancing . Im - portantly , such data can be collected discretely in closed populations and provide invaluable insight into the deployment of public health interventions ( Motta et al . , 2021 ) . Supplementary Material A Supplementary material including derivations , proofs and additional details of inference and data analysis . ( Document attached at the end . ) B Code and example synthetic data . R and Python code for inference and simulations ; since the real data are proprietary , only example synthetic data are provided . GitHub repository : github . com / fanbu1995 / EpiNetHetero . References Aiello , A . E . , G . F . Murray , V . Perez , R . M . Coulborn , B . M . Davis , M . Uddin , D . K . Shay , S . H . Waterman , and A . S . Monto ( 2010 ) . Mask use , hand hygiene , and seasonal inﬂuenza - like illness among young adults : a randomized intervention trial . The Journal of infectious diseases 201 ( 4 ) , 491 – 498 . Aiello , A . E . , A . M . Simanek , M . C . Eisenberg , A . R . Walsh , B . Davis , E . Volz , C . Cheng , J . J . Rainey , A . Uzicanin , H . Gao , et al . ( 2016 ) . Design and methods of a social network isolation study for reducing respiratory infection transmission : The eX - FLU cluster randomized trial . Epidemics 15 , 38 – 55 . Arbogast , J . W . , L . Moore - Schiltz , W . R . Jarvis , A . Harpster - Hagen , J . Hughes , and A . Parker ( 2016 ) . Impact of a comprehensive workplace hand hygiene program on employer health care insurance claims and costs , absenteeism , and employee perceptions and practices . Journal of occupational and environmental medicine 58 ( 6 ) , e231 . Auranen , K . , E . Arjas , T . Leino , and A . K . Takala ( 2000 ) . Transmission of pneumococcal carriage in families : a latent Markov process model for binary longitudinal data . Journal of the American Statistical Association 95 ( 452 ) , 1044 – 1053 . Britton , T . ( 2010 ) . Stochastic epidemic models : a survey . Mathematical biosciences 225 ( 1 ) , 24 – 35 . Bu , F . , A . E . Aiello , A . Volfovsky , and J . Xu ( 2021 ) . Supplement to “likelihood - based inference for partially observed stochastic epidemics with individual heterogeneity” . 23 Bu , F . , A . E . Aiello , J . Xu , and A . Volfovsky ( 2020 ) . Likelihood - based inference for partially observed epidemics on dynamic networks . Journal of the American Statistical Association , 1 – 17 . Cauchemez , S . and N . M . Ferguson ( 2008 ) . Likelihood - based estimation of continuous - time epidemic models from time - series data : application to measles transmission in london . Jour - nal of the Royal Society Interface 5 ( 25 ) , 885 – 897 . Cauchemez , S . , L . Temime , A . - J . Valleron , E . Varon , G . Thomas , D . Guillemot , and P . - Y . Boëlle ( 2006 ) . S . pneumoniae transmission according to inclusion in conjugate vaccines : Bayesian analysis of a longitudinal follow - up in schools . BMC Infectious Diseases 6 ( 1 ) , 14 . Celeux , G . ( 1985 ) . The sem algorithm : a probabilistic teacher algorithm derived from the em algorithm for the mixture problem . Computational statistics quarterly 2 , 73 – 82 . Cencetti , G . , G . Santin , A . Longa , E . Pigani , A . Barrat , C . Cattuto , S . Lehmann , and B . Lepri ( 2020 ) . Using real - world contact networks to quantify the eﬀectiveness of digital contact tracing and isolation strategies for covid - 19 pandemic . medRxiv . Diebolt , J . and E . H . Ip ( 1995 ) . A stochastic em algorithm for approximating the maxi - mum likelihood estimate . Technical report , Sandia National Labs . , Livermore , CA ( United States ) . Dong , W . , A . Pentland , and K . A . Heller ( 2012 ) . Graph - coupled HMMs for modeling the spread of infection . arXiv preprint arXiv : 1210 . 4864 . Doss , C . R . , M . A . Suchard , I . Holmes , M . Kato - Maeda , and V . N . Minin ( 2013 ) . Fitting birth - death processes to panel data with applications to bacterial dna ﬁngerprinting . The annals of applied statistics 7 ( 4 ) , 2315 . Eames , K . T . and M . J . Keeling ( 2003 ) . Contact tracing and disease control . Proceedings of the Royal Society of London . Series B : Biological Sciences 270 ( 1533 ) , 2565 – 2571 . Fan , K . , M . Eisenberg , A . Walsh , A . Aiello , and K . Heller ( 2015 ) . Hierarchical graph - coupled HMMs for heterogeneous personalized health data . In Proceedings of the 21th ACM SIGKDD international conference on knowledge discovery and data mining , pp . 239 – 248 . ACM . Fan , K . , C . Li , and K . Heller ( 2016 ) . A unifying variational inference framework for hierar - chical graph - coupled HMM with an application to inﬂuenza infection . In Thirtieth AAAI Conference on Artiﬁcial Intelligence . Ferguson , N . , D . Laydon , G . Nedjati Gilani , N . Imai , K . Ainslie , M . Baguelin , S . Bhatia , A . Boonyasiri , Z . Cucunuba Perez , G . Cuomo - Dannenburg , et al . ( 2020 ) . Report 9 : Im - pact of non - pharmaceutical interventions ( npis ) to reduce covid19 mortality and healthcare demand . Fintzi , J . , X . Cui , J . Wakeﬁeld , and V . N . Minin ( 2017 ) . Eﬃcient data augmentation for ﬁtting stochastic epidemic models to prevalence data . Journal of Computational and Graphical Statistics 26 ( 4 ) , 918 – 929 . 24 Gillespie , D . T . ( 1977 ) . Exact stochastic simulation of coupled chemical reactions . The journal of physical chemistry 81 ( 25 ) , 2340 – 2361 . Guttorp , P . ( 2018 ) . Stochastic modeling of scientiﬁc data . CRC Press . Ho , L . S . T . , F . W . Crawford , and M . A . Suchard ( 2018 ) . Direct likelihood - based inference for discretely observed stochastic compartmental models of infectious disease . The Annals of Applied Statistics 12 ( 3 ) , 1993 – 2021 . Ho , L . S . T . , J . Xu , F . W . Crawford , V . N . Minin , and M . A . Suchard ( 2018 ) . Birth / birth - death processes and their computable transition probabilities with biological applications . Journal of mathematical biology 76 ( 4 ) , 911 – 944 . Hobolth , A . and E . A . Stone ( 2009 ) . Simulation from endpoint - conditioned , continuous - time Markov chains on a ﬁnite state space , with applications to molecular evolution . The Annals of Applied Statistics 3 ( 3 ) , 1204 . Hoti , F . , P . Erästö , T . Leino , and K . Auranen ( 2009 ) . Outbreaks of streptococcus pneumoniae carriage in day care cohorts in ﬁnland – implications for elimination of transmission . BMC infectious diseases 9 ( 1 ) , 102 . Hovi , T . , J . Ollgren , and C . Savolainen - Kopra ( 2017 ) . Intensiﬁed hand - hygiene campaign including soap - and - water wash may prevent acute infections in oﬃce workers , as shown by a recognized - exposure - adjusted analysis of a randomized trial . BMC infectious diseases 17 ( 1 ) , 1 – 9 . Hübner , N . - O . , C . Hübner , and A . Kramer ( 2013 ) . Impact of health campaign on hand hygiene with alcohol - based hand rubs in a non - clinical setting . Journal of Hospital Infection 83 , S23 – S28 . Ju , N . , J . Heng , and P . E . Jacob ( 2021 ) . Sequential monte carlo algorithms for agent - based models of disease transmission . arXiv preprint arXiv : 2101 . 12156 . Kermack , W . O . and A . G . McKendrick ( 1927 ) . A contribution to the mathematical theory of epidemics . Proceedings of the royal society of london . Series A , Containing papers of a mathematical and physical character 115 ( 772 ) , 700 – 721 . Kiss , I . Z . , D . M . Green , and R . R . Kao ( 2006 ) . Infectious disease control using contact tracing in random and scale - free networks . Journal of The Royal Society Interface 3 ( 6 ) , 55 – 62 . Lee , E . C . , N . I . Wada , M . K . Grabowski , E . S . Gurley , and J . Lessler ( 2020 ) . The engines of sars - cov - 2 spread . Science 370 ( 6515 ) , 406 – 407 . Louis , T . A . ( 1982 ) . Finding the observed information matrix when using the em algorithm . Journal of the Royal Statistical Society : Series B ( Methodological ) 44 ( 2 ) , 226 – 233 . Lunz , D . , G . Batt , and J . Ruess ( 2021 ) . To quarantine , or not to quarantine : A theoretical framework for disease control via contact tracing . Epidemics 34 , 100428 . 25 Motta , F . C . , K . A . McGoﬀ , A . Deckard , C . R . Wolfe , M . Bonsignori , M . A . Moody , K . Ca - vanaugh , T . N . Denny , J . Harer , and S . B . Haase ( 2021 ) . Assessment of simulated surveil - lance testing and quarantine in a sars - cov - 2 – vaccinated population of students on a univer - sity campus . In JAMA Health Forum , Volume 2 , pp . e213035 – e213035 . American Medical Association . Nielsen , B . F . , L . Simonsen , and K . Sneppen ( 2021 ) . Covid - 19 superspreading suggests miti - gation by social network modulation . Physical Review Letters 126 ( 11 ) , 118301 . Nielsen , S . F . et al . ( 2000 ) . The stochastic em algorithm : estimation and asymptotic results . Bernoulli 6 ( 3 ) , 457 – 489 . Rao , V . and Y . W . Teg ( 2013 ) . Fast mcmc sampling for markov jump processes and extensions . Journal of Machine Learning Research 14 ( 11 ) . Renshaw , E . ( 2015 ) . Stochastic population processes : analysis , approximations , simulations . OUP Oxford . Savolainen - Kopra , C . , J . Haapakoski , P . A . Peltola , T . Ziegler , T . Korpela , P . Anttila , A . Amiryouseﬁ , P . Huovinen , M . Huvinen , H . Noronen , et al . ( 2012 ) . Hand washing with soap and water together with behavioural recommendations prevents infections in common work environment : an open cluster - randomized trial . Trials 13 ( 1 ) , 1 – 11 . Skums , P . , A . Kirpich , P . I . Baykal , A . Zelikovsky , and G . Chowell ( 2020 ) . Global transmission network of sars - cov - 2 : From outbreak to pandemic . MedRxiv . Small , M . and D . Cavanagh ( 2020 ) . Modelling strong control measures for epidemic propaga - tion with networks—a covid - 19 case study . IEEE access 8 , 109719 – 109731 . Soriano - Arandes , A . , A . Gatell , P . Serrano , M . Biosca , F . Campillo , R . Capdevila , A . Fàbrega , Z . Lobato , N . López , A . M . Moreno , et al . ( 2021 ) . Household sars - cov - 2 transmission and children : a network prospective study . Clinical Infectious Diseases : an Oﬃcial Publication of the Infectious Diseases Society of America . Stedman - Smith , M . , C . L . DuBois , and S . F . Grey ( 2015 ) . Hand hygiene performance and beliefs among public university employees . Journal of health psychology 20 ( 10 ) , 1263 – 1274 . Stedman - Smith , M . , C . L . DuBois , S . F . Grey , D . M . Kingsbury , S . Shakya , J . Scoﬁeld , and K . Slenkovich ( 2015 ) . Outcomes of a pilot hand hygiene randomized cluster trial to reduce communicable infections among us oﬃce - based employees . Journal of occupational and environmental medicine 57 ( 4 ) , 374 . Stutz , T . C . , J . S . Sinsheimer , M . Sehl , and J . Xu ( 2021 ) . Computational tools for assessing gene therapy under branching process models of mutation . arXiv preprint arXiv : 2111 . 08183 . Thompson , S . J . and L . Rew ( 2015 ) . The healthy workplace project : results of a hygiene - based approach to employee wellness . American Journal of Health Promotion 29 ( 5 ) , 339 – 341 . Touloupou , P . , B . Finkenstädt , and S . E . Spencer ( 2020 ) . Scalable bayesian inference for coupled hidden markov and semi - markov models . Journal of Computational and Graphical Statistics 29 ( 2 ) , 238 – 249 . 26 Xu , J . , P . Guttorp , M . Kato - Maeda , and V . N . Minin ( 2015 ) . Likelihood - based inference for discretely observed birth – death - shift processes , with applications to evolution of mobile genetic elements . Biometrics 71 ( 4 ) , 1009 – 1021 . Xu , J . and V . N . Minin ( 2015 ) . Eﬃcient transition probability computation for continuous - time branching processes via compressed sensing . In Uncertainty in artiﬁcial intelligence : proceedings of the . . . conference . Conference on Uncertainty in Artiﬁcial Intelligence , Volume 2015 , pp . 952 . NIH Public Access . 27 Supplement to Likelihood - based Inference for partially observed stochastic epidemics with individual heterogeneity S1 Additional details of the model framework As a supplement to the model framework introduced in Section 2 , we may consider individual - level covariates in the change rates of links in the contact network . Speciﬁcally , given the status of the process at time t , Z t , if i and j are not in contact , then they initiate contact with rate α ijt , where log α ijt = (cid:2) α A it A jt 0 1 ( t ∈ T 0 ) + α A it A jt 1 1 ( t ∈ T 1 ) (cid:3) + x Ti b α + x Tj b α , ( S1 ) where α ABk represents the baseline link activation rate for link type A − B in phase T k , and b α are the coeﬃcients that describe the additional eﬀects of individual characteristics on the pairwise link activation rate . Similarly , we can introduce the same regression structure to link termination rate ω ijt , log ω ijt = (cid:2) ω A it A jt 0 1 ( t ∈ T 0 ) + ω A it A jt 1 1 ( t ∈ T 1 ) (cid:3) + x Ti b ω + x Tj b ω , ( S2 ) where b ω are the coeﬃcients that describe the eﬀects of individual characteristics on the pairwise link termination rate . With these additional terms added to the link change rates , the complete data inference procedure described in Section 3 . 1 has to be updated . First of all , the complete data likelihood now becomes L ( Θ ; complete data ) = β n E γ n R ϕ n I p n Is s ( 1 − p s ) n Ia Y i : i got exposed e b TS x i h I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η i × Y k = 0 , 1 Y ( A , B ) ∈S h ( α ABk ) C ABk ( ω ABk ) D ABk i N Y i = 1 e N ci x Ti b α e N di x Ti b ω × exp − Z T 0 " β N X i = 1 e b TS x i [ I ai ( t ) + I si ( t ) e η ] 1 ( i is susceptible at t ) + γ ( I a ( t ) + I s ( t ) ) + ϕE ( t ) # dt ! ( S3 ) × exp   − Z T 0 X i , j = 1 : N , i < j h α A it A jt k e x Ti b α + x Tj b α ( 1 − 1 i − j ( t ) ) + ω A it A jt k e x Ti b ω + x Tj b ω 1 i − j ( t ) i dt   . Here N ci and N cj denote the total number of link activation and termination events that i has been involved in , respectively . Moreover , 1 i − j ( t ) is an indicator of whether or not i and j are connected at time t . 28 Then we can see that all the inference steps related to the epidemic parameters shall remain unchanged , but we need modiﬁed steps to estimate α , b α , ω , and b ω . Take partial derivatives of the log - likelihood with respect to these parameters and set them to zero , ∂‘ ∂α ABk = C ABk α ABk − X i < j d ( ij ) ABk e ( x i + x j ) T b α ( for k = 0 , 1 , ( A , B ) ∈ S ) , ( S4 ) ∂‘ ∂ω ABk = D ABk ω ABk − X i < j c ( ij ) ABk e ( x i + x j ) T b ω ( for k = 0 , 1 , ( A , B ) ∈ S ) , ( S5 ) ∂‘ ∂b α = N X i = 1 N ci x i − X k = 0 , 1 X ( A , B ) ∈S α ABk X i < j h d ( ij ) ABk e ( x i + x j ) T b α ( x i + x j ) i , ( S6 ) ∂‘ ∂b ω = N X i = 1 N di x i − X k = 0 , 1 X ( A , B ) ∈S ω ABk X i < j h c ( ij ) ABk e ( x i + x j ) T b ω ( x i + x j ) i , ( S7 ) where d ( ij ) ABk is the total time i and j spend as a disconnected A - B type pair during T k , and c ( ij ) ABk is the total time i and j spend as a connected A - B type pair during T k . Then we can employ the following iterative procedure to solve for α and b α : repeat until convergence or maximum number of iterations is reached : • update α ABk ( for ( A , B ) ∈ S = { ( H , H ) , ( H , I ) , ( I , I ) } and k = 0 , 1 ) with ˆ α ABk = C ABk P i < j d ( ij ) ABk e ( x i + x j ) T b α ; ( S8 ) • update b α by solving 0 = N X i = 1 N ci x i − X k = 0 , 1 X ( A , B ) ∈S α ABk X i < j h d ( ij ) ABk e ( x i + x j ) T b α ( x i + x j ) i ( S9 ) = N X i < j N cij x ij − X i < j   X k = 0 , 1 X ( A , B ) ∈S α ABk d ( ij ) ABk   e x Tij b α x ij , ( S10 ) where N cij is the total counts of link activation between i and j and x ij = x i + x j , and then this is equivalent to solving for the linear coeﬃcients of a Poisson regression model with individual oﬀset log (cid:16)P k = 0 , 1 P ( A , B ) ∈S α ABk d ( ij ) ABk (cid:17) . Estimation for ω and b ω can be conducted in almost exactly the same manner as in the steps above for α and b α , so we will omit the details here . S2 Details of complete data inference Here we provide details on the numerical iterative procedure for solving the MLEs of paramters β , η and b S by setting the partial derivatives in equations ( 8 ) - ( 10 ) to zero . Since it is equivalent to operate with e η instead of η , we directly estimate e η in this procedure . Let F i ( e η ) = Z T 0 ( I ai ( t ) + I si ( t ) e η ) 1 ( i susceptible at t ) dt 29 be the total amount of “pathogen exposure” for person i , which is a function of e η . We run the following steps until convergence or the maximum number of iterations is reached : • update β with ˆ β = n E P Ni = 1 e x Ti b S F i ( e η ) ; • update b S by solving 0 = X i : i got infected x i − β N X i = 1 e x Ti b S F i ( e η ) x i = N X i = 1 y i x i − N X i = 1 e x Ti b S + log β + log F i ( e η ) x i , ( S11 ) where in y i = 1 ( i ever got exposed ) , and solving for the objective function ( S11 ) is equiv - alent to solving for the linear coeﬃcients of a Poisson regression model with individual oﬀset log β + log F i ( e η ) ; • update e η by numerically solving § § 0 = X i : i got exposed I si ( t ( E ) i ) I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η − β N X i = 1 e x Ti b S Z t ( E ) i 0 I si ( t ) dt . ( S12 ) S3 Derivations of the rejection sampler for missing exposure times Given that the risk λ i ( t ) is a step function , the normalizing constant C i ( t i min , t i max ) in Equa - tion ( 17 ) can be explicitly evaluated as ( note that λ i ( t ) ≡ λ j on each interval A j = ( t j − 1 , t j ) ) C i ( t i min , t i max ) = ϕ exp ( − ϕt ( I ) i ) n i X j = 1 λ j exp   − X k < j len ( A k ) λ k + λ j t j − 1   × ( t j − t j − 1 ) 1 ( ϕ = λ j ) e ( ϕ − λ j ) t j − e ( ϕ − λ j ) t j − 1 ϕ − λ j ! 1 ( ϕ 6 = λ j ) . ( S13 ) If we don’t have prior knowledge about the latency period , we should perhaps search for possible exposure time between 0 and the manifestation time . That is , we can adopt the natural choice of L i = [ 0 , t ( I ) i ] , and then the density ( 17 ) is simpliﬁed into p i ( t | t ( I ) i , β , δ i , η , ϕ , network events ) = λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) × ϕ exp ( − ϕ ( t ( I ) i − t ) ) 1 ( 0 < t < t ( I ) i ) C i ( 0 , t ( I ) i ) . ( S14 ) § § Any built - in solver oﬀered by computational softwares ( e . g , “ optim ” function in R ) should work . 30 Let q i ( t ) = λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) 1 ( 0 < t < t ( I ) i ) 1 − exp (cid:18) − R t ( I ) i 0 λ i ( u ) du (cid:19) ( S15 ) be the density function of a truncated inhomogeneous Exponential distribution with rate function λ i ( t ) , and then we would have p i ( t ) q i ( t ) = (cid:20) 1 − exp (cid:18) − R t ( I ) i 0 λ i ( u ) du (cid:19)(cid:21) × ϕ exp ( − ϕ ( t ( I ) i − t ) ) C i ( 0 , t ( I ) i ) ≤ (cid:20) 1 − exp (cid:18) − R t ( I ) i 0 λ i ( u ) du (cid:19)(cid:21) × ϕ exp ( − ϕ ( t ( I ) i − t ( I ) i ) ) C i ( 0 , t ( I ) i ) = exp (cid:16) ϕt ( I ) i (cid:17) R t ( I ) i 0 λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) dt R t ( I ) i 0 exp ( ϕt ) λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) dt = : M , and it’s straightforward to see that M > 1 . This suggests that we can sample exposure time t ( E ) i from p i ( t ) via rejection sampling with proposal density q i ( t ) , as described in Section 4 . 1 . S4 More details of the real data analysis S4 . 1 Complete data inference with external infection cases In Figure S1 , we provide a diagram of the epidemic model with external onsets . Here external onset is the transition between S and I , with the E status subsumed . 𝑆 𝐼 ! 𝐸 𝑅 𝐼 " 𝛽 ! " 𝜑𝑝 # 𝜑 ( 1 − 𝑝 # ) 𝜉𝑝 # 𝜉 ( 1 − 𝑝 # ) 𝛾 𝛾 Figure S1 : Diagram of the epidemic model with external onset transitions . 31 For convenience , when working with the real data , we assume that we have knowledge of which cases are internal infection cases and which are external ones . ¶¶ Denote the former set of cases by I ( int ) and the latter by I ( ext ) . Now the set of parameters are extended to ˜Θ = { β , ϕ , γ , η , b S , ξ , b E , α , ω } , and the complete data likelihood ( 7 ) should be modiﬁed into ˜ L ( ˜Θ ; complete data ) = β n E γ n R ϕ n ( int ) I p n Is s ( 1 − p s ) n Ia Y i : i ∈I ( int ) e b TS x i h I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η i × ξ n ( ext ) I Y i : i ∈I ( ext ) e b TE x i × Y k = 0 , 1 Y ( A , B ) ∈S h ( α ABk ) C ABk ( ω ABk ) D ABk i × exp − Z T 0 " β N X i = 1 e b TS x i [ I ai ( t ) + I si ( t ) e η ] 1 ( i is susceptible at t ) + γ ( I a ( t ) + I s ( t ) ) + ϕE ( t ) # dt ! ( S16 ) × exp − ξ N X i = 1 t ( I ) i e b TE x i ! exp   − Z T 0 X k = 0 , 1 X ( A , B ) ∈S h α ABk M dAB ( t ) + ω ABk M cAB ( t ) i 1 ( t ∈ T k ) dt   . In addition to the notation explained in Section 2 , here n ( int ) I , n ( ext ) I denote the total number of infection ( manifestation ) cases due to internal and external sources , respectively . Again , similar to previous deﬁnitions , for convenience , if an individual i never got infected , then we set t ( E ) i = t ( I ) i = t ( R ) i = T . Examining the above expression , it is obvious that estimation of all previously existing parameters are not really impacted , except that all formulas related to β , b S , η and ϕ should be restricted to internal infection cases instead of all infection cases . Therefore , equations ( 12 ) - ( 15 ) shall remain completely unchanged , and the rest of the partial derivatives should be ¶¶ Details on how we identify internal and external cases are discussed in Section 6 . 2 . 32 modiﬁed slightly , on top of adding two more for ξ and b E : ∂‘ ∂β = n E β − N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # , ( S17 ) ∂‘ ∂b S = X i : i ∈I ( int ) x i − β N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # x i , ( S18 ) ∂‘ ∂e η = X i : i ∈I ( int ) I si ( t ( E ) i ) I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η − β N X i = 1 e x Ti b S Z t ( E ) i 0 I si ( t ) dt , ( S19 ) ∂‘ ∂ϕ = n ( int ) I ϕ − Z T 0 E ( t ) dt , ( S20 ) ∂‘ ∂ξ = n ( ext ) I ξ − N X i = 1 t ( I ) i e b T E x i , ( S21 ) ∂‘ ∂b E = X i : i ∈I ( ext ) x i − ξ " N X i = 1 t ( I ) i e b TE x i # x i . ( S22 ) Same as described in Section 3 . 1 , solving for MLEs requires setting all partial derivatives to zero , which leads to an updated inference method that includes all steps in Section 3 . 1 , with an additional iterative procedure that runs until convergence or the maximum number of iterations is reached : • update ξ with ˆ ξ = n ( ext ) I P Ni = 1 t ( I ) i e b TE x i ; ( S23 ) • update b E by solving 0 = X i : i ∈I ( ext ) x i − ξ " N X i = 1 t ( I ) i e b TE x i # x i = N X i = 1 z i x i − N X i = 1 e x Ti b E + log ξ + log t ( I ) i x i , ( S24 ) where z i = 1 ( i ∈ I ( ext ) ) , and ( very similar to our treatment to b S in ( S11 ) ) this is equiv - alent to solving for the linear coeﬃcients of a Poisson regression model with individual oﬀset log ξ + log t ( I ) i . Therefore , with this updated inference procedure for maximum likelihood estimation from complete data , we can run the inference algorithm stated in Section 4 on the real data , where epidemic observations are incomplete . Note that the addition of the external infection sources doesn’t aﬀect conditional sampling of the missing exposure times or recovery times , so Step 1 and Step 2 of the inference scheme remains unchanged , while only Step 3 is modiﬁed to the procedure discussed above . 33 S4 . 2 Survey questions used to derive individual characteristic “change _ behavior” The following prompt is copied verbatim from the original eX - FLU survey : The next section asks questions about a possible outbreak of pandemic ﬂu in the US - a new type of ﬂu that spreads rapidly among humans and causes severe illness . Imagine that a lot of people were getting very sick from the ﬂu and the ﬂu was spreading rapidly from person to person when you answer the following questions . During an outbreak , would you voluntarily make the following changes to your life ? ( Select Yes ( 1 ) or No ( 0 ) . ) 1 . Cancel plans with friends , other students , or family members ; 2 . Avoid busy public places - e . g . , shopping areas , movie theaters , restaurants ; 3 . Cancel inter - state or international travel plans ; 4 . Stock up on food and / or other necessities ; 5 . Avoid public transportation , including University buses ; 6 . Stay in your residence hall room if you were feeling sick ; 7 . Stay in your residence hall room to avoid contact with sick people ; 8 . Reduce contact with people outside of your residence ; 9 . Wear a face mask when out in public ; 10 . Be absent from class ; 11 . Be absent from work ; 12 . Assist sick neighbors or friends by bringing them food or supplies ; 13 . Limit shopping to living essentials , e . g . food , medicine . S4 . 3 Survey questions used to derive individual characteristic “prevention” The following prompt is copied verbatim from the original eX - FLU survey : Do you believe that the following practices reduce your risk of catching ﬂu ? ( Score from 1 to 5 ; 1 = strongly disgree , 5 = strongly agree . ) 1 . Reducing the number of people you meet over a day ; 2 . Avoiding public transportation , including university buses ; 3 . Cleaning or disinfecting things you might touch ; 4 . Washing your hands regularly with soap and water ; 5 . Wearing a face mask when out in public ; 6 . Avoiding hospitals or doctors’ oﬃces . 34 SubmittedtotheAnnalsofAppliedStatistics SUPPLEMENT TO LIKELIHOOD - BASED INFERENCE FOR PARTIALLY OBSERVED STOCHASTIC EPIDEMICS WITH INDIVIDUAL HETEROGENEITY B Y F AN B U 1 † , A LLISON E . A IELLO 2 , A LEXANDER V OLFOVSKY 1 ∗ k AND J ASON X U 1 ∗ 1 Department of Statistical Science , Duke University , fan . bu1 @ duke . edu ; alexander . volfovsky @ duke . edu ; jason . q . xu @ duke . edu 2 Gillings School of Global Public Health , University of North Carolina , Chapel Hill , aaiello @ email . unc . edu ∗ Joint last authors , k Corresponding author S1 . Additional details of the model framework . As a supplement to the model frame - work introduced in Section 2 , we may consider individual - level covariates in the change rates of links in the contact network . Speciﬁcally , given the status of the process at time t , Z t , if i and j are not in contact , then they initiate contact with rate α ijt , where ( S1 ) log α ijt = (cid:2) α A it A jt 0 1 ( t ∈ T 0 ) + α A it A jt 1 1 ( t ∈ T 1 ) (cid:3) + x T i b α + x T j b α , where α ABk represents the baseline link activation rate for link type A − B in phase T k , and b α are the coefﬁcients that describe the additional effects of individual characteristics on the pairwise link activation rate . Similarly , we can introduce the same regression structure to link termination rate ω ijt , ( S2 ) log ω ijt = (cid:2) ω A it A jt 0 1 ( t ∈ T 0 ) + ω A it A jt 1 1 ( t ∈ T 1 ) (cid:3) + x Ti b ω + x Tj b ω , where b ω are the coefﬁcients that describe the effects of individual characteristics on the pairwise link termination rate . With these additional terms added to the link change rates , the complete data inference procedure described in Section 3 . 1 has to be updated . First of all , the complete data likelihood now becomes L ( Θ ; complete data ) = β n E γ n R ϕ n I p n Is s ( 1 − p s ) n Ia Y i : i got exposed e b TS x i h I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η i × Y k = 0 , 1 Y ( A , B ) ∈S h ( α ABk ) C ABk ( ω ABk ) D ABk i N Y i = 1 e N ci x Ti b α e N di x Ti b ω × exp − Z T 0 " β N X i = 1 e b TS x i [ I ai ( t ) + I si ( t ) e η ] 1 ( i is susceptible at t ) + γ ( I a ( t ) + I s ( t ) ) + ϕE ( t ) # dt ! ( S3 ) × exp   − Z T 0 X i , j = 1 : N , i < j h α A it A jt k e x Ti b α + x Tj b α ( 1 − 1 i − j ( t ) ) + ω A it A jt k e x Ti b ω + x Tj b ω 1 i − j ( t ) i dt   . Here N ci and N cj denote the total number of link activation and termination events that i has been involved in , respectively . Moreover , 1 i − j ( t ) is an indicator of whether or not i and j are connected at time t . † Now at Department of Human Genetics , University of California , Los Angeles . 1 a r X i v : 2112 . 07892v1 [ s t a t . M E ] 15 D ec 2021 2 Then we can see that all the inference steps related to the epidemic parameters shall remain unchanged , but we need modiﬁed steps to estimate α , b α , ω , and b ω . Take partial derivatives of the log - likelihood with respect to these parameters and set them to zero , ∂‘ ∂α ABk = C ABk α ABk − X i < j d ( ij ) ABk e ( x i + x j ) T b α ( for k = 0 , 1 , ( A , B ) ∈ S ) , ( S4 ) ∂‘ ∂ω ABk = D ABk ω ABk − X i < j c ( ij ) ABk e ( x i + x j ) T b ω ( for k = 0 , 1 , ( A , B ) ∈ S ) , ( S5 ) ∂‘ ∂b α = N X i = 1 N ci x i − X k = 0 , 1 X ( A , B ) ∈S α ABk X i < j h d ( ij ) ABk e ( x i + x j ) T b α ( x i + x j ) i , ( S6 ) ∂‘ ∂b ω = N X i = 1 N di x i − X k = 0 , 1 X ( A , B ) ∈S ω ABk X i < j h c ( ij ) ABk e ( x i + x j ) T b ω ( x i + x j ) i , ( S7 ) where d ( ij ) ABk is the total time i and j spend as a disconnected A - B type pair during T k , and c ( ij ) ABk is the total time i and j spend as a connected A - B type pair during T k . Then we can employ the following iterative procedure to solve for α and b α : repeat until convergence or maximum number of iterations is reached : • update α ABk ( for ( A , B ) ∈ S = { ( H , H ) , ( H , I ) , ( I , I ) } and k = 0 , 1 ) with ( S8 ) ˆ α ABk = C ABk P i < j d ( ij ) ABk e ( x i + x j ) T b α ; • update b α by solving 0 = N X i = 1 N ci x i − X k = 0 , 1 X ( A , B ) ∈S α ABk X i < j h d ( ij ) ABk e ( x i + x j ) T b α ( x i + x j ) i ( S9 ) = N X i < j N cij x ij − X i < j   X k = 0 , 1 X ( A , B ) ∈S α ABk d ( ij ) ABk   e x Tij b α x ij , ( S10 ) where N cij is the total counts of link activation between i and j and x ij = x i + x j , and then this is equivalent to solving for the linear coefﬁcients of a Poisson regression model with individual offset log (cid:16)P k = 0 , 1 P ( A , B ) ∈S α ABk d ( ij ) ABk (cid:17) . Estimation for ω and b ω can be conducted in almost exactly the same manner as in the steps above for α and b α , so we will omit the details here . S2 . Details of complete data inference . Here we provide details on the numerical itera - tive procedure for solving the MLEs of paramters β , η and b S by setting the partial derivatives in equations ( 8 ) - ( 10 ) to zero . Since it is equivalent to operate with e η instead of η , we di - rectly estimate e η in this procedure . Let F i ( e η ) = Z T 0 ( I a i ( t ) + I si ( t ) e η ) 1 ( i susceptible at t ) dt be the total amount of “pathogen exposure” for person i , which is a function of e η . We run the following steps until convergence or the maximum number of iterations is reached : SUPPLEMENT - INFERENCE FOR PARTIALLY OBSERVED EPIDEMICS WITH HETEROGENEITY 3 • update β with ˆ β = n E P Ni = 1 e x Ti b S F i ( e η ) ; • update b S by solving 0 = X i : i got infected x i − β N X i = 1 e x Ti b S F i ( e η ) x i = N X i = 1 y i x i − N X i = 1 e x Ti b S + log β + log F i ( e η ) x i , ( S11 ) where in y i = 1 ( i ever got exposed ) , and solving for the objective function ( S11 ) is equiv - alent to solving for the linear coefﬁcients of a Poisson regression model with individual offset log β + log F i ( e η ) ; • update e η by numerically solving * ( S12 ) 0 = X i : i got exposed I si ( t ( E ) i ) I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η − β N X i = 1 e x Ti b S Z t ( E ) i 0 I si ( t ) dt . S3 . Derivations of the rejection sampler for missing exposure times . Given that the risk λ i ( t ) is a step function , the normalizing constant C i ( t i min , t i max ) in Equation ( 17 ) can be explicitly evaluated as ( note that λ i ( t ) ≡ λ j on each interval A j = ( t j − 1 , t j ) ) C i ( t i min , t i max ) = ϕ exp ( − ϕt ( I ) i ) n i X j = 1 λ j exp   − X k < j len ( A k ) λ k + λ j t j − 1   × ( t j − t j − 1 ) 1 ( ϕ = λ j ) (cid:18) e ( ϕ − λ j ) t j − e ( ϕ − λ j ) t j − 1 ϕ − λ j (cid:19) 1 ( ϕ 6 = λ j ) . ( S13 ) If we don’t have prior knowledge about the latency period , we should perhaps search for possible exposure time between 0 and the manifestation time . That is , we can adopt the natural choice of L i = [ 0 , t ( I ) i ] , and then the density ( 17 ) is simpliﬁed into p i ( t | t ( I ) i , β , δ i , η , ϕ , network events ) = λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) × ϕ exp ( − ϕ ( t ( I ) i − t ) ) 1 ( 0 < t < t ( I ) i ) C i ( 0 , t ( I ) i ) . ( S14 ) Let ( S15 ) q i ( t ) = λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) 1 ( 0 < t < t ( I ) i ) 1 − exp (cid:16) − R t ( I ) i 0 λ i ( u ) du (cid:17) be the density function of a truncated inhomogeneous Exponential distribution with rate func - tion λ i ( t ) , and then we would have p i ( t ) q i ( t ) = h 1 − exp (cid:16) − R t ( I ) i 0 λ i ( u ) du (cid:17)i × ϕ exp ( − ϕ ( t ( I ) i − t ) ) C i ( 0 , t ( I ) i ) * Any built - in solver offered by computational softwares ( e . g , “ optim ” function in R ) should work . 4 ≤ h 1 − exp (cid:16) − R t ( I ) i 0 λ i ( u ) du (cid:17)i × ϕ exp ( − ϕ ( t ( I ) i − t ( I ) i ) ) C i ( 0 , t ( I ) i ) = exp (cid:16) ϕt ( I ) i (cid:17) R t ( I ) i 0 λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) dt R t ( I ) i 0 exp ( ϕt ) λ i ( t ) exp (cid:16) − R t 0 λ i ( u ) du (cid:17) dt = : M , and it’s straightforward to see that M > 1 . This suggests that we can sample exposure time t ( E ) i from p i ( t ) via rejection sampling with proposal density q i ( t ) , as described in Section 4 . 1 . S4 . More details of the real data analysis . S4 . 1 . Complete data inference with external infection cases . In Figure S1 , we provide a diagram of the epidemic model with external onsets . Here external onset is the transition between S and I , with the E status subsumed . 𝑆 𝐼 ! 𝐸 𝑅 𝐼 " 𝛽 ! " 𝜑𝑝 # 𝜑 ( 1 − 𝑝 # ) 𝜉𝑝 # 𝜉 ( 1 − 𝑝 # ) 𝛾 𝛾 F IG S1 . Diagram of the epidemic model with external onset transitions . For convenience , when working with the real data , we assume that we have knowledge of which cases are internal infection cases and which are external ones . † Denote the former set of cases by I ( int ) and the latter by I ( ext ) . Now the set of parameters are extended to ˜Θ = { β , ϕ , γ , η , b S , ξ , b E , α , ω } , and the com - plete data likelihood ( 7 ) should be modiﬁed into ˜ L ( ˜Θ ; complete data ) = β n E γ n R ϕ n ( int ) I p n Is s ( 1 − p s ) n Ia Y i : i ∈I ( int ) e b TS x i h I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η i × ξ n ( ext ) I Y i : i ∈I ( ext ) e b TE x i × Y k = 0 , 1 Y ( A , B ) ∈S h ( α ABk ) C ABk ( ω ABk ) D ABk i † Details on how we identify internal and external cases are discussed in Section ? ? . SUPPLEMENT - INFERENCE FOR PARTIALLY OBSERVED EPIDEMICS WITH HETEROGENEITY 5 × exp − Z T 0 " β N X i = 1 e b TS x i [ I ai ( t ) + I si ( t ) e η ] 1 ( i is susceptible at t ) + γ ( I a ( t ) + I s ( t ) ) + ϕE ( t ) # dt ! ( S16 ) × exp − ξ N X i = 1 t ( I ) i e b TE x i ! exp   − Z T 0 X k = 0 , 1 X ( A , B ) ∈S h α ABk M dAB ( t ) + ω ABk M cAB ( t ) i 1 ( t ∈ T k ) dt   . In addition to the notation explained in Section 2 , here n ( int ) I , n ( ext ) I denote the total number of infection ( manifestation ) cases due to internal and external sources , respectively . Again , similar to previous deﬁnitions , for convenience , if an individual i never got infected , then we set t ( E ) i = t ( I ) i = t ( R ) i = T . Examining the above expression , it is obvious that estimation of all previously existing parameters are not really impacted , except that all formulas related to β , b S , η and ϕ should be restricted to internal infection cases instead of all infection cases . Therefore , equations ( 12 ) - ( 15 ) shall remain completely unchanged , and the rest of the partial derivatives should be modiﬁed slightly , on top of adding two more for ξ and b E : ∂‘ ∂β = n E β − N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # , ( S17 ) ∂‘ ∂b S = X i : i ∈I ( int ) x i − β N X i = 1 e x Ti b S " Z t ( E ) i 0 ( I ai ( t ) + I si ( t ) e η ) dt # x i , ( S18 ) ∂‘ ∂e η = X i : i ∈I ( int ) I si ( t ( E ) i ) I ai ( t ( E ) i ) + I si ( t ( E ) i ) e η − β N X i = 1 e x Ti b S Z t ( E ) i 0 I si ( t ) dt , ( S19 ) ∂‘ ∂ϕ = n ( int ) I ϕ − Z T 0 E ( t ) dt , ( S20 ) ∂‘ ∂ξ = n ( ext ) I ξ − N X i = 1 t ( I ) i e b TE x i , ( S21 ) ∂‘ ∂b E = X i : i ∈I ( ext ) x i − ξ " N X i = 1 t ( I ) i e b TE x i # x i . ( S22 ) Same as described in Section 3 . 1 , solving for MLEs requires setting all partial derivatives to zero , which leads to an updated inference method that includes all steps in Section 3 . 1 , with an additional iterative procedure that runs until convergence or the maximum number of iterations is reached : • update ξ with ( S23 ) ˆ ξ = n ( ext ) I P Ni = 1 t ( I ) i e b TE x i ; • update b E by solving 0 = X i : i ∈I ( ext ) x i − ξ " N X i = 1 t ( I ) i e b TE x i # x i 6 = N X i = 1 z i x i − N X i = 1 e x Ti b E + log ξ + log t ( I ) i x i , ( S24 ) where z i = 1 ( i ∈ I ( ext ) ) , and ( very similar to our treatment to b S in ( S11 ) ) this is equivalent to solving for the linear coefﬁcients of a Poisson regression model with individual offset log ξ + log t ( I ) i . Therefore , with this updated inference procedure for maximum likelihood estimation from complete data , we can run the inference algorithm stated in Section 4 on the real data , where epidemic observations are incomplete . Note that the addition of the external infection sources doesn’t affect conditional sampling of the missing exposure times or recovery times , so Step 1 and Step 2 of the inference scheme remains unchanged , while only Step 3 is modiﬁed to the procedure discussed above . S4 . 2 . Survey questions used to derive individual characteristic “change _ behavior” . The following prompt is copied verbatim from the original eX - FLU survey : The next section asks questions about a possible outbreak of pandemic ﬂu in the US - a new type of ﬂu that spreads rapidly among humans and causes severe illness . Imagine that a lot of people were getting very sick from the ﬂu and the ﬂu was spreading rapidly from person to person when you answer the following questions . During an outbreak , would you voluntarily make the following changes to your life ? ( Select Yes ( 1 ) or No ( 0 ) . ) 1 . Cancel plans with friends , other students , or family members ; 2 . Avoid busy public places - e . g . , shopping areas , movie theaters , restaurants ; 3 . Cancel inter - state or international travel plans ; 4 . Stock up on food and / or other necessities ; 5 . Avoid public transportation , including University buses ; 6 . Stay in your residence hall room if you were feeling sick ; 7 . Stay in your residence hall room to avoid contact with sick people ; 8 . Reduce contact with people outside of your residence ; 9 . Wear a face mask when out in public ; 10 . Be absent from class ; 11 . Be absent from work ; 12 . Assist sick neighbors or friends by bringing them food or supplies ; 13 . Limit shopping to living essentials , e . g . food , medicine . S4 . 3 . Survey questions used to derive individual characteristic “prevention” . The fol - lowing prompt is copied verbatim from the original eX - FLU survey : Do you believe that the following practices reduce your risk of catching ﬂu ? ( Score from 1 to 5 ; 1 = strongly disgree , 5 = strongly agree . ) 1 . Reducing the number of people you meet over a day ; 2 . Avoiding public transportation , including university buses ; 3 . Cleaning or disinfecting things you might touch ; 4 . Washing your hands regularly with soap and water ; 5 . Wearing a face mask when out in public ; 6 . Avoiding hospitals or doctors’ ofﬁces .
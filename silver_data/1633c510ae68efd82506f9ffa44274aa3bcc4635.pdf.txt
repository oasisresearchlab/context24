Modeling the Analog Circuit Design Feature Variety Cristian Ferent and Alex Doboli Department of Electrical and Computer Engineering State University of New York at Stony Brook Stony Brook , New York , USA Email : { Cristian . Ferent , Alex . Doboli } @ stonybrook . edu Abstract —This paper presents a method to model the design feature variety in analog circuits , such as the various topological structures present in a set of circuits devised for the same purpose ( like OpAmps or OTAs ) . The insight is important to characterize the novel and similar features in a circuit , the conditions under which existing design features can be reused in new circuits , and the exploration of new conceptual designs . The paper introduces the four basic operators used in modeling : circuit comparison , circuit instantiation - abstraction , circuit combination , and design feature induction . A case study presents the circuit feature variety modeling for a set of modern OpAmps . I . I ntroduction Most design tools for analog and mixed - signal ( AMS ) cir - cuits target tedious but conceptually - well understood , routine activities , like transistor sizing and device placement and routing . Having enough knowledge ( insight ) on a design task enables one to formulate explicit , closed - form descriptions of the task , e . g . , models and rules [ 1 ] – [ 5 ] . The design task is then accomplished by solving the closed - form descriptions using mathematical solvers or heuristic optimization algorithms . In contrast , there is less knowledge available for design problems that introduce conceptually new challenges or prob - lems which evolve over time . There are usually no closed - form descriptions or speciﬁc design rules available unless a signiﬁcantly large number of conceptually - similar designs are solved ﬁrst manually . The solving process involves reasoning and decision making in an e ﬀ ort to address open - ended issues and create the missing domain knowledge . In particular , circuit topology design and reﬁnement for novel applications requires signiﬁcant conceptual design for ﬁnding new principles of signal processing and control . New ways of connecting struc - turally the devices , novel rules for constraining the device operation , and new sub - structures might emerge during rea - soning . Devising a representation model to express expanding and evolving circuit design knowledge is a ﬁrst step towards creating new design tools that can e ﬀ ectively tackle a wide range of problems without closed - form descriptions . This paper present a formal model for deﬁning concept structures to describe domain knowledge in analog circuit design . The knowledge is used mainly in synthesis and reﬁne - ment of AMS circuit topologies . Figure 1 shows that concept structures expand the traditional design space model , used by design tools for transistor sizing and layout generation . Concept structures express symbolically the design features that create new conceptual solutions ( e . g . , circuit topologies , signal ﬂow graphs , etc . ) at various levels of abstraction . Each Concept 1 v 2 T 1 T 2 Available P solutionNumerical Unkown Abstractionlevels combinations & Concept Incremental induction concept concept concept structure space structure structure grouping v Fig . 1 . Concept structure model and traditional design space model conceptual solution ( or concept ) originates speciﬁc perfor - mance trade - o ﬀ surfaces between the related design variables , like surfaces T 1 and T 2 in Figure 1 deﬁning the trade - o ﬀ s between performance P and variables v 1 and v 2 . Trade - o ﬀ surfaces are part of the traditional design space model , and are explored through well - known circuit design methods , including optimization - based techniques . The concept structure model expresses the design feature variety of analog circuits . The concept structure model has two basic operators , ( 1 ) circuit comparison to relate the topo - logical , behavioral and performance characteristics of di ﬀ erent circuits , and ( 2 ) circuit instantiation - abstraction to organize the features as conceptual abstractions and instances at various levels . In addition , two operators are deﬁned to express the ex - tension of a concept structure : ( 3 ) circuit feature combination to create new concepts based on present circuit features , and ( 4 ) design feature induction to deduce more features following the same patterns as the existing ones . The concept structure characterizes the common and unique features in a circuit compared to other designs , the conditions under which existing features can be reused to meet new speciﬁcations , and the exploration of new conceptual designs . The concept structure for a set of state - of - the - art OpAmp circuits is also discussed . AMS circuit topology design has been notoriously di ﬃ cult to automate due to the hardness of specifying the related design space and identifying rules and algorithms to ex - plore the space [ 2 ] . There is arguably no known closed - form expression of the unrestricted design space . For particular cases , there exist algorithms that utilize a customized set of design rules [ 7 ] or a closed - form representation of a class of possible topologies [ 5 ] . Another option are evolutionary algorithms [ 8 ] , [ 9 ] , which rely on stochastic search in large populations , over successive generations to compensate for the V3 C3 R3 V2 C2 R2 V1 C1 R1 Vin− Vin + V4 C4 R4 Vy Cy Ry R c C c C b bias V in− Vin + V3 V2 V1 V4 Vo M1 M2 M3 M4 M6 M7 M5 C L M8 Vy Vx Vz ( a ) F ( 1 , 2 ) F ( 2 , 3 ) E ( 3 , 1 ) F ( + , 3 ) F ( − , 2 ) F ( − , 1 ) F ( + , 1 ) F ( 1 , 3 ) E ( 4 , 3 ) SignalInputs Circuit Nodes E ( 2 , 1 ) E ( 3 , 2 ) F ( 4 , o ) F ( y , o ) F ( 3 , o ) F ( 3 , 4 ) F ( 3 , y ) E ( o , 4 ) E ( o , 3 ) E ( y , 3 ) E ( o , y ) ( b ) Vo Co Ro Fig . 2 . ( a ) Superimposed schematic and ( b ) superimposed signal - ﬂow graph of two - stage Miller ampliﬁer and class AB two - stage ampliﬁer [ 6 ] missing domain knowledge . However , there is no guarantee that feasible topologies are created for new problems and there is no reusable insight on any novel conceptual designs that were discovered during the evolutionary process . Studies have also shown that the topological characteristics of evolved AMS topologies are di ﬀ erent of those manually designed unless speciﬁc design rules and constraints are considered [ 10 ] . The paper has the following structure . Section II o ﬀ ers an overview of the proposed concept structure model . Section III presents the algorithmic implementation of the model and Section IV discusses a case study for the conceptual structure . Conclusions end the paper . II . D esign K nowledge R epresentations for A nalog C ircuits Given a speciﬁcation ( application ) Ψ and a set of circuits Ω that implement Ψ , the goal is to construct a knowledge representation that distinguishes the circuits C i ∈ Ω based on the conceptual steps used in realizing speciﬁcation Ψ as well as the constraints under which the speciﬁcation is achieved . The proposed knowledge representation is called a concept structures . It has two basic operators for building the structure : ( 1 ) circuit comparison and ( 2 ) circuit instantiation - abstraction . Two other operators , ( 3 ) concept combination and ( 4 ) feature induction are used to extend the concept structure . The four operators are discussed next . 1 . Circuit comparison . Comparing two circuits C 1 , C 2 ∈ Ω ﬁnds the common and distinct signal ﬂow paths of the two circuits , and then computes the common ( e . g . , transfer function H comm ) and the distinguishing ( i . e . transfer functions H 1 , dif f , H 2 , dif f ) electrical behavior of the circuits , and charac - terizes the impact of the common and distinguishing behavior with respect to speciﬁcation Ψ . The operator also identiﬁes the correspondence between the circuit nodes with similar behavior and the conditions under which expressions H comm and H dif f are computed , e . g . , conditions that keep the transistors in the right operation region or the conditions under which two di ﬀ erent device parameters have the same e ﬀ ect . The correspondence set is described as Cor . The conditions set is denoted as En . Example : Figure 2 ( a ) depicts , superimposed , a two - stage Miller ampliﬁer and a class AB OpAmp . The class AB OpAmp has in addition devices M 8 and C b as highlighted in the ﬁgure . Figure 2 ( b ) presents the small - signal models of the circuits , called UBBB model [ 10 ] . All circuit nodes V j vc H ( ) Σ H ( ) H ( ) Σ A A’ H ( ) v2 H ( ) Σ H ( ) A v1 io v2 i1 i2 vc2vc1 ( a ) v1 io i1 vc1 i2 vc2 Is ( c ) v1 io v2 i1 i2 Is ( b ) Fig . 3 . Instantiation - abstraction operator for di ﬀ erential inputs are represented in the model , including the resistive ( R j ) and capacitive ( C j ) components of the poles . Node coupling is of two types , direct coupling between two nodes ( i . e . through relations F ( i , j ) ) and equivalent couplings after removing the feedback connections ( e . g . , through expressions E ( k , j ) ) . H comm is the transfer function produced by the common pole and coupling expressions in the two signal ﬂow graphs . H dif f are the transfer functions that results from the unique pole and coupling expression of the circuits , such as the encircled expressions in Figure 2 ( b ) . Set Cor includes the following nodes of the two circuits : V in − , V in + , V 1 , V 2 , and V 4 . Two circuit nodes have similar behavior if their pole compo - nents and ingoing coupling di ﬀ er only by a small margin ( ǫ ) . The two nodes are called ǫ - matched . The unmatched nodes in Figure 2 are V 3 , V y , and V o . Based on the circuit comparison operator , circuit C 1 is expressed with respect to circuit C 2 as follows : < H comm , H 1 , dif f , Cor , En > ( 1 ) and similarly , circuit C 2 is described with respect to circuit C 1 as < H comm , H 2 , dif f , Cor , En > . 2 . Circuit instantiation - abstraction . Instantiation - abstraction is the operator that replaces signals or blocks in a design through clusters of signals or blocks with the same behavior , such that at least one of the following four conditions is met : ( i ) the modiﬁed circuit is closer to the physical implementation than the starting design , ( ii ) the behavior of the resulting circuit o ﬀ ers a better matching to speciﬁcation Ψ than the original design , ( iii ) the constraints of the original design are relaxed in the new circuit , and ( iv ) the speciﬁcation - relevant trade - o ﬀ s are changed in the new circuit . The original circuit is called abstraction and the new circuit is its instance . Example : Figure 3 illustrates the instantiation - abstraction operator . Figure 3 ( a ) presents the block structure of a simple di ﬀ erential input pair . Signals v c 1 and v c 2 in Figure 3 ( a ) are C4 v1 M1 C2 vx vy M1 M4 vg1 vf vo vg v1 C5 vo vx vy M1 vg vg1 vf M4 v1 ve V1 V4 V2 V3 M3 M4 M2 M1 IWCM M2 v1 vo M1 vx C1 V1 V4 V2 V3 M1 M2 M4 M3 CCM M2 M3 ve vo vx vy M1 vg vg1 M4 v1 C3 ve M2 M3 vx vo vy vg M2 M3 M2 M3 ve ( a ) ( b ) Fig . 4 . Concept combinations for current mirrors replaced in Figure 3 ( b ) with block A ( ) that generates both ( the same ) signals . Similarly , in Figure 3 ( c ) , the two signals are instantiated with the structure including blocks A ( ) and A ′ ( ) , thus the new circuit is also an instance of that in Figure 3 ( a ) . Set Assoc deﬁnes the association between the more abstract signals and blocks in C 1 and their corresponding clusters in C 2 . For example , in Figure 3 ( a ) , the abstract signals v c 1 and v c 2 are instantiated as the encircled clusters in Figures 3 ( b ) and ( c ) . Circuit C is expressed with respect to the set of circuits Ω as follows : < H abstr , H inst , Assoc , En > ( 2 ) where H abstr is the transfer function of the abstraction of circuit C produced using the circuits in set Ω . H inst is the instantiation introduced by circuit C for its abstraction . Assoc is the association list between signals and blocks in the abstract concept and C . En are the constraints under which the two mathematical expressions are valid . 3 . Concept combinations . Concept combination produces a new circuit concept for speciﬁcation Ψ by mixing the features of two circuits . The resulting design has new features that are not an additive compositions of the features of the two designs . Figure 4 illustrates two di ﬀ erent kinds of concept combi - nations . In Figure 4 ( a ) , the basic current mirror ( CM ) circuit ( C 1 ) is combined with the Improved Wilson CM ( IWCM ) to create a new concept , cascoded CM ( CCM ) . Concept CCM is an instance of C 1 , thus features of IWCM are transferred to the combined concept . The concept combination in Figure 4 ( b ) produces concept C 4 which combines features from both con - cepts C 2 and C 3 without being an instance of any of the two . Concept C 4 has two nodes v g and v g 1 that can be connected to a number of alternative circuit nodes shown with dashed lines . In contrast , each of the combined concepts C 2 and C 3 has a single node with variable connections , hence , as their topology is more constrained , none of the two concepts can instantiate alone C 4 . Concept C 5 is an instance of concept C 4 . The connections of nodes v g and v g 1 are now decided . 4 . Design feature induction . The induction operator uses the existing information on design feature variety of the expressions H inst ( equation ( 2 ) ) of existing instances and the same abstraction is used to create new expressions H inst . R C2 C3 C1 C4 C5 ( a ) 1 2 3 ( b ) C2 C3 C4 C1 C5 C6 C7 C8 C9 C10 C11 U1 U2 S S T T Fig . 5 . Concept abstraction example Example : The complementary property of mathematical operators , like equal and di ﬀ erent , summation and di ﬀ er - ence , integration and di ﬀ erentiation , can be used to induce new H instr . The instance in Figure 3 ( b ) for the abstraction in Figure 3 ( a ) has v c 1 = v c 2 , which induces the situation in which v c 1 , v c 2 , thus the design in Figure 3 ( c ) . III . A lgorithms to C onstruct K nowledge R epresentations This sections discusses the algorithms for implementing the four operators of the proposed concept structure . 1 . Circuit comparison . A detailed presentation of the al - gorithm for automatically comparing two circuits is presented in [ 10 ] . The algorithm ﬁrst ﬁnds the maximal set of ǫ - matched nodes in the two circuits , such that the signal ﬂows through the matched nodes is similar in the two circuits . Then , the transfer functions of the maximal sets of ǫ - matched nodes describe the common electrical behavior of the circuits ( H comm ) , and the transfer functions due to the unmatched nodes express the distinguishing behavior of the circuits ( H dif f ) . Next , the impact of H comm and H dif f on circuit performance is found , i . e . gain , bandwidth , slew rate , noise , and PSRR , and the trade - o ﬀ expressions of each circuit are also produced . The trade - o ﬀ s explicitly show the performance beneﬁt of a circuit compared to another as well as its performance bottlenecks . 2 . Circuit instancing - abstraction . The procedure constructs the set of abstract concepts for a given set of instances . Figure 5 illustrates the procedure . The procedure uses two related notions : ( i ) maximum association of two symbolic expressions and ( ii ) association of unmatched symbols . Maximum association ( MA ) of two symbolic expressions E 1 and E 2 ﬁnds the association between the operators and variables in E 1 and E 2 , such that the value due to the unmatched symbols is minimum . Example : Let’s assume that variables x i > 1 . MA between E 1 = ( x 1 + x 2 ) x 3 + x 1 + x 2 + x 3 and E 2 = ( x 1 + x 5 ) x 3 + x 6 is as follows : x 1 and x 3 in E 2 are associated with the ﬁrst for all unmatched nodes k in subgraphs m { 1 C 2 C n , , . . . H abstr H comm { H j , diff C 2 C n C 1 , } > = compare ( < ) ; , , . . . H abstr = H comm ; H abstr = H abstr U R ; inputs : ; output : ; begin procedure generate _ abstraction S = set of matched nodes with output edges to unmatched nodes ; T = set of matched nodes with input edges from unmatched nodes ; R = matched nodes in the subgraphs and arcs between matched nodes ; Q = subgraphs originating at n in S and ending at p in T ; a = arc from n to p ; label a with MA and Rel of the signal paths ; H abstr = H abstr ; U a } } } end procedure . for all signal paths from n in S to p in T and passing through k { for all subsets of Q with subgraphs m from different circuits { C Fig . 6 . Algorithm to construct the abstraction of a circuit set occurrences of x 1 and x 3 , respectively in E 1 not with their second occurrence in E 2 . This error is smaller than if the two variables are associated with their second occurrence in E 1 . Association of unmatched symbols ( AUS ) establishes a cor - respondence between the unmatched symbols in two symbolic expressions E 1 and E 2 . After ﬁnding MA for E 1 and E 2 , the remaining unmatched symbols are linked depending on the syntactic structure of the expressions . Example : For the previous expressions , x 2 ∈ E 1 is associated to x 5 ∈ E 2 and x 1 + x 2 + x 3 ∈ E 1 is associated to x 6 ∈ E 2 . During the abstraction process , two associated , unmatched symbols or sub - expressions v 1 and v 2 are replaced by a new symbol R with a domain equal to the reunion of the domains of v 1 and v 2 . Thus , symbol R acts as a place holder for both v 1 and v 2 . This step is denoted as R = Repl ( v 1 , v 2 ) . Figure 5 illustrates the abstraction procedure for a set of ﬁve designs described in Figure 5 ( a ) as their signal ﬂow graphs . The resulting abstract concepts are show in Figure 5 ( b ) . Each of the initial designs is highlighted with bold line . Concepts C 6 − C 11 are the abstractions . For example , concepts C 2 and C 4 originate the abstract concept C 6 . MA for the transfer functions of the two circuits includes the pole and coupling expressions of the matched nodes in the two circuits . The matched nodes are shown with bold line . AUS includes the expressions corresponding to the subgraphs shown in bold dotted line . Let’s denote the two expressions as U 1 and U 2 . Then , for concept C 6 , the arc shown in bold line is annotated with a symbolic expression R = Repl ( U 1 , U 2 ) . Note that multiple abstractions can result for a set of instances . For example , concepts C 1 and C 6 create two ab - stractions , C 7 and C 8 . Multiple abstractions result , if MAs include multiple associations that produce a similar ( or same ) error of the unmatched symbols . For example , node 1 in C 1 can be associated either with node 2 or with node 3 in C 6 . This creates two di ﬀ erent AUS , and thus the two abstractions . Figure 6 presents the algorithm to construct the abstractions for a set of circuits C 1 , C 2 , . . . , C n . All circuits must serve the same purpose , like OTA or OpAmp . The result is description H abstr of the abstraction , e . g . , its signal ﬂow graph or transfer end procedure ; 1 C 2 comb SetComb H 1 , inst < H 1 , abstr , , En 1 > C 1 identify for ; H 1 , diff H 2 , diff for all subsets S of U { H comm comb SetComb = comb SetComb U T ; T = Add ( , S ) ; if ( T is feasible ) { } comb SetComb H comm H 1 , diff C 2 C 1 = compare ( , ) ; , < , H 2 , diff 2 , diff Cor , En > H i , abstr H 1 , abstr H 2 , abstr = compare ( , ) ; H comm comb SetComb = comb SetComb U T ; combinations of distinct abstractions procedure generate _ combination inputs : , ; output : ; begin identify for ; < H , , En > H C 2 , abstr 2 , inst 2 2 } combinations of distinct features combinations using abstraction } T = Add ( if ( T is feasible ) { } = comb SetComb U T ; , S ) ; , < , H 2 , diff 2 , diff Cor , En > H comm H 1 , diff for all subsets S of U { H i , inst H j , diff abstr abstr abstr for all subsets S of U { H 1 , diff H 2 , diff abstr abstr T = Add ( , S ) ; if ( T is feasible ) { abstr } } C Fig . 7 . Algorithm to construct concept combinations func tion . The ﬁrst step compares the circuits and produces the symbolic expressions of H comm , H j , dif f , and the set of ǫ - matched and unmatched nodes . Then , H abstr is initialized as H comm , the common part of all C i . Set S is the set of matched nodes with outgoing arcs to unmatched nodes , and set T is the set of matched nodes with ingoing arcs from unmatched nodes . ( Sets S and T are indicated in Figure 5 ( b ) for C 2 and C 4 ) . Set Q of signal paths originating at nodes in S and ending at nodes in T produces the additional sub - graphs that must be included in H abstr ( Set Q is shown with bold dashed line for C 2 and C 4 ) . Separate sub - graphs are created for each subset of paths in set Q , such that each path is from a di ﬀ erent C i . Each sub - graph includes any remaining matched nodes on the considered signal paths , the arcs between matched nodes , and a set of new arcs a built as follows . Each arc a corresponds to paths in distinct C i from the same node n ∈ S to the same node p ∈ T , such that the paths pass through at least one unmatched node k . The label of arc a is the symbolic expression corresponding to MA of the considered paths as well as the place holders created using Repl for the unmatched sub - expressions of the paths . ( The bold arc with label R in C 6 is such an arc a ) 3 . Circuit feature combination . Figure 7 calculates the concept combinations for two circuit concepts C 1 and C 2 . The output S etComb comb is the set of all possible concept combinations . The procedure ﬁrst compares the two circuits and then computes their abstractions . The ﬁrst for loop ﬁnds concept combinations by combining H comm , the common part of the two circuits , with subsets S of nodes and arcs from the distinguishing parts of the two circuits . The combinations that are feasible are added to set S etComb comb , e . g . , those that modify the trade - o ﬀ s to improve performance or relax the constraints . The second for loop produces concept combi - nations using the abstractions of the two concepts ( H i , abstr ) and ( c ) H ( ) H ( ) C ( ) A H ( ) H ( ) Σ N ( ) N ( ) Σ Σ v1 v2 vc i1 Is i2 io A Σ H ( ) H ( ) N ( ) N ( ) A Σ i1 i2 io v2 v1 vc Is ( a ) ( b ) v1 io i1 i2 v2 vc Σ Is Fig . 8 . Design feature induction for di ﬀ erential inputs with improved nonlinearity features of C 1 and C 2 , i . e . subsets S of the instantiated features H i , inst and the distinguishing features of the other circuit ( H j , dif f ) . The third loop creates combinations only using the two abstractions . The common parts of H abstr are combined with subsets S of nodes and arcs from the distinguishing parts of the two abstractions . 4 . Design feature induction . The induction operator explores the instance space of an abstraction , where the instance space includes all possible instances that can be devised for the ab - straction . Let’s assume set Λ of existing instances , where each instance j is characterized by < H j , abstr , H j , inst , Assoc j , En j > ( equation ( 2 ) ) . Then , in the instance space , instance expres - sions H j , inst can refer to the following situations : ( i ) same signal of the abstraction , ( ii ) same block of the abstraction , ( iii ) di ﬀ erent signals , ( iv ) di ﬀ erent blocks , and ( v ) combina - tions of the four previous instances . Example : The designs in Figures 8 ( a ) and ( b ) are instances of the abstraction in Figure 3 ( b ) . The blocks involved in the two instances are marked with dotted lines . Note that the two instances involve di ﬀ erent signals of block A ( ) in the abstraction in Figure 3 ( b ) . Finding induction operators based on set Λ involves ﬁrst identifying the structures corresponding to the di ﬀ erent H j , inst , such as the structures marked with dotted lines in Figures 8 ( a ) and ( b ) . Then , a generic structure is ﬁtted for the set of H j , inst , such that each H j , inst results by selecting some of the blocks of the structure and dropping others . In addition , the generic structure must serve the same common purpose ( goal ) as the instances , such as having minimum nonlinearity for signal v c in the two ﬁgures . Any new instance H inst < Λ must be based on the generic structure and serve the same purpose as the given instances . For example , the dotted structure in Figure 8 ( c ) is induced by the structures in Figures 8 ( a ) and ( b ) as the new structure follows the same pattern . IV . C ase S tudy This section discusses a case study for constructing the concept structure for a set of modern ampliﬁer designs [ 6 ] , [ 11 ] – [ 17 ] and the classic 2 - stage Miller circuit . The analysis considers AC behavior of the circuits to identify conceptual abstractions and design instances . The structure is utilized to create concept combinations and induced features that are not part of the initial set of circuits . The AC behavior of the circuits is represented as UBBB models , which include the cross - coupling between the circuit H H = Pz J = ( Ny No ) J = ( N1 Ny ) F = PxPy J H J H Px Py O9 H J F G J F F H Pw F , H = Cx = Cgd−G = 1 G = 0 O2 F = 0 O4 H = 0 O3 J = 0 H = 0 Pw Pw O8 Pz H = 0 H = 1 O11 O10 No Ny N1 Ny O6 O7 O5 F = 1 O Po P1 H O1 J = 0 Cx = Cgs + sCsC sCgd−gmgsCgd sCgd−gmg sCgd } s C g s + g m g s C g s s C g s + g m g s C g s s C g s + g m g s C g s s C g s + g m g s C g s sCy + K sCy } sCsC sCgd−gmgsCgd s C g d − g m g s C g d s C y + K s C y s C gd − g m g s C gd sCgd−gmgsCgd s C s C sCsC sCgdsCgd−gmg s C gd − g m g s C gd sCsC s C g d − g m g s C g d sCgd−gmgsCgd sC sC sCsC sCgd−gmgsCgd sCgd−gmgsCgd } sCsC } sCsC sCgd−gmgsCgd sCgd−gmgsCgd } sCsC } sCsC s C gd − g m g s C gd sCgd−gmgsCgd sCgd−gmgsCgd } s C gd − g m g s C gd sCx + / −gmg sCx } sCsC } sCx + / −gmg sCx } sCsC } sCsC } sCsC sCgd−gmgsCgd } sCgs + gmg sCgs } sCgs + gmg sCgs } sCgs + gmg sCgs } s C gd − g m g s C gd sCgd−gmgsCgd } Fig . 9 . Concept strutcure of the OpAmp output stage blocks nodes and the poles at the nodes . Each OpAmp design was divided into three blocks , e . g . , input , single - ended conversion , and output blocks . A separate concept structure was built for each block type . The top level concepts present more abstract , conceptual attributes which are common to its instances . For brevity , the paper presents the concept structure of the OpAmp output blocks . The arcs in green are common to multiple concepts . The arcs in red are unique to a concept . The top concept in Figure 9 , concept O , describes concep - tually the abstract characteristics of the output blocks of the considered OpAmps . The features of the top concept include two separate output signal paths characterized by functions F and H , with generic form Cx ± g mg . Also , there are two ways of compensation loops . The loops are expressed by cross - coupling sC / sC together with functions G and J . At this abstraction level , both poles P 1 ( block input ) and Po ( output ) are in generic form . Note that the top - level concept covers a wide range of output stage conﬁgurations , including bu ﬀ ers and multi - stage ampliﬁers with or without class AB outputs . Concept O has two instances , concepts O 1 and O 2 . They separate , based on the implemented concept , the OpAmp set into two categories . Concept O 2 corresponds to single - stages or output bu ﬀ ers ( with no voltage gain ) since concept O 2 lacks any compensation loops . The pole structures is still generic for this concept . Concept O 1 describes multi - stage compensated OpAmp designs , and is discussed shortly . Concept O 2 has two instances . Concept O 4 results from its abstraction O 2 by adding the features F = 0 and H = 0 . Note that concept O 4 is still conceptual , thus does not represent an implementation . It does not include any additional output structure , and represents the case of the single stage ampliﬁer topology . This concept is used in designs [ 11 ] , [ 16 ] . Concept O 3 is the second instance of concept O 2 . The generic cross - coupling from input to output is instantiated as C gs + gmg / C gs ( Cx = C gs + ) through the intermediate node structures captured by functions F and H . Both functions have the same cross - coupling form across the intermediate node with pole P w given by expression g md + g ms ( resistive component ) and C gd + C db + C gs + C sb + C gs + C gd + C gb ( capac - itive parts component ) . Concept O 3 , with two complementary output paths , corresponds to a bu ﬀ er design through source fol - lowers with no voltage gain ( only current gain ) . OpAmp [ 12 ] uses this concept . The dual complementary path ensures wide range output swing in both positive or negative directions . The abstract concept O 1 , the second instance of the top concept O , represents multi - stage compensated OpAmps . The two di ﬀ erent input - output paths are both characterized by the gate - drain cross - coupling C gd − gmg / C gd ( Cx = C gd − ) . The abstract functions F and H remain generic , as well as one of the compensation loops through function J . Feature G = 1 of the concept illustrates that all instantiated concepts share a direct input - output compensation loop characterized by a symmetric cross - coupling through the compensation capacitor ( sC / sC ) . Concept O 5 is an instance of O 1 for F = 1 . The con - cept describes two - stage compensated OpAmps with common source output gain stage structure ( e . g . , direct input - output gate - drain coupling through C gd − gmg / C gd ) . A simple extension of concept O 5 eliminates the second compensation loop , and produces concept O 6 . This abstract concept covers both classic and class AB output stages in ampliﬁer design . For H = 0 , the alternate output path is eliminated , and concept O 7 represents the output structure found in conventional compensated two - stage ampliﬁers ( class A ) . The basic conﬁguration is used in the Miller ampliﬁer and circuits [ 15 ] , [ 17 ] . OpAmp [ 17 ] further expands the concept by using two identical , but complementary , instantiations of the concept . This allows rail - to - rail operation at the expense of additional complexity and power consumption . In contrast to O 7 , concept O 8 keeps the alternate output path and instantiates it through an intermediate node ( i . e . P z ) using a cross - coupling of form sCy + K / sCy . Concept O 8 corresponds to class AB output stages . Two OpAmps in the set use this concept [ 6 ] , [ 14 ] . Circuit [ 14 ] uses Cy = C gs and K = g mg to implement the additional path through a gate - source connection ( source follower ) to the intermediate node . OpAmp [ 6 ] uses a di ﬀ erent instantiation of the concept with C y = C ( discrete capaci - tance ) and K = 0 to provide the coupling to the intermediate node . This changes the P 1 pole structure to include the extra capacitor C gs + C gd + C gb + C + C . Pole P z is given by a diode connected transistor , extra capacitor , and the gate connection of the added signal path transistor ( g md + g mg and C gs + C db + C gb + C + C gs + C gd + C gb ) . While both designs o ﬀ er better driving capabilities with limited increase in distortion ( compared to the conventional case of O 7 ) , the OpAmp in [ 6 ] has reduced static power dissipation compared to [ 14 ] . Exploring the alternative path from concept O 1 , function F can be instantiated through two additional intermediate nodes ( P x and P y ) with gate - drain cross - coupling C gd − gmg / C gd in concept O 9 . This introduces an additional cascaded gain stage . The abstract concept can be mapped to various three - stage compensated ampliﬁers . Concept O 11 results by setting H = 0 and placing the second compensation path between N y and output N o . The concept implements a nested - Miller three stage ampliﬁer output struc - ture . It is not utilized in the considered OpAmp set ( but it is used for comparison in the design of [ 13 ] ) . Concept O 10 is the second instance of concept O 9 . It places the second compensation path across input N 1 and N y and uses a secondary direct input - output path through gate - drain cross - coupling C gd − gmg / C gd . This concept implements a positive feedback compensation scheme for three - stage ampliﬁers . In contrast to concept O 11 , O 10 changes input pole P 1 by adding the second compensation capacitor and the gate connection of the secondary output path . OpAmp [ 13 ] uses this concept to improve frequency behavior , settling time , and slew rate compared to the nested - Miller design for concept O 11 . V . C onclusions This paper presents the concept structure model to express the design feature variety in analog circuits . The model has four basic operators , circuit comparison , circuit instantiation - abstraction , circuit combination , and design feature induction . The insight o ﬀ ered by the model is important to characterize the novel and common features in a circuit and the exploration of new conceptual designs . The analyzed OpAmp set imple - ments only 9 distinct topologies , however , there are more than 140 distinct combinations that can result using the concept structures for the OpAmps . Concept O 11 in Figure 9 does not exist in the set but can be obtained using the model . Some combinations are not feasible since the advantages of one concept are eliminated when combined with another concept . For example , concept O 4 ( single stage amp - no output stage ) is infeasible for low voltage , high gain requirements . A cknowledgment This material is based upon work supported by the National Science Foundation under Grant No . 0856038 . Any opinions , ﬁndings , and conclusions or recommendations expressed in this material are those of the author ( s ) and do not necessarily reﬂect the views of the National Science Foundation . R eferences [ 1 ] M . Mar Hershenson , S . Boyd , and T . Lee , “Optimal design of a cmos op - amp via geometric programming , ” IEEE Trans . CADICS , vol . 20 ( 1 ) , pp . 1 – 21 , 2001 . [ 2 ] E . Martens and G . Gielen , “Classiﬁcation of analog synthesis tools based on their architecture selection mechanisms , ” Integration , the VLSI Journal , vol . 41 , pp . 238 – 252 , 2008 . [ 3 ] B . Liu and et al . , “E ﬃ cient and accurate statistical analog yield op - timization and variation - aware circuit sizing based on computational intelligence techniques , ” IEEE Trans . CADICS , vol . 30 ( 6 ) , 2011 . [ 4 ] T . Massier , H . Graeb , and U . Schlichtmann , “The sizing rules method for CMOS and bipolar analog integrated circuit synthesis , ” IEEE Trans . CADICS , vol . 27 , pp . 2209 – 2221 , Dec . 2008 . [ 5 ] Y . Wei and et al . , “Systematic methodology for designing reconﬁgurable delta sigma modulator topologies for multimode communication sys - tems , ” IEEE Trans . CADICS , vol . 26 ( 3 ) , 2007 . [ 6 ] J . Ramírez - Angulo and et al . , “A free but e ﬃ cient low - voltage class - AB two - stage operational ampliﬁer , ” IEEE Trans . Circuits Syst . II , vol . 53 , pp . 568 – 571 , Jul . 2006 . [ 7 ] R . Harjani and et al . , in A Prototype Framework for Knowledge - based Analog Circuit Synthesis . Proc . DAC , 1987 . [ 8 ] T . Sripramong and C . Toumazou , “The invention of CMOS ampliﬁers using genetic programming and current - ﬂow analysis , ” IEEE Trans . CADICS , vol . 21 , pp . 1237 – 1252 , Nov . 2002 . [ 9 ] A . Das and et al . , “Topology synthesis of analog circuits based on adaptively generated building blocks , ” in Proc . DAC , 2008 . [ 10 ] C . Ferent and A . Doboli , “Symbolic matching and constraint generation for systematic comparison of analog circuits , ” IEEE Transactions on Computer - Aided Design of Integrated Circuits and Systems , vol . 32 , no . 4 , pp . 616 – 629 , 2013 . [ 11 ] E . Yuce and S . Minaei , “A modiﬁed CFOA and its applications to simulated inductors , capacitance multipliers , and analog ﬁlters , ” IEEE Trans . Circuits Syst . I , vol . 55 , pp . 266 – 275 , Feb . 2008 . [ 12 ] G . Palumbo and S . Pennisi , “Current - feedback ampliﬁers versus voltage operational ampliﬁers , ” IEEE Trans . Circuits Syst . I , vol . 48 , pp . 617 – 623 , May 2001 . [ 13 ] J . Ramos and M . S . J . Steyaert , “Positive feedback frequency compen - sation for low - voltage low - power three - stage ampliﬁer , ” IEEE Trans . Circuits Syst . II , vol . 51 , pp . 1967 – 1974 , Oct . 2004 . [ 14 ] B . J . Maundy , A . R . Sarkar , and S . J . Gift , “A new design topology for low - voltage CMOS current feedback ampliﬁers , ” IEEE Trans . Circuits Syst . II , vol . 53 , pp . 34 – 38 , Jan . 2006 . [ 15 ] H . - C . Choi and et al . , “A 1 . 2 - V 12 - b 120 - MS / s SHA - free dual - channel nyquist ADC based on midcode calibration , ” IEEE Trans . Circuits Syst . I , vol . 56 , pp . 894 – 901 , May 2009 . [ 16 ] Y . Zheng and et al . , “A CMOS VGA with DC o ﬀ set cancellation for direct - conversion receivers , ” IEEE Trans . Circuits Syst . I , vol . 56 , pp . 103 – 113 , Jan . 2009 . [ 17 ] L . Yao and et al . , “Sensitivity - enhanced CMOS phase luminometry system using xerogel - based sensors , ” IEEE Transactions on Biomedical Circuits and Systems , vol . 3 , pp . 304 – 311 , Oct . 2009 .
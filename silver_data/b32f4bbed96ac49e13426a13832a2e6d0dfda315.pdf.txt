Articles nAture methods | VOL . 9 NO . 3 | MARCH 2012 | 283 cellular signaling processes depend on spatiotemporal distributions of molecular components . multicolor , high - resolution microscopy permits detailed assessment of such distributions , providing input for fine - grained computational models that explore mechanisms governing dynamic assembly of multimolecular complexes and their role in shaping cellular behavior . however , it is challenging to incorporate into such models both complex molecular reaction cascades and the spatial localization of signaling components in dynamic cellular morphologies . here we introduce an approach to address these challenges by automatically generating computational representations of complex reaction networks based on simple bimolecular interaction rules embedded into detailed , adaptive models of cellular morphology . using examples of receptor - mediated cellular adhesion and signal - induced localized mitogen - activated protein kinase ( mAPK ) activation in yeast , we illustrate the capacity of this simulation technique to provide insights into cell biological processes . the modeling algorithms , implemented in a new version of the simmune toolset , are accessible through intuitive graphical interfaces and programming libraries . The increasing spatial resolution of optical microscopy , in con - cert with new technologies for labeling cell constituents , is con - tinuously revealing new details about how cells actively tailor the chemical composition of membrane domains during signaling or generate intracellular concentration gradients in response to localized external signals 1 – 3 . Reflecting these insights , modern simulation approaches no longer assume well - mixed biochem - istry but instead simulate signaling processes in computational representations of cellular geometries ( see Supplementary Note 1 for a discussion of available approaches ) . In parallel , experimen - talists and theorists have begun to explore the physiological role of multicomponent molecular complexes . Systematic analyses of the binding partners of receptor tyrosine kinases such as the epider - mal growth factor receptor 4 or of the assembly of ‘signalosomes’ around scaffold proteins 5 have revealed that signaling pathways are intricate factories , dynamically assembling and disassembling molecular complexes with specific functions . computational modeling of cellular signaling processes embedded into dynamic spatial contexts Bastian R Angermann 1 , 3 , Frederick Klauschen 1 – 3 , Alex D Garcia 1 , 3 , Thorsten Prustel 1 , Fengkai Zhang 1 , Ronald N Germain 1 & Martin Meier - Schellersheim 1 Defining computational models for exploring the reaction dynamics of networks of these large multimolecular complexes requires approaches that differ from the traditional strategy of explicitly formulating all mass - action equations for the complete set of reactants in a system . The reason is that reaction dynamics in systems with many molecular components , or with compo - nents that have many binding sites or internal states , may involve very large numbers of alternative interactions and complexes , a phenomenon sometimes referred to as ‘combinatorial explosion’ 6 . However , because all reactions in such networks are based on interactions between pairs of molecular binding sites , much of the complexity can be reduced to defining the rules that describe these binary interactions . Taking advantage of this underlying reality , ‘rule - based’ approaches leave the task of actually assembling the complexes and reaction networks to the computer , once the inves - tigator has defined the fundamental components and their pair - wise interactions 7 – 12 . Rule - based simulation approaches have , however , so far been limited with regard to their ability to take into account the cellular morphologies in which the molecular networks operate and had to assume static geometries or well - mixed biochemical conditions . Here we introduce a computational approach that can be used to simulate complex signaling processes in the context of real - istic and even dynamic cellular morphologies . This capacity is based on the ability to generate reaction networks automatically , taking into account the location - dependent molecular interaction possibilities determined by the dynamic membrane geometries and three - dimensional ( 3D ) shapes of the simulated cells ( Fig . 1 and Supplementary Note 2 ) . The approach is a major exten - sion and improvement of the modeling tool Simmune 7 . Most of its functionalities are available to users who prefer a graphical user interface to writing model definition scripts . It also permits modelers to simulate aspects of biology that would be difficult to address with conventional methods , such as the local dynamics of multimolecular signaling complexes in large networks . We used the approach to simulate two well - studied biological sys - tems , the reaction - diffusion processes of adhesion receptors at dynamic cell - cell contacts and the formation of MAPK activity 1 Laboratory of Systems Biology , National Institute of Allergy and Infectious Diseases , National Institutes of Health , Bethesda , Maryland , USA . 2 Institute of Pathology , Charite University Medicine , Berlin , Germany . 3 These authors contributed equally to this work . Correspondence should be addressed to B . R . A . ( bastian . angermann @ nih . gov ) or M . M . - S . ( mms @ niaid . nih . gov ) . Received 19 SeptembeR 2011 ; accepted 23 NovembeR 2011 ; publiShed oNliNe 29 JaNuaRy 2012 ; doi : 10 . 1038 / Nmeth . 1861 n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . 284 | VOL . 9 NO . 3 | MARCH 2012 | nAture methods Articles gradients by intracellular multimolecular signaling complexes in the yeast mating pheromone response . resultsmolecular reaction networks in their spatial contexts Modeling approaches that focus on phenomena of individual complexes ( for instance , receptor clustering 13 ) and that simu - late the motion and reactions performed by discrete particles incorporate spatial constraints naturally ( Online Methods and Supplementary Fig . 1 ) : complexes can only interact when they have a common location , and the rates of their interactions depend on their local abundances . However , the computational cost of particle - based simulations increases at least linearly ( and typically much faster than linearly ) with the abundance of the complexes . This means that simulating a system with 1 , 000 , 000 molecules ( roughly corresponding to a micromolar concentration in a cell of 10 µ m diameter ) will take at least 1 , 000 times longer than simulating a system with 1 , 000 mol - ecules . Because many cellular signaling phenomena involve many molecules and do not require approaches that track indi - vidual particles , they can be investigated far more efficiently by simulating the dynamics of local molecular concentrations instead of using particle - based simulators ( Online Methods and Supplementary Fig . 1 ) . It should be noted that one of the most computationally expen - sive aspects of particle - based simulations , namely capturing the diffusional motion of particles between molecular encounters and reactions , has recently been addressed with techniques that either avoid taking single Brownian diffusion steps ( Green’s - function reaction dynamics 14 ) or that take large steps and correct for the introduced error ( Smoldyn 15 ) . Nevertheless , these simulations remain very time - consuming 15 when particle numbers are large ; their immediate value lies in applications with relatively few particles to be simulated . Without taking into account spatial aspects , rule - based approaches to model cellular signaling networks can translate interaction rules directly into sets of complexes and the reactions between them , and simulate them as sets of ordinary differential equations . In contrast , for spatially resolved simulations , the rates of these reactions and even the types of reactions that will actually occur depend on the morphology in which the biochemical com - ponents of the network operate . The new simulation algorithms in Simmune therefore apply the rules that specify how molecular interactions are translated into complexes and reaction networks for each volume or membrane element individually , based on its local biochemical composition . For membrane elements that are in contact with other membranes ( for instance , as part of an intercellular contact ) the network generation algorithm addi - tionally determines whether the opposing membrane contains receptor complexes that can interact with the local molecular complexes . Each complex is then assigned a list of reaction proc - esses ( associations , dissociations or transformations ) . Finally , the diffusion - based exchange among neighboring volume or mem - brane elements is determined and added to the list of processes that now can be used to calculate how local concentrations of molecular complexes will change over time . Rule - based network creation can be computationally expen - sive ( Supplementary Note 3 ) . For simulations with high spatial resolution , Simmune has to generate local networks for thou - sands of volume and membrane elements and therefore uses a multistep strategy that first builds a nonspatial reaction network based on all possible interactions among the molecular species in the simulated biological system . This template network is then adapted to the specific local molecular environment of each volume or membrane element , which can be done much faster than creating networks de novo . Additionally , each newly generated local network is stored in a network repository that allows reuse when networks have to be built for locations with identical a Definition of signaling networks Definition of molecular interaction rules Automated generation of non - spatial reaction networks Manualimport Manualimport Morphological dynamics or spatial simulations with high complexity Definition of reaction - diffusion networks Definition and simulation of spatial aspects Definition of simulatedgeometry Simulation of reaction - diffusion network in static morphologies b Definition of molecular interactions Definition of simulated geometry Spatially resolved adaptive reaction - diffusion networks in complex dynamic cell morphologies Automated generation of reaction - diffusion networks 1 1 2 2 y z x Figure 1 | Automated spatially resolved generation of reaction networks permitted simulation of cellular signaling in realistic morphologies . ( a ) The schematic illustrates that nonspatial rule - based modeling methods can generate signaling networks based on pair - wise molecular interactions but cannot take into account the specific localizations of the molecules . Automatically generated nonspatial networks would have to be translated manually ( ‘imported’ ) into reaction - diffusion networks and then inserted into the simulated space by assigning molecular species to specific locations . Non - rule - based spatial simulation tools , in contrast , allow users to define simulated geometries and simulate predefined reaction - diffusion networks within them . Extending the latter simulations to dynamic morphologies or to spatial simulations of highly complex reaction networks is , however , not possible because the reaction - diffusion networks must be fully specified before performing the spatially resolved simulation . ( b ) Simmune’s spatially resolved automated network generator permits the definition of reaction networks based on molecular interaction rules and then generates and simulates reaction - diffusion networks while adapting them to potentially dynamic cellular morphologies such as shown here for the simulation of cell - cell contact formation . The red and blue squares in the molecule icons visualize molecular states influencing reaction properties . The yellow and blue spheres in the lower left represent the initial cellular geometries in the simulated space ( indicated by the colored coordinate system ) . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . nAture methods | VOL . 9 NO . 3 | MARCH 2012 | 285 Articles molecular composition . This strategy is efficient enough to permit the automatic creation of reaction networks even in the context of changing cellular shapes , for instance , when simulating receptor interactions at dynamic cell - cell contact interfaces . The results of the simulations we report here emphasize the potentially impor - tant differences between morphologically dynamic versus static modeling of reaction - diffusion processes . static and dynamic simulations of intercellular e - cadherin E - cadherin – mediated cell - cell adhesion is essential for the organi - zation of multicellular organisms 16 . Here we simulated cell - cell contact regulation involving just this one molecular species , under conditions in which both membranes express the same adhesion molecules and in which these molecules form homodimers or larger complexes based on these dimers 17 , 18 . Focusing just on these isolated interactions allowed us to explore a simple but important system with well - established phenomenology . The purely biochemical network resulting from the fundamen - tal interactions between E - cadherin monomers contains only seven biochemically distinct complexes composed of up to four monomers when spatial issues are ignored ( Fig . 2a , b ) . In contrast , adding to the analysis the localization of the molecular components in two adjacent cell membranes yields a considerably more com - plicated picture ( Fig . 2c ) . This is due to the fact that structurally equivalent complexes now can differ with regard to which side of the membrane - membrane interface their E - cadherin molecules belong . For example , the tetramer with an open cis interface exists in two ver - sions at the cell - cell interface , facing either one or the other cell with its ‘open’ end ( Fig 2b , c ) . Even without accounting for lateral diffusion in the membranes , a mathematical description of the possible reac - tions between the different types of complexes would require more than 100 reaction terms ( Supplementary Note 2b ) . Incorporating spatial aspects thus transforms generation of the biochemically sim - ple network of E - cadherin trans and cis dimerization into a nontrivial task , as illustrated ( Fig . 3 ) for one step of the local network genera - tion process for two adjacent membrane elements . We first investigated the accumulation of E - cadherin at the interfaces between models of morphologically static cells that we simulated as coming into close proximity before the formation of receptor contacts , mimicking cellular crowding that arises when cells enter into a pre - existing epithelial layer involved in rearrange - ments or repair . It is currently assumed that cis interactions are much weaker than trans interactions 19 and that their main function may be to stabilize trans interactions 20 . Varying the lifespan of cis bonds in trans complexes between 1 s and 100 s , we observed an accumulation of E - cadherin at the periphery of the contact zones ( Fig . 4a ) , reminiscent of the experimentally observed accumulation of E - cadherin at the edges of adhesive cell contacts ( Fig . 4b , c ) 21 . This accumulation was markedly modulated by the cis - bond lifespan and reached up to 1 . 5 - fold the concentra - tion of E - cadherin outside of the contact zones ( Fig . 4d ) . These results are consistent with the findings of a previous computa - tional model of a cell in contact with a small sphere acting as a completely absorbing surface for E - cadherin 22 . To study the evolution of local concentrations of intercellular E - cadherin complexes during the more physiological setting of grad - ual growth of receptor - mediated cellular adhesive contacts involving membranes of flexible geometry , we performed simulations with receptor interaction networks embedded into the dynamic morpho - logy of two interacting cells using a three - dimensional version of the ‘cellular Potts model’ method 23 . This method has been used to study cellular movement in models of biological 3D environments 24 . It simulates the dynamic geometries of biological cells as coherent structures consisting of 2D or 3D basic spatial elements ( for example , squares , hexagons or cubes ) through stochastic updates that calcu - late the probabilities for adding or removing volume elements based on their particular states or geometric neighborhoods . We imple - mented coupling between biochemistry and morphological dynam - ics through Potts energy terms that describe the binding status of membrane receptors ( Online Methods and Supplementary Note 3 ) . In contrast to simulations with static morphologies , combin - ing receptor interactions and morphological dynamics requires rebuilding the local molecular reaction networks every time the morphology changes to take into account new receptor interaction possibilities or to discard those that are no longer supported by the membrane geometry . c a S e l f Self Intra - complex Intra - complex Self V VI VII S e l f Reactions in trans Reactions in cis b ( 5 ) ( 1 ) ( 2 ) ( 4 ) ( 7 ) ( 9 ) ( 11 ) ( 3 ) ( 8 ) ( 10 ) ( 6 ) Possible trans reaction Possible cis reaction Result complex after single reaction Figure 2 | From nonspatial to spatial representations of E - cadherin interactions . ( a ) Schematic of E - cadherin receptor interactions in cis ( within one membrane ) and in trans ( linking two adjacent membranes ) . ( b ) Schematic of the E - cadherin reaction network assuming one cis and one trans binding site per receptor , without taking into account the membrane localization of the receptors and using a maximum complex size of four . Associations between identical components are labeled ‘self’ . ( Labels V – VII mark complexes discussed in supplementary note 2 . ) ( c ) Schematic of the consequence of embedding the network shown in b into the spatial context of two adjacent membranes . For example , complex 1 can associate with 4 ( yellow line between 1 and 4 ) to form 7 ( dashed arrow from 1 to 7 ) . The color gradients of the E - cadherin molecules ( ranging from green to blue or from purple to blue ) indicate that the complexes are treated as embedded in two adjacent membranes ; blue indicates the intercellular domains . Numbers correspond to the numbering of the differential equations in supplementary note 2 . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . 286 | VOL . 9 NO . 3 | MARCH 2012 | nAture methods Articles The overall simulation flow after the initialization of cellular biochemistry and morphology proceeded according to the fol - lowing pattern : ( i ) local network ( reaction - diffusion ) generation and adjustment , ( ii ) integration of the corresponding system of coupled differential equations for the local concentrations of all molecular complexes , ( iii ) Potts model update , repeated until user - defined event or end time point is reached ( Supplementary Fig . 2 ) . We note that the local network generation method introduced here can be embedded into any algorithm generat - ing morphological dynamics , not just Potts model simulations . The network generation could in principle be combined with more sophisticated approaches for shape and surface dynamics ( more sophisticated than just cubic extension and retraction ) such as finite element methods or level sets , but the coupling between shape dynamics and biochemistry would be highly nontrivial . We simulated cells as initially coming into contact at small membrane regions . Then we allowed these small contacts and the shape of the membranes in which the molecules were embed - ded to evolve , driven by the formation of intercellular E - cadherin contacts . The simulations incorporated Potts model parameters chosen to reproduce previous work reporting experimentally determined growth rates of cell - cell contacts , which began at 30 µ m h −1 ( ref . 21 ) and resulted over 1 . 5 h in cells joined through a contact interface spanning almost the entire cellular diameter ( Fig . 4e and Supplementary Movie 1 ) . Even for receptor - interaction parameters that had led to pronounced peripheral cadherin accumulation along the edges of cellular contacts in the morphologically static case , these dynamic simulations instead showed an overall increase in cadherin density in the central con - tact zone modulated by the morphological features of the interface ( such as regions of smooth or rugged , interrupted cell - cell con - tacts ) ( Fig . 4f ) . This qualitatively different behavior of the models is a consequence of the rapid ( relative to the time scale governing the growth of cell - cell contacts ) E - cadherin diffusion that allows fast recruitment of receptors that stabilize nascent contacts . The results of the simulations thus show that , owing to the fast diffu - sion of E - cadherin , cells have to use active transport mechanisms ( as opposed to passive diffusion , as modeled here ) to generate a high - concentration adhesive ring at the periphery of cellular contacts by removing receptors from the central contact zone to finally form mature adherens junctions 25 . Indeed , performing morphologically dynamic simulations with a diffusion coefficient typical for larger transmembrane receptors ( tenfold lower than has been reported for E - cadherin ) , or with contacts that grew five times faster than had been reported experimentally ( thereby shifting the balance between diffusion and morphological dynam - ics ) , we obtained a peripheral accumulation of these receptors ( Supplementary Fig . 3 ) . In contrast , just the accumulation of E - cadherin in intercellular contact zones did not require active transport , in accord with previous experimental findings 26 . computational exploration of mAPK activation in yeast We next applied our modeling method to exploring spatial aspects of MAPK activation in yeast , which requires the genera - tion of a signaling network with high combinatorial complexity within a characteristic cellular morphology . MAPK activation downstream of the yeast pheromone receptor is organized around the scaffold protein Ste5 . The scaffold interacts with a variety of partners , among them the G - protein subunit G βγ , the phospho - lipid phosphatidylinositol - ( 4 , 5 ) - bisphosphate ( PIP 2 ) , the kinase Ste20 that initiates activation of the MAPK cascade , its inter - action partner Ste11 ( MAPKKK ) , the MAPKK Ste7 and the MAP kinase Fus3 ( ref . 27 ) . Many of these binding partners may exist in several different states of activation . Taking into account all possible combinations of membrane - bound and cytosolic Ste5 molecules in complex with one , two or three of its interaction Identified trans dimer as binding partner for cis - binding of monomer in VE 2 _ i Is trans dimer part of biochemistry of VE 2 _ i ? VE 1 _ i VE 1 _ i VE 2 _ i VE 2 _ i Membrane contact Create a representation in VE 2 _ i of the trimer that labels the two cis - bound components as belonging to VE 2 _ i and a trans - bound component as belonging to VE 1 _ i List cis association of monomer and trans dimer with result trimer among reactions of VE 2 _ i Create a representation in VE 1 _ i of the trimer that labels the two cis - bound components as belonging to VE 2 _ i and a trans - bound component as belonging to VE 1 _ i List cis association of monomer and trans dimer with result trimer among reactions of VE 1 _ i Is binding site on trans dimer mediating the binding located in VE 2 _ i ? Is result trimer already part of biochemistry of VE 2 _ i ? Is result trimer already part of biochemistry of VE 1 _ i ? Look up next interaction of the monomer No No No No Yes Yes Yes Yes Figure 3 | Automatic creation of an E - cadherin trimer for a membrane contact reaction network . Flow diagram of how the algorithms that are part of our approach automatically create spatially resolved reactions and complexes based on simple user - provided rules specifying molecular interactions . The membrane of a volume element with index i in cell 2 ( VE 2 _ i ) contains a monomer that can bind through a cis interaction to a trans dimer . If no trans dimer is present in VE 2 _ i , the algorithm will look for the next potential interaction partner . If it is present in VE 2 _ i , the algorithm will check whether the site capable of mediating the cis interaction with the monomer is located in VE 2 _ i ( possibly the trans dimer has no available cis binding site ) . If the binding site is available , the algorithm will determine whether such a trimer ( with two molecules located in the membrane of VE 2 _ i and one in the adjacent membrane of VE 1 _ i ) is already represented as a complex in the biochemistry of VE 2 _ i , in which case this complex representation will be used as the result complex of the association . Otherwise , a result trimer complex will be built in the biochemistry of VE 2 _ i . As the result trimer also is ‘visible’ in the membrane element of VE 1 _ i , it has to be inserted or identified in that reaction network as well . Finally , the reaction information is completed by assembling a code for the association of the monomer with the trans dimer resulting in the formation of the trimer and with the reaction rate as specified by the user - supplied association rate between the involved binding sites . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . nAture methods | VOL . 9 NO . 3 | MARCH 2012 | 287 Articles partners in phosphorylated or unphosphorylated states , as well as interactions with other membrane - bound components , yields local reaction networks equivalent to more than 150 coupled differential equations in the membrane regions and 70 cou - pled ordinary differential equations in the cytoplasmic regions . Diffusional coupling between the membrane and volume ele - ments of the discretized cellular morphology has to be handled also . Capturing the many distinct molecular complexes involved in Fus3 activation is therefore a very difficult task that has been undertaken only a few times 28 , 29 using conventional modeling techniques that assemble the components of a mathematical model in a nonautomated manner . The shape of the yeast cells as they respond to pheromone stimulation has a considerable effect on the signaling events : Saccharomyces cerevisiae responds to pheromone by assuming a polarized pear - like shape and accumulating signaling molecules in its narrow tip , the ‘shmoo’ 27 . Recently , a microscopy study revealed the spatial distribution of the molecular components of the yeast pheromone response with enough quantitative detail to permit spatially resolved simulations 30 . Note that owing to the necessity to account for both spatial biochemical inhomogeneity and the influence of intracellular diffusion , a nonspatial rule - based method would require a manual mapping of each one of the automatically generated sets of reactions , describing the biochem - istry at one particular point in space , onto the volume elements of the simulated cellular geometry . Phosphorylated Ste7 ( pSte7 ) is thought to phosphorylate Fus3 in a Ste5 - dependent scaffold – guided process ( Fig . 5a ) . Given the low affinity of Fus3 for Ste5 ( dissociation constant ( K d ) of ~ 1 µ mol 30 , 31 ) , the concentration of complexes involving pSte7 and Fus3 bound to Ste5 must be low , posing the question of how the cells achieve a phosphorylation of 40 % of their Fus3 pool in less than an hour after pheromone stimulation 30 . After ini - tial simulations , we therefore replaced the classical mechanism of intrascaffold activation of Fus3 ( Fig . 5a ) with a mechanism according to which Ste5 - bound , activated Ste7 directly binds and activates Fus3 ( Fig . 5b ) , taking advantage of the fact that the graphical user interface of the modeling tool makes even such major structural changes quite painless . This mechanism has been suggested in a recent structural study that revealed that binding to Ste5 considerably enhances Ste7 phosphorylation of Fus3 and that this does not require direct interaction of Fus3 with Ste5 ( ref . 31 ) . This finding is in accord with the unexpected pre - vious observation that suppressing the interaction of Fus3 with Ste5 actually promotes Fus3 activation 32 . In addition , we included a tip - localized binding partner for pFus3 representing one of the targets of its kinase activity as suggested by the authors of the experimental study 30 . This allowed the model to account for an experimentally reported imbalance between Fus3 and Ste5 at the tip and to satisfy an additional constraint provided by the experimental data ( the shmoo tip contained 1 . 7 - fold less Ste5 than Fus3 ) that would have been impossible to satisfy without these Fus3 binding part - ners ( Supplementary Fig . 4 ) . With this second modification , simulations reproduced both the experimentally observed Fus3 concentration and phosphorylation profile ( Fig . 5c – e ) and the phosphorylation of 40 % of the total Fus3 pool . As in the original experiments 30 , the Fus3 concentration profiles were calculated using a spatial averaging over cells with different localizations of the cell nucleus ( Supplementary Fig . 5 ) . Among the advantages of the automated generation of reac - tion networks is the possibility to identify molecular complexes with common properties . Summing over the concentrations of all complexes containing the ‘Ste5 - pSte7 - Fus3 ′ pattern we could very efficiently determine the spatial concentration profile of the complexes that generate pFus3 . Even though the concentra - tion of these complexes was much lower in the body than at the shmoo tip , the total number of cytoplasmic sources for pFus3 was greater than those at the tip because the shmoo tip encom - passes only a few percent of the cell’s volume ( Fig . 5f ) . Thus , our a b d e f 1 s 3 s 10 s 30 s 100 s 100 s ( dynamic interface ) E - c adhe r i n den s i t y ( pe r µ m 2 ) 130 120 110 100 90 80 70 60 0 5 10 15 20 25 Distance across cell interface ( µ m ) c F l uo r e sc en c e ( a . u . ) 0 10 20 30 40 Distance across contact ( µ m ) Figure 4 | E - cadherin accumulation at static or dynamic cell contacts . ( a ) View of one of the two simulated cells interacting at a static interface with color - coded local concentrations ( blue , low ; red , high ) of E - cadherin . ( b ) Micrograph showing interacting cells expressing GFP - labeled E - cadherin with peripheral accumulation of this receptor highlighted by circles . ( c ) Plot of the fluorescence profile along the cell - cell interface . Scale bar , 15 µ m . A . u . , arbitrary units . Images in b and c are reprinted with permission from reference 21 . ( d ) Simulated E - cadherin density at the cell - cell interface ( after 30 min of contact ) with indicated lifespan of the cis interaction in E - cadherin complexes . For a lifespan of 100 s , data for both a static and dynamic interface are shown . ( e ) Cell - cell contact after 1 . 5 simulated hours based on cellular Potts model dynamics . ( f ) Color - coded E - cadherin concentration ( blue , low ; red , high ) at the dynamic cellular interface . The red line was used to determine the concentration profile for the dynamic interface in d . One voxel has a side length of 1 . 29 µ m . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . 288 | VOL . 9 NO . 3 | MARCH 2012 | nAture methods Articles spatial rule – based approach was required for the simulation of a complex signaling cascade embedded into its specific geometry and was also very useful for analyzing the consequences of the spatial distribution . In this case , the simulations suggested that the fact that much of the pFus3 was produced in the cell body imposes a limit on the steepness of the gradient that can be pro - duced by the highly concentrated source of this active kinase at the shmoo tip ( Supplementary Note 4 ) . Finally , the ability to include spatial aspects into quantitative models of cellular behavior considerably increases the stringency of the constraints provided by experimental data ; this should facilitate instructive simulations even in cases where the data are less complete than for the yeast MAPK pathway . discussion In addition to solving long - standing technical modeling issues through its ability to automatically generate spatially resolved reaction - diffusion networks , the approach we presented here also offers an opportunity for experimentalists with limited computa - tional experience to use modeling and simulation in their studies . As demonstrated in the step - by - step guide through the models , ( re ) building , modifying and exploring the models and perform - ing the simulations does not require a strong computational back - ground or the creation of elaborate computer scripts but instead can be done with the help of an intuitive graphical interface . Theorists will find it useful that the localized generation of reac - tion networks performed by our approach permits access to more details of local dynamics than is typically provided by ‘black - box’ partial differential equation solvers . This makes it straightfor - ward to analyze the different reactions contributing to the kinet - ics with which local complex concentrations change over time . Finally , computational modelers can use the programming inter - face provided for all algorithms to create single - or multicellular simulations combining biochemical ( reaction - diffusion ) and morphological dynamics , using the different components of our toolset as building blocks for customized projects . methods Methods and any associated references are available in the online version of the paper at http : / / www . nature . com / naturemethods / . Note : Supplementary information is available on the Nature Methods website . AcKnowledgments We thank R . Schwartz , R . Varma , A . Nita - Lazar , I . Fraser , J . Tsang and D . Cioffi for helpful comments , members of the Laboratory for Systems Biology at the US National Institute of Allergy and Infectious Diseases for insightful discussions , G . Mack for advice during the early stages of Simmune development and A . Meier - Schellersheim for creating Figure 2 and supplementary Figure 1 . This work was supported by the Intramural Research Program of the US National Institute of Allergy and Infectious Diseases of the National Institutes of Health . Author contriButions B . R . A . wrote the application for designing cellular morphologies . A . D . G . wrote the simulator graphical user interface . M . M . - S . and F . K . developed the volume and membrane spatial discretization . B . R . A . developed the adaptive membrane diffusion discretization . B . R . A . and T . P . performed numerical tests . F . Z . wrote the application for defining molecular interactions . M . M . - S . developed the spatially adaptive network generator . B . R . A . and M . M . - S . developed the integrator drivers . B . R . A . , F . K . , A . D . G . , T . P . , F . Z . , R . N . G . and M . M . S . discussed the project and wrote the manuscript . M . M . S . conceived and supervised the project . comPeting FinAnciAl interests The authors declare no competing financial interests . Published online at http : / / www . nature . com / naturemethods / . reprints and permissions information is available online at http : / / www . nature . com / reprints / index . html . 1 . Lingwood , D . & Simons , K . Lipid rafts as a membrane - organizing principle . Science 327 , 46 – 50 ( 2010 ) . 2 . Kholodenko , B . N . Four - dimensional organization of protein kinase signaling cascades : the roles of diffusion , endocytosis and molecular motors . J . Exp . Biol . 206 , 2073 – 2082 ( 2003 ) . 3 . Delon , J . & Germain , R . N . Information transfer at the immunological synapse . Curr . Biol . 10 , R923 – R933 ( 2000 ) . a Ste5 Ste11 Ste7 F u s 3 Ste5 Ste11 Ste7 Fus3 d f e b c Concentrationat tip 1 0 . 034 0 . 023 0 . 98 0 . 41 0 . 59 Contributionof tip Contribution of body Concentrationin body Tip volume Body volume 1 0 . 5 0 0 2 4 6 8 10 Distance from shmoo tip ( µ m ) A v e r age fl uo r e sc en c e ( a . u . ) C on c en t r a t i on o f pho s pho F u s 3 ( n M ) 1 , 200 1 , 000 800 600 400 200 0 1 2 3 Distance from shmoo tip ( µ m ) 4 5 6 7 Figure 5 | Experimental and simulated patterns of Fus3 phosphorylation . ( a , b ) The schematic shows the conventional ‘in - scaffold’ activation scheme for Fus3 ( a ) and an alternate activation scheme according to which scaffold - bound Ste7 activates Fus3 that is not bound to Ste5 ( b ) . Arrows indicate kinase activity . ( c ) Experimentally reported intensity profile of fluorescent Fus3 ( reprinted from ref . 30 ) . ( d ) Confocal microscopy image of yeast cells with accumulation of fluorescent Fus3 in the shmoo after stimulation with pheromone . Scale bar , 5 µ m . ( Reprinted from ref . 30 ) . ( e ) Overlay of the simulated concentration profile of phosphorylated Fus3 as a function of the distance from the shmoo tip and color - coded concentration ( blue , low ; red , high ) in a central plane through a simulated yeast cell . Side length of one square is 0 . 28 µ m . ( f ) Relative concentrations of the pFus3 producing complexes at the shmoo tip and in the cell body , the relative volumes of the two spatial regions and the resulting relative contributions of the regions to the total pFus3 production . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . nAture methods | VOL . 9 NO . 3 | MARCH 2012 | 289 Articles 4 . Jones , R . B . , Gordus , A . , Krall , J . A . & MacBeath , G . A quantitative protein interaction network for the ErbB receptors using protein microarrays . Nature 439 , 168 – 174 ( 2006 ) . 5 . Brown , M . D . & Sacks , D . B . Protein scaffolds in MAP kinase signalling . Cell . Signal . 21 , 462 – 469 ( 2009 ) . 6 . Hlavacek , W . S . , Faeder , J . R . , Blinov , M . L . , Perelson , A . S . & Goldstein , B . The complexity of complexes in signal transduction . Biotechnol . Bioeng . 84 , 783 – 794 ( 2003 ) . 7 . Meier - Schellersheim , M . et al . Key role of local regulation in chemosensing revealed by a new molecular interaction - based modeling method . PLoS Comput . Biol . 2 , e82 ( 2006 ) . 8 . Hlavacek , W . S . et al . Rules for modeling signal - transduction systems . Sci . STKE 2006 , re6 ( 2006 ) . 9 . Lok , L . & Brent , R . Automatic generation of cellular reaction networks with Moleculizer 1 . 0 . Nat . Biotechnol . 23 , 131 – 136 ( 2005 ) . 10 . Feret , J . , Danos , V . , Krivine , J . , Harmer , R . & Fontana , W . Internal coarse - graining of molecular systems . Proc . Natl . Acad . Sci . USA 106 , 6453 – 6458 ( 2009 ) . 11 . Koschorreck , M . & Gilles , E . D . ALC : automated reduction of rule - based models . BMC Syst . Biol . 2 , 91 ( 2008 ) . 12 . Mallavarapu , A . , Thomson , M . , Ullian , B . & Gunawardena , J . Programming with models : modularity and abstraction provide powerful capabilities for systems biology . J . R . Soc . Interface 6 , 257 – 270 ( 2009 ) . 13 . Varma , R . , Campi , G . , Yokosuka , T . , Saito , T . & Dustin , M . L . T cell receptor - proximal signals are sustained in peripheral microclusters and terminated in the central supramolecular activation cluster . Immunity 25 , 117 – 127 ( 2006 ) . 14 . van Zon , J . S . & ten Wolde , P . R . Green’s - function reaction dynamics : a particle - based approach for simulating biochemical networks in time and space . J . Chem . Phys . 123 , 234910 ( 2005 ) . 15 . Andrews , S . S . , Addy , N . J . , Brent , R . & Arkin , A . P . Detailed simulations of cell biology with Smoldyn 2 . 1 . PLoS Comput . Biol . 6 , e1000705 ( 2010 ) . 16 . Gumbiner , B . M . Regulation of cadherin - mediated adhesion in morphogenesis . Nat . Rev . Mol . Cell Biol . 6 , 622 – 634 ( 2005 ) . 17 . Sivasankar , S . , Zhang , Y . , Nelson , W . J . & Chu , S . Characterizing the initial encounter complex in cadherin adhesion . Structure 17 , 1075 – 1081 ( 2009 ) . 18 . Cavey , M . & Lecuit , T . Molecular bases of cell - cell junctions stability and dynamics . Cold Spring Harb . Perspect . Biol . 1 , a002998 ( 2009 ) . 19 . Zhang , Y . , Sivasankar , S . , Nelson , W . J . & Chu , S . Resolving cadherin interactions and binding cooperativity at the single - molecule level . Proc . Natl . Acad . Sci . USA 106 , 109 – 114 ( 2009 ) . 20 . Troyanovsky , S . Cadherin dimers in cell - cell adhesion . Eur . J . Cell Biol . 84 , 225 – 233 ( 2005 ) . 21 . Adams , C . L . , Chen , Y . T . , Smith , S . J . & Nelson , W . J . Mechanisms of epithelial cell - cell adhesion and cell compaction revealed by high - resolution tracking of E - cadherin - green fluorescent protein . J . Cell Biol . 142 , 1105 – 1119 ( 1998 ) . 22 . Perez , T . D . , Tamada , M . , Sheetz , M . P . & Nelson , W . J . Immediate - early signaling induced by E - cadherin engagement and adhesion . J . Biol . Chem . 283 , 5014 – 5022 ( 2008 ) . 23 . Glazier , J . A . & Graner , F . Simulation of the differential adhesion driven rearrangement of biological cells . Phys . Rev . E Stat . Phys . Plasmas Fluids Relat . Interdiscip . Topics 47 , 2128 – 2154 ( 1993 ) . 24 . Beltman , J . B . , Maree , A . F . , Lynch , J . N . , Miller , M . J . & de Boer , R . J . Lymph node topology dictates T cell migration behavior . J . Exp . Med . 204 , 771 – 780 ( 2007 ) . 25 . Perez - Moreno , M . , Jamora , C . & Fuchs , E . Sticky business : orchestrating cellular signals at adherens junctions . Cell 112 , 535 – 548 ( 2003 ) . 26 . Hong , S . , Troyanovsky , R . B . & Troyanovsky , S . M . Spontaneous assembly and active disassembly balance adherens junction homeostasis . Proc . Natl . Acad . Sci . USA 107 , 3528 – 3533 ( 2010 ) . 27 . Dohlman , H . G . & Thorner , J . W . Regulation of G protein - initiated signal transduction in yeast : paradigms and principles . Annu . Rev . Biochem . 70 , 703 – 754 ( 2001 ) . 28 . Kofahl , B . & Klipp , E . Modelling the dynamics of the yeast pheromone pathway . Yeast 21 , 831 – 850 ( 2004 ) . 29 . Shao , D . , Zheng , W . , Qiu , W . , Ouyang , Q . & Tang , C . Dynamic studies of scaffold - dependent mating pathway in yeast . Biophys . J . 91 , 3986 – 4001 ( 2006 ) . 30 . Maeder , C . I . et al . Spatial regulation of Fus3 MAP kinase activity through a reaction - diffusion mechanism in yeast pheromone signalling . Nat . Cell Biol . 9 , 1319 – 1326 ( 2007 ) . 31 . Good , M . , Tang , G . , Singleton , J . , Remenyi , A . & Lim , W . A . The Ste5 scaffold directs mating signaling by catalytically unlocking the Fus3 MAP kinase for activation . Cell 136 , 1085 – 1097 ( 2009 ) . 32 . Bhattacharyya , R . P . et al . The Ste5 scaffold allosterically modulates signaling output of the yeast mating pathway . Science 311 , 822 – 826 ( 2006 ) . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . doi : 10 . 1038 / nmeth . 1861 nAture methods online methods Models and tools . All models and the tools described here for generating the reported modeling results are available at http : / / www . niaid . nih . gov / LabsAndResources / labs / aboutlabs / lsb / Pages / simmuneproject . aspx . The tools run on Linux , MacIntosh ( Apple ) and Windows ( Microsoft ) operating systems . The models are stored in struc - tured query language ( SQL ) databases to allow for flexible and efficient organization and for detailed queries about molecular properties and interactions . The database communicates with the simulation software through an application programming interface ( API ) that can directly be accessed by computational modelers or programmers who want to implement their own sim - ulation engines or supply programmatically generated models to the simulator . Model databases are stored as SQLite dbf files that can be easily exchanged between researchers . Simulating cellular biochemistry in the context of intercel - lular receptor - mediated contacts . To illustrate the challenges associated with transitioning from a nonspatial to a spatial rep - resentation of a signaling network , we consider a simple model of receptor - mediated cellular communication with the following rules ( Supplementary Fig . 1 ) : R 1 and R 2 are two receptors , each with one extracellular and one intracellular binding site . They can bind to each other extracellularly and can bind to intracel - lular components , C 1 and C 2 , respectively . C 1 can interact with R 1 regardless of the receptor’s extracellular binding state , whereas C 2 can bind to R 2 only after this receptor has been bound by R 1 ( outside - in signaling ) . R 1 can bind to R 2 only after C 1 has attached itself to intracellular domain of R 1 ( inside - out signaling ) . The network thus incorporates outside - in and inside - out signaling mechanisms representing typical binding event - induced changes in the behavior of transmembrane proteins responsible for trans - mitting and reacting to cellular contact signals 33 . Whereas the biochemical reaction possibilities resulting from the rules in the model can be described easily as a network graph when the geometry of the system is ignored ( Supplementary Fig . 1a ) , taking into account the spatial localization of the network’s molecular components relative to two cytoplasmic membranes of adjacent cells expressing either R 1 and C 1 or R 2 and C 2 creates a substantial additional layer of complexity . To illustrate this we depict components that need to be treated as cytosolic as green for cell 1 and as purple for cell 2 . Extracellular membrane - bound components are depicted in blue ( Supplementary Fig . 1b , c ) . C 1 and C 2 perform free 3D diffusion as unbound molecules . After their association with the transmembrane receptors R 1 and R 2 , they are confined to 2D membrane - guided diffusion . Another important difference between a nonspatial and a spatially resolved simulation of the model is that in the latter case molecular complexes need to be accounted for in multiple locations simultaneously . As one example , the receptor - receptor association ( reaction 2 ) cre - ates a complex that is ‘visible’ in five distinct spatial regions : cytoplasm 1 , membrane 1 , intercellular space , membrane 2 and cytoplasm 2 . In a simulation that tracks individual complexes , the interaction possibilities of these intercellular transmembrane complexes would follow naturally from their individual posi - tions in space : complexes that are spatially very close to each other can react ( Supplementary Fig . 1c ) . However , switching to what is usually a far more efficient approach by simulating the dynamics of molecular concentrations in two discretized , grid - like representations of the membranes and adjacent volumes of the two interacting cells means giving up the information about locations of individual molecule complexes ( Supplementary Fig . 1d ) . The algorithms updating the concentrations over time of molecular complexes that are present in multiple adjacent membrane and volume elements thus need to be able to model these interdependencies on the ensemble level ( local concentra - tions of complex species ) even though , physically , they arise at the level of individual complexes . For example , the association of C 1 : R 1 and R 2 in two adjacent membrane grid elements depicted by the red squares in Supplementary Figure 1d increases the concentration of the product complex C 1 : R 1 : R 2 in the two membrane grid elements and their associated volumes ( sub - membrane and intercellular ) . It decreases the concentration of C 1 : R 1 in the grid element on the left ( cell 1 ) and of R 2 in the grid element on the right ( cell 2 ) . Thus , although the rate of this reaction depends only on the concentrations of C 1 : R 1 and R 2 in the intercellular space hosting the interaction , the formation of the larger complex changes the concentrations of complexes in multiple additional locations . To address these issues we developed algorithms that con - struct the computational representations of reaction networks for individual volume ( or membrane ) elements based on their local geometry and the locally available molecular components , as opposed to using interaction rules to generate a global reaction network and then mapping it onto discretized spatial structures . The latter approach would have difficulties simulating situations in which multimolecular complexes could exist in multiple ver - sions that , while biochemically identical , nonetheless differ with regard to the roles they have in the modeled cellular geometry . The adhesion receptors ICAM - 1 and LFA - 1 , both expressed on interacting T and B lymphocytes , are biological examples of this situation . Here both cells express the equivalents of R 1 and R 2 ( ICAM - 1 and LFA - 1 ) . The complex ICAM - 1 : LFA - 1 can thus mean two things : ICAM - 1 is anchored on the T cell and LFA - 1 on the B cell or vice versa . The purely biochemical , theoretical interaction possibilities of the intercellular complex as part of a nonspatial signaling network are identical in both cases , but the algorithm simulating the network’s reaction dynamics in space now needs two representations in each grid element with distinct local reaction rules . Using the biochemically simpler system of E - cadherin receptor homodimerization , we describe ( Fig . 1 and Supplementary Note 2a ) how our approach builds local reac - tion networks capable of correctly handling such situations by encoding the spatial localization of the components of multimo - lecular complexes to be able to dynamically assemble and disas - semble complexes connecting multiple distinct spatial regions . This approach solves the above - mentioned problem : components involved in the formation of transmembrane complexes ‘know’ where they come from , thereby making it straightforward to assign target volume ( or membrane ) elements to the fragments of dissociating complexes . The information contained in the com - plexes ( origins of their components , list of complex interactions that can generate them , list of decays that disintegrate them into fragments ) is then translated into sets of equations encoding the concentration changes ( and their kinetic rates ) of the complexes in the system ( Supplementary Note 3a ) . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . doi : 10 . 1038 / nmeth . 1861 nAture methods All simulation methods described here are implemented in algo - rithms that are either accessible through graphical user interfaces or programmatically through an API . Examples illustrating how to access the reported functionality in custom programs using the algorithms introduced here are provided in the documentation for the modeler and simulator API . The numerical parameters we used are given in Supplementary Note 5 . Numerical validations of the adaptive membrane diffusion scheme and of the cubic grid bulk diffusion scheme are provided in Supplementary Note 6 . Generation of location - dependent reaction networks . Reactions between molecular complexes are based on binding possibilities between pairs of molecular binding sites . The rate constants of these reactions may be determined by the complexes to which the interacting molecules belong : two molecules A and B may have different association ( and dissociation ) rates depending on whether they interact as monomolecular ‘complexes’ A and B or are part of larger complexes , for instance , as A bound to C in a complex A : C . These properties of the molecules and the complexes they may form define the purely biochemical network corresponding to the network shown in Figure 2b for cadherin interactions . The modeler interface provides the functionality to specify these properties using a graphical interface . Once the computational representations of the cellular morphologies have been generated ( see below ) , local networks in the volume ele - ments of the spatial discretization are generated based on the molecular complexes that are initially placed into these volume elements ( as initial conditions of a particular simulation of the model ) and their potential interactions and the complexes they can form . The local networks in each volume element will gen - erate only those complexes that can actually be formed based on the locally available initial biochemical makeup in that element . For instance , if A can bind to B and C but a local volume element contains only A and C , the algorithm will generate a representation of complex A : C but not A : B instead of generat - ing both and just setting the concentration of A : B to zero . This distinction ensures a maximally efficient ( sparse ) representation of the reaction kinetics . In all membrane locations , the molecular complexes are given additional tags that encode their volume element identity . This allows the algorithm to generate inter - cellular membrane - membrane complexes and identify which components of a complex ( each belonging to one of two distinct membrane elements ) they decay to when the binding that medi - ates the membrane - membrane link ( in the E - cadherin example the trans - trans interaction ) is lost . With the information about which interactions are possible locally and the location tagging , the algorithm can finally determine all reactions for each single local molecular complex : associations , where two complexes form a larger complex ; dissociations , where a complex decays into two smaller ones ; and transformations , where a complex changes the state of its molecular components , for instance , switching from unphosphorylated to phosphorylated . In spite of the overhead resulting from the additional information needed to generate localized spatial networks , Simmune’s network generators com - pare favorably with other approaches for automated network gen - eration ( Supplementary Note 3b and Supplementary Fig . 6 ) . Generation of computational representations of cellular mor - phologies : finite volume method . Partial differential equations ( PDEs ) are the continuous mathematical representation of the reaction - diffusion system given by interacting and diffusing molecular complexes . PDEs that describe the spatiotemporal behavior of conserved quantities such as diffusing molecules are amenable to discretization by the finite volume method . The method’s central idea is to cover the spatial region on which the PDE is defined with a set of volume elements and express the rate of change of the conserved quantity in those elements in terms of the flux through their surface 34 . In the case of diffusion the flux through the surfaces is determined by Fick’s law . Cytosolic and extracellular diffusion can be discretized in a natural way by choosing a piecewise constant approximation of concentrations , and an approximation of the gradients through the distances between the centers of the volume elements ( these are cubic in the implementation used here ) . However , the surface elements of the cubic grid elements that cover a simulated cell do not provide an adequate approximation of the cell’s surface . The distances and interface lengths entering Fick’s law have to be inferred from the cell’s shape . This will be explained below . Generation of modified surface geometry for membrane diffu - sion . The surface elements of the cubic grid elements that cover a simulated cell provide an inadequate approximation to the cell’s surface ( Supplementary Note 3d ) . To illustrate this issue consider a sphere of radius 1 . The circumference of that sphere is 2 π and its area 4 π . In contrast , the circumference of the discretized sphere at the equator is 8 , independent of the resolution of the discretization . ( Distinct parts of the circumference can be viewed from four direc - tions , perpendicular to the front , back , left and right faces of the cubic grid elements defining the sphere . The visible circumference from each of these four viewpoints is 2 for a total of 8 . ) The surface area of the discretized sphere converges to 6 π for a grid constant approaching 0 . By an argument similar to the previous one the area can be viewed from six directions . In each direction a circle with area π is approximated by the surfaces of the grid elements , leading to a total area of 6 π . Considering these discrepancies between the discretized and ideal sphere it is obvious that a naive approach using the surface of the cubic grid cells to solve the diffusion equation will not yield results converging to the true solution . This can be remedied by locally adapting the area and shape as well as the distances between surface elements of the cubic grid elements ( Supplementary Fig . 7 ) . The approach taken here is based on a method 35 that was designed to provide accu - rate approximations to idealized smooth surfaces that do not change over the course of a simulation . Our simulation scheme is designed to allow for frequent changes of the surface geo - metry . This requires rebuilding the surface approximation and redistributing membrane molecules ( Supplementary Note 3c and Supplementary Fig . 8 ) after each change of the surface geo - metry . We therefore modified the original method to reduce the computational cost for creating the approximation . In numerical tests , the error of the much faster modified method was still in the sub - percent range ( Supplementary Note 6 ) . Supplementary Movies 1 and 2 use the surface normals generated by this method to display the curvature of the cell membranes . Potts model dynamics . We use a cellular Potts model ( CPM ) 23 to simulate dynamic cell morphologies . During each morphology update , which occurs with a user - defined frequency , a subset of n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . doi : 10 . 1038 / nmeth . 1861 nAture methods the volume elements that are adjacent to the cell’s surface are ran - domly chosen . The energy cost for the extension of the element in a randomly chosen direction and the retraction of the element are evaluated . The change with the lower cost is chosen and will be accepted if the cost is smaller than zero or with a probability exp ( − E ) for a cost E . A volume element of one cell can extend into a volume element occupied by another cell ; the total cost will be the sum of the costs for extending one volume element and retracting the other . Note that this strategy as implemented here permits the devel - opment of models that couple membrane biochemical and mor - phological dynamics . However , this coupling is phenomenological in the sense that membrane dynamics are not simulated based on biomechanical calculations that describe surface deformations in terms of forces generated , for instance , by actin and myosin fibers that interact with the cell’s membrane . Accordingly , Potts model parameters have to be chosen heu - ristically to reproduce the experimentally observed dynamics of cellular morphology . Our CPM uses four different energy terms . The relative strengths s x of the terms are tunable as part of a simulation defi - nition . The total cost E is given by E = s v E v + s a E a + s b E b + s c E c , where E v and E a are contribution controlling the cost of volume and surface changes , E b determines the contribution of receptor binding between adjacent membranes and E c represents a phe - nomenological term that penalizes small thin protrusions . These terms are defined in detail below . Their proportionality constants have been chosen to result in realistic behavior of the E - cadherin receptor mediated adhesion model for relative strengths close to one . Additional user - defined terms can be added through the pro - gramming interface ( API ) , by deriving a new class from the PottsTerm - class and reimplementing its extendCost ( Cube * c , DIRECTION d ) and retractCost ( Cube * c ) methods as illus - trated by the PottsTermExample class in the smun _ PottsTerm . h header file that is part of the package distributed with the software . An implementation example is provided in the file PottsExample . cpp . The volume term models the effects of an impermeable cell membrane . The potential energy of a cell with volume V and equilibrium volume V 0 is proportional to the squared volume difference . The energy cost for osmotic swelling of the cell , given the new V new and old V old cell volumes , is thus ∆ E v ~ ( V new − V 0 ) 2 − ( V old − V 0 ) 2 = V e ( n + 1 − n 0 ) 2 – ( n − n 0 ) 2 = V e ( 2 ( n − n 0 ) + 1 ) , where V e is the volume of a single volume element , n the number of volume elements and n 0 the number of volume elements at which the cell is in equilibrium . V 0 is specified as a fraction of the initial cell volume . This is done through the CellDesigner user interface . In the case of the E - cadherin model , the fraction equals 1 ; thus the cell is in equilib - rium at the start of the simulation , with a relative strength s v = 1 . The area term models energy cost of changes to the cell’s sur - face area . The area change ∆ A is approximated by change of the area of the surface of the subset of the cubic grid that is covered by the cell ∆ A = A e ∆ s with ∆ s = s − s 0 being the change of the number of surface ele - ments and A e the area of a single surface element . In analogy to the volume term we model the energy cost for extending the membrane out of its relaxed state by a harmonic potential . The energy cost for changing the morphology is thus ∆ E a ~ ( ∆ A ) 2 + 2 ∆ AA e ( s − s 0 ) . The number of surface elements of the relaxed membrane is specified as a fraction of the initial cell surface analogous to the relaxed volume . Setting the relaxed fraction to a value different from one allows the user to model phenomena such as the open - ing of membrane reservoirs . The relaxed surface of the cells used in the E - cadherin model equals their initial surface , the area term has a relative strength s a = 1 / 2 . The binding term models the energy cost of adhesion owing to the breaking of intercellular bonds resulting from changes of the mor - phology . The contribution of each type of bond is proportional to the number of bonds that are broken by the morphology change ∆ E b ~ Σ Surface Σ Bond A Surface C Bond , where the first sum is over all surface elements that are removed and the second sum is over all intercellular bonds . The area of a surface element is given by A Surface and the surface concentra - tion of a bond type by C Bond . Only bonds that are marked as trans in the model specification can be used as bonds that enter the adhesion term ; the relative strength of the adhesion term is specified together with the other Potts term during the setup of a simulation . Naming the binding sites in the components of the interacting molecules specifies bonds . The E - cadherin model has only one type of binding that can enter as a binding term , the trans interaction of the E - cadherin molecules , which is given a relative strength s b = 2 . The bending resistance of the cell membrane is modeled by a phenomenological term that depends only on the number of direct neighbors of the changing volume element . The relative cost for extending a volume element is E rel = { 1 , 0 , −1 , 10 , −25 } with one to five neighbors . This penalizes the formation of small , thin exten - sions while it favors closing of small invaginations . The cost terms for retracting a volume element have the opposite cost favoring the retraction of a small protrusion while penalizing the formation of invaginations . The asymmetric nature of the cost terms allows the cell to sample its surroundings while keeping the cell’s surface from becoming very rough . The only parameter of this purely local term is its relative contribution to the total cost E . For the E - cadherin model we chose the relative contribution s c = 1 / 2 . 33 . Evans , R . et al . Integrins in immunity . J . Cell Sci . 122 , 215 – 225 ( 2009 ) . 34 . Eymard , R . , Gallouet , T . & Herbin , R . Finite volume methods . in Handbook of Numerical Analysis ( eds . Ciarlet , P . G . & Lions , J . L . ) 7 , 713 – 1020 ( 2000 ) . 35 . Novak , I . L . et al . Diffusion on a curved surface coupled to diffusion in the volume : application to cell biology . J . Comput . Phys . 226 , 1271 – 1290 ( 2007 ) . n p g © 2012 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d .
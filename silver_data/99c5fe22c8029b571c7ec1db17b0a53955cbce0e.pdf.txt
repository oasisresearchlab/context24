Connectedness Proﬁles in Protein Networks for the Analysis of Gene Expression Data Jo¨el Pradines 1 , Vlado Danˇc´ık 1 , 2 , Alan Ruttenberg 1 , and Victor Farutin 1 , 3 1 Computational Sciences , Millennium Pharmaceuticals Inc . , 40 Landsdowne Street , Cambridge , MA 02139 , USA 2 Mathematical Institute , Slovak Academy of Sciences , Greˇs´akova 6 , 040 01 Koˇsice , Slovakia 3 Pﬁzer Global R & D , Research Technology Center , 620 Memorial Drive , Cambridge , MA 02139 , USA Abstract . Knowledge about protein function is often encoded in the form of large and sparse undirected graphs where vertices are proteins and edges represent their functional relationships . One elementary task in the computational utilization of these networks is that of quantifying the density of edges , referred to as connectedness , inside a prescribed protein set . For instance , many functional modules can be identiﬁed be - cause of their high connectedness . Since individual proteins can have very diﬀerent numbers of interactions , a connectedness measure should be well - normalized for vertex degree . Namely , its distribution across ran - dom sets of vertices should not be aﬀected when these sets are biased for hubs . We show that such degree - robustness can be achieved via an ana - lytical framework based on a model of random graph with given expected degrees . We also introduce the concept of connectedness proﬁle , which characterizes the relation between adjacency in a graph and a prescribed order of its vertices . A straightforward application to gene expression data and protein networks is the identiﬁcation of tissue - speciﬁc func - tional modules or cellular processes perturbed in an experiment . The strength of the mapping between gene - expression score and interaction in the network is measured by the area of the connectedness proﬁle . De - riving the distribution of this area under the random graph enables us to deﬁne degree - robust statistics that can be computed in O ( M ) , M being the network size . These statistics can identify groups of microar - ray experiments that are pathway - coherent , and more generally , vertex attributes that relate to adjacency in a graph . 1 Introduction Much knowledge about the interactome is now available [ 1 , 2 ] . Whether it is an artifact of sampling or not [ 3 ] , large graphs representing protein interactions always display a marked heterogeneity of vertex degrees : a small number of hubs and a majority of proteins having few interactions . Therefore , to avoid bias towards or against hubs , computational work with protein networks often requires a control that preserves vertex degrees . A commonly used control is the T . Speed and H . Huang ( Eds . ) : RECOMB 2007 , LNBI 4453 , pp . 296 – 310 , 2007 . c (cid:2) Springer - Verlag Berlin Heidelberg 2007 Connectedness Proﬁles in Protein Networks 297 random graph with ﬁxed degree sequence : edges are randomly paired and rewired [ 4 , 5 , 6 ] . However , such numerical approach is time expensive and thus limits the range of applications [ 7 , 8 ] . There is no easy analytical alternative in the case of the random graph with ﬁxed degree sequence , because it models edges as dependent random variables [ 8 , 9 , 10 , 11 , 12 ] . Rendering edges independent yields a model known as the Random Graph with Given Expected Degrees ( RGGED ) [ 12 , 13 ] . Some of the analytical treatment becomes then much easier [ 14 ] . In this paper we show that the RGGED is a powerful framework to design statistics that are not degree - biased and for which there exist good analyti - cal approximations . This allows us to perform degree - robust yet fast compu - tational work with protein networks . We focus on one quantity referred to as connectedness : the density of interactions inside a prescribed protein set . For in - stance , many protein functional modules can be identiﬁed because of their high connectedness [ 15 ] . The connectedness of a protein set L is quantiﬁed by the probability P L ( x ) of observing x or more edges inside L in the RGGED . The p - value P L can be rapidly computed via an approximation based on the Poisson distribution . We show that P L is robust with respect to vertex degrees in the sense that its distribution across random sets of | L | proteins is not very sensitive to the degrees represented in L . Also , we demonstrate that P L has a rather intuitive meaning : it is a reasonable approximation of the p - value for higher connectedness when selecting a random set of | L | proteins . We then introduce the more general concept of a connectedness proﬁle , which characterizes the relation between adjacency in a network and a given order of its vertices . An application to gene expression data and protein networks is the identiﬁcation of tissue - related functional modules or cellular processes perturbed in an experiment . The strength of the mapping between gene expression score and interaction in the network can be quantiﬁed by the area of the connect - edness proﬁle . Studying the distribution of this area under the RGGED yields degree - robust statistics that can be computed in O ( M ) , where M is the network size . These statistics are useful to identify groups of microarray experiments that are pathway - coherent , and more generally , vertex attributes that relate to adja - cency in a network . The proﬁle area is similar in spirit to the mixing coeﬃcient previously introduced by Newman [ 16 ] . The diﬀerence is that our statistics were designed via a random graph model in order to be degree - robust . In addition , not just its area but other features of a connectedness proﬁle provide useful information . In the next sections , as mathematical results are derived , we provide examples of application to the analysis of gene expression data with a network representing known functional relationships between proteins . The microarray data was down - loaded from the Gene Expression Omnibus resource of NCBI [ 17 ] . The protein network represents protein interactions stored in the Human Protein Reference Database ( HPRD ) [ 2 ] and adjacency of human enzymes in the metabolic path - ways of the LIGAND database [ 18 , 19 ] . The full graph has 7 , 302 vertices , 36 , 344 edges , median degree 4 and maximal degree 165 . 298 J . Pradines et al . 2 Connectedness Proﬁle We start with the problem of quantifying the connectedness of a given protein set and then introduce the concept of connectedness proﬁle . 2 . 1 Quantifying Connectedness The protein network is modeled with an undirected graph G ( V , E ) , where the vertex set V represents proteins and the edge set E their functional relationships . We use the following notations : N = | V | , M = | E | , k i is the degree of vertex v i and (cid:2) k (cid:3) the average vertex degree . Consider a prescribed order of the vertices : L N = ( v 1 , . . . , v N ) . For instance , v 1 is the most diﬀerentially expressed gene in an experiment , v 2 the second most and so on . We wish to test for a relation between L N and E : are the ﬁrst elements of L N closely related in the graph ? We call L i the restriction of L N to its ﬁrst i elements . If the number of edges x i of the subgraph induced by L i is large , then L i is well connected . To deﬁne what a large x i means we need a control . An obvious one is a random set of i vertices , i . e . a permutation of the elements of L N . The set of all permutations deﬁnes a random variable x i and large values of x i correspond to small values of Pr ( x i ≥ x i ) . However , a small p - value based on x i might only reﬂect that L i contains vertices of large degrees . We illustrate this with a numerical experi - ment , where connectedness is perturbed by adding the network hub to random protein sets . We generated 10 5 random sequences L N of all proteins and , for each sublist L i ( i < N ) , estimated the threshold value T i of x i for which Pr ( x i ≥ T i ) ≤ 0 . 05 . One protein of each list L i was then replaced with the network hub ( k = 165 ) and the frequency F of induced sizes x i greater than T i estimated . If x i were a degree - robust measure , the values of F should stay close to 0 . 05 . Instead , the black circles of Fig . 1 ( a ) show that F tends to be much higher . This is due to the wide range of degrees in the network combined with the small proportion of hubs . A better connectedness measure should take into account the degrees of the vertices in L i . Given k 1 , . . . , k i we can compute the largest possible value x mi of x i with an algorithm similar to that designed to test whether an integer sequence is graphical or not [ 14 , 20 , 21 ] . We can then quantify connectedness with x i / x mi . Yet , the white circles of Fig . 1 ( a ) show that x i / x mi is still very degree sensitive . Indeed , the relative increase of x mi is small compared to that of x i upon the addition of a hub in L i . Such sensitivity to degrees is problematic . The goal of testing a list for its connectedness is to detect functional proximity , not the presence of hubs . A much better robustness to degrees is obtained for a connectedness measure that we refer to as P L [ 14 ] . The squares of Fig . 1 ( a ) show that the distribution of P L across protein sets is barely aﬀected when the network hub is added to each set . P L ( x ) is the probability of observing x or more edges in L under a null model of the network known as the Random Graph with Given Expected Connectedness Proﬁles in Protein Networks 299 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 10 100 1000 F i C = x i i ( a ) C = x / x i i im C = PL i i 0 0 . 2 0 . 4 0 . 6 0 . 8 1 0 0 . 2 0 . 4 0 . 6 0 . 8 1 C u m u l a t i ve f r e qu e n cy PL i = 50 i = 200 i = 1000 i = 5000 ( b ) Fig . 1 . ( a ) Sensitivity of diﬀerent connectedness measures to vertex degree . A degree - robust measure C i should yield values of F close to 0 . 05 . ( b ) Distributions of P L i across random sets of i proteins . Degrees ( RGGED ) [ 12 , 13 ] . In the RGGED all possible edges v i v j are modeled with independent Bernoulli random variables of parameters p ij = min ( k i k j / 2 M , 1 ) with 2 M = N (cid:2) k (cid:3) . ( 1 ) The RGGED tends to preserve vertex degrees in a sparse network . We will con - sider two conditions of sparseness : strong : k 2 i (cid:6) N (cid:2) k (cid:3) , ∀ i and weak : (cid:2) k (cid:3) / N (cid:6) 1 . The strong condition implies the weak one and p ij (cid:6) 1 . In the RGGED the size X of the subgraph induced by L is the sum of independent Bernoulli variables and P L can be easily computed [ 14 ] : P L = Pr ( X ≥ x ) (cid:8) α − 1 e − λ m (cid:2) y = x λ y / y ! , α = e − λ m (cid:2) y = 0 λ y / y ! , λ = (cid:2) i < j | L p ij , ( 2 ) with m = | L | ( | L | − 1 ) / 2 and α (cid:8) 1 . Equation ( 2 ) is a good approximation for strongly - sparse graphs [ 14 ] , because error bounds scale as p 2 ij and p ij [ 22 , 23 ] . In addition to being degree - robust , P L has also an interesting meaning with respect to the permutation control . Figure 1 ( b ) displays a few distributions of P L i across random protein orders L N . The important point is that for intermediate list sizes ( 100 < i < 1000 ) the distributions are close to uniform . Therefore , for such i values , P L i is a good approximation of the p - value for higher connectedness when selecting a random set of i proteins . In summary , P L is a connectedness measure that has a simple interpretation , is degree - robust and can be rapidly computed . 2 . 2 P L Proﬁle Rather than limiting ourselves to one list L i , we can characterize the whole or - dering L N with the sequence ( log ( P L 1 ) , . . . , log ( P L N ) ) that we call a P L proﬁle . The computation of all the required x i and λ i values , as well as the variance σ 2 i of X i , is performed as follows . 300 J . Pradines et al . ( a ) x 1 = 0 , λ 1 = 0 , σ 21 = 0 , k m = k 1 , Σk = k 1 , Σk 2 = k 21 . ( b ) x i + 1 = x i + x a i + 1 , with x a i + 1 = | L i ∩ ν ( v i + 1 ) | , ν ( v ) = { u ∈ V | uv ∈ E } . ( c ) p m = k m k i + 1 / 2 M . If p m > 1 do ( d ) otherwise do ( e ) ( d ) λ a i + 1 = (cid:3) ij = 1 p i + 1 , j , σ 2 a i + 1 = (cid:3) ij = 1 p i + 1 , j ( 1 − p i + 1 , j ) . ( e ) λ a i + 1 = k i + 1 Σk / 2 M , σ 2 a i + 1 = λ a i + 1 − k 2 i + 1 Σk 2 / 4 M 2 . ( f ) λ i + 1 = λ i + λ a i + 1 , σ 2 i + 1 = σ 2 i + σ 2 a i + 1 , Σk + = k i + 1 , Σk 2 + = k 2 i + 1 . ( g ) if k i + 1 > k m , k m = k i + 1 . All the steps are O ( 1 ) , except for ( b ) which is O ( k i ) and ( d ) which is O ( i ) . For the network we use here , ( d ) is never executed because there is no pair of vertices such that k i k j > 2 M . Consequently , the computation is O ( M ) . More generally , the number of vertices requiring step ( d ) is small compared to N for large protein networks because they are weakly sparse : ξ = (cid:2) k (cid:3) / N (cid:6) 1 . Let H stand for the set of vertices such that k 2 > N (cid:2) k (cid:3) and H its complement in V . The average degree over H is (cid:2) k (cid:3) H = (cid:4) N (cid:2) k (cid:3) + δ , with δ > 0 . Let f H = | H | / N denote the fraction of hubs . We have (cid:2) k (cid:3) = f H (cid:2) k (cid:3) H + ( 1 − f H ) (cid:2) k (cid:3) H ⇒ f H = ξ − (cid:2) k (cid:3) H / N √ ξ + δ / N − (cid:2) k (cid:3) H / N ⇒ f H < (cid:4) ξ . For large protein networks ξ ≈ 10 − 3 so that f H < 0 . 04 , which implies that step ( d ) is rarely executed and the computation of the P L proﬁle is fast . 2 . 3 Applications to Gene Expression Data We consider the comparison of two groups A and B of microarray experiments . Each gene g is scored for its diﬀerential expression between A and B with D ( g , A , B ) = (cid:5) (cid:2) ln ( I g ) (cid:3) A − (cid:2) ln ( I g ) (cid:3) B (cid:6) / (cid:5) sd ( ln ( I g ) ) A + sd ( ln ( I g ) ) B (cid:6) , ( 3 ) where I is the intensity , (cid:2)(cid:3) A denotes the average over group A and sd ( ) the standard deviation . Figure 2 ( a ) presents two P L proﬁles obtained when ordering genes by the score D comparing expression in one tissue ( group A , two samples ) to expression in other tissues ( group B , 2 × 78 samples ) [ 24 ] . We can approximate the pathways highly expressed in adipocytes with the subgraph induced by the ﬁrst 393 genes , as they correspond to a clear local minimum of P L . We broke this subgraph into densely connected parts called communities [ 25 , 26 ] and likely to represent functional modules . Often , this is done by looking for a partition into c vertex groups that maximizes the global modularity score Q = (cid:2) ij ( a ij − p ij ) c (cid:2) r = 1 δ ( g i , r ) δ ( g j , r ) = c (cid:2) r = 1 x r − λ r , ( 4 ) where a ij = 1 if v i v j ∈ E and 0 otherwise , and δ is the Kronecker function . Here , instead of using only the diﬀerence between x and its expected value λ , we deﬁned Q as the average | log ( P L ) | across the c candidate communities . We obtained ﬁve main modules , two of which are displayed in Fig . 2 . They correspond to Connectedness Proﬁles in Protein Networks 301 - 80 - 60 - 40 - 20 0 0 2000 4000 6000 l og ( P L ) i adipocytes appendix ( a ) GYG2 HADHSC ALDH1A3 NNMT PAPSS2 CYP4B1 MAOA ACAT2 CPT2 SAT AOC2 PPAP2B PRDX6 SUOX PLA2G2A AOC3 ADH1B PGM1 G6PD ADH1C PTGIS LPL ENPP1 FASN ACAA2 SCP2 HADHB ACOX1 ALDH9A1 SHMT1 ECHS1 GYS1 UAP1 PYGL MCCC1 FTHFD AOX1 UGP2 ACSL5 ACSL1 ACAT1 GBE1 ACACA HK2 AGPAT2 PTGS1 HNMT ADH5 PC GYG2 HADHSC ALDH1A3 NNMT PAPSS2 CYP4B1 MAOA ACAT2 CPT2 SAT AOC2 PPAP2B PRDX6 SUOX PLA2G2A AOC3 ADH1B PGM1 G6PD ADH1C PTGIS LPL ENPP1 FASN ACAA2 SCP2 HADHB ACOX1 ALDH9A1 SHMT1 ECHS1 GYS1 UAP1 PYGL MCCC1 FTHFD AOX1 UGP2 ACSL5 ACSL1 ACAT1 GBE1 ACACA HK2 AGPAT2 PTGS1 HNMT ADH5 PC . . ( b ) ELN COL6A1 ASPA SERPINF1 ADAMTS1 COL3A1 FBLN2 LAMB1 SDC2 DCN FMOD ACDC CSPG2 CD36 LAMC1 DPT LAMA2 COL1A2 SPARC MFAP2 COMP COL1A1 NID NID2 MFAP5 FBLN1 HSD11B1 HSPG2 ASS LOX SERPINE2 COL4A1 ACHE PRELP FBN1 COL4A2 CTSK DDR2 TGFBI FBN2 HDLBP FN1 ELN COL6A1 ASPA SERPINF1 ADAMTS1 COL3A1 FBLN2 LAMB1 SDC2 DCN FMOD ACDC CSPG2 CD36 LAMC1 DPT LAMA2 COL1A2 SPARC MFAP2 COMP COL1A1 NID NID2 MFAP5 FBLN1 HSD11B1 HSPG2 ASS LOX SERPINE2 COL4A1 ACHE PRELP FBN1 COL4A2 CTSK DDR2 TGFBI FBN2 HDLBP FN1 . . ( c ) Fig . 2 . ( a ) Two P L proﬁles obtained when genes are ordered for their higher expression level in one tissue versus 78 others . ( b - c ) Parts of the network induced by the genes highly expressed in adipocytes . lipid - metabolism pathways and components and modiﬁers of the extra - cellular matrix . These modules are relevant to adipose tissue . So , by combining the P L proﬁle and a community ﬁnding algorithm we can identify tissue related functional modules or cellular processes perturbed in an experiment . However , such approach becomes questionable when the optimal i giving the best P L i is large , e . g . 43 % of the vertices with the appendix samples . Partition - ing such a large graph into communities is unlikely to be much driven by the expression scores . One can then adopt other strategies that identify portions of the graph rich in diﬀerentially expressed genes [ 27 , 28 ] . This said , the P L proﬁle gives us valuable information : diﬀerential expression can map to a large number of pathways , because functional neighbors tend to be co - expressed [ 29 , 30 ] . To illustrate this we generated 10 4 random partitions of 173 tumor samples [ 31 ] in two groups of sizes 86 and 87 . Each partition was used to order genes by descending values of D ( 3 ) , compute a P L proﬁle and measure some of its charac - teristics . The results , as well as those obtained with 10 4 random L N sequences , are summarized in Table 1 . The optimal i values corresponding to the minimal P L i values are large compared to the permutation control . The best values of P L are smaller with the D - based order than they are with random order . A better measure than min P L to characterize a proﬁle is the average value of log ( P L ) , because its distributions for random and expression - based orders overlap lit - tle . The results of Table 1 show that the P L proﬁle can detect co - expression of 302 J . Pradines et al . Table 1 . Mean ( standard deviation ) of P L proﬁle characteristics for gene expression based and random protein orders protein order optimal i min i ( log P L i ) (cid:2) log P L i (cid:3) i based on gene expression 940 ( 771 ) - 7 . 1 ( 6 . 2 ) - 1 . 9 ( 1 . 3 ) random 672 ( 834 ) - 1 . 3 ( 0 . 6 ) - 0 . 4 ( 0 . 1 ) pathway neighbors . Now , to state about a given partition of the tumor samples , we might want to compare its P L proﬁle to those obtained with random par - titions . Building such control distribution is not a problem because P L proﬁles are fast to compute . As mentioned above , a good statistic to compare P L pro - ﬁles is the sum of the log ( P L ) values . Each P L is appropriately normalized for degrees , but adequate normalization of the sum requires further mathematical treatment . 3 Area of a Proﬁle In the previous section we indicated that P L is a degree - robust measure which reasonably approximates the p - value for higher connectedness under the permu - tation control . In this section we show that the same holds for the area of a connectedness proﬁle . 3 . 1 Distribution of Connectedness Proﬁle Area Under the RGGED Instead of working with log ( P L i ) we consider a centered and reduced version of the size X i of the subgraph induced by the protein set L i : Z i = X i − λ i σ i for i ≥ 2 and Z 1 = 0 , with σ 2 i = (cid:2) r < s ≤ i p rs ( 1 − p rs ) ( 5 ) and p rs being deﬁned by ( 1 ) . When i is large , the distribution of Z i is close to normal . Convergence can be roughly estimated by approximating X i with a Poisson variable : σ 2 i (cid:8) λ i (cid:8) i ( i − 1 ) 2 (cid:2) k (cid:3) 2 2 M (cid:8) i 2 (cid:2) k (cid:3) 2 N . ( 6 ) If our criterion for normality is λ i ≥ 5 , then we must have i ≥ 86 for the network used in this paper . For large i there is a monotonic mapping between Z i and log ( P L i ) , so that the P L proﬁle area is well represented by the sum of the Z i values . We deﬁne the Z - proﬁle area up to index n ≤ N by A n = n (cid:2) i = 1 Z i = n (cid:2) i = 2 X i σ i − γ n , γ n = n (cid:2) i = 2 λ i σ i . ( 7 ) Connectedness Proﬁles in Protein Networks 303 By deﬁnition of Z i , the expected value of A n is 0 . We next turn X i into a sum of independent attachment variables X a j , each X a j being the number of edges between v j and v l for l < j . The variance S 2 n of A n is then easily obtained : A n = n (cid:2) i = 2 β i X a i − γ n ; S 2 n = n (cid:2) i = 2 β 2 i σ 2 a i , β i = n (cid:2) j = i 1 σ j , σ 2 a i = (cid:2) j < i p ij ( 1 − p ij ) . ( 8 ) We argue that the asymptotic distribution of A n is Gaussian . This is not trivial because the variables X a i have diﬀerent distributions . Also , since the Z i vari - ables are dependent , their normality does not necessarily imply that of A n . We decompose X a i into a sum of Bernoulli variables B ij , one for each possible edge : A n = n (cid:2) i = 2 β i i − 1 (cid:2) j = 1 B ij − γ n . ( 9 ) Suﬃcient conditions for convergence of the distribution of A n to normality are given by a theorem due to Lindeberg [ 32 ] : Lindeberg’s theorem . The central limit theorem applies when for any (cid:11) > 0 the truncated variables U ij deﬁned by U ij = β i | B ij − p ij | if β i | B ij − p ij | ≤ (cid:11)S n and U ij = 0 otherwise ( 10 ) are such that when n → ∞ S n → ∞ and 1 S 2 n (cid:2) ( ij ) E (cid:5) U 2 ij (cid:6) → 1 . ( 11 ) Note that the rigorous formulation of ( 10 ) is with | β i B ij − E ( β i B ij ) | . We have simpliﬁed given that β i > 0 . If for any (cid:11) > 0 , S n increases fast enough with n so that U ij = β i | B ij − p ij | , then ( 11 ) is satisﬁed . We now show that this is the case when there is no degree correlation in L N . Approximating σ 2 i with ( 6 ) and σ 2 a i with i (cid:2) k (cid:3) / N gives β i (cid:8) ρ n (cid:2) j = i 1 j , ρ = (cid:4) 2 N / (cid:2) k (cid:3) , S 2 n (cid:8) 2 n (cid:2) i = 2 i ⎛ ⎝ n (cid:2) j = i 1 j ⎞ ⎠ 2 . ( 12 ) We then notice that S 2 n ≥ 4 ( h n − 1 ) 2 , where h n is the harmonic series . Given that h n diverges , the left part of ( 11 ) is satisﬁed . To ﬁnd a lower bound of S 2 n we use i n (cid:2) j = i 1 j ≥ i n (cid:2) j = i 1 n ≥ f ( i ) with f ( i ) = i (cid:11) 1 − i n (cid:12) . Studying f yields a lower bound of S 2 n and there exists a trivial upper bound for U ij . S 2 n ≥ 2 3 n / 4 (cid:2) n / 4 1 i f 2 ( i ) ≥ 2 3 n / 4 (cid:2) n / 4 4 3 n 9 n 2 16 2 ≥ 3 n 2 64 ; U ij ≤ β i ≤ ρ ( 1 + ln ( n ) ) . ( 13 ) 304 J . Pradines et al . Let (cid:11) > 0 be given . Since x / ln ( x ) → ∞ as x → ∞ , there exists n such that n ≥ 8 ρ ( 1 + ln ( n ) ) / (cid:11) √ 3 and (cid:11)S n ≥ β i | B ij − p ij | so that the variables U ij and β i | B ij − p ij | are identical and ( 11 ) is satisﬁed . Since the Lindeberg theorem applies to A n + γ n , the asymptotic distribution of A n is normal . In our proof we considered that σ 2 i scaled as i 2 and σ 2 a i as i , based on the assumption of no correlation between rank and degree in L N . The values of S n predicted by such approximations ( 12 ) are displayed by the line of Fig . 3 ( a ) . Squares corresponds to the exact S n values ( 8 ) averaged over 10 3 random vertex sequences . The ﬁt is excellent . However , ordering vertices by ascending degrees yields smaller S n values ( circles ) , and ordering by descending degrees gives larger values ( triangles ) . Therefore , we numerically checked convergence to normality for diﬀerent sequences of degrees . Figure 3 ( b ) shows that the L 1 distance d 1 be - tween the normal distribution and the distribution of A n / S n ( sampled with 10 3 realizations of the RGGED ) decreases as n increases . The speed of convergence depends of the sequence of degrees . Yet , in all cases , the Gaussian approxima - tion is reasonable when n > 5 , 000 . The protein network we use in this paper has N = 7 , 302 vertices . Therefore , whatever the sequence of degrees is , A N has normal distribution under the RGGED . Also , note that the computation of A N and S N can be performed in O ( M ) via an algorithm similar that of Sect . 2 . 2 . 0 2000 4000 6000 0 2000 4000 6000 Sn n ( a ) degree independent ascending degrees descending degrees 0 100 200 10 100 1000 d1 n ( b ) Fig . 3 . ( a ) Standard deviation S n of the Z proﬁle area as a function of the proﬁle length n . ( b ) Convergence of A n / S n to a normal variable under the RGGED : values of the L 1 distance to normality , averaged over 10 2 protein orders . Values above the horizontal line have probability less than 0 . 01 with a normal variable . The normality of A N under the RGGED is a useful property . It allows us to compare connectedness proﬁles by their values of A N / S N , this quantity being appropriately normalized for the sequence of degrees . We indicate in the next section that this property carries over to the permutation control . 3 . 2 Distribution Under the Permutation Control Figure 4 ( a ) shows the distribution of A N / S N across 10 4 random L N sequences . It is Gaussian , its mean is slightly shifted from zero ( + 0 . 07 ) and its standard deviation is smaller ( 0 . 41 ) than that expected in the RGGED . The diﬀerence of means is due to λ N being smaller than M : by half the sum of p ii over all Connectedness Proﬁles in Protein Networks 305 vertices . When we compute λ N , we do not consider self edges ( v i v i ) but the formula p ij = k i k j / 2 M does . The diﬀerence of variances seen in panel ( a ) of Fig . 4 is explained by panel ( b ) . In the RGGED the parameter σ i increases linearly with i . In the permutation control the standard deviation sd i of x i is a non - monotonic function of i , because the total number of edges is constrained to M . Using the values of sd i instead of σ i in equation ( 8 ) gives the value S N = 0 . 41 observed with the permutation control . As shown by Fig . 4 ( a ) , such diﬀerence of variances implies that the p - value for A N / S N under the RGGED is a conservative estimation of the p - value under the permutation control . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 - 3 - 2 - 1 0 1 2 3 d e n s i t y An / Sn RGGED permutationcontrol ( a ) 0 100 200 300 400 0 2000 4000 6000 va l u e i ( b ) sd ( X ) i pc < s i > pc Fig . 4 . ( a ) Distributions of the Z - proﬁle area under the RGGED and the permutation control . ( b ) Standard deviation of x i under the permutation control and average σ i . We now show that this property is preserved when the permutation control is no longer independent of vertex degree . Table 2 gives the mean and the stan - dard deviation of A N / S N for diﬀerent types of random protein orders . All values were estimated with 10 4 L N sequences . When the protein order is correlated to degrees , the mean of A N / S N signiﬁcantly increases . Rather than indicating a problem in the way A N / S N is normalized for degrees , the shift of the distri - bution points out a property of the network known as positive degree mixing [ 16 ] : vertices with similar degrees tend to be adjacent . To show that degree mixing accounts for the observed shift , we rewired the network with the so - called switching algorithm [ 4 ] . This destroys mixing while preserving degrees . Table 2 shows that both means and standard deviations of A N / S N go back towards zero . Therefore , it is reasonable to state that the p - value for A N / S N under the RGGED is a conservative approximation for the p - value under the permutation control , whatever the sequence of degrees is . Degree mixing has no meaningful impact on the analysis of experimental data , as long as the knowledge of the degrees is not used to order the proteins . 3 . 3 Application to Gene Expression Data As an example , we consider two groups of tumors : 173 multiple myeloma samples that are associated with bone lesions and 36 that are not [ 31 ] . The values of the proﬁle areas obtained for diﬀerent expression scores are given in Table 3 . The 306 J . Pradines et al . Table 2 . Mean ( standard deviation ) of A N / S N for diﬀerent types of random protein orders order degree independent ascending degrees descending degrees original network 0 . 07 ( 0 . 41 ) 42 . 30 ( 0 . 42 ) 11 . 96 ( 0 . 01 ) rewired network 0 . 07 ( 0 . 41 ) 0 . 48 ( 0 . 25 ) 0 . 06 ( 0 . 005 ) best mapping to the network is obtained when ranking genes for their higher expression in the samples associated with bone lesions ( A N / S N = 9 . 15 ) . This corresponds to a p - value of 10 − 20 in the RGGED , and thus to an even smaller p - value under the permutation control . A more informative p - value can be es - timated by comparing the proﬁle area to those obtained with random groups . Table 3 shows that only 0 . 2 % of 10 4 random partitions yield a mapping to the network better than that obtained with the original groups . Therefore , we can be conﬁdent that genes having higher expression in the tumors associated with bone lesions are signiﬁcantly close in the protein network . The mapping to the network less signiﬁcant for genes having lower expression in samples with bone lesions ( p = 0 . 015 ) and an intermediate p - value is obtained when ordering genes by their fold change ( p = 0 . 005 ) . Also , genes which are not diﬀerentially expressed between the two groups ( ascending values of | D | ) are not as well or - ganized inside the network ( p = 0 . 02 ) . The pathways they map to are less likely to be related to the presence or absence of bone lesions . Table 3 . Diﬀerential expression associated with bone - lesion inducing tumors is path - way coherent Bone lesions / no lesions Random groups Expression score D | D | D | D | Expression score Order desc . asc . desc . asc . desc . asc . desc . asc . Order A N / S N value 9 . 15 6 . 8 2 . 27 1 . 27 2 . 37 2 . 37 0 . 45 0 . 30 Mean p - value 0 . 002 0 . 015 0 . 005 0 . 021 1 . 49 1 . 49 0 . 53 0 . 45 S . D . 4 Area of a Weighted Proﬁle As mentioned above , connectedness proﬁles can be compared by the degree - robust quantity A N / S N . For instance , in Fig . 3 ( a ) the proﬁle for the appendix samples has a larger area ( 11 . 8 ) than the proﬁle obtained with the adipocytes ( 8 . 0 ) . Yet , one might ﬁnd the latter more interesting because the best P L value corresponds to fewer proteins . Such diﬀerence can be quantiﬁed by making a weighted proﬁle w i Z i , where large indices i are deemphasized , and using the sum Aw N of the weighted variables . Since the standard deviation σ i of X i scales as i , a convenient weighting scheme is Aw N = N (cid:2) i = 1 w i Z i , with w i = i − θ and 0 < θ < 1 . ( 14 ) Connectedness Proﬁles in Protein Networks 307 0 10 20 30 0 2000 4000 6000 Z i ( a ) descendingorder ascendingorder 2 4 6 8 10 50 100 150 n e t w o r k sc o r e clustering step ( b ) Fig . 5 . ( a ) Connectedness proﬁles based on diﬀerential expression D in promyelocytic leukemia compared to 78 other tissues . Vertical lines indicate the points at which D = 0 , and arrows the best values of connectedness Z . ( b ) Evolution of a network - mapping score based on Aw N / Sw N during the clustering of tumor samples . A high score indicates a partition into pathway - coherent groups . Lines show the average values ( ± one standard deviation ) over 10 3 runs of random clustering . All the results obtained for the non - weighted proﬁle carry over to the weighted one . Weighted proﬁles can be compared by their values of Aw N / Sw N , where Sw N is the standard deviation of Aw N in the RGGED . For instance , with weight parameter θ = 0 . 5 , Aw N is larger ( 13 . 3 ) for the adipocyte proﬁle of Fig . 3 ( a ) than it is for the appendix proﬁle ( 11 . 9 ) . Weighting a connectedness proﬁle can also avoid paradoxical results in the case of extreme proﬁles such as those displayed in Fig . 5 ( a ) . Two proﬁles were obtained by ordering genes for their higher or lower expression in samples of promyelocytic leukemia compared to 78 other tissues [ 24 ] . Ordering genes by descending values of the expression score D ( 3 ) gives a Z proﬁle reaching its maximum before D becomes negative ( vertical line ) . On the contrary , the reverse order yields a maximal Z value only after D changes sign . So , up - regulated genes largely contribute to the proﬁle area A N intended to characterize down - regulated genes . Such problem can be avoided by using Aw N instead of A N . Comparing the proﬁle area of a protein order to that of the reverse order is required for the last example of application we consider . Clustering of microarray experiments is a widely used technique to uncover groups of samples based on gene expression . One important question is whether these groups are associated with known pathways . Here , we clustered 173 multiple myeloma samples [ 31 ] via a greedy agglomerative algorithm . The distance between samples is based on the Pearson correlation coeﬃcient and the clustering output is a binary tree . Samples were grouped together because some genes have higher or lower expression in these samples versus the others . So , each cluster deﬁnes a diﬀerential expression score D and we can estimate how well it maps to the protein network with the largest value max A of Aw N / Sw N ( θ = 0 . 5 ) , when genes are ordered by descending or ascending D values . Each clustering step gives a partition of the samples and an average score (cid:2) max A (cid:3) . Figure 5 ( b ) shows that (cid:2) max A (cid:3) increases during the clustering . For comparison , (cid:2) max A (cid:3) tends to decrease in average across 10 3 runs of random clustering . Therefore , the clusters obtained with the 308 J . Pradines et al . greedy algorithm might be associated with certain functional modules . These groups of samples do not signiﬁcantly overlap with the two categories deﬁned by the presence or absence of bone lesions . So , the clustering gave other pathway - coherent partitions of the tumor samples . 5 Conclusion In this paper we have presented degree - robust statistics of connectedness that are useful for working with protein networks . Robustness to degrees is impor - tant , since individual proteins can have very diﬀerent numbers of interactions . The computation of our statistics is fast , in contrast to the commonly utilized approach of rewiring edges to control for degrees . Hence , this work should open new possibilities in the computational biology of protein networks . Even though our connectedness measures were deﬁned via a rather abstract model of random graph , they have simple interpretations . The probability P L is a good approximation of the p - value for higher connectedness when selecting | L | proteins at random . The p - value of A N / S N in the RGGED approximates the p - value for a stronger mapping between gene expression score and interaction in the network when randomly ordering genes . We have presented a few examples of application to the analysis of gene ex - pression data . Clearly , there are more potential use cases and they can be based on other gene attributes than expression scores . For instance , one could order proteins for the match of their sequence to a given amino - acid motif . An opti - mization algorithm based on Aw N / Sw N could then identify motifs that relate to protein interaction . Finally , the degree - robust yet fast identiﬁcation of vertex attributes that relate to adjacency in a graph could prove useful in general . Acknowledgments We thank Rich Ferrante , Stan Letovsky and Noah Pradines for their comments . References 1 . Bader , G . , Betel , D . , Hogue , C . : Bind : the biomolecular interaction network database . Nucleic Acids Res . 31 ( 2003 ) 248 – 250 2 . Peri , S . , Navarro , J . , Amanchy , R . , Kristiansen , T . , Jonnalagadda , C . , Suren - dranath , V . , Niranjan , V . , Muthusamy , B . , Gandhi , T . , Gronborg , M . , Ibarrola , N . , Deshpande , N . , Shanker , K . , Shivashankar , H . , Rashmi , B . , Ramya , M . , Zhao , Z . , Chandrika , K . , Padma , N . , Harsha , H . , Yatish , A . , Kavitha , M . , Menezes , M . , Choudhury , D . , Suresh , S . , Ghosh , N . , Saravana , R . , Chandran , S . , Krishna , S . , Joy , M . , Anand , S . , Madavan , V . , Joseph , A . , Wong , G . , Schiemann , W . , Constan - tinescu , S . , Huang , L . , Khosravi - Far , R . , Steen , H . , Tewari , M . , Ghaﬀari , S . , Blobe , G . , Dang , C . , Garcia , J . , Pevsner , J . , Jensen , O . , Roepstorﬀ , P . , Deshpande , K . , Chinnaiyan , A . , Hamosh , A . , Chakravarti , A . , Pandey , A . : Development of human protein reference database as an initial platform for approaching systems biology in humans . Genome Res . 13 ( 2003 ) 2363 – 2371 Connectedness Proﬁles in Protein Networks 309 3 . Han , J . , Dupuy , D . , Bertin , N . , Cusick , M . , Vidal , M . : Eﬀect of sampling on topology predictions of protein - protein interaction networks . Nat . Biotechnol . 23 ( 2005 ) 839 – 844 4 . Maslov , S . , Sneppen , K . : Speciﬁcity and stability in topology of protein networks . Science 296 ( 2002 ) 910 – 913 5 . Milo , R . , Shen - Orr , S . , Itzkovitz , S . , Kashtan , N . , Chklovskii , D . , Alon , U . : Network motifs : simple building blocks of complex networks . Science 298 ( 2002 ) 824 – 827 6 . Sharan , R . , Ideker , T . , Kelley , B . , Shamir , R . , RM , K . : Identiﬁcation of protein complexes by comparative analysis of yeast and bacterial protein interaction data . J . Comp . Biol . 12 ( 6 ) ( 2005 ) 835 – 846 7 . Koyut¨urk , M . , Grama , A . , Szpankowski , W . : Assessing signiﬁcance of connectivity and conservation in protein interaction networks . In : RECOMB - 06 . LNBI ( 2006 ) 45 – 59 8 . Itzkovitz , S . , Milo , R . , Kashtan , N . , Ziv , G . , Alon , U . : Subgraphs in random networks . Phys . Rev . E 68 ( 2003 ) 026127 9 . Bender , E . , Canﬁeld , E . : The asymptotic number of labelled graphs with given degree sequences . J . Combin . Theory ( A ) 24 ( 1978 ) 296 – 307 10 . Molloy , M . , Reed , B . : The size of the giant component of a random graph with a given degree sequence . Comb . Prob . Comp . 7 ( 1998 ) 295 – 305 11 . Newman , M . , Strogatz , S . , Watts , D . : Random graphs with arbitrary degree dis - tributions and their applications . Phys . Rev . E 64 ( 2001 ) 026118 12 . Park , J . , Newman , M . : The statistical mechanics of networks . Phys . Rev . E 70 ( 2004 ) 066117 13 . Chung , F . , Lu , L . : The average distance in random graphs with given expected degrees . Proc . Natl . Acad . Sci . USA 99 ( 2002 ) 15879 – 15882 14 . Pradines , J . , Farutin , V . , Rowley , S . , Danˇc´ık , V . : Analyzing protein lists with large networks : edge - count probabilities in random graphs with given expected degrees . J . Comp . Biol . 12 ( 2 ) ( 2005 ) 113 – 128 15 . Farutin , V . , Robison , K . , Lightcap , E . , Dancik , V . , Ruttenberg , A . , Letovsky , S . , Pradines , J . : Edge - count probabilities for the identiﬁcation of local protein com - munities and their organization . Proteins 62 ( 3 ) ( 2006 ) 800 – 818 16 . Newman , M . : Mixing patterns in networks . Phys . Rev . E 67 ( 2003 ) 026126 17 . Barrett , T . , Suzek , T . , Troup , D . , Wilhite , S . , Ngau , W . , Ledoux , P . , Rudnev , D . , Lash , A . , Fujibuchi , W . , Edgar , R . : Ncbi geo : mining millions of expression proﬁles – database and tools . Nucleic Acids Res . 33 ( 2005 ) D562 – D566 18 . Goto , S . , Okuno , Y . , Hattori , M . , Nishioka , T . , Kanehisa , M . : Ligand : database of chemical compounds and reactions in biological pathways . Nucleic Acids Res . 30 ( 1 ) ( 2002 ) 402 – 404 19 . Kanehisa , M . , Goto , S . , Hattori , M . , Aoki - Kinoshita , K . , Itoh , M . , Kawashima , S . , Katayama , T . , Araki , M . , Hirakawa , M . : From genomics to chemical genomics : new developments in kegg . Nucleic Acids Res . 34 ( 2006 ) D354 – D357 20 . Hakimi , S . : On realizability of a set of integers as degrees of the vertices of a linear graph . J . Soc . Ind . Appl . Math . 10 ( 1962 ) 496 – 506 21 . Soﬀer , S . , Vazquez , A . : Clustering coeﬃcient without degree correlations biases . Phys . Rev . E 71 ( 5 Pt 2 ) ( 2005 ) 057101 22 . Le Cam , L . : An approximation theorem for the poisson binomial distribution . Pacif . J . Math . 10 ( 1960 ) 1181 – 1197 23 . Kerstan , J . : Verallgemeinerung eines satzes von prochorow und le cam . Z Washrscheinlichkeitstheorie und Verw . Gebiete 2 ( 1964 ) 173 – 179 310 J . Pradines et al . 24 . Su , A . , Wiltshire , T . , Batalov , S . , Lapp , H . , Ching , K . , Block , D . , Zhang , J . , Soden , R . , Hayakawa , M . , Kreiman , G . , Cooke , M . , Walker , J . , JB , H . : A gene atlas of the mouse and human protein - encoding transcriptomes . Proc . Natl . Acad . Sci . USA 101 ( 16 ) ( 2004 ) 6062 – 6067 25 . Newman , M . : Fast algorithm for detecting community structure in networks . Phys . Rev . E 69 ( 2004 ) 066133 26 . Clauset , A . , Newman , M . E . J . , Moore , C . : Finding community structure in very large networks . Phys . Rev . E 70 ( 2004 ) 066111 27 . Ideker , T . , Ozier , O . , Schwikowski , B . , Siegel , A . : Discovering regulatory and signalling circuits in molecular interaction networks . Bioinformatics 18 ( Suppl . 1 ) ( 2002 ) S233 – S240 28 . Pradines , J . , Rudolph - Owen , L . , Hunter , J . , Leroy , P . , Cary , M . , Coopersmith , R . , Dancik , V . , Eltsefon , Y . , Farutin , V . , Leroy , C . , Rees , J . , Rose , D . , Rowley , S . , Ruttenberg , A . , Wieghardt , P . , Sander , C . , Reich , C . : Detection of activity centers in cellular pathways using transcript proﬁling . J . Biopharm . Stat . 14 ( 2004 ) 1 – 21 29 . Grigoriev , A . : A relationship between gene expression and protein interactions on the proteome scale : analysis of the bacteriophage t7 and the yeast saccharomyces cerevisiae . Nucleic Acids Res . 29 ( 17 ) ( 2001 ) 3513 – 3519 30 . Jansen , R . , Greenbaum , D . , Gerstein , M . : Relating whole - genome expression data with protein - protein interactions . Genome Res . 12 ( 1 ) ( 2002 ) 37 – 46 31 . Tian , E . , Zhan , F . , Walker , R . , Rasmussen , E . , Ma , Y . , Barlogie , B . , Shaughnessy , J . : The role of the wnt - signaling antagonist dkk1 in the development of osteolytic lesions in multiple myeloma . N . Engl . J . Med . 349 ( 26 ) ( 2003 ) 2483 – 2494 32 . Feller , W . : XI . In : An introduction to probability theory and its applications . Volume I . John Wiley & Sons , New York ( 1970 ) 254 – 255
Supporting Text S1 for Yeast mating and image - based quantiﬁcation of spatial pattern formation Christian Diener 1 , 2 ∗ , Gabriele Schreiber 1 ∗ , Wolfgang Giese 1 ∗ , Gabriel del Rio 2 , Andreas Schr¨oder 3 , Edda Klipp 1 ∗ 1 ∗ Theoretische Biophysik , Humboldt - Universit¨at zu Berlin , Invalidenstr . 42 , 10115 Berlin , Germany 2 Instituto de Fisiolog´ıa Celular , Universidad Nacional Aut´onoma de M´exico S / N Ciudad Universitaria , 04510 M´exico D . F , M´exico 3 Department of Mathematics , University of Salzburg , Hellbrunnerstr . 34 , 5020 Salzburg , Austria ∗ Correspondence to : edda . klipp @ biologie . hu - berlin . de Contents Computational Techniques 2 Image analysis with CellID to identify cell type and location . . . . . . . . . . . . . . . . . . . . . . . . 2 Construction of the computational domain for simulations . . . . . . . . . . . . . . . . . . . . . . . . . 2 Dynamic model equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 Boundary and initial conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 Model reduction and stationary distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 Calibration and Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 Calculating the local α - factor concentrations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 Estimating the Bar1 activity kinetics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 Estimating the average α - factor secretion rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 Analysis of α - factor distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 Numerical methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 Figures S1 to S8 11 Tables S1 and S2 17 Supporting Text S1 Computational Techniques We established an eﬃcient workﬂow between experiment and mathematical model and automatized major parts of the whole process . In the following , we describe the procedure from analyzing microscopic images to ﬁnally visualize the calculated spatial patterns of the mating pheromone distribution . In particular , we introduce the methods for the automatic identiﬁcation of mating types on images as well as the transformation of microscopic pictures to the corresponding computational domains , which are represented as ﬁnite element meshes . Furthermore , a detailed explanation of the mathematical model equations as well as the boundary conditions is given . The presented computational approach allows us to estimate α - factor distributions by calculating pheromone distributions and ﬂuxes for various spatial cell arrangements in the experimental setup . Image analysis with CellID to identify cell type and location Images were generated using the Olympus Software as described in the main text ( see Materials and Methods ) and analyzed with CellID [ 1 ] . In order to prepare them for analysis , all z positions starting from the focal plane to the most extreme out - of - focus coordinate ( thus , the upper half of the z - stack ) were projected over the z - axis via an average intensity projection . This was done in order to obtain the required out - of - focus images with low noise levels . Since far out - of - focus images in the ﬂuorescent channels generally showed a strong autoﬂuorescence only the three slices closest to the focus were used for an average intensity z - projection here . No other modiﬁcations were applied to the images prior to analysis . Figure 1 and Figure 3 ( see main text ) were generated by an overlay of the bright ﬁeld , GFP and mCherry channel . Here the contrast was adapted linearly to aid visibility ( originals shown in Figure S1 ) . However , no contrast or pixel value modiﬁcation was ever applied to images used for analysis or quantiﬁcation . The generated projections were consecutively analyzed using VCellID and a modiﬁed version of CellID [ 2 ] . Here , the modiﬁcation of CellID led to additional text ﬁle output containing the individual boundaries for each detected cell along with a list of all interior pixels and by - pixel ﬂuorescence values contained within an area extending the cell boundary by 3 pixels . Parameters for CellID were chosen within VCellID to maximize the fraction of detected cells . The output was further analyzed with the statistical scripting environment R [ 3 ] . Using CellID output , we expressed the x and y locations in micrometers . For each cell i the ﬂuorescence level ( mCherry for MAT α and GFP for MAT a ) was translated to the average ﬂuorescence per pixel F i with F i = F itot n ipix − F bg . ( 1 ) Here , F itot denotes the total ﬂuorescence for a given cell with index i , n ipix the number of contained pixels and F bg is the background ﬂuorescence , which is calculated from the intensities of the pixels not contained in cells . Since MAT α cells were labeled with a constitutive mCherry marker , cells with ﬂuorescence value above four times the background in the mCherry channel were identiﬁed as MAT α cells . All other cells were considered MAT a haploids . Construction of the computational domain for simulations We use real cell positions and activation levels to enable realistic simulations of the distributions of α - factor and Bar1 activity . To this end , individual cell boundaries were read from the output of the modiﬁed CellID and were transferred to polar coordinates based on the center of the cells . This information was used to approximate cell boundaries with a smoothing spline . Overlaps occurring after smoothing were resolved automatically . The generated cell shapes were used to build up the geometry and mesh for the ﬁnite element representation , for which meshing was performed within the Gmsh framework [ 4 ] and , thus , conforming to its geometry formats . The construction of the ﬁnite element mesh was started from a disk with a given radius chosen large enough such that it left suﬃcient space within the outer regions of the mesh . Cells were cut out of the disk according to the spline generated from the boundary pixels in order to yield a geometry reﬂecting the cell boundaries on the image . A unique boundary ID was assigned to each cell which was later used to identify the cell type ( MAT a or MAT α ) . The resulting geometry was then used to generate a triangular mesh with the Frontal algorithm implemented in Gmsh ( compare Figure S2 ) . Reﬁnement of the grid increased the accuracy of the approximate ﬁnite element solution . Since we were interested in obtaining high - accuracy solutions particularly in regions close to cells , the size of the generated triangles was adapted automatically in the vicinity of cells or at sites of complex geometry . This was achieved through the calculation of a local density map from the binned densities of all original boundary points returned by CellID with 128 bins in the x and y direction . A diameter size S C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 2 Supporting Text S1 was then assigned to each point used in the geometry of the grid via the relation S = max { λ S · e − γD ( x , y ) , λ M } , ( 2 ) where D ( x , y ) is the local density of the point and γ , λ S and λ M were scaling parameters controlling the minimum and maximum target size . The generated diameter sizes for the triangles were imposed upon the Frontal algorithm to create a mesh that is able to represent the cell shapes . The resulting mesh was then exported and used for the following ﬁnite element simulations and parameter optimization . Dynamic model equations In the experimental set up described above the cells were put on a dish within a thin ﬂuid layer of height h . To simulate the diﬀusion of α - factor and Bar1 during a given time period [ 0 , T ] we establish a system of reaction - diﬀusion equations on a computational domain Ω ⊂ R 2 ( see Figure S3 ) . This domain represents the extracellular space in the view from above . The following system of partial diﬀerential equations describes concentrations , i . e . molecules per area . Note that the projection onto a two dimensional domain does not aﬀect the diﬀusion constants . We consider free diﬀusion of α - factor and Bar1 in the extracellular medium and the degradation of α - factor by Bar1 . The system of reaction - diﬀusion equations reads as : ∂α ( x , t ) ∂t = D α ∆ α ( x , t ) − k · Bar 1 ( x , t ) · α ( x , t ) in Ω × ( 0 , T ) , ( 3 ) ∂Bar 1 ( x , t ) ∂t = D B ∆ Bar 1 ( x , t ) in Ω × ( 0 , T ) . ( 4 ) D α and D B denote the diﬀusion contants of α - factor and Bar1 , respectively . The Laplace operator ∆ denotes the second order derivative with respect to the spatial dimension . The reaction term on the right hand side of equation ( 3 ) eﬀectuates a negative feedback from Bar1 on the α - factor concentration . Secretion and absorption processes are described via ﬂux conditions ( also called Neumann boundary conditions ) as explained below . The α - factor absorption of each MAT a cell is measured by a boundary integral over the surface of the MAT a cells , which determines the secretion of Bar1 . Boundary and initial conditions Since the interior of the cells is excluded from the computational domain , the boundaries also deﬁne cell walls ( compare Figure S3 ) . These boundaries are denoted by Γ α i and Γ a j for the i - th MAT α cell and for the j - th MAT a cell , respectively , where an appropriate numbering is used . The outer boundary is denoted by Γ sur . The secretion of α - factor by the MAT α cells is speciﬁed via Neumann boundary conditions , i . e . via the speciﬁcation of the ﬂux of the α - factor over the boundary , where a constant secretion of α - factor by each of these cells is assumed : − D α · ∇ α ( x , t ) · n ( x ) = J α i on Γ α i × ( 0 , T ) , i = 1 , . . . , N α . ( 5 ) N α denotes the number of MAT α cells . The vector n ( x ) is the unit outer normal with respect to the boundary and points into the cell interior . The other vector ∇ α ( x , t ) is a spatial gradient of α ( x , t ) . Hence , the mathemat - ical expression − D α ∇ α · n ( x ) is the ﬂux of α - factor from the intracellular into the extracellular area , which is the secretion rate J α i . On the boundary of the MAT a cells the α - factor is detected . It is assumed that binding eﬀects on the concentration of α - factor in the extracellular domain can be neglected . Hence , homogeneous Neumann boundary conditions are imposed : − D α · ∇ α ( x , t ) · n ( x ) = 0 on Γ a i × ( 0 , T ) , i = 1 , . . . , N a , ( 6 ) with N a the number of MAT a cells . Similarly , homogeneous Neumann boundary conditions are assumed for the surrounding , i . e . the exchange of α - factor between the computational domain and the remaining cell culture is in equilibrium : − D α · ∇ α ( x , t ) · n ( x ) = 0 on Γ sur × ( 0 , T ) . ( 7 ) C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 3 Supporting Text S1 The MAT a cells are assumed to secrete the aspartyl protease Bar1 depending on the α - factor that is present on the cell surface . Bar1 expression depends on the average concentration of α - factor on the boundary of the considered cell I α i in the following manner : I α i ( t ) = 1 | Γ a i | (cid:90) Γ ai α ( x , t ) dS , i = 1 , . . . , N a . ( 8 ) Secretion of Bar1 is induced by the resulting gene expression and , therefore , the Bar1 concentration in the vicinity of the cell wall should follow the same kinetics as the Fus1 expression which is obtained from the imaging experiments . Hence , the Bar1 concentration is given by the following Dirichlet boundary condition : Bar 1 ( x , t ) = k 0 + k 1 I α i ( t − τ ) H I α i ( t − τ ) H + EC H 50 on Γ a i × ( 0 , T ) , i = 1 , . . . , N a . ( 9 ) The constant k 0 is the basal expression of Bar1 and k 1 is the maximal expression upon detection of α - factor , whereas τ is the delay that represents the time required for the processes from the pheromone pathway activation to the expression of Bar1 . The coeﬃcient H and the kinetic constant EC 50 are the parameters of the Hill curve used for the ﬂuorescence expression . Note that Bar1 is neither absorbed nor secreted by the MAT α cells . Thus , homogeneous Neumann boundary conditions are assumed : − D B · ∇ Bar 1 ( x , t ) · n ( x ) = 0 on Γ a i × ( 0 , T ) , i = 1 , . . . , N a . ( 10 ) On the exterior boundary Bar1 we also assume Neumann boundary conditions for Bar1 . To describe an equi - librium exchange with the environment due to the fast Bar1 diﬀusion : − D B · ∇ Bar 1 ( x , t ) · n ( x ) = 0 on Γ sur × ( 0 , T ) . ( 11 ) Moreover , for the initial conditions we assume : α ( x , 0 ) = α 0 ( x ) in Ω , Bar 1 ( x , 0 ) = Bar 1 0 ( x ) in Ω . ( 12 ) Model reduction and stationary distributions Since we measured the degradation of α - factor by Bar1 in the experiments , we found that the concentration of Bar 1 ( x , t ) and the degradation constant k cannot be estimated at the same time as they are strongly correlated in the parameter estimation results . Therefore , the reaction - diﬀusion equations ( 3 ) , ( 4 ) for Bar1 were simpliﬁed by introducing the Bar1 activity B ( x , t ) = k · Bar 1 ( x , t ) . This yields the equation system : ∂α ( x , t ) ∂t = D α ∆ α ( x , t ) − B ( x , t ) · α ( x , t ) in Ω × ( 0 , T ) , ( 13 ) ∂B ( x , t ) ∂t = D B ∆ B ( x , t ) in Ω × ( 0 , T ) . ( 14 ) Note , that also the inhomogeneous boundary conditions have to be adapted : B ( x , t ) = ˜ k 0 + ˜ k 1 I α i ( t − τ ) H I α i ( t − τ ) H + EC H 50 on Γ a i , i = 1 , . . . , N a , ( 15 ) where ˜ k 0 = k · k 0 and ˜ k 1 = k · k 1 . In the remainder , we use B instead of k · Bar 1 and assume that the α - factor secretion rates are proportional to the size of the MAT α cells and hence , J α i = J α for all i = 1 , . . . , N α . The term B also includes non - speciﬁc spontaneous degradation of α - factor . A Bar1 deletion ( bar 1∆ ) is simulated by reducing B to a constant with a constant Dirichlet boundary on all MAT a cells and an outer Neumann C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 4 Supporting Text S1 condition . This results in a constant distribution of B . Thus , for a deletion we simply set ˜ k 1 = 0 and ˜ k 0 = 10 − 3 as α - factor should show no signiﬁcant spontaneous degradation on a scale of 15 minutes . The steady state distribution of α - factor and Bar1 activity B is derived by omitting the time derivative on the left hand sides of equations ( 13 ) and ( 14 ) . This leads to the following reaction - diﬀusion system D α ∆ α ( x ) = B ( x ) · α ( x ) in Ω , ( 16 ) D B ∆ B ( x ) = 0 in Ω . ( 17 ) Also the boundary conditions are adapted to the stationary model . Hence , the time dependent boundary condition equation ( 9 ) becomes : B ( x ) = ˜ k 0 + ˜ k 1 I Hα i I Hα i + EC H 50 on Γ a i , i = 1 , . . . , N a , I α i = 1 | Γ a i | (cid:90) Γ ai α ( x ) dS . ( 18 ) The remaining boundary conditions equations ( 5 ) - ( 7 ) and equations ( 10 ) , ( 11 ) are exactly the same as in the instationary model . Only the parameters J α i , ˜ k 0 and ˜ k 1 have to be determined by parameter estimations from the microcopic data . The diﬀusion constants can instead be calculated from the protein properties since the medium we consider is only in the cell free space and thus is essentially an aqueous solution . The rates have been estimated by applying the Einstein - Stokes - Relation D = k B T 6 π · η · r , ( 19 ) where k B denotes the Boltzmann constant , T the temperature of the medium , η the viscosity of the medium and r the protein radius . The radius r is approximated from the density derived via the protein mass and applying the correction of Fischer et al . [ 5 ] to approximate the density of the protein from its mass : ρ ( M ) = 1 . 41 + 0 . 145 · exp (cid:18) M [ kDa ] 13 (cid:19) [ g · cm − 3 ] . ( 20 ) Converting that to [ kg · cm − 3 ] and assuming a globular shape for the protein within the aqueous medium M with viscosity η M the diﬀusion rate of a protein P is , thus , given by D ( P ) = k B T 6 π · η M · (cid:18) 750 · M P π · ρ ( M P ) (cid:19) − 1 / 3 . ( 21 ) Substituting the masses by the ones known for α - factor and Bar1 results in eﬀective diﬀusion rates of 361 . 48 µm 2 s − 1 and 104 . 63 µm 2 s − 1 , respectively . The relevant temperature of the climate chamber was 30 ◦ C . Calibration and Optimization The parameters J α i , ˜ k 0 , ˜ k 1 , EC H 50 and H of the mathematical model ( equations ( 13 ) - ( 14 ) ) were deduced from our experimental data on cell location and activation in three major steps . First , as a calibration , bar 1∆ mutants were used to establish an unambigious relation between the expression of Fus1 and the α - factor concentration perceived by a cell . This relationship was ﬁtted to a sigmoidal curve , and the relevant parameters EC 50 and H were identiﬁed . In the second setup , we observed solely MAT a cells of wild type to estimate the activity of Bar1 due to supplied α - factor . We measured Fus1 - GFP as indicator for Bar1 expression . The estimation employed solving a nonlinear ordinary delay diﬀerential equation with respect to an optimization problem . Finally , the model equations were solved in a spatial arrangement to determine the α - factor secretion rate . This was performed to obtain best model behavior and prediction of the spatial pheromone patterns for various cell arrangements . Details of the three steps are explained in the following . Calculating the local α - factor concentrations In order to quantitatively couple the solution of the reaction - diﬀusion system to the images we needed to relate the solution to the observable expression of Fus1 . Since the model only predicts the local integrated α - factor concentrations and Bar1 activity we required a calibration relating the Fus1 expression level to the local α - factor C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 5 Supporting Text S1 concentrations at the membrane of the cells . This was achieved by measuring the Fus1 expression levels via the ﬂuorescence intensity of Fus1 - GFP in MAT a bar 1∆ cells over a range of diﬀerent α - factor concentrations . Since Bar1 could not inﬂuence the concentration of α - factor in this genetic background , all cells were exposed to the same level of α - factor . Fus1 expression was quantiﬁed after 3 hours using confocal microscopy images . The individual GFP ﬂuorescence of each cell was quantiﬁed using CellID and R as described above . Since it has been reported that the response behavior of the pathway follows a Hill curve , we ﬁtted the ﬂuorescence values to that functional form [ 6 , 7 ] . This yielded a functional relationship between Fus1 - GFP expression and local α - factor concentrations of the form F obs = F max · α ( t − τ ) H α ( t − τ ) H + EC H 50 + F base . ( 22 ) For a given α - factor concentration the distribution of ﬂuorescence values showed a normal distribution ( 105 - 588 cells for each concentration ) . The ﬁtting of the Hill curve was performed by optimizing the log - likelihood of the calculated curve under the data by iteratively using a Simulated Annealing run followed by a Broy - den – Fletcher – Goldfarb – Shanno ( BFGS ) optimization ( see Figure S5 for results ) . Signiﬁcance was assessed us - ing the F - test . For any given local α - factor concentration equation ( 22 ) provides a unique relationship between the concentration and the steady state Fus1 - GFP ﬂuorescence . The surface of a spherical MAT a cell is by a factor 2 r i bigger than the circumference of the cell . This has to be taken into account since our model employs integrated quantities over the z - axis . In order to ensure the same α - factor levels in the integrated model the observed average α - factor concentration has to be scaled by this factor . As a consequence , for a given observed Fus1 - GFP expression we can derive the local α - factor concentration α i in direct vicinity of the MAT a cell i from the observed Fus1 - GFP ﬂuorescence F i in steady state as α i = 2 r i · EC 50 · (cid:18) F i F max + F base − F i (cid:19) 1 H . ( 23 ) Because F base is the autoﬂuorescence of cells not expressing Fus1 - GFP this quantity can also be quantiﬁed by the signal in the GFP channel of the MAT α mCherry cells which do not carry Fus1 - GFP . Estimating the Bar1 activity kinetics In the experimental setup for the estimation of the Bar1 activity only MAT a cells of the wild type are present and α - factor in given amounts is added to the cellular arrangement . Therefore , we assume that spatial inhomo - geneities can be neglected . To estimate the parameters ˜ k 0 and ˜ k 1 in equation ( 15 ) we reduce the PDE system equations ( 13 ) , ( 14 ) to an ordinary diﬀerential equation . Integration of equation ( 13 ) over Ω and application of Green’s formula gives the continuity equation d dt (cid:90) Ω α ( x , t ) dV = − D α (cid:90) ∂ Ω ∇ α ( x , t ) · n ( x ) dS − (cid:90) Ω B ( x , t ) α ( x , t ) dV . ( 24 ) Insertion of the boundary conditions ( equations ( 5 ) - ( 7 ) ) gives : d dt (cid:90) Ω α ( x , t ) dV = N α (cid:88) i = 0 (cid:90) Γ αi J α i dS − (cid:90) Ω B ( x , t ) α ( x , t ) dV . ( 25 ) Since there are no MAT α cells in the experimental setup , equation ( 25 ) simpliﬁes to : d dt (cid:90) Ω α ( x , t ) dV = − (cid:90) Ω B ( x , t ) α ( x , t ) dV . ( 26 ) The average α - factor concentration is ¯ α = 1 | Ω | (cid:82) Ω α ( x , t ) dV and it holds : | Ω | d dt ¯ α ( t ) = − | Ω | ¯ α ( t ) ¯ B ( t ) . ( 27 ) C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 6 Supporting Text S1 Furthermore , we deduce the average Bar1 activity from the Dirichlet boundary condition equation ( 15 ) . This yields a nonlinear equation with delay of the form : d dt ¯ α ( t ) = − ¯ α ( t ) (cid:18) ˜ k 0 + ˜ k 1 I ¯ α ( t − τ ) H I ¯ α ( t − τ ) H + ( EC 50 ) H (cid:19) . ( 28 ) This delay ODE can be solved for each of the diﬀerent α - factor concentrations yielding α ( t ) = { α i ( t ) } , i = 1 , . . . , N c . This leads to a predicted ﬂuorescence F ( t ) = { F i ( t ) } when plugging α ( t ) into equation ( 22 ) . We ﬁtted the parameters ˜ k 0 , ˜ k 1 and τ to our experimental data by a maximum likelihood optimization using the probability distributions of the observed ﬂuorescence of each of the N c diﬀerent experiments ( see Figure S5 ) . The ﬂuorescence values were given by normal distributions f i ( x , µ i , σ i ) measured at timepoint t obs ( 147 - 746 cells for each concentration , 2458 cells in total ) . The resulting optimization problems is given by : Find ˜ k 0 , ˜ k 1 , τ such that for F ( t ) = { F i ( t obs ) } : N c (cid:88) i = 1 ln f i ( F i ( t obs ) , µ i , σ i ) → max . ( 29 ) The ODE was solved by the fully adaptive implicit LSODA method and used during the optimization by again iterating Simulated Annealing and BFGS runs . Signiﬁcance was assessed using an F - test . The ﬁtted parameters were the steady state ( stimulated ) Bar1 activities and the delay time τ under the given number of cells in the population and the given volume . The delay time τ was optimized here since this is the only time course optimization we perform ( α - factor secretion parameter is ﬁtted later to the steady state ) . The activation of the Ste12 transcription factor takes at least 5 minutes [ 6 ] . Considering that Bar1 also has to be transcribed , translated , modiﬁed and exported we do expect that cells will need more time to adequately react with an increased Bar1 secretion . The ﬁtted value of τ ≈ 30 min is in good agreement with this consideration and our own observations that shmooing started later than half an hour after mixing of cultures . However , since all cells secrete Bar1 the steady state Bar1 activity is dependent on the number , and possibly , size of the cells in the population . Since the overall Bar1 activity will scale linearly with the total amount of Bar1 secreted , we normalized the obtained parameters by the fraction of the image area occupied by the total are of the cells . For any given cell conﬁguration on an image we calculated the corresponding Bar1 activity parameters . The volume of the containing medium was calculated by the image area multiplied with the height of the liquid ﬁlm . This height h is given by the surface tension γ of the medium ( aqueous solution ) , the gravitational acceleration g and the liquid density ρ via h = 2 (cid:114) γ gρ . ( 30 ) This ﬁnally yielded the Bar1 activity with and without stimulation , which was plugged into the reaction - diﬀusion equations ( also see Figure S5 ) . The ﬁtted Bar1 activity indicated a pheromone - dependent induction of about 3 - fold which was in good agreement with previous measurements ( 3 . 4 ± 1 . 1 [ 8 ] ) . The approximated Bar1 activity in a typical liquid ﬁlm ( h ≈ 170 µm ) where the bottom is covered completely with cells was derived as 0 . 24 s − 1 without α - factor induction and could rise to 0 . 84 s − 1 when induced by α - factor . This is a signiﬁcant degradation activity , however , it is strongly reduced on lower cell densities . For a cell density of 1 Mio . cells per ml the Bar1 activity is 0 . 00053 s − 1 to 0 . 002 s − 1 . Thus , the Bar1 activity is strongly coupled to the cell abundance in the medium and can reach a substantial value in high density cultures . Estimating the average α - factor secretion rate The observed local α - factor boundary value α i for the MAT a cell i was ﬁtted to the simulated α - factor con - centration I α i ( compare deﬁnition equation ( 8 ) ) on the MAT a cell wall . Hence , to estimate the surface ﬂux J α we solve the optimization problem : Find J α such that for α = { α i } : N a (cid:88) i = 1 ( I α i − α i ) 2 → min . ( 31 ) Here , we computed α i by solving the stationary equations ( 16 ) and ( 17 ) , where the computational domain is based on the corresponding microscopic image as described in the section ”Construction of the computational C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 7 Supporting Text S1 domain for simulations” . The BFGS method was used with a numeric approximation of the derivatives . We also implemented the Nelder - Mead method which does not require derivatives but uses more function evaluations in order to test the robustness of the results . Both optimizers led to the same results . For optimization problems with about 10 to 20 cells this resulted in a computation time of less than 10 minutes per image and CPU ( 3 GHz ) to reach a minimum for meshes with more than 20 . 000 triangles . We ﬁtted the secretion rate of α - factor to 10 images obtained on 2 diﬀerent days on a total of 52 MAT α and 90 MAT a cells . Signiﬁcance was assessed for all ﬁts using the F - test for a zero - intercept - one - parameter model where 9 of the ﬁts were found to be signiﬁ - cant . The total secretion per cell could be calculated by multiplying the resulting ﬂux ( in nM · µm 2 s − 1 ) by the average cell circumference calculated from the mean cell radius from the CASY counter experiments ( yielding a unit of nM · µm 3 s − 1 = 10 − 15 nmol / s , see Figure 7 main text ) . The resulting average secretion rate was 865 molecules / s per MAT α cell . The validity of the model and obtained parameters was tested by reliably predicting the ﬂuorescence values from an independent image not used in the optimization ( F - test p - value < 2 . 2 · 10 − 6 , 67 MAT α cells and 78 MAT a cells ) . The mean secretion rate ˆ J α obtained form the 9 signiﬁcant ﬁts was used here ( 101 . 589 · 10 − 15 nmol · µm − 1 s − 1 ) . It is noteworthy that the presented methodology does not require a special functional form of the calibration ( or response curve ) . Even though many cellular signaling systems show a Hill curve in their input - output relation , this is not a requirement . As long as the input - output relation is strictly monotonous all our methods can still be used with the only diﬀerence that the ﬁt to a Hill curve may be substituted by some non - parametric curve such as a normal or smoothed spline or a sliding mean approach . This “black box” treatment of input - output relation allows to apply the methodology to systems in which the actual mechanisms of intracellular signaling are still unclear . Analysis of α - factor distributions In order to analyze key properties of the inﬂuence of Bar1 we analyzed the α - factor distribution independent of the exact culture composition and under varying population densities . We calculated the α - factor distribution for diﬀerent randomly generated cell populations in an area of 150 µm × 150 µm . The populations were composed of half MAT a and MAT α cells and cells where assumed to have a circular shape with radii sampled from the normal distribution extracted from a statistic of 730 individual cells . Since we needed particularly the radii in the xy - plane , those were taken from the zero samples of the calibration curves ( µ = 1 . 98 µm , σ r = 0 . 25 µm ) . This was done for populations sizes of 2 up to 700 cells , roughly corresponding to a range of 20 up to 10 , 000 cells per mm 2 . For each population density we calculated 16 repetitions with random cell conﬁgurations . In a ﬁrst step we calculated the maximum information content of the observed α - factor distribution . The rationale here is that the cells try to obtain information about their environment and , therefore , it is interesting to quantify the maximum amount of information the cells can perceive . The maximum information any distribution can carry is given by the entropy of this distribution . We started by taking the overall α - factor distribution from all pixels of the simulated image ( N = 512 × 512 points ) . The observed α - factor concentrations were subdivided into N bins bins and the number of bins chosen applying Sturges’ law N bins = (cid:100) log 2 N + 1 (cid:101) . ( 32 ) This was used to obtain a discrete distribution from which the bin probabilities p i ( i = 1 , . . . , N bins ) were approximated using a shrinkage estimator [ 9 ] . The entropy H , and thus the maximum information content I max , was ﬁnally computed as I max = H = − N bins (cid:88) i = 1 p i ln p i . ( 33 ) For each population density the entropy was averaged over the 16 replicates . In a second step we calculated how well the direction of the α - factor signal could be perceived by the individual MAT a cells in the given setting . We calculated the relative diﬀerence of the points at the cell surface exposed to the maximum α - factor concentration ( the front ) and the points exposed to the minimum α - factor concentration ( the back ) . Thus , the relative front / back diﬀerence d i for the MAT a cell i is given by d i = max x ∈ Γ ai α ( x , t ) − min x ∈ Γ ai α ( x , t ) min x ∈ Γ a i α ( x , t ) ( 34 ) The relative diﬀerences were ﬁnally averaged over all MAT a cells and over all 16 replicates for a given population density . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 8 Supporting Text S1 Finally , we also tracked the average α - factor concentration over all replicates in each population density in order to see how much the overall α - factor concentration changes with varying population densities considering that MAT a cells only respond to a small range of α - factor concentrations [ 6 , 7 ] . We performed experiments with a population with equally mixed MAT a wt and MAT α for and for six diﬀerent initial numbers of cells ( compare Table S2 ) . The cells were sedimented in a circular dish with a diameter of 3 . 6 cm in a solution of 2 ml . Assuming that the cells are placed on quadratic lattices on the ground of the dish we can caluclate the average distance between the cells . For this calcluation we also take the cell diameter into account , which is assumed to be 5 µm . Numerical methods The stationary model equations ( 16 ) - ( 17 ) as well as the dynamic model equations ( 13 ) - ( 14 ) were numerically solved by a discontinuous Galerkin ﬁnite element method ( dG - FEM ) . This method can be used to approximate solutions of various types of partial diﬀerential equations . A general overview can be found in [ 10 , 11 ] . As in classical ﬁnite element methods ( FEM ) the computational domain is divided into small grid elements , usually triangles ( 2D ) or tetrahedra ( 3D ) . The grids can be unstructured , i . e . the grid elements can vary in their form , which allows the representation of complex geometries of computational domains . In the dg - FEM discretization this is done by discontinuous functions , which are piecewise linear or polynomials of higher order . The non - symmetric interior penalty Galerkin ( NIPG ) method is used here [ 12 , 13 ] . Since dG - FEM methods are locally mass conservative , they are especially suitable for diﬀusion problems [ 11 ] . For the time discretization of equations ( 13 ) - ( 14 ) we applied a diagonally implicit Runge - Kutta method of order three . The spatial and temporal discretization yields a convergence rate of O ( h p ) + O ( τ 3 ) in the (cid:96) ∞ ( L 2 ) - as well as in the (cid:96) 2 ( H 1 ) - norm , where τ is the length of the longest time step , h is the mesh size and p is the polynomial degree . Implementation In our implementation we used the Distributed and Uniﬁed Numerics Environment ( DUNE ) [ 14 ] . In particular , we used the PDELab environment , where several FEM methods and the dG - FEM discretization are implemented . We applied the grid implementation UGGrid [ 15 ] to create meshes based on Gmsh [ 4 ] ﬁles . To solve the resulting linear equation systems we used SuperLU [ 16 ] . References [ 1 ] Gordon A , Colman - Lerner A , Chin TE , Benjamin KR , Yu RC , et al . ( 2007 ) Single - cell quantiﬁcation of molecules and rates using open - source microscope - based cytometry . Nat Methods 4 : 175 – 181 . [ 2 ] Chernomoretz A , Bush A , Yu R , Gordon A , Colman - Lerner A ( 2008 ) Using Cell - ID 1 . 4 with R for microscope - based cytometry . Curr Protoc Mol Biol Chapter 14 : Unit 14 . 18 . [ 3 ] R Development Core Team ( 2012 ) R : A Language and Environment for Statistical Computing . R Foundation for Statistical Computing , Vienna , Austria . URL http : / / www . r - project . org . ISBN 3 - 900051 - 07 - 0 . [ 4 ] Geuzaine C , Remacle JF ( 2008 ) Gmsh : a three - dimensional ﬁnite element mesh generator with built - in pre - and post - processing facilities . International Journal for Numerical Methods in Engineering . [ 5 ] Fischer H , Polikarpov I , Craievich A ( 2004 ) Average protein density is a molecular - weight - dependent func - tion . Protein Science 13 : 2825 – 2828 . [ 6 ] Yu RC , Pesce CG , Colman - Lerner A , Lok L , Pincus D , et al . ( 2008 ) Negative feedback that improves information transmission in yeast signalling . Nature 456 : 755 – 761 . [ 7 ] Malleshaiah M , Shahrezaei V , Swain P , Michnick S ( 2010 ) The scaﬀold protein Ste5 directly controls a switch - like mating decision in yeast . Nature 465 : 101 – 105 . [ 8 ] Manney TR ( 1983 ) Expression of the BAR1 gene in Saccharomyces cerevisiae : induction by the alpha mating pheromone of an activity associated with a secreted protein . J Bacteriol 155 : 291 – 301 . [ 9 ] Hausser J , Strimmer K ( 2008 ) Entropy inference and the James - Stein estimator , with application to non - linear gene association networks . Journal of Machine Learning Research 10 : : 1469 – 1484 . [ 10 ] Arnold D , Brezzi F , Cockburn B , Marini L ( 2002 ) Uniﬁed analysis of discontinuous Galerkin methods for elliptic problems . SIAM journal on numerical analysis : 1749 – 1779 . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 9 Supporting Text S1 [ 11 ] Rivi ` ere B ( 2008 ) Discontinuous Galerkin Methods for Solving Elliptic an Parabolic Equations - Theory and Implementation . SIAM , Frontiers in Applied Mathematics . [ 12 ] Doleˇsji V , Feistauer M , Kuˇcera V , Sobot´ıkov´a V ( 2008 ) An optimal L ∞ ( L 2 ) - error estimate of the discon - tinuous Galerkin method for a nonlinear nonstationary convection - diﬀusion problems . IMA J Numer Anal 3 : 496 – 521 . [ 13 ] B´eatrice Rivi ` ere MFW , Girault V ( 1999 ) . Improved Energy Estimates for Interior Penalty , Constrained and Discontinuous Galerkin Methods for Elliptical Problems . [ 14 ] Bastian P , Blatt M , Dedner A , Engwer C , Kl¨ofkorn R , et al . ( 2008 ) A Generic Grid Interface for Parallel and Adaptive Scientiﬁc Computing . Part I : Abstract Framework . Computing 82 : 103 – 119 . [ 15 ] Bastian P , Birken K , Johannsen K , Lang S , Neuß N , et al . ( 1997 ) UG – a ﬂexible software toolbox for solving partial diﬀerential equations . Computing and Visualization in Science 1 : 27 – 40 . [ 16 ] Li X ( 2005 ) An overview of SuperLU : Algorithms , implementation , and user interface . ACM Transactions on Mathematical Software ( TOMS ) 31 : 302 – 325 . [ 17 ] Rappaport N , Barkai N ( 2012 ) Disentangling signaling gradients generated by equivalent sources . J Biol Phys 38 : 267 – 78 . [ 18 ] Rogers DW , McConnell E , Greig D ( 2012 ) Molecular quantiﬁcation of Saccharomyces cerevisiae alpha - pheromone secretion . FEMS Yeast Res 12 : 668 – 74 . [ 19 ] Jin M , Errede B , Behar M , Mather W , Nayak S , et al . ( 2011 ) Yeast dynamically modify their environment to achieve better mating eﬃciency . Sci Signal 4 : ra54 . [ 20 ] Andrews SS , Addy NJ , Brent R , Arkin AP ( 2010 ) Detailed Simulations of Cell Biology with Smoldyn 2 . 1 . PLoS Computational Biology 6 . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp 10 Supporting Text S1 Figures S1 to S8 brightﬁeld + tracking GFP mCherry merge A B Figure S1 . Raw confocal images and merging . Confocal images as taken from the microscope and merged in Figure 1 and 3 of the main text . Individual channels were obtained as described in this Supplementary Text . Individual cells were identiﬁed directly from brightﬁeld images . The GFP channel was used for Fus1 - GFP or Rpl9A - GFP ﬂuorescence and the red channel for mCherry ﬂuorescence under the TDH3 promoter . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 A B Figure S2 . Examples of automatically generated meshes . Meshes as automatically generated from CellID output . Depending on the parameters one can extract meshes with varying coarseness . MAT a MAT MAT a MAT MAT a MAT MAT a MAT Figure S3 . Schematic representation of the composition of the computational domain Ω . The interior of the cells is excluded from Ω . The boundaries are denoted by Γ α i , Γ a i and Γ sur . Green triangles and red dots indicate Bar1 and α - factor , respectively . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 average at cell MAT a surface image predicted A B Figure S4 . The Fus1 - GFP calibration curve and predicted GFP levels . ( A ) The calibration used to associate the Fus1 - GFP ﬂuorescence with local α - factor concentrations . The green band shows the distribution of the measured ﬂuorescence values . The color intensity indicates the conﬁdence , thus the probability to observe a Fus1 - GFP ﬂuorescence within the region of the band with a distinct intensity ( 2965 MAT a cells in total ) . The black rugs on the upper axis indicate the concentrations at which measurements have been taken . One can observe that the relation between local α - factor concentration and Fus1 - GFP ﬂuorescence is suﬃciently unique for small α - factor concentrations ( below 100 nM ) . Relevant α - factor concentrations observed in the experiments with wild type mating mixes never exceeded 20 nM ( dashed line ) . ( B ) The observed and predicted average α - factor concentrations on the surface of the MAT a cells in the veriﬁcation image . The prediction seems to reduce the variance observed in the measurements . The ﬁt was signiﬁcant under a one - parameter F - test ( p < 2 . 2 e − 6 ) . −8 −7 −6 −5 −4 −3 0 500 1000 1500 2000 log 10 ( α −factor ) [ M ] F l uo r e sc en c e [ f . u . ] k0 = 0 . 2402 k1 = 0 . 5992 delay = 29 . 71 min F−test p = 0 . 001859 1 / s 1 / s A B Figure S5 . Fit of the extracellular Bar1 activity . ( A ) Comparison of the Fus1 - GFP expression to the Bar1pr - qVenus expression measured by ﬂuorescence . Error bars denote standard deviation ( 643 cells in total for Fus1 - GFP and 578 cells for Bar1pr - qVenus ) . ( B ) Results of approximating the Bar1 activity kinetics . The green triangles indicate the mean values of the measured ﬂuorescences ( 2 . 458 MATa cells in total ) . Parameters were obtained by maximizing the log - likelihood under the data by using the entire distributions of ﬂuorescence values at each measured concentration of added α - factor . The Bar1 activities are normalized by the cell number per volume . Experiments in ( A ) and ( B ) used diﬀerent GFP acquisition parameters . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 A B C D Figure S6 . Additional experimental and computational data . ( A ) Volumes of the cells in diﬀerent conditions . Cells in the MAT a bar 1∆ / MAT α mating mix background show higher average volumes , which increase with time , whereas wild type cultures increase their volume to that of the size of diploids and maintain this over time ( n = 6 ) . ( B ) Growth curves for mating cultures and haploids alone ( control ) . The higher growth rate of the wild type compared to the mating bar 1∆ culture is also observed here ( two biological replicates ) . However , one can also observe that OD is a poor approximation for the number of cells in the population since the increase in OD of the bar 1∆ culture is entirely due to the larger cell volumes ( OD and individual cell volumes increase about 4 - fold ) . ( C ) Average α - factor concentration on the simulated in vitro cell populations in the wild type background . ( D ) Average α - factor concentration in the simulated populations in the bar 1∆ background . The dashed lines indicate 10 nM , which was the minimum concentration in the calibration curve were shmoo formation was observed . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 A B α - f a c t o r [ m o l e cs / μ m 2 ] B a r 1 - a c t i v i t y α - f a c t o r [ m o l e cs / μ m 2 ] d ~ 2μm 20 . 10 3 cells / mm 2 d ~ 3μm 15 . 10 3 cells / mm 2 d ~ 5μm 10 . 10 3 cells / mm 2 d ~ 9μm 5 . 10 3 cells / mm 2 d ~ 17μm 2 . 10 3 cells / mm 2 d ~ 26μm 1 . 10 3 cells / mm 2 high population density low population density d ~ 5μm 10 . 10 3 cells / mm 2 ( same arrangement of cells as above ) spatial α - factor distribution inhomogeneity of Bar1 activity Figure S7 . Density dependence of α - factor level and gradient formation . ( A ) Computational experiments have been performed with random cell arrangements for mixed populations ( 50 % MAT α , 50 % MAT a ) . The densities of these populations correspond to the experiments shown in Figure 5 . ( B ) The simulation from above [ top row , on the right ] for a density of 10 · 10 6 cells / ml is plotted again using another color scale to make α - factor gradients visible [ left ] . For the same arrangement the inhomogeneous Bar1 activity is depicted [ right ] . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 wt 24h bar1 5h A B Figure S8 . Phenotypes arising from long incubation . ( A ) Wild type MAT a Fus1 - GFP cells were mixed with high fractions of MAT α mCherry and incubated overnight while rapidly shaken in order to prevent conjugation . ( B ) MAT a Fus1 - GFP bar 1∆ cells together with MAT α mCherry incubated without shaking , thus with α - factor gradients ( also compare Figure 7 in the main text ) . The behavior already starts after 5h were the entire culture is in arrest . Comparing both images evidences that shaking of the wild type cultures , and thus disrupting the α - factor distribution , has a similar eﬀect as a deletion of Bar1 and results in elongated cells with high Fus1 - GFP expression . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp Supporting Text S1 Tables S1 and S2 Quantity Our Others Secretion of α - factor 865 molecs 10 molecs [ 17 ] ; 550 − 1300 molecs [ 18 ] ; 3000 molecs [ 19 ] ; per cell 1230 − 4000 molecs [ 20 ] Diﬀusion coeﬃcient 361 µm 2 s 300 µm 2 s [ 17 ] ; 125 µm 2 s [ 19 ] ; 132 µm 2 s [ 20 ] for α - factor Diﬀusion coeﬃcient 104 µm 2 s 30 µm 2 s [ 17 ] ; 6 . 25 µm 2 s [ 19 ] ; 27 µm 2 s [ 20 ] for Bar1 Bar1 induction by yes , ﬁtted Hill - curve no [ 17 ] , [ 20 ] , [ 19 ] α - factor stimulation Bar1 localization free diﬀusion in the media free diﬀusion in the media [ 19 ] , [ 20 ] ; cell - wall - bound [ 17 ] Bar1 activity 0 . 24 s − 1 − 0 . 84 s − 1 1 / 60 s − 1 [ 17 ] Endocytosis of α - factor no no [ 19 ] ; buﬀered [ 20 ] ; by MAT a cells MAT a cells are perfect absorbers [ 17 ] Table S1 . A comparison of parameters and assumptions in recent works . References correspond to reference list in Supplementary Text S1 . number of cells cell density OD 600 average distance cells per area 1 · 10 6 0 . 5 · 10 6 cells / ml 0 . 017 26 . 6 µm 1 · 10 3 cells / mm 2 2 · 10 6 1 · 10 6 cells / ml 0 . 033 17 . 4 µm 2 · 10 3 cells / mm 2 5 · 10 6 2 . 5 · 10 6 cells / ml 0 . 083 9 . 1 µm 5 · 10 3 cells / mm 2 10 · 10 6 5 · 10 6 cells / ml 0 . 16 5 . 0 µm 10 · 10 3 cells / mm 2 15 · 10 6 7 . 5 · 10 6 cells / ml 0 . 25 2 . 7 µm 15 · 10 3 cells / mm 2 20 · 10 6 10 · 10 6 cells / ml 0 . 33 2 . 1 µm 20 · 10 3 cells / mm 2 Table S2 . Initial cell numbers as used in the density experiments ( Figure 5 and Supplementary Figure S7 ) and average distances between cells . C . Diener , G . Schreiber , W . Giese , G . Del Rio , W . Schr¨oder , E . Klipp
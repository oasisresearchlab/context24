Accurate Tight - Binding Hamiltonians for 2D and Layered Materials Luis A . Agapito , 1 , 2 Marco Fornari , 3 , 4 Davide Ceresoli , 5 Andrea Ferretti , 6 Stefano Curtarolo , 4 , 7 and Marco Buongiorno Nardelli 2 , 4 , ∗ 1 Department of Mechanical Engineering and Materials Science , Duke University , Durham , NC 27708 , USA 2 Department of Physics , University of North Texas , Denton , TX 76203 , USA 3 Department of Physics , Central Michigan University , Mt . Pleasant , MI 48859 4 Center for Materials Genomics , Duke University , Durham , NC 27708 , USA 5 CNR - ISTM , Istituto di Scienze e Tecnologie Molecolari . I - 20133 Milano , Italy 6 CNR - NANO S3 Center , Istituto Nanoscienze , I - 41125 Modena , Italy 7 Materials Science , Electrical Engineering , Physics and Chemistry , Duke University , Durham , NC 27708 , USA ( Dated : January 13 , 2016 ) We present a scheme to controllably improve the accuracy of tight - binding Hamiltonian matrices derived by projecting the solutions of plane - wave ab initio calculations on atomic orbital basis sets . By systematically increasing the completeness of the basis set of atomic orbitals , we are able to optimize the quality of the band structure interpolation over wide energy ranges including unoccupied states . This methodology is applied to the case of interlayer and image states , which appear several eV above the Fermi level in materials with large interstitial regions or surfaces such as graphite and graphene . Due to their spatial localization in the empty regions inside or outside of the system , these states have been inaccessible to traditional tight - binding models and even to ab initio calculations with atom - centered basis functions . I . INTRODUCTION The generation of highly accurate tight - binding mod - els for arbitrary systems is a long - lasting problem that has enormous implications in the development of eﬃcient tools for the study of the electronic structure of molecules and solids 1 , 2 , and for applications in accelerated materials development . 3 With the introduction of ab initio tight - binding Hamiltonians the accuracy of these methods has seen a substantial improvement . However , the best rep - resentations still rely on ad hoc basis sets that need to be iteratively optimized 4 – 6 and are computationally ex - pensive . In recent papers , we have introduced an eﬃ - cient scheme to construct optimal tight - binding Hamil - tonians projecting the Bloch states obtained from plane - wave ( PW ) Density Functional Theory calculations onto atomic orbitals derived directly from the generation of the atomic pseudopotentials . 7 – 9 In this scheme , the energy range in which the TB Hamiltonian reproduces the origi - nal states is limited by the ﬁnite number of pseudo atomic orbitals ( PAO ) that comprise the minimal basis set . As such , only a few unoccupied bands are typically well rep - resented and an accurate description of the conduction states is impossible beyond a few eV . If more conduction states are needed , the basis set needs to be systematically extended . In this work , we propose a procedure that extends the validity of the TB representation of the band structure to electronic states far above the Fermi level . This novel ap - proach is based on the Projector Augmented Wave ( PAW ) formalism and involves several atomic orbital ( AO ) for each angular momentum that are directly computed from the all electron atomic potential . The paper is organized as follow : in section II . A we introduce the PAW formalism ; since the PAW method requires smoother AO functions , i . e . the PAOs , the pseudization process is presented in Section II . B ; in Sec . II . C we brieﬂy summarize the projection , ﬁltering and shifting procedure to generate accurate Hamiltonian ma - trices as originally discussed in Ref . 7 and 8 ; in Sec . II . D we discuss the convergence properties of the unoccu - pied Kohn - Sham states and their dependence on the basis set representation ; ﬁnally , in Section III we present two examples where we demonstrate the eﬀectiveness of our enhanced scheme by reproducing the interlayer states of graphite and the image states of graphene in a wide energy range . II . METHODOLOGY A . The PAW method Density - functional theory ( DFT ) in combination with the plane - wave pseudopotential ( PP ) formalism is one of the most common method to derive the electronic struc - ture of molecules and solids . Pseudopotentials are con - structed to remove core electrons from the Hamiltonian and to reduce drastically the number of plane waves that would be otherwise needed to represent the diver - gent Coulomb potential close to the nucleus . In addition , pseudo - wavefunctions are smooth in the region close to the nuclei because they don’t need to be orthogonalized to the core orbitals . The drawback of the PP method is that all the details on the wavefunctions within a speciﬁc distance from the nucleus ( the atomic sphere ) are lost . This is im - portant when it comes to calculate , for instance , magnetic resonance parameters or core emission spectroscopies . 10 – 12 In that regard , the PAW method 13 allows to reconstruct the full nodal structure of the wavefunctions near the ions . The basic idea is to “augment” the pseudo wavefunctions with a set of pseudo partial waves | ˜ ϕ n α (cid:105) , which are local - a r X i v : 160 1 . 02657v1 [ c ond - m a t . m t r l - s c i ] 11 J a n 2016 2 ized functions centered at position R α for each atom α ( n is a composite index for the quantum numbers n , l , m ) . This augmentation procedure is achieved through the ap - plication of the ˆ T operator to the pseudo wavefunctions , | ˜ ψ i (cid:105) , in order to obtain the all - electron wavefunctions , | ψ i (cid:105) = ˆ T | ˜ ψ i (cid:105) . Such an operator is deﬁned as ˆ T = ˆ1 + (cid:88) α ˆ T α , ˆ T α = (cid:88) n ( | ϕ nα (cid:105) − | ˜ ϕ nα (cid:105) ) (cid:104) ˜ p nα | ( 1 ) where | ϕ nα (cid:105) are the all - electron partial waves and | ˜ ϕ nα (cid:105) are the corresponding pseudo partial waves . The PAW method is grounded on the assumption of completeness of the basis of partial waves in Eq . 1 : the wavefunction can be expanded in terms of partial waves inside the augmenta - tion sphere . In practice , in order to enforce a high degree of completeness one has to include more than one par - tial wave per angular momentum ( typically two or three ) , where the ﬁrst corresponds to the bound energy state and the others to unbound states of positive energy . The pro - jectors | ˜ p nα (cid:105) are local functions centered at R α and vanish - ing beyond a certain cutoﬀ radius r cα ; they are determined such that : ∀ α (cid:104) ˜ p nα | ˜ ϕ n (cid:48) α (cid:105) = δ n , n (cid:48) for | r − R α | < r cα ( 2 ) The inclusion of multiple partial waves enables the high transferability and accuracy of the PAW potentials , which are deﬁned by a given set of partial waves , projectors and cutoﬀ radii . Libraries of PAW datasets for almost all el - ements in the periodic table are available : PSlibrary 14 , GBRV 15 , JTH 16 , GPAW 17 , VASP 18 , ATOMPAW 19 , , and GIPAW , used in the calculation of NMR shifts 20 . B . Generation of the PAO basis sets For given energies (cid:15) n , the all - electron atomic - orbital functions | φ nα (cid:105) are obtained by solving the Schr¨odinger equation : (cid:20) − 1 2 ∇ 2 + V AE α (cid:21) | φ nα (cid:105) = (cid:15) n | φ nα (cid:105) ( 3 ) where V AE α is the screened all - electron potential found by self - consistently solving the isolated atom at a refer - ence electronic conﬁguration . The corresponding smooth atomic - orbitals | ˜ φ n (cid:105) ( dropping the atom index α for sim - plicity ) are obtained by solving the implicit equation : | φ n (cid:105) = ˆ T | ˜ φ n (cid:105) , that is : ˜ φ n ( r ) = φ n ( r ) − (cid:88) m [ ϕ m ( r ) − ˜ ϕ m ( r ) ] C m , n ( 4 ) where C m , n = (cid:104) ˜ p m | ˜ φ n (cid:105) = (cid:82) r c 0 ˜ p m ( r ) ∗ ˜ φ n ( r ) r 2 dr . Notice that we have include only the radial component of the functions , i . e . without the the angular part , given by the spherical harmonics Y lm . Eq . ( 4 ) has the form of a Fredholm equation of the sec - ond kind 21 which can be reduced to a matrix equation deﬁning C = ( I + A ) − 1 B where I , A and B are iden - tity , square and rectangular matrices , respectively , with elements A k , h = (cid:82) r c 0 ˜ p k ( r ) ∗ ( ϕ h ( r ) − ˜ ϕ h ( r ) ) r 2 dr , B k , m = (cid:82) r c 0 ˜ p k ( r ) ∗ φ m ( r ) r 2 dr . The indexes k and h runs over the set of projectors and partial waves that deﬁne the PAW dataset , respectively , while the indexes n , m run over the full set of radial wavefunctions from Eq . ( 3 ) . We have applied the procedure discussed above to de - rive sets of smooth AOs , i . e the PAOs ˜ φ i . In a strict sense , while the PAOs are the auxiliary functions involved in the PAW method , the AOs φ i are the functions that consti - tute the basis set for the tight binding models . Fig . 1 shows a comparison of the radial parts of the all - electron vs . the pseudo atomic orbitals of carbon ( the s and s (cid:48) func - tions of PAO 3 given in Table I ) using the PAW potential C . pbe - n - kjpaw psl . 1 . 0 . 0 . UPF from Ref . 14 . The PAO functions are smoother that the all - electron functions in - side the cutoﬀ radius of 1 . 4 a B , while , by construction , both are identical outside the cutoﬀ radius . 10 − 3 10 − 2 10 − 1 10 0 10 1 r ( Bohr ) − 1 . 0 − 0 . 5 0 . 0 0 . 5 1 . 0 1 . 5 R a d i a l p a r t ( B o h r − 1 / 2 ) ( a ) φ s ( r ) ˜ φ s ( r ) 10 − 3 10 − 2 10 − 1 10 0 10 1 r ( Bohr ) − 1 . 0 − 0 . 5 0 . 0 0 . 5 1 . 0 1 . 5 ( b ) φ s 0 ( r ) ˜ φ s 0 ( r ) FIG . 1 . All - electron and pseudo - atomic functions for the { s , s (cid:48) } components of the PAO 3 set . The parameters used to compute the pseudo - atomic orbitals are deﬁned by the same PAW data set used in the DFT calculation . One point of strength of this approach is that we can construct PAO sets of increasing size and completeness . The sets can include multiple functions for each { lm } channel which correspond to diﬀerent energy parameters (cid:15) n ( see Table I ) . The ﬁrst choice for the values of (cid:15) n are the eigenenergies of the bound states ( (cid:15) n < 0 ) of the isolated atom . The orbitals form the minimal set PAO 1 which is equivalent to the single - zeta basis used in quantum chem - istry , e . g . { s , p } functions for carbon , composed of M = 4 functions . Hamann 22 showed that positive - energy ( scattering ) states can be employed to improve the accuracy of norm conserving pseudopotentials . Within our approach , we augment the minimal PAO 1 set with scattering states of energies (cid:15) n > 0 ( these energy parameters can be chosen arbitrarly ) . The PAO 2 set is of single - zeta - polarized qual - 3 TABLE I . Energy parameters ( in Ry ) that deﬁne the functions used in the construction of the PAO sets { ˜ φ n ( r ) } for carbon via Eq . 3 . set (cid:15) s (cid:15) p (cid:15) d (cid:15) s (cid:48) (cid:15) p (cid:48) (cid:15) s (cid:48)(cid:48) (cid:15) p (cid:48)(cid:48) PAO 1 - 1 . 01 - 0 . 39 – – – – – PAO 2 - 1 . 01 - 0 . 39 0 . 05 – – – – PAO 3 - 1 . 01 - 0 . 39 0 . 05 0 . 05 0 . 05 – – PAO 4 - 1 . 01 - 0 . 39 0 . 20 0 . 20 0 . 20 0 . 4 0 . 4 ity that includes polarization functions with higher an - gular momentum , l max + 1 , i . e . { s , p , d } , M = 9 . PAO 3 is of double - zeta - polarized quality , i . e . { s , s (cid:48) , p , p (cid:48) , d } , M = 13 , and PAO 4 triples the number of minimal basis functions and includes additional polarization functions , i . e . { s , s (cid:48) , s (cid:48)(cid:48) , p , p (cid:48) , p (cid:48)(cid:48) , d } , M = 17 , thus , it is of triple - zeta - polarized quality . C . Building the TB Hamiltonian matrices Accurate TB Hamiltonian matrices can be built from the direct projection of the Kohn - Sham ( KS ) Bloch states | ψ n k (cid:105) onto a chosen PAO set as discussed extensively in Ref . 7 and 8 . This procedure is satisfactory when Bloch states , that project well on the selected AO basis set , are kept and states that do not project well are eliminated , i . e . , ﬁltering . In this process the crucial quantities that quantify the accuracy of the basis are the projectabilities p n k = (cid:104) ψ n k | ˆ P | ψ n k (cid:105) ≥ 0 ( ˆ P is the operator that projects onto the space of the PAO basis set , as deﬁned in Ref . 8 ) which indicate the representability of a Bloch state | ψ n k (cid:105) on the chosen PAO set . Maximum projectability , p n k = 1 , indicates that the particular Bloch state can be perfectly represented in the chosen PAO set ; contrarily , p n k ≈ 0 in - dicates that the PAO set is insuﬃcient and should be aug - mented . Once the Bloch states with good projectabilities have been identiﬁed , the TB Hamiltonian is constructed as : H ( k ) = AEA † + κ (cid:16) I − A (cid:0) A † A (cid:1) − 1 A † (cid:17) . ( 5 ) where E is the diagonal matrix of KS eigenenergies and A is the matrix of coeﬃcients obtained from projecting the Bloch wavefunctions onto the PAO set ( See Ref . 8 . ) Since the ﬁltering procedure introduces a null space , the parameter κ is used to shift all the unphysical solutions outside a given energy range of interest . The real - space TB matrix , H ( R ) , between the central and the neighboring unit cell at lattice vector R is ob - tained via Fourier transform : H ( R ) = 1 N V (cid:88) k e − i k · R H ( k ) , ( 6 ) where N V is the number of k points in the reciprocal unit cell . Using these matrices , one can calculate the inter - polated TB band structure , for any k , using the inverse Fourier transform . D . TB representation of the unoccupied bands When a linear combination of AOs ( LCAO ) are used as basis sets in DFT based methods , the unoccupied bands tend to substantially depend upon basis set size . As an illustration of the above argument , we have computed the band structure of graphite and graphene using both ap - proaches . All PW - and LCAO - DFT calculations presented in this work were performed using the software packages quantum espresso 23 or openmx 24 using the Perdew - Burke - Ernzerhof ( PBE ) 25 exchange and correlation func - tional . The PW calculations use the PAW pseudopoten - tial C . pbe - n - kjpaw psl . 1 . 0 . 0 . UPF from the PSlibrary 14 and a kinetic energy cutoﬀ energy of 40 Ry . The LCAO - DFT calculations use norm conserving pseudopotentials and the optimized AO basis sets from the openmx pseu - dopotential database 26 , with a cutoﬀ radius for all carbon basis functions of 7 a B . The basis set used for the “empty atoms” contains two s , two p , two d , and one f function , all with a cutoﬀ of 13 a B . The ﬁrst three panels in Figs . 2 and 3 show the LCAO - DFT band structures for graphite and graphene , respec - tively , calculated using AO basis sets of increasing quality , taken from a public database 26 : single zeta ( SZ ) , dou - ble zeta with polarization ( DZP ) , and triple zeta with double polarization ( TZDP ) . Under the same approxima - tion to the exchange - correlation functional , calculations using a well converged plane wave ( PW ) basis set ( fourth panel ) reproduce the unoccupied states systematically bet - ter than the AO basis sets . Γ MK ΓA LH A − 20 − 15 − 10 − 5 0 5 10 15 E n e r g y − E F ( e V ) SZ Γ MK ΓA LH A DZP Γ MK ΓA LH A TZDP Γ MK ΓA LH A PW FIG . 2 . Band structure of graphite using atomic - orbital ( at the single - zeta , double - zeta polarized , and triple - zeta doubly - polarized level ) and well converged plane - wave basis sets . Not surprisingly , a minimal basis set such as SZ fails to reproduce not only the unoccupied but also the occupied bands of graphite and graphene . The SZ calculation com - pletely misses the lowest conduction band at Γ , as seen in the ﬁrst panel in Figs . 2 and 3 . DZP basis sets are gen - erally considered satisfactory to reproduce ground - state properties , reaching close to chemical accuracy . 27 Indeed , we ﬁnd that all occupied states are well converged at the DZP level ; however , it oﬀers little improvement to the un - 4 occupied bands . Only when the much larger TZDP set is used , the unoccupied bands start to qualitatively match the fully converged PW results . Despite the deﬁciencies of standard implementation of DFT , single particle KS eigenstates ( occupied and un - occupied ) are often needed , for instance , as the starting point for more reﬁned calculation of the excited states ( time - dependent DFT , 28 density - functional perturbation theory , 29 many - body perturbation theory GW , 30 coupled - cluster theory , 31 etc . ) , thus TB Hamiltonians that are ex - pressed in small AO basis sets but that can still deliver the accuracy of the converged PW DFT results , especially for the unoccupied states , are a valuable tool for the study of novel materials and further development of theoretical methods . K Γ M K − 20 − 15 − 10 − 5 0 5 10 15 E n e r g y − E F ( e V ) SZ K Γ M K TZDP K Γ M K DZP - EA K Γ M K PW FIG . 3 . Band structure of graphene using atomic - orbital ( at the single - zeta , double - zeta polarized , and triple - zeta doubly - polarized level ) and well converged plane - wave basis sets . The ﬁrst three panels use atomic - orbital - like sets : SZ , TZDP , and DZP with empty atoms from Ref . 26 . III . APPLICATIONS For most crystalline materials , minimal PAO sets ( of SZ or SZP quality ) are suﬃcient for constructing TB Hamil - tonians that are describing accurately the band structre up to ∼ 2 eV above the Fermi energy . 7 , 8 However , materi - als containing extended interstitial regions tend to exhibit “interlayer states” usually located several electron - volts above the Fermi energy . Similarly , the description of “im - age states” in metallic surfaces also requires a larger en - ergy range in the unoccupied bands . Here , we discuss two prototypical cases , graphite and graphene , to demonstrate the eﬀectiveness of our augmented PAO basis sets and TB scheme for the treatment of interlayer and image states , which have been out of reach of traditional parameterized TB models so far . Γ MK ΓA LH A − 20 − 15 − 10 − 5 0 5 10 15 E n e r g y − E F ( e V ) PAO 1 Γ MK ΓA LH A PAO 2 Γ MK ΓA LH A PAO 3 Γ MK ΓA LH A TB FIG . 4 . ( Color online ) Projectability p n k , in color scale , of Bloch states ψ n k of graphite on the PAO 1 , PAO 2 , and PAO 3 sets . The fourth panel shows the interpolated band structure in green obtained from the TB Hamiltonians built on the PAO 3 , superimposed to the plane - wave band structure . The color bar is shown in Fig . 6 . A . Graphite The ﬁrst step toward quantifying the quality of LCAO basis set involves a detailed analysis of the projectabilities . As mentioned before we construct PAO sets of increasing “completeness” and derived an appropriate TB model in - tended to interpolate the fully converged PW band struc - ture . In Fig . 4 we discriminate between bands with mod - erate to high projectabilities ( plotted in red ) from bands with lower projectabilities ( plotted in blue . ) See color scale in Fig . 6 . The ﬁrst panel shows the projectabili - ties on the PAO 1 set . There are two discernible groups of bands : the states with predominant { s , p } character ( in red ) and the parabolic bands near Γ ( in blue ) . Expect - edly , the high projectabilitis bands qualitatively resem - ble the LCAO - DFT calculation with SZ basis in Fig . 2 . Conversely , the low projectability bands ( in blue ) , which can not be well represented on the minimal { s , p } basis , are absent in Fig . 2 ( SZ . ) Interestingly , those bands cor - respond to the so - called interlayer states of graphite 32 – 34 , which are strongly - dispersed unoccupied states located in - between the graphitic planes ( see Fig . 3c in Ref . 34 . ) Interlayer states are characteristic of materials with in - terstitial hollow regions , 35 , 36 layered structures , 37 and / or reduced dimensionality such as carbon nanotubes , 38 , 39 C 60 , 40 etc . Naturally , atom - centered basis functions are inappropriate to describe states that extend to the in - terstitial and / or vacuum regions , whereas PW basis are particularly well suited for this . 41 This is reﬂected in the pronounced discrepancy between unoccupied eigenener - gies calculated using PW and AO basis sets . 35 , 36 The in - terlayer states of graphite are not captured with commonly used AO basis sets 42 , 43 such as DZP , as seen in Fig . 2 . Our PAW - based procedure allows a systematic exten - sion of the PAO sets ( see Table I ) to distill TB Hamiltoni - ans that capture the details of the band structure includ - 5 ing “interlayer states” . The performance of each PAO set is assessed by determining its energy range of good pro - jectability for a particular material , which in turn leads to a TB model that is highly accurate within the same energy range . The performance of the four PAO sets in Table I in terms of projectabilities are shown in Fig . 5 . We choose the threshold of p n k ≥ 0 . 95 to determine the target en - ergy range of accuracy . The performance of the PAO 1 set ( blue line ) sharply declines above 3 . 3 eV due to the presence of parabolic bands that do not project well on the small LCAO basis . The TB model using this set is accurate only up to 3 . 3 eV . The larger spatial range of the { s (cid:48) , p (cid:48) } functions added in PAO 2 facilitates the rep - resentation of the interlayer states closer to the graphitic planes , yielding a noticeable increase in the projectabili - ties with respect to PAO 1 over the entire energy range . This is also observed in the second panel in Fig . 4 where most of the blue bands switched to red ; the interlayer states with wave - vector component perpendicular to the graphitic planes , those in the Γ – A direction , are still of low projectability . The wavefunction of perpendicular Bloch states are primarily localized at the center of the intersti - tial space , the farthest from the planes , and the { s (cid:48) , p (cid:48) } functions are still insuﬃcient to fully capture them ; this is reﬂected by the oscillations of the green line in the 3 . 3 – 7 eV range in Fig . 5 . When we augment the basis set with d functions ( PAO 3 ) the range of high projectability increases up to 7 . 2 eV above the Fermi level . PAO 4 ( light blue line ) further extends that range up to 10 . 8 eV . From the above results it is clear that the upper bound of the energy range of high - projectability , and consequently the range of accu - racy of the TB matrices , can be systematically increased in this way . − 20 − 15 − 10 − 5 0 5 10 15 Energy − E F ( eV ) 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 M i n i m u m p r o j ec t a b ili t y PAO 1 PAO 2 PAO 3 PAO 4 FIG . 5 . ( Color online ) Projectability of the Bloch states ψ n k of graphite onto the four PAO sets deﬁned in Table I . The plot shows the minimum value of projectability for each bin of a discretized energy grid . The dotted line indicates the pro - jectability threshold of 0 . 95 . All k points in the reciprocal unit cell are included in the calculation . The interpolated TB band structure constructed using the PAO 3 set is shown in green in Fig . 4 . An excellent agreement with the PW - DFT bands up to 7 . 2 eV above the Fermi level is observed , as expected from the energy range of high projectabilities deduced from Fig . 5 . B . Graphene K Γ M K − 20 − 15 − 10 − 5 0 5 10 15 E n e r g y − E F ( e V ) PAO 1 K Γ M K PAO 3 K Γ M K TB 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8 0 . 9 1 . 0 FIG . 6 . ( Color online ) Projectabilities of the Bloch states of graphene on the PAO 1 and PAO 3 sets . The interpolated TB band structure , computed using the PAO 3 basis set , is shown in green on the third panel superimposed to the PW bands . The high energy electronic bands of graphene are characterized by the presence of image states . Im - age states give rise to superconductivity in metal - doped graphite . 34 , 44 Similarly , they play a critical role in sev - eral phenomena such as the functionalization of graphene , the adsorption of oxygenated moieties and hydrogen , the formation of defects , 45 , 46 and the ‘ﬁnger - print’ peaks in the X - ray absorption spectra found in the same energy region . 47 – 52 Image states have also been shown to medi - ate electron tunneling in graphene . 53 The importance of TB models that reproduce well “interlayer” and “image states” cannot be underestimated especially when design - ing devices and interpreting experiments . Image states in graphene follow 54 double Rydberg se - ries n ± and , expectedly , have low projectability on PAO 1 ( blue lines in the ﬁrst panel of Fig . 6 ) . The two lowest unoccupied bands , parabolic at Γ , are the ﬁrst states of the series , denoted as 1 + and 1 − . The third lowest un - occupied band corresponds to the state 2 + . Increasing the projectability of the image - state bands by augmenting the basis set is diﬃcult for the particular case of graphene . The projectabilities improve with higher PAO sets , but fail to reach the threshold of 0 . 95 . As seen in the second panel , bands 1 + and 1 − can reach moderately high projectability ( ∼ 0 . 8 at Γ ) with PAO 3 , in sharp contrast , however , band 2 + ( light blue ) still exhibits low projectability . This be - havior is due to the spatial distribution of the image states . Indeed , the wavefunctions of 1 + and 1 − around Γ have a component that is localized in the graphene plane form - ing σ and π hybridizations , respectively ( see also Fig . 3b in Ref . 54 ) . This component can be partially accounted for with the inclusion of { s (cid:48) , p (cid:48) } ( and to a lesser extent , d ) functions in PAO 3 , leading to the observed increase of pro - jectabilities in the second panel with respect to the ﬁrst in Fig . 6 . The other component of the wavefunctions 1 + and 1 − is more localized in the vacuum region 54 and , thus , is 6 not captured by the s (cid:48) and p (cid:48) functions . Band 1 − loses its dispersion and becomes ﬂat around K , where a marked reduction in projectability in also seen ( blue segment at ∼ 10 . 6 eV in the second panel . ) This happens because around K the wavefunction of 1 − loses its in - plane π - like component and consequently can no longer be expanded with the { s (cid:48) , p (cid:48) } functions ( see also the charge density plot in Fig . 3a in Ref . 55 ) . On the other hand , the wavefunction 2 + is fully localized in the vacuum region with the position of the maximum electron density away from the graphene plane 54 . Contrary to 1 ± , it has no in - plane component at Γ and , thus , cannot be represented just by adding ba - sis functions that are centered in the plane ; therefore , 2 + exhibits low projectability on the PAO 3 set . This is corroborated by examining the LCAO - DFT bands , shown in the ﬁrst three panels in Fig . 3 . Even with the large TZDP basis set ( second panel ) , the band struc - ture completely misses the parabolic image state bands obtained when using the PW basis . The image states are reached only after extending the DZP with empty - atom ( EA ) basis functions centered at 2 . 8 ˚A above and below the graphene sheet . Although the DZP - EA set is too ex - pensive for practical calculations , it is observed that the bands ( third panel ) reach qualitative agreement to the PW solution ( fourth panel ) . As seen in the third panel in Fig . 6 , the TB Hamiltonian generated using the PAO 3 set is able to correctly repro - duce the band structure ( in green ) up to the two lowest parabolic bands 1 + and 1 − . Our method supersedes pa - rameterized tight - binding schemes that are only suitable in the vicinity of the Dirac point . The TB band structure shown here achieves higher accuracy than even the LCAO - DFT result , and with a less expensive basis set . We expect that extending the PAO set with empty - atom functions lo - cated oﬀ plane will noticeably increase the projectabilities of the interlayer states 1 ± and 2 + above the threshold of 0 . 95 . We leave this for future investigation . IV . SUMMARY AND CONCLUSIONS We presented a scheme to extend PAO basis sets to systematically increase the level of completeness of tight - binding representations obtained from plane waves ab ini - tio calculations . While minimal PAO sets ( of SZ or SZP quality ) can be suﬃcient for generating TB Hamiltonian matrices accurate up to ∼ 2 eV above the Fermi level for most materials , we have shown that enhanced PAO basis sets , containing both negative and positive energy atomic - orbital functions , can controllably increase the energy win - dow in which the TB model is faithfully representing the details of the bands . Results for graphite and graphene , notably very diﬃcult systems to represent in a TB scheme , demonstrate the accuracy and eﬀectiveness of the method . ACKNOWLEDGMENTS We want to thank Dr . Derek Stewart for helpful dis - cussions , the Texas Advanced Computing Center ( TACC ) at the University of Texas Austin for providing comput - ing facilities , and the funding provided by the ONR - MURI under Contract No . N00014 - 13 - 1 - 0635 . The authors ac - knowledge the Duke University Center for Materials Ge - nomics and the CRAY Corporation for computational as - sistance . ∗ Email : mbn @ unt . edu 1 E . H¨uckel , Quantentheoretische Beitr¨age zum Benzolprob - lem , Zeitschriftf¨ur Physik 70 , 628 ( 1931 ) . 2 H . Jones , N . F . Mott , and H . W . B . Skinner , A Theory of the Form of the X - Ray Emission Bands of Metals , Phys . Rev . 45 , 379 – 384 ( 1934 ) . 3 S . Curtarolo , G . L . W . Hart , M . Buongiorno Nardelli , N . Mingo , S . Sanvito , and O . Levy , The high - throughput highway to computational materials design , Nature Mater . 12 , 191 – 201 ( 2013 ) . 4 O . K . Andersen and T . Saha - Dasgupta , Muﬃn - tin orbitals of arbitrary order , Phys . Rev . B 62 , R16219 – R16222 ( 2000 ) . 5 N . Marzari , A . A . Mostoﬁ , J . R . Yates , I . Souza , and D . Van - derbilt , Maximally localized Wannier functions : Theory and applications , Rev . Mod . Phys . 84 , 1419 – 1475 ( 2012 ) . 6 W . C . Lu , C . Z . Wang , T . L . Chan , K . Ruedenberg , and K . M . Ho , Representation of electronic structures in crys - tals in terms of highly localized quasiatomic minimal basis orbitals , Phys . Rev . B 70 , 041101 ( 2004 ) . 7 L . A . Agapito , A . Ferretti , A . Calzolari , S . Curtarolo , and M . Buongiorno Nardelli , Eﬀective and accurate representa - tion of extended Bloch states on ﬁnite Hilbert spaces , Phys . Rev . B 88 , 165127 ( 2013 ) . 8 L . A . Agapito , S . Ismail - Beigi , S . Curtarolo , M . Fornari , and M . Buongiorno Nardelli , Accurate tight - binding Hamil - tonian matrices from ab - initio calculations : Minimal basis sets , Phys . Rev . B 93 , 035104 ( 2016 ) . 9 L . A . Agapito , S . Curtarolo , and M . Buongiorno Nardelli , Reformulation of DFT + U as a Pseudohybrid Hubbard Den - sity Functional for Accelerated Materials Discovery , Phys . Rev . X 5 , 011006 ( 2015 ) . 10 B . Pavan , D . Ceresoli , M . M . Tecklenburg , and M . Fornari , First principles NMR study of ﬂuorapatite under pressure , Solid State Nuclear Magnetic Resonance 45 – 46 , 59 – 65 ( 2012 ) . 11 M . Taillefumier , D . Cabaret , A . - M . Flank , and F . Mauri , X - ray absorption near - edge structure calculations with the pseudopotentials : Application to the K edge in diamond and α - quartz , Phys . Rev . B 66 , 195107 ( 2002 ) . 12 A . Pasquarello , M . S . Hybertsen , and R . Car , Theory of Si 2 p core - level shifts at the Si ( 001 ) - SiO 2 interface , Phys . Rev . B 53 , 10942 – 10950 ( 1996 ) . 13 P . E . Bl¨ochl , Generalized separable potentials for electronic - structure calculations , Phys . Rev . B 41 , 5414 – 5416 ( 1990 ) . 7 14 A . Dal Corso , Pseudopotentials periodic table : From H to Pu , Comp . Mat . Sci . 95 , 337 – 350 ( 2014 ) . 15 K . F . Garrity , J . W . Bennett , K . M . Rabe , and D . Vander - bilt , Pseudopotentials for high - throughput DFT calculations , Comp . Mat . Sci . 81 , 446 – 452 ( 2014 ) . 16 F . Jollet , M . Torrent , and N . Holzwarth , Generation of Pro - jector Augmented - Wave atomic data : A 71 element vali - dated table in the XML format , Comput . Phys . Commun . 185 , 1246 – 1254 ( 2014 ) . 17 https : / / wiki . fysik . dtu . dk / gpaw / setups / setups . html . 18 G . Kresse and D . Joubert , From ultrasoft pseudopotentials to the projector augmented - wave method , Phys . Rev . B 59 , 1758 ( 1999 ) . 19 http : / / users . wfu . edu / natalie / papers / pwpaw / newperiodictable / . 20 D . Ceresoli , N . Marzari , M . G . Lopez , and T . Thon - hauser , Ab initio converse NMR approach for pseudopoten - tials , Phys . Rev . B 81 , 184424 ( 2010 ) . 21 R . P . Kanwal , Linear integral equations ( Springer Science & Business Media , 2013 ) . 22 D . R . Hamann , Generalized norm - conserving pseudopoten - tials , Phys . Rev . B 40 , 2980 – 2987 ( 1989 ) . 23 P . Giannozzi , S . Baroni , N . Bonini , M . Calandra , R . Car , C . Cavazzoni , D . Ceresoli , G . L . Chiarotti , M . Cococcioni , I . Dabo , A . Dal Corso , S . de Gironcoli , S . Fabris , G . Fratesi , R . Gebauer , U . Gerstmann , C . Gougoussis , A . Kokalj , M . Lazzeri , L . Martin - Samos , N . Marzari , F . Mauri , R . Maz - zarello , S . Paolini , A . Pasquarello , L . Paulatto , C . Sbrac - cia , S . Scandolo , G . Sclauzero , A . P . Seitsonen , A . Smo - gunov , P . Umari , and R . M . Wentzcovitch , QUANTUM ESPRESSO : a modular and open - source software project for quantum simulations of materials , J . Phys . : Conden . Matt . 21 , 395502 ( 2009 ) . 24 T . Ozaki , Variationally optimized atomic orbitals for large - scale electronic structures , Phys . Rev . B 67 , 155108 ( 2003 ) . 25 J . P . Perdew , K . Burke , and M . Ernzerhof , Generalized gradient approximation made simple , Phys . Rev . Lett . 77 , 3865 – 3868 ( 1996 ) . 26 T . Ozaki and H . Kino , Numerical atomic basis orbitals from H to Kr , Phys . Rev . B 69 , 195113 ( 2004 ) . 27 M . Gusso , Study on the maximum accuracy of the pseu - dopotential density functional method with localized atomic orbitals versus plane - wave basis sets , J . Chem . Phys . 128 , 044102 ( 2008 ) . 28 M . Petersilka , U . J . Gossmann , and E . K . U . Gross , Ex - citation Energies from Time - Dependent Density - Functional Theory , Phys . Rev . Lett . 76 , 1212 – 1215 ( 1996 ) . 29 A . G¨orling and M . Levy , DFT ionization formulas and a DFT perturbation theory for exchange and correla - tion , through adiabatic connection , International Journal of Quantum Chemistry 56 , 93 – 108 ( 1995 ) . 30 M . S . Hybertsen and S . G . Louie , Electron correlation in semiconductors and insulators : Band gaps and quasiparticle energies , Phys . Rev . B 34 , 5390 – 5413 ( 1986 ) . 31 A . G . Taube and R . J . Bartlett , Frozen natural orbital coupled - cluster theory : Forces and application to decompo - sition of nitroethane , J . Chem . Phys . 128 , 164101 ( 2008 ) . 32 M . Posternak , A . Baldereschi , A . J . Freeman , E . Wim - mer , and M . Weinert , Prediction of Electronic Interlayer States in Graphite and Reinterpretation of Alkali Bands in Graphite Intercalation Compounds , Phys . Rev . Lett . 50 , 761 – 764 ( 1983 ) . 33 D . A . Fischer , R . M . Wentzcovitch , R . G . Carr , A . Con - tinenza , and A . J . Freeman , Graphitic interlayer states : A carbon K near - edge x - ray - absorption ﬁne - structure study , Phys . Rev . B 44 , 1427 – 1429 ( 1991 ) . 34 G . Cs´anyi , P . Littlewood , A . H . Nevidomskyy , C . J . Pickard , and B . Simons , The role of the interlayer state in the electronic structure of superconducting graphite intercalated compounds , Nature Phys . 1 , 42 – 45 ( 2005 ) . 35 Y . - i . Matsushita , S . Furuya , and A . Oshiyama , Floating Electron States in Covalent Semiconductors , Phys . Rev . Lett . 108 , 246404 ( 2012 ) . 36 Y . - i . Matsushita and A . Oshiyama , Interstitial Channels that Control Band Gaps and Eﬀective Masses in Tetra - hedrally Bonded Semiconductors , Phys . Rev . Lett . 112 , 136403 ( 2014 ) . 37 X . Blase , A . Rubio , S . G . Louie , and M . L . Cohen , Quasi - particle band structure of bulk hexagonal boron nitride and related systems , Phys . Rev . B 51 , 6868 – 6875 ( 1995 ) . 38 S . Okada , A . Oshiyama , and S . Saito , Nearly free electron states in carbon nanotube bundles , Phys . Rev . B 62 , 7634 – 7638 ( 2000 ) . 39 J . W . Chiou , C . L . Yueh , J . C . Jan , H . M . Tsai , W . F . Pong , I . - H . Hong , R . Klauser , M . - H . Tsai , Y . K . Chang , Y . Y . Chen , C . T . Wu , K . H . Chen , S . L . Wei , C . Y . Wen , L . C . Chen , and T . J . Chuang , Electronic structure of the carbon nanotube tips studied by x - ray - absorption spectroscopy and scanning photoelectron microscopy , Appl . Phys . Lett . 81 , 4189 – 4191 ( 2002 ) . 40 M . Feng , J . Zhao , and H . Petek , Atomlike , Hollow - Core – Bound Molecular Orbitals of C60 , Science 320 , 359 – 362 ( 2008 ) . 41 D . Stewart , A Cautionary Tale of Two Basis Sets and Graphene , Computing in Science and Engineering 14 , 55 – 59 ( 2012 ) . 42 L . Samuelson and I . P . Batra , Electronic properties of vari - ous stages of lithium intercalated graphite , J . Phys . C : Solid State Phys . 13 , 5105 ( 1980 ) . 43 S . B . Trickey , F . M¨uller - Plathe , G . H . F . Diercksen , and J . C . Boettger , Interplanar binding and lattice relaxation in a graphite dilayer , Phys . Rev . B 45 , 4460 – 4468 ( 1992 ) . 44 T . E . Weller , M . Ellerby , S . S . Saxena , R . P . Smith , and N . T . Skipper , Superconductivity in the intercalated graphite compounds C 6 Yb and C 6 Ca , Naturere Physics 1 , 39 – 41 ( 2005 ) . 45 V . A . Coleman , R . Knut , O . Karis , H . Grennberg , U . Jans - son , R . Quinlan , B . C . Holloway , B . Sanyal , and O . Eriksson , Defect formation in graphene nanosheets by acid treatment : an x - ray absorption spectroscopy and density functional the - ory study , J . Phys . Chem . 41 , 062001 ( 2008 ) . 46 C . Ehlert , W . E . S . Unger , and P . Saalfrank , C K - edge NEX - AFS spectra of graphene with physical and chemical defects : a study based on density functional theory , Phys . Chem . Chem . Phys . 16 , 14083 – 14095 ( 2014 ) . 47 D . Pacil´e , M . Papagno , A . F . Rodr´ıguez , M . Grioni , L . Pa - pagno , C¸ . Girit , J . C . Meyer , G . E . Begtrup , and A . Zettl , Pacil´e et al . Reply : , Phys . Rev . Lett . 102 , 099702 ( 2009 ) . 48 D . Pacil´e , M . Papagno , A . F . Rodr´ıguez , M . Grioni , L . Pa - pagno , C¸ . Girit , J . C . Meyer , G . E . Begtrup , and A . Zettl , Near - Edge X - Ray Absorption Fine - Structure Investigation of Graphene , Phys . Rev . Lett . 101 , 066806 ( 2008 ) . 49 M . Papagno , A . F . Rodr´ıguez , C¸ . Girit , J . Meyer , A . Zettl , and D . Pacil´e , Polarization - dependent C K near - edge X - ray absorption ﬁne - structure of graphene , Chem . Phys . Lett . 475 , 269 – 271 ( 2009 ) . 50 H . - K . Jeong , H . - J . Noh , J . - Y . Kim , L . Colakerol , P . - A . Glans , M . H . Jin , K . E . Smith , and Y . H . Lee , Comment on “Near - Edge X - Ray Absorption Fine - Structure Investiga - 8 tion of Graphene” , Phys . Rev . Lett . 102 , 099701 ( 2009 ) . 51 B . J . Schultz , C . J . Patridge , V . Lee , C . Jaye , P . S . Lysaght , C . Smith , J . Barnett , D . A . Fischer , D . Prendergast , and S . Banerjee , Imaging local electronic corrugations and doped regions in graphene , Nature Commun . 2 , 372 ( 2011 ) . 52 W . Hua , B . Gao , S . Li , H . ˚Agren , and Y . Luo , X - ray absorp - tion spectra of graphene from ﬁrst - principles simulations , Phys . Rev . B 82 , 155433 ( 2010 ) . 53 Y . Zhang , V . W . Brar , F . Wang , C . Girit , Y . Yayon , M . Pan - lasigui , A . Zettl , and M . F . Crommie , Giant phonon - induced conductance in scanning tunnelling spectroscopy of gate - tunable graphene , Nature Phys . 4 , 627 – 630 ( 2008 ) . 54 V . M . Silkin , J . Zhao , F . Guinea , E . V . Chulkov , P . M . Echenique , and H . Petek , Image potential states in graphene , Phys . Rev . B 80 , 121408 ( 2009 ) . 55 E . Kogan , V . U . Nazarov , V . M . Silkin , and M . Kaveh , Energy bands in graphene : Comparison between the tight - binding model and ab initio calculations , Phys . Rev . B 89 , 165430 ( 2014 ) .
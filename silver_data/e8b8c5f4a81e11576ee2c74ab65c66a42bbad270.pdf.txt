a r X i v : c ond - m a t / 0007235v2 [ c ond - m a t . s t a t - m ec h ] 7 M a y 2001 Random graphs with arbitrary degree distributions and their applications M . E . J . Newman 1 , 2 , S . H . Strogatz 2 , 3 , and D . J . Watts 1 , 4 1 Santa Fe Institute , 1399 Hyde Park Road , Santa Fe , NM 87501 2 Center for Applied Mathematics , Cornell University , Ithaca NY 14853 – 3401 3 Department of Theoretical and Applied Mechanics , Cornell University , Ithaca NY 14853 – 1503 4 Department of Sociology , Columbia University , 1180 Amsterdam Avenue , New York , NY 10027 Recent work on the structure of social networks and the internet has focussed attention on graphs with distributions of vertex degree that are signiﬁcantly diﬀerent from the Poisson degree distri - butions that have been widely studied in the past . In this paper we develop in detail the theory of random graphs with arbitrary degree distributions . In addition to simple undirected , unipartite graphs , we examine the properties of directed and bipartite graphs . Among other results , we derive exact expressions for the position of the phase transition at which a giant component ﬁrst forms , the mean component size , the size of the giant component if there is one , the mean number of vertices a certain distance away from a randomly chosen vertex , and the average vertex – vertex distance within a graph . We apply our theory to some real - world graphs , including the world - wide web and collaboration graphs of scientists and Fortune 1000 company directors . We demonstrate that in some cases random graphs with appropriate distributions of vertex degree predict with surprising accuracy the behavior of the real world , while in others there is a measurable discrepancy between theory and reality , perhaps indicating the presence of additional social structure in the network that is not captured by the random graph . I . INTRODUCTION A random graph [ 1 ] is a collection of points , or vertices , with lines , or edges , connecting pairs of them at random ( Fig . 1a ) . The study of random graphs has a long his - tory . Starting with the inﬂuential work of Paul Erd˝os and Alfr´ed R´enyi in the 1950s and 1960s [ 2 – 4 ] , random graph theory has developed into one of the mainstays of modern discrete mathematics , and has produced a prodi - gious number of results , many of them highly ingenious , describing statistical properties of graphs , such as distri - butions of component sizes , existence and size of a giant component , and typical vertex – vertex distances . In almost all of these studies the assumption has been made that the presence or absence of an edge between two vertices is independent of the presence or absence of any other edge , so that each edge may be considered to be present with independent probability p . If there are N vertices in a graph , and each is connected to an average of z edges , then it is trivial to show that p = z / ( N − 1 ) , which for large N is usually approximated by z / N . The number of edges connected to any particular vertex is called the degree k of that vertex , and has a probability distribution p k given by p k = (cid:18) N k (cid:19) p k ( 1 − p ) N − k ≃ z k e − z k ! , ( 1 ) where the second equality becomes exact in the limit of large N . This distribution we recognize as the Poisson distribution : the ordinary random graph has a Poisson distribution of vertex degrees , a point which turns out to be crucial , as we now explain . Random graphs are not merely a mathematical toy ; they have been employed extensively as models of real - ( a ) ( b ) FIG . 1 . ( a ) A schematic representation of a random graph , the circles representing vertices and the lines edges . ( b ) A directed random graph , i . e . , one in which each edge runs in only one direction . world networks of various types , particularly in epidemi - ology . The passage of a disease through a community de - pends strongly on the pattern of contacts between those infected with the disease and those susceptible to it . This pattern can be depicted as a network , with individuals represented by vertices and contacts capable of transmit - ting the disease by edges . The large class of epidemio - logical models known as susceptible / infectious / recovered ( or SIR ) models [ 5 – 7 ] makes frequent use of the so - called fully mixed approximation , which is the assumption that contacts are random and uncorrelated , i . e . , that they form a random graph . Random graphs however turn out to have severe short - comings as models of such real - world phenomena . Al - though it is diﬃcult to determine experimentally the structure of the network of contacts by which a disease is spread [ 8 ] , studies have been performed of other social networks such as networks of friendships within a variety 1 of communities [ 9 – 11 ] , networks of telephone calls [ 12 , 13 ] , airline timetables [ 14 ] , and the power grid [ 15 ] , as well as networks in physical or biological systems , including neu - ral networks [ 15 ] , the structure and conformation space of polymers [ 16 , 17 ] , metabolic pathways [ 18 , 19 ] , and food webs [ 20 , 21 ] . It is found [ 13 , 14 ] that the distribution of vertex degrees in many of these networks is measur - ably diﬀerent from a Poisson distribution—often wildly diﬀerent—and this strongly suggests , as has been em - phasized elsewhere [ 22 ] , that there are features of such networks which we would miss if we were to approximate them by an ordinary ( Poisson ) random graph . Another very widely studied network is the internet , whose structure has attracted an exceptional amount of scrutiny , academic and otherwise , following its meteoric rise to public visibility starting in 1993 . Pages on the world - wide web may be thought of as the vertices of a graph and the hyperlinks between them as edges . Empir - ical studies [ 23 – 26 ] have shown that this graph has a dis - tribution of vertex degree which is heavily right - skewed and possesses a fat ( power - law ) tail with an exponent between − 2 and − 3 . ( The underlying physical struc - ture of the internet also has a degree distribution of this type [ 27 ] . ) This distribution is very far from Poisson , and therefore we would expect that a simple random graph would give a very poor approximation of the structural properties of the web . However , the web diﬀers from a random graph in another way also : it is directed . Links on the web lead from one page to another in only one direction ( see Fig . 1b ) . As discussed by Broder et al . [ 26 ] this has a signiﬁcant practical eﬀect on the typical acces - sibility of one page from another , and this eﬀect also will not be captured by a simple ( undirected ) random graph model . A further class of networks that has attracted scrutiny is the class of collaboration networks . Examples of such networks include the boards of directors of compa - nies [ 28 – 31 ] , co - ownership networks of companies [ 32 ] , and collaborations of scientists [ 33 – 37 ] and movie ac - tors [ 15 ] . As well as having strongly non - Poisson de - gree distributions [ 14 , 36 ] , these networks have a bipartite structure ; there are two distinct kinds of vertices on the graph with links running only between vertices of unlike kinds [ 38 ] —see Fig . 2 . In the case of movie actors , for example , the two types of vertices are movies and actors , and the network can be represented as a graph with edges running between each movie and the actors that appear in it . Researchers have also considered the projection of this graph onto the unipartite space of actors only , also called a one - mode network [ 38 ] . In such a projection two actors are considered connected if they have appeared in a movie together . The construction of the one - mode network however involves discarding some of the infor - mation contained in the original bipartite network , and for this reason it is more desirable to model collaboration networks using the full bipartite structure . Given the high current level of interest in the structure of many of the graphs described here , and given their sub - B D A C E F G H I J K A B C D E F G H I J K 1 2 3 4 FIG . 2 . A schematic representation ( top ) of a bipartite graph , such as the graph of movies and the actors who have appeared in them . In this small graph we have four movies , labeled 1 to 4 , and eleven actors , labeled A to K , with edges joining each movie to the actors in its cast . In the lower part of the picture we show the one - mode projection of the graph for the eleven actors . stantial diﬀerences from the ordinary random graphs that have been studied in the past , it would clearly be useful if we could generalize the mathematics of random graphs to non - Poisson degree distributions , and to directed and bipartite graphs . In this paper we do just that , demon - strating in detail how the statistical properties of each of these graph types can be calculated exactly in the limit of large graph size . We also give examples of the ap - plication of our theory to the modeling of a number of real - world networks , including the world - wide web and collaboration graphs . II . RANDOM GRAPHS WITH ARBITRARY DEGREE DISTRIBUTIONS In this section we develop a formalism for calculating a variety of quantities , both local and global , on large unipartite undirected graphs with arbitrary probability distribution of the degrees of their vertices . In all re - spects other than their degree distribution , these graphs are assumed to be entirely random . This means that the degrees of all vertices are independent identically - distributed random integers drawn from a speciﬁed dis - tribution . For a given choice of these degrees , also called the “degree sequence , ” the graph is chosen uniformly at random from the set of all graphs with that degree se - quence . All properties calculated in this paper are aver - aged over the ensemble of graphs generated in this way . In the limit of large graph size an equivalent procedure is to study only one particular degree sequence , averaging uniformly over all graphs with that sequence , where the 2 sequence is chosen to approximate as closely as possible the desired probability distribution . The latter proce - dure can be thought of as a “microcanonical ensemble” for random graphs , where the former is a “canonical en - semble . ” Some results are already known for random graphs with arbitrary degree distributions : in two beautiful re - cent papers [ 39 , 40 ] , Molloy and Reed have derived for - mulas for the position of the phase transition at which a giant component ﬁrst appears , and the size of the gi - ant component . ( These results are calculated within the microcanonical ensemble , but apply equally to the canon - ical one in the large system size limit . ) The formalism we present in this paper yields an alternative derivation of these results and also provides a framework for obtaining other quantities of interest , some of which we calculate . In Sections III and IV we extend our formalism to the case of directed graphs ( such as the world - wide web ) and bipartite graphs ( such as collaboration graphs ) . A . Generating functions Our approach is based on generating functions [ 41 ] , the most fundamental of which , for our purposes , is the gen - erating function G 0 ( x ) for the probability distribution of vertex degrees k . Suppose that we have a unipartite undi - rected graph—an acquaintance network , for example—of N vertices , with N large . We deﬁne G 0 ( x ) = ∞ X k = 0 p k x k , ( 2 ) where p k is the probability that a randomly chosen ver - tex on the graph has degree k . The distribution p k is assumed correctly normalized , so that G 0 ( 1 ) = 1 . ( 3 ) The same will be true of all generating functions consid - ered here , with a few important exceptions , which we will note at the appropriate point . Because the probability distribution is normalized and positive deﬁnite , G 0 ( x ) is also absolutely convergent for all | x | ≤ 1 , and hence has no singularities in this region . All the calculations of this paper will be conﬁned to the region | x | ≤ 1 . The function G 0 ( x ) , and indeed any probability gener - ating function , has a number of properties that will prove useful in subsequent developments . Derivatives The probability p k is given by the k th derivative of G 0 according to p k = 1 k ! d k G 0 d x k (cid:12)(cid:12) (cid:12)(cid:12) x = 0 . ( 4 ) Thus the one function G 0 ( x ) encapsulates all the in - formation contained in the discrete probability distribu - tion p k . We say that the function G 0 ( x ) “generates” the probability distribution p k . Moments The average over the probability distribu - tion generated by a generating function—for instance , the average degree z of a vertex in the case of G 0 ( x ) —is given by z = h k i = X k kp k = G ′ 0 ( 1 ) . ( 5 ) Thus if we can calculate a generating function we can also calculate the mean of the probability distribution which it generates . Higher moments of the distribution can be calculated from higher derivatives also . In general , we have h k n i = X k k n p k = (cid:20)(cid:18) x d d x (cid:19) n G 0 ( x ) (cid:21) x = 1 . ( 6 ) Powers If the distribution of a property k of an object is generated by a given generating function , then the dis - tribution of the total of k summed over m independent realizations of the object is generated by the m th power of that generating function . For example , if we choose m vertices at random from a large graph , then the dis - tribution of the sum of the degrees of those vertices is generated by [ G 0 ( x ) ] m . To see why this is so , consider the simple case of just two vertices . The square [ G 0 ( x ) ] 2 of the generating function for a single vertex can be ex - panded as [ G 0 ( x ) ] 2 = (cid:20)X k p k x k (cid:21) 2 = X jk p j p k x j + k = p 0 p 0 x 0 + ( p 0 p 1 + p 1 p 0 ) x 1 + ( p 0 p 2 + p 1 p 1 + p 2 p 0 ) x 2 + ( p 0 p 3 + p 1 p 2 + p 2 p 1 + p 3 p 0 ) x 3 + . . . ( 7 ) It is clear that the coeﬃcient of the power of x n in this expression is precisely the sum of all products p j p k such that j + k = n , and hence correctly gives the probability that the sum of the degrees of the two vertices will be n . It is straightforward to convince oneself that this prop - erty extends also to all higher powers of the generating function . All of these properties will be used in the derivations given in this paper . Another quantity that will be important to us is the distribution of the degree of the vertices that we arrive at by following a randomly chosen edge . Such an edge arrives at a vertex with probability proportional to the degree of that vertex , and the vertex therefore has a prob - ability distribution of degree proportional to kp k . The correctly normalized distribution is generated by P k kp k x k P k kp k = xG ′ 0 ( x ) G ′ 0 ( 1 ) . ( 8 ) 3 If we start at a randomly chosen vertex and follow each of the edges at that vertex to reach the k nearest neighbors , then the vertices arrived at each have the dis - tribution of remaining outgoing edges generated by this function , less one power of x , to allow for the edge that we arrived along . Thus the distribution of outgoing edges is generated by the function G 1 ( x ) = G ′ 0 ( x ) G ′ 0 ( 1 ) = 1 z G ′ 0 ( x ) , ( 9 ) where z is the average vertex degree , as before . The prob - ability that any of these outgoing edges connects to the original vertex that we started at , or to any of its other immediate neighbors , goes as N − 1 and hence can be ne - glected in the limit of large N . Thus , making use of the “powers” property of the generating function described above , the generating function for the probability distri - bution of the number of second neighbors of the original vertex can be written as X k p k [ G 1 ( x ) ] k = G 0 ( G 1 ( x ) ) . ( 10 ) Similarly , the distribution of third - nearest neighbors is generated by G 0 ( G 1 ( G 1 ( x ) ) ) , and so on . The average number z 2 of second neighbors is z 2 = (cid:20) d d xG 0 ( G 1 ( x ) ) (cid:21) x = 1 = G ′ 0 ( 1 ) G ′ 1 ( 1 ) = G ′′ 0 ( 1 ) , ( 11 ) where we have made use of the fact that G 1 ( 1 ) = 1 . ( One might be tempted to conjecture that since the average number of ﬁrst neighbors is G ′ 0 ( 1 ) , Eq . ( 5 ) , and the aver - age number of second neighbors is G ′′ 0 ( 1 ) , Eq . ( 11 ) , then the average number of m th neighbors should be given by the m th derivative of G 0 evaluated at x = 1 . As we show in Section II F , however , this conjecture is wrong . ) B . Examples To make things more concrete , we immediately intro - duce some examples of speciﬁc graphs to illustrate how these calculations are carried out . a . Poisson - distributed graphs The simplest example of a graph of this type is one for which the distribution of degree is binomial , or Poisson in the large N limit . This distribution yields the standard random graph studied by many mathematicians and discussed in Section I . In this graph the probability p = z / N of the existence of an edge between any two vertices is the same for all vertices , and G 0 ( x ) is given by G 0 ( x ) = N X k = 0 (cid:18) N k (cid:19) p k ( 1 − p ) N − k x k = ( 1 − p + px ) N = e z ( x − 1 ) , ( 12 ) where the last equality applies in the limit N → ∞ . It is then trivial to show that the average degree of a vertex is indeed G ′ 0 ( 1 ) = z and that the probability distribution of degree is given by p k = z k e − z / k ! , which is the ordinary Poisson distribution . Notice also that for this special case we have G 1 ( x ) = G 0 ( x ) , so that the distribution of out - going edges at a vertex is the same , regardless of whether we arrived there by choosing a vertex at random , or by following a randomly chosen edge . This property , which is peculiar to the Poisson - distributed random graph , is the reason why the theory of random graphs of this type is especially simple . b . Exponentially distributed graphs Perhaps the next simplest type of graph is one with an exponential distri - bution of vertex degrees p k = ( 1 − e − 1 / κ ) e − k / κ , ( 13 ) where κ is a constant . The generating function for this distribution is G 0 ( x ) = ( 1 − e − 1 / κ ) ∞ X k = 0 e − k / κ x k = 1 − e − 1 / κ 1 − x e − 1 / κ , ( 14 ) and G 1 ( x ) = (cid:20) 1 − e − 1 / κ 1 − x e − 1 / κ (cid:21) 2 . ( 15 ) An example of a graph with an exponential degree dis - tribution is given in Section V A . c . Power - law distributed graphs The recent interest in the properties of the world - wide web and of social net - works leads us to investigate the properties of graphs with a power - law distribution of vertex degrees . Such graphs have been discussed previously by Barab´asi et al . [ 22 , 23 ] and by Aiello et al . [ 13 ] . In this paper , we will look at graphs with degree distribution given by p k = Ck − τ e − k / κ for k ≥ 1 . ( 16 ) where C , τ , and κ are constants . The reason for including the exponential cutoﬀ is two - fold : ﬁrst many real - world graphs appear to show this cutoﬀ [ 14 , 36 ] ; second it makes the distribution normalizable for all τ , and not just τ ≥ 2 . The constant C is ﬁxed by the requirement of normal - ization , which gives C = [ Li τ ( e − 1 / κ ) ] − 1 and hence p k = k − τ e − k / κ Li τ ( e − 1 / κ ) for k ≥ 1 , ( 17 ) where Li n ( x ) is the n th polylogarithm of x , a function familiar to those who have worked with Feynman inte - grals . Substituting ( 17 ) into Eq . ( 2 ) , we ﬁnd that the gen - erating function for graphs with this degree distribution is G 0 ( x ) = Li τ ( x e − 1 / κ ) Li τ ( e − 1 / κ ) . ( 18 ) 4 In the limit κ → ∞ —the case considered in Refs . [ 13 ] and [ 23 ] —this simpliﬁes to G 0 ( x ) = Li τ ( x ) ζ ( τ ) , ( 19 ) where ζ ( x ) is the Riemann ζ - function . The function G 1 ( x ) is given by G 1 ( x ) = Li τ − 1 ( x e − 1 / κ ) x Li τ − 1 ( e − 1 / κ ) . ( 20 ) Thus , for example , the average number of neighbors of a randomly - chosen vertex is z = G ′ 0 ( 1 ) = Li τ − 1 ( e − 1 / κ ) Li τ ( e − 1 / κ ) , ( 21 ) and the average number of second neighbors is z 2 = G ′′ 0 ( 1 ) = Li τ − 2 ( e − 1 / κ ) − Li τ − 1 ( e − 1 / κ ) Li τ ( e − 1 / κ ) . ( 22 ) d . Graphs with arbitrary speciﬁed degree distribution In some cases we wish to model speciﬁc real - world graphs which have known degree distributions—known because we can measure them directly . A number of the graphs described in the introduction fall into this category . For these graphs , we know the exact numbers n k of vertices having degree k , and hence we can write down the exact generating function for that probability distribution in the form of a ﬁnite polynomial : G 0 ( x ) = P k n k x k P k n k , ( 23 ) where the sum in the denominator ensures that the gen - erating function is properly normalized . As a example , suppose that in a community of 1000 people , each person knows between zero and ﬁve of the others , the exact num - bers of people in each category being , from zero to ﬁve : { 86 , 150 , 363 , 238 , 109 , 54 } . This distribution will then be generated by the polynomial G 0 ( x ) = 86 + 150 x + 363 x 2 + 238 x 3 + 109 x 4 + 54 x 5 1000 . ( 24 ) C . Component sizes We are now in a position to calculate some proper - ties of interest for our graphs . First let us consider the distribution of the sizes of connected components in the graph . Let H 1 ( x ) be the generating function for the dis - tribution of the sizes of components which are reached by choosing a random edge and following it to one of its . . . + + + = + FIG . 3 . Schematic representation of the sum rule for the connected component of vertices reached by following a ran - domly chosen edge . The probability of each such component ( left - hand side ) can be represented as the sum of the probabil - ities ( right - hand side ) of having only a single vertex , having a single vertex connected to one other component , or two other components , and so forth . The entire sum can be expressed in closed form as Eq . ( 26 ) . ends . We explicitly exclude from H 1 ( x ) the giant com - ponent , if there is one ; the giant component is dealt with separately below . Thus , except when we are precisely at the phase transition where the giant component ap - pears , typical component sizes are ﬁnite , and the chances of a component containing a closed loop of edges goes as N − 1 , which is negligible in the limit of large N . This means that the distribution of components generated by H 1 ( x ) can be represented graphically as in Fig . 3 ; each component is tree - like in structure , consisting of the sin - gle site we reach by following our initial edge , plus any number ( including zero ) of other tree - like clusters , with the same size distribution , joined to it by single edges . If we denote by q k the probability that the initial site has k edges coming out of it other than the edge we came in along , then , making use of the “powers” property of Sec - tion II A , H 1 ( x ) must satisfy a self - consistency condition of the form H 1 ( x ) = xq 0 + xq 1 H 1 ( x ) + xq 2 [ H 1 ( x ) ] 2 + . . . ( 25 ) However , q k is nothing other than the coeﬃcient of x k in the generating function G 1 ( x ) , Eq . ( 9 ) , and hence Eq . ( 25 ) can also be written H 1 ( x ) = xG 1 ( H 1 ( x ) ) . ( 26 ) If we start at a randomly chosen vertex , then we have one such component at the end of each edge leaving that vertex , and hence the generating function for the size of the whole component is H 0 ( x ) = xG 0 ( H 1 ( x ) ) . ( 27 ) In principle , therefore , given the functions G 0 ( x ) and G 1 ( x ) , we can solve Eq . ( 26 ) for H 1 ( x ) and substitute into Eq . ( 27 ) to get H 0 ( x ) . Then we can ﬁnd the proba - bility that a randomly chosen vertex belongs to a compo - nent of size s by taking the s th derivative of H 0 . In prac - tice , unfortunately , this is usually impossible ; Eq . ( 26 ) is a complicated and frequently transcendental equation , which rarely has a known solution . On the other hand , we note that the coeﬃcient of x s in the Taylor expansion 5 of H 1 ( x ) ( and therefore also the s th derivative ) are given exactly by only s + 1 iterations of Eq . ( 27 ) , starting with H 1 = 1 , so that the distribution generated by H 0 ( x ) can be calculated exactly to ﬁnite order in ﬁnite time . With current symbolic manipulation programs , it is quite pos - sible to evaluate the ﬁrst one hundred or so derivatives in this way . Failing this , an approximate solution can be found by numerical iteration and the distribution of clus - ter sizes calculated from Eq . ( 4 ) by numerical diﬀerenti - ation . Since direct evaluation of numerical derivatives is prone to machine - precision problems , we recommend evaluating the derivatives by numerical integration of the Cauchy formula , giving the probability distribution P s of cluster sizes thus : P s = 1 s ! d s H 0 d z s (cid:12)(cid:12)(cid:12)(cid:12) z = 0 = 1 2 π i I H 0 ( z ) z s + 1 d z . ( 28 ) The best numerical precision is obtained by using the largest possible contour , subject to the condition that it enclose no poles of the generating function . The largest contour for which this condition is satisﬁed in general is the unit circle | z | = 1 ( see Section II A ) , and we recom - mend using this contour for Eq . ( 28 ) . It is possible to ﬁnd the ﬁrst thousand derivatives of a function without diﬃculty using this method [ 42 ] . D . The mean component size , the phase transition , and the giant component Although it is not usually possible to ﬁnd a closed - form expression for the complete distribution of cluster sizes on a graph , we can ﬁnd closed - form expressions for the average properties of clusters from Eqs . ( 26 ) and ( 27 ) . For example , the average size of the component to which a randomly chosen vertex belongs , for the case where there is no giant component in the graph , is given in the normal fashion by h s i = H ′ 0 ( 1 ) = 1 + G ′ 0 ( 1 ) H ′ 1 ( 1 ) . ( 29 ) From Eq . ( 26 ) we have H ′ 1 ( 1 ) = 1 + G ′ 1 ( 1 ) H ′ 1 ( 1 ) , ( 30 ) and hence h s i = 1 + G ′ 0 ( 1 ) 1 − G ′ 1 ( 1 ) = 1 + z 21 z 1 − z 2 , ( 31 ) where z 1 = z is the average number of neighbors of a vertex and z 2 is the average number of second neighbors . We see that this expression diverges when G ′ 1 ( 1 ) = 1 . ( 32 ) This point marks the phase transition at which a giant component ﬁrst appears . Substituting Eqs . ( 2 ) and ( 9 ) into Eq . ( 32 ) , we can also write the condition for the phase transition as X k k ( k − 2 ) p k = 0 . ( 33 ) Indeed , since this sum increases monotonically as edges are added to the graph , it follows that the giant compo - nent exists if and only if this sum is positive . This re - sult has been derived by diﬀerent means by Molloy and Reed [ 39 ] . An equivalent and intuitively reasonable state - ment , which can also be derived from Eq . ( 31 ) , is that the giant component exists if and only if z 2 > z 1 . Our generating function formalism still works when there is a giant component in the graph , but , by deﬁ - nition , H 0 ( x ) then generates the probability distribution of the sizes of components excluding the giant compo - nent . This means that H 0 ( 1 ) is no longer unity , as it is for the other generating functions considered so far , but instead takes the value 1 − S , where S is the fraction of the graph occupied by the giant component . We can use this to calculate the size of the giant component from Eqs . ( 26 ) and ( 27 ) thus : S = 1 − G 0 ( u ) , ( 34 ) where u ≡ H 1 ( 1 ) is the smallest non - negative real solu - tion of u = G 1 ( u ) . ( 35 ) This result has been derived in a diﬀerent but equivalent form by Molloy and Reed [ 40 ] , using diﬀerent methods . The correct general expression for the average compo - nent size , excluding the ( formally inﬁnite ) giant compo - nent , if there is one , is h s i = H ′ 0 ( 1 ) H 0 ( 1 ) = 1 H 0 ( 1 ) (cid:20) G 0 ( H 1 ( 1 ) ) + G ′ 0 ( H 1 ( 1 ) ) G 1 ( H 1 ( 1 ) ) 1 − G ′ 1 ( H 1 ( 1 ) ) (cid:21) = 1 + zu 2 [ 1 − S ] [ 1 − G ′ 1 ( u ) ] , ( 36 ) which is equivalent to ( 31 ) when there is no giant com - ponent ( S = 0 , u = 1 ) . For example , in the ordinary random graph with Pois - son degree distribution , we have G 0 ( x ) = G 1 ( x ) = e z ( x − 1 ) ( Eq . ( 12 ) ) , and hence we ﬁnd simply that 1 − S = u is a solution of u = G 0 ( u ) , or equivalently that S = 1 − e − zS . ( 37 ) The average component size is given by h s i = 1 1 − z + zS . ( 38 ) These are all well - known results [ 1 ] . 6 For graphs with purely power - law distributions ( Eq . ( 17 ) with κ → ∞ ) , S is given by ( 34 ) with u the smallest non - negative real solution of u = Li τ − 1 ( u ) uζ ( τ − 1 ) . ( 39 ) For all τ ≤ 2 this gives u = 0 , and hence S = 1 , imply - ing that a randomly chosen vertex belongs to the giant component with probability tending to 1 as κ → ∞ . For graphs with τ > 2 , the probability of belonging to the gi - ant component is strictly less than 1 , even for inﬁnite κ . In other words , the giant component essentially ﬁlls the entire graph for τ ≤ 2 , but not for τ > 2 . These results have been derived by diﬀerent means by Aiello et al . [ 13 ] . E . Asymptotic form of the cluster size distribution A variety of results are known about the asymptotic properties of the coeﬃcients of generating functions , some of which can usefully be applied to the distribu - tion of cluster sizes P s generated by H 0 ( x ) . Close to the phase transition , we expect the tail of the distribution P s to behave as P s ∼ s − α e − s / s ∗ , ( 40 ) where the constants α and s ∗ can be calculated from the properties of H 0 ( x ) as follows . The cutoﬀ parameter s ∗ is simply related to the radius of convergence | x ∗ | of the generating function [ 41 , 43 ] , ac - cording to s ∗ = 1 log | x ∗ | . ( 41 ) The radius of convergence | x ∗ | is equal to the magnitude of the position x ∗ of the singularity in H 0 ( x ) nearest to the origin . From Eq . ( 27 ) we see that such a singular - ity may arise either through a singularity in G 0 ( x ) or through one in H 1 ( x ) . However , since the ﬁrst singu - larity in G 0 ( x ) is known to be outside the unit circle ( Section II A ) , and the ﬁrst singularity in H 1 ( x ) tends to x = 1 as we go to the phase transition ( see below ) , it follows that , suﬃciently close to the phase transition , the singularity in H 0 ( x ) closest to the origin is also a singu - larity in H 1 ( x ) . With this result x ∗ is easily calculated . Although we do not in general have a closed - form ex - pression for H 1 ( x ) , it is easy to derive one for its func - tional inverse . Putting w = H 1 ( x ) and x = H − 1 1 ( w ) in Eq . ( 26 ) and rearranging , we ﬁnd x = H − 1 1 ( w ) = w G 1 ( w ) . ( 42 ) The singularity of interest corresponds to the point w ∗ at which the derivative of H − 1 1 ( w ) is zero , which is a solution of G 1 ( w ∗ ) − w ∗ G ′ 1 ( w ∗ ) = 0 . ( 43 ) Then x ∗ ( and hence s ∗ ) is given by Eq . ( 42 ) . Note that there is no guarantee that ( 43 ) has a ﬁnite solution , and that if it does not , then P s will not in general follow the form of Eq . ( 40 ) . When we are precisely at the phase transition of our system , we have G 1 ( 1 ) = G ′ 1 ( 1 ) = 1 , and hence the so - lution of Eq . ( 43 ) gives w ∗ = x ∗ = 1—a result which we used above—and s ∗ → ∞ . We can use the fact that x ∗ = 1 at the transition to calculate the value of the ex - ponent α as follows . Expanding H − 1 1 ( w ) about w ∗ = 1 by putting w = 1 + ǫ in Eq . ( 42 ) , we ﬁnd that H − 1 1 ( 1 + ǫ ) = 1 − 12 G ′′ 1 ( 1 ) ǫ 2 + O ( ǫ 3 ) , ( 44 ) where we have made use of G 1 ( 1 ) = G ′ 1 ( 1 ) = 1 at the phase transition . So long as G ′′ 1 ( 1 ) 6 = 0 , which in general it is not , this implies that H 1 ( x ) and hence also H 0 ( x ) are of the form H 0 ( x ) ∼ ( 1 − x ) β as x → 1 , ( 45 ) with β = 12 . This exponent is related to the exponent α as follows . Equation ( 40 ) implies that H 0 ( x ) can be written in the form H 0 ( x ) = a − 1 X s = 0 P s x s + C ∞ X s = a s − α e − s / s ∗ x s + ǫ ( a ) , ( 46 ) where C is a constant and the last ( error ) term ǫ ( a ) is as - sumed much smaller than the second term . The ﬁrst term in this expression is a ﬁnite polynomial and therefore has no singularities on the ﬁnite plane ; the singularity resides in the second term . Using this equation , the exponent β can be written : β = lim x → 1 (cid:20) 1 + ( x − 1 ) H ′′ 0 ( x ) H ′ 0 ( x ) (cid:21) = lim a →∞ lim x → 1 (cid:20) 1 x + x − 1 x P ∞ s = a s 2 − α x s − 1 P ∞ s = a s 1 − α x s − 1 (cid:21) = lim a →∞ lim x → 1 (cid:20) 1 x + 1 − x x log x Γ ( 3 − α , − a log x ) Γ ( 2 − α , − a log x ) (cid:21) , ( 47 ) where we have replaced the sums with integrals as a be - comes large , and Γ ( ν , µ ) is the incomplete Γ - function . Taking the limits in the order speciﬁed and rearranging for α , we then get α = β + 1 = 32 , ( 48 ) regardless of degree distribution , except in the special case where G ′′ 1 ( 1 ) vanishes ( see Eq . ( 44 ) ) . The result α = 3 2 was known previously for the ordinary Poisson random graph [ 1 ] , but not for other degree distributions . 7 F . Numbers of neighbors and average path length We turn now to the calculation of the number of neigh - bors who are m steps away from a randomly chosen ver - tex . As shown in Section II A , the probability distribu - tions for ﬁrst - and second - nearest neighbors are gener - ated by the functions G 0 ( x ) and G 0 ( G 1 ( x ) ) . By exten - sion , the distribution of m th neighbors is generated by G 0 ( G 1 ( . . . G 1 ( x ) . . . ) ) , with m − 1 iterations of the func - tion G 1 acting on itself . If we deﬁne G ( m ) ( x ) to be this generating function for m th neighbors , then we have G ( m ) ( x ) = (cid:26) G 0 ( x ) for m = 1 G ( m − 1 ) ( G 1 ( x ) ) for m ≥ 2 . ( 49 ) Then the average number z m of m th - nearest neighbors is z m = d G ( m ) d x (cid:12)(cid:12)(cid:12)(cid:12) x = 1 = G ′ 1 ( 1 ) G ( m − 1 ) ′ ( 1 ) = G ′ 1 ( 1 ) z m − 1 . ( 50 ) Along with the initial condition z 1 = z = G ′ 0 ( 1 ) , this then tells us that z m = [ G ′ 1 ( 1 ) ] m − 1 G ′ 0 ( 1 ) = (cid:20) z 2 z 1 (cid:21) m − 1 z 1 . ( 51 ) From this result we can make an estimate of the typi - cal length ℓ of the shortest path between two randomly chosen vertices on the graph . This typical path length is reached approximately when the total number of neigh - bors of a vertex out to that distance is equal to the num - ber of vertices on the graph , i . e . , when 1 + ℓ X m = 1 z m = N . ( 52 ) Using Eq . ( 51 ) this gives us ℓ = log [ ( N − 1 ) ( z 2 − z 1 ) + z 21 ] − log z 21 log ( z 2 / z 1 ) . ( 53 ) In the common case where N ≫ z 1 and z 2 ≫ z 1 , this reduces to ℓ = log ( N / z 1 ) log ( z 2 / z 1 ) + 1 . ( 54 ) This result is only approximate for two reasons . First , the conditions used to derive it are only an approxima - tion ; the exact answer depends on the detailed structure of the graph . Second , it assumes that all vertices are reachable from a randomly chosen starting vertex . In general however this will not be true . For graphs with no giant component it is certainly not true and Eq . ( 54 ) is meaningless . Even when there is a giant component however , it is usually not the case that it ﬁlls the entire graph . A better approximation to ℓ may therefore be given by replacing N in Eq . ( 54 ) by NS , where S is the fraction of the graph occupied by the giant component , as in Section II D . Such shortcomings notwithstanding , there are a num - ber of remarkable features of Eq . ( 54 ) : 1 . It shows that the average vertex – vertex distance for all random graphs , regardless of degree distri - bution , should scale logarithmically with size N , according to ℓ = A + B log N , where A and B are constants . This result is of course well - known for a number of special cases . 2 . It shows that the average distance , which is a global property , can be calculated from a knowledge only of the average numbers of ﬁrst - and second - nearest neighbors , which are local properties . It would be possible therefore to measure these numbers em - pirically by purely local measurements on a graph such as an acquaintance network and from them to determine the expected average distance between vertices . For some networks at least , this gives a surprisingly good estimate of the true average dis - tance [ 37 ] . 3 . It shows that only the average numbers of ﬁrst - and second - nearest neighbors are important to the calculation of average distances , and thus that two random graphs with completely diﬀerent distribu - tions of vertex degrees , but the same values of z 1 and z 2 , will have the same average distances . For the case of the purely theoretical example graphs we discussed earlier , we cannot make an empirical mea - surement of z 1 and z 2 , but we can still employ Eq . ( 54 ) to calculate ℓ . In the case of the ordinary ( Poisson ) random graph , for instance , we ﬁnd from Eq . ( 12 ) that z 1 = z , z 2 = z 2 , and so ℓ = log N / log z , which is the standard result for graphs of this type [ 1 ] . For the graph with de - gree distributed according to the truncated power law , Eq . ( 17 ) , z 1 and z 2 are given by Eqs . ( 21 ) and ( 22 ) , and the average vertex – vertex distance is ℓ = log N + log (cid:2) Li τ ( e − 1 / κ ) / Li τ − 1 ( e − 1 / κ ) (cid:3) log (cid:2) Li τ − 2 ( e − 1 / κ ) / Li τ − 1 ( e − 1 / κ ) − 1 (cid:3) + 1 . ( 55 ) In the limit κ → ∞ , this becomes ℓ = log N + log (cid:2) ζ ( τ ) / ζ ( τ − 1 ) (cid:3) log (cid:2) ζ ( τ − 2 ) / ζ ( τ − 1 ) − 1 (cid:3) + 1 . ( 56 ) Note that this expression does not have a ﬁnite positive real value for any τ < 3 , indicating that one must specify a ﬁnite cutoﬀ κ for the degree distribution to get a well - deﬁned average vertex – vertex distance on such graphs . G . Simulation results As a check on the results of this section , we have per - formed extensive computer simulations of random graphs 8 with various distributions of vertex degree . Such graphs are relatively straightforward to generate . First , we gen - erate a set of N random numbers { k i } to represent the degrees of the N vertices in the graph . These may be thought of as the “stubs” of edges , emerging from their respective vertices . Then we choose pairs of these stubs at random and place edges on the graph joining them up . It is simple to see that this will generate all graphs with the given set of vertex degrees with equal proba - bility . The only small catch is that the sum P i k i of the degrees must be even , since each edge added to the graph must have two ends . This is not diﬃcult to con - trive however . If the set { k i } is such that the sum is odd , we simply throw it away and generate a new set . As a practical matter , integers representing vertex de - grees with any desired probability distribution can be generated using the transformation method if applica - ble , or failing that , a rejection or hybrid method [ 44 ] . For example , degrees obeying the power - law - plus - cutoﬀ form of Eq . ( 17 ) can be generated using a two - step hy - brid transformation / rejection method as follows . First , we generate random integers k ≥ 1 with distribution pro - portional to e − k / κ using the transformation [ 45 ] k = ⌈− κ log ( 1 − r ) ⌉ , ( 57 ) where r is a random real number uniformly distributed in the range 0 ≤ r < 1 . Second , we accept this number with probability k − τ , where by “accept” we mean that if the number is not accepted we discard it and generate another one according to Eq . ( 57 ) , repeating the process until one is accepted . In Fig . 4 we show results for the size of the giant com - ponent in simulations of undirected unipartite graphs with vertex degrees distributed according to Eq . ( 17 ) for a variety of diﬀerent values of τ and κ . On the same plot we also show the expected value of the same quantity derived by numerical solution of Eqs . ( 34 ) and ( 35 ) . As the ﬁgure shows , the agreement between simulation and theory is excellent . III . DIRECTED GRAPHS We turn now to directed graphs with arbitrary de - gree distributions . An example of a directed graph is the world - wide web , since every hyperlink between two pages on the web goes in only one direction . The web has a degree distribution that follows a power - law , as discussed in Section I . Directed graphs introduce a subtlety that is not present in undirected ones , and which becomes impor - tant when we apply our generating function formalism . In a directed graph it is not possible to talk about a “component”—i . e . , a group of connected vertices— because even if vertex A can be reached by following ( directed ) edges from vertex B , that does not necessarily mean that vertex B can be reached from vertex A . There 1 10 100 cutoff parameter κ 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 s i ze o f g i a n t c o m pon e n t τ = 1 . 0 τ = 1 . 5 τ = 2 . 0 τ = 2 . 5 FIG . 4 . The size of the giant component in random graphs with vertex degrees distributed according to Eq . ( 17 ) , as a function of the cutoﬀ parameter κ for ﬁve diﬀerent values of the exponent τ . The points are results from numerical simulations on graphs of N = 1 000 000 vertices , and the solid lines are the theoretical value for inﬁnite graphs , Eqs . ( 34 ) and ( 35 ) . The error bars on the simulation results are smaller than the data points . are two correct generalizations of the idea of the compo - nent to a directed graph : the set of vertices which are reachable from a given vertex , and the set from which a given vertex can be reached . We will refer to these as “out - components” and “in - components” respectively . An in - component can also be thought of as those ver - tices reachable by following edges backwards ( but not forwards ) from a speciﬁed vertex . It is possible to study directed graphs by allowing both forward and backward traversal of edges ( see Ref . [ 26 ] , for example ) . In this case , however , the graph eﬀectively becomes undirected and should be treated with the formalism of Section II . With these considerations in mind , we now develop the generating function formalism appropriate to random directed graphs with arbitrary degree distributions . A . Generating functions In a directed graph , each vertex has separate in - degree and out - degree for links running into and out of that ver - tex . Let us deﬁne p jk to be the probability that a ran - domly chosen vertex has in - degree j and out - degree k . It is important to realize that in general this joint dis - tribution of j and k is not equal to the product p j p k of the separate distributions of in - and out - degree . In the world - wide web , for example , it seems likely ( although this question has not been investigated to our knowledge ) that sites with a large number of outgoing links also have 9 a large number of incoming ones , i . e . , that j and k are correlated , so that p jk 6 = p j p k . We appeal to those work - ing on studies of the structure of the web to measure the joint distribution of in - and out - degrees of sites ; empiri - cal data on this distribution would make theoretical work much easier ! We now deﬁne a generating function for the joint prob - ability distribution of in - and out - degrees , which is nec - essarily a function of two independent variables , x and y , thus : G ( x , y ) = X jk p jk x j y k . ( 58 ) Since every edge on a directed graph must leave some ver - tex and enter another , the net average number of edges entering a vertex is zero , and hence p jk must satisfy the constraint X jk ( j − k ) p jk = 0 . ( 59 ) This implies that G ( x , y ) must satisfy ∂ G ∂x (cid:12)(cid:12)(cid:12)(cid:12) x , y = 1 = ∂ G ∂y (cid:12)(cid:12)(cid:12)(cid:12) x , y = 1 = z , ( 60 ) where z is the average degree ( both in and out ) of vertices in the graph . Using the function G ( x , y ) , we can , as before , deﬁne generating functions G 0 and G 1 for the number of out - going edges leaving a randomly chosen vertex , and the number leaving the vertex reached by following a ran - domly chosen edge . We can also deﬁne generating func - tions F 0 and F 1 for the number arriving at such a vertex . These functions are given by F 0 ( x ) = G ( x , 1 ) , F 1 ( x ) = 1 z ∂ G ∂y (cid:12)(cid:12)(cid:12)(cid:12) y = 1 , ( 61 ) G 0 ( y ) = G ( 1 , y ) , G 1 ( y ) = 1 z ∂ G ∂x (cid:12)(cid:12)(cid:12) (cid:12) x = 1 . ( 62 ) Once we have these functions , many results follow as be - fore . The average numbers of ﬁrst and second neighbors reachable from a randomly chosen vertex are given by Eq . ( 60 ) and z 2 = G ′ 0 ( 1 ) G ′ 1 ( 1 ) = ∂ 2 G ∂x∂y (cid:12)(cid:12)(cid:12)(cid:12) x , y = 1 . ( 63 ) These are also the numbers of ﬁrst and second neigh - bors from which a random vertex can be reached , since Eqs . ( 60 ) and ( 63 ) are manifestly symmetric in x and y . We can also make an estimate of the average path length on the graph from ℓ = log ( N / z 1 ) log ( z 2 / z 1 ) + 1 , ( 64 ) strongly connected component links out links in 1 2 FIG . 5 . The “bow - tie” diagram proposed by Broder et al . as a representation of the giant component of the world - wide web ( although it can be used to visualize any directed graph ) . as before . However , this equation should be used with caution . As discussed in Section II F , the derivation of this formula assumes that we are in a regime in which the bulk of the graph is reachable from most vertices . On a directed graph however , this may be far from true , as appears to be the case with the world - wide web [ 26 ] . The probability distribution of the numbers of vertices reachable from a randomly chosen vertex in a directed graph—i . e . , of the sizes of the out - components—is gen - erated by the function H 0 ( y ) = yG 0 ( H 1 ( y ) ) , where H 1 ( y ) is a solution of H 1 ( y ) = yG 1 ( H 1 ( y ) ) , just as before . ( A similar and obvious pair of equations governs the sizes of the in - components . ) The results for the asymptotic behavior of the component size distribution from Sec - tion II E generalize straightforwardly to directed graphs . The average out - component size for the case where there is no giant component is given by Eq . ( 31 ) , and thus the point at which a giant component ﬁrst appears is given once more by G ′ 1 ( 1 ) = 1 . Substituting Eq . ( 58 ) into this expression gives the explicit condition X jk ( 2 jk − j − k ) p jk = 0 ( 65 ) for the ﬁrst appearance of the giant component . This expression is the equivalent for the directed graph of Eq . ( 33 ) . It is also possible , and equally valid , to de - ﬁne the position at which the giant component appears by F ′ 1 ( 1 ) = 1 , which provides an alternative derivation for Eq . ( 65 ) . Just as with the individual in - and out - components for vertices , the size of the giant component on a directed graph can also be deﬁned in diﬀerent ways . The giant component can be represented using the “bow - tie” dia - gram of Broder et al . [ 26 ] , which we depict ( in simpli - ﬁed form ) in Fig . 5 . The diagram has three parts . The strongly connected portion of the giant component , rep - resented by the central circle , is that portion in which ev - ery vertex can be reached from every other . The two sides of the bow - tie represent ( 1 ) those vertices from which the strongly connected component can be reached but which it is not possible to reach from the strongly connected component and ( 2 ) those vertices which can be reached from the strongly connected component but from which it is not possible to reach the strongly connected compo - 10 1 10 number of accessible sites s 0 . 0001 0 . 001 0 . 01 0 . 1 1 fr e qu e n c y P s κ = κ c = 1 . 4427 κ = 0 . 8 κ = 0 . 5 FIG . 6 . The distribution P s of the numbers of vertices ac - cessible from each vertex of a directed graph with identically exponentially distributed in - and out - degree . The points are simulation results for systems of N = 1 000 000 vertices and the solid lines are the analytic solution . nent . The solution of Eqs . ( 34 ) and ( 35 ) with G 0 ( x ) and G 1 ( x ) deﬁned according to Eq . ( 62 ) gives the number of vertices , as a fraction of N , in the giant strongly con - nected component plus those vertices from which the gi - ant strongly connected component can be reached . Using F 0 ( x ) and F 1 ( x ) ( Eq . ( 61 ) ) in place of G 0 ( x ) and G 1 ( x ) gives a diﬀerent solution , which represents the fraction of the graph in the giant strongly connected component plus those vertices which can be reached from it . B . Simulation results We have performed simulations of directed graphs as a check on the results above . Generation of random di - rected graphs with known joint degree distribution p jk is somewhat more complicated than generation of undi - rected graphs discussed in Section II G . The method we use is as follows . First , it is important to ensure that the averages of the distributions of in - and out - degree of the graph are the same , or equivalently that p jk satisﬁes Eq . ( 59 ) . If this is not the case , at least to good approx - imation , then generation of the graph will be impossible . Next , we generate a set of N in / out - degree pairs ( j i , k i ) , one for each vertex i , according to the joint distribution p jk , and calculate the sums P i j i and P i k i . These sums are required to be equal if there are to be no dangling edges in the graph , but in most cases we ﬁnd that they are not . To rectify this we use a simple procedure . We choose a vertex i at random , discard the numbers ( j i , k i ) for that vertex and generate new ones from the distribu - tion p jk . We repeat this procedure until the two sums are found to be equal . Finally , we choose random in / out pairs of edges and join them together to make a directed graph . The resulting graph has the desired number of vertices and the desired joint distribution of in and out degree . We have simulated directed graphs in which the dis - tribution p jk is given by a simple product of indepen - dent distributions of in - and out - degree . ( As pointed out in Section III A , this is not generally the case for real - world directed graphs , where in - and out - degree may be correlated . ) In Fig . 6 we show results from simulations of graphs with identically distributed ( but independent ) in - and out - degrees drawn from the exponential distri - bution , Eq . ( 13 ) . For this distribution , solution of the critical - point equation G ′ 1 ( 1 ) = 1 shows that the giant component ﬁrst appears at κ c = [ log 2 ] − 1 = 1 . 4427 . The three curves in the ﬁgure show the distribution of num - bers of vertices accessible from each vertex in the graph for κ = 0 . 5 , 0 . 8 , and κ c . The critical distribution fol - lows a power - law form ( see Section II C ) , while the others show an exponential cutoﬀ . We also show the exact dis - tribution derived from the coeﬃcients in the expansion of H 1 ( x ) about zero . Once again , theory and simulation are in good agreement . A ﬁt to the distribution for the case κ = κ c gives a value of α = 1 . 50 ± 0 . 02 , in good agreement with Eq . ( 48 ) . IV . BIPARTITE GRAPHS The collaboration graphs of scientists , company direc - tors , and movie actors discussed in Section I are all ex - amples of bipartite graphs . In this section we study the theory of bipartite graphs with arbitrary degree distribu - tions . To be concrete , we will speak in the language of “actors” and “movies , ” but clearly all the developments here are applicable to academic collaborations , boards of directors , or any other bipartite graph structure . A . Generating functions and basic results Consider then a bipartite graph of M movies and N actors , in which each actor has appeared in an average of µ movies and each movie has a cast of average size ν actors . Note that only three of these parameters are independent , since the fourth is given by the equality µ M = ν N . ( 66 ) Let p j be the probability distribution of the degree of actors ( i . e . , of the number of movies in which they have appeared ) and q k be the distribution of degree ( i . e . , cast size ) of movies . We deﬁne two generating functions which generate these probability distributions thus : f 0 ( x ) = X j p j x j , g 0 ( x ) = X k q k x k . ( 67 ) 11 ( It may be helpful to think of f as standing for “ﬁlm , ” in order to keep these two straight . ) As before , we nec - essarily have f 0 ( 1 ) = g 0 ( 1 ) = 1 , f ′ 0 ( 1 ) = µ , g ′ 0 ( 1 ) = ν . ( 68 ) If we now choose a random edge on our bipartite graph and follow it both ways to reach the movie and actor which it connects , then the distribution of the number of other edges leaving those two vertices is generated by the equivalent of ( 9 ) : f 1 ( x ) = 1 µ f ′ 0 ( x ) , g 1 ( x ) = 1 ν g ′ 0 ( x ) . ( 69 ) Now we can write the generating function for the distri - bution of the number of co - stars ( i . e . , actors in shared movies ) of a randomly chosen actor as G 0 ( x ) = f 0 ( g 1 ( x ) ) . ( 70 ) If we choose a random edge , then the distribution of num - ber of co - stars of the actor to which it leads is generated by G 1 ( x ) = f 1 ( g 1 ( x ) ) . ( 71 ) These two functions play the same role in the one - mode network of actors as the functions of the same name did for the unipartite random graphs of Section II . Once we have calculated them , all the results from Section II follow exactly as before . The numbers of ﬁrst and second neighbors of a ran - domly chosen actor are z 1 = G ′ 0 ( 1 ) = f ′ 0 ( 1 ) g ′ 1 ( 1 ) , ( 72 ) z 2 = G ′ 0 ( 1 ) G ′ 1 ( 1 ) = f ′ 0 ( 1 ) f ′ 1 ( 1 ) [ g ′ 1 ( 1 ) ] 2 . ( 73 ) Explicit expressions for these quantities can be obtained by substituting from Eqs . ( 67 ) and ( 69 ) . The average vertex – vertex distance on the one - mode graph is given as before by Eq . ( 54 ) . Thus , it is possible to estimate average distances on such graphs by measuring only the numbers of ﬁrst and second neighbors . The distribution of the sizes of the connected compo - nents in the one - mode network is generated by Eq . ( 27 ) , where H 1 ( x ) is a solution of Eq . ( 26 ) . The asymptotic results of Section II E generalize simply to the bipartite case , and the average size of a connected component in the absence of a giant component is h s i = 1 + G ′ 0 ( 1 ) 1 − G ′ 1 ( 1 ) , ( 74 ) as before . This diverges when G ′ 1 ( 1 ) = 1 , marking the ﬁrst appearance of the giant component . Equivalently , the giant component ﬁrst appears when f ′′ 0 ( 1 ) g ′′ 0 ( 1 ) = f ′ 0 ( 1 ) g ′ 0 ( 1 ) . ( 75 ) Substituting from Eq . ( 67 ) , we then derive the explicit condition for the ﬁrst appearance of the giant component : X jk jk ( jk − j − k ) p j q k = 0 . ( 76 ) The size S of the giant component , as a fraction of the to - tal number N of actors , is given as before by the solution of Eqs . ( 34 ) and ( 35 ) . Of course , all of these results work equally well if “ac - tors” and “movies” are interchanged . One can calculate the average distance between movies in terms of common actors shared , the size and distribution of connected com - ponents of movies , and so forth , using the formulas given above , with only the exchange of f 0 and f 1 for g 0 and g 1 . The formula ( 75 ) is , not surprisingly , invariant under this interchange , so that the position of the onset of the giant component is the same regardless of whether one is looking at actors or movies . B . Clustering Watts and Strogatz [ 15 ] have introduced the concept of clustering in social networks , also sometimes called network transitivity . Clustering refers to the increased propensity of pairs of people to be acquainted with one another if they have another acquaintance in common . Watts and Strogatz deﬁned a clustering coeﬃcient which measures the degree of clustering on a graph . For our purposes , the deﬁnition of this coeﬃcient is C = 3 × number of triangles on the graph number of connected triples of vertices = 3 N △ N 3 . ( 77 ) Here “triangles” are trios of vertices each of which is con - nected to both of the others , and “connected triples” are trios in which at least one is connected to both the oth - ers . The factor of 3 in the numerator accounts for the fact that each triangle contributes to three connected triples of vertices , one for each of its three vertices . With this factor of 3 , the value of C lies strictly in the range from zero to one . In the directed and undirected unipartite random graphs of Sections II and III , C is trivially zero in the limit N → ∞ . In the one - mode projections of bi - partite graphs , however , both the actors and the movies can be expected to have non - zero clustering . We here treat the case for actors . The case for movies is easily derived by swapping f s and g s . An actor who has z ≡ z 1 co - stars in total contributes 12 z ( z − 1 ) connected triples to N 3 , so that N 3 = 12 N X z z ( z − 1 ) r z , ( 78 ) where r z is the probability of having z co - stars . As shown above ( Eq . ( 70 ) ) , the distribution r z is generated by G 0 ( x ) and so 12 N 3 = 12 NG ′′ 0 ( 1 ) . ( 79 ) A movie which stars k actors contributes 16 k ( k − 1 ) ( k − 2 ) triangles to the total triangle count in the one - mode graph . Thus the total number of triangles on the graph is the sum of 16 k ( k − 1 ) ( k − 2 ) over all movies , which is given by N △ = 16 M X k k ( k − 1 ) ( k − 2 ) q k = 16 Mg ′′′ 0 ( 1 ) . ( 80 ) Substituting into Eq . ( 77 ) , we then get C = M N g ′′′ 0 ( 1 ) G ′′ 0 ( 1 ) . ( 81 ) Making use of Eqs . ( 66 ) , ( 67 ) , and ( 70 ) , this can also be written as 1 C − 1 = ( µ 2 − µ 1 ) ( ν 2 − ν 1 ) 2 µ 1 ν 1 ( 2 ν 1 − 3 ν 2 + ν 3 ) , ( 82 ) where µ n = P k k n p k is the n th moment of the distribu - tion of numbers of movies in which actors have appeared , and ν n is the same for cast size ( number of actors in a movie ) . C . Example To give an example , consider a random bipartite graph with Poisson - distributed numbers of both movies per ac - tor and actors per movie . In this case , following the derivation of Eq . ( 12 ) , we ﬁnd that f 0 ( x ) = e µ ( x − 1 ) , g 0 ( x ) = e ν ( x − 1 ) , ( 83 ) and f 1 ( x ) = f 0 ( x ) and g 1 ( x ) = g 0 ( x ) . Thus G 0 ( x ) = G 1 ( x ) = e µ ( e ν ( x − 1 ) − 1 ) . ( 84 ) This implies that z 1 = µν and z 2 = ( µν ) 2 , so that ℓ = log N log µν = log N log z , ( 85 ) just as in an ordinary Poisson - distributed random graph . From Eq . ( 74 ) , the average size h s i of a connected com - ponent of actors , below the phase transition , is h s i = 1 1 − µν , ( 86 ) which diverges , yielding a giant component , at µν = z = 1 , also as in the ordinary random graph . From Eqs . ( 34 ) and ( 35 ) , the size S of the giant component as a fraction of N is a solution of S = 1 − e µ ( e − νS − 1 ) . ( 87 ) And from Eq . ( 81 ) , the clustering coeﬃcient for the one - mode network of actors is C = Mν 3 Nν 2 ( µ 2 + µ ) = 1 µ + 1 , ( 88 ) where we have made use of Eq . ( 66 ) . Another quantity of interest is the distribution of num - bers of co - stars , i . e . , of the numbers of people with whom each actor has appeared in a movie . As discussed above , this distribution is generated by the function G 0 ( x ) de - ﬁned in Eq . ( 70 ) . For the case of the Poisson degree dis - tribution , we can perform the derivatives , Eq . ( 4 ) , and setting x = 0 we ﬁnd that the probability r z of having appeared with a total of exactly z co - stars is r z = ν z z ! e µ ( e − ν − 1 ) z X k = 1 n z k o(cid:2) µ e − ν (cid:3) k , ( 89 ) where the coeﬃcients (cid:8) z k (cid:9) are the Stirling numbers of the second kind [ 46 ] n z k o = k X r = 1 ( − 1 ) k − r r ! ( k − r ) ! r z . ( 90 ) D . Simulation results Random bipartite graphs can be generated using an algorithm similar to the one described in Section III B for directed graphs . After making sure that the required degree distributions for both actor and movie vertices have means consistent with the required total numbers of actors and movies according to Eq . ( 66 ) , we generate vertex degrees for each actor and movie at random and calculate their sum . If these sums are unequal , we dis - card the degree of one actor and one movie , chosen at random , and replace them with new degrees drawn from the relevant distributions . We repeat this process until the total actor and movie degrees are equal . Then we join vertices up in pairs . In Fig . 7 we show the results of such a simulation for a bipartite random graph with Poisson degree distribution . ( In fact , for the particular case of the Poisson distribu - tion , the graph can be generated simply by joining up actors and movies at random , without regard for indi - vidual vertex degrees . ) The ﬁgure shows the distribution of the number of co - stars of each actor , along with the analytic solution , Eqs . ( 89 ) and ( 90 ) . Once more , numer - ical and analytic results are in good agreement . V . APPLICATIONS TO REAL - WORLD NETWORKS In this section we construct random graph models of two types of real - world networks , namely collaboration 13 0 20 40 60 80 100 number of costars z 0 . 00 0 . 01 0 . 02 0 . 03 0 . 04 fr e qu e n c y r z FIG . 7 . The frequency distribution of numbers of co - stars of an actor in a bipartite graph with µ = 1 . 5 and ν = 15 . The points are simulation results for M = 10 000 and N = 100 000 . The line is the exact solution , Eqs . ( 89 ) and ( 90 ) . The error bars on the numerical results are smaller than the points . graphs and the world - wide web , using the results of Sec - tions III and IV to incorporate realistic degree distribu - tions into the models . As we will show , the results are in reasonably good agreement with empirical data , although there are some interesting discrepancies also , perhaps in - dicating the presence of social phenomena that are not incorporated in the random graph . A . Collaboration networks In this section we construct random bipartite graph models of the known collaboration networks of company directors [ 29 – 31 ] , movie actors [ 15 ] , and scientists [ 36 ] . As we will see , the random graph works well as a model of these networks , giving good order - of - magnitude esti - mates of all quantities investigated , and in some cases giving results of startling accuracy . Our ﬁrst example is the collaboration network of the members of the boards of directors of the Fortune 1000 companies ( the one thousand US companies with the highest revenues ) . The data come from the 1999 For - tune 1000 [ 29 – 31 ] and in fact include only 914 of the 1000 , since data on the boards of the remaining 86 were not available . The data form a bipartite graph in which one type of vertex represents the boards of directors , and the other type the members of those boards , with edges connecting boards to their members . In Fig . 8 we show the frequency distribution of the numbers of boards on which each member sits , and the numbers of members of each board . As we see , the former distribution is close to exponential , with the majority of directors sitting on only one board , while the latter is strongly peaked around 10 , 0 2 4 6 8 number of boards 1 10 100 1000 10000 fr e qu e n c y 0 10 20 30 number of members 1 10 100 fr e qu e n c y FIG . 8 . Frequency distributions for the boards of directors of the Fortune 1000 . Left panel : the numbers of boards on which each director sits . Right panel : the numbers of direc - tors on each board . indicating that most boards have about 10 members . Using these distributions , we can deﬁne generating functions f 0 ( x ) and g 0 ( x ) as in Eq . ( 23 ) , and hence ﬁnd the generating functions G 0 ( x ) and G 1 ( x ) for the distributions of numbers of co - workers of the directors . We have used these generating functions and Eqs . ( 72 ) and ( 81 ) to calculate the expected clustering coeﬃcient C and the average number of co - workers z in the one - mode projection of board directors on a random bipar - tite graph with the same vertex degree distributions as the original dataset . In Table I we show the results of these calculations , along with the same quantities for the real Fortune 1000 . As the table shows the two are in remarkable—almost perfect—agreement . It is not just the average value of z that we can cal - culate from our generating functions , but the entire dis - tribution : since the generating functions are ﬁnite poly - nomials in this case , we can simply perform the deriva - tives to get the probability distribution r z . In Fig . 9 , we show the results of this calculation for the Fortune 1000 graph . The points in the ﬁgure show the actual distribu - tion of z for the real - world data , while the solid line shows clustering C average degree z network theory actual theory actual company directors 0 . 590 0 . 588 14 . 53 14 . 44 movie actors 0 . 084 0 . 199 125 . 6 113 . 4 physics ( arxiv . org ) 0 . 192 0 . 452 16 . 74 9 . 27 biomedicine ( MEDLINE ) 0 . 042 0 . 088 18 . 02 16 . 93 TABLE I . Summary of results of the analysis of four col - laboration networks . 14 0 10 20 30 40 50 number of codirectors z 0 . 00 0 . 05 0 . 10 fr e qu e n c y r z 0 0 . 01 0 . 02 fr e qu e n c y 0 10 20 30 40 50 collaborators 0 0 . 1 movies collaborationsin physics FIG . 9 . The probability distribution of numbers of co - directors in the Fortune 1000 graph . The points are the real - world data , the solid line is the bipartite graph model , and the dashed line is the Poisson distribution with the same mean . Insets : the equivalent distributions for the numbers of collaborators of movie actors and physicists . the theoretical results . Again the agreement is excellent . The dashed line in the ﬁgure shows the distribution for an ordinary Poisson random graph with the same mean . Clearly this is a signiﬁcantly inferior ﬁt . In fact , within the business world , attention has fo - cussed not on the collaboration patterns of company di - rectors , but on the “interlocks” between boards , i . e . , on the one - mode network in which vertices represent boards of directors and two boards are connected if they have one or more directors in common [ 28 , 29 ] . This is also simple to study with our model . In Fig . 10 we show the distri - bution of the numbers of interlocks that each board has , along with the theoretical prediction from our model . As we see , the agreement between empirical data and theory is signiﬁcantly worse in this case than for the distribution of co - directors . In particular , it appears that our theory signiﬁcantly underestimates the number of boards which are interlocked with very small or very large numbers of other boards , while over estimating those with interme - diate numbers of interlocks . One possible explanation of this is that “big - shots work with other big - shots . ” That is , the people who sit on many boards tend to sit on those boards with other people who sit on many boards . And conversely the people who sit on only one board ( which is the majority of all directors ) , tend to do so with others who sit on only one board . This would tend to stretch the distribution of numbers of interlocks , just as seen in ﬁgure , producing a disproportionately high number of boards with very many or very few interlocks to others . To test this hypothesis , we have calculated , as a function of the number of boards on which a director sits , the av - erage number of boards on which each of their codirectors 0 10 20 30 number of interlocks 0 . 00 0 . 02 0 . 04 0 . 06 0 . 08 0 . 10 0 . 12 p r ob a b ilit y 0 5 10 boards you sit on 0 1 2 3 bo a r d s c od i r ec t o r s s it on FIG . 10 . The distribution of the number of other boards with which each board of directors is “interlocked” in the Fortune 1000 data . An interlock between two boards means that they share one or more common members . The points are the empirical data , the solid line is the theoretical prediction . Inset : the number of boards on which one’s codirectors sit , as a function of the number of boards one sits on oneself . sit . The results are shown in the inset of Fig . 10 . If these two quantities were uncorrelated , the plot would be ﬂat . Instead , however , it slopes clearly upwards , indicating in - deed that on the average the big - shots work with other big - shots . ( This idea is not new . It has been discussed previously by a number of others—see Refs . [ 47 ] and [ 48 ] , for example . ) The example of the boards of directors is a particu - larly instructive one . What it illustrates is that the cases in which our random graph models agree well with real - world phenomena are not necessarily the most interest - ing . Certainly it is satisfying , as in Fig . 9 , to have the theory agree well with the data . But probably Fig . ( 10 ) is more instructive : we have learned something about the structure of the network of the boards of directors by observing the way in which the pattern of board inter - locks diﬀers from the predictions of the purely random network . Thus it is perhaps best to regard our random graph as a null model—a baseline from which our expec - tations about network structure should be measured . It is deviation from the random graph behavior , not agree - ment with it , that allows us to draw conclusions about real - world networks . We now look at three other graphs for which our theory also works well , although again there are some noticeable deviations from the random graph predictions , indicating the presence of social or other phenomena at work in the network . We consider the graph of movie actors and the movies in which they appear [ 15 , 49 ] and graphs of scientists and the papers they write in physics and biomedical re - 15 search [ 36 ] . In Table I we show results for the cluster - ing coeﬃcients and average coordination numbers of the one - mode projections of these graphs onto the actors or scientists . As the table shows , our theory gives results for these ﬁgures which are of the right general order of mag - nitude , but typically deviate from the empirically mea - sured ﬁgures by a factor of two or so . In the insets of Fig . 9 we show the distributions of numbers of collabo - rators in the movie actor and physics graphs , and again the match between theory and real data is good , but not as good as with the Fortune 1000 . The ﬁgures for clustering and mean numbers of col - laborators are particularly revealing . The former is uni - formly about twice as high in real life as our model pre - dicts for the actor and scientist networks . This shows that there is a signiﬁcant tendency to clustering in these networks , in addition to the trivial clustering one expects on account of the bipartite structure . This may indicate , for example , that scientists tend to introduce pairs of their collaborators to one another , thereby encouraging clusters of collaboration . The ﬁgures for average numbers of collaborators show less deviation from theory than the clustering coeﬃcients , but nonetheless there is a clear tendency for the numbers of collaborators to be smaller in the real - world data than in the models . This probably indicates that scientists and actors collaborate repeat - edly with the same people , thereby reducing their total number of collaborators below the number that would naively be expected if we consider only the numbers of papers that they write or movies they appear in . It would certainly be possible to take eﬀects such as these into account in a more sophisticated model of collaboration practices . B . The world - wide web In this section we consider the application of our theory of random directed graphs to the modeling of the world - wide web . As we pointed out in Section III A , it is not at present possible to make a very accurate random - graph model of the web , because to do so we need to know the joint distribution p jk of in - and out - degrees of vertices , which has not to our knowledge been measured . How - ever , we can make a simple model of the web by assum - ing in - and out - degree to be independently distributed according to their known distributions . Equivalently , we assume that the joint probability distribution factors ac - cording to p jk = p j q k . Broder et al . [ 26 ] give results showing that the in - and out - degree distributions of the web are approxi - mately power - law in form with exponents τ in = 2 . 1 and τ out = 2 . 7 , although there is some deviation from the perfect power law for small degree . In Fig . 11 , we show histograms of their data with bins chosen to be of uniform width on the logarithmic scales used . ( This avoids certain systematic errors known to aﬄict linearly histogrammed 1 10 100 1000 in−degree 10 0 10 2 10 4 10 6 10 8 nu m b e r o f p a g e s 1 10 100 1000 out−degree FIG . 11 . The probability distribution of in - degree ( left panel ) and out - degree ( right panel ) on the world - wide web , rebinned from the data of Broder et al . [ 26 ] . The solid lines are best ﬁts of form ( 91 ) . data plotted on log scales . ) We ﬁnd both distributions to be well - ﬁtted by the form p k = C ( k + k 0 ) − τ , ( 91 ) where the constant C is ﬁxed by the requirement of nor - malization , taking the value 1 / ζ ( τ , k 0 ) , were ζ ( x , y ) is the generalized ζ - function [ 46 ] . The constants k 0 and τ are found by least - squares ﬁts , giving values of 0 . 58 and 3 . 94 for k 0 , and 2 . 17 and 2 . 69 for τ , for the in - and out - degree distributions respectively , in reasonable agreement with the ﬁts performed by Broder et al . With these choices , the data and Eq . ( 91 ) match closely ( see Fig . 11 again ) . Neither the raw data nor our ﬁts to them satisfy the constraint ( 59 ) , that the total number of links leaving pages should equal the total number arriving at them . This is because the data set is not a complete picture of the web . Only about 200 million of the web’s one billion or so pages were included in the study . Within this sub - set , our estimate of the distribution of out - degree is pre - sumably quite accurate , but many of the outgoing links will not connect to other pages within the subset studied . At the same time , no incoming links which originate out - side the subset of pages studied are included , because the data are derived from “crawls” in which web pages are found by following links from one to another . In such a crawl one only ﬁnds links by ﬁnding the pages that they originate from . Thus our data for the incoming links is quite incomplete , and we would expect the total number of incoming links in the dataset to fall short of the num - ber of outgoing ones . This indeed is what we see . The totals for incoming and outgoing links are approximately 2 . 3 × 10 8 and 1 . 1 × 10 9 . The incompleteness of the data for incoming links lim - its the information we can at present extract from a ran - 16 dom graph model of the web . There are however some calculations which only depend on the out - degree distri - bution . Given Eq . ( 91 ) , the generating functions for the out - degree distribution take the form G 0 ( x ) = G 1 ( x ) = Φ ( x , τ , k 0 ) ζ ( τ , k 0 ) , ( 92 ) where Φ ( x , y , z ) is the Lerch Φ - function [ 46 ] . The cor - responding generating functions F 0 and F 1 we cannot calculate accurately because of the incompleteness of the data . The equality G 0 = G 1 ( and also F 0 = F 1 ) is a gen - eral property of all directed graphs for which p jk = p j q k as above . It arises because in such graphs in - and out - degree are uncorrelated , and therefore the distribution of the out - degree of a vertex does not depend on whether you arrived at it by choosing a vertex at random , or by following a randomly chosen edge . One property of the web which we can estimate from the generating functions for out - degree alone is the frac - tion S in of the graph taken up by the giant strongly con - nected component plus those sites from which the giant strongly connected component can be reached . This is given by S in = 1 − G 0 ( 1 − S in ) . ( 93 ) In other words , 1 − S in is a ﬁxed point of G 0 ( x ) . Using the measured values of k 0 and τ , we ﬁnd by numeri - cal iteration that that S in = 0 . 527 , or about 53 % . The direct measurements of the web made by Broder et al . show that in fact about 49 % of the web falls in S in , in reasonable agreement with our calculation . Possibly this implies that the structure of the web is close to that of a directed random graph with a power - law degree distri - bution , though it is possible also that it is merely coinci - dence . Other comparisons between random graph models and the web will have to wait until we have more accurate data on the joint distribution p jk of in - and out - degree . VI . CONCLUSIONS In this paper we have studied in detail the theory of random graphs with arbitrary distributions of vertex de - gree , including directed and bipartite graphs . We have shown how , using the mathematics of generating func - tions , one can calculate exactly many of the statistical properties of such graphs in the limit of large numbers of vertices . Among other things , we have given explicit formulas for the position of the phase transition at which a giant component forms , the size of the giant compo - nent , the average and distribution of the sizes of the other components , the average numbers of vertices a cer - tain distance from a given vertex , the clustering coeﬃ - cient , and the typical vertex – vertex distance on a graph . We have given examples of the application of our the - ory to the modeling of collaboration graphs , which are inherently bipartite , and the World - Wide web , which is directed . We have shown that the random graph theory gives good order - of - magnitude estimates of the properties of known collaboration graphs of business - people , scien - tists and movie actors , although there are measurable diﬀerences between theory and data which point to the presence of interesting sociological eﬀects in these net - works . For the web we are limited in what calculations we can perform because of the lack of appropriate data to determine the generating functions . However , the calcu - lations we can perform agree well with empirical results , oﬀering some hope that the theory will prove useful once more complete data become available . ACKNOWLEDGEMENTS The authors would like to thank Lada Adamic , Andrei Broder , Jon Kleinberg , and Cris Moore for useful com - ments and suggestions , and Jerry Davis , Paul Ginsparg , Oleg Khovayko , David Lipman , Grigoriy Starchenko , and Janet Wiener for supplying data used in this study . This work was funded in part by the National Science Foun - dation , the Army Research Oﬃce , the Electric Power Re - search Institute , and Intel Corporation . [ 1 ] B . Bollob´as , Random Graphs , Academic Press , New York ( 1985 ) . [ 2 ] P . Erd˝os and A . R´enyi , “On random graphs , ” Publica - tiones Mathematicae 6 , 290 – 297 ( 1959 ) . [ 3 ] P . Erd˝os and A . R´enyi , “On the evolution of random graphs , ” Publications of the Mathematical Institute of the Hungarian Academy of Sciences 5 , 17 – 61 ( 1960 ) . [ 4 ] P . Erd˝os and A . R´enyi , “On the strength of connect - edness of a random graph , ” Acta Mathematica Scientia Hungary 12 , 261 – 267 ( 1961 ) . [ 5 ] L . Sattenspiel and C . P . Simon , “The spread and per - sistence of infectious diseases in structured populations , ” Mathematical Biosciences 90 , 367 – 383 ( 1988 ) . [ 6 ] R . M . Anderson and R . M . May , “Susceptible – infectious – recovered epidemic models with dynamic partnerships , ” Journal of Mathematical Biology 33 , 661 – 675 ( 1995 ) . [ 7 ] M . Kretschmar and M . Morris , “Measures of concurrency in networks and the spread of infectious disease , ” Math - ematical Biosciences 133 , 165 – 195 ( 1996 ) . [ 8 ] D . D . Heckathorn , “Respondent - driven sampling : A new approach to the study of hidden populations , ” Social Problems 44 , 174 – 199 ( 1997 ) . [ 9 ] C . C . Foster , A . Rapoport , and C . J . Orwant , “A study of a large sociogram : Elimination of free parameters , ” Behavioural Science 8 , 56 – 65 ( 1963 ) . [ 10 ] T . J . Fararo and M . Sunshine , A study of a biased friend - ship network , Syracuse University Press , Syracuse , NY ( 1964 ) . 17 [ 11 ] H . R . Bernard , P . D . Kilworth , M . J . Evans , C . Mc - Carty , and G . A . Selley , “Studying social relations cross - culturally , ” Ethnology 2 , 155 – 179 ( 1988 ) . [ 12 ] J . Abello , A . Buchsbaum , and J . Westbrook , “A func - tional approach to external graph algorithms , ” in Pro - ceedings of the 6th European Symposium on Algorithms ( 2000 ) . [ 13 ] W . Aiello , F . Chung , and L . Lu , “A random graph model for massive graphs , ” in Proceedings of the 32nd Annual ACM Symposium on Theory of Computing ( 2000 ) . [ 14 ] L . A . N . Amaral , A . Scala , M . Barth´el´emy , and H . E . Stanley , “Classes of small - world networks , ” Proc . Natl . Acad . Sci . USA 97 , 11149 – 11152 ( 2000 ) . [ 15 ] D . J . Watts and S . H . Strogatz , “Collective dynamics of ‘small - world’ networks” , Nature 393 , 440 – 442 ( 1998 ) . [ 16 ] S . Jespersen , I . M . Sokolov , and A . Blumen , “Small - world Rouse networks as models of cross - linked polymers , ” J . Chem . Phys . 113 , 7652 – 7655 ( 2000 ) . [ 17 ] A . Scala , L . A . N . Amaral and M . Barth´el´emy , “Small - world networks and the conformation space of a lattice polymer chain , ” cond - mat / 0004380 . [ 18 ] D . Fell and A . Wagner , “The small world of metabolism , ” Nature Biotechnology 18 , 1121 – 1122 ( 2000 ) . [ 19 ] H . Jeong , B . Tombor , R . Albert , Z . N . Oltvai , and A . - L . Barab´asi , “The large - scale organization of metabolic networks , ” Nature 407 , 651 – 654 ( 2000 ) . [ 20 ] R . J . Williams and N . D . Martinez , “Simple rules yield complex food webs , ” Nature 404 , 180 – 183 ( 2000 ) . [ 21 ] J . M . Montoya and R . V . Sol´e , “Small world patterns in food webs , ” cond - mat / 0011195 . [ 22 ] A . - L . Barab´asi and R . Albert , “Emergence of scaling in random networks , ” Science 286 , 509 – 512 ( 1999 ) . [ 23 ] R . Albert , H . Jeong , and A . - L . Barab´asi , “Diameter of the world - wide web , ” Nature 401 , 130 – 131 ( 1999 ) . [ 24 ] B . A . Huberman and L . A . Adamic , “Growth dynamics of the world - wide web , ” Nature 401 , 131 ( 1999 ) . [ 25 ] J . M . Kleinberg , S . R . Kumar , P . Raghavan , S . Ra - jagopalan , and A . Tomkins , “The web as a graph : Mea - surements , models , and methods , ” in Lecture Notes in Computer Science , No . 1627 , T . Asano , H . Imai , D . T . Lee , S . - I . Nakano , and T . Tokuyama ( eds . ) , Springer - Verlag , Berlin ( 1999 ) . [ 26 ] A . Broder , R . Kumar , F . Maghoul , P . Raghavan , S . Ra - jagopalan , R . Stata , A . Tomkins , and J . Wiener , “Graph structure in the web , ” Computer Networks 33 , 309 – 320 ( 2000 ) . [ 27 ] M . Faloutsos , P . Faloutsos , and C . Faloutsos , “On power - law relationships of the internet topology , ” Comp . Comm . Rev . 29 , 251 – 262 ( 1999 ) . [ 28 ] P . Mariolis , “Interlocking directorates and control of cor - porations , ” Social Science Quarterly 56 , 425 – 439 ( 1975 ) . [ 29 ] G . F . Davis , “The signiﬁcance of board interlocks for corporate governance , ” Corporate Governance 4 , 154 – 159 ( 1996 ) . [ 30 ] G . F . Davis and H . R . Greve , “Corporate elite networks and governance changes in the 1980s , ” American Journal of Sociology 103 , 1 – 37 ( 1997 ) . [ 31 ] G . F . Davis , M . Yoo , and W . E . Baker , “The small world of the corporate elite , ” preprint , University of Michigan Business School ( 2001 ) . [ 32 ] B . Kogut and G . Walker , “The small world of ﬁrm own - ership in Germany : Social capital and structural holes in large ﬁrm acquisitions – 1993 - 1997 , ” Working paper , Regi - nald H . Jones Center , Wharton School ( 1999 ) . [ 33 ] J . W . Grossman and P . D . F . Ion , “On a portion of the well - known collaboration graph , ” Congressus Numeran - tium 108 , 129 – 131 ( 1995 ) . [ 34 ] R . De Castro and J . W . Grossman , “Famous trails to Paul Erd˝os , ” Mathematical Intelligencer 21 , 51 – 63 ( 1999 ) . [ 35 ] V . Batagelj and A . Mrvar , “Some analyses of Erd˝os col - laboration graph , ” Social Networks 22 , 173 – 186 ( 2000 ) . [ 36 ] M . E . J . Newman , “The structure of scientiﬁc collabora - tion networks , ” Proc . Natl . Acad . Sci . USA 98 , 409 – 415 ( 2001 ) . [ 37 ] M . E . J . Newman , “A study of scientiﬁc collaboration networks : I . Network construction and fundamental re - sults , ” Phys . Rev . E , in press ; “A study of scientiﬁc col - laboration networks : II . Shortest paths , weighted net - works , and centrality , ” Phys . Rev . E , in press . [ 38 ] S . Wasserman and K . Faust , Social Network Analysis , Cambridge University Press , Cambridge ( 1994 ) . [ 39 ] M . Molloy and B . Reed , “A critical point for random graphs with a given degree sequence , ” Random Structures and Algorithms 6 , 161 – 179 ( 1995 ) . [ 40 ] M . Molloy and B . Reed , “The size of the giant compo - nent of a random graph with a given degree sequence , ” Combinatorics , Probability and Computing 7 , 295 – 305 ( 1998 ) . [ 41 ] H . S . Wilf , Generatingfunctionology , 2nd Edition , Aca - demic Press , London ( 1994 ) . [ 42 ] C . Moore and M . E . J . Newman , “Exact solution of site and bond percolation on small - world networks , ” Phys . Rev . E 62 , 7059 – 7064 ( 2000 ) . [ 43 ] G . H . Hardy and J . E . Littlewood , “Tauberian theorems concerning power series and Dirichlet’s series whose coef - ﬁcients are positive , ” Proc . London Math . Soc . 13 , 174 – 191 ( 1914 ) . [ 44 ] M . E . J . Newman and G . T . Barkema , Monte Carlo Methods in Statistical Physics , Oxford University Press , Oxford ( 1999 ) . [ 45 ] Note that one must use log ( 1 − r ) in this expression , and not log r , even though one might expect the two to give the same result . The reason is that r can be zero where 1 − r cannot . With the standard 32 - bit random number generators used on most computers , r will be zero about once in every 4 billion calls , and when it is , calculating log r will give an error but log ( 1 − r ) will not . For simu - lations on large graphs of a few million vertices or more this will happen with some frequency , and calculation of log r should therefore be avoided . [ 46 ] M . Abramowitz and I . Stegun , Handbook of Mathematical Functions , Dover , New York ( 1965 ) . [ 47 ] B . Mintz and M . Schwartz , The Power Structure of American Business , University of Chicago Press , Chicago ( 1985 ) . [ 48 ] G . F . Davis and M . S . Mizruchi , “The money center can - not hold : Commercial banks in the U . S . system of corpo - rate governance , ” Administrative Science Quarterly 44 , 215 – 239 ( 1999 ) . 18 [ 49 ] The ﬁgures given in our table diﬀer from those given by Watts and Strogatz in Ref . [ 15 ] because we use a more re - cent version of the actor database . Our version dates from May 1 , 2000 and contains about 450 000 actors , whereas the 1998 version contained only about 225 000 . 19
Ecology , 91 ( 1 ) , 2010 , pp . 299 – 305 (cid:2) 2010 by the Ecological Society of America A distance - based framework for measuring functional diversity from multiple traits E TIENNE L ALIBERTE´ 1 , 3 AND P IERRE L EGENDRE 2 1 School of Forestry , University of Canterbury , Private Bag 4800 , Christchurch 8140 New Zealand 2 De´partement de Sciences Biologiques , Universite´ de Montre´al , C . P . 6128 , Succursale Centre - Ville , Montre´al H3C3J7 Canada Abstract . A new framework for measuring functional diversity ( FD ) from multiple traits has recently been proposed . This framework was mostly limited to quantitative traits without missing values and to situations in which there are more species than traits , although the authors had suggested a way to extend their framework to other trait types . The main purpose of this note is to further develop this suggestion . We describe a highly ﬂexible distance - based framework to measure different facets of FD in multidimensional trait space from any distance or dissimilarity measure , any number of traits , and from different trait types ( i . e . , quantitative , semi - quantitative , and qualitative ) . This new approach allows for missing trait values and the weighting of individual traits . We also present a new multidimensional FD index , called functional dispersion ( FDis ) , which is closely related to Rao’s quadratic entropy . FDis is the multivariate analogue of the weighted mean absolute deviation ( MAD ) , in which the weights are species relative abundances . For unweighted presence – absence data , FDis can be used for a formal statistical test of differences in FD . We provide the ‘‘FD’’ R language package to easily implement our distance - based FD framework . Key words : functional composition ; functional dispersion ; functional divergence ; functional diversity ; functional evenness ; functional identity ; functional richness ; functional trait ; multivariate dispersion . I NTRODUCTION Functional diversity ( FD ) is a key driver of ecosystem processes ( Hooper et al . 2005 ) , ecosystem resilience to environmental change ( Folke et al . 2004 ) , and ecosystem services ( Dı´az et al . 2007 ) . This has led to the development of several indices for measuring FD ( e . g . , Petchey and Gaston 2002 , Botta - Duka´t 2005 ) . Recently , Ville´ger et al . ( 2008 ) have proposed three multidimen - sional functional diversity ( FD ) indices for continuous functional traits , each exploring a different aspect of FD : functional richness ( FRic ) , functional evenness ( FEve ) , and functional divergence ( FDiv ) . We fully agree with them that exploring different facets of FD in multidimensional trait space , as they proposed , offers a meaningful framework for measuring FD . That being said , their framework was mostly limited to quantitative traits without missing values and to situations where there are more species than traits , although they had suggested a way to extend their framework to other trait types . The main purpose of this note is to further develop this suggestion , highlighting its strengths and pitfalls . First , we illustrate how the original framework of Ville´ger et al . ( 2008 ) can be generalized to a highly ﬂexible distance - based framework to measure FD from any distance or dissimilarity measure , any number of traits ( including more traits than species ) , and from different types of traits ( i . e . , quantitative , semi - quanti - tative , and / or qualitative ) , while tolerating missing trait values and allowing the weighting of individual traits . This is a signiﬁcant improvement over their original framework , which could only deal with quantitative traits , did not allow the use of only one trait or of more traits than species , did not tolerate missing trait values , and did not directly allow the weighting of individual traits . We also propose a new and intuitive multidimensional FD index , called functional dispersion ( FDis ) , which presents several desirable properties . FDis is the mean distance in multidimensional trait space of individual species to the centroid of all species ; it can account for species abundances by shifting the position of the centroid toward the more abundant species and weighting distances of individual species by their relative abundances . FDis is the multivariate analogue of the weighted mean absolute deviation ( MAD ) ; this makes the new index unaffected by species richness by construction . Manuscript received 4 December 2008 ; revised 16 April 2009 ; accepted 20 April 2009 . Corresponding Editor : N . J . Gotelli . 3 E - mail : etiennelaliberte @ gmail . com January 2010 299 NOTES January 2010 299 NOTES In order for our distance - based FD framework to be easily implemented , we have developed the ‘‘FD’’ R language package ( available online ) 4 for computing the FRic , FEve , and FDiv indices of Ville´ger et al . ( 2008 ) and our own FDis index under this framework , as well as three other FD indices : the community - level weighted means of trait values ( CWM ; Lavorel et al . 2008 ) , Rao’s quadratic entropy ( Rao 1982 , Botta - Duka´t 2005 ) , and functional group richness ( FGR ) based on a posteriori functional classiﬁcations ( Petchey and Gaston 2006 ) . The ﬂexibility of our distance - based FD framework and its easy implementation in the ‘‘FD’’ package should greatly facilitate the measurement of FD for a wide range of ecological applications . G ENERALIZATION TO A F LEXIBLE D ISTANCE - BASED F UNCTIONAL D IVERSITY ( FD ) F RAMEWORK Ville´ger et al . ( 2008 ) suggested that ordination should be used when there are more traits than species ( a situation that cannot be handled by their functional richness [ FRic ] and functional divergence [ FDiv ] indices ) or when qualitative traits are present . In particular , they proposed to use the principal coordinate analysis ( PCoA ) axes from a Gower dissimilarity matrix ( Gower 1971 ) among the species as the new traits to compute their FD indices when there are qualitative traits in the original ( species 3 trait ) matrix . We add that it is also useful when some traits are semi - quantitative , when missing trait values are present , and when individual traits need to be weighted differently , because the Gower dissimilarity index can handle all of these situations ( Gower 1971 , Legendre and Legendre 1998 , Podani 1999 ) . That being said , Ville´ger et al . ( 2008 ) did not provide any details on how this approach should be implement - ed . We believe that this is needed in order to better highlight its strengths and pitfalls . This is especially relevant given that the situations already listed here ( i . e . , presence of qualitative and semi - quantitative traits , and / or missing values ) are likely to be common in functional trait data sets . For example , about one - third of all plant functional traits from the standard list of Cornelissen et al . ( 2003 ) are qualitative or semi - quantitative . The original FD framework of Ville´ger et al . ( 2008 ) can actually be generalized to a ﬂexible distance - based FD framework in which ( 1 ) any appropriate distance measure of choice is computed from the ( species 3 trait ) matrix , ( 2 ) this distance matrix is analyzed through PCoA , and ( 3 ) the resulting PCoA axes are used as the new traits to compute the FD indices . In that view , the original approach of Ville´ger et al . ( 2008 ) simply represents the particular case where all traits are quantitative and where the Euclidean distance is used . To be fair to them , our distance - based framework is in line with what they proposed , i . e . , to use the ( standard - ized ) traits directly to compute FD if all traits are quantitative , or to use the PCoA axes of a Gower dissimilarity matrix if some traits are qualitative ( in the Gower dissimilarity , quantitative traits are ranged in the [ 0 – 1 ] interval instead of being standardized ) . We simply highlight that any distance measure can actually be used , not only the Euclidean distance or the Gower dissim - ilarity . Although we contend that one of these two measures ( Euclidean and Gower ) will be appropriate in many situations , other measures may be preferred for particular applications . For example , other dissimilarity measures can accommodate different types of variables and missing values ( Estabrook and Rogers 1966 , Pavoine et al . 2009 ) . Such a distance - based framework is not new for the analysis of ecological data . For example , the use of PCoA axes as variables has already been presented in the context of multivariate analysis of variance ( Legen - dre and Anderson 1999 ) and general discriminant analysis ( Anderson and Robinson 2003 ) . This previous work has pointed out an important issue that needs to be considered when using that approach , but which Ville´ger et al . ( 2008 ) have not mentioned : what should we do if PCoA returns negative eigenvalues ? Indeed , some distance matrices will not allow the distance relationships among the objects to be fully represented in a Euclidean space ( Gower 1982 ) . This problem can result from the use of a semimetric or nonmetric distance measure or from the presence of missing values ( Legendre and Legendre 1998 ) ; it can even arise with most of the metric distance measures ( Gower 1982 ) . In all these cases , PCoA can return negative eigenvalues . The corresponding PCoA axes are not real , and therefore cannot be used as traits to compute FD . If one ignores these imaginary axes and uses only the ones with positive eigenvalues , not all the variation of the original trait data is represented , leading to biased estimates of FD . Three correction methods are available ( Legendre and Legendre 1998 ) . The ﬁrst two consist of adding the smallest possible constant to either the distances ( Cailliez 1983 ) or the squared distances ( Lingoes 1971 , Gower and Legendre 1986 ) so that all negative eigenvalues are eliminated . The third one , which does not work for all coefﬁcients , consists of taking the square root of the distances ( see Legendre and Legendre 1998 : Table 7 . 2 ) . More details on these corrections methods can be found in Legendre and Anderson ( 1999 ) . Another potential pitfall regarding the use of PCoA axes as traits concerns the standardization of traits . Ville´ger et al . ( 2008 ) suggested standardizing traits in order to make them dimensionally homogeneous and to put equal weight to each trait in the estimation of FD . 4 h http : / / cran . r - project . org / web / packages / FD i NOTES 300 Ecology , Vol . 91 , No . 1 This is a sensible suggestion given that we rarely know a priori if some traits are more important than others . As such , the R code that they provided ( available online ) 5 to compute their FD indices automatically standardizes each trait , without allowing the user to choose otherwise . However , it is crucial that the PCoA axes are not standardized prior to the estimation of FD . In a distance - based approach , if traits are to be standardized , this needs to be done prior to computing the ( species 3 species ) distance matrix . PCoA axes are scaled to lengths equal to the square roots of their eigenvalues , or in other words to variances equal to the PCoA eigenvalues divided by ( n (cid:2) 1 ) : the ﬁrst axis always represents the largest proportion of variation , while the additional axes represent progres - sively smaller amounts of variation . Therefore , standard - izing the PCoA axes prior to the estimation of FD would give equal weight to each PCoA axis , which in turn would distort trait space , leading to incorrect estimates of FD . It would be unfair to blame Ville´ger et al . ( 2008 ) for this potential pitfall , as they never mentioned whether PCoA axes should be standardized or not when they are to be used as traits . However , we believe that their silence on the issue , coupled with the fact that their code automatically standardizes traits before computing their FD indices , could have led users to miscalculate FD . Our new ‘‘FD’’ package ( available online ; see footnote 4 ) avoids this potential pitfall . W EIGHTING THE T RAITS Ville´ger et al . ( 2008 ) have suggested standardizing all traits to mean 0 and unit variance to give the same weight to each trait in functional diversity ( FD ) estimation . As mentioned previously , this is justiﬁed by the fact that we rarely know a priori which traits are the most important . Nonetheless , weighting of individ - ual traits can a useful tool for FD estimation and has been identiﬁed as an important area for future FD research ( Petchey and Gaston 2006 ) . The Gower dissimilarity index can be programmed to provide different weightings to descriptors of mixed types , as suggested by Legendre and Legendre ( 1998 ) . Our ‘‘FD’’ package ( see footnote 4 ) includes the ‘‘gowdis’’ function to compute the Gower dissimilarity coefﬁcient , with options to assign different weights to individual descriptors and to treat semi - quantitative variables as described by Podani ( 1999 ) . This coefﬁcient is the default used in the ‘‘dbFD’’ function of the ‘‘FD’’ package to measure FD under our distance - based framework when some traits are semi - quantitative and / or qualitative , or when weights are speciﬁed . There is at least one obvious case where different weightings would be required for adequately estimating FD . When , for a given qualitative trait ( e . g . , for ﬂowering plants , pollinator type ) , an individual species can have more than one attribute ( e . g . , bees , ﬂies , moths ) , this trait is typically reclassiﬁed into as many binary ( 0 , 1 ) variables as there are individual attributes for that trait ( e . g . , bee pollinated , ﬂy pollinated , moth pollinated ) . However , doing so artiﬁcially increases the weight given to that trait relative to other traits . A sensible solution is to give a weight w i ¼ x i / b i to each binary variable required to reclassify the trait , where x i is the original weight given to trait i , and b i is the number of binary variables required to re - code trait i . F UNCTIONAL D ISPERSION One very intuitive measure of functional diversity ( FD ) for a community of S species on which T quantitative traits were measured is the dispersion ( i . e . , spread ) of the S species in the T - dimensional space . In univariate statistics , dispersion can be estimated by measures such as the mean absolute deviation , the sum of squared deviations from the mean ( SS ) , the variance , the standard deviation , or the range , among others . Ville´ger et al . ( 2008 ) proposed a valuable framework to explore distinct facets of FD , but only their functional richness ( FRic ) index can estimate the dispersion of species in trait space . It does so through the volume of the minimum convex hull that includes all species , which itself is a multivariate analogue of the range . Although FRic is clearly useful , it is well known that the range is not a reliable estimator of dispersion because it is highly sensitive to outliers . In addition , FRic cannot integrate information on relative abundances . Consequently , rare species with extreme trait values will greatly inﬂate FRic . This may or may not be a desirable property , depending on the application . On the other hand , the functional evenness ( FEve ) and functional divergence ( FDiv ) indices of Ville´ger et al . ( 2008 ) are interesting and can take into account the relative abundances of the species , but they do not estimate the dispersion of species in trait space . Indeed , they focus on the distribution of species within the convex hull independently of its actual volume ( see Appendix A ) . Hence the development of a reliable estimate of functional dispersion that could also consider species relative abundances would be useful . We suggest using multivariate dispersion ( Anderson et al . 2006 ) as a multidimensional index of functional dispersion ( FDis ) . In that view , FDis is the mean distance of individual species to the centroid of all species in the community ( Fig . 1a ) . Details on how to compute multivariate dispersions in PCoA space from any distance or dissimilarity measure and how to correct for negative eigenvalues are given by Anderson ( 2006 ) . FDis can account for relative abundances by computing the weighted centroid of the X ¼ [ x ij ] ( species 3 trait ) matrix in the following way : c ¼ ½ c i (cid:3) ¼ X a j x ij X a j 5 h http : / / www . ecolag . univ - montp2 . fr / software i January 2010 301 NOTES where c is the weighted centroid in the i - dimensional space , a j the abundance of species j , and x ij the attribute of species j for trait i ( Fig . 1b ) . This implies that traits are quantitative , but we described in the Generalization to a ﬂexible distance - based functional diversity ( FD ) framework section how other trait types ( i . e . , semi - quantitative , qualitative ) can be handled as well through principal coordinate analysis ( PCoA ) . FDis , the weight - ed mean distance ¯z to the weighted centroid c , is then computed as FDis ¼ X a j z j X a j where a j is the abundance of species j and z j is the distance of species j to the weighted centroid c . These two modiﬁcations over Anderson’s ( 2006 ) procedure essentially shift the position of the centroid toward the more abundant species and weigh distances of individual species to this weighted centroid by their relative abundances ( Fig . 1b ) . When all species have equal abundances ( i . e . , presence – absence data ; Fig . 1a ) , FDis is simply the unweighted mean distance to the centroid as originally described by Anderson ( 2006 ) . FDis has no upper limit and requires at least two species to be computed . For communities composed of only one species , we suggest that FDis should be 0 . We ran simulations to compare FDis to the FD indices of Ville´ger et al . ( 2008 ) and to Rao’s quadratic entropy Q ( Rao 1982 , Botta - Duka´t 2005 , Ricotta 2005 ) , a popular multidimensional FD index that is conceptually similar to FDis and can also account for species relative abundances . To do so , we created 20 000 artiﬁcial communities of 5 – 100 species drawn from a common pool of 500 species via the ‘‘simul . dbFD’’ function of our ‘‘FD’’ package . Values for three functional traits were generated following a normal distribution . Relative abundances were generated from a lognormal distribu - tion . FDis was moderately positively related to FRic ( r ¼ 0 . 425 , Fig . 2a ) and FDiv ( r ¼ 0 . 475 , Fig . 2b ) , and weakly with FEve ( r ¼ 0 . 214 , Fig . 2c ) . On the other hand , FDis showed a strong positive linear relationship with Rao’s Q ( r ¼ 0 . 966 , Fig . 2d ) . Both FDis and Rao’s Q were little inﬂuenced by species richness ( FDis , r ¼ 0 . 274 , Fig . 2e ; Rao’s Q , r ¼ 0 . 264 , Fig . 2f ) . For completeness , we repeated our simulations with presence – absence data ( Appendix B ) . Results were very similar , with the exception that FDiv and FEve were less associated with FDis ( r ¼ 0 . 110 and r ¼ 0 . 131 , respectively ) . The strong positive correlation between FDis and Rao’s Q was expected given that both indices aim at estimating the dispersion of species in trait space , weighted by their relative abundances . However , they do so differently . When abundances are frequencies ( i . e . , counts of individuals ) , Rao’s Q expresses the mean distance between two randomly selected individuals ( Botta - Duka´t 2005 ) . On the other hand , FDis is the weighted mean distance of individual species to their weighted centroid , where weights are their relative abundances ( Fig . 1 ) ; this is the multivariate analogue of the weighted mean absolute deviation ( MAD ) . Although both indices are clearly associated , one potential advantage of FDis over Rao’s Q is that in the unweighted case ( i . e . , with presence – absence data ) , it opens possibil - ities for formal statistical tests for differences in FD between two or more communities through a distance - based test for homogeneity of multivariate dispersions ( Anderson 2006 ) , which itself is a multivariate extension of Levene’s ( 1960 ) test on absolute deviations . FDis is , by construction , unaffected by species richness , can be computed from any distance or dissimilarity measure ( Anderson et al . 2006 ) , can handle any number and type of traits ( including more traits than species ) , is not strongly inﬂuenced by outliers , and can take into account species relative abundances . FDis also satisﬁes all criteria but the ﬁrst one ( i . e . , to be constrained between 0 and 1 for convenience ) of Mason et al . ( 2003 ) if traits are standardized prior to its computation ( see Appendix C ) . FDis does not satisfy F IG . 1 . An example showing how functional dispersion ( FDis ) is computed . The n individual species in a two - dimensional trait space are represented by black circles whose sizes are proportional to their abundances . Vector x j represents the position of species j , vector c is the centroid of the n species ( white square ) , z j is the distance of species j to centroid c , and a j is the abundance of species j . In panel ( a ) , all species have equal abundances ( i . e . , presence – absence data ) . In that case , c ¼ [ c i ] , where c i is the mean value of trait i , and FDis is the mean of distances z of individual species to c . In panel ( b ) , species have different abundances . In that case , the position of c is weighted by the species relative abundances , such that it shifts toward the more abundant species . Individual distances z of species to c are weighted by their relative abundances to compute FDis . NOTES 302 Ecology , Vol . 91 , No . 1 the set monotonicity criterion ( i . e . , a subset of a community should be no more diverse than the whole community ) of Ricotta ( 2005 ) because removing species that are close to the centroid effectively increases the dispersion of species in trait space . This represents an interesting ecological signal , not a methodological artifact . In our simulations ( Fig . 2 ) , FDis satisﬁed the set concavity criterion of Ricotta ( 2005 ) , since the total c diversity of the pooled set of communities was greater ( FDis c ¼ 1 . 584 ) than the mean a - diversity of all communities ( FDis ¯ a ¼ 1 . 519 ) . Further investigation is required to conﬁrm whether this property can be generalized . B RIDGING THE G AP BETWEEN T HEORY AND P RACTICE For a functional diversity ( FD ) framework to be most useful it has to be easily implemented by ecologists , if possible with freely available software . As such , we applaud the efforts made by Ville´ger et al . ( 2008 ) to provide the code to compute their FD indices in the freely available R language environment ( R Develop - ment Core Team 2009 ) . Likewise , we provide the ‘‘FD’’ R package ( see footnote 4 ) to easily implement our distance - based FD framework . Our ‘‘FD’’ package includes numerous elements of ﬂexibility ( see Appendix D ) . First , whereas the ‘‘F _ RED’’ function of Ville´ger et al . ( 2008 ) only allowed quantitative traits to be used , the F IG . 2 . Simulation results ( 20000 communities ) showing ( a ) the relationships between FRic and FDis , ( b ) FDiv and FDis , ( c ) FEve and FDis , ( d ) Rao’s Q and FDis , ( e ) species richness and FDis , and ( f ) species richness and Rao’s Q . January 2010 303 NOTES ‘‘dbFD’’ function of our ‘‘FD’’ package allows for a wide range of input options , including the use of a ( species 3 species ) distance matrix . Second , ‘‘F _ RED’’ did not allow the use of more traits than species for any of the three FD indices it returned . For FRic and FDiv , this was supported by the fact that no convex hull can be computed when there are more dimensions ( i . e . , traits ) than points ( i . e . , species ) , but this was unnecessary for FEve , which does not have that limitation . Our ‘‘dbFD’’ function can deal with any number of traits . Indeed , more traits than species can always be used for FDis and FEve . For FRic and FDiv , when the goal is to compare several communities , this problem is elegantly solved by selecting a subset of principal coordinate analysis ( PCoA ) axes such that T ¼ S min (cid:2) 1 , where S min is the number of species in the community with the fewest species and T the number of PCoA axes to be used as traits . However , doing so entails dimensionality reduc - tion , which implies some loss of information . Such information loss can be quantiﬁed via the R 2 - like ratio in PCoA ( Legendre and Legendre 1998 ) . Third , in ‘‘dbFD , ’’ FRic is generally measured as the convex hull volume , but when there is only one quantitative trait it is measured as the range . For a single semi - quantitative trait , FRic is the range of the ranks . Conversely , when only qualitative and semi - quantitative traits are present , FRic is measured as the number of unique trait - value combinations in a community . We added other multidimensional FD indices in our ‘‘FD’’ package . The community - level weighted means of trait values ( CWM ) is a direct extension of the ‘‘biomass ratio hypothesis’’ ( Grime 1998 ) and represents function - al composition ( sometimes called functional identity ) . Because functional composition has been shown to be a key driver of ecosystem processes ( e . g . , Mokany et al . 2008 ) , we felt that the inclusion of CWM was important . CWM can be multidimensional , as it is a vector containing as many elements as there are traits . When the goal is to compare several communities , PCoA axes could be computed from the CWM data , using an appropriate distance measure , and these axes could be used as an index of functional composition . As previously mentioned , correction for negative eigenval - ues may be necessary . Multivariate analyses could then be used to compare functional composition between groups of communities ( e . g . , Legendre and Anderson 1999 ) or to carry out spatial analysis of functional diversity ( Legendre et al . 2005 ) . As far as we know , CWM has been used strictly for quantitative traits , but our ‘‘FD’’ package extends it to qualitative and semi - quantitative traits . Another addition is functional group richness ( FGR ) , which is computed from an a posteriori classiﬁcation of species based on their functional traits ( i . e . , the ‘‘data - deﬁned’’ approach of Gitay and Noble [ 1997 ] ) . This differs from commonly used a priori classiﬁcations such as C 4 grasses , C 3 grasses , or legumes ( e . g . , Tilman et al . 1997 ) , which generally follow a ‘‘deductive approach’’ ( Gitay and Noble 1997 ) . FGR computed from a priori functional classiﬁcations has been shown to be a poor predictor of ecosystem processes ( Wright et al . 2006 , Mokany et al . 2008 ) , yet it is unclear whether this also applies to a posteriori classiﬁcations . It may turn out to be so , in which case FGR could still be useful for descriptive purposes . C ONCLUSION Ville´ger et al . ( 2008 ) have set the stage well for the development of a multidimensional and multifaceted framework for functional ecology . The purpose of this note was to improve their framework . First , we described how the approach of Ville´ger et al . ( 2008 ) could be generalized to a ﬂexible distance - based functional diversity ( FD ) framework . Second , we presented a new FD index , functional dispersion ( FDis ) . FDis is the weighted mean distance in multidimensional trait space of individual species to the weighted centroid of all species , where weights correspond to the relative abundances of the species . Finally , we provided the ‘‘FD’’ R language package ( see footnote 4 ) to easily implement our distance - based FD framework . We believe that our distance - based FD framework and our code represent signiﬁcant improvements over the orig - inal approach described by Ville´ger et al . ( 2008 ) , yet we see it simply as a second step and believe that our contribution can certainly be improved upon in the future . We will welcome suggestions to make our distance - based FD framework , and its implementation in our ‘‘FD’’ package , even more useful and ﬂexible . Doing so will help in increasing the ability of ecologists to understand and predict the functional consequences of human - induced changes in biodiversity , a major contemporary goal for ecology . A CKNOWLEDGMENTS We thank A . Paquette , M . J . Anderson , and D . Driscoll for helpful discussions , and S . Ville´ger and N . G . Swenson for comments on a previous version of the manuscript . During the writing of this manuscript , E . Laliberte´ was supported by doctoral scholarships from the University of Canterbury , the Fonds Que´be´cois de Recherche sur la Nature et les Technol - ogies ( FQRNT ) , and Education New Zealand . L ITERATURE C ITED Anderson , M . J . 2006 . Distance - based tests for homogeneity of multivariate dispersions . Biometrics 62 : 245 – 253 . Anderson , M . J . , K . E . Ellingsen , and B . H . McArdle . 2006 . Multivariate dispersion as a measure of beta diversity . Ecology Letters 9 : 683 – 693 . Anderson , M . J . , and J . Robinson . 2003 . Generalised discrim - inant analysis based on distances . Australian and New Zealand Journal of Statistics 45 : 301 – 318 . Botta - Duka´t , Z . 2005 . Rao’s quadratic entropy as a measure of functional diversity based on multiple traits . Journal of Vegetation Science 16 : 533 – 540 . Cailliez , F . 1983 . The analytical solution of the additive constant problem . Psychometrika 48 : 305 – 310 . NOTES 304 Ecology , Vol . 91 , No . 1 Cornelissen , J . H . C . , S . Lavorel , E . Garnier , S . Dı´az , N . Buchmann , D . E . Gurvich , P . B . Reich , H . ter Steege , H . D . Morgan , M . G . A . van der Heijden , J . G . Pausas , and H . Poorter . 2003 . A handbook of protocols for standardised and easy measurement of plant functional traits worldwide . Australian Journal of Botany 51 : 335 – 380 . Dı´az , S . , S . Lavorel , F . de Bello , F . Que´tier , K . Grigulis , and T . M . Robson . 2007 . Incorporating plant functional diversity effects in ecosystem service assessments . Proceedings of the National Academy of Sciences ( USA ) 104 : 20684 – 20689 . Estabrook , G . F . , and D . J . Rogers . 1966 . A general method of taxonomic description for a computed similarity measure . BioScience 16 : 789 – 793 . Folke , C . , S . Carpenter , B . Walker , M . Scheffer , T . Elmqvist , L . Gunderson , and C . S . Holling . 2004 . Regime shifts , resilience , and biodiversity in ecosystem management . Annual Review of Ecology , Evolution , and Systematics 35 : 557 – 581 . Gitay , H . , and I . R . Noble . 1997 . What are functional types and how should we seek them ? Pages 3 – 19 in T . M . Smith , H . H . Shugart , and F . I . Woodward , editors . Plant functional types : their relevance to ecosystem properties and global change . Cambridge University Press , Cambridge , UK . Gower , J . C . 1971 . A general coefﬁcient of similarity and some of its properties . Biometrics 27 : 857 – 871 . Gower , J . C . 1982 . Euclidean distance geometry . Mathematical Scientist 7 : 1 – 14 . Gower , J . C . , and P . Legendre . 1986 . Metric and Euclidean properties of dissimilarity coefﬁcients . Journal of Classiﬁca - tion 3 : 5 – 48 . Grime , J . P . 1998 . Beneﬁts of plant diversity to ecosystems : immediate , ﬁlter and founder effects . Journal of Ecology 86 : 902 – 910 . Hooper , D . U . , et al . 2005 . Effects of biodiversity on ecosystem functioning : a consensus of current knowledge . Ecological Monographs 75 : 3 – 35 . Lavorel , S . , K . Grigulis , S . McIntyre , N . S . G . Williams , D . Garden , J . Dorrough , S . Berman , F . Que´tier , A . The´bault , and A . Bonis . 2008 . Assessing functional diversity in the ﬁeld—methodology matters ! Functional Ecology 22 : 134 – 147 . Legendre , P . , and M . J . Anderson . 1999 . Distance - based redundancy analysis : testing multispecies responses in mul - tifactorial ecological experiments . Ecological Monographs 69 : 1 – 24 . Legendre , P . , D . Borcard , and P . Peres - Neto . 2005 . Analyzing beta diversity : partitioning the spatial variation of commu - nity composition data . Ecological Monographs 75 : 435 – 450 . Legendre , P . , and L . Legendre . 1998 . Numerical ecology . Second English edition . Elsevier Science , Amsterdam , The Netherlands . Levene , H . 1960 . Robust tests for equality of variances . Pages 278 – 292 in S . G . Olkin , W . Hoeffding , W . G . Madow , and H . B . Mann , editors . Contributions to probability and statistics . Stanford University Press , California , USA . Lingoes , J . C . 1971 . Some boundary conditions for a monotone analysis of symmetric matrices . Psychometrika 36 : 195 – 203 . Mason , N . W . H . , K . MacGillivray , J . B . Steel , and J . B . Wilson . 2003 . An index of functional diversity . Journal of Vegetation Science 14 : 571 – 578 . Mokany , K . , J . Ash , and S . Roxburgh . 2008 . Functional identity is more important than diversity in inﬂuencing ecosystem processes in a temperate native grassland . Journal of Ecology 96 : 884 – 893 . Pavoine , S . , J . Vallet , A . Dufour , S . Gachet , and H . Daniel . 2009 . On the challenge of treating various types of variables : application for improving the measurement of functional diversity . Oikos 118 : 391 – 402 . Petchey , O . L . , and K . J . Gaston . 2002 . Functional diversity ( FD ) , species richness and community composition . Ecology Letters 5 : 402 – 411 . Petchey , O . L . , and K . J . Gaston . 2006 . Functional diversity : back to basics and looking forward . Ecology Letters 9 : 741 – 758 . Podani , J . 1999 . Extending Gower’s general coefﬁcient of similarity to ordinal characters . Taxon 48 : 331 – 340 . R Development Core Team . 2009 . R : a language and environment for statistical computing . R Foundation for Statistical Computing , Vienna , Austria . h http : / / www . R - project . org i Rao , C . R . 1982 . Diversity and dissimilarity coefﬁcients—a uniﬁed approach . Theoretical Population Biology 21 : 24 – 43 . Ricotta , C . 2005 . A note on functional diversity measures . Basic and Applied Ecology 6 : 479 – 486 . Tilman , D . , J . Knops , D . Wedin , P . Reich , M . Ritchie , and E . Siemann . 1997 . The inﬂuence of functional diversity and composition on ecosystem processes . Science 277 : 1300 – 1302 . Ville´ger , S . , N . W . H . Mason , and D . Mouillot . 2008 . New multidimensional functional diversity indices for a multifac - eted framework in functional ecology . Ecology 89 : 2290 – 2301 . Wright , J . P . , S . Naeem , A . Hector , C . Lehman , P . B . Reich , B . Schmid , and D . Tilman . 2006 . Conventional functional classiﬁcation schemes underestimate the relationship with ecosystem functioning . Ecology Letters 9 : 111 – 120 . APPENDIX A A ﬁgure showing that FDiv and FEve do not estimate functional dispersion ( Ecological Archives E091 - 022 - A1 ) . APPENDIX B Simulation results with presence – absence data ( Ecological Archives E091 - 022 - A2 ) . APPENDIX C A list of criteria for functional diversity indices tested on FDis ( Ecological Archives E091 - 022 - A3 ) . APPENDIX D A table listing the main features of the ‘‘dbFD’’ function ( Ecological Archives E091 - 022 - A4 ) . January 2010 305 NOTES
a r X i v : c ond - m a t / 0610446v2 [ c ond - m a t . s t a t - m ec h ] 17 J un 2007 Link and subgraph likelihoods in random undirected networks with ﬁxed and partially ﬁxed degree sequence Jacob G . Foster , 1 David V . Foster , 2 Peter Grassberger , 1 , 2 and Maya Paczuski 1 1 Complexity Science Group , Department of Physics and Astronomy , University of Calgary , Calgary , Canada 2 Institute for Biocomplexity and Bioinformatics , University of Calgary , Calgary , Canada ( Dated : February 6 , 2008 ) The simplest null models for networks , used to distinguish signiﬁcant features of a particular network from a priori expected features , are random ensembles with the degree sequence ﬁxed by the speciﬁc network of interest . These “ﬁxed degree sequence” ( FDS ) ensembles are , however , fa - mously resistant to analytic attack . In this paper we introduce ensembles with partially - ﬁxed degree sequences ( PFDS ) and compare analytic results obtained for them with Monte Carlo results for the FDS ensemble . These results include link likelihoods , subgraph likelihoods , and degree correlations . We ﬁnd that local structural features in the FDS ensemble can be reasonably well estimated by simultaneously ﬁxing only the degrees of few nodes , in addition to the total number of nodes and links . As test cases we use a food web , two protein interaction networks ( E . coli , S . cerevisiae ) , the internet on the autonomous system ( AS ) level , and the World Wide Web . Fixing just the degrees of two nodes gives the mean neighbor degree as a function of node degree , h k ′ i k , in agreement with results explicitly obtained from rewiring . For power law degree distributions , we derive the disassortativity analytically . In the PFDS ensemble the partition function can be expanded diagram - matically . We obtain an explicit expression for the link likelihood to lowest order , which reduces in the limit of large , sparse undirected networks with L links and with k max ≪ L to the simple formula P ( k , k ′ ) = kk ′ / ( 2 L + kk ′ ) . In a similar limit , the probability for three nodes to be linked into a triangle reduces to the factorized expression P ∆ ( k 1 , k 2 , k 3 ) = P ( k 1 , k 2 ) P ( k 1 , k 3 ) P ( k 2 , k 3 ) . PACS numbers : 02 . 50 . Cw , 02 . 70 . Uu , 05 . 20 . Gg , 87 . 10 . + e , 87 . 23 . Cc , 89 . 75 . Fb , 89 . 75 . Hc I . INTRODUCTION A pivotal question of empiricism is the degree to which the results of an observation are expected . In ideal cases , either predictions based on these expectations remain valid in view of new measurements , or the expectations have to be changed . But this clear distinction is often blurred by uncertainties resulting from measurement er - rors , imprecision of model parameters , or the impossi - bility of extracting exact predictions from complicated models . Whether or not the problem at hand is a typ - ical instance of a wider class of problems that are al - ready understood is a question of statistical inference . In rare cases , the consequences of the expectations ( or the model ) can be derived analytically prior to observation . If this is not feasible , a widely used strategy is to con - struct a large number of “surrogates” [ 1 ] , or instances of a well - deﬁned null model encapsulating the expectations , and to compare the actual observations to this artiﬁcial data . Constructing surrogates is equivalent to simulating a statistical ensemble . In choosing weights for the ensemble of surrogates one often uses Occam’s razor—no outcome compatible with the null hypothesis should be preferred , and all such outcomes are equally likely . This is sim - ilar to Jaynes’ construction of statistical mechanics by maximizing Shannon entropy with physically meaningful constraints . Consequently , the numerical construction of surrogates often uses Monte Carlo methods [ 2 ] similar to those used in statistical mechanics . This paper addresses properties of ensembles used as null models for complex networks . Predictions based on the null models ﬁx expectations , and thereby de - termine whether or not deviations in the properties of an actual network are functionally or historically signiﬁ - cant . While the numerical construction of surrogates of these ensembles has received attention in the recent liter - ature [ 3 , 4 , 5 ] , much less is known about analytic methods ( see discussion below ) . Nowadays networks attract enormous interest as repre - sentations of complex systems . They take various guises in biological , social , technological and physical contexts . The nodes designate distinct degrees of freedom ( e . g agents , species , genes , magnetic concentrations in the solar photosphere , or earthquakes ) and the links iden - tify primary interactions or relationships between pairs of nodes ( e . g . co - authorship , predator - prey relations , gene regulation , magnetic ﬂux tubes , or seismic correlations ) . For examples see [ 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 ] . The ubiq - uity of networks and their relatively easy visualization as graphs , together with notions of universality prevalent in the physics community , have driven speculations that the structure of networks can shed light on fundamental principles of social or biological organization , such as po - litical behavior , ecosystem dynamics , brain function or the regulated homeostasis of organisms . At the simplest level , networks are purely static en - tities , with each pair of distinct nodes connected by no more than one edge ( or “link” ) . If , in addition , the inter - 2 action strength is disregarded ( which often is a very useful simpliﬁcation ) the adjacency matrix M for the graph is a square ( 0 , 1 ) matrix . If M ij = 1 then an edge points from node i to node j ; if M ij = 0 then the edge is absent . Without self - interactions , M ii = 0 . For undirected net - works , the adjacency matrix is symmetric , M ij = M ji . The degree k i of node i is then deﬁned as the number of edges incident on it , k i = P j M ji . Several reviews may be found in Refs . [ 6 , 14 , 15 ] . Section II deﬁnes more precisely the network ensembles ( or null models ) we consider in this paper . Our analyti - cal methods focus on ensembles where the total number of links and nodes in the network is speciﬁed as well as the degrees of a small subset of nodes . These are called ensembles of “partially ﬁxed degree sequence” ( PFDS ) . Analytic predictions based on the PFDS ensembles can be compared with numerical results from a ‘rewiring’ al - gorithm for ensembles with ﬁxed degree sequence ( FDS ) , where the number of links attached to every node in the network is simultaneously speciﬁed . Section III mainly recalls previous results . We review Monte Carlo meth - ods for sampling the FDS ensemble . Then we discuss how such null models can be used , and we conclude by recalling previous analytic approaches . Section IV dis - cusses some results derived later in Section V , namely analytic estimates of the link linkelihood p ij ( the linkeli - hood for a link to connect nodes i and j ) . It uses them to make predictions for the average nearest neighbor de - gree h k ′ i k and for disassortativity . The calculation gives an excellent description of h k ′ i k for large k , e . g . for an Escherichia coli protein interaction network and an AS level map of the Internet . We also compute h k ′ i k ana - lytically for the case where the degree distribution is a power law , using Eq . ( 1 ) given below . In that case , the naive approximation for P ( k , k ′ ) would give divergent or ill - deﬁned results . Section V contains our main analytic results . In order to keep the notational clutter of this section to a mini - mum and to emphasize the intuitive nature of the results , most intermediate steps are moved to Appendix B . In the limit of large sparse networks with L links and with the maximal degree much less than L , we ﬁnd that the link likelihood depends only on L and on the degrees k and k ′ of the two nodes , and is given by P ( k , k ′ ) ≈ kk ′ / ( 2 L + kk ′ ) . ( 1 ) This improves substantially over the widely used ‘naive’ approximation P ( k , k ′ ) ≈ kk ′ / 2 L . We also ﬁnd that the disassortativity of the FDS ensembles correspond - ing to several real world networks is well - described by PFDS ensembles simultaneously ﬁxing the degrees of two nodes at a time . Finally , we ﬁnd an expression for the likelihood of a triangle , which factorizes in the same limit of large sparse networks ( and when all three degrees are much larger than 1 ) to P ∆ ( k 1 , k 2 , k 3 ) = P ( k 1 , k 2 ) P ( k 1 , k 3 ) P ( k 2 , k 3 ) , with P ( k , k ′ ) given again by Eq . ( 1 ) . The paper ends in section VI with a discussion and an outlook to further problems . II . NULL MODELS FOR NETWORKS A . Erd¨os - Renyi ( Undirected ) Graphs The simplest null hypothesis is that a given network is completely random , not even the number of links be - ing speciﬁed . The only constraint is on the number of nodes , which is assumed to be N . Each pair of nodes may be joined with at most one link . Hence , the number of labelled undirected graphs with ﬁxed N is Z 0 ( N ) = 2 N ( N − 1 ) / 2 . This quantity is the number of ways undirected links may be placed in (cid:0) N 2 (cid:1) = N ( N − 1 ) / 2 possible positions . A statistical ensemble is obtained by assigning weights to each graph . The most natural choice is to weigh each graph with L links by a factor p L , where p is the probability that two given nodes are connected by a link . This gives the average number of links as ¯ L = pN ( N − 1 ) / 2 . The average degree of a node , i . e . the average number of links attached to it , is then ¯ k = 2¯ L / N = p ( N − 1 ) , and the degree distribution is binomial . In the limit of sparse networks , where p → 0 for N → ∞ such that pN → const . , the degree distri - bution ( or the probability P ( k ) that a node has k links ) becomes Poissonian , P ( k ) = ¯ k k exp − ¯ k k ! . ( 2 ) While this ensemble can be viewed as a “grand canon - ical” version of the Erd¨os - Renyi ensemble [ 16 ] since the particle fugacity is ﬁxed , it is more customary to asso - ciate Erd¨os - Renyi graphs with a diﬀerent ensemble where the total number L of links is ﬁxed , rather than just the average ¯ L . Park and Newman refer to the ensemble with ﬁxed L as “canonical” [ 18 , 19 ] , making an analogy be - tween the number of links and the number of particles in traditional statistical mechanics . However , we shall refer to this ensemble , and ensembles with similar hard degree constraints , as microcanonical . Excluding self - connections as well as multiple edges between any pair of nodes gives Z 1 ( N , L ) = { L } X { lg , N } 1 = (cid:18)(cid:0) N 2 (cid:1) L (cid:19) ( 3 ) distinct labelled , undirected graphs with ﬁxed N and L [ 17 ] . The subscript “ { lg , N } ” indicates a sum over la - belled graphs with N nodes , while the superscript { L } on the sum indicates , as in later formulae , the constraints on the edges . The subscript “1” on Z indicates that Z 1 is the number of undirected graphs with one ( global ) hard constraint on the links , just as Z 0 ( N ) is the number of undirected graphs with zero constraints on the links . With no further knowledge or constraints on the net - work , Occam’s razor suggests assigning equal weight to each labelled graph satisfying all the hard constraints . This corresponds exactly to the construction of micro - canonical ensembles in statistical mechanics . For Z 1 , 3 each node has equal probability to be connected to any other node . It is easy to show [ 20 ] that the distribution for the number of links attached to each node is again Poissonian for sparse networks with large N , where the grand canonical and microcanonical ensembles become equivalent . In contrast , observations of real networks reveal fat - tailed degree distributions , which diﬀer starkly from the situation where each node has equal likelihood to be con - nected to any other node . The most salient consequence is that the average degree ¯ k fails to characterize the con - nectivity of the nodes ; in particular it cannot account for the dominant nodes or “hubs” with many links , which would not typically appear in the Erd¨os - Renyi ensemble . B . Ensembles with Fixed Degree Sequences As a result , attention has moved to ensembles that build additional information into the null hypothesis about the “distinguishability” or diversity of the nodes . Although many diﬀerent and equally plausible ways to account for diversity can be imagined , to begin we focus on the most popular contemporary method . This uses the random ensemble of labelled graphs with ﬁxed de - gree sequence ( FDS ) as the relevant null model . The complete degree sequence simultaneously ﬁxes all the one - node properties for each member of the ensemble , without reference to their relationships ( or links ) in the network . Obviously , it is straightforward to obtain the degree sequence for any network , and there exist numer - ical methods to estimate characteristic properties of the corresponding FDS ensemble ( see section III ) . The microcanonical FDS ensemble is speciﬁed by as - signing a speciﬁc degree ( = number of links ) to each node , k i for i = 1 , . . . , N , and giving equal weight to each graph with this degree sequence , while giving zero weight to all those graphs which have a diﬀerent degree sequence . The null hypothesis for any observable pertinent to a speciﬁc graph G with adjacency matrix M G is then obtained by taking its expectation value in the FDS ensemble with the same degree sequence . For undirected graphs excluding self - interactions , the FDS partition sum is the number of symmetric ( 0 , 1 ) matrices with zeroes on the diagonal and with ﬁxed marginal sums , which can be written ac - cording to our previous convention as Z N ( N , L , k 1 , k 2 , . . . , k N − 1 ) = { k 1 . . . , k N } X { lg , N } 1 . ( 4 ) with k 1 + k 2 + . . . + k N = 2 L . For most networks of physical interest , Z N is astronomically large compared to one , but vanishingly small compared to Z 1 . For instance , Chen et al . [ 5 ] numerically estimate the number of 12 × 12 ( 0 , 1 ) matrices with each row and column sum equal to 2 ( and with no restrictions of symmetry or vanishing diagonal ) to be ≈ 2 . 196 × 10 16 , which agrees well with the exact number found by Wang and Zhang [ 21 ] . This number is much smaller than the number of all 12 × 12 ( 0 , 1 ) matrices with 24 ones , which is (cid:0) 12 2 24 (cid:1) ≈ 1 . 69 × 10 29 . Despite eﬀorts by these and other mathematicians over decades [ 21 , 22 ] , no well - developed , exact analytical approaches are known for these combinatorial problems , but advanced computational methods exist , as described in Section III . C . Partially Fixed Degree Sequences On the one hand , the diﬃculty of enumerating the number of graphs in the FDS ensemble suggests strong correlations in the graphs , since similar problems in sys - tems lacking correlations can often be solved exactly . In - deed , the FDS ensemble makes very diﬀerent predictions from the Erd¨os - Renyi ( ER ) ensemble , showing that tak - ing into account some information about the nodes’ de - grees is crucial . On the other hand , it might be the case that not all the constraints in the FDS ensemble must be taken into account simultaneously . After all it is the simultaneous ﬁxing of all the marginal sums in the matrix that makes the calculation of Z N diﬃcult . Perhaps taking into ac - count all the constraints , but not requiring them to be simultaneously enforced , is already suﬃcient to capture some nontrivial aspects of the FDS ensemble . If this is possible , then we must also identify which speciﬁc small subset of the nodes’ degrees gives the most reliable esti - mate of various expectation values in the FDS ensemble . Here , we study ensembles where the degrees of a very small subset of the nodes are simultaneously ﬁxed – the other degrees being arbitrary up to the constraint on the total number of links . We also demand that no more than one link may connect any two nodes in the net - work , and disallow self - connections . All graphs satisfying these constraints have equal weight . Those not satisfying these constraints are given zero weight . These ensembles can all be viewed as sub - ensembles of the ER ensem - ble . For each possible degree subset , we calculate the diﬀerent partition functions corresponding to all possible subgraphs of a certain size . From these we can approxi - mate expectation values of various quantities in the FDS ensemble . In the following we shall always label the nodes such that the ﬁrst m degrees , k 1 , . . . k m , are ﬁxed . We call the resulting ensembles PFDS ( m + 1 ) : partially ﬁxed de - gree sequence with m + 1 constraints ( the ﬁnal constraint comes from ﬁxing the number of links , L ) . Clearly , putting more constraints on the ensemble of labelled graphs diminishes its size until , when each and every edge is speciﬁed , the ensemble contains just one mem - ber - the real network G being studied . For ensembles with increasing numbers of link constraints this implies that Z m + 1 decreases monotonically with m + 1 , and 1 ≡ Z G ≪ Z N ( N , L , k 1 , k 2 , . . . , k N − 1 ) ≪ Z m + 1 ( N , L , k 1 , . . . k m ) ≪ Z 1 ( N , L ) , ( 5 ) 4 for 1 < m < N − 1 . We ﬁnd that ﬁxing only the degrees of the nodes par - ticipating in the small subgraph ( e . g . link or trian - gle ) under consideration , with explicit exclusion of self - connection and multiple - connections between any nodes , already gives a good approximation to the disassortativ - ity ( and to other properties ) in the FDS ensemble . As noted above , this uses information about the whole de - gree sequence , but in each contribution corresponding to one speciﬁc ( labelled ) subgraph only part of this infor - mation is used . The information stored in the degree sequence is most important when its distribution is very wide . Even for networks exhibiting broad degree distributions , such as protein interaction networks or autonomous system maps of the Internet , it is suﬃcient to ﬁx the degrees of the node pairs directly involved ( as well as the total number of links in the network ) to obtain a good estimate of h k ′ i k and of the disassortativity . In order to estimate the num - ber of triangles ( i . e . the clustering ) , one has to ﬁx the degrees of node triples . If we ﬁx in addition the degrees of ( some ) hubs , this slightly improves the approximations . It is much easier to make analytical calculations for small m , with the smallest meaningful m being the size of the subgraph being considered . Hence for link likelihoods and for h k ′ i k this minimum is m = 2 , while for triangle likelihoods it is m = 3 . By comparing analytic proper - ties of the PFDS ( m ) ensemble with numerical estimates of the FDS ensemble , we can assess to what extent the correlations in the PFDS ensembles resemble those in the FDS and in the ER ensembles . To begin , we will focus in Section IV on the link likeli - hood , p ij , which is the probability that a randomly cho - sen graph from the ensemble contains an edge from node i to node j . From this microscopic quantity one can cal - culate the standard degree - degree correlations that are commonly compared with real - world networks to iden - tify statistically signiﬁcant features . Details of the calcu - lation of p ij are deferred to Section V ( and to Appendix B ) . There we will also treat the generalization to m ≥ 3 which is needed in order to estimate the frequencies of higher order quantities such as motifs [ 23 ] . As an exam - ple of a motif calculation , we include an estimate of the number of triangles . III . BACKGROUND A . Monte Carlo algorithms to estimate the FDS ensemble As for many other problems where one wants to sample complex instances from some well - deﬁned ensemble , here two basic strategies predominate : Markov chain Monte Carlo and sequential sampling [ 4 , 24 , 25 ] . For the present case , the most obvious and popular Markov chain algo - rithm is the rewiring algorithm [ 3 , 26 , 27 , 28 , 29 ] . We describe it here for directed graphs ; the generalization to undirected graphs is immediate . We start by making an initial network with N nodes , no self - connections , and the desired degree sequence , but without paying atten - tion to multiple links between pairs of nodes [ 30 ] . The Monte Carlo algorithm proper consists of a sequence of moves , randomly chosen from a move set , which con - tinues until equilibrium ( i . e . uniformity of sampling ) is reached with suﬃcient accuracy . A move is initiated by choosing randomly four diﬀerent nodes i , j , l and m with M ij > 0 and M lm > 0 . If either M im > 0 or M lj > 0 , a null move is performed ( the graph is left as it is ) . If nei - ther of the pairs { i , m } and { l , j } were already connected by a link , M ij and M lm are each decreased by 1 , while M im and M lj are increased by one . This corresponds to swapping one pair of links . It can be shown easily that this algorithm eventually leads to a graph without multiple links ( provided such a graph consistent with the ﬁxed degree sequence exists ) . After this happens , the algorithm satisﬁes detailed bal - ance ( any sequence of moves is equally likely to be cho - sen as its reversed sequence ) and is ergodic ( each graph with the same degree sequences can be reached by a suit - able move sequence . ) As shown in [ 27 ] , ergodicity is not strictly satisﬁed , but the few exceptions can be taken into account by including three - link exchanges in the move set . Sequential sampling proceeds , in contrast , by repeat - edly building a new graph from scratch . For this we start with an empty adjacency matrix and ﬁll its entries randomly . In the simplest version , this is done without paying any attention to the degree sequence , to the ab - sence of self loops , or to the exclusion of multiple links . Instead , the candidate graph is discarded if any of these constraints are violated . In this way the uniformity of the sampling is guaranteed , but the attrition ( i . e . the chance to reach an illegal conﬁguration ) is overwhelm - ing , rendering the algorithm useless . But there are more sophisticated options for sequential sampling . The most eﬃcient algorithm studied in the literature [ 5 ] uses de - tailed mathematical results for the structure of legal ad - jacency matrices [ 31 ] to bias the matchings in a much more clever way . B . Uses of null models Statistically signiﬁcant deviations between a null model and a real network point to organizing laws or his - torical accidents that are not accounted for by the null hypothesis . On the other hand , ﬁnding no statistically signiﬁcant deviations would promote the belief that the entire structure of the network could be accounted for by the model , e . g . by the complete degree sequence in case of the FDS ensemble . This process of building null models can , in principle , be iterated to understand the full set of organizing principles or physical constraints on a network : one builds a null model , tests for signiﬁcant deviations , and then builds a new null model with richer 5 structure to try to reduce any signiﬁcant deviations to typicality . Through an application of this discriminatory method , Maslov et al . [ 33 ] showed that a signiﬁcant part of the dissortativity [ 34 ] observed in the Internet could be at - tributed to the broad degree distribution together with the restriction of no multiple links between any pair of nodes . For a scale free network of N nodes with a degree distribution P ( k ) ∼ k − γ , the maximum expected degree k c ( N ) scales as k c ( N ) ∼ N 1 / ( γ − 1 ) . In a random network with no constraints on edge multiplicities , the expected number of edges between the two largest hubs would then scale as k c ( N ) 2 / N ∼ N 2 / ( γ − 1 ) − 1 . For γ < 3 , this number diverges with N . If the constraint of no multiple edges is imposed , these links must be distributed so that they connect the hubs to other nodes . This creates fewer links between hubs than naively expected , and more links be - tween hubs and nodes with small degree ; it also leads to a suppression of links between nodes with small degrees ( as the degrees of these nodes are “used up” by connect - ing to hubs ) . The net eﬀect is that ﬁxing a broad degree sequence decreases assortativity ( the preference for nodes with similar degrees to be connected to each other ) [ 33 ] . On the other hand , Milo et al . [ 23 ] have discovered subgraphs or motifs that are signiﬁcantly more frequent in actual networks than in the corresponding FDS en - semble . Identifying these motifs allows a classiﬁcation of networks that share the same motifs . For instance feed - forward loops are overrepresented in gene regulation networks and in some electronic circuits , while fully con - nected triangles are most overrepresented in the world wide web . So , on the one hand we see that the FDS ensemble , to - gether with non - trivial ( power law ) degree distributions , allows both discrimination between features of the net - work and comparison with other networks ; on the other hand , the ensemble itself exhibits strong correlations . To explain how these correlations are related to each other and to the degree sequence it is useful to have an analytic approach . This is also important if one wants to develop more reﬁned null models , or study very large networks for which rewiring is prohibitive . While most authors have considered the FDS ensemble as the most natural null model for networks , there have been attempts to generalize to more complex ensembles . Maybe the most interesting is due to Mahadevan et al . [ 35 ] . C . Previous analytic approaches The present paper builds on a paper by Burda et al . [ 20 ] . An alternative strategy to incorporate infor - mation on degree distributions was proposed by Park and Newman [ 18 , 19 ] . While we ﬁx the degree sequence { k ( m ) , m = 0 , 1 , . . . } exactly , Park and Newman con - strain only the average numbers h k ( m ) i , averaged over the ensemble . Thus , while our approach is microcanoni - cal , the one of [ 18 , 19 ] is grand canonical . As in statisti - FIG . 1 : Log - log scatter plot of the naive analytic estimate of link likelihood k out , i k in , j / L ( directed network , St . Mar - tin foodweb [ 37 ] ) or k i k j / 2 L ( undirected network , Eschericia coli protein interaction network [ 38 ] ) versus the ratio of the Monte - Carlo rewiring estimate to the naive estimate for the corresponding nodes . Note that the directed network has con - siderably more scatter for given k out , i , k in , j . cal mechanics , calculations are often simpler in the grand canonical ensemble , but they are feasible and not too dif - ﬁcult for the PFDS ( m ) ensemble considered in this paper , with m small . Note that for ﬁnite sized networks , the two ensembles are not equivalent . Further , for a given net - work , physical arguments may suggest that one ensemble is more explanatory than another . IV . LINK LIKELIHOODS p ij AND DISASSORTATIVITY IN NULL MODELS For undirected networks , all pairs of nodes with the same degree have the same likelihood to be connected in the FDS ensemble . For directed networks the likelihood to form a link from node i with out - degree k out , i to node j with in - degree k in , j also depends on k in , i and k out , j . This is demonstrated in Fig . 1 , where the actual link likelihood estimated using a rewiring algorithm is plotted vs . the naive analytic estimate of the link likelihood k out , i k in , j / L ( for pairs in the directed networks ) or k i k j / 2 L ( for pairs in the undirected network ) . In particular , directed net - works exhibit a high degree of scatter for the same values of the connected ( out - and in - ) degrees , showing the im - portance of the other degrees associated with the pair ( in - and out - , respectively ) . Further , the likelihood does not approach the naive estimate for k i k j ≪ L . This is due to the constraint of one link between two nodes and to the presence of hubs , which thus have to distribute their links to diﬀerent nodes . For any ensemble A , let N A ( k , k ′ ) be the average num - ber of links between nodes with degree k and nodes with 6 degree k ′ . In terms of the link likelihood , N A ( k , k ′ ) = X i , j p ij , A δ ( k i − k ) δ ( k j − k ′ ) ( 6 ) where the sum over i , j indicates a sum over all pairs of nodes , and p ij , A is the link likelihood for ensemble A . If the ensemble A is the trivial ensemble consisting of just one network , namely the experimentally observed graph G with adjacency matrix M G , then p ij , A = M G , ij . The average degree h k ′ i k of neighbors of nodes with degree k is h k ′ i k = P k ′ k ′ N ( k , k ′ ) P k ′ N ( k , k ′ ) . ( 7 ) where we have dropped the subscript “ A ” for brevity . This quantity can be related to the ( dis ) assortativity , i . e . the tendency of nodes to connect ( less ) preferentially to nodes with similar degree . The assortativity was formally introduced by Newman as the Pearson correlation coef - ﬁcient for the degrees of any two nodes connected by an edge [ 34 ] . Intuitively , when the average degree h k ′ i k is an increasing function of k then the network shows assor - tative mixing , i . e . nodes of low degree tend to connect to nodes of low degree and nodes of high degree tend to connect to nodes of high degree . When h k ′ i k is ﬂat , the network shows no assortativity , and when h k ′ i k is a decreasing function of k then the network shows disas - sortative mixing [ 36 ] . We can compute h k ′ i k in several PFDS ensembles . The ensemble Z 3 ( k 1 , k 2 ) consists of uncorrelated random graphs with N nodes , L edges and no multiple or self - connections , where we ﬁx the degrees of one pair of nodes . Evidently , we choose the pair whose link likelihood is be - ing evaluated . Eq . ( 7 ) is then calculated by averaging over all pairs of nodes in the network . This clearly allows us to take the whole degree sequence into consideration , although only pairs of node degrees are considered si - multaneously . To include the presence of a hub , we work in Z 4 ( k 1 , k 2 , k max ) , the ensemble of uncorrelated random graphs with N nodes , L edges and no multiple or self - connections , where we ﬁx the degree of the pair of nodes whose link likelihood is being evaluated , as well as the degree k max of the strongest hub . As shown in Section V and in Appendix B , we can compute h k ′ i k exactly in Z 3 ( k 1 , k 2 ) and Z 4 ( k 1 , k 2 , k max ) , as well as in the approximate Z 3 ( k 1 , k 2 ) ensemble with p ij given by Eq . ( 1 ) [ see also Eq . ( 22 ) below ] , which be - comes exact in the limit of large N for sparse networks , and for k max ≪ L . In Fig . 2 we plot h k ′ i k versus k for an Escherichia coli protein interaction network [ 38 ] . The FDS ensemble , as sampled by the Monte Carlo rewiring procedure , is clearly disassortative , while the estimate of h k ′ i k using the standard naive estimate p ij = k i k j / 2 L shows no disassortativity or assortativity , as expected . We note that forbidding self - connection but otherwise using the naive estimate for p ij results in slight disas - sortativity , while approximate Z 3 , exact Z 3 ( k 1 , k 2 ) , and 11 . 5 12 12 . 5 13 13 . 5 14 14 . 5 15 15 . 5 0 5 10 15 20 25 30 35 < k ’ > k k Monte CarloNaive Naive , no self connectionZ 3 Z 4 Approximate Z 3 FIG . 2 : Average degree of the neighbor , h k ′ i k vs . node de - gree k for an Escherichia coli protein interaction network [ 38 ] in several ensembles . The FDS ensemble , sampled by Monte Carlo rewiring , shows disassortativity as h k ′ i k is a decreasing function of k . For the naive estimate p ij = k i k j / 2 L and using the exact degree sequence , there is no disassortativity ( while using a power law as in Eq . ( 10 ) leads to divergence ) . How - ever , using the naive estimate but forbidding self - connection results in slight disassortativity . Approximate Z 3 , exact Z 3 , and Z 4 ( k 1 , k 2 , k max ) are increasingly reﬁned estimates of the FDS ensemble . Notice that the latter two can hardly be dis - tinguished . Z 4 ( k 1 , k 2 , k max ) are increasingly reﬁned estimates of the FDS behavior ( see Fig . 2 ) . Finally , Z 4 ( k 1 , k 2 , k max ) gives only a slight improvement over Z 3 , indicating that hubs per se are less important to global properties such as dis - assortativity than constraints such as no self - or multiple connections , which are already implemented at the level of Z 3 , along with information about the whole degree sequence , taken in degree pairs . The approximate Z 3 ensemble is of further interest be - cause h k ′ i k can be calculated analytically . Note that N ( k , k ′ ) = X i , j p modelij δ ( k i − k ) δ ( k j − k ′ ) = P ( k , k ′ ) N ( k ) N ( k ′ ) . ( 8 ) For a power law degree distribution , N ( k ) = ( γ − 1 ) Nk − γ ( 9 ) where N is the number of nodes in the network and the degree distribution of the network is a power law with exponent γ . In this case the sums over k ′ in Eq . ( 7 ) can be approximated by integrals , yielding h k ′ i k = R ∞ 1 k ′ P ( k , k ′ ) k ′− γ dk ′ R ∞ 1 P ( k , k ′ ) k ′− γ dk ′ . ( 10 ) If we approximate P ( k , k ′ ) by Eq . ( 1 ) , these integrals can be solved in terms of hypergeometric functions : h k ′ i k = γ − 1 γ − 2 2 F 1 ( 1 , γ − 2 ; γ − 1 ; − 2 Lk ) 2 F 1 ( 1 , γ − 1 ; γ ; − 2 Lk ) . ( 11 ) 7 FIG . 3 : h k ′ i k versus k for the Internet at the AS level from [ 39 ] . We plot the analytic estimate of Eq . ( 11 ) for γ = 2 . 3 ; for comparison we plot the results in the approximate Z 3 and Z 3 ensembles , computed directly from the degree sequence of [ 39 ] , as well as Monte Carlo rewiring estimates of the FDS ensemble . We note that for γ = 2 . 5 the hypergeometric functions can be expressed in terms of elementary functions : h k ′ i k = arcsin (cid:16)q 2 L 2 L + k (cid:17) ( k 2 L ) 1 / 2 − ( k 2 L ) arctan (cid:0) ( k 2 L ) − 1 / 2 (cid:1) . ( 12 ) To test the validity of Eq . ( 11 ) , we turn to a large network , speciﬁcally Newman’s recent AS - level Internet data [ 39 ] , for which L = 48436 . In [ 18 ] it is reported that γ ≈ 2 . 2 ± 0 . 3 for the Internet ; we estimate γ ≈ 2 . 1 ± 0 . 3 for Ref . [ 39 ] . In Fig . 3 we plot the analytic estimates of h k ′ i k given by Eq . ( 11 ) for γ = 2 . 3 . This value for γ gives the best ﬁt for h k ′ i k and is within the uncertainty of the direct degree distribution measurement of γ . For comparison we also show the results in the approximate Z 3 and Z 3 ensembles , computed directly from the degree sequence of [ 39 ] , as well as Monte Carlo rewiring estimates of the FDS ensemble . Note the strong similarities between the Z 3 results and the Monte Carlo estimates of the FDS ensemble ; in particular , we observe a ﬂattening of h k ′ i k for small k both in the Z 3 ensemble and in the Monte Carlo rewiring . This is consistent with the observations of [ 18 ] . Also note the similar scaling of the various estimates and of the Monte Carlo results at large k . For the Inter - net , h k ′ i k has been reported to scale with k as a power law , h k ′ i k ≈ k − ν with ν ≈ 0 . 5 [ 18 ] . Our Monte Carlo results for the FDS ensemble , using the degree sequence of Ref . [ 39 ] , show indeed such a power law for large k , but with ν ≈ 0 . 75 . The exact and approximate Z 3 cal - culations , obtained with the exact degree sequence , give ν ≈ 0 . 7 resp . 0 . 62 . When using a power law degree se - quence and Eq . ( 11 ) , the scaling depends on γ . But in this case , one can verify that scaling does not hold in the large k limit , but in the limit k ≪ L . The curvature of the continuous line visible in Fig . 3 results entirely from the fact that k is not much less than L . Thus it is the slope of the continuous line at small k which should be used for extracting ν . With this , one ﬁnds that ν varies from ≈ 0 . 79 for γ = 2 . 2 to 0 . 5 for γ = 2 . 5 . Note that ν = 0 . 5 for γ = 2 . 5 is an exact result that can be obtained analytically by taking the limit 2 L / k / to ∞ in Eq . ( 12 ) . In contrast to the approach of [ 18 ] , all of our results can be computed directly from the degree distribution or the degree sequence , omitting the intermediate step of con - structing a fugacity distribution to match the statistics of the degree distribution and then extracting h k ′ i k from the fugacities . The fact that the disassortativity prop - erties of the Internet can be studied so directly in the simple approximate Z 3 ensemble suggests that Eq . ( 1 ) should replace the naive estimate P ( k , k ′ ) = kk ′ / 2 L in other applications , for example in the study of motifs . This is explored in Section V . B ( see Eq . 25 ) . For undirected networks and any null model A , Maslov et al . [ 33 ] deﬁned a quantity called the corre - lation proﬁle R ( k , k ′ ) = N G ( k , k ′ ) / N A ( k , k ′ ) and the Z - score Z ( k , k ′ ) = [ N G ( k , k ′ ) − N A ( k , k ′ ) ] / σ A ( k , k ′ ) , where N A ( k , k ′ ) is deﬁned as in Eq . ( 6 ) , N G ( k , k ′ ) is the analo - gous quantity for the trivial ensemble ( with p ij replaced by M G , ij ) , and σ 2 A ( k , k ′ ) is the variance of the number of links connecting nodes with degrees k and k ′ in en - semble A ( remember that N A ( k , k ′ ) was the average of that number ) . The speciﬁc null studied in [ 33 ] was the FDS ensemble . As shown in Appendix A , a similar anal - ysis can be done comparing diﬀerent null models to each other . Results are also discussed in Appendix A . V . ANALYTIC ESTIMATES OF THE FDS ENSEMBLE FOR UNDIRECTED NETWORKS A . Notation and Basic Identities We now derive our principal analytic results . Our central object is the partition function Z , which counts the number of graphs in the ensemble . The elemen - tary constraints on the network ( N nodes , no multiple or self - connections ) imply that the adjacency matrix M is N × N , is symmetric ( for undirected networks ) , has zeroes along the diagonal , and consists solely of 0’s and 1’s . If we add the constraint of L links , the partition function can be written as Z 1 ( N , L ) = X { Mij = 0 , 1 } i < j δ ( L − X i < j M ij ) ( 13 ) where the sum is over the upper triangle of M due to symmetry . A simple computation gives Eq . ( 3 ) for the number of ways to distribute L links among (cid:0) N 2 (cid:1) possible pairs of nodes . 8 m N − m N − m m 0 A B C symmetric FIG . 4 : Schematic decomposition of the adjacency matrix M into the three sub - matrices A , B , C discussed in the text . Note that M is symmetric for undirected networks . Now let us specify the degrees of m of the nodes . We refer to m as the “order” of a calculation . The partition function becomes Z m + 1 ( N , L , k 1 , . . . , k m ) = X { Mij } i < j δ ( L − X i < j M ij ) × m Y l = 1 δ ( k l − l − 1 X j = 1 M jl − N X j = l + 1 M lj ) ( 14 ) where we use the symmetry of the adjacency matrix to write the degree constraints in terms of the variables M ij with i < j . It will be helpful at this point to introduce some further notation to assist us in organizing this calculation . We split the matrix M into four pieces : • A , the square submatrix controlling the edges link - ing the m nodes with ﬁxed degree to each other ; • B , the rectangular matrix encoding the connections of the m nodes of ﬁxed degree with the rest of the nodes in the graph , and its transpose B T ; • C , the square submatrix encoding the edges among the N − m remaining nodes ( whose degrees are not speciﬁed ) . Due to the symmetry of M only B and the upper tri - angular parts of A and C are independent . In Fig . 4 we present a schematic decomposition of M . The sum over all adjacency matrices decomposes into a sum over the A , B and C sub - matrices , with suitable con - straints . In particular , we write the symbol P { A } for the sum over all possible values { 0 , 1 } of the matrix elements of the submatrix A . Each term of this sum corresponds to a particular ( possibly disconnected ) labelled subgraph involving m nodes of ﬁxed degree . This is analogous to a diagrammatic expansion of the partition function , where the partition function is now written as the sum over all possible subgraphs involving nodes 1 through m , and each subgraph is weighted by a degeneracy factor result - ing from the summations over B and C . This degener - acy counts the number of possible graphs in the ensemble containing that particular subgraph ( respectively subma - trix ) A . The partition function is written in this notation as : Z m + 1 = X { A } Z m + 1 ( A ) ( 15 ) where Z m + 1 ( A ) is the partition function or degeneracy factor for a given ﬁxed submatrix ( equivalently , sub - graph ) A . For each Z m + 1 ( A ) , the nodes with ﬁxed de - grees ( i . e . the ﬁrst m nodes ) are connected in a speciﬁed way . Thus , for example , the probability of some partic - ular m × m subgraph A occurring would be Prob ( A ) = Z m + 1 ( A ) Z m + 1 . ( 16 ) As shown in Appendix B , the degeneracy of a given subgraph Z m + 1 ( A ) can be written as Z m + 1 ( A ) = (cid:18) (cid:0) N − m 2 (cid:1) L + P j = m i < j , = 2 A ij − P ml = 1 k l (cid:19) × m Y l = 1 (cid:18) N − m k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj (cid:19) ( 17 ) The ﬁrst term on the right hand side is the degener - acy associated with the upper half triangle of the square submatrix C . Recall that the submatrix C deﬁnes con - nections between all N − m nodes not in A , i . e . all nodes with free degree . This matrix has (cid:0) N − m 2 (cid:1) independent places to put a speciﬁed number of 1’s . The number of 1’s in C depends on L , the total number of 1’s in the entire ( upper triangular ) adjacency matrix , minus the number of 1’s from edges that have at least one end on a node of ﬁxed degree . By deﬁnition , those 1’s cannot appear in C . Due to the symmetry of the entire matrix , the number of 1’s to be placed in the upper triangular half of C is L + P j = m i < j , j = 2 A ij − P m l = 1 k l . Each factor in the product Q ml = 1 of Eq . ( 17 ) is the degeneracy associated with a row in the matrix B . For every such row there are N − m places to put 1’s , and the number of 1’s that must be placed in the l - th row is the degree of the node k l minus the number of 1’s in the corresponding row of the entire matrix A . This latter number is the degree of the node within the subgraph A . B . Calculation of link likelihoods for undirected networks As a ﬁrst application we compute the link likelihood for two nodes in this framework . At lowest order we can just specify the degrees of the two nodes under con - sideration , giving the ensemble Z 3 with m = 2 . For 9 convenience , the two nodes are labelled 1 and 2 . The two possible conﬁgurations of this subsystem , where the nodes are either connected or disconnected , must be weighted by the appropriate degeneracy factors accord - ing to Eq . 17 . Let us denote these two conﬁgurations by ℵ and ℵ ′ . In ℵ an edge connects the two nodes , so ℵ 12 = 1 . We denote this “connected” part of the to - tal partition function Z conn 3 = Z 3 ( ℵ ) . In ℵ ′ there is no edge between the two nodes , so ℵ ′ 12 = 0 . We de - note this “disconnected” part of the total partition func - tion Z disc 3 = Z 3 ( ℵ ′ ) . The total partition function is thus Z total 3 = Z conn 3 + Z disc 3 = Z 3 ( ℵ ) + Z 3 ( ℵ ′ ) , thus p ( m = 2 ) 12 = Z conn 3 Z total 3 = Z 3 ( ℵ ) Z 3 ( ℵ ) + Z 3 ( ℵ ′ ) . ( 18 ) From Eq . 17 , the explicit expressions are Z 3 ( ℵ ) = (cid:18) (cid:0) N − 2 2 (cid:1) L + 1 − k 1 − k 2 (cid:19) 2 Y l = 1 (cid:18) N − 2 k l − 1 (cid:19) , ( 19 ) Z 3 ( ℵ ′ ) = (cid:18) (cid:0) N − 2 2 (cid:1) L − k 1 − k 2 (cid:19) 2 Y l = 1 (cid:18) N − 2 k l (cid:19) . ( 20 ) Straightforward calculation gives p ( m = 2 ) 12 ( 21 ) = (cid:20) 1 + ( L + 1 − k 1 − k 2 ) ( N − 1 − k 1 ) ( N − 1 − k 2 ) k 1 k 2 ( ( N − 2 ) ( N − 3 ) / 2 − L + k 1 + k 2 ) (cid:21) − 1 and in the limit L → ∞ , L / N 2 → 0 , and k i ≪ L this reduces to p ( m = 2 ) 12 ≈ k 1 k 2 2 L + k 1 k 2 . ( 22 ) In the limit k 1 k 2 < < L we recover from Eq . ( 22 ) the naive estimate k 1 k 2 / 2 L used by most authors . This naive esti - mate is a bad approximation if either node 1 or node 2 is a hub . In general , the full expression given in Eq . ( 21 ) is a better approximation , although as we have shown in sec - tion IV the approximate Z 3 ensemble given by Eq . ( 22 ) is both analytically tractable and signiﬁcantly better than the naive estimate . The presence of any hubs in the network reduces the link likelihood between two nodes , particularly nodes of low degree , as their links are “stolen” by the hubs . This eﬀect already appears in the calculation of the disassor - tativity , as shown in Figures 2 and 3 . We can reﬁne the preceding computation by including constraints on the degree sequence coming from the hubs . We incorporate these constraints from the hubs by considering the nodes with the highest degrees ﬁrst . The partially ﬁxed de - gree sequence ensemble Z 4 ( k 1 , k 2 , k max ) , then , includes the two nodes k 1 , k 2 whose link likelihood we compute ( free to vary over all node pairs ) and the largest hub Z conn 4 = 1 2 3 + 1 2 3 + 1 2 3 + 1 2 3 ( a ) Z disc 4 = 1 2 3 + 1 2 3 + 1 2 3 + 1 2 3 ( b ) FIG . 5 : Diagrammatic expansion for the connected ( a ) and disconnected ( b ) contributions to the partition function Z 4 for p 12 . in the network , with degree ( k max ) . In the case that k max = k 1 or k 2 we use the next largest hub degree for the third constraint . In the sub - matrices A , all possi - ble ways to connect the three nodes are enumerated . To compute the link likelihood p ( m = 3 ) ij we divide the par - tition function into connected Z conn 4 and disconnected Z disc 4 parts , where connected means an edge connects node 1 and node 2 , i . e . A 12 = 1 . The diagrammatic ex - pansion for the connected sub - partition function is shown in Fig . 5a . and the disconnected sub - partition function is shown in Fig . 5b . So we can compute the link likelihood as p ( m = 3 ) 12 = Z conn 4 Z conn 4 + Z disc 4 ( 23 ) = Z 4 ( ℵ 1 ) + Z 4 ( ℵ 2 ) + Z 4 ( ℵ 3 ) + Z 4 ( ℵ 4 ) P 8 i = 1 Z 4 ( ℵ i ) , where ℵ 1 to ℵ 8 denote the adjacency matrices for the eight graphs shown in Fig . 5 . In Fig . 6 we compare the link likelihood p ij for an undirected network in the FDS ensemble ( obtained numerically by the rewiring method ) to the analytic results in the ensembles Z 3 ( k 1 , k 2 ) and Z 4 ( k 1 , k 2 , k max ) . For each pair ( i , j ) we plot the naive es - timate k i k j 2 L on the horizontal axis ; the vertical coordinate is the ratio of the numerical ( Monte - Carlo ) estimate to the naive , no hub , and one hub estimates for that pair . The Z 3 estimate is already a substantial improvement over the naive analytic estimate , with slight further re - ﬁnement coming as expected from the inclusion of hubs in all the diagrams . C . Calculation of subgraph likelihoods for undirected networks Estimating the likelihoods of larger subgraphs can be done along exactly the same lines . As an example , we estimate the number of triangles in an undirected net - work and test this estimate on an Escherichia coli pro - tein interaction network [ 38 ] , a yeast ( Saccharomyces cerevisiae ) protein interaction network [ 40 ] , two artiﬁ - 10 TABLE I : Comparing estimates of the total number of triangles in various networks with N nodes . MC refers to Monte Carlo rewiring estimates of the FDS ensemble . As expected , the results of Eq . 24 approach the asymptotic result , Eq . ( 25 ) , for large , sparse networks . Network N Eq . ( 25 ) Eq . ( 24 ) MC % Error % Error % Error Eq . ( 25 ) vs . Eq . ( 24 ) Eq . ( 25 ) vs . MC Eq . ( 24 ) vs . MC E . coli 230 215 . 82 289 . 65 322 . 14 25 . 49 33 . 01 10 . 09 Yeast ( narrow ) 1373 302 . 77 247 . 65 339 . 10 - 22 . 26 10 . 71 26 . 97 Yeast 1373 651 . 07 592 . 59 1160 . 39 - 9 . 87 43 . 89 48 . 93 Yeast ( broad ) 1373 1553 . 94 1667 . 70 2813 . 37 6 . 82 44 . 77 40 . 72 AS Internet 22963 29157 . 38 31840 . 23 37810 . 68 8 . 43 22 . 89 15 . 79 WWW 325729 379371 . 15 379706 . 63 274926 . 89 0 . 09 - 37 . 99 - 38 . 11 FIG . 6 : Scatter plot comparing estimates of the link likelihood in an Escherichia coli protein interaction network . On the horizontal logarithmic axis we plot the naive estimate k i k j 2 L ; on the vertical logarithmic axis we plot for all corresponding nodes the ratio of the Monte - Carlo rewiring estimate to the naive , Z 3 ( no hub ) , and Z 4 ( one hub ) estimates . The latter two nearly coincide . cial yeast protein interaction networks created by mod - ifying the degree sequence of [ 40 ] by hand to make it narrower or broader , the Newman AS level map of the Internet [ 39 ] , and a symmetrized snapshot of the World Wide Web [ 41 ] . Working in an ensemble with four con - straints , Z 4 ( k 1 , k 2 , k 3 ) , we consider all permitted triples of nodes ( i , j , k ) , forbidding self - and multiple connection . Note that node 3 is no longer ﬁxed as the largest hub , but allowed to range over all nodes . Given ﬁxed nodes 1 , 2 , and 3 , we can compute the likelihood of a triangle between them as p ( m = 3 ) ∆ = Z 4 ( ℵ 4 ) P 8 i = 1 Z 4 ( ℵ i ) ( 24 ) where ℵ 4 corresponds to the fully connected subgraph , i . e . the last term in the sum of Fig . 5 ( a ) . The resulting combinatorial expression is quite unwieldy . However , in the limit L → ∞ , L / N 2 → 0 , and 1 ≪ k i ≪ L , i . e . the large , sparse network limit used in deriving Eq . ( 22 ) with the additional assumption of 1 ≪ k i , we ﬁnd a remark - able simpliﬁcation . The expression factorizes to p ( m = 3 ) ∆ ≈ P ( k 1 , k 2 ) P ( k 1 , k 3 ) P ( k 2 , k 3 ) ( 25 ) where P ( k 1 , k 2 ) is given by Eq . ( 1 ) . We now test these formulae against the various trial networks . The results are shown in Table I , where “MC” represents the averaged triangle count for many Monte Carlo rewirings , i . e . a numerical estimate of the average number of triangles in the FDS ensemble . The only no - ticeable trend is the decrease in the absolute value of the % Error ( deﬁned as [ Eq . ( 24 ) - Eq . ( 25 ) ] / Eq . ( 24 ) ) be - tween the simple factorized expression of Eq . ( 25 ) and the elaborate expression of Eq . ( 24 ) as N increases . This ver - iﬁes the approximation made in deriving Eq . ( 25 ) . The time required to make the “complex” estimate given by Eq . 24 is roughly equal to the time required to count the number of triangles for a single Monte Carlo instance ; the simple estimate given by Eq . ( 25 ) is much faster , running on the WWW data in roughly 90 seconds ( on an Intel core duo processor ) without any optimization for speed . It is tedious to verify similar factorizations for larger motifs . However , the convergence to Eq . ( 25 ) in the pre - dicted limit provides further evidence for the replacement of the naive estimate P ( k , k ′ ) = kk ′ / 2 L used e . g . in [ 42 ] , where factorizations as in Eq . ( 25 ) were assumed , with Eq . ( 1 ) . This will be the topic of future work . Such ex - tensions of our method can also be used to study larger motifs in complex networks [ 43 , 44 ] , or to study large net - works where computational time for rewiring grows pro - hibitively , but the approximation underlying Eqs . ( 22 ) and ( 25 ) should still be valid . VI . CONCLUSION Detecting and describing local structure is an impor - tant frontier in the study of complex networks , as many of the features distinguishing real - world networks from their random analogues or null models are local : degree - degree 11 correlations , motifs , and so forth . One of the major ob - stacles to this project is the lack of analytical techniques to study the ﬁxed degree sequence ensemble , which is the most common null model for complex networks as - sociated with the rewiring method . In this paper we have reviewed the numerical tools for studying the FDS ensemble and discussed some of the practical uses ( e . g . disassortativity , motif calculation , correlation proﬁles ) to which knowledge of local structure can be put . Through a careful study of the partition function of the FDS en - semble and the PFDS ensembles containing it , we derive simple and general combinatorial expressions that im - prove naive estimates of the link likelihood by explicitly including important constraints from the FDS ensemble ( the exclusion of multiple edges and self connections , and the appearance of a broad range of degrees ) in a “Gaus - sian” type approximation where the set of degree con - straints are treated minimally but non - trivially . In particular , for undirected networks we have de - veloped the analytically tractable approximate Z 3 en - semble , where the link likelihood P ( k , k ′ ) = kk ′ / ( 2 L + kk ′ ) ( Eq . ( 1 ) ) gives clear disassortativity , while the naive estimate kk ′ / 2 L does not . We have also intro - duced a diagrammatic expansion of the PFDS parti - tion function , which organizes the combinatorial calcu - lations usefully and leads to a simple , approximate fac - torized formula for the estimated number of undirected triangles between three nodes , P ( m = 3 ) ∆ ( k 1 , k 2 , k 3 ) = P ( k 1 , k 2 ) P ( k 1 , k 3 ) P ( k 2 , k 3 ) ( Eq . ( 25 ) ) where k 1 , k 2 , k 3 are the degrees of the 3 nodes . The factorization suggests the application of Eq . ( 22 ) to extended local structures such as motifs . It should be emphasized that these analytic results are not merely useful for the null model they have been ex - plicitly developed to approximate ( the FDS ensemble ) . They also provide guidance in developing more com - plicated null models that incorporate higher - level con - straints . The astronomical Z - scores observed in work on extended motifs [ 43 , 44 ] dramatize the need for such ex - tensions , which might constrain , for example , the number of triangles in addition to the number of nodes , number of links , and a few degrees . Further work will explore applications of the approximate Z 3 and other PFDS en - sembles to motif estimates , as well as the incorporation of higher - level constraints in the PFDS ensemble to im - prove likelihood estimates of extended motifs . The ex - tension of the results of this paper to directed networks is in preparation . Acknowledgements J . G . F thanks Amer Shreim for creating the correlation proﬁle in Figure 7 . We thank Gabe Musso for providing the data set of Ref . [ 40 ] . Part of this work was com - pleted at the Perimeter Institute , for which hospitality the authors express their sincere thanks . J . G . F . grate - fully acknowledges the support of the Rhodes Trust and the Alberta Ingenuity Fund . P . G . thanks iCORE for ﬁ - nancial support . VII . APPENDIX A : COMPARING NULL MODELS VIA THE CORRELATION PROFILE We can study how the real network deviates from var - ious null hypotheses by calculating R ( k , k ′ ) with respect to various null hypotheses . This provides an overall mea - sure of how close the ensembles are to each other and helps establish the relevant features that distinguish the real network from the diﬀerent ensembles . In general , we can deﬁne correlation proﬁles and Z - scores for any pair ( A , B ) of ensembles : R A | B ( k , k ′ ) = N A ( k , k ′ ) N B ( k , k ′ ) . ( 26 ) and Z A | B ( k , k ′ ) = N A ( k , k ′ ) − N B ( k , k ′ ) p σ 2 A + σ 2 B . ( 27 ) In particular , we can calculate the correlation proﬁle for the numerically sampled FDS ensemble and the ensem - ble Z 3 ( k 1 , k 2 ) . Recall that the ensemble Z 3 consists of uncorrelated random graphs with N nodes , L edges and no multiple or self - connections , where we ﬁx the de - gree of the pair of nodes whose link likelihood is being evaluated . We might also compare the FDS ensemble to Z 4 ( k 1 , k 2 , k max ) , the ensemble of uncorrelated random graphs with N nodes , L edges and no multiple or self - connections , where we ﬁx the degree of the pair of nodes whose link likelihood is being evaluated , as well as the degree of the largest node in the network , k max . In Z 3 and Z 4 , p ij can be calculated exactly ( see Section V ) . We plot R Z 3 | FDS ( k , k ′ ) for the Escherichia coli protein inter - action network in Fig . 7 . It is clear that the Z 3 ensemble captures many of the features of the FDS ensemble , as R Z 3 | FDS ( k , k ′ ) is close to 1 for all k , k ′ . R Z 4 | FDS ( k , k ′ ) exhibits slight improvement over Z 3 , as expected ( data not shown ) . The correlation proﬁle allows us to identify correlations due to the degrees of the other nodes in the network and provides a test of our hypothesis that the PFDS ensemble captures much of the structure of the FDS ensemble . 12 5 10 15 20 25 30 35 5 10 15 20 25 30 35 k k ’ 0 . 7 0 . 8 0 . 9 1 1 . 1 FIG . 7 : Correlation proﬁle R Z 3 | FDS ( k , k ′ ) for the Escherichia coli protein interaction network [ 38 ] . Note that the dark blue regions are artiﬁcially set to the value . 7 ; they correspond to values of ( k , k ′ ) for which no data exist . VIII . APPENDIX B : DERIVATION OF Z m + 1 FOR UNDIRECTED NETWORKS We note that the number of possible undirected subgraphs of m nodes is 2 ( m 2 − m ) / 2 . So we write : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { A ij } X { B ij } X { C ij } δ ( L − ( j = m X i < j j = 2 A ij ) − ( j = N X i ≤ m j = m + 1 B ij ) − ( i = N X i < j i = m + 1 C ij ) ) × m Y l = 1 δ ( k l − l − 1 X j = 1 A jl − m X j = l + 1 A lj − N X j = m + 1 B lj ) ( 28 ) For concision we henceforth write the sum more compactly , as in the next equation . We now Fourier transform the delta - functions : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { ABC } 1 ( 2 π ) m + 1 Z π − π . . . Z π − π dzda 1 . . . da m e ız ( L − P j = m i < j j = 2 A ij ) × m Y l = 1 e ıa l ( k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj ) m Y l = 1 N Y j = m + 1 e − ı ( z + a l ) B lj N Y i < j i = m + 1 e − ızC ij ( 29 ) We can do the sum over B ij , yielding : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { AC } 1 ( 2 π ) m + 1 Z π − π . . . Z π − π dzda 1 . . . da m e ız ( L − P j = m i < j j = 2 A ij ) × m Y l = 1 e ıa l ( k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj ) m Y l = 1 ( 1 + e − ı ( z + a l ) ) N − m N Y i < j i = m + 1 e − ızC ij ( 30 ) Performing the standard binomial expansion yields : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { AC } 1 ( 2 π ) m + 1 Z π − π . . . Z π − π dzda 1 . . . da m e ız ( L − P j = m i < j j = 2 A ij ) × m Y l = 1 e ıa l ( k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj ) m Y l = 1 N − m X n l = 0 (cid:18) N − m n l (cid:19) e − ın l ( z + a l ) N Y i < j i = m + 1 e − ızC ij ( 31 ) 13 Integrating over a 1 . . . a m sets n l = k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj , so we have : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { AC } 1 ( 2 π ) Z π − π dze ız ( L − P j = m i < j j = 2 A ij ) × m Y l = 1 e − ız ( k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj ) (cid:18) N − m k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj (cid:19) N Y i < j i = m + 1 e − ızC ij ( 32 ) We now sum over C ij and perform the binomial expansion of the resulting quantity : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { A } 1 ( 2 π ) Z π − π dze ız ( L + P j = m i < j j = 2 A ij − P ml = 1 k l ) × m Y l = 1 (cid:18) N − m k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj (cid:19) ( N − m 2 ) X n = 0 (cid:18)(cid:0) N − m 2 (cid:1) n (cid:19) e − ızn ( 33 ) where we have used the fact that m Y l = 1 e ız ( P l − 1 j = 1 A jl + P mj = l + 1 A lj ) = e ız ( P ml = 1 ( P l − 1 j = 1 A jl + P mj = l + 1 A lj ) ) = e 2 ız P j = m l < j j = 2 A lj by the symmetry of the adjacency matrix . We may now integrate over z to give the result : Z m + 1 ( N , L , k 1 , . . . , k m ) = X { A } (cid:18) (cid:0) N − m 2 (cid:1) ( L + P j = m i < j , j = 2 A ij − P ml = 1 k l ) (cid:19) m Y l = 1 (cid:18) N − m k l − P l − 1 j = 1 A jl − P mj = l + 1 A lj (cid:19) ( 34 ) This can be written as a sum over sub - partition sums Z m + 1 ( A ) , each of which is given by Eq . ( 17 ) . Thus we recover the result for ﬁxed A given in Section V . [ 1 ] J . Theiler , S . Eubank , A . Longtin , B . Galdrikian , and J . D . Farmer , Physica D 58 , 77 ( 1992 ) . [ 2 ] T . Schreiber and A . Schmitz , Physica D 142 , 346 ( 2000 ) . [ 3 ] S . Maslov and K . Sneppen , Science 296 , 910 ( 2002 ) . [ 4 ] R . Milo , N . Kashtan , S . Itzkovitz , M . E . J . Newman , U . Alon , preprint arXiv / cond - mat / 0312028v2 ( 2004 ) . [ 5 ] Y . G . Chen , P . Diaconis , S . R . Holmes , and J . S . Liu , J . Amer . Statist . Assoc . 100 , 109 ( 2005 ) . [ 6 ] M . E . J . Newman , SIAM Review 45 , 167 - 256 , preprint arXiv / cond - mat / 0303516v1 ( 2003 ) . [ 7 ] M . E . J . Newman , Phys . Rev . E 64 , 016131 ( 2001 ) . [ 8 ] S . Gupta , R . M . Anderson , and R . M . May , AIDS 3 , 807 - 817 ( 1989 ) . [ 9 ] M . Kretzschmar , Y . T . H . P . van Duynhoven , and A . J . Sev - erijnen , Am . J . Epidemiol . 144 , 306 - 317 ( 1996 ) . [ 10 ] J . Camacho , R . Guimer ` a , and L . A . N . Amaral , Phys . Rev . Lett . 88 , 228102 ( 2002 ) . [ 11 ] S . A . Kauﬀman in A . Moscana and A . Monroy ( eds . ) Cur - rent Topics in Developmental Biology 6 , 145 - 182 ( Aca - demic Press , New York , 1971 ) . [ 12 ] J . Davidsen , P . Grassberger , M . Paczuski , Geophys . Res . Lett . , 33 , L11304 ( 2006 ) . [ 13 ] M . Paczuski , “Networks as Renormalized Models for Emergent Behavior in Physical Systems” , in C . Beck , G . Benedek , A . Rapisarda & C . Tsallis ( eds . ) Complex - ity , Metastability and Nonextensivity ( World Scientiﬁc , London , 2005 ) . [ 14 ] R . Albert and A . - L . Barab´asi , Rev . Mod . Phys . 74 , 47 ( 2002 ) . [ 15 ] A . S . N . Dorogovtsev and J . F . F . Mendes , Adv . Phys . 51 , 1079 ( 2002 ) . [ 16 ] B . Bollobas , Random graphs ( Cambridge Univ . Press , 2001 ) . [ 17 ] This is the number of ways of placing L identical objects ( in this case “1”s ) in N ( N − 1 ) / 2 places . [ 18 ] J . Park and M . E . J . Newman , Phys . Rev . E 68 , 026112 ( 2003 ) . [ 19 ] J . Park and M . E . J . Newman , Phys . Rev . E 70 , 066117 ( 2004 ) . [ 20 ] L . Bogacz , Z . Burda , and B . Waclaw , Physica A , 366 , 587 ( 2006 ) . [ 21 ] B . Y . Wang and F . Zhang , Discrete Math . 187 , 211 ( 1998 ) . [ 22 ] E . A . Bender and E . R . Canﬁeld , Journal of Combinatorial Theory A 24 , 296 - 307 ( 1978 ) . [ 23 ] R . Milo , S . Shen - Orr , S . Itzkovitz , N . Kashtan , D . Chklovskii , and U . Alon , Science 298 , 824 ( 2002 ) . [ 24 ] S . J . Liu , Monte Carlo Strategies in Scientiﬁc Computing 14 ( Springer , New York 2001 ) . [ 25 ] P . Grassberger , Computer Physics Communications 147 , 64 ( 2002 ) . [ 26 ] J . Besag and P . Cliﬀord , Biometrica 76 , 633 ( 1989 ) . [ 27 ] A . R . Rao , R . Jana , and S . Bandyopadhya , Indian J . Statistics 58 , 225 ( 1996 ) . [ 28 ] J . M . Roberts Jr . , Social Networks 22 , 273 ( 2000 ) . [ 29 ] G . W . Cobb and Y . - P . Chen , American Mathematical Monthly 110 , 265 ( 2003 ) . [ 30 ] In many cases one wants to construct a surrogate ensem - ble with the same degree sequence as a given graph G . If a given graph G is available , one does not need this ﬁrst step , and starts from G directly . [ 31 ] H . J . Ryser , Can . J . Math . 9 , 371 ( 1957 ) . [ 32 ] F . T . Wall and J . J . Erpenbeck , J . Chem . Phys . 30 , 634 ( 1959 ) . [ 33 ] S . Maslov , K . Sneppen , and A . Zaliznyak , Physica A 333 , 529 ( 2004 ) . [ 34 ] M . E . J . Newman , Phys . Rev . Lett . 89 , 208701 - 1 ( 2002 ) ; Phys . Rev . E 67 , 026126 ( 2003 ) . Phys . Rev . E 68 , 026127 ( 2003 ) . [ 35 ] P . Mahadevan , D . Krioukov , K . Fall , and A . Vahdat , “A Basis for Systematic Analysis of Network Topologies” , SIGCOMM ’06 , preprint arXiv / cs . NI / 0605007v2 ( 2006 ) . [ 36 ] M . Catanzaro , M . Bogu˜n´a , R . Pastor - Satorras , Phys . Rev . E 71 , 027103 , preprint arXiv / cond - mat / 0408110v1 ( 2005 ) . [ 37 ] L . Goldwasser and J . Roughgarden , Ecology 74 , 1216 - 1233 ( 1993 ) . [ 38 ] G . Butland et al . , Nature 433 , 531 ( 2005 ) . [ 39 ] M . Newman , data at URL www - personal . umich . edu / ∼ mejn / netdata / ( 2006 ) . [ 40 ] A . C . Gavin et al . , Nature 440 , 631 ( 2006 ) ; data received from G . Musso ( University of Toronto ) . [ 41 ] R . Albert , H . Jeong and A . - L . Barab´asi , Nature 401 , 130 ( 1999 ) ; data at www . nd . edu / ∼ networks / resources . htm . [ 42 ] S . Itzkovitz , R . Milo , N . Kashtan , G . Ziv , and U . Alon , Phys . Rev . E 68 , 026127 , preprint arXiv cond - mat / 0302375 ( 2003 ) . [ 43 ] K . Baskerville and M . Paczuski , Phys . Rev . E 74 , 051903 , preprint arXiv q - bio . QM / 0606023 ( 2006 ) . [ 44 ] K . Baskerville , P . Grassberger , and M . Paczuski , preprint arXiv q - bio / 0702029 ( 2007 ) .
a r X i v : 0709 . 3431v1 [ phy s i c s . s o c - ph ] 21 S e p 2007 K - Scaﬀold subgraphs of Complex networks Bernat Corominas - Murtra 1 , Sergi Valverde 1 , Carlos Rodr´ıguez - Caso 1 Ricard V . Sol´e 1 , 2 1 ICREA - Complex Systems Lab , Universitat Pompeu Fabra , Dr . Aiguader 80 , 08003 Barcelona , Spain 2 Santa Fe Institute , 1399 Hyde Park Road , New Mexico 87501 , USA Complex networks with high numbers of nodes or links are often diﬃcult to analyse . However , not all elements contribute equally to their structural patterns . A small number of elements ( the hubs ) seem to play a particularly relevant role in organizing the overall structure around them . But other parts of the architecture ( such as hub - hub connecting elements ) are also important . In this letter we present a new type of substructure , to be named the K - scaﬀold subgraph , able to capture all the essential network components . Their key features , including the so called critical scaﬀold graph , are analytically derived . Introduction . Networks pervade complexity [ 1 , 2 , 3 , 4 ] . How networks are organized at diﬀerent scales is one of the main topics of complex network research [ 5 , 6 , 7 , 8 , 9 , 10 ] . Some approaches are based on the study of given subgraphs , from the smaller network motifs [ 7 , 8 , 11 ] to K - cores [ 6 , 12 ] , spanning trees [ 10 ] or gradient subgraphs obtained form a given internal system’s dynamics [ 9 ] . One of the most studied subgraphs is the so - called K - core , formally deﬁned by Bollob ` as in [ 13 ] . The K - core of a graph G , C k ( G ) is the largest subgraph whose vertices have , at least , degree k ≥ K . The behaviour of such subgraph , and its percolation properties have been widely studied [ 6 , 13 , 14 , 15 , 16 ] . K - cores display interesting features with several implications in the study of real networks , both at the theoretical and applied level [ 6 , 12 , 14 , 17 ] . Hubs are the center of attention of the K - core . They are responsible for the eﬃcient communication among net - work units and their failure or removal can have dramatic consequences [ 18 ] . But other graph components are also relevant to understand network behavior . In particular , hubs are often related through other elements exhibit - ing low connectivity , the so - called conectors . Despite its relevance , the K - core fails in ﬁnding the hub - connector structure . This pattern is essential in highly dissassorta - tive or modular networks , where hub - hub conectors play a crucial role [ 2 ] . In such networks , robustness against failures is strongly tied to hubs , but also to the hub - conector structure . Moreover , conectors can display high betweness centrality [ 2 ] despite their low conectivity , re - inforcing the role of this kind of nodes in non - local orga - nization of the global topology and dynamics . To overcome these limitations , we introduce a subgraph deﬁnition which captures the previous traits . Speciﬁ - cally , we consider a subgraph that includes the most con - nected nodes and their connectors , if any . In doing so , we want to explore wether there is some fundamental hub - connector subgraph and its relevant properties . Such a graph , the so - called K - scaﬀold subgraph , was recently introduced ( in qualitative terms ) within the context of the human proteome [ 19 ] . This network included only transcription factors , i . e . proteins linking to DNA and thus involved in regulating gene expression ( ﬁg 1 ( a ) ) . Speciﬁcally , it was shown that an appropiate choice of relevant hubs and their connectors allowed to deﬁne a functionally meaningful subgraph . Such subgraph con - tained a large number of cancer - related proteins around which well - deﬁned modules were organized as evolution - arily and functionally related subsets . Here , we deﬁne this subgraph in a rigorous way . We analitically charac - terize its properties and degree distributions as well as the presence of a special class of minimal scaﬀold graph based on a critical percolation threshold . K - Scaﬀold subgraphs . Let us consider a graph G ( V , Γ ) , where V is the set of nodes and Γ the set of edges connect - ing them . The K - Scaﬀold subgraph S K ( G ) will consider the degree of nodes k ( e i ) , e i ∈ E but it will take into account correlations : Speciﬁcally , if we choose a node e i ∈ V , it will belong to S K ( G ) if and only if ( 1 ) K ≤ k i or ( 2 ) e i is connected to e j ∈ V , and e j is such that K ≤ k j . Thus , given a graph G ( V , Γ ) , with its adjacency matrix a ij , the K - scaﬀold of G will be deﬁned as : S ij = (cid:26) a ij iﬀ ( K ≤ k i ∨ K ≤ k j ) 0 otherwise ( 1 ) An example of such K - scaﬀold subgraph is shown in ( ﬁg . ( 1b ) ) . This allows us to deﬁne , from a given graph G a nested hierarchy of subgraphs S K ( G ) such that : . . . S K + 1 ( G ) ⊆ S K ( G ) ⊆ S K − 1 ( G ) . . . ( 2 ) To clarify which elements are really relevant , we also de - ﬁne a naked K - scaﬀold subgraph . From the K - scaﬀold subgraph , S K ( G ) , the naked K - scaﬀold , γ K ( G ) , is ob - tained by removing all nodes having a single link ( the “hair” of the graph ) ( ﬁg . ( 1c ) ) . Thus , from S ij , it is easy to compute the adjacency matrix of the naked K - scaﬀold subgraph , namely : γ ij = S K ( a ij ) ( 1 − δ k i , 1 ) ( 1 − δ k j , 1 ) ( 3 ) Additionally , if two or more connectors have identical pattern of conectivity in γ K ( G ) ( i . e . , they are connected to exactly the same hubs , understanding hubs as nodes with k ≥ K ) , we renormalize these sets of connectors by replacing each of them with a single node . In this way , the renormalized K - scaﬀold subgraph , γ K ( G ) , keeps the relevant elements without redundancies ( ﬁg . ( 1d ) ) . 2 (cid:0) (cid:1) (cid:2)(cid:1) (cid:3)(cid:1) (cid:4)(cid:1) FIG . 1 : ( a ) The Human Transcription Factor interaction Network ( HTFN ) . ( b ) its 11 - Scaﬀold subgraph . ( c ) The naked 11 - scaﬀold subgraph and ( d ) the naked and renormalized 11 - scaﬀold subgraph . The K - scaﬀold subgraph displays a fundamental hub - connector structure that organizes the general topology of the whole system . Data from [ 19 ] . Statistical Properties . Here we derive the main statistical features of the K - scaﬀold subgraph from an arbitrary , uncorrelated network G . First , we compute the fraction of nodes in G belonging to S K ( G ) , i . e . , the probability for a random choosen node of G to belong to S K ( G ) . If we deﬁne q < K = X k < K kP ( k ) h k i G ( 4 ) We can deﬁne f as : f = 1 − X k < K P ( k ) ( q < K ) k ( 5 ) Where we have to read the second term of equation ( 5 ) as the probability to ﬁnd a node with k < K such that all of its k ﬁrst neighbours have k ′ < K . We could consider or not links connecting connectors , i . e . , nodes with k < K but connected to nodes with k ≥ K . In order to simplify algorithmic procedures , it is reasonable to avoid such connector - connector links . If we avoid these class of links , the probability for a randomly choosen link to belong to the K - scaﬀold is , simply : h = 1 − ( q < K ) 2 ( 6 ) However , for mathematical consistency , it is necessary to take into account such kind of links . If we do so , the probability for a randomly choosen link to belong to the K - scaﬀold is : h = 1 − X k < K q ( k ) ( q k < k ) k − 1 ! 2 ( 7 ) To complete our characterization , we ﬁnd the degree dis - tribution of S K ( G ) . To do the job , we need to deﬁne the probability that a node whith degree less than K is con - nected to exactly k nodes whose connectivity is equal or higher than K , namely : g ( k , K ) = X k < i < K P ( i ) ( 1 − q < K ) k ( q < K ) i − k ( 8 ) 3 The probability distribution for k ’s above K in the K - scaﬀold is the same probability distribution of the sub - strate graph G , multiplied by a normalization factor f . To see this , we can see that , from the deﬁnition of g ( k , K ) we have : X k < K g ( k , K ) + ∞ X k ≥ K P ( k ) = | N | S k ( G ) | N | G = f ( 9 ) Thus , the normalized degree distribution of S K ( G ) will be : P S K ( k ) = (cid:26) g ( k , K ) / f , iﬀ k < K P ( k ) / f , otherwise ( 10 ) Minimal K - Scaﬀold subgraphs . The previous deﬁnitions refer to K - dependent subgraphs , being K arbitrary . But we can ask if some specially relevant K value is involved . In otherwords , since larger K values support smaller scaf - fold graphs , we might ask what is the limit in this process and what is keeped before the network is fragmented or too small . The question we are addressing concerns the existence of a characteristic scale . The minimal scaﬀold subgraph will label the minimal substructure capturing the fundamental hub - connector architecture of the net , if it exists . This subcritical subgraph will be located imme - diatly above of the percolation threshold of G , considering how the K - scaﬀold performs node deletion . Following the conﬁguration model [ 20 ] , we consider very large random graphs with an arbitrary degree distribution [ 21 ] . Thus , given a graph G we compute S K ( G ) by increasing K un - til it breaks down into many unconnected components . The probability for a node to belong to the K - scaﬀold subgraph will be a function of its connectivity k . We will refer to this function as f k : f k = (cid:26) 1 , iﬀ k ≥ K 1 − ( q < K ) k , otherwise ( 11 ) Clearly , a node with degree k < K has a probability 1 − ( q < K ) k to be connected with at least to one node with degree higher than K . Now we deﬁne the generat - ing functions [ 6 , 21 , 22 , 23 ] , taking in account that to compute the K - scaﬀold implies deleting a given fraction nodes [ 23 ] , namely : F 0 ( x ) = ∞ X k P ( k ) f k x k ( 12 ) Let us deﬁne F 1 ( x ) as : F 1 ( x ) = 1 h k i G ∞ X k kP ( k ) f k x k − 1 = 1 h k i G dF 0 ( x ) dx ( 13 ) Using previous theoretical results [ 21 , 22 , 23 ] , we com - pute the generating functions for the probability distri - bution of component sizes other than the giant compo - nent , if any . H 1 ( x ) will be deﬁned as the generating function for the probability that one end of a randomly choosen edge on the network G - when computing its K - scaﬀold - leads to a connected component of a given num - ber of nodes . This includes the probability that such component will contain zero nodes , because of the dele - tion of nodes of G when computing the K - scaﬀold . As we discussed above , this will happen with a probability 1 − f = 1 − F 1 ( 1 ) . The end of the edge can be occupied by a node with k outgoing edges , distributed along F 1 ( x ) [ 23 ] . Thus , it leads us to the self - consistency equation [ 21 , 22 , 23 ] - for a clear and detailed derivation of these results , see [ 22 , 24 ] : H 1 ( x ) = 1 − F 1 ( 1 ) + xF 1 ( H 1 ( x ) ) ( 14 ) And the generating function for the size of the component to which a random choosen node belongs will be [ 21 , 22 , 23 ] : H 0 ( x ) = 1 − F 0 ( 1 ) + xF 0 ( H 1 ( x ) ) ( 15 ) The size of the giant component S K that we will further identify with the K - scaﬀold subgraph will be S K = F 0 ( 1 ) − F 0 ( v ) ( 16 ) where v is the ﬁrst non trivial , physically relevant solu - tion of v = 1 − F 1 ( 1 ) + F 1 ( v ) ( 17 ) We can now look for a singularity in the average size of components . Immediately above of this point we deﬁne the minimal S K ( G ) . Knowing that h s i = dH 0 ( x ) dx (cid:12)(cid:12)(cid:12)(cid:12) x = 1 ( 18 ) we ﬁnd , after some algebra [ 21 , 22 , 23 ] : h s i = F 0 ( 1 ) + dF 0 ( x ) dx (cid:12)(cid:12)(cid:12)(cid:12) x = 1 × F 1 ( 1 ) 1 − dF 1 ( x ) dx (cid:12)(cid:12)(cid:12) x = 1 ( 19 ) With a singularity when [ dF 1 ( x ) / dx ] x = 1 = 1 . Now using : dF 1 ( x ) dx (cid:12)(cid:12)(cid:12)(cid:12) x = 1 = 1 h k i G ∞ X k k ( k − 1 ) f k P ( k ) ( 20 ) we can derive the percolation condition for a K - scaﬀold graph from a given substrate graph G ( V , Γ ) with given average conectivity h k i G and degree distribution P ( k ) . We compute such condition taking in account the above critical condition ( 20 ) . ( Recall that computations are performed considering the successive pruning of G by in - creasing K ) . Knowing that : ∞ X k kP ( k ) h k i G = 1 ( 21 ) 4 1 10 100 1000 K 0 . 001 0 . 01 0 . 1 0 50 100 150 200 250 300 K 0 . 001 0 . 01 0 . 1 1 1 10 100 1000 K 0 . 001 0 . 01 0 . 1 0 20 40 60 80 K 0 0 . 2 0 . 4 0 . 6 0 . 8 1 S a b c d FIG . 2 : Numerical simulations of the relative size of the giant component S K of the K - scaﬀold subgraphs of model degree distributions against K . S K is computed as S K = F 0 ( 0 ) − F 0 ( v ) , where v is the numerical approach of the ﬁrst non - trivial , physically relevant solution of the the equation v = 1 − F 1 ( 1 ) + F 1 ( v ) ( See text ) . The plots display S K for ( a ) Erd¨os - R´enyi graph , whith h k i = 15 . ( b ) A Scale - free network with P ( k ) ∝ k − α , α = 2 . 3 . No K c can be properly identiﬁed ( see text ) . The presence of the cut - oﬀ can be due to the ﬁnite size eﬀects of the simulation ; ( c ) Exponential net with P ( k ) ∝ e − k / K , K = 13 ( d ) Power Law with exponential cut oﬀ net with P ( k ) ∝ k − α e − k / K , for α = 2 . 5 and K = 52 . and since equation ( 20 ) is equivalent to : ∞ X k k ( kf k − f k − 1 ) P ( k ) = 0 ( 22 ) the percolation condition for a K - scaﬀold , S K , is : X k k ( kf k − f k − 1 ) P ( k ) > 0 ( 23 ) We can easily see such a condition as the extension of the Molloy and Reed criteria [ 25 ] for the K - scaﬀold , S K ( G ) : ∞ X k k ( k − 2 ) P ( k ) > X k < K k ( k − 1 ) q k < K P ( k ) ( 24 ) Note that the right - hand side of the equation ( 24 ) is al - ways ﬁnite , whereas the left - hand side could not be ﬁnite . Indeed , note that q < K ≤ 1 , thus , ( q < K ) k ≤ 1 ( 25 ) Futhermore , P ( k ) ≤ 1 . Thus , the sum X k < K k ( k − 1 ) q k < K P ( k ) < ∞ ( 26 ) is always ﬁnite provided that k is bounded . It is straigh - forward that : ∞ X k k ( k − 2 ) P ( k ) = h k 2 i − 2 h k i ( 27 ) Thus , a ﬁnite K for the critical scaﬀold will exist if and only if the degree distribution of the network has a ﬁ - nite second moment h k 2 i . An Erd¨os - R´enyi graph , for example , will display a critical K - scaﬀold , provided that h k 2 i ER = h k i 2 . But for arbitrary large scale - free net - works with realistic exponents ( 2 < α < 3 ) , we ﬁnd that there is not such minimal K - scaﬀold . This is due to the divergence of the second moment . Thus , condition ( 24 ) always applies for all K ’s . Implications should be studied , provided that it implies that the hub - conector structure appears at all scales . Numerical simulations ( Fig . ( 2 ) ) show that if we intro - duce a cut - oﬀ in the degree distribution , a characteristic scale K c is present . In E - R graphs , the size of the K - scaﬀold displays an abrupt decay beyond h k i . Finally , the size of S K ( G ) displays a critical K in exponential networks . Note that by its deﬁnition , if S K ( G ) perco - lates , also do the corresponding naked and renormalized counterparts ( γ K ( G ) and γ K ( G ) ) . Discussion . K - Scaﬀold subgraphs can be easily mea - sured on any arbitrary network and can be useful to de - tect both key elements and the topological components that glue them . If topological organization is linked with functionality , particularly in relation to hubs , the scaf - fold of a complex network should be able to capture the relevant subsystem . For the human transcription factor network [ 19 ] it was found that for K = 11 , a small set of proteins having relevant cellular functions ( including oncogenes , tumor supressor genes and the TATA - binding protein ) was obtained , being all of them related through intermediate connector proteins . This is in agreement with the dissasortative character of celullar networks . Since each hub was associated to a group of functionally related TFs , the connectors were actually relating diﬀer - ent parts of the protein machinery . Other real systems have also been analysed and provided further conﬁrma - tion of the relevance of the scaﬀold approach ( Corominas Murtra et al , in preparation ) . Further extensions and properties of this subgraph , togheter with te analysis of ﬁnite size eﬀects associated to real systems will be pre - sented elsewhere . Acknowledgments The authors thank the members of the Complex Sys - tems . This work has been supported by grants FIS2004 - 5 0542 , IST - FET ECAGENTS , project of the European Community founded under EU R & D contract 01194 , by the EU within the 6th Framework Program under con - tract 001907 ( DELIS ) , by NIH 113004 , FIS2004 - 05422 and by the Santa Fe Institute . [ 1 ] Albert , R . and Barabasi , A . ( 2001 ) Rev . Mod . Phys . 74 , 47 . [ 2 ] Newman , M . E . J . ( 2003 ) SIAM Review 45 , 167 . [ 3 ] Dorogovtsev , S . N . and Mendes , J . F . F . ( 2002 ) Adv . Phys . 51 , 1079 - 1187 . [ 4 ] Boccaletti , S . ; Latora , V . ; Moreno , Y . ; Chavez , M . and Hwang , D . - U . ( 2006 ) Physics Reports 424 , 175 . [ 5 ] Palla , G . ; Derenyi , I . ; Farkas , I . and Vicsek ( 2005 ) . Na - ture 435 , 814 . [ 6 ] S . N . Dorogovtsev , A . V . Goltsev , and J . F . F . Mendes . ( 2006 ) Phys . Rev . Lett . 96 , 040601 1 - 4 . [ 7 ] S . Itzkovitz , R . Milo , N . Kashtan , G . Ziv and U . Alon ( 2003 ) Phys . Rev . E 68 , 026127 . [ 8 ] Milo R . , Shen - Orr S . , Itzkovitz S . , Kashtan N . , Chklovskii D . and Alon U . ( 2002 ) Science 298 , 824 - 827 . [ 9 ] Z . Toroczkai , B . Kozma , K . E . Bassler , N . W . Hengart - ner , and G . Korniss ( 2004 ) . arXiv : cond - mat / 0408262 . [ 10 ] Kim , D . H . ; Noh , J . D . ; Jeong , H . ( 2004 ) Phys . Rev . Lett . 96 , 018701 . [ 11 ] Valverde , S . and Sol´e , R . V . ( 2005 ) Phys . Rev . E 72 , 026107 . [ 12 ] J . I . Alvarez - Hamelin , L . Dall’Asta , A . Barrat and A . Vespingani , cs . NI / 0504107 ; cs . NI / 0511007 [ 13 ] Bollob ` as , B . ( 1984 ) Graph Theory and Combinatorics : Proc . Cambridge Combinatorial Conference in honour of Paul Erd¨os . ( B . Bollob ` as , ed ) Academic Press , New York . [ 14 ] Fernholz , D . and Ramachandran , V . ( 2004 ) Technical Re - port TR04 - 13 , University of Texas at Austin . G / A . [ 15 ] Molloy , M . and Reed , B . ( 1999 ) . Electronic J . Comb . 6 , R35 . [ 16 ] Molloy , M . ( 1996 ) Random Structures and Algorithms 8 , 159 - 160 . [ 17 ] S . Wuchty and E . Almaas , ( 2005 ) BMC Evol Biol . 5 , 24 [ 18 ] Albert , R . , Jeong , H . , Barabasi , A . ( 2000 ) Nature 407 , 651 . [ 19 ] Rodriguez - Caso C . , Medina M . A . , Sol´e R . V . ( 2005 ) FEBS Journal 272 , 6423 . [ 20 ] A . Bekessy , P . Bekessy , J . Komlos , ( 1972 ) Stud . Sci . Math . Hungar . 7 , 343 ; E . A . Bender , E . R . Canﬁeld , ( 1978 ) J . Combinatorial Theory A 24 , 296 ; B . Bollob´as , ( 1980 ) Eur . J . Comb . 1 , 311 ; N . C . Wormald , ( 1981 ) J . Combinatorial Theory B 31 , 156 , 168 . [ 21 ] Newman , M . E . J . ; Strogatz , S . H . ; Watts , D . J . ( 2001 ) Phys . Rev . E 64 026118 . [ 22 ] Moore C . , Newman M . E . J . ( 2000 ) Phys . Rev . E , 62 , 7059 - 7064 . [ 23 ] Callaway , D . S . , Newman , M . E . J . , Strogatz , S . E and Watts , D . J . ( 2000 ) Phys . Rev . lett . 85 , 5468 . [ 24 ] Newman , M . E . J . ( 2002 ) arXiv : cond - mat / 0202208 v1 [ 25 ] Molloy , M . and Reed , B . ( 1995 ) Random Structures and Algorithms 6 , 161 - 180 .
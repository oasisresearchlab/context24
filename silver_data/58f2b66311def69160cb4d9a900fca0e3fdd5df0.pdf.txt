JOURNAL . OF COMPUTATIONAL PHYSICS 22 , 245 - 268 ( 1976 ) Efficient Estimation of Free Energy Differences from Monte Carlo Data CHARLES H . BENNETT IBM Thomas J . Watson Research Center , Yorktown Heights , New York 10598 Received February 13 , 1976 ; accepted May 3 , 1976 Near - optimal strategies are developed for estimating the free energy difference between two canonical ensembles , given a Metropolis - type Monte Carlo program for sampling each one . The estimation strategy depends on the extent of overlap between the two ensembles , on the smoothness of the density - of - states as a function of the difference potential , and on the relative Monte Carlo sampling costs , per statistically independent data point . The best estimate of the free energy difference is usually obtained by dividing the available computer time approximately equally between the two ensembles ; its efficiency ( variance x computer time ) - ’ is never less , and may be several orders of magnitude greater , than that obtained by sampling only one ensemble , as is done in perturbation theory . I . INTRODUCTION A well - known deficiency of the Monte Carlo [ I , 21 and molecular dynamics [ 3 ] methods , commonly used to study the thermodynamic properties of classical systems having 1Oa to IO4 degrees of freedom , is their inability to calculate quantities such as the entropy or free energy , which cannot be expressed as canonical or microcanonical ensemble averages . In general , the free energy of a Monte Carlo ( MC ) or molecular dynamics ( MD ) system can be determined only by a procedure analogous to calorimetry , i . e . , by establishing a reversible path between the system of interest and some reference system of known free energy . “Computer calorimetry” has a considerable advantage over laboratory calorimetry in that the reference system may differ from the system of interest not only in its thermo - dynamic state variables but also in its Hamiltonian , thereby making possible a much wider variety of reference systems and reversible paths . Often the path between an analytically tractable reference system and the system of ultimate physical interest will include one or more intermediate systems . These may be interesting in their own right ( e . g . , the hard sphere fluid ) , or they may be special systems , important only as calorimetric stepping stones , whose Hamiltonians contain artificial terms designed to stabilize the system against phase transitions [ 4 , 51 , induce favorable importance weighting [ 6 , 71 , or otherwise enhance the system’s efficiency as a computational tool [ 8 - lo ] . 245 Copyright 0 1976 by Academic Press , Inc . All rights of reproduction in any form reserved . 246 CHARLES H . BENNETT Whether the calorimetric path has one step or many , one eventually faces the statistical problem of extracting from the available data the best estimate of the free energy differences between consecutive systems . Specializing the question somewhat , one might inquire what is the best estimate one can make of the free energy difference between two MC systems ( i . e . , two canonical ensembles on the same configuration space ) , given a finite sample of each ensemble . Section II of this paper derives the “acceptance ratio estimator , ” a near - optimal solution of this estimation problem , based only on the data in the two ensemble samples ( a special case is the estimation of the free energy difference between two ensembles using data from only one of them ; however , it will be argued that it is usually preferable to gather data from both ensembles ) . The efficiency of the acceptance ratio estimator is proportional to the degree of overlap between the two ensembles . Section III presents a related method , the “interpolation method , ” which yields an improved free energy estimate under an additional assumption that is often physically justified , namely , that the density of states in each ensemble is a smooth function of the difference potential . When this assumption is justified , the inter - polation method can yield a good free energy estimate even when the overlap between the two ensembles is negligible . On the other hand , when the two ensembles neither overlap nor satisfy this smoothness assumption , no method of statistical analysis can yield a good estimate of the free energy difference , and one must collect additional MC data from one or more ensembles intermediate between the two originally considered . Section IV compares the present methods with older methods of MC free energy estimation , viz , numerical integration of a derivative of the free energy , perturbation theory , and previous overlap methods . This section also discusses some of the problems of designing and sampling intermediate ensembles . II . THE ACCEPTANCE RATIO METHOD IIa . Acceptance Probabilities and Configurational Integrals In this section the acceptance ratio method , to be developed more rigorously in Sections IIb and IIc , will be discussed from a physical and qualitative point of view . In most classical systems of interest the kinetic part of the canonical partition function is trivially calculable ; hence the problem of finding the free energy of a given ( N , T , I’ ) macrostate reduces to that of evaluating the canonical con - figurational integral Q = 1 ev - uU ( q , . . . qdl dq , . . . dqN . MONTE CARLO FREE ENERGY ESTIMATION 247 Here U = @ / kT is the temperature - scaled potential energy , a function of the System’s N COIIfigUI’atiOnal degrees Of freedom , q1 , q2 , . . . , qN . It iS COIIVenient to allow U sometimes to take on the “value” plus infinity ( but never minus infinity ) so that external constraints , such as those that define the system’s volume and shape , may be incorporated directly in the potential function and Q may be defined , as above , by an unbounded integral . With these conventions any nonsingular probability density p ( q ) may be viewed as a canonical ensemble density , determined by a potential of the form U ( q ) = const - In p ( q ) . Existing methods are incapable , in general , of evaluating integrals of the form ( l ) , because the dominant contribution typically comes from a small but intricately shaped portion of configuration space ; however it is not difficult to derive useful formulas for the ratio between two such integrals , defined by two dzferent potential functions , U , , and U , , acting on the same configuration space { ( ql . . . qN ) } . Equation ( 4 ) , for example , to be derived presently , expresses the ratio Q , / Q , as a ratio of canonical averages involving the “Metropolis” function , M ( x ) = min { l , exp ( - x ) > . The Metropolis function , because it has the property M ( x ) / M ( - x ) = exp ( - x ) , is used in the standard Monte Carlo algorithm [ l , 21 to assign Boltzmann - weighted acceptance probabilities to trial moves , a move that would change the ( temperature - scaled ) energy by A U being accepted with proba - bility M ( d U ) . Here , however , we consider an unorthodox kind of trial move - one that keeps the same configuration ( ql . . . qN ) , but switches the potential function from U , , to U , or vice - versa . For each configuration , the acceptance probabilities for such a pair of trial moves must satisfy the relation M ( U , - U , > exp ( - U , ) = M ( U , - U , ) exp ( - U , ) . ( 2 ) Integrating this identity over all of configuration space and multiplying by the trivial factors Q , / Q , and Q , / Q1 , one obtains : = Q , s M ( & I - VI ) exP ( - & ) dq , * * * dq , Ql ( 3 ) The quotients on both sides can be recognized as canonical averages , i . e . , quantities that can be measured during ordinary MC runs on systems 0 and 1 respectively . Representing these averages by the conventional angle brackets , one obtains the desired result : ( 4 ) 248 CHARLES H . BENNETT The physical meaning of this formula is that a Monte Carlo calculation that included potential - switching trial moves ( in a fixed ratio to ordinary , configuration - changing trial moves ) would distribute configurations between the unknown U , and the reference U , system in the ratio of their configurational integrals . The potential - switching moves need not actually be carried out , however , since the desired ratio can be estimated more accurately simply by taking the indicated averages over separately - generated samples of the U , , and U , ensembles . Before proceeding further , a few general remarks on the scope and limitations of the acceptance ratio method are in order . The requirement that the two systems be defined by potentials acting on the same configuration space is not a serious limitation , since , for most pairs of macrostates one might care to compare , a rather trivial transformation of the coordinates ( e . g . , a dilation or shear ) s & ices to make the two configuration spaces congruent . It is possible even to compare systems with a different number of degrees of freedom ( as in the MC simulation of a grand canonical ensemble ) ; the lower - order system is simply given one or more dummy coordinates , whose contribution to Q can later be factored out and computed analytically . Most special ensembles used in Monte - Carlo work can be expressed as canonical ensembles by appropriate definition of the potential function U . The ( N , T , P ) ensemble , for example , can be represented [ 2 ] by making the volume a coordinate and the pressure a parameter of U . Importance - weighted ensembles [ 6 , 71 can be viewed as canonical ensembles defined by U functions containing additive terms designed to concentrate the probability density in desired portions of configuration space . The only important practical limitation on the method is that both mean acceptance probabilities ( i . e . , both averages in Eq . ( 4 ) ) must be large enough to be determined with reasonable statistical accuracy in a Monte - Carlo run of reasonable duration . If only one of the acceptance probabilities is too small , it can be increased , at the expense of the other , by shifting the origin of one of the potential functions by an additive constant . Simultaneous smallness of both probabilities indicates that there is insufficient overlap between the U , , and U , ensembles , and , in order to obtain a good estimate of Q , , one must either : 1 . Find a new reference potential which exhibits greater overlap with U , . 2 . Perform additional MC calculations under one or more intermediate potentials , so as to form an overlapping chain between U , and U , . 3 . Use curve - fitting methods , to be discussed in Section III , to interpolate between the U , and U , ensembles , thereby obtaining a good estimate of the free energy difference in spite of the lack of overlap . Although Eq . ( 4 ) is not strictly correct for the ( N , E , V ) or ( N , E , V , linear MONTE CARLQ FREE ENERGY ESTIMATION 249 momentum ) ensembles sampled by molecular dynamics , in practice it often can be used with molecular dynamics data , owing to the close similarity ( except near phase transitions ) of the configurational distributions in the various ensembles , for systems having more than a few degrees of freedom . Since temperature is not an independent variable in a constant - energy ensemble , the temperatures used in defining the temperature - scaled potentials U , and U , would have to be taken from time averages of the kinetic energy . An exact microcanonical analog of Eq . ( 4 ) exists for the somewhat special case of two systems at the same energy E whose Hamiltonians , H , , and H1 , have equal “soft” parts , i . e . , H , , and HI are equal wherever neither is infinite . For such a pair of systems the ratio of the microcanonical phase integrals is given by . f W & I - El dqN dPN = exp ( So _ S , ) , k = WWo - Hdl , sS ( H , - E ) dqN dpN MHI - f & J10 ’ ( 5 ) with square brackets here denoting microcanonical phase averages . The numerator and denominator of Eq . ( 5 ) have a very simple interpretation : e . g . , [ M ( H , - H , , ) ] , is the fraction of points on the Ho energy surface that also lie on the HI energy surface . The formulation of a more general microcanonical analog of Eq . ( 4 ) is frustrated by the fact that , for a general pair of Hamiltonians , H , , and Z & , the two energy surfaces would have an intersection of zero measure . Returning to the canonical ensemble , it may be noted that Eq . ( 4 ) is not the most general formula for Q , / Q , as a ratio of canonical averages . A more general formula results if one includes in both the numerator and denominator an arbitrary weighting function . Let W ( q , * * * qN ) be any everywhere - finite function of the coordinates . It then follows easily that e , = Q , s W ev ( - U . - W dqN = ( Wexp ( - WI Ql Ql J W ew ( - ul - UO > dqN ( W ev ( - W . * ( 6 ) Note that configurations having infinite energy under either U , or U , or both make no contribution to Eq . ( 6 ) so long as W is finite ; henceforth , W will by convention be set equal to zero for all such configurations . Most previous direct or overlap methods for estimating free energy ( to be reviewed in Section IV ) can be viewed as special cases of Eq . ( 6 ) , with particular forms of the potentials U , and U , and the weight function W . Equation ( 4 ) , for example , corresponds to the choice W = exp ( + min { U , , , U , } ) . The next section ( IIb ) shows , by some rather lengthy statistical arguments , that the optimized estimator of Qo / Ql as a ratio of canonical averages differs from Eq . ( 4 ) in two respects : ( 1 ) the Fermi function , f ( x ) = l / ( 1 + exp ( + x ) ) , is used instead of the Metropolis function ; and ( 2 ) the origin of one of the potential functions is shifted so as to ( roughly ) equalize the two acceptance probabilities . 250 CHARLES H . BENNETT It is also shown that , when one is free to vary the amount of computer time spent sampling the two ensembles , roughly equal time should be devoted to each . Ilb . Optimized Acceptance Ratio Estimator - - Large Sample Regime Optimization of the free energy estimate is most easily carried out in the limit of large sample sizes . Let the available data consist of n , statistically independent configurations from the U , ensemble and n , from the U , ensemble , and let this data be used in Eq . ( 6 ) to obtain a finite - sample estimate of the reduced free energy difference dA = Al - A , = In ( Q , / Q , ) . For sufficiently large sample sizes the error of this estimate will be nearly Gaussian , and its expected squre will be Expectation of ( d Aest - dA ) 2 < W2ed - 2Wh ( W2 exp ( - 2 U & M M Wew - Wo12 + M Wexp ( - U0 ) > J2 1 1 - - - _ _ n , n , = s ( ( Q & d exP ( - G ) - t - < Qlh > exp ( - U , ) ) W2 exp ( - U , , - U , ) dqN [ J Wed - G - W WI2 - wd - Wnd . ( 7 ) By making the integral in the numerator stationary with respect to a variation of W at constant value of the integral in the denominator , the optimum W function is found : m , . . . qN ) = const x ( * exp ( - U , ) + - $ exp ( - UJP1 . ( 8 ) Substituting this into Eq . ( 6 ) yields $ = WA - Ul + Cl > , ( f ( U , - u , - C ) ) , exp ( + C ) y Pa > W and f denotes the Fermi function f ( x ) = l / ( 1 + exp ( + x ) ) . Equation ( 9a ) is true for any value of the shift constant C , but the particular value specified by Eq . ( 9b ) minimizes the expected square error ( Eq . ( 7 ) ) when the canonical averages are evaluated by finite sample means , with sample sizes n , and n , . The magnitude , 02 , of this minimum square error can be found by taking rhe variance of Eq . ( 9a ) , or by substituting Eq . ( 8 ) into ( 7 ) ; u2 can be conveniently MONTE CARLO FREE ENERGY ESTIMATION 251 expressed in terms of n , , n , , and the normalized configuration - space density functions p0 and p1 : = . 2 = < f2 > rJ - < f > i + < f % - < fX n & f X n & f > i = ( I wlPoPl & q - l nope + Wl " on ; : 1 . ( 104 ( lob ) In Eq . ( lOa ) the argument offis understood to be ( U , - U , - C ) or ( U . - U , + C ) in the 0 and 1 expectations , respectively , with C = ln ( Q & Qln , , ) as specified by Eq . W . In Eq . ( lob ) , p ( ql . a * qN ) denotes the density ( l / Q ) exp [ - U ( q , 1 . . qN ) ] . Since a2 is a monotonically decreasing function of both no and n , , it follows that for some ii , lying between no and n , , 2 ( 72 ET = = n [ ( S dq” ) - l - 11 & WI PO + Pl ( 11 ) The integral in this equation is clearly a measure of the “overlap” between the two densities in configuration space . Equation ( 11 ) thus says that Qo / Ql can be determined accurately as a ratio of canonical averages by ( and only by ) sampling a number of configurations greater than the reciprocal of the overlap between p . and p1 . The optimized formula for Qo / Q , ( Eq . ( 9a ) ) differs from that derived earlier ( Eq . ( 4 ) ) only in the use of the Fermi function in place of the Metropolis function , and in the shifting of the origin of one of the potentials by an additive constant C . Figure 1 shows both the Fermi and Metropolis functions along with a typical probability density for values of their argument x , the change in energy accom - panying a potential - switching move ( i . e . , x = U , - U , + C under U , , and FIG . 1 . The Fermi function , f ( x ) = l / [ l + exp ( + x ) ] , and the Metropolis function , M ( x ) = min { I , exp ( - x ) x are shown along with a typical probability density , p ( x ) , for their argument . Plotted on the left is a typical probability density for values of the Fermi function . 252 CHARLES H . BENNETT Ul - U , - C under U , , ) . When the shift constant is properly chosen ( Eq . ( 9b ) ) , most potential - switching moves ( like most trial moves in an ordinary MC cal - culation ) will result in an increase in energy and hence will lie on the positive “tail” of thef ( or M ) function . The advantage of the Fermi function in estimating free energy differences lies in its having a softer shoulder than the Metropolis function . This narrows the distribution of acceptance probabilities p ( f ( x ) ) , and makes possible a more accurate estimation of the ensemble average acceptance probability from a given body of data . The Metropolis function , on the other hand , is the better acceptance function to use in the ordinary MC algorithm for generating new configurations , because here one seeks to maximize the acceptance probability itself , without regard to its variance . The shifting of the energy origin by C serves to maximize the number of configurations falling near the soft shoulder of the f function , while minimizing the number falling far out on its tail . It should perhaps be pointed out that in the special case of two potentials whose soft parts are identical , Eq . ( 9a ) becomes equivalent to Eq . ( 4 ) and yields no better estimate of Qo / Q , . In practice , of course , one cannot determine the optimum shift constant C exactly , because it depends on the unknown quantity QO / Q1 ; however a value sufficiently close to the optimum can be found by adjusting C until Eqs . ( 9a ) and ( 9b ) become self - consistent for the given body of data . This estimation proce - dure can be expressed conveniently as a pair of simultaneous equations in & est and C : AAest = In cl’f ( uo - ” + ‘ ) I + C - ln ( n , / n , ) co V ( Ul - uo - CM ( 124 & test = C - ln ( n , / no ) . Wb ) Equation ( 12a ) ( the finite - sample analog of Eq . ( 9a ) ) estimates the free energy difference in terms of explicit sums over the n , configurations comprising the U , ensemble sample and the no comprising the U , ensemble sample ; Eq . ( 12b ) ( or equivalently x1 = Co ) is the self - consistency criterion for selecting C . The large - sample regime assumed in Eqs . ( 9 ) - ( 12 ) may now be expressed as a condition on the sums Co and x1 : namely , that for some range of C - values about the true C of Eq . ( 9b ) , these sums differ relatively little from their respective expec - tations , no ( ) . and n , ( ) 1 . Under this condition the self - consistent procedure yields essentially an optimum estimate of AA , differing from the true value by a quantity of order g . This follows from the fact that the first term on the right - side of Eq . ( 12a ) is a monotonically decreasing function of C with a slope of nearly - 1 and a value , for the correct C of Eq . ( 9b ) , within about 0 of zero . One may be sure of being in the large - sample regime whenever both x1 and x0 are large compared to unity , because the terms comprising the sums are statistically independent and all lie between zero and one ( the large sample condition is thus equivalent to the condition MONTE CARLO FREE ENERGY ESTIMATION 253 discussed in connection with Eqs . ( 10 ) and ( 1 l ) , viz , n , and n1 must be great enough to adequately sample the region of overlap between p , , and pI ) . Figure 2 shows a representative graphical solution of Eqs . ( 12a ) and ( 12b ) for four sets of simulated Monte - Carlo data drawn from the same pair of ensembles ( the sample sizes n , = n , = 106 , lay in the large sample regime , with Co M x1 M 200 ) . Note that the straight line of Eq . ( 12b ) cuts through a region where the four curves of ( 12a ) differ least from each other and from the true value of AA . In the large sample regime the standard error of the estimate dA est will be less than & 1 , and can be computed in the usual manner by solving Eqs . ( 12a ) and ( 12b ) for several large , independent bodies of data , as was done in Fig . 2 . 26 - i 3 ii Iu " 25 - i iii * : - - - - - 24 - - - - - a * iv iv 23 - ii . III 0 8 16 24 32 40 48 C FIG . 2 . Acceptance ratio estimate of the free energy difference between two MC ensembles in the large - sample regime by simultaneous graphical solution of Eqs . ( 12a ) and ( 12b ) . For a description of the two ensembles , and the method of sampling them , see the Appendix . The four curves ( i - iv ) plot the right side of Eq . ( 12a ) as a function of the shift constant C for four inde - pendent sets of data , each consisting of l @ points randomly chosen from the 0 ensemble and 1V from the 1 ensemble . The slanting straight line is Eq . ( 12b ) , while the dashed horizontal line gives the true free energy difference AA . The mean and standard error of the four tite - sample estimates are 24 . 290 + 0 . 017 ; these are in satisfactory agreement with the true free energy diier - ence , 24 . 268 , and the error ( I = ho . 021 predicted by E & ( lob ) for sample sizes n , = II ~ = 4 x IV . Equations ( 12a ) and ( 12b ) represent an estimation strategy optimized with respect to a given pair of large samples , with fixed sizes n , and n , . We now consider the allocation of computer time between the two ensembles if the sample sizes are not fixed beforehand , but are free to be chosen so as to minimize ~ 9 with respect to q / no at a constant total cost in computer time . Let us assume that the time required to compute each ( statistically - independent ) data point is do in the 0 ensemble and + ? I in the 1 ensemble , so that the total computing time is nolo + n , ( , . A crude but effective rule for choosing nIlno is simply to allocate equal time to the two ensembles , i . e . , 254 CHARLES H . BENNETT The estimation efficiency , l / [ ( n & + n , + $ ) u2 ] , resulting from this equal - time allocation is at least half as great as that resulting from any other allocation . This follows from the fact that o2 is a monotonically decreasing function of both no and n , ; ( i . e . , even the best allocation of 1 hour of computer time between the two ensembles yields no better estimate than would obtained by devoting a full hour to each ensemble ) . In the special case + $ , = # I = 1 , the equal - time estimation effi - ciency is approximately one fourth the overlap integral ( cf . Eq . ( 11 ) ) . The equal time rule gives a sufficiently good n & z , ratio for most practical situations ; however , for the sake of elegance , the true optimum ratio can be expressed in terms of the variance of the Fermi functions by solving the variational equation 61 ( d ~ 2 / dno ) = hW2 / dnl ) . ( 14 ) Explicitly differentiating Eq . ( lOa ) with respect to n , and n , , one obtains ( 15 ) with the argument off understood to be U , - U , - C in the 0 expectations and U , , - U , + C in the 1 expectations . One might worry about the implicit n - depen - dence that the various Fermi expectations have by virtue of the n - dependent shift constant C , defined in Eq . ( 9b ) . However , these implicit n - dependences have no effect on the derivatives of u2 , because Eq . ( 9b ) is itself the solution to the variational condition a $ / aC = 0 . Equations ( 9a ) and ( 9b ) also cause the denominators on the two sides of Eq . ( 15 ) to be equal . Thus Eq . ( 15 ) reduces to an equation in one unknown , defining an optimum value for the shift constant C : 4 WMU ~ - 6 - Cl1 = 6 VarLW6 - VI + CM , ( 16 ) with Var , , and Var , denoting the absolute variances . These variances , of course , cannot be estimated with much precision from finite samples of the ensembles , but by adjusting the sample sizes until Eqs . ( 12a ) and ( 12b ) can be solved self - consistently for the same value of C as Eq . ( 16 ) , one might obtain some improve - ment over the equal time strategy , particularly in cases where the optimum time ratio is far from 1 : 1 . As noted earlier , the efficiency of estimating dA is at least half - optimal , and not very sensitive to the n & r0 ratio , in the neighborhood of n & z , , = & , / tI ( the equal time rule ) . This can be seen in Fig . 3 , which plots the log estimation efficiency versus the log sampling ratio for the pair of model ensembles considered earlier . Although the optimum n & z , , ratio is 1 . 8 , the estimation efficiency at n & z0 = 1 is almost ( 99 . 7 % ) as good . ( At first it might appear that by making the costs & , and ( I very disparate , the optimum time ratio could be displaced far from unity ; MONTE CARLO FREE ENERGY ESTIMATION 255 however this is not so . If , for example # J # , is changed from 1 to 1O4 , the optimum nl / no ratio is indeed greatly increased as one would expect ; but the optimum time ratio , n , & / n , / , , , changes only from 1 . 8 to 1 . 3 ) Ln h , h , ) FIG . 3 . Dependence of estimation efficiency , l / [ ( n , + n & 9 ] , on the nJn , ratio for the model ensembles described in the Appendix , assuming equal sampling costs ( el = # & in the two en - sembles . The horizontal wings of the curve indicate the rather poor efficiency with which Al - A , can be estimated when only one ensemble is sampled , as in infiniteorder perturbation theory . The efficiency curve was calculated by exact evaluation of Eq . ( lob ) over the rather trivial con - figuration space of the model ensembles . Figure 3 also shows that the estimation efficiency can become very bad if one flouts the equal time rule by sampling only one ensemble . The poor efficiency results from the fact that , when only one ensemble is sampled ( say the 0 ensemble ) , the acceptance ratio estimator reduces to the average of a pure exponential ( cf . Eq . ( 22 ) ) , whose variance can be expressed in terms of the densities p0 and p1 as [ . I - W / PO ) 4P - llhl * This expression is less transparent than the formula ( Eq . ( 11 ) ) relating the variance of the two - ensemble estimate to the overlap integral ; however , its qualitative meaning is that an accurate one - ensemble estimate requires that the sampled ensemble include all important configurations of the other ensemble . A good two - ensemble estimate , on the other hand , requires only that each ensemble include some important configurations of the other ensemble . IIc . Acceptance Ratio Estimates in the Small Sample Regime The treatment so far has been limited to the large sample regime , in which both sums in Eq . ( 12a ) can be made simultaneously greater than unity . Unfortunately , in many cases of interest , the overlap between the two ensembles is so slight that even with the largest practical n , and n , this condition cannot be met . We shall now show that even in this small sample regime Eq . ( 12a ) can yield a useful estimate of LIA , though the error bounds will be greater than f 1 and can no longer be 256 CHARLES H . BENNETT estimated from the spread among independent estimates . When either sum in ( 12a ) ( say C1 ) is small compared to unity , its most serious source of statistical error becomes the possibility that some important class of configurations , whose total ensemble probability is low ( I / n , or less ) but whose f values are high ( near unity at worst ) , may not be sampled at all . Such failures to sample could cause either sum to underestimate its expectation by a quantity of order unity ( corre - sponding errors due to ouer - sampling of high - f configurations could also occur , but , owing to the convexity of the log function , their effect on Eq . ( 12a ) would be much less ) . In order to find bounds on the possible failure - to - sample errors , and hence on AA , we take advantage of the fact that & is a monotonically decreasing function of C , while Co is monotonically increasing . Therefore , by decreasing C to that value , C , , for which x1 becomes equal to unity , we can make all the failure - to - sample errors appear in the denominator of Eq . ( 12a ) and obtain a value , & test + , which may overestimate , but is unlikely to seriously under - Ln I , c’ c co Ln IO C FIG . 4 . Acceptance ratio estimate of the free energy difference in the small - sample regime . The upper pair of curves show the construction of the optimum estimate dAest by graphical solution of Eqs . ( 12a ) and ( 12b ) , from two small samples ( n , = n , w 20 ) of the pair of ensembles described in the Appendix . The lower pair of solid curves show the construction of the upper and lower estimates , dAest + and dAest - , by Eqs . ( 17a ) and ( 17b ) . The dashed curves show the log expectations , In ( Co > = In [ nO ( f ( UI - U , , - C ) > , ] and ln < C > = ln [ nI ( f ( Uo - U , + C ) ) , ] , which are closely approximated by the observed log sums as long as the latter are greater than unity , but are poorly approximated at C values for which the log sums are less than unity . MONTE CARLO FREE ENERGY ESTIMATION 257 estimate , the true free energy difference dA . The construction of this upper estimate and the corresponding lower estimate , & est - - , is shown in Fig . 4 . The computation of error bounds in the small sample regime may be summarized : & test - = R12a ( C , , ) 5 dA 5 R12a ( C , ) = & test + , ( 174 where R12a ( C ) denotes the right side of Eq . ( 12a ) , and C , , and C , are defined by c MU1 - UC - cc ) l = 1 = 1 { f ( U , - u , + Cl ) } . ( 1W Parenthetically it is interesting to note that the right side of Eq . ( IZa ) , which would be independent of C in the large - sample limit , here decreases with a slope of about - 1 throughout the range where both sums are much smaller than unity . This is necessarily so because , under these conditions , neither sum can receive contri - butions except from the nearly exponential positive tail of the f function . The self - consistent estimate & test obtained by solving Eq . ( 12a ) with ( 12b ) therefore lies about midway between the upper and lower bounds computed by Eq . ( 17 ) . It is still the best estimate of LA in the sense that it equalizes the damage that would be done by a unit failure - to - sample error in the numerator or the denominator of Eq . ( 12a ) . IId . Practical Considerations in Using Acceptance Ratio Methods In using Eqs . ( 12 ) and ( 17 ) with real MC data account must be taken of the fact that successively generated configurations of a Markov chain are not statistically independent , but on the contrary highly correlated . Each of the sums , Co and x1 , and the numbers no and n1 , must therefore refer to a subset of configurations , chosen from the chain so infrequently as to be uncorrelated , or else be defined in terms of the whole chain as follows : C = 7 - l C ; n = 7 - ‘nwc . WC Here CWc denotes a sum over the whole chain , having nwc configurations , and T is an empirically estimated autocorrelation time of the Markov chain with respect to values of the f function ( This autocorrelation time can be defined as the large k limit of the quantity k * Varlf ( k ) ] / Varlf ] , where f ( “ ) denotes the mean of k consecutivefvalues . Clearly T can be estimated accurately only if it is considerably shorter than the total chain length nwc ) . The cost , 4 , of a statistically independent data point , discussed in connection with Eqs . ( 13 ~ ( 16 ) , would be similarly defined as T times the computer time required to make one MC move . Another practical note : although the evaluation of the sums in Eq . ( 12a ) could in principle be done after the MC data ( typically a Markov chain of several million configurations ) had been generated , it is inconvenient to store all this data . A . 581 / 22 / z - 9 258 CHARLES H . BENNETT better approach would be during the run to accumulate values of x , , and x1 , using a mesh of C values sufficiently fine to permit accurate graphical solution of Eqs . ( 12a ) and ( 12b ) at the end of the run . Alternatively , one could store a pair of histograms , h , ( AU ) and h , ( flU ) , of the values of the difference potential d U = U , - U , , , observed while sampling the 0 and 1 ensembles , respectively . The interval width of the histograms need be no smaller than the desired precision of estimating & I , and they can be summed over easily at the end of the runs to evaluate Eq . ( 12a ) . Such histograms are also useful in their own right , in the inter - polative method for estimating dA to be discussed in the next section . The acceptance ratio method is at its best when the overlap between the two ensembles , as defined by the integral in Eq . ( ll ) , is not too small , e . g . , in solid state vacancy calculations [ 8 , lo ] where the difference potential , U , - U , , , depends strongly on only a few atomic coordinates . It is more common for the difference potential to depend strongly on all the coordinates , resulting in an overlap many orders of magnitude less than unity . The two data histograms , h , ( d U ) and h , ( d U ) will then be separated by a wide gap ( cf . Fig . 5 ) that cannot be filled in by any reasonable amount of additional sampling of either ensemble , and the acceptance ratio method ( Eq . ( 17 ) in particular ) will yield only the rather crude conclusion that the true free energy difference dA is somewhere between max { d U > , and min { d U } , . I ; , x - C AU - - l FIG . 5 . Histograms of values of dU = U , - U , , , ho representing a typical set of AU values sampled from the 0 ensemble , and h1 a typical set sampled from the 1 ensemble . In the gap between the two histograms are a pair of complementary Fermi functions f0 = f ( AU - C ) and fi = f ( C - AU ) whose origin can be shifted to the left or right , but whose widths are insufficient to achieve good overlap of fO with ho , and fi with h1 , simultaneously . The estimate of dA can be considerably improved if , as is often the case , the two histograms are sufficiently smooth to justify extrapolating them into the gap region of the A U spectrum , from which no data have been collected . The following section will deal with this method of estimating AA , which is no longer a pure acceptance ratio method , because it is based on the additional assumption that the A U spectrum is smooth even where no data have been collected . When the smoothness assumption is not justified , i . e . , when the data histograms MONTE CARLO FREE ENERGY ESTIMATION 259 are ragged as well as widely separated , an improved estimate of AA can be obtained by using the acceptance ratio method in a multistage manner , with data collected from a chain of intermediate ensembles extending from U , - , to U , . III . INTERPOLATION OR CURVE - FITTING METHOD This section concerns the estimation of A4 from histograms of AU values , h & l U ) and h & l U ) , which are smooth but may be separated by a gap wide com - pared to kT . This situation is likely to arise when the difference potential depends strongly but more or less equally on many coordinates , e . g . , when U , and U , represent a condensed system of many identical atoms interacting via one pair potential in the U , system and another in the U , system . If one is willing to infer from the histograms’ smoothness that the reduced density - of - states functions p & l U ) and p & l U ) , which the histograms approximate , extend smoothly into the gap region , one can obtain a much better estimate of A4 than could be obtained from the acceptance ratio method alone . This approach is less risky than it might first appear , and in fact is more akin to interpolation than to extrapolation , because p , , and p1 are not independent : Pl ( 4 = < WI - Uo - 4h = exp ( & _ $ . P & 4 ( WI - ull - x ) > o , ( 19 ) thus it is a matter of finding a single function ( p . , say ) which fits both histograms , while satisfying the normalization constraints and s Co p & lU ) ddU = 1 , - - m ( 204 Jm p & lU ) ddU = Jm p & lU ) exp ( dA - AU ) ddU = 1 . W’b ) - - m - - m This can be done conveniently by expanding In p . as a polynomial in d U and performing a least - squares fit of the expansion coefficients , along with AA , to the histogram data , subject to the normalization constraints . The adequacy of the polynomial approximation , as well as the range of plausible AA values , can be judged by chi - square tests . Estimation of AA also can be performed graphically ( cf . Fig . 6 ) , by plotting the two functions - - gAu + lm , W ) and - k & AU + lnp , ( 21’4 260 CHARLES H . BENNETT versus LIU on the same graph . Each function is plotted ( solid curves ) over the range of AU values for which it can be accurately estimated from the histogram data . By virtue of Eq . ( 19 ) , the two functions are parallel , differing only by the unknown additive constant AA ; hence , in order to estimate AA , one need only find a plausible parallel extrapolation ( dashed curves ) of the two functions into the range of AU values corresponding to the gap between the two histograms . Probably the easiest way to do this is to cut the graph in half vertically and slide the right half up or down until it can be smoothly joined onto the left half by some plausible extrapolation . The range of vertical shifts for which this can be done is then the range of plausible A4 values . In Fig . 6 this range can be seen to be about d - 4 = - 85 . 5 & 2 . 5 , which is considerably narrower than the gap between the two histograms . Clearly the interpolation method is at its best when the data histograms are smooth and significantly broader than kT ( kT = 1 in the reduced units of AU ) , - 120 - loo - 80 - 60 - 40 AU FIG . 6 . The curve - fitting method of free energy estimation ( cf . Eqs . ( 21a ) and ( 21b ) ) , applied to data of Valleau and Card [ 17 ] . The U , system here consisted of 200 charged ( lOO + and lOO - ) hard spheres at a fixed temperature and volume ; the U , system was the same , except that the spheres were uncharged . The left and right solid curves in the present figure were obtained , respectively , from the left and right probability density curves of Valleau and Card [ 17 , Fig . 21 ( omitting the tails where the density was less than one tenth maximum ) by : scaling the energy to units of kT , taking the logarithm , and adding + & lU and - & lU , respectively . Their figure also includes a middle curve , corresponding to an intermediate ensemble which they used to bridge the gap between the two outer curves . With the help of this intermediate ensemble , they estimated dA to be - 85 . 60 f 0 . 58 ( cf . [ 17 , Table I ] . As the present figure suggests , the outer curves are smooth enough to yield a fairly good estimate of AA ( about - 85 . 5 f 2 . 5 ) by interpolation across the gap , without help from the intermediate ensemble . MONTE CARLO FREE ENERGY ESTIMATION 261 and separated by a gap not much broader than the histograms themselves . Under these conditions much information about the shape of p , , and p1 in the overlap region can be inferred from data points lying far outside that region , data points which contribute hardly anything to the acceptance probabilities on which the method of the previous section is based . From this it can be seen that when two smooth histograms overlap very slightly ( i . e . , overlap integral in Eq . ( 11 ) of order l / E ) , the interpolation method will still be an improvement over the straight acceptance ratio estimator . However , the more the two histograms overlap , the less important it becomes to guess the shape of the reduced density - of - states functions , p , , and p1 , and , in the large - overlap limit ( overlap integral ml ) , inter - polation does not improve the estimate at all . On the other hand , when the gap between h , and h , is excessively wide compared to the width of the histograms themselves , accurate interpolation becomes difficult , and it is best to use the interpolation . metbod in a multistage manner , using MC data collected under one or more intermediate potentials , e . g . , U , = U , + X ( U , - U , > ; 0 < A < 1 . This linear form of the intermediate potential is con - venient because it allows all the In p & l U ) data to be plotted on the same graph and fitted to the same polynomial , but it may be inferior to the more general intermediate potentials discussed in Section IVc . IV . DISCUWON In this section the acceptance ratio and interpolation methods of Sections II and III are compared with other methods of free energy estimation , viz , pertur - bation theory , numerical integration of a derivative of the free energy , and previous overlap methods . IVa . Perturbation Theory Perturbation theory [ l 1 , 121 , which estimates the free energy of the U , system by extrapolation from the U , system , can be viewed as the limiting case of the accep - tance ratio method in the absence of any data from the U , system . In this limit ( i . e . , n , - + 0 ) Eqs . ( 9a ) and ( 9b ) reduce to Al - A , . = - ln ( exp ( U , - Ul ) & ( 22 ) an infinite - order perturbation formula [ 131 which . is exact , provided there are no configurations for which U , is infkite but U , . is finite . To obtain finite - order formulas , one assumes the potential U to depend on a continuous parameter 262 CHARLES H . BENNETT X in such a way that as X is varied from 0 to 1 , U passes smoothly from U , to U , . The potential U , in Eq . ( 22 ) then can be expanded in a Taylor series about U , : A , - A , = - ln ( exp [ - ( W / L % ) - ( @ U / iW ) / 2 - * . + ] ) o = wvml + H < a2w ~ 2 > o - < w / w2 > , + ( @ wwcJ21 ( 23 ) + . . . = aA / ah + * a2Ajah2 + - - , where all the derivatives with respect to h are evaluated in the U , , ensemble , at h = 0 . The expansion is usually truncated at second order because the statistical uncertainty in measuring the higher derivatives , by a MC run of reasonable duration , is typically so great that they contribute only noise to the infinite - order formula ( Eq . ( 22 ) ) . The simplest perturbation formula results by taking U , = U , + h AU , in which case % U / aX2 = 0 and NJ / ah = AU ; Eq . ( 23 ) then expresses AA in terms of the mean and moments of AU , as measured in the reference system . Alternatively , the acceptance ratio and curve fitting methods of Sections II and III may be viewed as double - ended , interpolative counterparts of ordinary extrapolative perturbation methods of infinite ( Eq . ( 22 ) ) and finite ( Eq . 23 ) ) order , respectively . The assumption of smoothness of the density - of - states function , on which the curve - fitting method is based , is then a less restrictive counterpart of the assumption that higher - order terms in Eq . ( 23 ) are negligible . Double - ended methods have the advantage of being able to set both upper and lower bounds on the free energy difference A , - A , , . The crudest of these bounds is the so - called Gibbs - Bogoliubov inequality [ 14 ] , ( u , - U , ) , < Al - A , < < U , - UJ , 7 ( 24 ) which follows , via the convexity of the log function , from Eq . ( 22 ) and its analogue with U , , and U , interchanged ; more subtle bounds , e . g . , Eq . ( 17 ) , are discussed in Sections II and III . In an ordinary single - ended perturbation treatment , on the other hand , no data is collected from the U , ensemble and only the right half of Eq . ( 24 ) can be used . One therefore cannot rule out the possibility of seriously overestimating A , - A , , due to a failure to sample important configurations in the U , ensemble . Assurance that this hind of error has not occurred must come from specific knowledge of the potentials , or from independent conkmation of the properties of the U , system . The notably successful perturbation theory of liquids [ 12 , 15 , 161 , whose reference system is the hard sphere fluid , was confirmed in this manner . MONTE CARLO FREE ENERGY ESTIMATION 263 The perturbation theory of liquids also illustrates the chief strength of single - ended perturbation methods , namely , the possibility of using a single reference system to compute the properties of many different U , systems , without having to collect MC data on each of these separately . It should be noted , however , that when there is any doubt about the rapid convergence of an extrapolative pertur - bation from U , , data , the estimate of A , - A , can be considerably improved , usually without much cost in computer time , by collecting a small amount of MC data on the U , system , then using a double - ended method . Indeed , whenever the second - order perturbation term differs significantly from zero , the two ensembles being compared are probably sufficiently different to warrant sampling both of them . The gain in estimation efficiency made possible by sampling both ensembles instead of only one is suggested in Fig . 3 . IVb . Numerical Integration This method estimates the free energy difference Al - A , by numerically integrating the derivative aA / ah = ( XJ / aA ) , which is measured by equilibrium MC calculations at a mesh of values of the parameter h between 0 and 1 . The most commonly performed integration is of pressure versus volume [ 4 , 51 ; however , the method can be used to compute the free energy change attending any con - tinuous deformation [ 8 ] of the potential , boundary conditions , or other parameters defining the MC macrostate . The integration method as ordinarily practiced is less than optimal because it ignores the information which each MC run provides about higher derivatives of the free energy ( e . g . , the isothermal compressibility ) ; however , this information may be of poor statistical quality . Ideally each estimated derivative of A , at each mesh point , should be given a weight inversely proportional to its estimated standard error . Probably the easiest way to achieve this correct weighting of information is to use the acceptance ratio or interpolation methods in a multistage manner , to estimate J @ A / ah ) dh between consecutive mesh points . When information on higher derivatives is included it is clear that perturbation theory and the interpolation method of Section III are special cases of integration , with one or two mesh points , respectively . The number of mesh points actually needed depends on the smoothness of aA / ax as a function of A , and on the ease and precision with which the derivatives can be estimated at each mesh point . In typical applications , where five to ten mesh points are used , numerical integration can determine A , - A , when the unknown and reference ensembles are too different to be compared by any method not using intermediate ensembles . On the other hand , when the 0 and 1 systems are similar enough to be compared directly , the generation of many intermediate ensembles , each of which must be allowed to equilibrate before representative data can be collected , is tedious and may be wasteful of computer time . 264 CHARLES H . BENNETT IVc . Previous Overlap Methods Most previous overlap methods for determining free energy differences can be regarded as special cases of the acceptance ratio method , with particular forms of the potentials U , , and U , and of the weight function Win Eq . ( 6 ) . Perhaps the most common special case is the comparison of a pair of systems , one of which is restricted to a subset of the configurations accessible to the other . In other words , the difference potential dU = lJ , - U , is a hard function , taking on only the values zero and plus infinity . With such a pair of potentials , one of the acceptance probabilities in Eq . ( 4 ) becomes identically unity , while the other is simply the fraction of microstates in the less restricted ensemble belonging to the more restricted ensemble . In what was probably the first application of an overlap method to a realistic system , McDonald and Singer [ 9 ] sampled a nested set of ensembles , defined by a decreasing sequence of upper bounds on the total energy of a gaseous Lennard - Jones system , and obtained the unnormalized density of states as a function of energy over a wide range of energies , from which they were able to compute the thermodynamic properties of the gas over a wide range of temperature . Such nested sets of hard constraints can be used to restrict a MC system to any desired region of configuration space , and to determine the spontaneous proba - bility of occupancy of that region in the absence of the constraints . In a molecular dynamics calculation , analogous constraint terms in the Hamiltonian can be used to sample trajectories passing through an arbitrary region of phase space , and to estimate the spontaneous frequency of such passages in an unconstrained system [ lo ] . Apparently the first overlap calculation of a free energy difference between two systems whose potentials had differing “soft” parts was that of Valleau and Card [ 17 ] . These authors , interested in determining the thermodynamic properties of a fluid of charged hard spheres as a function of temperature , compared systems whose U differed by a constant factor , i . e . , systems having the same unscaled potential but different temperatures . Their somewhat complicated procedure for for estimating dA ( cf . [ 17 , Appendix ] ) can be recognized as accomplishing the same result , with somewhat less statistical efficiency , as the Fermi - function weighting used in the acceptance ratio method of Section II . By emphasizing the importance of the density - of - states functions , p & l U ) and p , ( d U ) , these authors adumbrated the interpolation method of Section III . In the same paper Valleau and Card pointed out the possibility of using a specially tailored bridging ensemble , designed to have significant overlap with both the unknown and reference ensembles , in place of the many intermediate ensembles ordinarily used in the numerical integration method . In principle it is always possible to define such a bridging ensemble , no matter how different U , and U , may be . This may be done , for example , by defining the bridging potential MONTE CARLO FREE ENERGY ESTIMATION 265 U , , as an appropriately weighted log mean exponential of a sequence of over - lapping potentials U , , , extending between U , and U , , UB = - - In i wA exp ( - U , ) , A = 0 the discrete weights w , being chosen to approximate exp ( A , ) . By using a continuous weight function w ( X ) one can even define a bridging ensemble whose density of states is perfectly flat over the entire relevant interval of the A U spectrum , but to guess such a weight function would be tantamount to guessing the function po ( d U ) over the same interval . Torrie , Valleau , and Bain [ 6 ] used discretely weighted bridging ensembles to pass between an unconstrained hard sphere fluid and a single occupancy fluid ( no two particles allowed in the same Wigner - Seitz cell ) in a few sampling stages , thereby avoiding the long pressure - volume integration by which the communal entropy is usually estimated . Unfortunately , the bridging ensembles exhibited such long autocorrelation times ( cf . Eq . ( 18 ) ) that the hoped - for gain in computational efficiency was not realized . The bridging system , in other words , diffused much too slowly between the part of configuration space overlapping with U , and the part overlapping with U , . In later work , Torrie and Valleau [ 7 ] obtained much better performance using continuously weighted bridging ensembles to estimate the free energy of a 32 particle Lennard - Jones fluid relative to that of the corresponding purely repulsive inverse twelfth power system . The difference in diffusion rates obtained in these two experiments probably is due in part to the superiority of a continuous weighting , but may also reflect the many - body character of the structural rearrangements involved in accommodating to the single - occupancy constraint . In difficult cases like the communal entropy calculation , some improvement in diffusion through a given bridging ensemble might be obtained by modifying the MC transition algorithm used to sample it ( infinitely many transition algorithms , with different rates of diffusion through configuration space , can be used to sample the same canonical ensemble ) . So far almost all MC calculations have used simple transition algorithms in which only one particle is moved at a time , and trial moves are symmetrically distributed in direction . More efficient diffusion in the desired direction might be obtained by making trial moves preferentially parallel and antiparallel to the local gradient of the difference potential . Overlap methods using a bridging potential of the form of Eq . ( 25 ) bear a certain similarity to numerical integration . Under a bridging potential , the system diffuses freely back and forth between the U , and U , parts of configuration space ; in numerical integration , a series of intermediate MC runs is made , and the system is forced to diffuse , by the increment in the integration parameter , as each successive run equilibrates . Given a particular MC transition algorithm , which limits the 266 CHARLES H . BENNETT diffusion rate , numerical integration and bridging ensembles may be equally efficient statistically , if the higher - derivative information provided by the integration runs is taken into account . V . CONCLUSION The problem of free energy estimation can be broken into three parts : 1 . what reference and ( possibly ) intermediate ensembles to use ; 2 . what MC transition algorithms to use for sampling the ensembles ; and 3 . how best to estimate the free energy from the resulting data . The acceptance ratio and interpolation methods ( developed in Sections II and III , respectively ) offer a fairly complete solution to the third subproblem , viz , optimally estimating the free energy difference between two canonical ensembles given a finite MC sample of each ( or , more generally , given MC routines able to sample each at some tied cost per statistically independent data point ) . A good estimate can be arrived at if the ensembles being compared 1 . exhibit significant overlap , allowing the acceptance ratio method of Section II to be used ; or 2 . are sufficiently similar that the density of states in each ensemble is a smooth function of d U = U , - U , , allowing the interpolation method of Section III to be used . In either case it is dangerous not to sample both ensembles , unless one is known to include all important configurations of the other . When the two ensembles neither overlap nor satisfy the above smoothness condition , an accurate estimate of the free energy cannot be made without gathering additional MC data from one or more intermediate ensembles . The first two subproblems are much less well understood than the third . The choice of a reference ensemble is more a matter of physics than of statistics , and it is probably best made on an individual , empirical basis . On the other hand the problems that arise in designing efficient bridging ensembles and transition algo - rithms to sample them appears to be the manifestation , in Monte Carlo work , of a general difficulty in the numerical simulation of systems with many degrees of freedom - the problem of moving efficiently through a complicated , labyrinthine configuration space . The problem arises whether one wishes to study the system dynamically ( where it makes itself felt as a disparity of time scale between the phenomena of interest and the time step needed to integrate the equations of motion [ 18 ] ) , or statistically ( as in Monte Carlo work ) , or merely by seeking the global MONTE CARLO FREE ENERGY ESTIMATION 267 energy minimum in a space filled with steep - sided curving valleys , saddle points , and spurious local minima [ 19 , 201 . Judging from results in these other fields , the problem may be partly alleviated by transition algorithms that make intelligent use of local anisotropy information , but some complicated systems will remain intrinsically sluggish and hard to simulate . APPENDIX : MODEL ENSEMBLES The acceptance ratio estimators of Sections IIb and IIc were tested using a pair of simple model ensembles , defined on a discrete configuration space having only 23 states . Because of the trivial configuration space the ensembles could be sampled by a simple Poisson routine ( rather than by a Markov chain ) and the free energy difference , Fermi expectations , and all other quantities of interest could be cal - culated exactly , for convenient comparison with the estimates under study . These estimates were obtained by applying the estimators ( e . g . , Eqs . ( 12a ) and 12b ) ) to finite random samples of the two ensembles . The defining properties of the ensembles are given in Table I . TABLE I State AU - - Inh - - InP , State AU - - In PO - - InP , % 4 2 26 . 352 30 . 352 6 . 084 8 . 084 n m 28 26 . 7 . 352 5 . 352 9 . 084 9 . 084 i 6 8 22 . 352 18 . 352 4 . 084 2 . 084 0 P 30 32 4 . 352 2 . 352 10 . 084 10 . 084 ; 10 12 15 . 352 13 . 352 1 . 084 1 . 084 4 r 34 36 1 . 352 1 . 352 11 . 084 13 . 084 g 14 12 . 352 2 . 084 s 38 1 . 352 15 . 084 h 16 11 . 352 3 . 084 t 40 2 . 352 18 . 084 i 18 11 . 352 5 . 084 u 42 4 . 352 22 . 084 j 20 10 . 352 6 . 084 V 44 6 . 352 26 . 084 k 22 9 . 352 7 . 084 W 46 8 . 352 30 . 084 I 24 8 . 352 8 . 084 Al - A0 is 24 . 268 ; overlap ( integral in Eq . ( 11 ) ) is 1 . 2 x BP * . ACKNOWLEDGMENTS I first learned of overlap methods , and of the statistical difficulty of estimating free energies from machine data , while working with Bemi Alder and Mary Arm Mansigh in 1966 - 70 . Dis - cussions with Aneesur Rahman , John Barker , and Betty Flehinger , and particularly reading Valleau and Card’s 1972 paper , stimulated my thinking . 268 CHARLES H . BENNETT REFERENCES 1 . M . METROPOLIS , A . W . ROSENBLUTH , M . N . ROSENBLUTH , A . H . TELLER , AND E . TELLER , J . Chem . Phys . 21 ( 1953 ) , 1087 . 2 . W . W . WOOD , ir ! “The Physics of Simple Liquids , ” ( H . N . V . Temperley , J . S . Rowlinson , and G . S . Rushbrooke , Eds . ) , North - Holland , Amsterdam , 1968 . 3 . B . J . ALDER AND T . E . WAINWRIGHT , J . Chem . Phys . 31 ( 1959 ) , 459 ; 33 ( 1960 ) , 1439 . 4 . W . G . HOOVER AND F . H . REE , J . Chem . Phys . 47 ( 1967 ) , 4873 ; 49 ( 1968 ) , 3609 . 5 . J . - P . HANSEN AND L . VERLET , Phys . Rev . 184 ( 1969 ) , 151 . 6 . G . TORRIE , J . P . VALLEAU , AND A . BAIN , J . Chem . Phys . 58 ( 1973 ) , 5479 . 7 . G . TORRIE AND J . P . VALLEAU , Chem . Phys . Lett . 28 ( 1974 ) , 578 ; J . Comput . Phys . , to be published . 8 . D . R . SQIJIRE AND W . G . HOOVER , J . Chem . Phys . 50 ( 1969 ) , 701 . 9 . I . R . MCDONALD AND K . SINGER , J . Chem . Phys . 47 ( 1967 ) , 4766 . 10 . C . H . BENNETT , in “Diffusion in Solids : Recent Developments” edited ( A . S . Nowick and J . J . Burton , Eds . ) , Academic Press , New York , 1975 . 11 . R . W . ZWANZIG , J . Chem . Phys . 22 ( 1954 ) , 1420 . 12 . W . R . ! & TH , in “Statistical Mechanics 1” ( K . Singer , Ed . ) , Chem . Sot . Pub ] . , London , 1973 . 13 . Z . W . SALSBIJRG , J . D . JACOBSON , W . FICKETT , AND W . W . WOOD , J . Chem . Phys . 30 ( 1959 ) , 65 . 14 . W . R . Sm , in “Statistical Mechanics 1” ( K . Singer , Ed . ) , pp . 98 - 99 . Chem . Sot . Pub ] . , London , 1973 . 15 . J . A . BARKER AND D . HENDERSON , J . Chem . Phys . 47 ( 1967 ) , 2856 and 4714 . 16 . D . LEVE ~ QUE AND L . VEFUET , Phys . Reo . 182 ( 1969 ) , 307 . 17 . J . P . VALLEAU AM ) D . N . CARD , J . Chem . Phys . 57 ( 1972 ) , 5457 . 18 . C . H . BENNETT , J . Comput . Phys . 19 ( 1975 ) , 267 . 19 . R . FLETCHER AND M . J , D . POWELL , Coqut ! J . 6 ( 1963 ) , 163 . 20 . M . L ~ vrrr AND A . WARSHEL , Nature 253 ( 1975 ) , 694 .
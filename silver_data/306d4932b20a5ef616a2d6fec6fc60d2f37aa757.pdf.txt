Computer Visualization of Three - Dimensional Image Data Using IMOD J AMES R . K REMER , D AVID N . M ASTRONARDE , AND J . R ICHARD M C I NTOSH Boulder Laboratory for 3 - D Fine Structure , Department of MCD Biology , University of Colorado , Boulder , Colorado 80309 - 0347 Received May 12 , 1995 , and in revised form August 3 , 1995 We have developed a computer software package , IMOD , as a tool for analyzing and viewing three - dimensional biological image data . IMOD is useful for studying and modeling data from tomographic , serial section , and optical section reconstructions . The software allows image data to be visualized by several different methods . Models of the image data can be visualized by volume or contour sur - face rendering and can yield quantitative informa - tion . © 1996 Academic Press , Inc . INTRODUCTION The amount and diversity of three - dimensional ( 3 - D ) image data being studied in structural biology has increased steadily with advances in microscope and computer technology . Currently , there is a high demand for computer software that can analyze and display such complex data sets . We have developed several computer programs as an aid for studying 3 - D biological data ( McDonald et al . , 1991 ; Wilson et al . , 1992 ) and have recently developed the program IMOD to aid in viewing , modeling , and analyzing 3 - D image data for structural biology ( Kremer et al . , 1994 ) . IMOD was written to facilitate viewing of complex and convoluted 3 - D image data of the type found in cellular and developmental biology ; it affords a user several ways to view , analyze , and model image data in order to obtain a better understanding of the structure under study . Most of the controls in IMOD were designed to have simple , yet complete , user interaction . The type of data most suitable for anal - ysis by IMOD is 3 - D image data from a volume of material , in which each voxel has a single intensity value . Examples of these data are tomographic re - constructions , serial section images from an electron microscope , and optical sections from a light micro - scope . MATERIALS AND METHODS Preparation of the 3 - D image data for use in IMOD . Tomo - graphic data sets are calculated from a series of tilted views using the R - weighted back projection algorithm ( Gilbert , 1972 ) . The tilt series must ﬁrst be aligned by creating a list of ﬁducial points , typically colloidal gold particles on the surface of the specimen . The program TILTALIGN uses the minimization approach de - scribed by Luther et al . ( 1988 ) to solve for the tilt angles and for the shifts , rotations , and size changes needed to align the views . TILTALIGN has two features that help to achieve accurate align - ment . First , if necessary , individual ﬁducials can be labeled through only a subset of views , i . e . , those in which a particular ﬁducial is seen clearly . ( The program by Jing and Sachs ( 1991 ) also has this feature but cannot solve for tilt angles or section distortion . ) Second , some parameters , such as ones that adjust for section distortion , can be expected to change slowly through the series . Several sequential views can be constrained to have the same , unknown , value of such a parameter , substantially reduc - ing the number of unknowns that must be solved for . Serial section images must frequently be aligned using linear transformations that allow for overall change in size and stretch along an arbitrary axis as well as image translation and rotation ( McDonald et al . , 1991 ) . Three methods ( described more fully in Mastronarde et al . , 1992 ) are available in separate programs for obtaining the needed transformations . The ﬁrst program allows one to visualize the alignment between a pair of adjacent sections while manually adjusting the transformation applied to one of them . This program can also transform contours or points within a model , so that if a misalignment is noticed after modeling has begun , a correction can be made without having to remodel the newly aligned 3 - D image . Second , one can make a list of ﬁducial points that correspond between adjacent sections and use these to solve for the linear transformations . Third , if enough image fea - tures are similar from one section to the next , the alignment can be done automatically , using a simplex algorithm to search for the transformation that minimizes a measure of image difference . IMOD uses the MRC image ﬁle format developed at the Med - ical Research Council , Cambridge , England . We chose this format for IMOD because we had already developed numerous programs that used it to run on a VaxStation 3200 ( McDonald et al . , 1991 ) . This format has the advantage of storing the 3 - D image or stack of 2 - D images in one ﬁle . Ancillary programs in the IMOD pack - age can convert TIFF image ﬁles in the byte format , rgb ﬁles from Silicon Graphics , Inc . ( SGI ) , and raw image data to the MRC format . Once the 3 - D image volume has been converted to MRC format and aligned , it is ready for viewing and modeling . Viewing the 3 - D image data with IMOD . IMOD allows 3 - D image data to be visualized by several different methods . Each view is shown in its own window and is linked with others that show the same location in 3 - D space from a different point of view . In this way , IMOD allows one to visualize 3 - D image data inter - actively on a 2 - D computer display . The windows representing these views are called the Zap ( zoom and pan ) window ( Fig . 1B ) , Model View window ( Fig . 1C ) , Tumbler window ( Fig . 2A ) , Image JOURNAL OF STRUCTURAL BIOLOGY 116 , 71 – 76 ( 1996 ) ARTICLE NO . 0013 71 1047 - 8477 / 96 $ 18 . 00 Copyright © 1996 by Academic Press , Inc . All rights of reproduction in any form reserved . Graph window ( Fig . 2B ) , Slicer window ( Fig . 2C ) , XYZ window ( Fig . 2D ) , and Tilt window . All windows share the same current point within the 3 - D data set and share the same brightness and contrast settings . IMOD’s main program window ( Fig . 1A ) shows the status of the model being built , the current location of the displays in the 3 - D image , and the current contrast settings . This window can also display text information , such as the areas within contours and error messages . The Zap window allows the user to zoom and pan an image in real time . The view represented by the Zap window is a slice perpendicular to the Z - axis in the 3 - D image volume ( Fig . 1C ) . The Zap window overlays model contours and points on the im - age , and the model may be edited using a mouse . Panning from one area to another is quickly done by using the mouse to drag the image to the desired view . The Model View window shows a Z - buffered wire frame ren - dering of model contour , line , and point data with adjustable per - spective ( Fig . 1C ) . The model data can be visualized in cross - eyed or wall - eyed stereo , and adjustments for scaling , rotation , and translation can be made manually . The view of the model data can be rotating while one is editing it . The XYZ window contains three views arranged like a mechan - ical drawing of a 3 - D object ( Fig . 2D ) . The lower left image is the same view shown in the Zap window ; the top and right images are orthogonal planes cut through the volume at the current viewing point along the X - and Y - axes , respectively . The layout of this view allows one to know exactly what planes of the 3 - D image data are being displayed . The Slicer window displays a slice cut through the 3 - D image data in any chosen orientation ( Fig . 2C ) . The slice can be rotated about the Z - , Y - , and X - axes and can be zoomed up . The slice can be displayed quickly with nearest - neighbor interpolation or with higher quality , but slower , quadratic interpolation . The orienta - tion of the slice in the 3 - D volume is shown by lines that indicate the intersection of the slice’s plane with the X , Y , and Z normal planes displayed in the XYZ window ( Fig . 2D ) The Tilt and Tumbler windows each show an orthographic summed voxel projection of the 3 - D data ; the former is based on a precalculated series of images , whereas the latter is calculated in real time . The Tilt window can display the original tilted views from which a tomogram was calculated , or a series of projections about the Y - axis of a 3 - D volume . One can also use this window to view the current model contour within the 3 - D data set in cross - eyed stereo . The Tumbler window shows a projection of a small volume around a selected point ( Fig . 2A ) . The user can easily rotate the volume to any orientation . Modeling areas of interest . The model structure in IMOD was designed to be ﬂexible and fast by employing a data hierarchy . Models can contain several types of data including a list of scat - tered points , a list of contours describing a surface , a 3 - D polygon F IG . 1 . Modeling a tomogram of the trans - Golgi network . The main program window ( A ) shows the current object , contour , and point along with the current X , Y , and Z location in 3 - D space . At the bottom , the current contour’s area and length have been printed out . The ‘‘Black’’ and ‘‘White’’ sliders are used for controlling image contrast . The Zap window ( B ) shows a slice though the image data with model contours overlaid . The Model View window ( C ) shows a Z - buffered wire - frame rendering in real time as the model is being built . KREMER , MASTRONARDE , AND MCINTOSH 72 mesh , a list of connected line segments , a list of points describing locations of similarly shaped items such as nuclear pores , or a list of scanline segments used for volume rendering . Data of one type can be grouped together into a single object that has attributes such as color , shininess , transparency , line width , point size , and name . All data types except the 3 - D polygon mesh and the scan - line list can be edited manually . Contours can be created by a semiautomated procedure that creates a contour around a se - lected area at a given threshold . Moreover , an entire contour - based model can be created by a fully automated threshold algo - rithm . Models generated automatically can be edited manually to improve the accuracy of the model . Visualization of the modeled volume . Once a 3 - D volume has been modeled , the model can be studied further . A projection of the 3 - D model can be displayed either by surface rendering of the contour data or by volume rendering of the image data contained within the contours . Quantitative results , such as volumes , sur - face areas , nearest neighbor distances , and centroids can be ob - tained from the model data . A smooth skin can be wrapped around the volume represented by the contours of a given object . The skin is represented by a surface mesh of connected triangles whose points are the same data points contained within the contours , along with additional points used to connect branches as needed . Adjacent contours are connected using an algorithm that minimizes the length of con - necting lines between the two contours . Branches are handled by a method similar to that of Shantz ( 1981 ) . Surface normals are also calculated , allowing a simple lighting algorithm to be used to display each object . The display program for this type of render - ing , IMODV , is completely user - interactive . Volume rendering is done by a separate command - line - driven program that generates movies of the 3 - D image data rotating about a ﬁxed axis . Other image processing tools . Several other command - line - driven programs are available to work with IMOD . Available op - erations include rotation , translation , stretching , cross - correlation , edge detection , calculating Fourier transforms , image averaging , ﬁltering , and adjusting contrast and brightness . Most of these processes can be done in 2 - D or 3 - D . Montaged images can also be blended together to create a single large image . RESULTS High Voltage Electron Microscope Tomography IMOD has been used to model tomographic image data of the trans - Golgi network and trans - Golgi cis - ternae in NRK cells ( Ladinsky et al . , 1994 ) . An ex - ample of this application can be seen in Fig . 1 , and F IG . 2 . Viewing a tomogram of insect ﬂight muscle in a relaxed state . The Tumbler window ( A ) shows a small cube cut out of the tomogram around the current point . The Image Graph X window ( B ) shows a graph of voxel intensity along the horizontal ( X ) dimension of the tomographic data shown in the XYZ window . The vertical line shows the location of the current X value . The Slicer window ( C ) shows a slice that has been rotated by 2 6 . 6° about the X - axis , 2 7 . 1° about the Y - axis , and 11 . 6° about the Z - axis of the tomogram , as indicated by the three sliders . The XYZ window ( D ) shows the planes that intersect the current viewing point normal to the X - , Y - , and Z - axes . The lines through the images show the intersection of these planes with the plane shown in the Slicer window ( C ) . Lines in the upper right corner of the XYZ window depict the current depth in the volume , and two additional lines show where the orthogonal slices are being cut through the volume . COMPUTER VISUALIZATION OF 3 - D IMAGE DATA USING IMOD 73 an example of a completed model is shown in Figs . 3A and 3B . The tomograms shown in Fig . 2 were generated from two 6 60° tilt series of a 0 . 25 - m m section of re - laxed insect ﬂight muscle . Micrographs were taken at 1° intervals around orthogonal axes and com - bined to create a single tomogram . The myoﬁla - ments were not perfectly aligned with the plane of section ( Fig . 2D ) , so the Slicer window was used to bring a plane containing alternating thick and thin ﬁlaments into view ( Fig . 2C ) . Serial Section Reconstruction from Electron Micrographs IMOD has also been used in several studies of 3 - D reconstructions from serial sections imaged in an electron microscope . An example of one such recon - struction , of a mitotic nucleus from a wild - type yeast cell , can be seen in Fig . 3C . The small bright spheres represent the nuclear pores , which were modeled by manually selecting the center of each pore . One sec - tion was missing from the input data , but an option for the skinning program , IMODMESH , was used to ﬁll in the missing data . We are now collecting sta - tistics on the number and distribution of the nuclear pores from several models from differing strains of yeast . Other Forms of Data IMOD can be useful for studying any kind of iso - tropic 3 - D images , such as ones from confocal mi - croscopy or MRI scans . For example , image data of a 12 - cell embryo of the nematode , C . elegans ( Wood , 1988 ) , were acquired from a light microscope using Nomarski differential interference contrast optics . The cell membranes and nuclei were modeled and then rendered as shown in Fig . 3D to illustrate the value of being able to make individual objects trans - parent . IMOD has thus proven useful for determin - ing the connectivity between structures in light mi - croscopic images as well as in electron tomographic data . DISCUSSION Advantages of Using IMOD for Viewing 3 - D Image Data Most scientists who have worked with 3 - D images have confronted the problem of studying and dis - playing their data in a reliable , comprehensible manner . IMOD was conceived and implemented in a laboratory that confronts these problems on a daily basis . The ﬂexibility and power of this program re - ﬂects our strong belief that multiple approaches to display and analysis contribute to a valid under - standing of 3 - D data . Each of the different views available within the IMOD program provides a different form of data vi - sualization ; our experience suggests that each form of display offers different insights into the 3 - D struc - ture under study . For example , slices viewed seria - tim in the third dimension are extremely useful for developing a clear understanding of 2 - D arrange - ments , but with such a display it is sometimes dif - ﬁcult to perceive the links between complex 3 - D ob - jects . Graphic contours drawn over 2 - D data and as - sembled in 3 - D can help one to perceive such linkages , but some form of rendering into a 3 - D sur - face is often necessary to display the continuity clearly . On the other hand , it is not uncommon to introduce errors of interpretation while making such a model . Since identifying and correcting such errors in a rendered model is impossible , it is impor - tant to have effective ways of perceiving continuity in the original image data . IMOD’s Slicer window , which allows one to cut a 3 - D data set in a plane with easily chosen orientation and position , has been helpful in developing accurate models of cyto - plasmic membranes . It has also helped in obtaining informative views of highly ordered structures , such as a myoﬁbril . Finally , we have found that models are most accurate when they go through several generations of reﬁnement . Our effort to develop semiautomated modeling routines , which provide draft structures that can subsequently be manually edited within IMOD , reﬂects our experience that a trained scientiﬁc observer is generally the best ar - biter of difﬁcult questions about the relationships between the model and the original data . Display ﬂexibility is also valuable in viewing mod - els . One wants varying levels of model complexity , ranging from simple contours to wire frames to ren - dered surfaces . One also wants different levels of transparency to enhance viewing of certain model features . An obvious value of building computer models of complex structures is the ease with which structural data may subsequently be quantiﬁed for objective analysis of hypothetical structural fea - tures . This ability has been particularly useful for us in our analysis of mitotic spindles ( e . g . , Mastronarde et al . , 1993 ) . IMOD’s abilities to measure areas , vol - umes , and contour lengths and to count objects of any model class constitute additional advantages of the software now available . Requirements for Using IMOD IMOD was developed on a SGI computer system and currently requires an SGI with 24 - bit graphics in order to run . We plan to make IMOD available for more computer systems by using X - Windows / Motif and SGI’s OpenGL for rendering of the graphic data . Using these programming interfaces would allow all 8 - bit X - Windows - capable computers to run IMOD . The executable version of IMOD and all ancillary KREMER , MASTRONARDE , AND MCINTOSH 74 F IG . 3 . Reconstructions by contour modeling in images acquired in three different ways . ( A , B ) The completed model of the trans - Golgi network tomogram from Fig . 1 is shown by volume rendering ( A ) and by surface rendering ( B ) . Each type of rendering shows different aspects of the tomographic data . ( C ) An example of a reconstruction based on serial section electron micrographs . The model represents a mitotic nucleus from a wild - type yeast cell , showing the location of the nuclear pores as spheres and the location of the nuclear envelope as a semi - transparent skin . Yeast were prepared and imaged as described in Winey et al . ( 1995 ) . ( D ) An example of a reconstruction based on optical sections . The model represents a 12 - cell C . elegans embryo showing the cell membranes ; the nuclei ( N ) of the MS cell can be seen through the transparent membrane . The thickness of each optical slice was 0 . 5 m m and the pixel size was 90 nm . COMPUTER VISUALIZATION OF 3 - D IMAGE DATA USING IMOD 75 programs are freely available from the Boulder Lab - oratory for 3 - D Fine Structure . Future Improvements to IMOD IMOD is a fairly new program , and we are work - ing both on improvements to IMOD and on addi - tional programs . We are currently seeking to en - hance automated modeling by adding edge detection along with threshold detection ( Yanowitz and Bruckstein , 1989 ) and by adding the ability to detect speciﬁc types of objects , such as the nuclear pores shown in Fig . 3C . Users will be able to start outlin - ing contours with a few points and have an interac - tive edge tracer complete the contour . The Slicer window ( Fig . 2C ) will add the ability to display slices of different thicknesses and to view these thick slices in stereo . Volume rendering is now done statically , but it will be valuable to have this rendering occur in real time after the user selects the orientation of the model . Interactive or batch ﬁle control will be used to render 3 - D movies automat - ically . We thank Mark Winey and Thomas H . Giddings for supplying the yeast model , William Wood and Daniel Weaver for supplying the 12 - cell embryo model , Mary Reedy and Michael Reedy for providing a sample of muscle , David Agard and Hans Chen for the original MRC source code , and Wah Chiu for a Unix version of low - level MRC ﬁle routines . This work was supported by Grant RR00592 from the National Institutes of Health to J . R . McIn - tosh . REFERENCES Gilbert , P . F . C . ( 1972 ) The reconstruction of a three - dimensional structure from projections and its application to electron mi - croscopy . II . Direct methods , Proc . R . Soc . London B Ser . Biol . Sci . 182 , 89 – 102 . Jing , Z . , and Sachs , F . ( 1991 ) Alignment of tomographic projec - tions using an incomplete set of ﬁducial markers , Ultramicros - copy 35 , 37 – 43 . Kremer , J . R . , Furcinitti , P . S . , and McIntosh , J . R . ( 1994 ) New image modeling software used for 3 - D analyses of biological electron microscopy data on Silicon Graphics computers , Proc . Microsc . Soc . Am . 52 , 334 – 335 . Ladinsky , M . S . , Kremer , J . R . , Furcinitti , P . S . , McIntosh , J . R . , and Howell , K . E . ( 1994 ) HVEM tomography of the trans - Golgi network : Structural insights and identiﬁcation of a lace - like vesicle coat , J . Cell Biol . 127 , 29 – 38 . Luther , P . K . , Lawrence , M . C . , and Crowther , R . A . ( 1988 ) A method for monitoring the collapse of plastic sections as a func - tion of electron dose , Ultramicroscopy 24 , 7 – 18 . Mastronarde , D . N . , O’Toole , E . T . , McDonald , K . L . , McIntosh , J . R . , and Porter , M . E . ( 1992 ) Arrangement of inner dynein arms in wild - type and mutant ﬂagella of Chlamydomonas , J . Cell Biol . 118 , 1145 – 1162 . Mastronarde , D . N . , McDonald , K . L . , Ding , R . , and McIntosh , J . R . ( 1993 ) Interpolar spindle microtubules in PTK cells , J . Cell Biol . 123 , 1475 – 1489 . McDonald , K . L . , Mastronarde , D . N . , O’Toole , E . T . , Ding , R . B . , and McIntosh , J . R . ( 1991 ) Computer - based tools for morpho - metric analysis of mitotic spindles and other microtubule sys - tems , EMSA Bull . 21 , 47 – 53 . Shantz , M . ( 1981 ) Surface deﬁnition for branching , contour - deﬁned objects , Comput . Graphics 15 , 242 – 266 . Wilson , C . J . , Mastronarde , D . N . , McEwen , B . , and Frank , J . ( 1992 ) Measurement of neuronal surface area using high - voltage electron microscope tomography , Neuroimage 1 , 11 – 22 . Winey , M . , Mamay , C . L . , O’Toole , E . T . , Mastronarde , D . N . , Gid - dings , T . H . , McDonald , K . L . , and McIntosh , J . R . ( 1995 ) Three - dimensional ultrastructural analysis of the Saccharomy - ces cerevisiae mitotic spindle , J . Cell Biol . 129 , 1601 – 1615 . Wood , W . B . ( 1988 ) Embryology , in Wood W . B . ( Ed . ) , The Nem - atode Caenorhabditis elegans , pp . 215 – 242 Cold Spring Harbor Laboratory , Cold Spring Harbor , NY . Yanowitz , S . D . , and Bruckstein , A . M . ( 1989 ) A new method for image segmentation , Comput . Vision , Graphics , Image Proc . 46 , 82 – 95 . KREMER , MASTRONARDE , AND MCINTOSH 76
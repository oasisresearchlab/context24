(cid:0)(cid:2)(cid:3)(cid:4)(cid:5)(cid:3)(cid:6)(cid:7)(cid:8)(cid:9) (cid:8)(cid:10) (cid:11)(cid:5)(cid:12)(cid:13)(cid:14)(cid:3)(cid:15)(cid:16) (cid:11)(cid:17)(cid:3)(cid:14)(cid:18)(cid:16)(cid:7)(cid:9)(cid:13) (cid:3)(cid:4)(cid:13)(cid:8)(cid:14)(cid:7)(cid:6)(cid:16)(cid:19)(cid:11) (cid:10)(cid:8)(cid:14) (cid:20)(cid:17)(cid:6)(cid:17)(cid:18)(cid:6)(cid:7)(cid:9)(cid:13) (cid:9)(cid:17)(cid:6)(cid:21)(cid:8)(cid:14)(cid:22) (cid:19)(cid:8)(cid:6)(cid:7)(cid:10)(cid:11) (cid:7)(cid:9) (cid:12)(cid:7)(cid:8)(cid:4)(cid:8)(cid:13)(cid:7)(cid:18)(cid:3)(cid:4) (cid:9)(cid:17)(cid:6)(cid:21)(cid:8)(cid:14)(cid:22)(cid:11) Jialu HU 1 , Lin GAO 1 , Guimin QIN 1 , 2 1 School of Computer Science and Technology , Xidian University , Xi’an 710071 , China 2 Software School , Xidian University , Xi’an 710071 , China c (cid:2) Higher Education Press and Springer - Verlag 2009 Abstract Despite several algorithms for searching sub - graphs in motif detection presented in the literature , no ef - fort has been done for characterizing their performance till now . This paper presents a methodology to evaluate the performance of three algorithms : edge sampling algorithm ( ESA ) , enumerate subgraphs ( ESU ) and randomly enumer - ate subgraphs ( RAND - ESU ) . A series of experiments are performed to test sampling speed and sampling quality . The results show that RAND - ESU is more ef ﬁ cient and has less computational cost than other algorithms for large - size mo - tif detection , and ESU has its own advantage in small - size motif detection . Keywords network motifs , subgraphs searching , sub - graphs enumeration , sampling algorithm (cid:0) (cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:8)(cid:9)(cid:4)(cid:10)(cid:6)(cid:3) An amount of data becomes available and has an exponen - tial increase on key cellular networks in a variety of simple organisms . It leads to a pressing need for a theory of com - plex networks which may help us uncover some concealed properties in these networks and may assist biologists in un - derstanding processes in organisms . To uncover the struc - tural design principles [ 1 ] and ﬁ nd the basic building blocks of complex networks , network motif was de ﬁ ned as patterns of interconnections occurring signi ﬁ cantly more frequently than those in randomized networks [ 2 , 3 ] . It has been suggested that motifs are often substructures with potential functional properties in a network [ 2 , 4 , 5 ] . Transcriptional regulatory networks , for instance , are very important data sources in the study of complex networks be - cause of their valuable signi ﬁ cance . They are biochemical Received December 15 , 2008 ; accepted June 2 , 2009 E - mail : lgao @ mail . xidian . edu . cn networks responsible for regulating the expression of genes in cells [ 3 ] . Several experimental results show that the simplest units of commonly used transcriptional regula - tory network architecture could provide speci ﬁ c regula - tory capacities such as positive and negative feedback loop [ 6 ] . Feed - forward loop ( FFL ) motif contains a regulator which controls a second regulator and has additional fea - ture that both regulators bind a common target gene . It has been shown theoretically to perform information - processing tasks such as sign - sensitive ﬁ ltering , response acceleration and pulse - generation [ 7 ] . Thus , the study of motif detec - tion in gene regulatory networks in which many functional substructures are currently unknown is in an urgent situation . There are four main tasks in the process of detecting net - work motifs : ( 1 ) generating an ensemble of proper random networks ; ( 2 ) scanning all the subgraphs in the networks ; ( 3 ) determining which of these subgraphs are isomorphic ; and ( 4 ) comparing substructure number with the expected number in random graphs . The problem is similar to that described in frequent sub - graphs mining algorithms [ 8 , 9 ] . However , it has to scan all possible patterns in large connected networks in the second task [ 2 , 10 , 11 ] . This dif ﬁ cult computational task is a ma - jor challenge facing us [ 12 ] . Several algorithms for search - ing certain classes acted by exact counting are known such as cycles [ 13 , 14 ] , cliques [ 15 , 16 ] and enumerate subgraphs ( ESU ) [ 11 ] . Aiming to cope with the complexity of exact counting , approaches of approximate counting were devel - oped such as counting Hamiltonian cycles or spanning trees in graphs [ 17 – 19 ] , edge sampling algarithm ( ESA ) [ 10 ] , ran - domly enumerate subgraphs ( RAND - ESU ) [ 11 ] , and opti - mizing counting algorithms [ 20 ] . In this paper , we give an introduction to three algorithms and present a methodology on how to evaluate their perfor - mances . The algorithms experimented here are ESA [ 10 ] , Front . Comput . Sci . China 2009 , 3 ( 3 ) : 412 – 416 413 ESU [ 11 ] and RAND - ESU [ 11 ] . We brie ﬂ y characterize each of these algorithms and evaluate two sampling algo - rithms for their performances of sampling speed and sam - pling quality . Then , we give a comparison of them for their sampling speed . Finally , we suggest appropriate choices of these algorithms for different requirements in motif detec - tion . (cid:11) (cid:12)(cid:13)(cid:4)(cid:14)(cid:5)(cid:10)(cid:13)(cid:15)(cid:16) (cid:13)(cid:3)(cid:7) (cid:17)(cid:14)(cid:4)(cid:18)(cid:6)(cid:7) All the three algorithms have been applied on general di - rected graphs . They are restricted to ﬁ nd connected sub - graphs in large networks . Furthermore , note that the concept of frequency appearing in this paper adopts F1 frequency [ 5 ] . It is described as the maximum number of different matches of one pattern which includes all the possible matches . Ac - cordingly , overlap is not under consideration in our subject . Hereafter , we give a simple conceptual description of the three algorithms . For more detailed information , the reader is referred to Refs . [ 10 , 11 , 21 ] . ESA is based on estimating the frequency of subgraphs from a randomly sampled set . Select a random edge and then randomly extend this edge with its connected edges un - til we obtain a reduced subgraph with the desired number of vertices . ESU ef ﬁ ciently enumerates all the size - k subgraphs . Here , a subgraph is extracted by selecting an individual node and extending one adjacent node at a time until the required size is reached . It recursively calls a procedure to extend the subgraphs and builds an ESU - tree whose leaves correspond to subgraphs of size k and internal nodes correspond to sub - graphs of size 1 up to k − 1 . RAND - ESU [ 11 , 21 ] adopts sampling strategy based on the ESU algorithm described above . Furthermore , it can esti - mate subgraph concentration with an unbiased estimator for its uniform sampling probability . (cid:19) (cid:20)(cid:14)(cid:16)(cid:8)(cid:15)(cid:4)(cid:16) We performed all these algorithms on a common platform , Xeon ( TM ) CPU 3 . 60 GHz with 3 . 00 GB memory run - ning under Microsoft Windows XP Professional ( sp3 ) , for the same transcriptional regulatory networks by m ﬁ nder1 . 2 and FANMOD . The testing gene regulatory networks used in this study are two best characterized transcriptional reg - ulation networks , corresponding to organisms from differ - ent kingdoms : a eukaryote ( Saccharomyces cerevisiae ) and a prokaryocyte ( Escherichia coli ) . It is freely obtainable † http : / / wwwweizmann . ac . il / mcb / UriAlon / group NetworksData . html . online † . 3 . 1 Evaluating the performance of subgraph searching algorithms based on sampling Based on a detailed analysis and a large number of experi - ments , we present a methodology to give a comprehensive and systematic evaluation for sampling algorithms . The per - formance evaluation is pursued on two aspects : sampling speed and sampling quality , which are related with runtime and precision of results , respectively . The results of our ex - periments will be particularly stated as follows . To deal with the complexity of exact counting , ESA adopts an idea based on sampling subgraphs to estimate subgraph concentrations . The runtime of the algorithm is asymptotically dependent on the network size . The result is shown in Fig . 1 . Fig . 1 Sampling speed of ESA for size 3 - 8 motif detection in the tran - scriptional network of Saccharomyces cerevisiae Compared with ESA , RAND - ESU requires a selection of sampling parameters , ( p 1 , p 2 , . . . , p k ) , for controlling the number of sampled subgraphs . Parameter p d ( 0 (cid:2) p d (cid:2) 1 ) denotes the sampling probability of every depth d ( 1 (cid:2) d (cid:2) k ) in ESU - tree . It is unbiased that each leaf of the corre - sponding ESU - tree can be visited with uniform probability (cid:2) d p d . In order to sample 10 percent of all subgraphs as expected , a series of parameters ( 1 , 1 , . . . , 1 , p k − 1 , p k ) are introduced , satisfying p k − 1 p k = 0 . 1 . The size of network motifs ranges from three to ﬁ ve . To select optimal param - eters , a detailed analysis and some experiments for various parameters have been performed . The results are shown in Fig . 2 ( a ) and ( b ) . The ﬁ gures indicate that the input parameters impact sam - pling speed of motif detection , and sampling speed is larger and larger with increasing probability p k on the whole . 414 Jialu HU , et al . Evaluation of subgraph searching algorithms for detecting network motifs in biological networks Fig . 2 Sampling speed of RAND - ESU for size 3 - 5 motif detection in transcriptional network . ( a ) for Saccharomyces cerevisiae ; ( b ) for Escherichia coli . Curve 1 - 3 in each ﬁ gure show the results for size 3 - 5 motif detection , respectively These results agree with the theoretical analysis of RAND - ESU quite well . As we do not survey all the possible ranges of parameters , we cannot be sure of the exact optimal pa - rameters . It is found that the optimal parameter of p k ranges from 0 . 8 to 0 . 9 . Both factors of sampling speed and quality can affect the ef ﬁ ciency of estimation . In order to evaluate sampling qual - ity , we propose a qualitative measurement , sample qualita - tive value ( SQV ) . SQV value for one sampling process is de - ﬁ ned as below : SQV = − log (cid:3)(cid:4) i ( C i sample ( G ) − C i real ( G ) ) 2 N . Given a graph G and a set R of size - k subgraphs , C i sample is the concentration of one type of subgraphs in the input network . With the same reason , C i real is the concentration in all the possible subgraphs [ 10 , 11 ] . N denotes the num - ber of all isomorphic types of subgraphs with k nodes ( there are 13 different types of three - node subgraphs , 199 for four - node subgraphs , 9364 for ﬁ ve - node subgraphs , etc . [ 10 ] ) , and k is given . It is clear that the greater the SQV value , the better the sampling quality is . Then we give a comparison of RAND - ESU with ESA using SQV . We sample parameter space for three - node motif detection to ﬁ nd out the effect of SQV value with the same sampling probability P ( P = 0 . 1 ) . In order to perform ESA algorithm in the same condition as that of RAND - ESU , we set the threshold to 1315 which is ten percent of the total subgraphs in the input network . The results shown in Table 1 indicate that smaller pa - rameter p k is good for the sampling quality of RAND - ESU . Hence , it is necessary to choose optimal parameters to bal - ance both of the performances in the process . Unbiased as it is , ESA gives a very accurate estimation with a compara - tively small number of samples for its exact correction . In order to make SQV value reach that of ESA , it is necessary to set parameters p k (cid:2) 0 . 1 . The result obtained by ESU can be made the reference standard for other experiment re - sults for its exhaustive enumeration . SQV gives a simple and direct show for sampling quality . Note that only ﬁ ve of thir - teen different types of substructures are shown in Table 1 for the absence of other types . The data in Table 1 are the results of an experiment for Saccharomyces cerevisiae . Par - ticularly , RAND - ESU is performed with ten different param - eters of p k , ranging from 0 . 1 to 1 . 0 . Subgraph id represents the adjacency matrix of the subgraph as a long binary inte - ger extracted by concatenation of the rows of the matrix . For example , CS5 ( concentration of the ﬁ fth type of subgraph ) id is 38 ( binary 011001000 , with least signi ﬁ cant bit on the left ) . 3 . 2 Comparing the speed of the three subgraphs searching algorithms In order to compare the ef ﬁ ciency of the three algorithms , we apply them to the transcriptional regulatory network of Saccharomyces cerevisiae for detecting size - k network mo - tif , 3 (cid:2) k (cid:2) 8 . Among all the three algorithms , the results of ESA have the most cost of runtime in searching process ( Fig . 3 ) . The speed curve falls off very rapidly when the motif size rises to ﬁ ve . As we see in Fig . 3 , it can reach a speed which is much higher than that of ESA . It is a very time - consuming task to enumerate all the possible subgraphs with size bigger than ﬁ ve ( k (cid:3) 5 ) in the large ensemble of ( e . g . , 1000 random Front . Comput . Sci . China 2009 , 3 ( 3 ) : 412 – 416 415 Table 1 Comparison of ESA with RAND - ESU for sampling quality with various parameters Algorithms Para . a ) CS1 ( 6 ) CS2 ( 12 ) CS3 ( 14 ) CS4 ( 36 ) CS5 ( 38 ) SQV RAND - ESU 0 . 1 0 . 909 0 . 024 0 . 002 0 . 064 0 . 002 2 . 678 0 . 2 0 . 926 0 . 022 0 . 003 0 . 048 0 . 002 2 . 071 0 . 3 0 . 929 0 . 016 0 . 002 0 . 048 0 . 004 2 . 032 0 . 4 0 . 934 0 . 014 0 . 002 0 . 049 0 . 002 1 . 985 0 . 5 0 . 942 0 . 020 0 . 001 0 . 035 0 . 001 1 . 847 0 . 6 0 . 940 0 . 016 0 . 001 0 . 040 0 . 003 1 . 886 0 . 7 0 . 946 0 . 020 0 . 001 0 . 032 0 . 002 1 . 807 0 . 8 0 . 951 0 . 021 0 . 000 0 . 026 0 . 002 1 . 752 0 . 9 0 . 947 0 . 020 0 . 000 0 . 033 0 . 000 1 . 804 1 . 0 0 . 949 0 . 012 0 . 000 0 . 039 0 . 000 1 . 812 ESA \ 0 . 908 0 . 023 0 . 001 0 . 062 0 . 006 2 . 657 ESU \ 0 . 903 0 . 022 0 . 001 0 . 068 0 . 005 \ a ) The parameter ranges from 0 . 1 to 1 . 0 for RAND - ESU networks ) generated random networks [ 11 , 21 ] . Hence , we just enumerate all the subgraphs in the original network and twenty related random networks to evaluate the speed . For RAND - ESU , it is necessary to choose an optimal pa - rameter to attain a balance between sampling speed and sam - pling quality as what has been stated above . In order to make the SQV value of RAND - ESU more close to that of ESA , we select p k = 0 . 1 . The results in Fig . 3 indicate that RAND - ESU is greatly superior in sampling speed to that of ESA , especially for larger - size motifs , and ESU is slightly faster than RAND - ESU for smaller - size motifs . Fig . 3 Comparison for sampling speed for size - k network motifs , 3 (cid:2) k (cid:2) 8 , on semi - log scale . Through a careful comparison , we ﬁ nd that ESU is the fastest algorithm for searching subgraphs . It is optimal to ap - ply RAND - ESU in motif detection for searching subgraphs as it could also get a high speed , though it is slightly slower than that of ESU for smaller - size motifs . (cid:21) (cid:22)(cid:6)(cid:3)(cid:9)(cid:15)(cid:8)(cid:16)(cid:10)(cid:6)(cid:3) In this study we mainly present a systematic study of three subgraph searching algorithms in motif detection . The results show that ESA also has a precise estimator though it is based on an unbiased sampling method and RAND - ESU is the best one to search subgraphs . ESA is more acceptable than ESU for larger - size motif detec - tion . However , for small - size motif ( k (cid:2) 5 ) with compar - atively less computing work , ESU is greatly superior to any sampling algorithm . Our analysis revealed that sampling speed and SQV value are two con ﬂ icting measurements for RAND - ESU . With the increase of p k , the sampling speed curve is on the rise , while SQV value goes in the opposite di - rection . Accordingly , on one hand it is necessary to ﬁ nd an appropriate parameter to maintain balance on the two per - formances . On the other hand it gives us a chance to pro - pose a more ef ﬁ cient method to challenge this complicated computing task . It is of signi ﬁ cance to rapidly complete the subgraph searching task with an accurate estimator . In summary , this paper gives a comprehensive compar - ison of three algorithms , which may provide ef ﬁ cient guid - ance to biological researchers for selecting a better algorithm or optimal parameters . It will be a good help for improving subgraph searching algorithms and hopefully facilitate fu - ture research on network motif detection and its adjoining ﬁ elds . Acknowledgements This work was supported by the National Natural Science Foundation of China ( Grant No . 60574039 ) and the Ph . D Programs 416 Jialu HU , et al . Evaluation of subgraph searching algorithms for detecting network motifs in biological networks Foundation of Ministry of Education of China ( 200807010013 ) , Xi’an Ap - plied Materials Innovation Fund ( XA - AM - 200605 ) and the Project Spon - sored by the Scienti ﬁ c Research Foundation for the Returned Overseas Chi - nese Scholars , State Education Ministry . The authors are grateful to all the workers who have participated in the research for ESA , ESU and RAND - ESU , as all what we did based on their well done scienti ﬁ c achievement , such as user - friendly motif detection tools , m ﬁ nder1 . 2 for ESA and FAN - MOD for ESU and RAND - ESU . (cid:20)(cid:14)(cid:23)(cid:14)(cid:5)(cid:14)(cid:3)(cid:9)(cid:14)(cid:16) 1 . Teichmann S A , Babu M M . Gene regulatory network growth by duplication . Nature Genetics , 2004 , 36 ( 5 ) : 492 – 496 2 . Milo R , Shen - Orr S , Itzkovitz S , et al . Network motifs : simple build - ing blocks of complex networks . Science , 2002 , 298 ( 5594 ) : 824 – 827 3 . Yeger - Lotem E , Sattath S , Kashtan N , et al . Network motifs in in - tegrated cellular networks of transcription - regulation and protein - protein interaction . In : Proceedings of the National Academy of Sciences , 2004 , 101 ( 16 ) : 5934 – 5939 4 . Shen - Orr S , Milo R , Mangan S , et al . Network motifs in the tran - scriptional regulation network of Escherichia coli . Nature Genetics , 2002 , 31 ( 1 ) : 64 – 68 5 . Schreiber F , Schwbbermeyer H . Towards motif detection in net - works : frequency concepts and ﬂ exible search . In : Proceedings of Intl . Wsh . Network Tools and Applications in Biology , 2004 , 91 – 102 6 . Lee T I , Nical J R , Francois R , et al . Transcriptional regulatory net - works in saccharomyces cerevisiae . Science , 2002 , 298 ( 5594 ) : 799 – 804 7 . Mangan S , Alon U . Structure and function of the feed - forward loop network motif . In : Proceedings of the National Academy of Sci - ences , 2003 , 100 ( 21 ) : 11980 – 11985 8 . Inokuchi A , Washio T , Motoda H . An apriori - based algorithm for mining frequent substructures from graph data . In : Proceedings of European Conference on Principles of Data Mining and Knowledge Discovery , 2000 , 13 – 23 9 . Yan X , Han J . gSpan : graph – based substructure pattern mining . In : Proceedings of IEEE International Conference on Data Mining , 2002 , 721 – 723 10 . Kashtan N , Itzkovitz S , Milo R , et al . Ef ﬁ cient sampling algorithm for estimating subgraph concentrations and detecting network mo - tifs . Bioinformatics , 2004 , 20 ( 11 ) : 1746 – 1758 11 . Wernicke S . Ef ﬁ cient detection of network motifs . IEEE / ACM Transactions on Computational Biology Bioinformatics , 2006 , 3 ( 4 ) : 347 – 359 12 . Itzkovitz S , Milo R , Kastan N , et al . Subgraphs in random networks . Physical Review E , 2003 , 68 , 06127 13 . Johnson D B . Finding all the elementary circuits of a directed graph . SIAM Journal on Computing , 1975 , 4 : 77 – 84 14 . Alon N , Yuster R , Zwick U . Finding and counting given length cy - cles . Algorithmica , 1997 , 17 : 209 – 223 15 . Akkoyunlu E . The enumeration of maximal cliques of large graphs . SIAM Journal on Computing , 1973 , 2 : 1 – 6 16 . Nesetril J , Poljak S . On the complexity of the subgraph problem . Commentationes Mathematicae Universitatis Carolinae , 1985 , 26 : 415 – 419 17 . Dyer M , Frieze A , Jerrum M . Approximately counting Hamilton cy - cles in dense graphs . In : Proceedings of the 5th Annual ACM / SIAM Symposium on Discrete Algorithms , 1994 , 336 – 343 18 . Frieze A , Kannan R . Quick approximation to matrices and applica - tions . Combinatorica , 1999 , 19 ( 2 ) : 175 – 220 19 . Jerrum M . Counting , Sampling and Integrating : Algorithms and Complexity . Birkhauser Verlag , 2003 20 . Itzhack R , Mogilevski Y , Louzoun Y . An optimal algorithm for counting network motifs . Physica A , 2007 , 381 : 482 – 490 21 . Wernicke S , Rasche F . FANMOD : a tool for fast network motif de - tection . Bioinformatics , 2006 , 22 ( 9 ) : 1152 – 1153
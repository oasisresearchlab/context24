Biometrilca ( 1083 ) , 70 , 1 , pp . 41 - 55 41 Printed in Ortat Britain The central role of the propensity score in observational studies for causal effects BY PAUL R . ROSENBAUM Departments of Statistics and Human Oncology , University of Wisconsin , Madison , Wisconsin , U . S . A . AND DONALD B . RUBIN University of Chicago , Chicago , Illinois , U . S . A . SUMMARY The propensity score is the conditional probability of assignment to a particular treatment given a vector of observed covariates . Both large and small sample theory show that adjustment for the scalar propensity score is sufficient to remove bias due to all observed covariates . Applications include : ( i ) matched sampling on the univariate propensity score , which is a generalization of discriminant matching , ( ii ) multivariate adjustment by subclassification on the propensity score where the same subclasses are used to estimate treatment effects for all outcome variables and in all subpopulations , and ( iii ) visual representation of multivariate covariance adjustment by a two - dimensional plot . Same hey words : Covariance adjustment ; Direct adjustment ; Discriminant matching ; Matched sampling ; Xonrandomized study ; Standardization ; Stratification ; Subclassification . 1 . DEFINITIONS 1 - 1 . The structure of studies for causal effects Inferences about the effects of treatments involve speculations about the effect one treatment would have had on a unit which , in fact , received some other treatment . We consider the case of two treatments , numbered 1 and 0 . In principle , the ith of the N units under study has both a response r u that would have resulted if it had received treatment 1 , and a response r 0l that would have resulted if it had received treatment 0 . In this formulation , causal effects are comparisons of r u and r Oi , for example r u — r 0l or r iil r oi - Since each unit receives only one treatment , either r u or r 0l is observed , but not both , so comparisons of r u and r Oi imply some degree of speculation . In a sense , estimating the causal effects of treatments is a missing data problem , since either r u or r 0 ( is missing . This formulation is that used in the literature of experimental design , for example , in the books by Fisher ( 1951 ) and Kempthorne ( 1952 ) , and follows the development by Rubin ( 1974 , 1977 , 1978 , 1980a ) ; Hamilton ( 1979 ) adopts a similar approach . The structure would not be adequate when , for example , the response of unit i to treatment / depends on the treatment given to unit j , as could happen if they compete for resources . The assumption that there is a unique value r ti corresponding to unit i and treatment t has been called the stable unit - treatment value assumption ( Rubin , 1980a ) , and will be D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 42 P . R . ROSENBAUM . AND D . B . RUBIN made here . For discussion of some possible violations of this assumption , see Cox ( 1958 , Chapter 2 ) or Rubin ( 1978 , § 23 ) . In this paper , the N units in the study are viewed as a simple random sample from some population , and the quantity to be estimated is the average treatment effect , defined as E ( ri ) - E ( r 0 ) , ( 1 - 1 ) where E { . ) denotes expectation in the population . Let 2 , = 1 if unit i is assigned to the experimental treatment , and z , = 0 if unit i is assigned to the control treatment . Let x t be a vector of observed pretreatment measurements or covariates for the ith unit ; all of the measurements in x are made prior to treatment assignment , but £ may not include all covariates used to make treatment assignments . It is assumed that the numbering of units is done at random , so that the index i contains no information ; observed information about unit i is contained in x , . Throughout , we ignore measure theoretic details . 1 - 2 . Balancing scores and the propensity score In randomized experiments , the results in the two treatment groups may often be directly compared because their units are likely to be similar , whereas in nonrandomized experiments , such direct comparisons may be misleading because the units exposed to one treatment generally differ systematically from the units exposed to the other treatment . Balancing scores , defined here , can be used to group treated and control units so that direct comparisons are more meaningful . A balancing score , b ( x ) , is a function of the observed covariates x such that the conditional distribution of x given b ( x ) is the same for treated ( z = 1 ) and control ( z = 0 ) units ; that is , in Dawid ' s ( 1979 ) notation , x _ Lz \ b ( x ) . The most trivial balancing score is b ( x ) = x . More interesting balancing scores are many - one functions of x . In § 2 we identify all functions of x that are balancing scores and identify the coarsest function of a ; that is a balancing score , namely the propensity score . We also show that easily obtained estimates of balancing scores behave like balancing scores . Also , we show that if treatment assignment is strongly ignorable given x , as defined in § 13 , then the difference between treatment and control means at each value of a balancing score is an unbiased estimate of the treatment effect at that value , and consequently pair matching , subclassification and covariance adjustment on a balancing score can produce unbiased estimates of the average treatment effect ( 11 ) . Moreover in § 3 we see that common methods of multivariate adjustment in observational studies , including covariance adjustment for x and discriminant matching ( Cochran & Rubin , 1973 ) , implicitly adjust for an estimated scalar balancing score . In order to motivate formally adjustment for a balancing score , we must consider the sampling distribution of treatment assignments . Let the conditional probability of assignment to treatment one , given the covariates , be denoted by e ( x ) = pr ( z = \ \ x ) , ( 1 - 2 ) where we assume V r ( z 1 , . . . , z n \ x 1 , . . . , x n ) = f [ e t a r O - e f o ) } 1 - " . D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 43 Although this strict independence assumption is not essential , it simplifies notation and discussion . The function e ( x ) is called the propensity score , that is , the propensity towards exposure to treatment 1 given the observed covariates x . Tn § 2 , e ( x ) is shown to be the coarsest balancing score . 1 - 3 . Strongly ignorable treatment assignment Randomized and nonrandomized trials differ in two distinct ways because in randomized experiments 2 , has a distribution determined by a specified random mechanism . First , in a randomized trial , the propensity score is a known function so that there exists one accepted specification for e ( x ) . In a nonrandomized experiment , the propensity score function is almost always unknown so that there is not one accepted specification for e ( x ) ; however , e ( x ) may be estimated from observed data , perhaps using a model such as a logit model . To a Bayesian , estimates of these probabilities are posterior predictive probabilities of assignment to treatment 1 for a unit with vector x of covariates . The second way randomized trials differ from nonrandomized trials is that , with properly collected data in a randomized trial , x is known to include all covariates that are both used to assign treatments and possibly related to the response ( r 1 , r 0 ) . More formally , in a randomized trial , treatment assignment z and response ( r lt r 0 ) are known to be conditionally independent given x , ( r u r 0 ) JLz \ x . This condition is usually not known to hold in a nonrandomized experiment . Moreover , in a randomized experiment , every unit in the population has a chance of receiving each treatment . Generally , we shall say treatment assignment is strongly ignorable given a vector of covariates v if ( r u r Q ) 1 z \ v , 0 < p r ( 2 = 11v ) < 1 ( 1 - 3 ) for all v . For brevity , when treatment assignment is strongly ignorable given the observed covariates x , that is , when ( 1 - 3 ) holds with v = x , we shall say simply that treatment assignment is strongly ignorable . If treatment assignment is strongly ignorable , then it is ignorable in Rubin ' s ( 1978 ) sense , but the converse is not true . 2 . THEORY 2 - 1 . Outline ( Section 2 presents five theorems whose conclusions may be summarized as follows , ( i ) The propensity score is a balancing score , ( ii ) Any score that is ' finer ' than the propensity score is a balancing score ; moreover , x is the finest balancing score and the propensity score is the coarsest , ( iii ) Tf treatment assignment is strongly ignorable given x , then it is strongly ignorable given any balancing score , ( iv ) At any value of a balancing score , the difference between the treatment and control means is an unbiased estimate of the average treatment effect at that value of the balancing score if treatment assignment is strongly ignorable . Consequently , with strongly ignorable treatment assignment , pair matching on a D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t o n 21 J anua r y 2019 44 P . R . ROSENBAUM AND D . B . RUBIN balancing score , subclassification on a balancing score and covariance adjustment on a balancing score can all produce unbiased estimates of treatment effects , ( v ) Using sample estimates of balancing scores can produce sample balance on x . 2 - 2 . Large - sample theory The results in this section treat e ( x ) as known , and are therefore applicable to large samples . THEOREM 1 . Treatment assignment and the observed covariates are conditionally inde - pendent given the propensity score , that is x JL z \ e ( x ) . The above theorem is a special case of Theorem 2 . Cochran & Rubin ( 1973 ) proved Theorem 1 in the particular case of multivariate normal covariates x \ the result holds regardless of the distribution of x . THEOREM 2 . Let b ( x ) be a function of x . Then b ( x ) is a balancing score , that is , x _ Lz \ b ( x ) , ( 2 - 1 ) if and only if b ( x ) is finer than e ( x ) in the sense that e ( x ) = f { b ( x ) } for some function f . Proof . First suppose b ( x ) is finer than e ( x ) . Since e ( x ) = pr ( z = 1 \ x ) , to show b ( x ) is a balancing score it is sufficient to show { } ( 2 - 2 ) Now by the definition of e ( x ) , But since b ( x ) is finer than e ( x ) , E { e ( x ) \ b ( x ) } = e ( x ) , as required , so that b ( x ) is a balancing score . Now , for the converse , suppose b ( x ) is a balancing score , but that b ( x ) is not finer than e ( x ) , so that there exists x 1 and x 2 such that e { x x ) = ¥e ( x 2 ) but 6 ( xj ) = b ( x 2 ) . But then , by the definition of e ( . ) , pr ( z = 1 | x ! ) 4 = pr ( z = 1 \ x 2 ) , so that z and x are not conditionally independent given b ( x ) , and thus b ( x ) is not a balancing score . Therefore , to be a balancing score , b ( x ) must be finer than e ( x ) . Theorem 1 implies that if a subclass of units or a matched treatment - control pair is homogeneous in e ( x ) , then the treated and control units in that subclass or matched pair will have the same distribution of x . Theorem 2 implies that if subclasses or matched treated - control pairs are homogeneous in both e ( x ) and certain chosen components of x , it is still reasonable to expect balance on the other components of a ; within these refined subclasses or matched pairs . The practical importance of Theorem 2 beyond Theorem 1 arises because it is sometimes advantageous to subclassify or match not only for e ( x ) but for other functions of x as well ; in particular , such a refined procedure may be used to obtain estimates of the average treatment effect in subpopulations defined by compo - nents of x , for example males , females . Theorem 3 is the key result for showing that if treatment assignment is strongly D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t o n 21 J anua r y 2019 Propensity score in observational studies 45 ignorable , then adjustment for a balancing score b ( x ) is sufficient to produce unbiased estimates of the average treatment effect ( 11 ) . THEOREM 3 . / / treatment assignment is strongly ignorable given x , then it is strongly ignorable given any balancing score b ( x ) ; that is , ( r u r 0 ) JLz \ x and 0 < pr ( z = 11 x ) < 1 for all x imply ( r , , r Q ) JLz \ b { x ) and 0 < p r { z = l \ b ( x ) } < 1 for all b ( x ) . Proof . The inequality given b ( x ) follows immediately from the inequality given x . Consequently , it is sufficent to show that pr { z = 1 | r 1 ; r 0 , b ( x ) } = pr { z = l \ b ( x ) } , which by Theorem 2 , equation ( 2 - 2 ) , is equivalent to showing that pr { z = 11 r t , r 0 , b ( x ) } = e ( x ) . Now p r { z = l \ r lt r o , b ( x ) } = # { p r ( z = I K , r 0 , x ) \ r lt r 0 , b ( x ) } , which by assumption equals ^ J { pr ( z = 1 \ x ) | r l , r 0 , b ( x ) } , which by definition equals E { e ( x ) | r l , r 0 , b ( x ) } , which , since b ( x ) is finer than e ( x ) , equals e ( x ) as required . Theorem 3 also can be proved using Lemmas 4 . 2 ( i ) and 4 . 3 of Dawid ( 1979 ) . We are now ready to relate balancing scores and ignorable treatment assignment to the estimation of treatment effects . The response r , to treatment t is observed only if the unit receives treatment t , that is if z = t . Thus , if a randomly selected treated unit , z = 1 , is compared to a randomly selected control unit , z = 0 , the expected difference in response is E ( ri \ z = l ) - E ( r o \ z = 0 ) . ( 2 - 3 ) Expression ( 2 - 3 ) does not equal ( 11 ) in general because the available samples are not from the marginal distribution of r , , but rather from the conditional distribution of r , given z = t . Suppose a specific value of the vector of covariates x is randomly sampled from the entire population of units , that is , both treated and control units together , and then a treated unit and a control unit are found both having this value for the vector of covariates . In this two - step sampling process , the expected difference in response is E x { E { r , \ x , z = \ ) - E ( r o \ x ' , z = 0 ) } , ( 2 - 4 ) where E x denotes expectation with respect to the distribution of x in the entire population of units . If treatment assignment is strongly ignorable , that is if ( 13 ) holds with v = x , then ( 2 - 4 ) equals E x { E ( ri \ x ) - E ( r 0 \ x ) } , which does equal the average treatment effect ( 11 ) . D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 46 P . R . ROSENBAUM AND D . B . RUBIN Now suppose a value of a balancing score b ( x ) is sampled from the entire population of units and then a treated unit and a control unit are sampled from all units having this value of b ( x ) , but perhaps different values of x . Given strongly ignorable treatment assignment , it follows from Theorem 3 that E { r , I b ( x ) , z = 1 } - E { r 0 | b ( x ) , z = 0 } = E { r , \ b ( x ) } - E { r 0 \ b ( x ) } from which it follows that E bw [ E { r x | b ( x ) , z = 1 } - E { r o | b ( x ) , z = 0 } ] = E Hx ) [ E { r , \ b ( x ) } —E { r 0 \ b ( x ) } ) = E ( r x - r 0 ) , ( 2 - 5 ) where E ^ denotes expectation with respect to the distribution of b ( x ) in the entire population . In words , under strongly ignorable treatment assignment , units with the same value of the balancing score b ( x ) but different treatments can act as controls for each other , in the sense that the expected difference in their responses equals the average treatment effect . The above argument has established the following theorem and corollaries . THEOREM 4 . Suppose treatment assignment is strongly ignorable and b ( x ) is a balancing score . Then the expected difference in observed responses to the tivo treatments at b ( x ) is equal to the average treatment effect at b ( x ) , that is , E { r 1 \ b ( x ) , z = l } - E { r o \ b ( x ) , z = 0 } = E { r 1 - r o \ b ( x ) } . COROLLARY 4 - 1 . Pair matching on balancing scores . Suppose treatment assignment is strongly ignorable . Further suppose that a value of a balancing score b ( x ) is randomly sampled from the population of units , and then one treated , z = 1 , unit and one control , z = 0 , unit are sampled with this value of b { x ) . Then the expected difference in response to the two treatments for the units in the matched pair equals the average treatment effect at b ( x ) . Moreover , the mean of matched pair differences obtained by this Iwo - step sampling process is unbiased for the average treatment effect ( I ' l ) . COROLLARY 4 - 2 . Subclassification on balancing scores . Suppose treatment assignment is strongly ignorable . Suppose further that a group of units is sampled using b ( x ) such that : ( i ) b ( x ) is constant for all units in the group , and ( ii ) at least one unit in the group received each treatment . Then , for these units , the expected difference in treatment means equals the average treatment effect at that value ofb ( x ) . Moreover , the weighted average of such differences , that is , the directly adjusted difference , is unbiased for the treatment effect ( M ) , when the weights equal the fraction of the population at b ( x ) . COROLLARY 4 - 3 . Covarianceadjustment on balancing scores . Suppose treatment assignment is strongly ignorable , so that in particular , E { r t \ z = I , b ( x ) } = E { r t \ b ( x ) } for balancing score b ( x ) . Further suppose that the conditional expectation of r , given b ( x ) is linear : E { r , \ z = t , b ( x ) } = < x , + P , b ( x ) ( t = 0 , 1 ) . Then the estimator is conditionally unbiased given b { x t ) ( i = l , . . . , n ) for the treatment effect at b { x ) , namely D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 47 E { r 1 — r 0 1 b ( x ) } , if a , and / ? , are conditionally unbiased estimators of a , and / ? „ such as least squares estimators . Moreover , where E = n ' 1 T , b ( Xj ) , is unbiased for the average treatment effect ( 1 - 1 ) if the units in the study are a simple random sample from the population . 2 - 3 . Some small - sample theory Usually the propensity scores e ( x t ) must be estimated from available data , ( z h x i ) ( i = \ , . . . , N ) . Define the sample conditional proportion prop ( vl | B ) as the pro - portion of those vectors ( z ( , x t ) satisfying condition B that also satisfy condition A , leaving prop ( A | B ) undefined if no vector satisfies condition B . For example , prop { z = 11 x = ( 1 , 0 ) } is the proportion of the N units with z = 1 among all units with x = ( 1 , 0 ) . Estimate e ( x ) by e ( a ) = prop ( z = 1 \ x = a ) . If e ( o ) = 0 or 1 then all units with x = a received the same treatment . Theorem 5 , which parallels Theorem 1 , shows that at all intermediate values of e ( a ) , that is for 0 < e ( a ) < 1 , there is sample balance . Of course , intermediate values of e ( x ) will exist only when x takes on relatively few values . THEOREM 5 . Suppose 0 < e ( a ) < 1 . Then prop { z = 0 , x = a \ e ( x ) = e ( a ) } = prop { z = 0 | e ( z ) = e ( x ) } prop { a ; = a \ e ( z ) = e ( a ) } . ( 2 - 6 ) An analogous theorem about sample balance parallels Theorem 2 , and the proofs parallel the corresponding proofs of Theorems 1 and 2 because proportions follow essentially the same axioms as probabilities . COROLLARY 5 - 1 . Suppose the N units are a random sample from an infinite population , and suppose x takes on only finitely many values in the population and at each such value 0 < e ( x ) < 1 . Then with probability 1 as N - * oo , subclassification on e ( x ) produces sample balance , that is , ( 2 - 6 ) holds . In practice , except when x takes on only a few values , e ( a ) will be either zero or one for most values of a . Consequently , in order to estimate propensity scores , some modelling will be required . The propensity score can often be modelled using an appropriate logit model ( Cox , 1970 ) or discriminant score . Clearly , pr ( 2 = l ) pr ( * | z = l ) " e ( x ) = pr ( z = 11 x ) = pr ( z = l ) pr ( z | z = l ) + pr ( z = 0 ) pr ( x | z = Elementary manipulations establish the following facts . ( i ) Tf pr ( x | z = t ) = N p ( fi t , Cl ) then e ( x ) is a monotone function of the linear discrimi - nant x T Q - 1 ( / * ! — n 2 ) . Therefore , matching on e ( x ) includes discriminant matching ( Cochran & Rubin , 1973 ; Rubin 1976a , b ; 1979 ; 1980b ) as a special case . Some related results appear in § 3 - 2 . ( ii ) If pr ( x | z = t ) is a polynomial exponential family distribution , i . e . if \ z = t ) = h ( x ) exp { P , ( x ) } , D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 48 P . R . ROSENBAUM AND D . B . RUBIN where P , ( x ) is a polynomial in x of degree k , say , then e ( x ) obeys a polynomial logit model where Q ( x ) is a degree k polynomial in x . This polynomial exponential family includes the linear exponential family resulting in a linear logit model for e ( x ) , the quadratic exponential family described by Dempster ( 1971 ) , and the binary data model described by Cox ( 1972 ) . Related discussion is given by Dawid ( 1976 ) . 3 . THREE APPLICATIONS OF PROPENSITY SCORES TO OBSERVATIONAL STUDIES 3 - 1 . Techniques for adjustment in observational studies The general results we have presented suggest that , in practice , adjustment for the propensity score should be an important component of the analysis of observational studies because evidence of residual bias in the propensity score is evidence of potential bias in estimated treatment effects . We conclude with three examples of how propensity scores can be explicitly used to adjust for confounding variables in observational studies . The examples involve three standard techniques for adjustment in observational studies ( Cochran , 1965 ; Rubin , 1983 ) , namely , matched sampling , subclassification , and covariance adjustment , that is , the three methods addressed by Corollaries 4 - 1 , 4 - 2 and 4 - 3 . 32 . Use of propensity scores to construct matched samples from treatment groups Matching is a method of sampling from a large reservoir of potential controls to produce a control group of modest size in which the distribution of covariates is similar to the distribution in the treated group . Some sampling of a large control reservoir is often required to reduce costs associated with measuring the response , for example , costs associated with obtaining extensive follow - up data on patients in clinical studies ( Rubin , 1973a ; Cohn et al . , 1981 ) . Although there exist model - based alternatives to matched sampling , e . g . covariance adjustment on random samples , there are several reasons why matching is appealing . ( I ) Matched treated and control pairs allow relatively unsophisticated researchers to appreciate immediately the equivalence of treatment and control groups , and to perform simple matched pair analyses which adjust for confounding variables . This issue is discussed in greater detail below in § 33 on balanced subclassification . ( II ) Even if the model underlying a statistical adjustment is correct , the variance of the estimate of the average treatment effect ( 1 - 1 ) will be lower in matched samples than in random samples since the distributions of x in treated and control groups are more similar in matched than in random samples . To verify this reduced variance , inspect the formula for the variance of the covariance adjusted estimate ( Snedecor & Cochran , 1980 , p . 368 , formula 18 . 2 . 3 ) , and note that the variance decreases as the difference between treatment and control means on x decreases . ( III ) Model - based adjustment on matched samples is usually more robust to D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 49 departures from the assumed form of the underlying model than model - based adjust - ment on random samples ( Rubin , 1973b , 1979 ) , primarily because of reduced reliance on the model ' s extrapolations . ( IV ) In studies with limited resources but large control reservoirs and many confounding variables , the confounding variables can often be controlled by multi - variate matching , but the small - sample sizes in the final groups do not allow control of all variables by model - based methods . Ideally , treated and control units would be exactly matched on all covariates x , so that the sample distributions of x in the two groups would be identical . Theorem 2 shows that it is sufficient to match exactly on any balancing score b ( x ) to obtain the same probability distributions of a ; for treated and control units in matched samples . Moreover , Corollary 4 - 1 shows that if treatment assignment is strongly ignorable , exact matching on a balancing score leads to an unbiased estimate of the average treatment effect . Unfortunately , exact matches even on a scalar balancing score are often impossible to obtain , so methods which seek approximate matches must be used . We now study properties of some matching methods based on the propensity score . A multivariate matching method is said to be equal per cent bias reducing if the bias in each coordinate of x is reduced by the same percentage ( Rubin , 1976a , b ) . Matching methods which are not equal per cent bias reducing have the potentially undesirable property that they increase the bias for some linear functions of x . If matched sampling is performed before the response ( r lt r 0 ) can be measured , and if all that is suspected about the relation between ( r 1 , r 0 ) and x is that it is approximately linear , then matching methods which are equal per cent bias reducing are reasonable in that they lead to differences in mean response in matched samples that should be less biased than in random samples . The initial bias in x is B = E ( x \ z = \ ) - E ( x \ z = 0 ) . ( 3 - 1 ) Let us suppose that we have a random sample of treated units and a large reservoir of randomly sampled control units , and suppose each treated unit is matched with a control unit from the reservoir . Then the expected bias in x in matched samples is B n = E ( x \ z = l ) - E m ( x \ z = O ) , ( 3 - 2 ) where the subscript m indicates the distribution in matched samples . In general , from Theorem 2 , B m is a null vector if exact matches on a balancing score have been obtained . If B m = yB for some scalar y , with 0 < y < 1 , then the matching method is equal per cent bias reducing : the bias in each coordinate of a ; is reduced by 100 ( 1 — y ) % . If the method is not equal per cent bias reducing , then there exists a vector w such that wB m > wB , so that matching has increased the bias for some linear function of x . In § 2 - 3 we observed that discriminant matching is equivalent to matching on the propensity score if the covariates x have a multivariate normal distribution . Assuming multivariate normality , Rubin ( 1976a ) showed that matching on the population or sample discriminant is equal per cent bias reducing . We now show that matching on the population propensity score is equal per cent bias reducing under weaker distributional assumptions . It is assumed that the matching algorithm matches each treated , 2 = 1 , unit with a control , z = 0 , unit drawn from a reservoir of control units on the basis of a balancing score , for example , using nearest available matching on a scalar balancing score . D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 50 P . R . ROSENBAUM AND D . B . RUBIN THEOREM 6 . Let b = b ( x ) be a balancing score . For any matching method that uses b alone to match each treated unit , z = 1 , with a control unit , z = 0 , the reduction in bias is B - B m = J E ( x \ b ) { pr M ( 6 | 2 = 0 ) - pr ( 6 | z = 0 ) } db , ( 3 - 3 ) ivhere pr m ( b \ z = 0 ) denotes the distribution of b in matched samples from the control group . Proof . From ( 31 ) and ( 32 ) we have ( b \ z = O ) - E ( x \ z = O , b ) pr ( b \ z = O ) } db . ( 3 - 4 ) For any matching method satisfying the condition of the theorem , E m ( x \ z = 0 , b ) = E ( x \ z = 0 , b ) ( 3 - 5 ) because any matching method using b alone to match units alters the marginal distribution of b in the control group , 2 = 0 , but does not alter the conditional distribution of x given b in the control group . However , by Theorem 2 , E ( x \ z = 0 , b ) = E ( x \ b ) . ( 3 - 6 ) Substitution of ( 35 ) and ( 36 ) into equation ( 34 ) yields the result ( 33 ) . COROLLARY 6 - 1 . If E ( x \ b ) = < x + fif ( b ) for some vectors a . and p and some scalar - valued function f ( . ) , then matching on b alone is equal per cent bias reducing . Proof . The per cent reduction in bias for the zth coordinate of x is , from ( 33 ) which is independent of i , as required . The following corollary shows that if subpopulations are defined using x so that some function d ( x ) is constant within each subpopulation , then propensity matching within subpopulations is equal per cent bias reducing in each subpopulation . COROLLARY 6 - 2 . Let d = d ( x ) be some function of x . If E ( x \ b , d ) = < x d + fi d f d ( b ) for vectors ix d , fi d , and some scalar - valued functions f d ( . ) , then matching on b alone at each value of d is equal per cent bias reducing at each value of d , thai is , E ( x \ d , z = l ) - E m ( x \ d , z = 0 ) = y d { E ( x \ d , z = \ ) - E ( x \ d , z = 0 ) } for scalar y d . Proof . Apply Theorem 6 and Corollary 61 within subpopulations . Rubin ' s ( 1979 ) simulation study examines the small - sample properties of discriminant matching in the case of normal covariates with possibly different covariances in the treatment groups . Thus , the study includes situations where the true propensity score is a quadratic function of x but the discriminant score is a linear function of x . Table 1 presents previously unpublished results from this study for situations in which the propensity score is a monotone function of the linear discriminant , so that propensity matching and discriminant matching are effectively the same . The covariates x are D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 51 Table 1 . Per cent reduction in bias due to matched sampling based on the sample and population propensity scores Ratio of size control reservoir to size of treatment group 2 3 4 Type of score SamplePopulation SamplePopulation SamplePopulation Initial bias along standardized O25 9292 10196 9798 0 - 50 8587 9695 9897 discriminant0 - 75 7778 9191 9594 100 6769 8384 9089 Assuming bivariate normal covariates with common covariance matrix , parallel linear response surfaces , sample size of 50 in treated and control groups . Estimated per cent reduction in bias from Rubin ' s ( 1979 ) simulation study . The largest estimated standard error for this table is less than 003 . bivariate normal with common covariance matrix . In the simulation , 50 treated units are matched using nearest available matching ( Cochran & Rubin , 1973 ) on the sample discriminant with 50 control units drawn from a reservoir of 50R potential control units , for R = 2 , 3 , 4 ; details are given by Rubin ( 1979 ) . Assuming parallel linear response surfaces , Table 1 shows that even in the absence of additional adjustments , propensity , i . e . discriminant , matching alone can remove most of the initial bias if the reservoir is relatively large . Moreover , Table 1 shows that the population and sample propensity scores are approximately equally effective in remov - ing bias , so that no substantial loss is incurred by having to estimate the propensity score . It should be noted that the conditions underlying Table 1 differ from the conditions underlying Theorem 1 because nearest available matching with imperfect matches provides only a partial adjustment for the propensity score . Propensity matching should prove especially effective relative to Mahalanobis metric matching ( Cochran & Rubin , 1973 ; Rubin , 1976a , b ; 1979 ; 1980b ) in situations where markedly nonspherically distributed x make the use of a quadratic metric unnatural as a measure of distance between treated and control units . For example , we have found in practice that if x contains one coordinate representing a rare binary event , then Mahalanobis metric matching may try too hard to match that coordinate exactly , thereby reducing the quality of matches on the other coordinates of x . Propensity matching can effectively balance rare binary variables for which it is not possible to match treated and control units adequately on an individual basis . 3 - 3 . Subclas8ification on propensity scores A second major method of adjustment for confounding variables is subclassification , whereby experimental and control units are divided on the basis of x into subclasses or strata ( Cochran , 1965 , 1968 ; Cochran & Rubin , 1973 ) . Direct adjustment with subclass total weights can be applied to the subclass differences in response to estimate the average treatment effect ( 11 ) whenever treatment assignment is strongly ignorable , without modelling assumptions such as parallel linear response surfaces ; see Corollary 4 - 2 . As a method of multivariate adjustment , subclassification has the advantage that it involves direct comparisons of ostensibly comparable groups of units within each D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 52 P . R . ROSEXBAUM AXD D . B . RUBIN subclass and therefore can be both understandable and persuasive to an audience with limited statistical training . The comparability of units within subclasses can be verified by the simplest methods , such as bar charts of means . A major problem with subclassification ( Cochran , 1965 ) is that as the number of confounding variables increases , the number of subclasses grows dramatically , so that even with only two categories per variable , yielding 2 P subclasses for P variables , most subclasses will not contain both treated and control units . Subclassification on the propensity score is a natural way to avoid this problem . We now use an estimate of the propensity score to subclassify patients in an actual observational study of therapies forcoronary artery disease . The treatments are coronary artery bypass surgery , z = 1 , and drug therapy , 2 = 0 . The covariates x are clinical , haemodynamic , and demographic measurements on each patient made prior to treat - ment assignment . Even though the covariates have quite different distributions in the two treatment groups , within each of the five subclasses , the surgical and drug patients will be seen to have similar sample distributions of x . The propensity score was estimated using a logit model for z given x . Covariates and interactions among covariates were selected for the model using a stepwise procedure . Based on Cochran ' s ( 1968 ) observation that subclassification with five subclasses is sufficient to remove at least 90 % of the bias for many continuous distributions , five subclasses of equal size were constructed at the quintiles of the sample distribution of the propensity score , each containing 303 patients . Beginning with the subclass with the highest propensity scores , the five subclasses contained 234 surgical patients , 164 surgical patients , 98 surgical patients , 68 surgical patients and 26 surgical patients , repectively . For each of the 74 covariates , Table 2 summarizes the balance before and after sublassification . The first row describes the 74 F statistics , that is the squares of the usual Table 2 . Example of increased balance using subclassification on estimated propensity score as summarized by distributions of F statistics for 74 covariates Treatment main effect without subclassification Treatment main effect with subclassification Treatment by subclass interaction Minimum 4 - 0 00 00 Lowerquartile 6 - 8 0 - 1 0 - 4 Median 10 - 9 0 - 2 0 - 8 Lpperquartile 16 - 8 0 - 6 1 - 2 Maximum 51 - 8 3 - 6 2 - 9 two - sample / statistics , for comparing the surgical group and drug group means of each covariate prior to subclassification . The second and third rows describe F statistics for the main effect of treatment and for interaction in a 2 x 5 , treatments by subclasses , analysis of variance , performed for each covariate . Although there is considerable imbalance prior to subclassification , within the constructed subclasses there is greater balance than would have been expected if treatments had been assigned at random within each subclass . When subclasses are perfectly homogeneous in b ( x ) , Theorem 2 shows that x has the same distribution for treated , 2 = 1 , and control , 2 = 0 , units in each subclass . Moreover , by Corollary 4 - 2 , if treatment assignment is strongly ignorable , then the directly adjusted estimate with population total weights is unbiased for the average treatment D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 53 effect ( 11 ) . However , in this example , and generally in practice , subclasses will not be exactly homogeneous in the balancing score b ( x ) that was used in subclassification , so the directly adjusted estimate may contain some residual bias due to x . The corollary to the following theorem shows that direct adjustment based on a balancing score b = b ( x ) can be expected to reduce bias in each coordinate of a ; providing the adjustment reduces the bias in b . Let I s be the set of values of a balancing score which make up subclass 8 ( s = 1 , . . . , S ) , so that b ( a ) e I s implies that units with x = a fall in subclass 8 . Suppose the weight applied to subclass s in direct adjustment is w s . THEOREM 7 . The bias in x after direct adjustment for the subclasses ( I , , s = 1 , . . . , £ ) is B , = t w , $ E ( x \ b ) { vr ( b \ z = l , b eI , ) 1 = 1 where b = b ( x ) . COROLLARY 7 - 1 . If E ( x \ b ) = tx + fif ( b ) for some vectors a and / ? and some scalar valued function / ( . ) ofb , and if the subclasses are formed using b , then the subclassification is equal per cent bias reducing in the sense that the per cent of bias in x remaining after adjustment is the same for each coordinate of x , namely , 100 y , where = 1 , 6 g 7 , ) - pr ( 6 | z = 0 , 6 e 7 $ f ( b ) { pr ( b \ z = l ) - pr ( b \ z = O ) } db . where the sum is over s = 1 , . . . , S . Proof . Apply Theorem 7 and follow the argument of Corollary 6 - 1 . In parallel with Corollary 62 direct adjustment based on a balancing score within subpopulations defined by x can be shown to be equal per cent bias reducing within those subpopulations . Subclassification on the propensity score is not the same as any of the several methods proposed by Miettinen ( 1976 ) : the propensity score is not generally a ' confounder ' score . For example , one of Miettinen ' s confounder scores is pr ( z = l \ r z = l , z ) 4 = pr ( 2 = l | x ) = e ( x ) . Moreover , under strong ignorability , e ( x ) = p r ( z = l \ x ) = p r ( z = l \ r u r 0 , x ) ± p r ( z = 1 \ r 2 = \ , x ) , so strong ignorability does not convert a confounder score into the propensity score . 3 - 4 . Propensity scores and covariance adjustment The third standard method of adjustment in observational studies is covariance adjustment . The point estimate of the treatment effect obtained from ah analysis of covariance adjustment for multivariate x is , in fact , equal to the estimate obtained from D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t o n 21 J anua r y 2019 54 P . R . ROSEXBAUM AND D . B . RUBIN univariate covariance adjustment for the sample linear discriminant based on x , whenever the same sample covariance matrix is used for both the covariance adjustment and the discriminant analysis . This fact is most easily demonstrated by linearly transforming x to the sample discriminant and components orthogonal to the sample discriminant which by construction have the same sample mean in both groups . Since covariance adjustment is effectively adjustment for the linear discriminant , plots of the responses r u and r 0l or residuals r ki — r kh where f ki is the value of r ki predicted from the regression model used in the covariance adjustment , versus the linear discriminant are useful in identifying nonlinear or nonparallel response surfaces , as well as extrapolations , which might distort the estimate of the average treament effect . Furthermore , such a plot is a bivariate display of multivariate adjustment , and as such might be useful for general presentation . Generally , plots of responses and residuals from covariance analysis against the propensity score e ( x ) are more appropriate than against the discriminant , unless of course the covariates are multivariate normal with common covariance matrix in which case the propensity score is a monotone function of the discriminant . The reason is that , by Corollary 4 - 3 , if treatment assignment is strongly ignorable , then at each e ( x ) the expected difference in response E { r l \ z = \ , e ( x ) } — E { r o \ z = 0 , e ( x ) } equals the average treatment effect at e ( x ) , namely E { r l \ e ( x ) } — E { r 0 \ e { x ) } . This property holds for the propensity score e ( x ) and for any balancing score b ( x ) , but does not generally hold for other functions of x ; generally , plots against other functions of x are still confounded by a ; . Cases where covariance adjustment has been seen to perform quite poorly are precisely those cases in which the linear discriminant is not a monotone function of the propensity score , so that covariance adjustment is implicitly adjusting for a poor approximation to the propensity score . In the case of univariate x , the linear discriminant is a linear function of x , whereas the propensity score may not be a monotone function of a ; if the variances of a ; in the treated and control groups are unequal . Intuitively , if the variance of x in the control group is much larger than the variance in the treated group , then individuals with the largest and smallest x values usually come from the control group . Rubin ( 1973b , Tables 4 and 6 , with r = 1 and x p as the estimator ) has shown that with nonlinear response surfaces , univariate covariance adjustment can either increase the bias or overcorrect for bias dramatically if the variances of x in the treated and control groups differ . Unequal variances of covariates are not uncommon in observational studies , since the subset of units which receives a new treatment is often more homogeneous than the general population . For example , in the observational half of the Salk vaccine trial , the parents of second graders who volunteered for vaccination had higher and therefore less variable educational achievement , x , than parents of control children who were parents of all first and third graders ( Meier , 1978 ) . Tn the case of multivariate normal x , Rubin ( 1979 , Table 2 ) has shown that covariance adjustment can seriously increase the expected squared bias if the covariance matrices in treated and control groups are unequal , that is , if the discriminant is not a monotone function of the propensity score . In contrast , when the covariance matrices are equal , so that the discriminant is a monotone function of the propensity score , covariance adjustment removes most of the expected squared bias in the cases considered by Rubin ( 1979 , Table 2 ) . In summary , covariance adjustment cannot be relied upon to perform well unless the linear discriminant is highly correlated with the propensity score . D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t on 21 J anua r y 2019 Propensity score in observational studies 55 The authors acknowledge valuable discussions with Arthur P . Dempster , A . Philip Dawid and Roderick J . A . Little on the subject of this paper . This work was partially supported by the U . S . Health Resources Administration , the U . S . Environmental Protection Agency , the Educational Testing Service , the U . S . Army Research Office , and the U . S . National Cancer Institute . REFERENCES COCHRAN , W . G . ( 1965 ) . The planning of observational studies of human populations ( with discussion ) . J . R . Statist . Soc . A 128 , 234 - 55 . COCHRAN , W . G . ( 1968 ) . The effectiveness of adjustment by subclassification in removing bias in observational studies . Biometrics 24 , 295 - 313 . COCHRAN , W . G . & RUBIN , D . B . ( 1973 ) . Controlling bias in observational studies : a review . Sankhyd A 35 , 417 46 . COHN . P . F . , HARRIS , P . , BABRY , W . , ROSATI , R . A . , ROSENBAUM , P . R . & WATERNAUX , C . ( 1981 ) . Prognostic importance of anginal symptoms in angiographically defined coronary arterv disease . Am . J . Cardiol . 47 , 233 - 7 . Cox . D . R . ( 1958 ) . The Planning of Experiments . New York : Wiley . Cox , D . R . ( 1970 ) . The Analysis of Binary Data . London : Methuen . Cox , D . R . ( 1972 ) . The analysis of multivariate binary data . Appl . Statist . 21 , 113 - 20 . DAWID , A . P . ( 1976 ) . Properties of diagnostic data distributions . Biometrics 32 , 647 - 58 . DAWID , A . P . ( 1979 ) . Conditional independence in statistical theory ( with discussion ) . J . R . Statist . Soc . B 41 , 1 - 31 . DEMPSTER , A . P . ( 1971 ) . An overview of multivariate data analysis . J . Mvil . Anal . 1 , 316 - 46 . FISHER , R . A . ( 1951 ) . The Design of Experiments . Edinburgh : Oliver & Boyd . HAMILTON , M . A . ( 1979 ) . Choosing a parameter for 2 x2 table or 2 x 2 x 2 table analysis . Am . J . Epidemiol . 109 , 362 - 75 . KEMPHORNE , O . ( 1952 ) . The Design and Analysis of Experiments . New York : Wiley . MEIER . P . ( 1978 ) . The biggest public health experiment ever : The 1954 trial of the Salk poliomyelitis vaccine . In Statistics : A Guide to the Unknoum , Ed . J . M . Tanur , el al . , pp . 3 - 15 . San Francisco : Holden Day . MIETTINEN , 0 . ( 1976 ) . Stratification by a multivariate confounder score . Am . J . Epidemiol . 104 , 609 - 20 . RUBIN , D . B . ( 1973a ) . Matching to remove bias in observational studies . Biometrics 29 . 159 - 83 . Correction ( 1974 ) 30 . 728 . RUBIN . D . B . ( 1973b ) . The use of matching and regression adjustment to remove bias in observational studies . Biometrics 29 , 185 - 203 . RUBIN . D . B . ( 1974 ) . Estimating causal effects of treatments in randomized and nonrandomized studies . J . Ed . Psychol . 66 , 688 701 . RUBIN . D . B . ( 1976a ) . Matching methods that are equal percent bias reducing : Some examples . Biometrics 32 . 109 20 . RUBIN . D . B . ( 1976b ) . Multivariate matching methods that are equal percent bias reducing : Maximums on bias reduction for fixed sample sizes . Biometrics 32 , 121 - 32 . RUBIN , D . B . ( 1977 ) . Assignment to treatment group on the basis of a covariate . J . Ed . Statist . 2 , 1 - 26 . RUBIN . I ) . B . ( 1978 ) . Bayesian inference for causal effects : The role of randomization . Ann . Statist . 6 , 34 58 . RUBIN . D . B . ( 1979 ) . Using multivariate matched sampling and regression adjustment to control bias in observational studies . J . Am . Statist . Assoc . 74 , 318 - 28 . RUBIN . D . B . ( 1980a ) . Discussion of paper by D . Basu . J . Am . Statist . Assoc . 75 , 591 3 . RUBIN . D . B . ( 1980b ) . Bias reduction using Mahalanobis metric matching . Biometrics 36 , 293 - 8 . RUBIN . D . B . ( 1983 ) . William G . Coehran ' s contributions to the design , analysis , and evaluation of observational studies . In Research Work of William O . Cochran , Eds . S . Rao and J . Sedransk . Xew York : Wiley . To appear . ISSKDKC ' OR . ( 4 . W . & COCHRAN , W . G . ( 1980 ) . Statistical Methods . Ames , Iowa : Iowa State University Press . [ Received March 1981 . Revised October 1982 ] D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o m e t / a r t i c l e - ab s t r a c t / 70 / 1 / 41 / 240879 b y gue s t o n 21 J anua r y 2019
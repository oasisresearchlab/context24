a r X i v : c ond - m a t / 0308217v1 [ c ond - m a t . s t a t - m ec h ] 11 A ug 2003 Finding and evaluating com m unity structure in netw orks M . E . J . Newm an 1 , 2 and M . G irvan 2 , 3 1 D epartm ent of Physics and Center for the Study of Com plex System s , University of M ichigan , Ann Arbor , M I 48109 { 1120 2 Santa Fe Institute , 1399 Hyde Park Road , Santa Fe , NM 87501 3 D epartm ent of Physics , CornellUniversity , Ithaca , NY 14853 { 2501 W e propose and study a set of algorithm s for discovering com m unity structure in networks | naturaldivisionsofnetwork nodesinto densely connected subgroups . O uralgorithm sallshare two de(cid:12)nitive features : (cid:12)rst , they involve iterative rem ovalofedges from the network to split it into com m unities , the edges rem oved being identi(cid:12)ed using one ofa num berofpossible \ betweenness " m easures , and second , thesem easuresare , crucially , recalculated aftereach rem oval . W ealsopropose a m easure forthe strength ofthe com m unity structure found by ouralgorithm s , which givesusan objective m etric for choosing the num berofcom m unities into which a network should be divided . W edem onstratethatouralgorithm sarehighly e(cid:11)ectiveatdiscovering com m unity structurein both com puter - generated and real - world network data , and show how they can be used to shed lighton the som etim esdauntingly com plex structure ofnetworked system s . I . IN T R O D U C T IO N Em piricalstudiesand theoreticalm odelingofnetworks havebeen thesubjectofalargebody ofrecentresearch in statisticalphysics and applied m athem atics [ 1 , 2 , 3 , 4 ] . Network ideas have been applied with great success to topics as diverse as the Internet and the world wide web [ 5 , 6 , 7 ] , epidem iology [ 8 , 9 , 10 , 11 ] , scienti(cid:12)c ci - tation and collaboration [ 12 , 13 ] , m etabolism [ 14 , 15 ] , and ecosystem s [ 16 , 17 ] , to nam e buta few . A property that seem s to be com m on to m any networks is com m u - nity structure , the division ofnetwork nodesinto groups within which the network connectionsaredense , butbe - tween which they are sparser | seeFig . 1 . The ability to (cid:12)nd and analyzesuch groupscan provideinvaluablehelp in understanding and visualizing the structure of net - works . In thispaperwe show how thiscan be achieved . The study ofcom m unity structure in networks has a long history . It is closely related to the ideas ofgraph partitioning in graph theory and com puter science , and FIG . 1 : A sm allnetwork with com m unity structure of the type considered in this paper . In this case there are three com m unities , denoted by thedashed circles , which havedense internallinksbutbetween which thereareonly alowerdensity ofexternallinks . hierarchicalclustering in sociology [ 18 , 19 ] . Before pre - senting our own (cid:12)ndings , it is worth reviewing som e of thispreceding work , to understand itsachievem entsand where itfallsshort . G raph partitioning isa problem thatarisesin , forex - am ple , parallel com puting . Suppose we have a num - ber n ofintercom m unicating com puter processes , which wewish todistributeoveranum ber g ofcom puterproces - sors . Processesdo not necessarily need to com m unicate with allothers , and the pattern ofrequired com m unica - tionscan be represented by a graph ornetwork in which the vertices represent processes and edges join process pairsthatneed to com m unicate . The problem isto allo - catetheprocessesto processorsin such a way asroughly to balance the load on each processor , while atthe sam e tim e m inim izing the num ber ofedges that run between processors , so thattheam ountofinterprocessorcom m u - nication ( which is norm ally slow ) is m inim ized . In gen - eral , (cid:12)nding an exact solution to a partitioning task of thiskind isbelieved tobean NP - com pleteproblem , m ak - ing itprohibitively di(cid:14)cultto solveforlargegraphs , but a wide variety ofheuristic algorithm s have been devel - oped thatgive acceptably good solutionsin m any cases , the best known being perhaps the K ernighan { Lin algo - rithm [ 20 ] , which runsin tim e O ( n 3 ) on sparse graphs . A solution to the graph partitioning problem is how - ever not particularly helpful for analyzing and under - standing networksin general . Ifwe m erely wantto (cid:12)nd if and how a given network breaks down into com m u - nities , we probably don’t know how m any such com - m unities there are going to be , and there is no reason why they should be roughly the sam esize . Furtherm ore , the num berofinter - com m unity edgesneedn’tbe strictly m inim ized either , since m ore such edges are adm issible between large com m unitiesthan between sm allones . Asfarasourgoalsin thispaperareconcerned , a m ore usefulapproach isthattaken by socialnetwork analysis with the setoftechniquesknown ashierarchicalcluster - ing . These techniques are aim ed at discovering natural divisionsof ( social ) networksinto groups , based on var - 2 FIG . 2 : A hierarchical tree or dendrogram illustrating the type ofoutput generated by the algorithm s described here . The circles at the bottom of the (cid:12)gure represent the indi - vidualvertices ofthe network . A s we m ove up the tree the verticesjoin togetherto form larger and larger com m unities , asindicated by thelines , untilwereach thetop , whereallare joined together in a single com m unity . A lternatively , we the dendrogram depicts an initially connected network splitting into sm aller and sm aller com m unities as we go from top to bottom . A cross - section ofthe tree atany level , asindicated by the dotted line , willgive the com m unities at that level . The verticalheight ofthe split - points in the tree are indica - tiveonly oftheorderin which thesplits ( orjoins ) took place , although it is possible to construct m ore elaborate dendro - gram sin which these heightscontain otherinform ation . ious m etrics ofsim ilarity or strength ofconnection be - tween vertices . They fallinto two broad classes , agglom - erative and divisive [ 19 ] , depending on whether they fo - cuson theaddition orrem ovalofedgestoorfrom thenet - work . In an agglom erative m ethod , sim ilarities are cal - culated by one m ethod oranotherbetween vertex pairs , and edgesare then added to an initially em pty network ( n verticeswith no edges ) starting with the vertex pairs with highestsim ilarity . The procedure can be halted at any point , and the resulting com ponentsin the network are taken to be the com m unities . Alternatively , the en - tire progression of the algorithm from em pty graph to com plete graph can be represented in the form ofa tree or dendrogram such asthatshown in Fig . 2 . Horizontal cuts through the tree representthe com m unities appro - priate to di(cid:11)erenthalting points . Agglom erativem ethodsbased on awidevariety ofsim - ilarity m easureshavebeen applied to di(cid:11)erentnetworks . Som e networks have naturalsim ilarity m etrics built in . For exam ple , in the widely studied network ofcollabo - rationsbetween (cid:12)lm actors [ 21 , 22 ] , in which two actors areconnected ifthey haveappeared in thesam e(cid:12)lm , one could quantify sim ilarity by how m any (cid:12)lm sactorshave appeared in together [ 23 ] . O thernetworkshaveno natu - ralm etric , butsuitableonescan bedevised using correla - tion coe(cid:14)cients , path lengths , orm atrix m ethods . A well known exam pleofan agglom erativeclustering m ethod is the Concoralgorithm ofBreiger etal . [ 24 ] . Agglom erative m ethods have their problem showever . O neconcern isthatthey failwith som efrequency to (cid:12)nd the correct com m unities in networks were the com m u - nity structureisknown , which m akesitdi(cid:14)cultto place m uch trustin them in othercases . Anotheristheirten - FIG . 3 : A gglom erative clustering m ethodsare typically good atdiscovering the strongly linked coresofcom m unities ( bold verticesand edges ) buttend to leave outperipheralvertices , even when , ashere , m ostofthem clearly belong to one com - m unity oranother . dency to (cid:12)nd only the cores ofcom m unities and leave out the periphery . The core nodes in a com m unity of - ten havestrong sim ilarity , and henceareconnected early in the agglom erative process , but peripheralnodes that haveno strong sim ilarity to otherstend to getneglected , leading to structures like that shown in Fig . 3 . In this (cid:12)gure , thereareanum berofperipheralnodeswhosecom - m unity m em bership isobviousto the eye | in m ostcases they have only a single link to a speci(cid:12)c com m unity | butagglom erativem ethodsoften failto placesuch nodes correctly . In this paper , therefore , we focus on divisive m eth - ods . These m ethods have been relatively little studied in the previous literature , either in socialnetwork the - ory or elsewhere , but , as we will see , seem to o(cid:11)er a lot ofprom ise . In a divisive m ethod , we start with the network ofinterestand attem ptto (cid:12)nd the least sim ilar connected pairs of vertices and then rem ove the edges between them . By doing this repeatedly , we divide the network into sm allerand sm allercom ponents , and again we can stop the processatany stage and take the com - ponents at that stage to be the network com m unities . Again , the process can be represented as a dendrogram depicting thesuccessivesplitsofthenetwork into sm aller and sm allergroups . The approach we take follows roughly these lines , butadoptsa som ewhatdi(cid:11)erentphilosophicalviewpoint . Ratherthan looking forthe m ostweakly connected ver - tex pairs , ourapproach willbeto look fortheedgesin the network thatarem ost \ between " othervertices , m eaning thatthe edge is , in som e sense , responsible for connect - ing m any pairs ofothers . Such edges need not be weak atallin the sim ilarity sense . How thisidea worksoutin practice willbecom e clearin the course ofthe presenta - tion . Brie(cid:13)y then , the outline of this paper is as follows . In Sec . II we describe the crucialconcepts behind our m ethodsfor(cid:12)ndingcom m unity structurein networksand show how these concepts can be turned into a concrete prescription for perform ing calculations . In Sec . III we describein detailtheim plem entation ofourm ethods . In 3 Sec . IV weconsiderwaysofdeterm ining when a particu - lardivision ofa network into com m unitiesisa good one , allowing us to quantify the success of our com m unity - (cid:12)nding algorithm s . And in Sec . V we give a num ber ofapplicationsofouralgorithm sto particularnetworks , both realand arti(cid:12)cial . In Sec . VI we give our conclu - sions . A briefreport ofsom e ofthe work contained in thispaperhasappeared previously asRef . 25 . II . FIN D IN G C O M M U N IT IE S IN A N E T W O R K In this paper we present a class of new algorithm s for network clustering , i . e . , the discovery ofcom m unity structure in networks . O ur discussion focuses prim arily on networkswith only a singletypeofvertex and a single type ofundirected , unweighted edge , although general - izationsto m orecom plicated network typesarecertainly possible . There are two centralfeaturesthatdistinguish oural - gorithm sfrom thosethathavepreceded them . First , our algorithm s are divisive rather than agglom erative . D i - visive algorithm s have occasionally been studied in the past , but , as discussed in the introduction , ours di(cid:11)er in focusing not on rem oving the edges between vertex pairs with lowest sim ilarity , but on (cid:12)nding edges with the highest \ betweenness , " where betweenness is som e m easure thatfavorsedgesthatlie between com m unities and disfavorsthose thatlie inside com m unities . To m akethingsm oreconcrete , wegivesom eexam ples ofthe typesofbetweennessm easureswe willbe looking at . Allofthem are based on the sam e idea . Iftwo com - m unitiesarejoined by only a few inter - com m unity edges , then allpaths through the network from verticesin one com m unity to verticesin the otherm ustpassalong one ofthosefew edges . G iven a suitablesetofpaths , onecan count how m any go along each edge in the graph , and this num ber we then expect to be largest for the inter - com m unity edges , thus providing a m ethod foridentify - ing them . O ur di(cid:11)erentm easurescorrespond to various im plem entationsofthisidea . 1 . The sim plest exam ple ofsuch a betweenness m ea - sureisthatbased on shortest ( geodesic ) paths : we (cid:12)nd theshortestpathsbetween allpairsofvertices and counthow m any run along each edge . To the bestofourknowledge thism easure was(cid:12)rstintro - duced by Anthonissein a never - published technical report in 1971 [ 26 ] . Anthonisse called it \ rush , " butwe preferthe term edge betweenness , since the quantity isa naturalgeneralization to edgesofthe well - known ( vertex ) betweenness m easure ofFree - m an [ 27 ] , which was the inspiration for our ap - proach . W hen we need to distinguish it from the otherbetweennessm easuresconsidered in this pa - per , wewillreferto itas shortest - path betweenness . A fast algorithm for calculating the shortest - path betweennessisgiven in Sec . IIIA . 2 . The shortest - path betweenness can be thought of in term s of signals traveling through a network . If signals travelfrom source to destination along geodesic network paths , and allvertices send sig - nals at the sam e constant rate to allothers , then the betweenness is a m easure ofthe rate atwhich signalspassalongeach edge . Supposehoweverthat signals do not travelalong geodesic paths , but in - stead just perform a random walk about the net - work untilthey reach theirdestination . Thisgives usanotherm easure on edges , the random - walk be - tweenness : we calculate the expected net num ber oftim es that a random walk between a particular pair of vertices will pass down a particular edge and sum over allvertex pairs . The random - walk betweennesscan be calculated using m atrix m eth - ods , asdescribed in Sec . IIIC . 3 . Anotherbetweennessm easureism otivated by ideas from elem entary circuit theory . W e consider the circuitcreated by placing a unitresistanceon each edge of the network and unit current source and sink ata particularpair ofvertices . The resulting current(cid:13)ow in the network willtravelfrom source to sink along a m ultitudeofpaths , thosewith least resistancecarrying the greatestfraction ofthe cur - rent . The current - (cid:13)ow betweenness for an edge we de(cid:12)ne to be the absolute value ofthe current along the edge sum m ed overallsource / sink pairs . It can be calculated using K irchho(cid:11)’s laws , as de - scribed in Sec . IIIB . In fact , as we willshow , the current - (cid:13)ow betweenness turns out to be exactly the sam e as the random walk betweenness ofthe previousparagraph , butwe nonethelessconsiderit separately since it leads to a sim pler derivation of the m easure . These m easuresare only suggestions ; m any othersare possibleand m ay wellbeappropriateforspeci(cid:12)capplica - tions . M easures ( 1 ) and ( 2 ) arein som esenseextrem esin thespectrum ofpossibilities , onecorrespondingtosignals that know exactly where they are going , and the other to signals that have no idea where they are going . As we willsee , however , these two m easures actually give rather sim ilar results , indicating that the precise choice ofbetweenness m easure m ay not , at least for the types ofapplicationsconsidered here , be thatim portant . Thesecond way in which ourm ethodsdi(cid:11)erfrom pre - viousonesisin the inclusion ofa \ recalculation step " in the algorithm . Ifwe wereto perform a standard divisive clustering based on edgebetweennesswewould calculate the edge betweenness for alledges in the network and then rem oveedgesin decreasing orderofbetweennessto produce a dendrogram like that ofFig . 2 , showing the orderin which the network splitup . However , oncethe(cid:12)rstedgein thenetwork isrem oved in such an algorithm , the betweennessvaluesforthe re - m aining edgeswillno longerre(cid:13)ectthenetwork asitnow is . Thiscan give rise to unwanted behaviors . Forexam - 4 ple , iftwo com m unitiesare joined by two edges , but , for one reason oranother , m ostpathsbetween the two (cid:13)ow along justone ofthose edges , then thatedge willhave a high betweennessscore and the otherwillnot . An algo - rithm thatcalculated betweennessesonly once and then rem oved edges in betweenness order would rem ove the (cid:12)rst edge early in the course of its operation , but the second m ight not get rem oved untilm uch later . Thus the obviousdivision ofthe network into two partsm ight notbediscovered by thealgorithm . In theworstcasethe twopartsthem selvesm ightbeindividually broken up be - fore the division between the two is m ade . In practice , problem s like this crop up in realnetworks with som e regularity and render algorithm s ofthis type ine(cid:11)ective forthe discovery ofcom m unity structure . The solution , luckily , is obvious . W e sim ply recalcu - late our betweenness m easure after the rem ovalofeach edge . Thiscertainly addsto the com putationale(cid:11)ortof perform ing thecalculation , butitse(cid:11)ecton theresultsis so desirable thatwe considerthe price worth paying . Thusthegeneralform ofourcom m unitystructure(cid:12)nd - ing algorithm isasfollows : 1 . Calculate betweenness scores for alledges in the network . 2 . Find the edgewith the highestscoreand rem oveit from the network . 3 . Recalculate betweennessforallrem aining edges . 4 . Repeatfrom step 2 . In fact , it appears that the recalculation step is the m ostim portantfeatureofthealgorithm , asfarasgetting satisfactory results is concerned . As m entioned above , ourstudiesindicatethat , onceonehitson theidea ofus - ingbetweennessm easurestoweightedges , theexactm ea - sure one usesappearsnotto in(cid:13)uence the resultshighly . The recalculation step , on the other hand , is absolutely crucialto the operation ofour m ethods . This step was m issing from previous attem pts at solving the cluster - ing problem using divisive algorithm s , and yet without itthe resultsare very poorindeed , failing to (cid:12)nd known com m unity structure even in the sim plest ofcases . In Sec . V B wegivean exam plecom paring theperform ance ofthe algorithm on a particularnetwork with and with - outthe recalculation step . In the following sections we discuss im plem entation and give exam plesofouralgorithm sfor(cid:12)nding com m u - nity structure . Forthereaderwho m erely wantsto know what algorithm they should use for their own problem , letusgive an im m ediate answer : form ostproblem s , we recom m end the algorithm with betweenness scores cal - culated using theshortest - path betweennessm easure ( 1 ) above . This m easure appears to work welland is the quickest to calculate | as described in Sec . IIIA , it can be calculated for alledges in tim e O ( m n ) , where m is the num ber ofedges in the graph and n is the num ber of vertices . This is the only version of the algorithm thatwe discussed in Ref . 25 [ 47 ] . The otherversionswe discuss , while being ofsom e pedagogicalinterest , m ake greatercom putationaldem ands , and in practice seem to give resultsno betterthan the shortest - path m ethod . III . IM P LE M E N TA T IO N In theory , the descriptions of the last section com - pletely de(cid:12)nethem ethodsweconsiderin thispaper , but in practice there are a num ber oftricks to their im ple - m entation thatareim portantforturning thedescription into a workable com puteralgorithm . Essentially allofthe work in the algorithm is in the calculation ofthe betweenness scores for the edges ; the job of(cid:12)nding and rem oving the highest - scoring edge is trivialand notcom putationally dem anding . Letustackle ourthree suggested betweennessm easuresin turn . A . Shortest - path betw eenness At(cid:12)rstsight , itappearsthatcalculating the edge be - tweennessm easure based on geodesic pathsforalledges willtake O ( m n 2 ) operations on a graph with m edges and n vertices : calculating the shortest path between a particularpairofverticescan bedoneusing breadth - (cid:12)rst search in tim e O ( m ) [ 28 , 29 ] , and there are O ( n 2 ) ver - tex pairs . Recently however new algorithm s have been proposed by Newm an [ 30 ] and independently by Bran - des [ 31 ] thatcan perform thecalculation fasterthan this , (cid:12)nding allbetweennessesin O ( m n ) tim e . Both Newm an and Brandes gave algorithm s for the standard Freem an vertex betweenness , but itis trivialto adapttheir algo - rithm s for edge betweenness . W e describe the resulting m ethod here forthe algorithm ofNewm an . Breadth - (cid:12)rstsearch can (cid:12)nd shortestpathsfrom a sin - gle vertex s to allothers in tim e O ( m ) . In the sim plest case , when there is only a single shortestpath from the source vertex to any other ( we willconsider other cases in a m om ent ) the resulting setofpathsform sa shortest - path tree | seeFig . 4a . W ecan now usethistreetocalcu - late the contribution to betweenness for each edge from thissetofpathsasfollows . W e (cid:12)nd (cid:12)rstthe \ leaves " of the tree , i . e . , those nodessuch thatno shortestpathsto othernodespassthrough them , and weassign ascoreof1 to the single edge that connects each to the rest ofthe tree , as shown in the (cid:12)gure . Then , starting with those edgesthatarefarthestfrom thesourcevertex on thetree , i . e . , lowestin Fig . 4a , wework upwards , assigning a score to each edge thatis 1 plus the sum ofthe scoreson the neighboring edgesim m ediately below it . W hen we have gone though alledges in the tree , the resulting scores are the betweenness countsfor the paths from vertex s . Repeating theprocessforallpossiblevertices s and sum - m ing the scores , we arriveatthe fullbetweennessscores for shortest paths between allpairs . The breadth - (cid:12)rst search and the process ofworking up through the tree 5 23 116 256 ( a ) 1 1 2 1 1 3 13 1 5 56 73 6 ( b ) 1 s s 1 4 2 1 leaves 1 2 FIG . 4 : Calculation ofshortest - path betweenness : ( a ) W hen there is only a single shortest path from a source vertex s ( top ) to allother reachable vertices , those paths necessarily form a tree , which m akes the calculation ofthe contribution to betweenness from this set ofpaths particularly sim ple , as describein thetext . ( b ) Forcasesin which thereism orethan one shortest path to som e vertices , the calculation is m ore com plex . First we m ust calculate the num ber ofpaths from the source to each other vertex ( num bers on vertices ) , and then these are used to weightthe path countsappropriately . In eithercase , wecan check theresultsby con(cid:12)rm ing thatthe sum ofthebetweennessesoftheedgesconnected to thesource vertex isequalto the totalnum berofreachable vertices | six in each ofthe casesillustrated here . both take worst - case tim e O ( m ) and there are n ver - ticestotal , so theentirecalculation takestim e O ( m n ) as claim ed . Thissim plecaseservesto illustratethebasicprinciple behind the algorithm . In general , however , it is notthe casethatthereisonly a singleshortestpath between any pairofvertices . M ostnetworkshaveatleastsom evertex pairs between which there are severalgeodesic paths of equallength . Figure 4b shows a sim ple exam ple of a shortest path \ tree " for a network with this property . Theresulting structureisin factno longera tree , and in such cases an extra step is required in the algorithm to calculate the betweennesscorrectly . In the traditionalde(cid:12)nition ofvertex betweenness [ 27 ] m ultiple shortest paths between a pair of vertices are given equalweightssum m ing to 1 . Forexam ple , ifthere are three shortest paths , each will be given weight 13 . W e adopt the sam e de(cid:12)nition for our edge betweenness ( as did Anthonisse in his originalwork [ 26 ] , although other de(cid:12)nitions are possible [ 32 ] ) . Note that the paths m ay run along the sam e edge or edges for som e part of their length , resulting in edges with greater weight . To calculate correctly whatfraction ofthe paths(cid:13)ow along each edgein the network , we generalizethe breadth - (cid:12)rst search partofthe calculation , asfollows . Consider Fig . 4b and suppose we are perform ing a breadth - (cid:12)rst search starting at vertex s . W e carry out the following steps : 1 . The initialvertex s isgiven distance d s = 0 and a weight w s = 1 . 2 . Every vertex i adjacentto s isgiven distance d i = d s + 1 = 1 , and weight w i = w s = 1 . 3 . Foreach vertex j adjacentto oneof those vertices i we do one ofthree things : ( a ) If j has not yet been assigned a distance , it is assigned distance d j = d i + 1 and weight w j = w i . ( b ) If j hasalready been assigned a distance and d j = d i + 1 , then the vertex’s weight is in - creased by w i , thatis w j w j + w i . ( c ) If j hasalready been assigned a distance and d j < d i + 1 , we do nothing . 4 . Repeat from step 3 untilno vertices rem ain that haveassigned distancesbutwhoseneighborsdonot have assigned distances . In practice , thisalgorithm can be im plem ented m ostef - (cid:12)ciently using a queue or(cid:12)rst - in / (cid:12)rst - outbu(cid:11)erto store the vertices that have been assigned a distance , just as in the standard breadth - (cid:12)rstsearch . Physically , theweighton avertex i representsthenum - ber ofdistinct paths from the source vertex to i . These weightsareprecisely whatwe need to calculateouredge betweennesses , because iftwo vertices i and j are con - nected , with j fartherthan i from the source s , then the fraction ofa geodesicpath from j through i to s isgiven by w i = w j . Thus , tocalculatethecontribution to edgebe - tweennessfrom allshortestpathsstarting at s , we need only carry outthe following steps : 1 . Find every \ leaf " vertex t , i . e . , a vertex such that no pathsfrom s to otherverticesgo though t . 2 . Foreach vertex i neighboring t assign a scoreto the edge from t to i of w i = w t . 3 . Now , starting with theedgesthatarefarthestfrom the sourcevertex s | lowerdown in a diagram such as Fig . 4b | work up towards s . To the edge from vertex i to vertex j , with j being farther from s than i , assign a score that is 1 plus the sum of the scores on the neighboring edges im m ediately below it ( i . e . , thosewith which itsharesa com m on vertex ) , allm ultiplied by w i = w j . 4 . Repeatfrom step 3 untilvertex s isreached . Now repeating thisprocessforall n sourcevertices s and sum m ing the resulting scores on the edges gives us the totalbetweennessforalledgesin tim e O ( m n ) . W e now have to repeat this calculation for each edge rem oved from the network , ofwhich there are m , and hencethecom pletecom m unity structurealgorithm based on shortest - path betweennessoperatesin worst - casetim e O ( m 2 n ) , orO ( n 3 ) tim eon a sparsegraph . In ourexperi - ence , thistypically m akesittractablefornetworksofup 6 to about n = 10000 vertices , with current ( circa 2003 ) desktop com puters . In som e specialcases one can do better . In particular , we note that the rem ovalof an edgeonly a(cid:11)ectsthebetweennessofotheredgesthatfall in the sam e com ponent , and hence that we need only recalculate betweennessesin that com ponent . Networks with strong com m unity structure often break apartinto separatecom ponentsquiteearly in theprogressoftheal - gorithm , substantially reducing the am ountofwork that needsto be done on subsequentsteps . W hether thisre - sultsin a changein the com putationalcom plexity ofthe algorithm forany com m only occurring classesofgraphs is an open question , but it certainly gives a substantial speed boostto m any ofthecalculationsdescribed in this paper . Som e networks are directed , i . e . , their edges run in one direction only . The world wide web is an exam ple ; linksin theweb pointin onedirection only from oneweb page to another . O ne could im agine a generalization of the shortest - path betweenness that allowed for directed edges by counting only those paths that travelin the forward direction along edges . Such a calculation is a trivialvariation on the one described above . However , we have found that in m any cases it is better to ignore the directed nature ofa network in calculating com m u - nity structure . O ften an edgeactssim ply asan indication ofa connection between two nodes , and its direction is unim portant . For exam ple , in Ref . 25 we applied our algorithm to a food web of predator - prey interactions between m arine species . Predator - prey interactions are clearly directed | one species m ay eat another , but it is unlikely thatthereverseissim ultaneouslytrue . However , as far as com m unity structure is concerned , we want to know only which species have interactions with which others . W e (cid:12)nd , therefore , that our algorithm applied to the undirected version ofthe food web works wellat picking outthe com m unity structure , and no specialal - gorithm isneeded forthe directed case . W e giveanother exam ple ofour m ethod applied to a directed graph in Sec . V D . B . R esistor netw orks As exam ples ofbetweenness m easuresthat take m ore than just shortest paths into account , we proposed in Sec . IIm easuresbased on random walksand resistornet - works . In fact , aswe now show , when appropriately de - (cid:12)ned thesetwo m easuresareprecisely thesam e . Herewe derive the resistance m easure (cid:12)rst , since it turns out to besim pler ; in thefollowing section wederivetherandom walk m easure and show thatthe two are equivalent . Consider the network created by placing a unit resis - tanceon every edgeofournetwork , a unitcurrentsource atvertex s , and aunitcurrentsink atvertex t ( seeFig . 5 ) . Clearly the current between s and t will(cid:13)ow prim arily along shortpaths , butsom e will(cid:13)ow along longerones , roughly in inverse proportion to their length . W e will t s current in current out FIG . 5 : A n exam pleofthetypeofresistornetwork considered here , in which aunitresistanceisplaced on each edgeand unit current(cid:13)owsinto and outofthe source and sink vertices . use the absolute m agnitude of the current (cid:13)ow as our betweennessscore foreach source / sink pair . The current (cid:13)ows in the network are governed by K irchho(cid:11)’s laws . To solve them we proceed as follows foreach separate com ponentofthe graph . Let V i be the voltage atvertex i , m easured relative to any convenient point . Then forall i we have X j A ij ( V i (cid:0) V j ) = (cid:14) is (cid:0) (cid:14) it ; ( 1 ) where A ij is the ij elem ent ofthe adjacency m atrix of the graph , i . e . , A ij = 1 if i and j are connected by an edgeand A ij = 0 otherwise . Theleft - hand sideofEq . ( 1 ) representsthenetcurrent(cid:13)ow outofvertex i alongedges ofthe network , and the right - hand side represents the source and sink . D e(cid:12)ning k i = P j A ij , which is the vertex degree , and creating a diagonalm atrix D with thesedegreeson thediagonal D ii = k i , thisequation can be written in m atrix form as ( D (cid:0) A ) (cid:1) V = s , where the source vector s hascom ponents s i = ( + 1 for i = s (cid:0) 1 for i = t 0 otherwise . ( 2 ) W ecannotdirectly invertthem atrix D (cid:0) A to getthe voltage vector V , because the m atrix ( which is just the graph Laplacian ) issingular . Thisisequivalentto saying thatthere isone undeterm ined degree offreedom corre - sponding to the choiceofreferencepotentialform easur - ing the voltages . W e can add any constantto a solution for the vertex voltages and get another solution | only the voltage di(cid:11)erencesm atter . In choosing the reference potential , we(cid:12)x thisdegreeoffreedom , leavingonly n (cid:0) 1 m oreto bedeterm ined . In m athem aticalterm s , onceany n (cid:0) 1 ofthe equationsin ourm atrix form ulation aresat - is(cid:12)ed , therem aining oneisalso autom atically satis(cid:12)ed so long as current is conserved in the network as a whole , i . e . , so long as P i s i = 0 , which is clearly true in this case . Choosing any vertex v to bethereferencepoint , there - fore , we rem ove the row and colum n corresponding to 7 that vertex from D and A before inverting . D enoting the resulting ( n (cid:0) 1 ) (cid:2) ( n (cid:0) 1 ) m atrices D v and A v , we can then write V = ( D v (cid:0) A v ) (cid:0) 1 (cid:1) s : ( 3 ) Calculation ofthecurrentsin thenetworkthusinvolves inverting D v (cid:0) A v once for any convenient choice of v , and taking the di(cid:11)erencesofpairsofcolum nsto getthe voltagevector V foreach possiblesource / sink pair . ( The voltage for the one m issing vertex v is always zero , by hypothesis . ) The absolute m agnitudesofthe di(cid:11)erences ofvoltages along each edge give us betweenness scores forthe given source and sink . Sum m ing overallsources and sinks , we then getourcom plete betweennessscore . The m atrix inversion takes tim e O ( n 3 ) in the worst case , while the subsequent calculation ofbetweennesses takestim e O ( m n 2 ) , where asbefore m isthe num berof edgesand n the num ber ofverticesin the graph . Thus , the entire com m unity structure algorithm , including the recalculation step , willtakeO (cid:0) ( n + m ) m n 2 (cid:1) tim eto com - plete , orO ( n 4 ) on a sparse graph . Although , aswe will see , the algorithm is good at (cid:12)nding com m unity struc - ture , this poor perform ance m akes it practicalonly for sm aller graphs ; a few hundreds ofvertices is the m ost that we have been able to do . It is for this reason that we recom m end using the shortest - path betweenness al - gorithm in m ostcases , which givesresultsaboutasgood orbetterwith considerably lesse(cid:11)ort . C . R andom w alks The random - walk betweennessdescribed in Sec . IIre - quiresusto calculatehow often on averagerandom walks starting atvertex s willpassdown a particularedgefrom vertex v to vertex w ( or vice versa ) before (cid:12)nding their way to a given targetvertex t . To calculatethisquantity weproceed asfollowsforeach separatecom ponentofthe graph . Asbefore , let A ij be an elem entofthe adjacency m a - trix such that A ij = 1 ifvertices i and j areconnected by an edgeand A ij = 0 otherwise . Considera random walk that on each step decides uniform ly between the neigh - bors ofthe current vertex j and takes a step to one of them . The num berofneighborsisjustthe degree ofthe vertex k j = P i A ij , and theprobability forthetransition from j to i is A ij = k j , which we can regard asan elem ent ofthe m atrix M = A (cid:1) D (cid:0) 1 , where D is the diagonal m atrix with D ii = k i . W e are interested in walks that term inate when they reach the target t , so that t is an absorbing state . The m ost convenientway to representthis is just to rem ove entirely thevertex t from thegraph , so thatno walk ever reachesany othervertex from t . Thuslet M t = A t (cid:1) D (cid:0) 1 t be the m atrix M with the t th row and colum n rem oved ( and sim ilarly for A t and D t ) . Now the probability that a walk starts at s , takes n steps , and endsup atsom e othervertex ( not t ) , isgiven by the is elem ent of M nt , which we denote [ M nt ] is . In particular , walks end up at v and w with probabilities [ M nt ] vs and [ M nt ] w s , and of those a fraction 1 = k v and 1 = k w respectively then passalong the edge ( v ; w ) in one direction or the other . ( Note that they m ay also have passed along thisedge an arbitrary num beroftim esbe - fore reaching thispoint . ) Sum m ing overall n , the m ean num beroftim esthata walk ofany length traversesthe edge from v to w is k (cid:0) 1 v [ ( I (cid:0) M t ) (cid:0) 1 ] vs , and sim ilarly for walksthatgo from w to v . To highlight the sim ilarity with the current - (cid:13)ow be - tweennessofSec . IIIB , letusdenote these two num bers V v and V w respectively . Then we can write V = D (cid:0) 1 (cid:1) ( I (cid:0) M t ) (cid:0) 1 (cid:1) s = ( D t (cid:0) A t ) (cid:0) 1 (cid:1) s ; ( 4 ) wherethesourcevector s isthevectorwhosecom ponents areall0exceptforasingle1in theposition corresponding to the source vertex s . Now we de(cid:12)ne our random - walk betweenness for the edge ( v ; w ) to be the absolute value ofthe di(cid:11)erence of the two probabilities V v and V w , i . e . , the netnum ber of tim es the walk passes along the edge in one direction . Thisseem sa naturalde(cid:12)nition | itm akeslittle sense to accord an edge high betweennesssim ply because a walk wentback and forth along itm any tim es . Itisthedi(cid:11)er - ence between the num bersoftim esthe edge istraversed in eitherdirection thatm atters [ 48 ] . Butnow weseethatthism ethod isvery sim ilarto the resistornetwork calculation ofSec . IIIB . In that calcu - lation we also evaluated ( D t (cid:0) A t ) (cid:0) 1 (cid:1) s for a suitable source vector and then took di(cid:11)erences ofthe resulting num bers . The only di(cid:11)erence isthatin the current - (cid:13)ow calculation we had a sink term in s as wellas a source . Purely forthepurposesofm athem aticalconvenience , we can add such a sink in the presentcaseatthe targetver - tex t | thism akesnodi(cid:11)erencetothesolution for V since the t th row hasbeen rem oved from theequationsanyway . By doing this , however , we turn the equations into pre - cisely theform ofthecurrent - (cid:13)ow calculation , and hence it becom es clear that the two m easures are num erically identical , although theirderivation isquite di(cid:11)erent . ( It also im m ediately followsthatwe can rem ove any row or colum n and stillget the sam e answer | it doesn’t have to be row and colum n t , although physically this choice m akesthe m ostsense . ) IV . Q U A N T IFY IN G T H E ST R E N G T H O F C O M M U N IT Y ST R U C T U R E Aswe show in Sec . V , ourcom m unity structure algo - rithm sdo an excellentjob ofrecoveringknown com m uni - tiesboth in arti(cid:12)cially generated random networksand in real - world exam ples . However , in practicalsituationsthe algorithm swillnorm ally be used on networksfor which the com m unities are not known ahead of tim e . This raisesa new problem : how do weknow when thecom m u - nities found by the algorithm are good ones ? O ur algo - 8 rithm salwaysproduce som e division ofthenetwork into com m unities , even in com pletely random networks that haveno m eaningfulcom m unity structure , so itwould be usefulto have som e way ofsaying how good the struc - ture found is . Furtherm ore , the algorithm s’output is in the form ofa dendrogram which represents an entire nested hierarchy ofpossible com m unity divisionsforthe network . W ewould liketo know which ofthesedivisions are the bestonesfora given network | where we should cutthe dendrogram to geta sensible division ofthe net - work . To answerthese questionswe now de(cid:12)ne a m easureof the quality ofa particular division ofa network , which we callthe m odularity . Thism easure isbased on a pre - vious m easure ofassortative m ixing proposed by New - m an [ 33 ] . Consider a particular division of a network into k com m unities . Letusde(cid:12)nea k (cid:2) k sym m etricm a - trix e whoseelem ent e ij isthefraction ofalledgesin the network that link verticesin com m unity i to verticesin com m unity j [ 49 ] . ( Hereweconsideralledgesin theorig - inalnetwork | even afteredgeshavebeen rem oved by the com m unity structure algorithm ourm odularity m easure iscalculated using the fullnetwork . ) Thetraceofthism atrixTr e = P i e ii givesthefraction ofedgesin thenetwork thatconnectverticesin thesam e com m unity , and clearly a good division into com m unities should have a high value ofthis trace . The trace on its own , however , isnotagood indicatorofthequality ofthe division since , forexam ple , placing allverticesin a single com m unity would give the m axim alvalue of Tr e = 1 while giving no inform ation aboutcom m unity structure atall . So we further de(cid:12)ne the row ( or colum n ) sum s a i = P j e ij , which representthefraction ofedgesthatconnect to verticesin com m unity i . In a network in which edges fallbetween verticeswithoutregard forthe com m unities they belong to , we would have e ij = a i a j . Thus we can de(cid:12)ne a m odularity m easure by Q = X i (cid:0) e ii (cid:0) a 2 i (cid:1) = Tr e (cid:0) (cid:13)(cid:13) e 2 (cid:13)(cid:13) ; ( 5 ) where k x k indicatesthe sum ofthe elem entsofthe m a - trix x . Thisquantity m easuresthe fraction ofthe edges in the network that connect vertices of the sam e type ( i . e . , within - com m unity edges ) m inusthe expected value ofthesam equantity in a network with thesam ecom m u - nity divisions but random connections between the ver - tices . Ifthenum berofwithin - com m unity edgesisnobet - terthan random , we willget Q = 0 . Valuesapproaching Q = 1 , which is the m axim um , indicate strong com m u - nity structure [ 50 ] . In practice , valuesforsuch networks typically fallin the range from about0 : 3 to 0 : 7 . Higher valuesare rare . Theexpected erroron Q can becalculated by treating each edgein thenetwork asan independentm easurem ent ofthe contributions to the elem ents ofthe m atrix e . A sim ple jackknife procedure workswell [ 33 , 34 ] . Typically , we willcalculate Q for each split ofa net - workintocom m unitiesaswem ovedown thedendrogram , and look forlocalpeaksin itsvalue , which indicate par - ticularly satisfactory splits . Usually we (cid:12)nd that there are only one or two such peaks and , as we willshow in the next section , in cases where the com m unity struc - ture is known beforehand by som e m eans we (cid:12)nd that thepositionsofthesepeakscorrespond closely to theex - pected divisions . The height ofa peak is a m easure of the strength ofthe com m unity division . V . A P P LIC A T IO N S In thissection wegivea num berofapplicationsofour algorithm s to particular problem s , illustrating their op - eration , and their use in understanding the structure of com plex networks . A . Tests on com puter - generated netw orks First , as a controlled test ofhow wellour algorithm s perform , we have generated networks with known com - m unity structure , to see ifthe algorithm s can recognize and extractthisstructure . W e have generated a large num ber of graphs with n = 128 vertices , divided into four com m unities of 32 vertices each . Edges were placed independently at ran - dom between vertex pairswith probability p in foran edge to fallbetween verticesin the sam e com m unity and p out to fallbetween vertices in di(cid:11)erent com m unities . The valuesof p in and p out were chosen to m ake the expected degree of each vertex equalto 16 . In Fig . 6 we show a typicaldendrogram from the analysis ofsuch a graph using the shortest - path betweennessversion ofouralgo - rithm . ( In fact , for the sake ofclarity , the (cid:12)gure is for a 64 - node version ofthe graph . ) Resultsforthe random walk version aresim ilar . Atthe top ofthe (cid:12)gurewealso show the m odularity , Eq . ( 5 ) , for the sam e calculation , plotted asafunction ofposition in thedendrogram . That is , the graph isaligned with the dendrogram so thatone can read o(cid:11) m odularity values for di(cid:11)erent divisions of thenetwork directly . Aswecan see , them odularity hasa single clearpeak atthe point where the network breaks into four com m unities , as we would expect . The peak value isaround 0 : 5 , which istypical . In Fig . 7 we show the fraction of vertices in our com puter - generated network sam ple classi(cid:12)ed correctly into the four com m unities by our algorithm s , as a func - tion ofthe m ean num ber z out ofedgesfrom each vertex to vertices in other com m unities . As the (cid:12)gure shows , both the shortest - path and random - walk versionsofthe algorithm perform excellently , with m orethan 90 % ofall verticesclassi(cid:12)ed correctly from z out = 0 allthe way to around z out = 6 . O nly for z out > (cid:24) 6 does the classi(cid:12)ca - tion begin to deteriorate m arkedly . In other words , our algorithm correctly identi(cid:12)esthecom m unity structurein the network alm ostallthe way to the point z out = 8 at 9 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 m odu l a r it y FIG . 6 : Plot of the m odularity and dendrogram for a 64 - vertex random com m unity - structured graph generated asde - scribed in the text with , in this case , z in = 6 and z out = 2 . The shapes on the right denote the four com m unities in the graph and aswe can see , the peak in the m odularity ( dotted line ) corresponds to a perfect identi(cid:12)cation ofthe com m uni - ties . 0 2 4 6 8 average number of inter - community edges per vertex 0 0 . 2 0 . 4 0 . 6 0 . 8 1 fr ac ti on o f v e r ti ce s c l a ss i f i e d c o rr ec tl y shortest path random walk FIG . 7 : The fraction of vertices correctly identi(cid:12)ed by our algorithm sin thecom puter - generated graphsdescribed in the text . The two curves show results for the edge betweenness ( circles ) and random walk ( squares ) versionsofthealgorithm as a function ofthe num ber ofedges vertices have to others outside their own com m unity . The point z out = 8 at the rightm ost edge ofthe plot represents the point at which the graphs | in this exam ple | have as m any connections outside their own com m unity as inside it . Each point is an average over100 graphs . which each vertex has on average the sam e num ber of connectionsto verticesoutside its com m unity asitdoes to those inside . The shortest - path version ofthe algorithm does how - ever perform noticeably better than the random - walk version , especially forthe m ore di(cid:14)cultcaseswhere z out is large . G iven that the random - walk algorithm is also m orecom putationally dem anding , thereseem slittle rea - son touseitratherthan theshortest - path algorithm , and hence , asdiscussed previously , we recom m end the latter for m ost applications . ( To be fair , the random - walk al - gorithm doesslightly out - perform theshortest - path algo - rithm in the exam ple addressed in the following section , although , being only a single case , it is hard to know whetherthisissigni(cid:12)cant . ) B . Zachary’s karate club netw ork W e now turn to applications ofour m ethods to real - world network data . O ur (cid:12)rst such exam ple is taken from one of the classic studies in socialnetwork anal - ysis . O ver the course oftwo years in the early 1970s , W ayne Zachary observed socialinteractionsbetween the m em bersofa karateclub atan Am erican university [ 35 ] . He constructed networksoftiesbetween m em bersofthe club based on their socialinteractions both within the club and away from it . By chance , a dispute arose dur - ing the course ofhis study between the club’s adm inis - 10 1 2 3 4 5 6 7 8 11 12 13 14 18 20 22 9 32 31 28 29 33 10 17 34 15 16 21 23 24 26 30 25 27 19 FIG . 8 : The network of friendships between individuals in thekarateclub study ofZachary [ 35 ] . Theadm inistratorand theinstructorarerepresented by nodes1 and 33 respectively . Shaded squaresrepresentindividualsto who ended up align - ing with theclub’sadm inistratorafterthe(cid:12)ssion oftheclub , open circlesthose who aligned with the instructor . trator and its principalkarate teacher over whether to raise club fees , and as a result the club eventually split in two , form ing two sm aller clubs , centered around the adm inistratorand the teacher . In Fig . 8 we show a consensus network structure ex - tracted from Zachary’s observations before the split . Feeding thisnetwork into ouralgorithm swe (cid:12)nd the re - sults shown in Fig . 9 . In the left - m ost two panels we show the dendrogram s generated by the shortest - path and random - walk versions ofour algorithm , along with the m odularity m easures for the sam e . As we see , both algorithm sgivereasonablyhigh valuesforthem odularity when thenetwork issplitinto two com m unities | around 0 . 4 in each case | indicating that there is a strong nat - uraldivision at this level . W hat’s m ore , the divisions in question correspond alm ostperfectly to the actualdi - visions in the club revealed by which group each club m em ber joined after the club split up . ( The shapes of theverticesrepresenting thetwo factionsarethesam eas those ofFig . 8 . ) O nly one vertex , vertex 3 , is m isclassi - (cid:12)ed by theshortest - path version ofthem ethod , and none are m isclassi(cid:12)ed by the random - walk version | the latter getsa perfectscoreon thistest . ( O n theotherhand , the two - com m unity splitfailsto producea localm axim um in the m odularity for the random - walk m ethod , unlike the shortest - path m ethod forwhich thereisalocalm axim um precisely atthispoint . ) In the last panelofFig . 9 we show the dendrogram and m odularity foran algorithm based on shortest - path betweenness but without the crucialrecalculation step discussed in Sec . II . As the (cid:12)gure shows , without this step , the algorithm fails to (cid:12)nd the division ofthe net - work into thetwo known groups . Furtherm ore , them od - ularity doesn’t reach nearly such high values as in the (cid:12)rst two panels , indicating that the divisions suggested arem uch poorerthan in thecaseswith therecalculation . C . C ollaboration netw ork Forournextexam ple , we look ata collaboration net - work of scientists . Figure 10a shows the largest com - ponent of a network of collaborations between physi - cists who conduct research on networks . ( The authors ofthe presentpaper , for instance , are am ong the nodes in this network . ) This network ( which appeared previ - ously in Ref . 36 ) was constructed by taking nam es of authors appearing in the lengthy bibliography ofRef . 4 and cross - referencingwith thePhysicsE - printArchiveat arxiv . org , speci(cid:12)cally the condensed m atter section of the archivewhere , forhistoricalreasons , m ostpaperson networkshaveappeared . Authorsappearingin both were added tothenetworkasvertices , and edgesbetween them indicate coauthorship ofone or m ore papers appearing in thearchive . Thusthecollaborativetiesrepresented in the (cid:12)gureare notlim ited to paperson topicsconcerning networks | we were interested prim arily in whether peo - ple know one another , and collaboration on any topic is a reasonable indicatorofacquaintance . The network aspresented in Fig . 10a isdi(cid:14)cultto in - terpret . G iven the nam esofthe scientists , a knowledge - ablereaderwith too m uch tim e on theirhandscould , no doubt , pick outknown groupings , forinstance atpartic - ular institutions , from the generalconfusion . But were thisanetworkaboutwhich wehad no a priori knowledge , we would be hard pressed to understand its underlying structure . Applying the shortest - path version of our algorithm to this network we (cid:12)nd that the m odularity , Eq . ( 5 ) , has a strong peak at 13 com m unities with a value of Q = 0 : 72 (cid:6) 0 : 02 . Extracting the com m unities from the corresponding dendrogram , wehaveindicated them with colorsin Fig . 10b . The knowledgeable readerwillagain be able to discern known groupsofscientistsin thisren - dering , and m ore easily now with the help ofthe colors . Still , however , the structure ofthe network as a whole and the ofthe interactions between groups is quite un - clear . In Fig . 10c we have reduced the network to only the groups . In this panel , we have drawn each group as a circle , with sizevarying roughly with thenum berofindi - vidualsin the group . The linesbetween groupsindicate collaborations between group m em bers , with the thick - nessofthe lines varying in proportion to the num berof pairsofscientistswho have collaborated . Now the over - allstructure ofthe network becom es easy to see . The network is centered around the m iddle group shown in cyan ( which consistsofresearchersprim arily in southern Europe ) , with a knot ofinter - com m unity collaborations going on between the groups on the lower right ofthe picture ( m ostly Boston University physicists and their intellectualdescendants ) . O ther groups ( including the authors’own ) are arranged in various attitudes further 11 134142820182213126717511 2532 242893433191631151023302127 2629 0 0 . 1 0 . 2 0 . 3 0 . 4 goodn e ss o f s p lit 0 0 . 1 0 . 2 0 . 3 0 . 4 goodn e ss o f s p lit 11561771213182022812144 329282527 32 2615161921239312430343310 0 0 . 1 0 . 2 0 . 3 0 . 4 goodn e ss o f s p lit 12177611510161523211932292830272426252218 34 3320319143138421 without recalculation random walk shortest path shortest path FIG . 9 : Com m unity structure in the karate club network . Left : the dendrogram extracted by the shortest - path betweenness version ofour m ethod , and the resulting m odularity . The m odularity has two m axim a ( dotted lines ) corresponding to splits into two com m unities ( which m atch closely the real - world splitofthe club , as denoted by the shapesofthe vertices ) and (cid:12)ve com m unities ( though one ofthose (cid:12)ve contains only one individual ) . O nly one individual , num ber3 , is incorrectly classi(cid:12)ed . Center : the dendrogram for the random walk version ofour m ethod . This version classi(cid:12)es all34 vertices correctly into the factionsthatthey actually splitinto ( (cid:12)rstdotted line ) , although thesplitinto fourcom m unitiesgetsa higherm odularity score ( second dotted line ) . Right : the dendrogram forthe shortest - path algorithm withoutrecalculation ofbetweennessesaftereach edge rem oval . Thisversion ofthe calculation fails to (cid:12)nd the splitinto the two factions . out . O neoftheproblem screated by thesudden availability in recent years oflarge network data sets has been our lack of tools for visualizing their structure [ 4 ] . In the early daysofnetwork analysis , particularly in the social sciences , itwasusually enough sim ply to draw a picture ofa network to seewhatwasgoingon . Networksin those dayshad ten ortwenty nodes , not140 ashere , orseveral billion asin theworld wideweb . W ebelievethatm ethods liketheonepresented here , ofusingcom m unity structure algorithm sto m ake a m eaningful \ coarse graining " ofa network , thereby reducing its levelofcom plexity to one that can be interpreted readily by the hum an eye , will be invaluable in helping usto understand the large - scale structure ofthese new network data . D . O ther exam ples In this section , we brie(cid:13)y describe exam ple applica - tionsofourm ethodsto threefurthernetworks . The(cid:12)rst isanon - hum an socialnetwork , anetworkofdolphins , the second anetworkof(cid:12)ctionalcharacters , and thethird not a socialnetwork atall , buta network ofweb pagesand the linksbetween them . In Fig . 11 we show the socialnetwork ofa com m unity of62 bottlenose dolphinsliving in D oubtfulSound , New Zealand . Thenetworkwascom piled by Lusseau [ 37 ] from seven yearsof(cid:12)eld studiesofthe dolphins , with tiesbe - tween dolphin pairs being established by observation of statisticallysigni(cid:12)cantfrequentassociation . Thenetwork splitsnaturally into two largegroups , represented by the 12 Chakrabarti Sen Manna Chatterjee Newman Moore Sneppen Park Strogatz Watts Callaway Hopcroft Kleinberg Girvan Dodds Weigt Vazquez Barrat Monasson Zecchina Berg Leone Munoz Barabasi Castellano Vespignani Pastor - SatorrasCaldarelli Ben - Avraham Capocci Alava Bianconi Kim Choi Kim Jeong Kahng Goh Hong Oh Barthelemy Havlin Stanley Amaral Scala Kertesz Cohen Erez Rozenfeld Schwartz Moreira Liljeros Edling Stroud Minnhagen Kim Holme Trusina Redner Mendes Krapivsky Rodgers Leyvraz Vazquez Dorogovtsev Goltsev Samukhin Arenas Guimera Camacho Maritan Banavar Giacometti Flammini Rinaldo Bornholdt Maslov Simonsen Eriksen Zaliznyak Penna Herrmann Stauffer Moukarzel Szabo Lahtinen Kaski Sreeram Dasgupta Mukherjee Tadic Ergun Kulkarni Almaas Neda Ravasz Vicsek Farkas Oltvai Somera Mongru Albert TomborYookMason Rajagopalan Podani Szathmary Rubi Sole Vilone Moreno Boguna Ebel Davidsen Schuster Klemm Mielsch HanYoon Holyst Aleksiejuk Fronczak Jedynak Sienkiewicz RothmanSmith Kepler Huss Stadler Gleiss Wagner Fell Barahona Gomez Pacheco Lassig Danon Cabrales Selman Ferrer i Cancho Valverde Andrade Eguiluz Pecora Chakrabarti Sen Manna Chatterjee Newman Moore Sneppen Park Strogatz Watts Callaway Hopcroft Kleinberg Girvan Dodds Weigt Vazquez Barrat Monasson Zecchina Berg Leone Munoz Barabasi Castellano Vespignani Pastor - Satorras Caldarelli Ben - Avraham Capocci Alava Bianconi Kim Choi Kim Jeong Kahng Goh Hong Oh Barthelemy Havlin Stanley Amaral Scala Kertesz Cohen Erez Rozenfeld Schwartz Moreira Liljeros Edling Stroud Minnhagen Kim Holme Trusina Redner Mendes Krapivsky Rodgers Leyvraz Vazquez Dorogovtsev Goltsev Samukhin Arenas Guimera Camacho Maritan Banavar Giacometti Flammini Rinaldo Bornholdt Maslov Simonsen Eriksen Zaliznyak Penna Herrmann Stauffer Moukarzel Szabo Lahtinen Kaski Sreeram Dasgupta Mukherjee Tadic Ergun Kulkarni Almaas Neda Ravasz Vicsek Farkas Oltvai Somera Mongru Albert Tombor Yook Mason Rajagopalan Podani Szathmary Rubi Sole Vilone Moreno Boguna Ebel Davidsen Schuster Klemm Mielsch HanYoon Holyst Aleksiejuk Fronczak Jedynak Sienkiewicz RothmanSmith Kepler Huss Stadler Gleiss Wagner Fell Barahona Gomez Pacheco Lassig Danon Cabrales Selman Ferrer i Cancho Valverde Andrade Eguiluz Pecora ( a ) ( b ) ( c ) FIG . 10 : Illustration ofthe use ofthe com m unity structure algorithm to m ake sense ofa com plex network . ( a ) The initial network isa network ofcoauthorshipsbetween physicistswho have published on topicsrelated to networks . The (cid:12)gure shows only the largestcom ponentofthe network , which contains145 scientists . There are 90 m ore scientistsin sm allercom ponents , which are notshown . ( b ) A pplication oftheshortest - path betweennessversion ofthecom m unity structurealgorithm produces the com m unitiesshown by the colors . ( c ) A coarse - graining ofthenetwork in which each com m unity isrepresented by a single node , with edges representing collaborations between com m unities . The thicknessofthe edges is proportionalto the num ber ofpairsofcollaboratorsbetween com m unities . Clearly panel ( c ) revealsm uch thatisnoteasily seen in the originalnetwork of panel ( a ) . 13 FIG . 11 : Com m unity structure in the bottlenose dolphinsof D oubtfulSound [ 37 , 38 ] , extracted using the shortest - path version ofouralgorithm . The squaresand circles denote the prim ary splitofthe network into two groups , and the circles are further subdivided into four sm aller groups denoted by the di(cid:11)erentshades ofvertices . The m odularity for the split is Q = 0 : 52 . The network hasbeen drawn with longer edges between verticesin di(cid:11)erentcom m unitiesthan between those in the sam e com m unity , to m ake the com m unity groupings clearer . The sam e isalso true ofFigs . 12 and 13 . circlesand squaresin the(cid:12)gure , and thelargerofthetwo alsosplitsintofoursm allersubgroups , represented by the di(cid:11)erent shades . The m odularity is Q = 0 : 38 (cid:6) 0 : 08 for the splitinto two groups , and peaksat0 : 52 (cid:6) 0 : 03 when the subgroup splitting isincluded also . The split into two groups appears to correspond to a known division ofthe dolphin com m unity [ 38 ] . Lusseau reports that for a period ofabout two years during ob - servation ofthe dolphinsthey separated into two groups along thelinesfound by ouranalysis , apparently because ofthe disappearance ofindividualson the boundary be - tween the groups . W hen som e ofthese individualslater reappeared , thetwohalvesofthenetwork joined together once m ore . AsLusseau pointsout , developm entsofthis kind illustrate that the dolphin network is not m erely a scienti(cid:12)c curiosity but , like hum an socialnetworks , is closely tied to the evolution ofthe com m unity . The sub - groupingswithin thelargerhalfofthenetwork also seem to correspond to realdivisions am ong the anim als : the largest subgroup consists alm ost of entirely of fem ales and the othersalm ostentirely ofm ales , and itisconjec - tured thatthesplitbetween the m alegroupsisgoverned by m atrilineage ( D . Lusseau , personalcom m unication ) . Figure 12 shows the com m unity structure ofthe net - work ofinteractionsbetween m ajorcharactersin Victor Hugo’ssprawling novelofcrim eand redem ption in post - restoration France , LesM is(cid:19)erables . Usingthelistofchar - acterappearancesby scene com piled by K nuth [ 39 ] , the network wasconstructed in which the verticesrepresent characters and an edge between two vertices represents co - appearance ofthe corresponding charactersin one or m ore scenes . The optim alcom m unity splitofthe result - ing graph has a strong m odularity of Q = 0 : 54 (cid:6) 0 : 02 , and gives 11 com m unities as shown in the (cid:12)gure . The com m unities clearly re(cid:13)ect the subplot structure ofthe book : unsurprisingly , the protagonist Jean Valjean and his nem esis , the police o(cid:14)cer Javert , are centralto the network and form the hubsofcom m unitiescom posed of their respective adherents . O ther subplots centered on M arius , Cosette , Fantine , and the bishop M yrielarealso picked out . Finally , asan exam pleoftheapplication ofourm ethod to a non - socialnetwork , wehavelooked ata web graph | a network in which the verticesand edgesrepresentweb pagesand thelinksbetween them . Thegraph in question represents180 pagesfrom theweb siteofa largecorpora - tion [ 51 ] . Figure 13 showsthe network and the com m u - nitiesfound in itby theshortest - path version ofouralgo - rithm . Thisnetwork hasoneofthestrongestm odularity valuesofthe exam plesstudied here , at Q = 0 : 65 (cid:6) 0 : 02 . Thelinksbetween web pagesaredirected , asindicated by the arrowsin the (cid:12)gure , but , as discussed in Sec . IIIA , for the purposes of (cid:12)nding the com m unities we ignore direction and treatthe network asundirected . Certainly itm ightbe usefulto know the com m unities in a web network ; an algorithm that can pick out com - m unitiescould revealwhich pagescoverrelated topicsor thesocialstructureoflinksbetween pagesm aintained by di(cid:11)erent individuals . Ideas along these lines have been pursued by , for exam ple , Flake et al . [ 40 ] and Adam ic and Adar [ 41 ] . V I . C O N C LU SIO N S In this paper we have described a new class ofalgo - rithm sforperform ing network clustering , the task ofex - tracting the naturalcom m unity structurefrom networks ofverticesand edges . Thisis a problem long studied in com puter science , applied m athem atics , and the social sciences , but it has lacked a satisfactory solution . W e believe the m ethodsdescribed here give such a solution . They are sim ple , intuitive , and dem onstrably give excel - lentresultson networksforwhich we know the com m u - nity structure ahead oftim e . O ur m ethods are de(cid:12)ned by two crucialfeatures . First , we use a \ divisive " tech - nique which iteratively rem ovesedgesfrom the network , thereby breaking itup in com m unities . The edgesto be rem oved are identi(cid:12)ed by using one ofa set ofedge be - tweennessm easures , ofwhich thesim plestisageneraliza - tion to edgesofthe standard shortest - path betweenness ofFreem an . Second , our algorithm s include a recalcu - lation step in which betweennessscoresare re - evaluated after the rem ovalofevery edge . This step , which was m issing from previousalgorithm s , turnsoutto be ofpri - m ary im portance to the successofours . W ithoutit , the algorithm sfailm iserably ateven the sim plestclustering tasks . W e have dem onstrated the e(cid:14)cacy and utility ofour m ethods with a num ber of exam ples . W e have shown 14 Myriel Mlle . Baptistine Mme . Magloire Countess de Lo Geborand Champtercier Cravatte Count Old Man Napoleon Valjean Labarre Marguerite Mme . de R Isabeau Gervais Fantine Mme . Thenardier Thenardier Cosette Javert Fauchelevent Bamatabois Simplice ScaufflaireWoman 1 Judge Champmathieu Brevet Chenildieu Cochepaille Woman 2 Mother Innocent Gavroche Mlle . Gillenormand Marius Enjolras Bossuet Gueulemer Babet Claquesous Montparnasse Toussaint Tholomyes Listolier Fameuil Blacheville Favourite Dahlia Zephine Perpetue Anzelma Magnon PontmercyEponine Boulatruelle Brujon Lt . GillenormandGillenormand Gribier Mme . Pontmercy Mabeuf Courfeyrac Jondrette Mme . Burgon Combeferre Prouvaire Feuilly Bahorel Joly Grantaire Child 1 Child 2 Mme . Hucheloup Baroness T Mlle . Vaubois Mother Plutarch FIG . 12 : The network ofinteractions between m ajor characters in the novel Les M is(cid:19)erables by V ictor H ugo . The greatest m odularity achieved in theshortest - path version ofouralgorithm is Q = 0 : 54 and correspondstothe11com m unitiesrepresented by the colors . that our algorithm s can reliably and sensitively extract com m unity structurefrom arti(cid:12)cially generated networks with known com m unities . W e have also applied them to real - world networkswith known com m unity structure and again they extractthatstructure withoutdi(cid:14)culty . And we have given exam plesofhow ouralgorithm scan beused to analyzenetworkswhosestructureisotherwise di(cid:14)cultto com prehend . The networksstudied include a collaboration network ofscientists , in which ourm ethods allow us to generate schem atic depictions ofthe overall structure ofthe network and collaborationstaking place within and between com m unities , other socialnetworks ofpeopleand ofanim als , and a network oflinksbetween pageson a corporate web site . The prim ary rem aining di(cid:14)culty with our algorithm s istherelatively high com putationaldem andsthey m ake . The fastestofthem , the one based on shortest - path be - tweenness , operates in O ( n 3 ) tim e on a sparse graph , which m akes it usable for networks up to about 10000 vertices , but for larger system s it becom es intractable . Although theever - im provingspeed ofcom puterswillcer - tainly raise thislim itin com ing years , itwould be m ore satisfactory ifa fasterversion ofthem ethod could bedis - covered . O ne possibility is parallelization : the between - ness calculation involvesa sum oversource verticesand theelem entsofthatsum can bedistributed overdi(cid:11)erent processors , m aking thecalculation trivially parallelizable on a distributed - m em ory m achine . However , a better approach would be to (cid:12)nd som e im provem entin the al - gorithm itselfto decrease itscom putationalcom plexity . Since the publication of our (cid:12)rst paper on this topic [ 25 ] , severalother authors have m ade use of the shortest - path version ofouralgorithm . Holm e etal . [ 42 ] have applied it to a num ber ofm etabolic networks for di(cid:11)erentorganism s , (cid:12)nding com m unitiesthatcorrespond to functionalunitswithin the networks , while W ilkinson and Huberm an [ 43 ] have applied it to a network ofre - lations between genes , as established by co - occurrence ofnam es ofgenes in published research articles . An in - teresting application to socialnetworks is the study by G leiser and D anon [ 44 ] ofthe collaboration network of early jazz m usicians . They found , am ong other things , thatthenetworksplitintotwocom m unitiesalonglinesof race , blackm usiciansin onegroup , whitem usiciansin the other . G uim er(cid:18)a etal . [ 45 ] have applied the m ethod to a networkofem ailm essagespassingbetween usersatauni - versity , and found com m unities that re(cid:13)ect both form al and inform allevelsoforganization . Tyler etal . [ 46 ] have 15 FIG . 13 : Pages on a web site and the hyperlinks between them . The colors denote the optim aldivision into com m uni - tiesfound by the shortest - path version ofouralgorithm . also applied the algorithm to an em ailnetwork , in their case ata large com pany , (cid:12)nding thatthe resulting com - m unitiescorrespond closely to organizationalunits . The latterwork isinterestingalsoin thatitsuggestsam ethod forim provingthespeed ofthealgorithm : Tyler etal . cal - culate betweenness for only a subset , random ly chosen , of possible source vertices in the network , rather than sum m ing over allsources . The size ofthe subset is de - cided on the (cid:13)y , by sam pling source vertices untilthe betweennessofatleastone edge in the network exceeds a predeterm ined threshold . This technique reduces the running tim e of the calculation considerably , although the resulting estim ate ofbetweenness necessarily su(cid:11)ers from thestatistical(cid:13)uctuationsinherentin random sam - pling m ethods . This idea , or a variation of it , m ight provide a solution to the problem s m entioned above of the high com putationaldem andsofouralgorithm s . W e areofcoursedelighted to see ourm ethodsapplied to such a variety ofproblem s . Com bined with the new algorithm sand m easuresdescribed in thispaper , wehope to see m any m ore applicationsin the future . A cknow ledgm ents The authors thank Steven Borgatti , Ulrik Brandes , Linton Freem an , D avid Lusseau , M ason Porter , and D ouglas W hite for useful com m ents . Thanks also to O liver Boisseau , Patti Haase , D avid Lusseau , and K arsten Schneiderforproviding the data forthe dolphin network and to D ouglasW hite forthe karate club data . This work was funded in part by the NationalScience Foundation under grant num ber D M S { 0234188 and by the Santa Fe Institute . [ 1 ] S . H . Strogatz , Exploring com plex networks . Nature 410 , 268 { 276 ( 2001 ) . [ 2 ] R . A lbert and A . - L . Barab(cid:19)asi , Statisticalm echanics of com plex networks . Rev . M od . Phys . 74 , 47 { 97 ( 2002 ) . [ 3 ] S . N . D orogovtsev and J . F . F . M endes , Evolution ofNet - works : From BiologicalNets to the Internetand W W W . O xford U niversity Press , O xford ( 2003 ) . [ 4 ] M . E . J . N ewm an , Thestructureand function ofcom plex networks . SIAM Review 45 , 167 { 256 ( 2003 ) . [ 5 ] M . Faloutsos , P . Faloutsos , and C . Faloutsos , O n power - law relationships of the internet topology . Com puter Com m unications Review 29 , 251 { 262 ( 1999 ) . [ 6 ] R . A lbert , H . Jeong , and A . - L . Barab(cid:19)asi , D iam eterofthe world - wide web . Nature 401 , 130 { 131 ( 1999 ) . [ 7 ] A . Broder , R . K um ar , F . M aghoul , P . Raghavan , S . Ra - jagopalan , R . Stata , A . Tom kins , and J . W iener , G raph structure in the web . Com puter Networks 33 , 309 { 320 ( 2000 ) . [ 8 ] A . K leczkowskiand B . T . G renfell , M ean - (cid:12)eld - typeequa - tions for spread ofepidem ics : The ‘sm allworld’m odel . Physica A 274 , 355 { 360 ( 1999 ) . [ 9 ] C . M oore and M . E . J . N ewm an , Epidem ics and perco - lation in sm all - world networks . Phys . Rev . E 61 , 5678 { 5682 ( 2000 ) . [ 10 ] R . Pastor - Satorrasand A . Vespignani , Epidem ic spread - ingin scale - freenetworks . Phys . Rev . Lett . 86 , 3200 { 3203 ( 2001 ) . [ 11 ] R . M . M ay and A . L . Lloyd , Infection dynam icson scale - free networks . Phys . Rev . E 64 , 066112 ( 2001 ) . [ 12 ] S . Redner , H ow popular is your paper ? A n em pirical study of the citation distribution . Eur . Phys . J . B 4 , 131 { 134 ( 1998 ) . [ 13 ] M . E . J . N ewm an , The structure ofscienti(cid:12)c collabora - tion networks . Proc . Natl . Acad . Sci . USA 98 , 404 { 409 ( 2001 ) . [ 14 ] H . Jeong , B . Tom bor , R . A lbert , Z . N . O ltvai , and A . - L . Barab(cid:19)asi , The large - scale organization of m etabolic networks . Nature 407 , 651 { 654 ( 2000 ) . [ 15 ] A . W agner and D . Fell , The sm all world inside large m etabolic networks . Proc . R . Soc . London B 268 , 1803 { 1810 ( 2001 ) . [ 16 ] J . A . D unne , R . J . W illiam s , and N . D . M artinez , Food - web structure and network theory : The role of con - nectanceand size . Proc . Natl . Acad . Sci . USA 99 , 12917 { 12922 ( 2002 ) . [ 17 ] J . Cam acho , R . G uim er(cid:18)a , and L . A . N . A m aral , Ro - bustpatternsin food web structure . Phys . Rev . Lett . 88 , 228102 ( 2002 ) . [ 18 ] M . R . G arey and D . S . Johnson , Com puters and In - tractability : A G uide to the Theory ofNP - Com pleteness . W . H . Freem an , San Francisco ( 1979 ) . [ 19 ] J . Scott , Social Network Analysis : A Handbook . Sage Publications , London , 2nd edition ( 2000 ) . [ 20 ] B . W . K ernighan and S . Lin , A e(cid:14)cientheuristic proce - 16 dureforpartitioning graphs . BellSystem TechnicalJour - nal 49 , 291 { 307 ( 1970 ) . [ 21 ] D . J . W atts and S . H . Strogatz , Collective dynam ics of ‘sm all - world’networks . Nature 393 , 440 { 442 ( 1998 ) . [ 22 ] L . A . N . A m aral , A . Scala , M . Barth(cid:19)el(cid:19)em y , and H . E . Stanley , Classes of sm all - world networks . Proc . Natl . Acad . Sci . USA 97 , 11149 { 11152 ( 2000 ) . [ 23 ] M . M archiori and V . Latora , H arm ony in the sm all - world . Physica A 285 , 539 { 546 ( 2000 ) . [ 24 ] R . L . Breiger , S . A . Boorm an , and P . A rabie , A n al - gorithm for clustering relations data with applications to socialnetwork analysis and com parison with m ultidi - m ensionalscaling . Journalof M athem atical Psychology 12 , 328 { 383 ( 1975 ) . [ 25 ] M . G irvan and M . E . J . N ewm an , Com m unity structure in socialand biologicalnetworks . Proc . Natl . Acad . Sci . USA 99 , 7821 { 7826 ( 2002 ) . [ 26 ] J . M . A nthonisse , The rush in a directed graph . Techni - calReport BN 9 / 71 , Stichting M athem aticsh Centrum , A m sterdam ( 1971 ) . [ 27 ] L . Freem an , A set ofm easures ofcentrality based upon betweenness . Sociom etry 40 , 35 { 41 ( 1977 ) . [ 28 ] R . K . A huja , T . L . M agnanti , and J . B . O rlin , Network Flows : Theory , Algorithm s , and Applications . Prentice H all , U pperSaddle River , N ew Jersey ( 1993 ) . [ 29 ] T . H . Corm en , C . E . Leiserson , R . L . Rivest , and C . Stein , Introduction to Algorithm s . M IT Press , Cam bridge , M A , 2nd edition ( 2001 ) . [ 30 ] M . E . J . N ewm an , Scienti(cid:12)c collaboration networks : II . Shortestpaths , weighted networks , and centrality . Phys . Rev . E 64 , 016132 ( 2001 ) . [ 31 ] U . Brandes , A faster algorithm for betweenness cen - trality . Journalof M athem aticalSociology 25 , 163 { 177 ( 2001 ) . [ 32 ] K . - I . G oh , B . K ahng , and D . K im , U niversalbehaviorof load distribution in scale - free networks . Phys . Rev . Lett . 87 , 278701 ( 2001 ) . [ 33 ] M . E . J . N ewm an , M ixing patterns in networks . Phys . Rev . E 67 , 026126 ( 2003 ) . [ 34 ] B . Efron , Com putersand thetheory ofstatistics : Think - ing the unthinkable . SIAM Review 21 , 460 { 480 ( 1979 ) . [ 35 ] W . W . Zachary , A n inform ation (cid:13)ow m odelfor con(cid:13)ict and (cid:12)ssion in sm allgroups . Journalof Anthropological Research 33 , 452 { 473 ( 1977 ) . [ 36 ] J . Park and M . E . J . N ewm an , The origin ofdegree cor - relations in the Internet and other networks . Preprint cond - m at / 0303327 ( 2003 ) . [ 37 ] D . Lusseau , The em ergent properties of a dolphin so - cial network . Biology Letters , Proc . R . Soc . London B ( suppl . ) ( 2003 ) . D O I10 . 1098 / rsbl . 2003 . 0057 . [ 38 ] D . Lusseau , K . Schneider , O . J . Boisseau , P . H aase , E . Slooten , and S . M . D awson , The bottlenose dolphin com m unity ofD oubtfulSound features a large propor - tion of long - lasting associations . Can geographic isola - tion explain this unique trait ? BehavioralEcology and Sociobiology ( 2003 ) . D O I10 . 1007 / s00265 - 003 - 0651 - y . [ 39 ] D . E . K nuth , The Stanford G raphBase : A Platform forCom binatorialCom puting . A ddison - W esley , Reading , M A ( 1993 ) . [ 40 ] G . W . Flake , S . R . Lawrence , C . L . G iles , and F . M . Co - etzee , Self - organization and identi(cid:12)cation ofW eb com - m unities . IEEE Com puter 35 , 66 { 71 ( 2002 ) . [ 41 ] L . A . A dam icand E . A dar , Friendsand neighborson the W eb . SocialNetworks 25 , 211 { 230 ( 2003 ) . [ 42 ] P . H olm e , M . H uss , and H . Jeong , Subnetwork hierar - chies ofbiochem icalpathways . Bioinform atics 19 , 532 { 538 ( 2003 ) . [ 43 ] D . W ilkinson and B . A . H uberm an , Findingcom m unities ofrelated genes . Preprintcond - m at / 0210147 ( 2002 ) . [ 44 ] P . G leiser and L . D anon , Com m unity structure in jazz . Preprintcond - m at / 0307434 ( 2003 ) . [ 45 ] R . G uim er(cid:18)a , L . D anon , A . D(cid:19)(cid:16)az - G uilera , F . G iralt , and A . A renas , Self - sim ilarcom m unity structurein organisa - tions . Preprintcond - m at / 0211498 ( 2002 ) . [ 46 ] J . R . Tyler , D . M . W ilkinson , and B . A . H uber - m an , Em ail as spectroscopy : A utom ated discovery of com m unity structure within organizations . Preprint cond - m at / 0303264 ( 2003 ) . [ 47 ] Following the publication of that paper , the algorithm has been im plem ented in the com - m ercial network analysis software package U CInet and in the open - source network library JU N G . ( See http : / / www . analytictech . com / and http : / / jung . sourceforge . net / respectively . ) [ 48 ] In fact we have tried counting each traversalseparately , butthism ethod givesextrem ely poorresults , con(cid:12)rm ing ourintuition thatthiswould notbe a good betweenness m easure . [ 49 ] A sdiscussed in [ 33 ] , itiscrucialto m ake sure each edge is counted only once in the m atrix e ij | the sam e edge should not appear both above and below the diagonal . A lternatively , an edge linking com m unities i and j can be split , half - and - half , between the ij and ji elem ents , which hasthe advantage ofm aking the m atrix sym m et - ric . Either way , there are a num ber of factors of 2 in the calculation thatm ustbe watched carefully , lestthey escape one’sattention and m ake m ischief . [ 50 ] In Ref . 33 , them easurewasnorm alized by dividing by its valueon anetwork with perfectm ixing , sothatwealways get1 forsuch a network . W e(cid:12)nd howeverthatdoing this in the presentcase m askssom e ofthe usefulinform ation to be gained from the value of Q , and hence that it is betterto use the unnorm alized m easure . In general , this unnorm alized m easure willnot reach a value of1 , even on a perfectly m ixed network . [ 51 ] Thegraph isoneofthetestgraphsfrom thegraph draw - ing com petition held in conjunction with theSym posium on G raph D rawing , Berkeley , California , Septem ber18 { 20 , 1996 .
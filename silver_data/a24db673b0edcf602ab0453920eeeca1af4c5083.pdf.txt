From evolution to folding of repeat proteins Ezequiel A . Galpern , 1 Jacopo Marchi , 2 , 3 Thierry Mora , 2 Aleksandra M . Walczak , 2 and Diego U . Ferreiro 1 1 Protein Physiology Lab , Universidad de Buenos Aires , Facultad de Ciencias Exactas y Naturales , Departamento de Qu´ımica Biol´ogica . Buenos Aires , Argentina . / CONICET - Universidad de Buenos Aires . Instituto de Qu´ımica Biol´ogica de la Facultad de Ciencias Exactas y Naturales ( IQUIBICEN ) . Buenos Aires , Argentina 2 Laboratoire de physique de l’´Ecole normale sup´erieure ( PSL University ) , CNRS , Sorbonne Universit´e , and Universit´e de Paris , 75005 Paris , France 3 Present adress : School of Biological Sciences , Georgia Institute of Technology , Atlanta , GA , USA and Institut de Biologie , ´Ecole Normale Sup´erieure , Paris , France Repeat proteins are made with tandem copies of similar amino acid stretches that fold into elongated architectures . Due to their symmetry , these proteins constitute excellent model systems to investigate how evolution relates to structure , folding and function . Here , we propose a scheme to map evolutionary information at the sequence level to a coarse - grained model for repeat - protein folding and use it to investigate the folding of thousands of repeat - proteins . We model the energetics by a combination of an inverse Potts model scheme with an explicit mechanistic model of duplications and deletions of repeats to calculate the evolutionary parameters of the system at single residue level . This is used to inform an Ising - like model that allows for the generation of folding curves , apparent domain emergence and occupation of intermediate states that are highly compatible with experimental data in speciﬁc case studies . We analyzed the folding of thousands of natural Ankyrin - repeat proteins and found that a multiplicity of folding mechanisms are possible . Fully cooperative all - or - none transition are obtained for arrays with enough sequence - similar elements and strong interactions between them , while non - cooperative element - by - element intermittent folding arose if the elements are dissimilar and the interactions between them are energetically weak . In between , we characterised nucleation - propagation and multi - domain folding mechanisms . Finally , we showed that stability and cooperativity of a repeat - array can be quantitatively predicted from a simple energy score , paving the way for guiding protein folding design with a co - evolutionary model . I . INTRODUCTION Robust folding and long - term evolution are two of the most basic aspects of natural protein molecules . These features are necessarily intertwined as the sequences we ﬁnd today are the result of selection of speciﬁc instances that , when folded , minimize the energetic conﬂicts be - tween their amino acids : they are overall ‘minimally frus - trated’ heteropolymers [ 1 ] . The energy landscape theory of protein folding recognizes these fundamental aspects and shows that the general topography of the energy landscape of globular domains is that of a rough funnel in which the native interactions are on average more favor - able than non - native ones . In accordance , the population of the folding routes can be reasonably well predicted with topological models of the native state [ 2 ] and , for most globular domains , local energetic diﬀerences rarely perturb the global aspects of the folding mechanisms [ 3 ] . This is not the typical situation in the case of repeat - proteins . Repeat - proteins are composed of tandem arrays of sim - ilar amino acid stretches . The repeats usually fold in re - cursive structural elements that pack against each other in a roughly periodic way , making the overall architec - ture of the arrays appear as elongated objects [ 4 ] . In these , folding domains are not easy to deﬁne and iden - tify as several , but not necessarily all , of the repetitions co - operate in the stabilization of structures [ 5 ] . Being quasi - one - dimensional , the folding of the complete array is dominated by the local energetics within each repeat and its local neighbors , making the folding sensitive to small perturbations that may lead to the break down of cooperativity and the appearance of stable intermedi - ates and sub - domains [ 5 ] . Notably , simple coarsed one - dimensional Ising - like models of repeat - protein have been found to be extremely useful for interpreting in - vitro ex - periments [ 6 ] . In general , the folding mechanisms are deﬁned by an initial nucleation in some region of the array and the propagation of structure to their neigh - bors . When the local energetics are similar along the assemblage , parallel folding routes can be identiﬁed [ 7 ] , and the routes can be switched by ( de ) stabilizing regions along the array [ 8 ] . Thus , the energy landscape of repeat - proteins appears ‘plastic’ and very amenable to design [ 9 ] . To which extent nature has exploited this opportunity is yet unknown . Besides single - point mutations , the evolution of repeat - proteins is thought to occur via duplications and dele - tions of large portions of primary structure , usually en - compassing one or more repeats [ 10 ] . These proteins are present in all taxa and are particularly abundant in eu - karyotes where they account for about 20 % of the coded proteins . Their activity is usually associated with spe - ciﬁc protein - protein interactions , with a versatility that can be equated to that of antibodies . In various cases , the detailed folding mechanism of the repeat - arrays have been identiﬁed to play a major role in their biological function [ 11 ] , but for most of the repeat - arrays it remains unknown . Here we aim to use evolutionary information a r X i v : 2202 . 12223v1 [ q - b i o . B M ] 2 4 F e b 2022 2 from repeat - protein systems to investigate the folding mechanisms of thousands of natural repeat - arrays . We will make use of Ankyrin - repeat proteins as this is one of the most abundant families and their folding mecha - nism can be well approximated with simple folding mod - els [ 12 ] . We hypothesize that the local energetics can be estimated with a maximum entropy model for the natural sequence statistics that result in a pair - wise Potts model for amino acid interactions [ 13 ] . We map the energetics of the sequences to an Ising - model with one free - parameter that we ﬁt with experimental folding data . The resulting model is then applied to thousands of diﬀerent sequences that fold to the same overall topology , revealing distinct folding routes , the emergence of sub - domains , downhill scenarios , etc , in a variegated zoo of folding mechanisms . We found that the overall folding behavior of a complete repeat - array can be well described with few global de - scriptors that can be directly calculated solely from se - quence information . A . Model Deﬁnition We considered a repeat - protein as a tandem array of consecutive folding elements , each of which can be either folded ( F ) or unfolded ( U ) . Each element corresponds to a group of consecutive amino - acids whose behaviour are considered together as one spin variable . The most simple assignment is to match a whole repeat with one spin , but the model can be generalised considering repeat sub - units consistently . Speciﬁc interactions take place between neighbour elements if both are folded . There - fore , the system can be represented by a ﬁnite quasi - one - dimensional folding Ising model with N elements where the energy of a coarse - grained conﬁguration , the Hamil - tonian , is given by the free energy of the corresponding ensemble of microstates H = − N (cid:88) j = 1 [ Ts j δ j , U + (cid:15) ij δ j , F ] − N − 1 (cid:88) j = 1 (cid:88) k > j (cid:15) sjk δ j , F δ k , F , ( 1 ) where δ j , U is the Kronecker symbol , taking value 1 if element j is unfolded and 0 otherwise . Hence , if j is un - folded there is an explicit contribution to the free energy given by the entropy s j of the available spatial conﬁgu - rations of the element , and we take the contributions to the internal energy to be zero . If the element is folded ( δ j , F = 1 and δ j , U = 0 ) we approximate the native state to be compact enough , hence there is no intrinsic entropy contribution , but an internal energy (cid:15) ij is assigned . Two elements interact with a surface energy (cid:15) sjk only if both are folded . A similar coarse - grained repeat - protein Ising model has been exhaustively studied using arbitrary parameters and compared to molecular dynamics simulations for the TPR family [ 14 ] . Here , we consider that the internal and surface energy parameters are functions of the amino - acid sequence . Focusing on Ankyrins , a single family in which a native repeated structure is roughly conserved [ 15 ] , we hypothesise that sequence variation within repeat units is linked to changes in local stability . Hence , in order to calculate (cid:15) ij (cid:15) sjk for a sequence , we used co - evolutionary ﬁelds that have been inferred for the Ankyrin family us - ing a combination of a Direct Coupling Analysis ( DCA ) and an explicit mechanistic evolution scheme of whole repeats duplications and deletions ( details in Support - ing Information ) . Given a sequence , the evolutionary statistical function ( often called energy ) is given by a Potts model . The Hamiltonian is translational invariant and , for example , for a sequence σ with two repeats of L residues it can be written as E ( σ ) = − 2 L (cid:88) a = 1 ˜ h a ( σ a ) − 2 L (cid:88) a , b = 1 ˜ J ab ( σ a , σ b ) . ( 2 ) This kind of inferred statistical energies have been re - ported to predict some ﬁtness eﬀect or global stability change given by point mutations [ 13 , 16 – 18 ] . Indeed , we compared the experimental folding energy diﬀerence be - tween mutants and wild type ( ∆∆ G ) available in the lit - erature for natural proteins of the Ankyrin family [ 8 , 19 – 24 ] and we compute ∆ E for the same mutants of three ANK proteins , ﬁnding a linear trend ( Fig . S7 , R 2 (cid:39) 0 . 6 ) . More details are provided in Supplementary Methods . If we assume that there is no entropy diﬀerence between point mutants , the coarse - grained folding energy of frag - ments can be calculated simply by locally applying evo - lutionary ﬁelds ˜ h a and ˜ J ab to a sequence σ and re - scaling properly . We deﬁne (cid:15) ij and (cid:15) sjk as explicit functions of σ j and σ k , the sequences of the folding elements j and k (cid:15) ij = (cid:15) i ( σ j ) = 1 α (cid:34) (cid:88) a ∈ j ˜ h a ( σ a ) + (cid:88) a , b ∈ j ˜ J ab ( σ a , σ b ) (cid:35) ( 3a ) (cid:15) sjk = (cid:15) s ( σ j , σ k ) = 1 α (cid:34) (cid:88) a ∈ j b ∈ k ˜ J ab ( σ a , σ b ) (cid:35) ( 3b ) where a ∈ j means the sequence position a is in the folding element j and α = − 1 . 3 is the ﬁtted slope in Fig . S7 . In this model , the internal folding energy is zero for a random sequence and is maximum for the most evolutionary favourable one . We present p16 protein as a example of the model deﬁnitions in Fig . 1A . We choose the folding elements to be the sequence of each alpha - helix in the typical Ankyrin repeat structure as it was done previously [ 25 ] . As in the evolution model ( Eq . 2 ) interactions were al - lowed between residues within a repeat and between ﬁrst neighbour repeats , each helix in the folding model ( Eq . 1 ) interacts with the other one in the same repeat and with the next two . Co - evolutionary ﬁelds applied to a sequence are represented ( ˜ J ab ( σ a , σ b ) as a matrix and ˜ h a ( σ a ) on its diagonal ) in Fig . 1B , highlighting evolu - tionary favourable or unfavourable residues and pairs of 3 1 2 3 4 5 6 7 8 Folding element 1 2 3 4 5 6 7 8 F o l d i n g e l e m e n t 1 19 34 52 67 85 100 118 133 Amino - acid sequence position 1 19 34 52 67 85 100 118 133 A m i n o - a c i d s e q u e n c e p o s i t i o n 2 1 0 1 2 E v o l u t i o n a r y E n e r g y 20 10 0 10 20 I s i n g E n e r g y A 1 2 3 4 5 6 7 8 1 ( 5 ) 19 34 ( 38 ) 52 67 ( 71 ) 85 100 ( 104 ) 118 ( 137 ) not included ( 1 ) not included B FIG . 1 . Model deﬁnition . A . Folding elements are 18 and 15 - residues repeat subunits as highlighted on the p16 sequence . They respectively correspond to ﬁrst and second alpha - helix of each repeat as coloured on the PDB structure . B . Double energy heat - map for p16 . Evolutionary residue pairwise coup´lings ˜ J ab ( σ a , σ b ) on the upper side and single residue contributions ˜ h a ( σ a ) on the diagonal were added according to folding elements and re - scaled to deﬁne Ising energies (cid:15) i ( σ j ) and (cid:15) s ( σ j , σ k ) on the lower side . Blue ( red ) dots represent evolutionary ( un ) favourable pairs and positions . On the lower side , almost all internal and interaction folding energies are favourable , hence are blue . residues . In this case , as in general , the partial sums of these contributions gives almost all favourable folding energy terms ( Eq . 3 ) . The scheme we propose leaves the intrinsic conﬁgura - tional entropy s j undeﬁned . We simpliﬁed its deﬁnition taking s j to be independent of amino - acid identity , there - fore for an element j with L j residues s j = L j s . Hence the single free parameter of the model is s , an average residue contribution to the eﬀective number of conﬁgu - rations that a folding element polymer can access when unfolded . B . Case studies We ran Monte - Carlo simulations for a well studied four - repeat ANK protein , the CDK4 / CDK6 inhibitor p16 . The fraction of folded elements as a function of temperature was compatible with experimental Circular Dichroism ( CD ) signal obtained from the literature [ 20 ] ( Fig . 2A ) . For the same entropy per residue s , the eﬀect of a point mutation in the unfolding curve was precisely reproduced ( Fig . S9 ) . Nevertheless , at low temperature T ( 190 - 250K ) simulated curves showed also a lees coop - erative pre - transition . In the main transition , not all the elements fold to - gether . Analysing the folding temperatures for each el - ement , we found that elements 4 to 7 actually behave collectively in what we deﬁne as an apparent folding do - main . Fig . 2C - D shows that the ﬁrst domain to fold ( the nucleus ) is closely followed by element 2 ( a single - element domain ) . Interestingly , element 3 that behaves separately presenting low stability , correspond to the ﬁrst half of the second repeat , which have been found by NMR to fold as a turn instead of a helix [ 26 , 27 ] . Consistently , molecular dynamics simulations have shown in this re - gion signiﬁcant ﬂuctuations in the folded state and it is believed to be functionally relevant for binding [ 28 ] . First and last helices also presented low folding temperatures . In addition to the border eﬀect , we remark that the evo - lutionary model was learned from internal repeats , be - cause terminal ones were considered diﬀerent biological objects that can present modiﬁcations in sequence when compared to internal repeats [ 15 , 29 ] . An approximate free energy proﬁle ∆ f ( Q ) , where Q is the number of folded elements , highlights a nucleation - propagation mechanism ( Fig . 2B ) . The nucleation of el - ements 4 to 7 is an all - or - none transition from Q = 0 to Q = 4 with a free energy barrier in between . Structure then propagates visiting every remaining Q one by one as temperature is lowered . As a measure of cooperativ - ity , we deﬁned a score ρ = Q barrier / ( N − 1 ) = 3 / 7 , the fraction of intermediary Q that were not a minimum of ∆ f ( Q ) for any T in a protein with N elements . In addition to p16 , we performed similar analyses on other natural ANK - containing proteins with available ex - perimental folding data . We ﬁt s to reproduce the re - versible CD thermal unfolding curves of TRPV4 [ 30 ] , 4 200 250 300 350 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 F o l d e d f r a c t i o n simulation experimental data 0 1 2 3 4 5 6 7 8 Folded elements ( Q ) 0 2 4 6 f 200 225 250 275 300 325 350 T e m p e r a t u r e 1 2 3 4 5 6 7 8 element 1 2 3 4 5 6 7 8 e l e m e n t A B C D FIG . 2 . Simulation results for p16 . A . Simulated ( black ) and experimental ( red ) thermal unfolding curves . B . Approx - imate free energy proﬁles , coloured by temperature ( same of C and D ) , with the number of folded elements Q as reaction coordinate . There is an all - or - none transition from Q = 0 to Q = 4 with a barrier in between , then the minimum moves without any barrier . C . PDB structure is coloured according to the folding temperature of each element . Purple fragments are the most unstable ones . D . Apparent domain matrix , coloured by domain folding temperatures . First domain to fold ( elements 4 to 7 ) correspond to the all - or - none transition described in B , consistently with a nucleation - propagation mechanism . TANC1 [ 31 ] and Kidney ANK 1 [ 32 ] ﬁnding optimal val - ues in the range between 4 . 2 and 6 . 2 cal mol − 1 K − 1 res − 1 ( including p16 , Fig . S8 ) . This interval is consistent with the calculations made by Baxa et al ( 4 . 3 cal mol − 1 K − 1 res − 1 for a 18AA fragment ) [ 33 ] , it overlaps with the range estimated by D’Aquino et al ( 3 . 6 to 10 . 5 cal mol − 1 K − 1 res − 1 ) [ 34 ] and it is lower than Makhatazde and Pri - valov proposal ( ∼ 11 cal mol − 1 K − 1 res − 1 ) [ 35 ] . Given the range we obtained from experimental data ﬁts , we set s = 5 cal mol − 1 K − 1 res − 1 from here on , allowing us to perform simulations where thermal unfolding data is unavailable . Consistently with reported folding dynamics [ 36 – 38 ] , our analysis on I κ B α ( Fig . S4 ) and Drosophila melan - gaster Notch Receptor ( Fig . S5 ) allowed us to precisely identify highly cooperative domains where folding starts and distinguish them from less stable , folding - on - binding or ﬂexible regions . On the other hand , the description of the AnkyrinR D34 24 - elements fragment unfolding via a stable intermediate with an unstructured half [ 39 ] was not reproduced ( Fig . S6 ) . A detailed analysis of these cases is provided in Supplementary case studies . Although trained on natural sequences , the model can also be applied on Designed Ankyrin Repeat proteins ( DARPins ) . Reported experimental thermal unfolding CD - signal was compatible with simulation results in two 4 - repeat sequences , but 3 - repeat DARPins curves were not as close to the experimental ones for the same s ( Fig . S9E - F ) . For a library of 100 DARPins generated using Pl¨uckthun’s framework [ 40 ] we found that stability in - creased with repeat - array length ( Fig . S10 ) , consistently with previous reports [ 41 ] . C . General results To evaluate the folding of thousands of repeat - proteins , we applied the model on a selected subset with 4020 nat - ural sequences formed with 4 to 36 repeats ( 8 to 72 ele - ments ) with no insertions or deletions . For each of these , we computed the thermal unfolding curves , the appar - ent domains and approximate free energy proﬁles and we found a large variety of folding behaviours . The data set included short proteins with strictly two - state transitions and a single domain as A2F665 ( Fig . 3A , ρ = 1 ) and oth - ers like M2SQG1 ( B ) which presented a downhill folding without any free energy barrier ( ρ = 0 ) . As protein size increases , we found multi - domain examples ( C - D ) , where several nucleations and propagations appeared . Large 46 - element H3DQ55 ( D ) presented a step - like folding , with wide stability gaps between large domain - like all - or - none transitions . Terminal repeats distinct behaviour is widespread along the data set , being more relevant in short proteins where its eﬀect can represent up to 50 % of the fraction folded than in longer ones . There is no characteristic size for the folding domains that emerges . The proteins spontaneously fold on av - erage 5 . 5 apparent folding domains , with a minor shift in the distribution when their full length is considered ( Fig . 4 A ) . Hence , domain size grows with protein size and on average each domain covers 12 % of the tandem array : while short proteins with 8 folding elements on av - erage present less than 2 - element domains , a long array with more than 40 folding elements typically presents 10 - element domains . If we consider for each protein only the ﬁrst domain to fold ( the nucleus ) , the trend with array size becomes stronger . The nucleus domain represents on average 48 % of the sequence ( Fig . 4 B ) . Also , short do - mains present a wide range of folding temperatures , while longer ones ( with 5 or more elements ) show more stabil - ity . The nucleus domains had also a roughly exponential dependence with size , but mostly fold at physiological or higher temperatures ( Fig . S11 ) . Protein folding temperature T f and cooperativity score ρ did not correlate with each other ( Fig . S12 ) , suggest - ing the complexity of the system requires at least these two parameters to deﬁne the folding dynamics . Never - theless , conditioning on array length reveals that there is a region of high cooperativity and stability where long arrays are more concentrated ( Fig . S13 ) . Interestingly , it has been showed that these large repeat - proteins are naturally formed with similar and energetically favorable elements [ 29 ] . Ankyrin domain proteins are reported to play a va - riety of biological activities . We scanned all the Gene Ontology annotations with experimental evidence on the 5 200 300 Temperature 0 . 0 0 . 5 1 . 0 F o l d e d f r a c t i o n A2F665 ( 178 - 309 ) 200 300 400 Temperature 0 . 0 0 . 5 1 . 0 M2SQG1 ( 582 - 713 ) 200 300 400 Temperature 0 . 0 0 . 5 1 . 0 A0A1J5R2Q9 ( 55 - 318 ) 200 400 600 Temperature 0 . 0 0 . 5 1 . 0 H3DQ55 ( 50 - 808 ) 1 2 3 4 5 6 7 8 element 12345678 e l e m e n t 1 2 3 4 5 6 7 8 element 12345678 1 5 9 13 element 1 5 9 13 1 13 25 37 element 1 13 25 37 0 5 Folded elements ( Q ) 0 5 f 0 5 Folded elements ( Q ) 0 5 0 10 Folded elements ( Q ) 0 5 0 20 40 Folded elements ( Q ) 0 5 10 250 300 350 200 300 400 200 300 400 200 400 T e m p e r a t u r e D C B A FIG . 3 . Diﬀerent folding mechanisms . Thermal unfolding curves ( top ) , apparent domain matrix and temperature scale ( middle ) and approximate free energy proﬁles ( bottom ) for four proteins . We identiﬁed each sequence with the UniProt [ ref ] code and the position range of the ANK repeat - array . A . A2F665 ( 178 - 309 ) had a highly cooperative two - state transition and a single domain . B . M2SQG1 ( 582 - 713 ) did not presented any free - energy barrier , but elements unfold one by one uncooperatively . C . 8 - repeat ( 16 folding elements ) A0A1J5R2Q9 ( 55 - 318 ) presented many domains of diﬀerent sizes and an unfolding curve with pre and post - transitions . D . H3DQ55 ( 50 - 808 ) is a long protein of 46 folding elements that folds in 3 steps . full dataset proteins and compute for the corresponding sequences T f and ρ , but we did not ﬁnd any clear rela - tion between them and molecular function ( Fig . S14 ) . Thus , the annotated function in the Gene Ontology is not a simple emergent of the folding properties of the sequences . D . Model interpretation How exactly are stability and cooperativity related to sequence statistics ? On one hand , protein T f estima - tions were highly correlated with length - normalized co - evolutionary energy of the respective sequences Fig 5A . This general mapping between stability and global evo - lutionary statistical energy was an expected output of the model , given the deﬁnitions of Eq . 3 and it is con - sistent with experimental results for other protein fam - ilies [ 42 ] . On the other hand , cooperativity has a more complex dependence with co - evolutionary energy . For a given protein , if diﬀerences between folding Ising inter - nal energies (cid:15) i j of interacting elements ( normalising by element length ) were compensated by the correspond - ing surface energies (cid:15) sjk , elements can fold cooperatively in an all - or - none transition . This would be the case of a full consensus protein with exactly duplicated re - peats . But complexity arises because this is not the case for natural proteins , as one can see in Fig . 5B . Each point corresponds to a sequence of the selected set on a plane deﬁned by the average normalized internal en - ergy diﬀerence (cid:104) | e ij − e ik | (cid:105) and the average non - zero nor - malized surface energies −(cid:104) e s (cid:105) , while the cooperativity score ρ is represented by the color scale . Cooperativity smoothly changed from two - state proteins with strong surface terms and low heterogeneity to full downhill pro - teins on the opposite corner of the plot . In the cen - tral region , sequences could present for instance a sharp transition and a pretransition as p16 and or many barri - ers and intermediaries . We ﬁtted a polynomial function of the energetic heterogeneity (cid:104) | e ij − e ik | (cid:105) and interaction average (cid:104) e s (cid:105) to deﬁne a phase diagram ( Fig 5B ) and to predict cooperativity ρ directly from the amino - acid se - quence . The evolutionary model can be used to generate se - quence ensembles with a Monte - Carlo run , such that they reproduced natural ANK data set features ( details in Supporting Information ) . For a generated ensemble of 4000 sequences with the same protein length distribution of the selected set , T f and ρ trends with energy roughly held ( Fig . S15 ) . Hence , it is possible to generate a large ensemble of sequences and then select a subset with the desirable cooperativity and stability , without computing the Ising model . 6 0 5 10 15 20 # Domains per array 0 . 00 0 . 05 0 . 10 0 . 15 D e n s i t y Array size 8 - 10 11 - 20 21 - 72 0 20 40 60 80 Array size 0 20 40 60 A v e r a g e d o m a i n s i z e All m = 0 . 12 1st to fold m = 0 . 48 A B FIG . 4 . Domain statistics . A . Domain count per array histogram for short ( blue ) , intermediate ( orange ) and long ( green ) arrays . B . Average domain size as a function of array size for all ( black ) and only for the ﬁrst domain to fold ( red ) . Error bars are the standard errors . Linear ﬁt slopes m repre - sented the average fraction of the array covered by a domain , which were 48 % for the ﬁrst to fold and 12 % for all . II . CONCLUDING REMARKS Although superﬁcially simple , the energy landscapes of repeat - proteins show very rich behaviors . We ex - plored here the folding of thousands of naturally occur - ring Ankyrin - repeat proteins and found that a multi - plicity of mechanisms can be coded in sequences with a common low - temperature fold . On the one hand , fully cooperative all - or - none transition is obtained when the proteins are composed by sequence - similar elements and strong interactions between them . On the other hand , non - cooperative element - by - element intermittent folding becomes the rule when the elements are dissimilar and the interactions between them are energetically weak . In between these extremes , cooperative folding domains may emerge . Along the dataset 73 % of elements folds to - gether with another ones , forming an apparent domain . Notably , we found that there is not a characteristic do - main size , but we observe a scale - free domain formation . Particularly , the ﬁrst domain to emerge covers about half of the repeat - array , and the rest of the chain folds upon it . We propose that the overall behaviour of the pro - teins can be projected in two dimensions that capture the cooperativity and the stability of the arrays . Using purely evolutionary information it is possible to predict the thermodynamics of these systems , beyond the eﬀect of single amino acid substitutions , but the truly collec - tive phenomena of protein folding . Strikingly , there are no examples of natural proteins for which the sequence heterogeneity is high and the interactions between them are strong . This eﬀect can be attributed to the internal structure of the learned evolutionary ﬁeld , as simulated sequences show the same distributions . Moreover , the variegated folding mechanisms is also obtained with sim - ulated sequences , which in principle can be used to design proteins with desired folding properties and mechanical functions , for example in their nano - spring behavior [ 43 ] . The biological function of most Ankyrin - repeat arrays is thought to be mediated by speciﬁc protein - protein in - teractions and for many of them the folding of repeats is coupled to the binding of their targets . We identiﬁed examples for which the calculations match the known ex - perimental region that undergoes transitions . We specu - late that the rich folding behavior we identiﬁed here can be related to the biological function of these proteins , for example in the identiﬁcation of the regions that undergo transitions at low temperatures as binding or allosteric regions . Despite the recent interest on the success of structure prediction tools [ 44 ] we should bear in mind that the dynamics of natural proteins is fundamental to their bio - logical activity and evolution . The occupation of excited states on the energy landscapes is crucial in determining the interactions that proteins juggle in the crowded inte - rior of cells . We presented here a way to model these dy - namics solely from sequence information , that may well be applied to other types of proteins . III . METHODS A . Sequence data curation We used subsets of a 1 . 2 million Ankyrin repeat se - quences alignment , previously built and characterised [ 29 ] . More details are provided in Supplementary meth - ods . B . Evolutionary model for repeat arrays We used the evolutionary energy ﬁelds learned with a statistical model from an ANK multiple sequence align - ment ( MSA ) , which included internal but not terminal repeats from the same full dataset previously described III A and arrays up to 40 repeats long . Brieﬂy , the model combines Direct Coupling Analysis ( DCA ) and an ex - plicit evolution mechanism of duplications and deletions of repeats . Maximum entropy model uses as constraints empirical MSA single site and 2 - point amino - acid fre - quencies , pairwise repeat identity and array length dis - tribution . Statistical inference was made with a Boltz - mann Learning algorithm , obtaining energy ﬁelds ˜ h a ( σ a ) 7 100 80 60 40 Normalized energy 0 100 200 300 400 500 T f ( f i t ) R 2 = 0 . 81 0 . 00 0 . 25 0 . 50 0 . 75 1 . 00 < e i e j > heterogeneity 0 . 000 0 . 005 0 . 010 0 . 015 0 . 020 0 . 025 0 . 030 0 . 035 0 . 040 i n t e r a c t i o n s < e s > 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 C oo p e r a t i v i t y A B FIG . 5 . Model interpretation . A . Protein T f estimations with sigmoid function ﬁts as a function of length - normalized co - evolutionary energy of the respective sequences . B . Cooperativity score ρ is showed in a color scale on a plane deﬁned by the average normalized internal energy diﬀerence (cid:104) | e ij − e ik | (cid:105) and the average non - zero normalized surface energies −(cid:104) e s (cid:105) . Level curves ( grey ) were obtained with a polynomial ﬁt . and ˜ J ab ( σ a , σ b ) . More details about the model deﬁni - tion , parameter inference and validation are provided in Supporting Information ) . C . Ising model elements assignment The multiple repeat sequence alignment we worked with has the amino - acid pattern TPLH on positions 10 to 13 . We divided each repeat in two fragments using sec - ondary and tertiary structural information reported in the literature [ 45 ] . We labelled residues 1 - 18 containing β - hairpins and a α - helix as the fragment A and residues 19 - 33 containing the second α - helix as the fragment B . Given that the dataset only contained concatenated 33 amino - acid repeats , any repeat - array can be mapped to a periodic succession of A - B elements . Repeats with less than 33 residues include gaps ( ’ - ’ ) to complete all the 33 positions . Although the evolutionary ﬁeld was learned including gaps in the alphabet and rigorously there is a folding energy contribution to be considered , we set both energetic and entropic gap positions contribution to zero . D . Ising model implementation We performed Monte Carlo Metropolis algorithm sim - ulations of the ﬁnite Ising model with a python routine . Simulation total time , transient time and equilibration time parameters scale linearly with protein length , and were obtained with an autocorrelation analysis . Dele - tions , unknown amino - acids and missing residues at the beginning or ending of sequences were excluded from all calculations . For the selected dataset , simulations were made for 500 equispaced temperatures in an interval such that the system folds and unfolds completely . E . Free energy proﬁles approximation We obtained qualitative free energy proﬁles approxi - mating the probability of states s with Q folded elements with the Metropolis Monte - Carlo sampling . We consid - ered together sampled states for simulations performed in a window of the 10 closest temperatures . The proﬁles we used are computed as ∆ f ( Q ) = − kT log (cid:32)(cid:80) s | Q N ( s ) (cid:80) s N ( s ) (cid:33) , ( 4 ) where T is the average temperature , N ( s ) are the counts of state s and s | Q are the states with Q folded elements . F . Apparent domains Elements j , k were assigned to the same domain if | T jf − T kf | < 5 , where the folding temperature T jf was obtained by a sigmoid ﬁt of the folding probability of el - ement j . Domain folding temperature is the average (cid:104) T jf (cid:105) for j belonging the domain . Overlapping domains were separated into the minimum number of non - overlapping ones . If more than one separation is possible , tempera - ture diﬀerence between domains were maximised . 8 G . Folding temperature To ﬁt folding temperatures T f we approximated the fraction folded m ( T ) as m ( T ) = m max 1 + e a ( T − T f ) ( 5 ) where m max ∈ [ 0 , 1 ] . We used scipy library curve fit to ﬁt and get σ T f , which we used as T f errors . H . Cooperativity phase diagram ﬁt We made multivariate polynomial ﬁts on the selected set , making 5 - fold cross - validation and using python sklearn library preprocessing . PolynomialFeatures and linear model . LinearRegression . We compared performance measured by predicted ρ RMSE for 1 to 9 - degree polynomial and kept the best one , 3 - degree . Acknowledgements . This work used compu - tational resources from CCAD – Universidad Nacional de C´ordoba ( https : / / ccad . unc . edu . ar / ) , which are part of SNCAD – MinCyT , Rep´ublica Argentina . This work was supported by the Consejo de Investigaciones Cient´ıﬁcas y T´ecnicas ( CONICET ) ; the Agencia Na - cional de Promoci´on Cient´ıﬁca y Tecnol´ogica [ PICT2016 - 1467 to D . U . F . ] and Universidad de Buenos Aires ( UBA - CYT 2018 - 20020170100540BA ) . Additional support from NAI and Grant Number : 80NSSC18M0093 Pro - posal : ENIGMA : EVOLUTION OF NANOMACHINES IN GEOSPHERES AND MICROBIAL ANCESTORS ( NASA ASTROBIOLOGY INSTITUTE CYCLE 8 ) . We thank I . E . S´anchez and P . G . Wolynes for stimulating discussions and comments during the development of this work . IV . SUPPORTING INFORMATION TEXT A . Evolutionary model for repeat arrays 1 . Evolutionary model In the evolutionary model for repeat - proteins , intro - duced in [ 46 ] , we consider an array of N r repeats in tan - dem , each consisting of an amino - acid sequence of ﬁxed length l r . Repeats are duplicated and deleted with dele - tion and duplication rates per repeat that we assume to be equal µ dup = µ del , captured by a unique parameter µ d . The rate at which these event happen at the whole array level depends linearly on the array length , so that the overall array duplication ( and deletion ) rate is µ d N r . Here duplications always place repeats one next to each other conserving the repeat locality on the array . This dynamics determines the phylogenetic relationship be - tween repeats and map it to their relative position in the array , alongside mutations which spark mismatches along this repeat phylogeny . These size changes undergo selection S ( N r ) , deﬁned as the probability that a size change leading to an array of length N r is accepted . We assume that S depends only on the number of repeats in the array and not on the amino - acid sequence . The master equation for the probability of N r is dP ( N r ) dt = ( P ( N r − 1 ) ( N r − 1 ) + P ( N r + 1 ) ( N r + 1 ) ) S ( N r ) µ dup − P ( N r ) N r ( S ( N r − 1 ) + S ( N r + 1 ) ) µ del ( 6 ) where we set S ( N r ) so that the equilibrium distribu - tion matches the empirical array length distribution P emp ( N r ) in our dataset . Point mutations can occur with rate µ p per amino - acid site , which with duplications and deletions constitute the key events underlying this simple model ( ﬁg . S1 ) . Af - ter mutations , sequences undergo selection according to some evolutionary energy . This energy is deﬁned by an internal repeat Potts energy E 1 ( σ ) = − l r (cid:88) i = 1 h i ( σ i ) − (cid:88) i < j ≤ l r J ij ( σ i , σ j ) ( 7 ) acting on single repeats separately , plus an interaction term I i , i + 1 between consecutive repeats i , i + 1 , consisting of coupling J s between repeats . For example for a 2 9 repeats array we have : E 2 ( σ ) = − l r (cid:88) i = 1 h i ( σ i ) − (cid:88) i < j ≤ l r J ij ( σ i , σ j ) (cid:124) (cid:123)(cid:122) (cid:125) E 1 ( σ 1 ) = E 11 − l r (cid:88) i = 1 h i ( a i + l r ) − (cid:88) i < j ≤ l r J ij ( a i + l r , a j + l r ) (cid:124) (cid:123)(cid:122) (cid:125) E 21 − (cid:88) i < l r ≤ j J ij ( σ i , σ j ) (cid:124) (cid:123)(cid:122) (cid:125) I 1 , 2 ( 8 ) With these objects we can generalize a discrete transla - tional invariant energy for arrays of arbitrary length N r : E N r ( σ ) = N r (cid:88) i = 1 E i 1 + N r − 1 (cid:88) i = 1 I i , i + 1 . ( 9 ) This minimal model assumes independent selection on protein lengths and sequences — modulo boundary ef - fects due to the fact that the impact of I 1 , 2 is lower on terminals . Apart from the energy parameters , the only relevant parameter is the ratio of the two rates , µ r = µ d µ p , or equivalently the ratio between the two timescales t r = 1 µ r = (cid:104) t d (cid:105) (cid:104) t p (cid:105) . As a side note , we mention that this model is out of equilibrium because microscopically detailed balance is broken by duplications and deletions . Repeat ar - rays are characterized by joint probability P ( σ , N r ) for the sequence σ with N r repeats . If (cid:104) t d (cid:105) (cid:104) t p (cid:105) (cid:29) 1 we have a separation of timescales between the two pro - cesses , so that the mutation process can thermalize between typical dupdel times and multi - repeat amino - acid sequences are almost always at equilibrium with P ( σ | N r ) → ( 1 / Z N r ) e − E Nr ( σ ) . 2 . Numerical simulations In order to simulate our model we use a Metropolis - Hastings Monte Carlo scheme both for changes in array length and in sequence . Therefore we start from a ran - dom amino - acid sequence and we produce point muta - tions with rate µ p = 1 per site , one at a time . If a mu - tation decreases the evolutionary energy ( 9 ) we accept it . Otherwise we accept the mutation with probability e − ∆ E , where ∆ E is the diﬀerence of energy between the original and the mutated sequence . In parallel , we generate duplications and deletion events with rate µ d per repeat , therefore with absolute rate µ d N r , producing a change of array length N or → N nr = N or ± 1 . The resulting array is accepted with prob - amino - acid sequence array of N repeats D G R T P L H D G R T P L H N G N V P L H N point mutation repeat D G R T P L H D G N T P L H D G N T P L H N G N V P L H duplication deletion FIG . S1 . Key events characterizing our model for repeat tandem arrays evolution . Within an array many repeat du - plications and deletions of whole repeats happen at rate µ d , whereas point mutation happen at rate µ p . ability acc ( N or → N nr ) = min (cid:18) 1 , S ( N nr ) N nr S ( N or ) N or (cid:19) , ( 10 ) We estimate the order of magnitude of the limiting process of the model as t lim = max ( 10 (cid:104) t p (cid:105) , (cid:104) t d (cid:105) ) . We skip the ﬁrst 100 t lim sequences , and then we add a sequence every t lim to the ﬁnal ensemble after checking that these conditions are suﬃcient to reach thermalization and to draw sequences that are uncorrelated in both processes . 3 . Parameters inference In order to obtain a model that reproduces the ex - perimentally observed site - dependent amino - acid fre - quencies , f i ( σ i ) and correlations between two positions f ij ( σ i , σ j ) within a single repeat and between consecu - tive repeats , we apply a likelihood gradient ascent pro - cedure , starting from an initial guess of the h i ( σ i ) , and J ij ( σ i , σ j ) parameters . At the same time we learn (cid:104) t d (cid:105) (cid:104) t p (cid:105) to reproduce the average similarity ( number of match - ing amino - acids ) between neighboring repeats , (cid:104) ID emp1 st (cid:105) . This extra optimization step leaves the learning problem convexity unaﬀected , because the model (cid:104) ID 1 st (cid:105) depends monotonously on the scalar parameter µ r : the higher µ r the higher (cid:104) ID 1 st (cid:105) . This monotonic trend implies that the proper update direction for µ r is proportional to (cid:104) ID emp1 st (cid:105) − (cid:104) ID model1 st (cid:105) . Importantly , learning a full ﬁeld for pairs of consecutive repeats without the dynamic in - gredient of dupdels cannot reproduce this distribution or its average ( not shown ) as was already found in [ 47 ] for a diﬀerent dataset . At each step , we generate 150000 sequences of vari - able length through the Metropolis - Hastings Monte - Carlo sampling described in IV A 2 . Once we have gen - erated the sequence ensemble , we measure its marginals f model i ( σ i ) and f model ij ( σ i , σ j ) , the latter at most between 10 consecutive repeat pairs , as well as (cid:104) ID model1 st (cid:105) , and up - date the parameters of Eq . 9 and (cid:104) t d (cid:105) (cid:104) t p (cid:105) following the gra - dient of the likelihood , equal to the diﬀerence between model and data averages . In order to speed up the in - ference we add an inertia term to the gradient ascent mimicking acceleration , as described in [ 48 ] . The local ﬁeld is updated as : h i ( σ i ) t + 1 ← h i ( σ i ) t + (cid:15) m [ f i ( σ i ) − f model i ( σ i ) ] + I tot ( h i ( σ i ) t − h i ( σ i ) t − 1 ) , ( 11 ) As the number of parameters for the interaction terms J ij is large , we impose a sparsity constraint via a L 1 regular - ization γ (cid:80) ij , σ , τ | J ij ( σ , τ ) | added to the likelihood . This leads to the following rules of maximization : If J ij ( σ i , σ j ) t = 0 and | f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) | < γ J ij ( σ i , σ j ) t + 1 ← 0 . ( 12 ) If J ij ( σ i , σ j ) t = 0 and | f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) | > γ J ij ( σ i , σ j ) t + 1 ← (cid:15) j [ f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) − γ sign ( f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) ) ] . ( 13 ) If (cid:104) J ij ( σ i , σ j ) t + (cid:15) j [ f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) − γ sign ( J ij ( σ i , σ j ) t ) ] (cid:105) J ij ( σ i , σ j ) t ≥ 0 J ij ( σ i , σ j ) t + 1 ← J ij ( σ i , σ j ) t + (cid:15) j [ f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) − γ sign ( J ij ( σ i , σ j ) t ) ] + I tot ( J ij ( σ i , σ j ) t − J ij ( σ i , σ j ) t − 1 ) . ( 14 ) If (cid:104) J ij ( σ i , σ j ) t + (cid:15) j [ f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) − γ sign ( J ij ( σ i , σ j ) t ) ] (cid:105) J ij ( σ i , σ j ) t < 0 J ij ( σ i , σ j ) t + 1 ← 0 . ( 15 ) The times ratio parameter t r = (cid:104) t d (cid:105) (cid:104) t p (cid:105) is updated according to : t t + 1 r ← t tr − (cid:15) ID ( (cid:104) ID emp1 st (cid:105) − (cid:104) ID model1 st (cid:105) ) . ( 16 ) To estimate the model error , we compute f i ( σ i ) − f model i ( σ i ) , f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) . We repeat the pro - cedure above until the maximum of all errors , | f i ( σ i ) − f model i ( σ i ) | , | f ij ( σ i , σ j ) − f model ij ( σ i , σ j ) | , goes below 0 . 004 . The order of magnitude of this threshold value is motivated by the ﬁnite size eﬀects from the number of samples in our dataset . The empirical frequencies can be thought as the frequencies of the result of N s Bernoulli trials ( each of this trials draws the symbols in a sequence of our sample ) , and therefore they are distributed ac - cording to a multinomial distribution parametrized by some underlying true distribution p ( σ ) . The standard deviation of these measured frequencies will be of order 0 20 40 repeats number 0 . 0 0 . 1 0 . 2 p r o b a b ili t y A model data 10 3 10 1 model marginal frequencies 10 3 10 1 d a t a m a r g i n a l f r e q u e n c i e s B 10 4 10 1 model intra - repeats joint frequencies 10 6 10 4 10 2 10 0 d a t a i n t r a - r e p e a t s j o i n t f r e q u e n c i e s C 10 6 10 4 10 2 10 0 model inter - repeats joint frequencies 10 6 10 4 10 2 10 0 d a t a i n t e r - r e p e a t s j o i n t f r e q u e n c i e s D FIG . S2 . The inferred model reproduces the desired empir - ical statistics . A ) Probability distribution of number of re - peats in an array , data in red and model generated sequences in green . B ) , C ) , D ) Scatter plot between the empirical and model generated 1 site marginal amino - acid frequencies , 2 site joint amino - acid frequencies within the same repeat , 2 site joint amino - acid frequencies between consecutive repeats , re - spectively . The color map represents points density ( yellow higher density ) . O ( 1 √ N s ) that for example for the ∼ 420000 repeats in our dataset is ∼ 0 . 002 , therefore on the same order of magnitude of our threshold . Moreover we require that | (cid:104) ID emp1 st (cid:105) − (cid:104) ID model1 st (cid:105) | < 0 . 1 , and this other threshold scale is derived from the empirical diﬀerence between ﬁrst and second neighbors similarity | (cid:104) ID emp1 st (cid:105) − (cid:104) ID emp2 nd (cid:105) | = 0 . 4 . Using this procedure we calculate the model deﬁned in Eq . 9 with diﬀerent interaction ranges W for the cou - plings J ij , exactly as we did in [ 49 ] . We start from the independent model h i ( σ i ) = log f i ( σ i ) . We ﬁrst learn the model in Eq . 9 with J = 0 , that consists of just learning t r . We then re - learn models with interactions between sites i , j along the linear sequence such that | i − j | ≤ W , in a seeded way starting from the previous model . We progressively increase W until we reach the full repeat pairs model , W = 66 . The optimization parameters were set to (cid:15) ID = 0 . 5 , and γ = 0 . 0003 , while (cid:15) m ∈ [ 0 . 1 , 1 ] , (cid:15) j ∈ [ 0 . 05 , 1 ] , and I tot ∈ [ 0 . 7 , 0 . 95 ] were tuned ad - hoc as a function of W , the ﬁrst two in a decreasing fashion . 4 . Inference validation As a ﬁrst consistency check we show in ﬁg . S2 that the inferred model reproduces both the empirical array 11 10 6 10 5 10 4 10 3 10 2 10 1 model 3 points frequencies 10 8 10 7 10 6 10 5 10 4 10 3 10 2 10 1 d a t a 3 p o i n t s f r e q u e n c i e s FIG . S3 . Scatter plot between the empirical and model generated 3 sites joint amino - acid frequencies , the color map represents points density ( yellow higher density ) . The model reproduces well higher order statistics that were not used for ﬁtting . length distribution ( panel A ) and the three amino - acid frequencies sets ( panels B , C , D respectively ) we used to ﬁt the parameters . Thanks to our inference scheme we also learn quantitatively the timescales ratio between dupdels and mutations : (cid:104) t d (cid:105) (cid:104) t p (cid:105) = 1 µ r = 27 . 28 . Therefore on average duplications ( the average time for deletions is the same ) per repeat happen 27 . 28 times slower than mutations per site . Putting times in the same relative scale , per repeat , replacing (cid:104) ˜ t p (cid:105) = (cid:104) t p (cid:105) l r = (cid:104) t p (cid:105) 33 we have (cid:104) t d (cid:105) (cid:104) ˜ t p (cid:105) ∼ 900 , therefore duplications are about 3 orders of magnitude rarer than mutations and the system is almost at equilibrium . This is consistent with the fact that this procedure reproduces the right equilibrium distribution shown in ﬁg . S2 . Fig . S3 shows that also 3 point amino - acid frequencies f i , j , k ( σ i , σ j , σ k ) , including inter - repeat sites , are well re - produced by the model , even though we did not use them to infer the model . This means that the model general - izes well with respect to some higher order statistics that were not used for ﬁtting . 5 . Simpliﬁed notation used in the main text Given N r it is possible to consistently repeat in a single matrix all the local contributions h i by deﬁning ˜ h a = ˜ h i + nl r = h i , ( 17 ) and for J ij contributions by deﬁning ˜ J ab = ˜ J i + nl r , j + nl r = J ij , ( 18 ) 100 200 300 400 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 F o l d e d f r a c t i o n 0 5 10 Folded elements ( Q ) 0 2 4 6 8 f 100 200 300 400 T e m p e r a t u r e 1 3 5 7 9 11 13 element 1 3 5 7 9 11 13 e l e m e n t A B C D FIG . S4 . Simulation results for I κ B α . A . Thermal un - folding curve . B . Approximate free energy proﬁles , coloured by temperature ( same of C and D ) , with the number of folded elements Q as reaction coordinate . C . ALphaFold [ 50 ] struc - ture is coloured according to the folding temperature of each element . Purple fragments are the most unstable ones . D . Apparent domain matrix , coloured by domain folding tem - peratures . where n goes from 0 to N r − 1 . B . Supplementary case studies 1 . I κ B α We consider a 7 ANK repeat fragment ( including residues 23 - 55 not considered in previous studies as a ﬁrst ANK repeat ) , that is to say a tandem array of 14 elements . Simulations show a cooperative transition of the most stable elements : 5 , 6 and 8 to 12 , which are fol - lowed by less cooperative folding of the remaining ones ( Fig . S4 ) . This description is compatible with denatura - tion experiments , where a major cooperative event were followed by a non - cooperative one mapped to elements 11 to 14 , a region that was also reported to fold upon binding [ 36 ] . Point mutant Y254L - T257A do not fully stabilised the C - terminal repeat ( elements 13 and 14 ) as been characterised [ 36 ] but locally increase the folding temperature of element 13 , C - terminal ﬁrst helix , in our simulations ( data not shown ) . We detected element 7 as less stable than others , while NMR studies have shown that the region of elements 7 and 8 are high ﬂexible in the folded state and are involved in binding [ 36 ] . Finally , element 1 is the last fragment to fold in simulations and consistently has no alpha - helix structure according to an Alpha - Fold prediction . 12 100 200 300 400 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 F o l d e d f r a c t i o n 0 5 10 Folded elements ( Q ) 0 2 4 6 8 f 100 200 300 400 T e m p e r a t u r e 1 3 5 7 9 11 13 element 1 3 5 7 9 11 13 e l e m e n t A B C D FIG . S5 . Simulation results for Drosophila melangaster Notch receptor Ankyrin Domain . A . Thermal unfolding curve . B . Approximate free energy proﬁles , coloured by tem - perature ( same of C and D ) , with the number of folded ele - ments Q as reaction coordinate . C . PDB structure is coloured according to the folding temperature of each element . Purple fragments are the most unstable ones . D . Apparent domain matrix , coloured by domain folding temperatures . 2 . Notch receptor We analysed the Drosophila melangaster Notch recep - tor Ankyrin region , a 14 - elements array . We ﬁnd that the ﬁrst 3 elements are less stable and do not fold co - operatively with the next ones ( Fig . S5 ) . Consistently , experimental evidence suggest that the region of the ﬁrst two elements remains at least partially folded while the main subdomain is fully folded [ 37 ] . We detect that the nucleus domain are elements 4 to 9 , while the next ele - ments showed less stability , another observation in agree - ment with dynamic data and previously proposed models [ 37 ] . 3 . D34 We study the 24 - element fragment of protein AnkyrinR known as D34 . Fluorescence chemical denaturation curves suggest a folding via a stable intermediate . Two subdomains were characterised experimentally : a more cooperative N - terminal half of 12 elements and a less co - operative C - terminal half [ 39 ] . In our simulations , al - though approximate free energy proﬁles revealed high energy intermediates , the experimentally described do - mains are not found . Only the last two elements separate from a large 22 - elements highly cooperative domain ( Fig . S6 ) . 100 200 300 400 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 F o l d e d f r a c t i o n 0 5 10 15 20 25 Folded elements ( Q ) 0 2 4 6 8 f 150 200 250 300 350 T e m p e r a t u r e 1 4 7 10 13 16 19 22 element 1 4 7 10 13 16 19 22 e l e m e n t A B C D FIG . S6 . Simulation results for D34 . A . Thermal unfold - ing curve . B . Approximate free energy proﬁles , coloured by temperature ( same of C and D ) , with the number of folded ele - ments Q as reaction coordinate . C . PDB structure is coloured according to the folding temperature of each element . Purple fragments are the most unstable ones . D . Apparent domain matrix , coloured by domain folding temperatures . C . Supplementary methods 1 . Sequence data The full dataset was built scanning UniprotKB [ 51 ] with a structurally - derived Hidden Markov Models for single internal , N - terminal or C - terminal repeats [ 15 ] us - ing the hmmsearch tool at default parameters on sin - gle sequence ﬁles . Detected elements were forced to be 33 residues long and aligned , accepting deletions as gap characters ’ - ’ , eliminating rarely occurring [ 29 ] insertions and ﬁlling missing terminal residues with gaps . Con - secutive repeats were concatenated into arrays , allowing more than one array per protein sequence if elements were more than 67 residues away from each other . More details about the full dataset can be found in a previous work [ 29 ] . Given that evolutionary model was trained only on internal repeats , we discard sequences with 1 or 2 repeats . For minimizing phylogenetic bias , we cluster by full sequence similarity using CD - hit [ 52 ] at 90 % cut - oﬀ and maximum length diﬀerence of 32 residues , keeping randomly a single sequence per cluster . We label as nat - ural dataset the corresponding 117304 arrays and 740458 repeats on 109390 protein sequences . In order to build the 4020 array selected set with which we ran Ising model simulations , we eliminate arrays where insertions , dele - tions , unknown residues were detected from the natural dataset . In addition , arrays in which at least one terminal repeat was truncated are discarded . Finally we eliminate short 3 - repeat arrays , because terminal repeats cover 2 / 3 of the array and also the 3 remaining long arrays with more than 36 repeats , for computation time reasons . 13 6 4 2 0 2 4 6 G [ kcal / mol ] 15 10 5 0 5 10 15 E R 2 = 0 . 595 = - 1 . 3±0 . 1 b = 0 . 8±0 . 2 p16 ikba Notch S - > P mutants FIG . S7 . Evolutionary energy change between a wildtype protein and a mutated variant as a function of the experi - mental unfolding free energy ∆∆ G . Error bars indicate the experimental standard deviation . Serine to Proline mutants ( grey ) have been described as structurally disruptive , hence they were not used for ﬁtting . 2 . Evolutionary energy and experimental free folding energy We considered the stability change by point mutations ∆∆ G for three diﬀerent ANK proteins : p16 INK4A [ 19 – 21 ] , Notch [ 8 , 24 ] and I κ B α [ 22 , 23 ] . To compare with evolutionary energy change , we discarded mutations in terminal repeats , because the evolutionary model was trained only in internal repeats and Serine to Proline mutations . We compared the experimental unfolding en - ergy diﬀerence between mutants and wild type ∆∆ G and we compute ∆ E for the same mutants S7 . We made a Linear ﬁt and used the slope α = − 1 . 3 ± 0 . 1 to convert one energy into the other . 3 . Entropy determination Optimal values for the entropy per residue s were found by comparing simulated fraction folded curves with ex - perimental ones . We used reversible thermal unfolding curves available in the literature for p16 INK4A wildtype and TPLH2 mutant [ 20 ] , TANC1 ANK repeat domain re + 2m mutant [ 31 ] , TRPV4 ANK repeat Domain wild - type , I331T and L199F mutants [ 31 ] , Kidney ANK re - peat containing protein KANK1 [ 32 ] , DARPins 4ANK , 3ANK [ 53 ] , 4CA and 3CA [ 54 ] . Circular Dichroism ( CD ) at 222 nm experimental curves both raw and normalized as fraction folded were extracted from ﬁgures with the 3 . 5 4 . 0 4 . 5 5 . 0 5 . 5 6 . 0 6 . 5 Entropy per residue [ cal / mol / K ] 0 5 10 15 L o ss f un c t i o n p16 TRPV4 TANC1 KANK1 4ANK 4CA FIG . S8 . We used least squares as loss function to get an optimal entropy per residue s for the thermal unfolding curve of studied proteins . WebPlotDigitizer web server [ 55 ] point by point or if it was not possible using the auto - extracting tool . If there were more available , we selected 25 ﬁxed uniformly dis - tributed temperatures in the experimental range . Cor - respondent sequence alignments were curated by hand and are available upon request . On wildtype sequences , we ran the model scanning entropy per residue s at the selected temperatures . For each s value , simulated frac - tion folded was normalized to reach the maximum ex - perimental value at the lower temperature and we found the optimal entropy by least squares ( Fig . S8 ) . For each wildtype optimal s , we present fraction folded both for wildtype and mutants in ﬁg . S9 . 4 . Gene Ontology analysis We checked for Gene Ontology ( GO ) [ 56 ] molecu - lar function annotations for all the UnirprotKB [ 51 ] ( September 2021 ) arrays of the full dataset . We con - sidered that proteins achieve functions globally , hence we linked all the GO entries of the corresponding pro - tein with the arrays detected on that sequence . We only worked experimental evidence codes and we kept one ar - ray per sequence , reducing the set to 217 proteins on which we ran the folding Ising model . In order to divide the data into comparable classes , we used GOATOOLS python library [ 57 ] to get the depth - 1 class for all the annotations . [ 1 ] JD Bryngelson , PG Wolynes , Spin glasses and the sta - tistical mechanics of protein folding . Proceedings of the National Academy of sciences 84 , 7524 – 7528 ( 1987 ) . 14 [ 2 ] PG Wolynes , Evolution , energy landscapes and the para - doxes of protein folding . Biochimie 119 , 218 – 230 ( 2015 ) . [ 3 ] DU Ferreiro , EA Komives , PG Wolynes , Frustration , function and folding . Current opinion in structural bi - ology 48 , 68 – 73 ( 2018 ) . [ 4 ] L Paladin , et al . , Repeatsdb in 2021 : improved data and extended classiﬁcation for protein tandem repeat struc - tures . Nucleic Acids Research 49 , D452 – D457 ( 2021 ) . [ 5 ] R Espada , et al . , Repeat proteins challenge the concept of structural domains . Biochem Soc Trans 43 , 844 – 9 ( 2015 ) . [ 6 ] M Petersen , D Barrick , Analysis of tandem repeat pro - tein folding using nearest - neighbor models . Annual re - view of biophysics 50 , 245 – 265 ( 2021 ) . [ 7 ] T Aksel , D Barrick , Direct observation of parallel fold - ing pathways revealed using a symmetric repeat protein system . Biophys J 107 , 220 – 32 ( 2014 ) . [ 8 ] KW Tripp , D Barrick , Rerouting the folding pathway of the notch ankyrin domain by reshaping the energy landscape . Journal of the American Chemical Society 130 , 5681 – 5688 ( 2008 ) . [ 9 ] DU Ferreiro , EA Komives , The plastic landscape of re - peat proteins . Proceedings of the National Academy of Sciences 104 , 7735 – 7736 ( 2007 ) . [ 10 ] A Sch¨uler , E Bornberg - Bauer , Evolution of protein do - main repeats in metazoa . Molecular biology and evolution 33 , 3170 – 3182 ( 2016 ) . [ 11 ] A Kumar , J Balbach , Folding and stability of ankyrin repeats control biological protein function . Biomolecules 11 , 840 ( 2021 ) . [ 12 ] CC Mello , D Barrick , An experimentally determined pro - tein folding energy landscape . Proceedings of the National Academy of Sciences 101 , 14102 – 14107 ( 2004 ) . [ 13 ] R Espada , RG Parra , T Mora , AM Walczak , DU Ferreiro , Inferring repeat - protein energetics from evolutionary in - formation . PLoS Comput Biol 13 , e1005584 ( 2017 ) . [ 14 ] DU Ferreiro , AM Walczak , EA Komives , PG Wolynes , The energy landscapes of repeat - containing proteins : topology , cooperativity , and the folding funnels of one - dimensional architectures . PLoS Comput Biol 4 , e1000070 ( 2008 ) . [ 15 ] RG Parra , R Espada , N Verstraete , DU Ferreiro , Struc - tural and Energetic Characterization of the Ankyrin Re - peat Protein Family . PLoS Computational Biology 11 , 1 – 20 ( 2015 ) . [ 16 ] A Contini , G Tiana , A many - body term improves the accuracy of eﬀective potentials based on protein coevo - lutionary data . The Journal of chemical physics 143 , 07B608 1 ( 2015 ) . [ 17 ] M Figliuzzi , H Jacquier , A Schug , O Tenaillon , M Weigt , Coevolutionary landscape inference and the context - dependence of mutations in beta - lactamase tem - 1 . Molecular biology and evolution 33 , 268 – 280 ( 2016 ) . [ 18 ] A Haldane , WF Flynn , P He , R Vijayan , RM Levy , Structural propensities of kinase family proteins from a potts model of residue co - variation . Protein Science 25 , 1378 – 1384 ( 2016 ) . [ 19 ] KS Tang , BJ Guralnick , WK Wang , AR Fersht , LS Itzhaki , Stability and folding of the tumour suppressor protein p16 . Journal of molecular biology 285 , 1869 – 1886 ( 1999 ) . [ 20 ] Y Guo , et al . , Contributions of conserved tplh tetrapep - tides to the conformational stability of ankyrin repeat proteins . Journal of molecular biology 399 , 168 – 181 ( 2010 ) . [ 21 ] KS Tang , AR Fersht , LS Itzhaki , Sequential unfolding of ankyrin repeats in tumor suppressor p16 . Structure 11 , 67 – 73 ( 2003 ) . [ 22 ] DU Ferreiro , et al . , Stabilizing i κ b α by “consensus” design . Journal of molecular biology 365 , 1201 – 1216 ( 2007 ) . [ 23 ] I DeVries , DU Ferreiro , IE S´anchez , EA Komives , Fold - ing kinetics of the cooperatively folded subdomain of the i κ b α ankyrin repeat domain . Journal of molecular biol - ogy 408 , 163 – 176 ( 2011 ) . [ 24 ] TO Street , CM Bradley , D Barrick , An improved ex - perimental system for determining small folding entropy changes resulting from proline to alanine substitutions . Protein science 14 , 2429 – 2435 ( 2005 ) . [ 25 ] NP Schafer , et al . , Discrete kinetic models from funneled energy landscape simulations . PloS one 7 , e50635 ( 2012 ) . [ 26 ] IJL Byeon , et al . , Tumor suppressor p16ink4a : determi - nation of solution structure and analyses of its interac - tion with cyclin - dependent kinase 4 . Molecular cell 1 , 421 – 431 ( 1998 ) . [ 27 ] C Yuan , TL Selby , J Li , IJL Byeon , MD Tsai , Tumor sup - pressor ink4 : reﬁnement of p16ink4a structure and deter - mination of p15ink4b structure by comparative modeling and nmr data . Protein Science 9 , 1120 – 1128 ( 2000 ) . [ 28 ] G Interlandi , G Settanni , A Caﬂisch , Unfolding tran - sition state and intermediates of the tumor suppressor p16ink4a investigated by molecular dynamics simula - tions . Proteins : Structure , Function , and Bioinformatics 64 , 178 – 192 ( 2006 ) . [ 29 ] EA Galpern , MI Freiberger , DU Ferreiro , Large ankyrin repeat proteins are formed with similar and energetically favorable units . Plos one 15 , e0233865 ( 2020 ) . [ 30 ] H Inada , E Procko , M Sotomayor , R Gaudet , Structural and biochemical consequences of disease - causing muta - tions in the ankyrin repeat domain of the human trpv4 channel . Biochemistry 51 , 6195 – 6206 ( 2012 ) . [ 31 ] Q Yang , H Liu , Z Li , Y Wang , W Liu , Puriﬁcation and mutagenesis studies of tanc1 ankyrin repeats domain provide clues to understand mis - sense variants from dis - eases . Biochemical and biophysical research communica - tions 514 , 358 – 364 ( 2019 ) . [ 32 ] W Pan , et al . , Structural insights into ankyrin repeat – mediated recognition of the kinesin motor protein kif21a by kank1 , a scaﬀold protein in focal adhesion . Journal of Biological Chemistry 293 , 1944 – 1956 ( 2018 ) . [ 33 ] MC Baxa , EJ Haddadian , JM Jumper , KF Freed , TR Sosnick , Loss of conformational entropy in protein folding calculated using realistic ensembles and its implications for nmr - based calculations . Proceedings of the National Academy of Sciences 111 , 15396 – 15401 ( 2014 ) . [ 34 ] JA D’aquino , et al . , The magnitude of the backbone conformational entropy change in protein folding . Pro - teins : Structure , Function , and Bioinformatics 25 , 143 – 156 ( 1996 ) . [ 35 ] GI Makhatadze , PL Privalov , On the entropy of protein folding . Protein Science 5 , 507 – 510 ( 1996 ) . [ 36 ] DU Ferreiro , EA Komives , Molecular mechanisms of sys - tem control of nf - κ b signaling by i κ b α . Biochemistry 49 , 1560 – 1567 ( 2010 ) . [ 37 ] CM Bradley , D Barrick , Limits of cooperativity in a structurally modular protein : response of the notch ankyrin domain to analogous alanine substitutions in each repeat . Journal of molecular biology 324 , 373 – 386 15 ( 2002 ) . [ 38 ] D Barrick , DU Ferreiro , EA Komives , Folding landscapes of ankyrin repeat proteins : experiments meet theory . Current opinion in structural biology 18 , 27 – 34 ( 2008 ) . [ 39 ] ND Werbeck , LS Itzhaki , Probing a moving target with a plastic unfolding intermediate of an ankyrin - repeat pro - tein . Proceedings of the National Academy of Sciences 104 , 7863 – 7868 ( 2007 ) . [ 40 ] A Kohl , et al . , Designed to be stable : crystal structure of a consensus ankyrin repeat protein . Proceedings of the National Academy of Sciences 100 , 1700 – 1705 ( 2003 ) . [ 41 ] SK Wetzel , G Settanni , M Kenig , HK Binz , A Pl¨uckthun , Folding and unfolding mechanism of highly stable full - consensus ankyrin repeat proteins . Journal of molecular biology 376 , 241 – 257 ( 2008 ) . [ 42 ] P Tian , JM Louis , JL Baber , A Aniana , RB Best , Co - evolutionary ﬁtness landscapes for sequence design . Angewandte Chemie International Edition 57 , 5674 – 5678 ( 2018 ) . [ 43 ] G Lee , et al . , Nanospring behaviour of ankyrin repeats . Nature 440 , 246 – 249 ( 2006 ) . [ 44 ] J Jumper , et al . , Highly accurate protein structure pre - diction with alphafold . Nature 596 , 583 – 589 ( 2021 ) . [ 45 ] SG Sedgwick , SJ Smerdon , The ankyrin repeat : a diver - sity of interactions on a common structural framework . Trends in biochemical sciences 24 , 311 – 316 ( 1999 ) . [ 46 ] J Marchi , Theses ( Universit´e Paris sciences et lettres ) ( 2020 ) . [ 47 ] R Espada , RG Parra , T Mora , AM Walczak , DU Ferreiro , Inferring repeat - protein energetics from evolutionary in - formation . PLoS computational biology pp . 1 – 16 ( 2017 ) . [ 48 ] G Goh , Why momentum really works . Distill ( 2017 ) . [ 49 ] J Marchi , et al . , Size and structure of the sequence space of repeat proteins . PLOS Computational Biology 15 , 1 – 23 ( 2019 ) . [ 50 ] M Varadi , et al . , Alphafold protein structure database : massively expanding the structural coverage of protein - sequence space with high - accuracy models . Nucleic acids research 50 , D439 – D444 ( 2022 ) . [ 51 ] E Boutet , D Lieberherr , M Tognolli , M Schneider , A Bairoch , Uniprotkb / swiss - prot in Plant bioinformatics . ( Springer ) , pp . 89 – 112 ( 2007 ) . [ 52 ] W Li , A Godzik , Cd - hit : a fast program for cluster - ing and comparing large sets of protein or nucleotide se - quences . Bioinformatics 22 , 1658 – 1659 ( 2006 ) . [ 53 ] LK Mosavi , DL Minor , Zy Peng , Consensus - derived structural determinants of the ankyrin repeat motif . Pro - ceedings of the National Academy of Sciences 99 , 16029 – 16034 ( 2002 ) . [ 54 ] L Kelly , MA McDonough , ML Coleman , PJ Ratcliﬀe , CJ Schoﬁeld , Asparagine β - hydroxylation stabilizes the ankyrin repeat domain fold . Molecular BioSystems 5 , 52 – 58 ( 2009 ) . [ 55 ] A Rohatgi , Webplotdigitizer ( https : / / automeris . io / WebPlotDigitizer ) ( 2020 ) . [ 56 ] TGO Consortium , The Gene Ontology resource : enrich - ing a GOld mine . Nucleic Acids Research 49 , D325 – D334 ( 2020 ) . [ 57 ] D Klopfenstein , et al . , Goatools : A python library for gene ontology analyses . Scientiﬁc reports 8 , 1 – 17 ( 2018 ) . 16 280 300 320 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 F o l d e d f r a c t i o n p16 wt TPLH2 wt exp TPLH2 exp 310 315 320 325 Temperature 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 F o l d e d f r a c t i o n KANK1 wt wt exp 290 300 310 320 330 Temperature 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 F o l d e d f r a c t i o n TRPV4 wt I331T L199F wt exp I331T exp L199F exp 300 320 340 360 Temperature 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 F o l d e d f r a c t i o n 4ANK 4ANK 3ANK 4ANK exp 3ANK exp 310 320 330 340 Temperature 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 F o l d e d f r a c t i o n TANC1 wt wt exp 320 340 360 Temperature 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 F o l d e d f r a c t i o n 4CA 3CA 4CA 3CA exp 4CA exp D C F E A B FIG . S9 . Optimal unfolding curves and mutation eﬀect . Simulations ( lines ) and rescaled CD signal to match the maximum folded fraction in the temperature range ( points ) . Optimal s found for each wild - type protein was used to simulate also mutated sequences if available . A . p16 wildtype and TPLH2 mutant [ 20 ] . B . TRPV4 - ARD wildtype , I331T and L199F mutants [ 30 ] . C TANC1 - ARD [ 31 ] . D . Kidney ANK 1 [ 32 ] . E . DARPins 4ANK ( s used ) and 3ANK [ 53 ] . F . DARPins 4CA ( s used ) and 3CA [ 54 ] 17 4 5 6 7 8 Length [ repeats ] 300 325 350 375 F o l d i n g t e m p e r a t u r e FIG . S10 . Sigmoid ﬁtted folding temperature for a library of 100 DARPins as a function of sequence length . Stability increase with length was found . 18 0 5 10 15 20 Domain size [ elements ] 0 100 200 300 400 500 D o m a i n f o l d i n g t e m p e r a t u r e 0 10 20 30 40 Domain size [ elements ] 10 0 10 1 10 2 10 3 10 4 0 5 10 15 20 Domain size [ elements ] 0 100 200 300 400 500 D o m a i n f o l d i n g t e m p e r a t u r e 0 10 20 30 40 Domain size [ elements ] 10 0 10 1 10 2 10 3 10 4 D C B A FIG . S11 . A . Domain folding temperature and size heat - map . B Domain size distribution . Panels C and D show results only for the ﬁrst domain to fold ( nucleus ) of each array . 19 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 Cooperativity 100 200 300 400 500 F o l d i n g t e m p e r a t u r e 0 200 400 600 C o un t 0 200 Count FIG . S12 . Arrays folding temperature and cooperativity score ρ joint histogram . 0 . 00 0 . 25 0 . 50 0 . 75 1 . 00 Cooperativity 100 200 300 400 500 F o l d i n g t e m p e r a t u r e Size 8 - 10 11 - 20 21 - 72 0 . 0 0 . 5 1 . 0 1 . 5 0 . 000 0 . 005 FIG . S13 . Arrays folding temperature and cooperativity score ρ joint distribution for short arrays ( blue ) , intermediate ( or - ange ) and large ones ( green ) . 20 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 Cooperativity score 100 150 200 250 300 350 400 450 500 F o l d i n g t e m p e r a t u r e binding transporter activity catalytic activity molecular function regulator transcription regulator activity structural molecule activity molecular adaptor activity molecular transducer activity FIG . S14 . Arrays with Gene Ontology annotations with ex - perimental evidence of molecular function ( colours ) folding temperature ( y - axis ) and cooperativity score ( x - axis ) . 100 80 60 40 Normalized energy 0 100 200 300 400 500 T f ( f i t ) R 2 = 0 . 89 0 . 00 0 . 25 0 . 50 0 . 75 1 . 00 < e i e j > heterogeneity 0 . 000 0 . 005 0 . 010 0 . 015 0 . 020 0 . 025 0 . 030 0 . 035 0 . 040 i n t e r a c t i o n s < e s > 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 C o o p e r a t i v i t y A B FIG . S15 . Generated sequence dataset results . A . Array T f estimations with sigmoid function ﬁts as a function of length - normalized co - evolutionary energy of the respective sequences . B . Cooperativity score ρ is showed in a color scale on a plane deﬁned by the average normalized internal energy diﬀerence (cid:104) e ij − e ik (cid:105) and the average non - zero normalized surface energies −(cid:104) e s (cid:105) .
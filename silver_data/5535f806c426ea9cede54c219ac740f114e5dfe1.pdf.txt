Stability analysis of second - order time accurate schemes for ALE – FEM Luca Formaggia a , * , Fabio Nobile b a MOX , Mathematics Department , Politecnico di Milano , Milan , Italy b ICES , The University of Texas at Austin , TX 78712 , USA Received 16 May 2003 ; received in revised form 29 August 2003 ; accepted 4 September 2003 Abstract In this work we will introduce and analyze the Arbitrary Lagrangian Eulerian formulation for a model problem of a scalar advection – diﬀusion equation deﬁned on a moving domain . Moving from the results illustrated in our previous work [ J . Num . Math . 7 ( 1999 ) 105 ] , we will consider ﬁrst and second - order time advancing schemes and analyze how the movement of the domain might aﬀect accuracy and stability properties of the numerical schemes with respect to their counterpart on ﬁxed domains . Theoretical and numerical results will be presented , showing that stability properties are not , in general , preserved , while accuracy is maintained . (cid:1) 2004 Elsevier B . V . All rights reserved . Keywords : Stability analysis ; Arbitrary Lagrangian Eulerian formulation ; Finite elements ; Time advancing schemes 1 . Introduction One of the most used techniques for the numerical simulation of partial diﬀerential equations on moving domains is the so - called Arbitrary Lagrangian Eulerian ( ALE ) formulation . In this formulation the partial time derivative is expressed with respect to a reference ﬁxed conﬁguration . A special homeomorphic map , called the ALE map A t : X 0 ! X ð t Þ associates , at each time t , a point in the current computational domain X ð t Þ to a point in the reference domain X 0 . In this way , the ODE system resulting after space discretization actually describes the evolution of the solution along trajectories that are at all times contained in the computational domain . The ALE mapping is somehow arbitrary , apart from the requirement of conforming to the evolution of the domain boundary , which is either a given data or the result of the coupling with other diﬀerential models . The latter is the case , for instance , when treating ﬂuid - structure interaction problems where the position of the ﬂuid domain * Corresponding author . E - mail address : luca . formaggia @ mate . polimi . it ( L . Formaggia ) . 0045 - 7825 / $ - see front matter (cid:1) 2004 Elsevier B . V . All rights reserved . doi : 10 . 1016 / j . cma . 2003 . 09 . 028 Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 www . elsevier . com / locate / cma boundary is provided through the interaction with a mechanical model . The map of the boundary o X 0 of the reference domain has then to provide , at all t , the boundary of the current conﬁguration X ð t Þ . In a numerical simulation we are concerned with the evolution of the discrete domain , typically built as the assembly of the elements of a computational grid . The discrete ALE map describes the evolution of the grid during the domain movement . It is indeed at discrete level that the advantage of the ALE formulation emerges , as in an ALE setting the time advancing scheme provides directly the evolution of the unknowns at mesh nodes , and thus , in a classic ﬁnite element setting , that of the degrees of freedom of the discrete problem at hand . Several issues have however to be addressed when using the ALE formulation in a ﬁnite element context . What is the minimal regularity for the ALE mapping to ensure the well - posedness of the diﬀerential problem in the ALE formulation ? What type of ﬁnite element discretization is appropriate for the discrete ALE mapping in relation to the ﬁnite element space chosen for the numerical solution ? How the stability of the numerical scheme is aﬀected by the mesh movement ? These are some of the questions addressed by the authors in [ 4 ] for a model advection – diﬀusion problem . In particular , in this reference it is shown how the fulﬁllment of the so called Geometric Conservation Law is a suﬃcient condition for the Backward Euler implicit scheme to be unconditionally stable . In fact the ALE formulation introduces an additional advection term , which is related to the grid velocity ( i . e . the time derivative of the discrete ALE mapping ) . The stability of the time advancing scheme may be aﬀected by this term , which is normally diﬃcult to control . The Geometric Conservation Law ( GCL ) was originally introduced in [ 12 ] and has been recently dealt in more details by Fahrat and coworkers . More speciﬁcally its signiﬁcance in a ﬁnite volume context and for aero - elasticity problems has been tackled in [ 6 , 9 ] , while in [ 7 ] a procedure is given to build schemes for unstructured dynamic meshes that show ( by numerical experimentation ) a second - order time accuracy . The GCL condition is , in fact , a request of strong consistency of the discrete problem with respect to constant solutions : the numerical scheme must be able to exactly represent constant solutions . In [ 4 ] its signiﬁcance for ﬁnite element formulations on moving grids is further clariﬁed by establishing a clear link with the degree of exactness of the time advancing scheme . In [ 3 ] it is shown how for a scalar non - linear hyperbolic conservation law discretized by means of monotone numerical ﬂuxes , the satisfaction of GCL is a suﬃcient and necessary condition for the numerical scheme to preserve a maximum principle when applied on moving meshes . However , in a later work [ 5 ] , the same authors , by means of truncation error arguments , show that the GCL is not a necessary condition to obtain a ( formally ) second - order time accurate scheme . In that work ﬁnite volume schemes are considered , applied to aero - elastic problems . In the present work , we reach the same conclusions by considering the ﬁnite element discretization of a model scalar advection – diﬀusion problem . We will consider ﬁrst and second - order time advancing schemes and analyze how the domain movement might aﬀect the stability and accuracy properties of the numerical schemes with respect to their counterpart on ﬁxed domains and what role does the GCL play with this respect . The numerical tests presented in Section 5 show that time accuracy of the numerical schemes is preserved irrespectively to the satisfaction of the GCL , provided the domain movement is suitably inter - polated . Conversely , we will show , both theoretically and numerically , that the stability of the most known second - order unconditionally stable ( on ﬁxed grids ) schemes is aﬀected by the domain movement , whether or not the GCL is satisﬁed , with the only exception of the backward Euler case , as already shown in [ 4 ] . This in practice means that a condition on the time step has to be imposed to ensure stability . However , although the results presented in Section 5 show a spurious ‘‘energy production’’ as a consequence of the moving mesh , we were actually unable to ﬁnd a test case where the simulation would blow - up . This probably shows that in practice ( at least for linear problems ) the instability induced by the domain movement is mild . The paper is organized as follows . In Section 2 we introduce the ﬁnite element formulation in ALE frame . In Section 3 we recall , for the sake of completeness , the principal results obtained in our previous 4098 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 work . In Section 4 we derive stability inequalities for two second - order schemes ( namely Crank – Nicolson and second - order backward ﬁnite diﬀerence scheme ) and prove a conditional stability for both of them . In Section 5 we analyze numerically the stability and accuracy of the diﬀerent schemes . Finally , in Section 6 we draw some conclusions . 2 . ALE formulation and ﬁnite element approximation Let us consider the following model problem deﬁned on a moving domain X t (cid:1) R d , t 2 I (cid:2) ð t 0 ; T Þ : o u o t þ $ (cid:3) ð b u Þ (cid:4) lD u ¼ f in X t ; t 2 I u ¼ u 0 in X 0 ; t ¼ t 0 u ¼ u D on o X t ; t 2 I ; ð 1 Þ where b is a convection velocity , which is assumed to satisfy $ (cid:3) b ¼ 0 , l a constant diﬀusivity , D indicates the Laplacian operator and u D is an assigned boundary condition of Dirichlet type . For this problem , and for the homogeneous case u D ¼ 0 , an a priori energy inequality can be easily obtained ( see for instance [ 4 ] ) , and it reads u ð t Þ k k 2 L 2 ð X t Þ þ l Z t t 0 $ u ð s Þ k k 2 L 2 ð X s Þ d s 6 u ð t 0 Þ k k 2 L 2 ð X t 0 Þ þ ð 1 þ C X Þ l Z t t 0 f ð s Þ k k 2 H (cid:4) 1 ð X s Þ d s ; 8 t 2 I ; ð 2 Þ where we have denoted by C X the constant appearing in the Poincar (cid:1) e inequality : v k k 2 L 2 ð X t Þ 6 C X $ v k k 2 L 2 ð X t Þ ; 8 v 2 H 10 ð X t Þ : The Sobolev spaces H 1 ð X Þ and H (cid:4) 1 ð X Þ and the corresponding norms are deﬁned in the standard way ( see , for instance , [ 2 , 11 ] ) . The Arbitrary Lagrangian Eulerian ( ALE ) formulation recasts the original problem ( 1 ) on a reference ﬁxed conﬁguration , say X 0 ( this might be , for instance , the domain conﬁguration at time t ¼ t 0 ) . Let A t be a family of mappings , hereafter called ALE mappings , which at each t 2 I associate a point Y of the reference conﬁguration X 0 to a point x on the current domain conﬁguration X t : A t : X 0 (cid:1) R d ! X t (cid:1) R d ; x ð Y ; t Þ ¼ A t ð Y Þ : We assume A t to be an homeomorphism , that is A t 2 C 0 ð X 0 Þ is invertible with inverse A (cid:4) 1 t 2 C 0 ð X t Þ . Furthermore , we assume that the application t ! x ð(cid:3) ; t Þ is diﬀerentiable almost everywhere in ½ t 0 ; T (cid:5) . We may note that the mapping is in fact rather arbitrary , apart from the requirement that , for all t 2 I , A t ð o X 0 Þ ¼ o X t . We name Y 2 X 0 the ALE coordinate while x ¼ x ð Y ; t Þ will be addressed as the spatial ( or Eulerian ) coordinate . For the sake of notation , we put X t (cid:6) I ¼ fð x ; t Þj x 2 X t ; t 2 I g . Let f : X t (cid:6) I ! R . We will indicate with ^ f : ¼ f (cid:7) A t the corresponding function on the ALE frame , i . e . ^ f : X 0 (cid:6) I ! R ; ^ f ð Y ; t Þ ¼ f ð A t ð Y Þ ; t Þ : Note that the composition operator applies only to the spatial variables , being the time variable t left unchanged by the mapping . We will adopt the symbol o f o t (cid:1) (cid:1) Y to indicate the ALE time derivative , deﬁned as o f o t (cid:1)(cid:1)(cid:1)(cid:1) Y : X t (cid:6) I ! R ; o f o t (cid:1)(cid:1)(cid:1)(cid:1) Y ð x ; t Þ ¼ o ^ f o t ð Y ; t Þ ; Y ¼ A (cid:4) 1 t ð x Þ : ð 3 Þ L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4099 For analogy , from now on we will use o f o t (cid:1)(cid:1) x for the partial time derivative in the Eulerian frame . Finally , we deﬁne the domain velocity ^ w as ^ w ð Y ; t Þ ¼ o x o t (cid:1)(cid:1)(cid:1)(cid:1) Y ð Y ; t Þ ; ð 4 Þ and indicate with w the corresponding function in X t (cid:6) I . We have that o f o t (cid:1)(cid:1)(cid:1)(cid:1) Y ¼ o f o t (cid:1)(cid:1)(cid:1)(cid:1) x þ o x o t (cid:1)(cid:1)(cid:1)(cid:1) Y (cid:3) $ x f ¼ o f o t (cid:1)(cid:1)(cid:1)(cid:1) x þ w (cid:3) $ x f : ð 5 Þ The model problem ( 1 ) in the ALE frame then reads [ 4 ] o u o t (cid:1)(cid:1)(cid:1) (cid:1) Y (cid:4) w (cid:3) $ x u þ $ x (cid:3) ð b u Þ (cid:4) lD x u ¼ f for x 2 X t ; t 2 I u ¼ u 0 for x 2 X 0 ; t ¼ t 0 u ¼ u D for x 2 o X t ; t 2 I ; ð 6 Þ where we have indicated the gradient , divergence and Laplace operators with $ x , $ x (cid:3) and D x , respectively , to underline that the space derivatives are taken with respect to the Eulerian coordinate x . Formulation ( 6 ) will be referred to as the non - conservative ALE formulation . Whenever the conservative properties of the problem are important , a conservative formulation may be desirable . This is readily obtained by noting that [ 1 ] o J A t o t (cid:1)(cid:1)(cid:1)(cid:1) Y ¼ J A t $ x (cid:3) w ; ð 7 Þ where J A t is the Jacobian of the ALE mapping J A t ¼ det ð J A t Þ ; and J A t ¼ o x o Y : We have , then , 1 J A t o ð J A t u Þ o t (cid:1)(cid:1)(cid:1)(cid:1) Y ¼ o u o t (cid:1)(cid:1)(cid:1)(cid:1) Y þ 1 J A t o J A t o t (cid:1)(cid:1)(cid:1)(cid:1) Y u ¼ o u o t (cid:1)(cid:1)(cid:1)(cid:1) Y þ u $ x (cid:3) w and the diﬀerential equation in ( 1 ) can be rewritten in the following conservative ALE form 1 J A t o J A t u o t (cid:1)(cid:1) (cid:1)(cid:1) Y þ $ x (cid:3) ð b ½ (cid:4) w Þ u (cid:4) l $ x u (cid:5) ¼ f for x 2 X t ; t 2 I : ð 8 Þ Remark 1 . We may also introduce the mapping A sr : X s ! X r , being s ; r 2 I , as A sr ¼ A r (cid:7) A (cid:4) 1 s : For the sake of notation , however , whenever we have to integrate a quantity u ð r Þ : X r ! R on a con - ﬁguration X s with s 6¼ r , we will simply write R X s u ð r Þ d X instead of the ( formally more correct ) expression R X s u ð r Þ (cid:7) A sr d X . Analogously , we will use k u ð r Þk L 2 ð X s Þ as a short - hand notation of k u ð r Þ (cid:7) A sr k L 2 ð X s Þ and so on . 2 . 1 . Finite element ALE formulation We brieﬂy recall the set up for the ﬁnite element formulation in an ALE frame that has been developed in [ 4 ] . 4100 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 Let X h ð X 0 Þ (cid:1) H 1 ð X 0 Þ be a ﬁnite element space deﬁned on the reference conﬁguration X 0 . The ﬁnite element space on the current conﬁguration is constructed by the help of the ALE mapping as X h ð X t Þ ¼ f w h : X t (cid:6) I ! R ; w h ¼ b w h (cid:7) A (cid:4) 1 t ; b w h 2 X h ð X 0 Þg : ð 9 Þ In most cases , the ALE mapping is , on its turn , represented by means of ﬁnite elements and is computed , for instance , by solving a suitable PDE , given the displacement of the domain boundary . Clearly , if this is the case , the domain boundary will not be exactly represented . Yet since this aspect is not crucial for the analysis that we will carry out in this paper , we will continue to indicate the computational domain by X t , for the sake of simplicity . Let N be the set of nodes of the ﬁnite element mesh and N int (cid:1) N that containing just the internal nodes . The set of Lagrange basis functions on the reference conﬁguration X 0 is indicated by f ^ w i ; ^ w i 2 X h ð X 0 Þ ; i 2 N g ; and forms a basis of X h ð X 0 Þ , while f ^ w i ; i 2 N int g forms a basis of X 0 ; h ð X 0 Þ ¼ X h ð X 0 Þ \ H 10 ð X 0 Þ . Correspondingly , we indicate with w i the ﬁnite element basis function on the triangulation of X t , deﬁned as w i ¼ ^ w i (cid:7) A (cid:4) 1 t ; i 2 N : For each t 2 I the numerical solution u h may then be expressed as a linear combination of nodal ﬁnite element basis functions , i . e . u h ð x ; t Þ ¼ X i 2 N w i ð x ; t Þ u i ð t Þ ; ð 10 Þ with time dependent coeﬃcients u i ð t Þ . The major diﬀerence with standard ﬁnite element formulation for time - dependent problems is that here the ﬁnite element basis functions depend on time because of the ALE mapping . Then , the ﬁnite element approximation of the non - conservative formulation ( 6 ) may be written as Semi - discrete non - conservative formulation For all t 2 I , ﬁnd u h 2 X h ð X t Þ such that Z X t o u h o t (cid:1)(cid:1)(cid:1)(cid:1) Y w h d X þ l Z X t $ x u h (cid:3) $ x w h d X þ Z X t $ x (cid:3) ð b u h Þ ½ (cid:4) w (cid:3) $ x u h (cid:5) w h d X ¼ Z X t f w h d X 8 w h 2 X 0 ; h ð X t Þ ð 11 Þ with u h ¼ u D h for x 2 o X t ; t 2 I ð 11a Þ u h ¼ u 0 h for x 2 X 0 ; t ¼ t 0 : ð 11b Þ u D ; h and u 0 ; h being suitable ﬁnite element approximations of u D and u 0 , respectively . By denoting by U ¼ f u i g i 2 N the vector of nodal values of u h ( which are , of course , functions of time ) , we may express ( 11 ) in an algebraic form as M ð t Þ d U ð t Þ d t þ H ð t Þ U ð t Þ (cid:4) B ð t ; w ð t ÞÞ U ð t Þ ¼ F ð t Þ ; t 2 I ð 12 Þ plus u i ð t Þ ¼ u D ; h ð x i ; t Þ ; i 2 N n N int ð 13a Þ L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4101 and u i ð t 0 Þ ¼ u 0 ; h ð x i Þ ; i 2 N : ð 13b Þ Here , M ð t Þ ¼ Z X t w i ð t Þ w j ð t Þ d X (cid:2) (cid:3) i 2 N int ; j 2 N is the mass matrix , while H and B are deﬁned as H ð t Þ ¼ Z X t $ x (cid:3) ð b w j ð t ÞÞ w i ð t Þ d X (cid:2) þ l Z X t $ x w j ð t Þ (cid:3) $ x w i ð t Þ d X (cid:3) i 2 N int ; j 2 N ; B ð t ; w Þ ¼ Z X t ð w ð t Þ (cid:3) $ x w j ð t ÞÞ w i ð t Þ d X (cid:2) (cid:3) i 2 N int ; j 2 N ; and F ð t Þ ¼ Z X t f ð t Þ w i ð t Þ d X (cid:2) (cid:3) i 2 N int : This formulation diﬀers from the one usually obtained in the ﬁnite element method when the unknowns on the Dirichlet portion of the boundary are statically eliminated , producing a system with square matrices M , H and B and a modiﬁed right - hand side . Yet , this equivalent formulation is here preferred for the further discussion . On the other hand , the ﬁnite element approximation of the conservative formulation ( 8 ) may be written as Semi - discrete conservative formulation For each t 2 I , ﬁnd u h 2 X h ð X t Þ such that d d t Z X t u h w h d X þ l Z X t $ x u h (cid:3) $ x w h d X þ Z X t $ x (cid:3) ð b ½ (cid:4) w Þ u h (cid:5) w h d X ¼ Z X t f w h d X 8 w h 2 X 0 ; h ð X t Þ ; ð 14 Þ with ( 11a ) and ( 11b ) as initial and boundary conditions , respectively . Equivalently , the algebraic form reads : d d t M ð t Þ U ð t Þ ð Þ þ H ð t Þ ð (cid:4) A ð t ; w ð t ÞÞ (cid:4) B ð t ; w ð t ÞÞÞ U ð t Þ ¼ F ð t Þ : ð 15 Þ Here , A ð t ; w Þ ¼ Z X t $ x (cid:3) w ð t Þ w j ð t Þ w i ð t Þ d X (cid:2) (cid:3) i 2 N int ; j 2 N : Both ( 12 ) and ( 15 ) are systems of ordinary diﬀerential equations and they may be put into the general form d y ð t Þ d t ¼ g 1 ð t ; U ð t ÞÞ þ g w ð t ; U ð t ÞÞ ; t 2 I ; ð 16 Þ where g 1 ð t ; U ð t ÞÞ accounts for the diﬀusive and convective terms , g w ð t ; U ð t ÞÞ is the term that depends on the domain velocity w , while 4102 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 y ð t Þ ¼ U ð t Þ non - conservative formulation ; M ð t Þ U ð t Þ ; conservative formulation : (cid:2) We observe that the diﬀerential system is not autonomous even in the case of steady boundary condi - tions and forcing term , since g 1 and g w depend on time not only through U , but also because of the domain movement . We now recall the deﬁnition of the Geometric Conservation Laws ( GCL ) as given , for instance in [ 4 , 8 , 13 ] . Deﬁnition 1 . A numerical scheme posed on a moving domain satisﬁes the Geometric Conservation Laws if it is able to reproduce exactly a constant solution . Clearly , we are assuming that the constant solution is admissible for the problem at hand . This is indeed the case whenever f ¼ 0 and the boundary and initial conditions are appropriately chosen . It has been shown in [ 4 ] that the non - conservative formulation ( 12 ) satisﬁes the GCL provided that all space integrals are computed exactly , irrespectively to the time - advancing scheme adopted . On the contrary , the conservative formulation ( 15 ) satisﬁes the GCL only if the identity d d t Z X t w i d X ¼ Z X t w i $ x (cid:3) w d X ; 8 i 2 N int ; ð 17 Þ which expresses the conservation of purely geometrical quantities , is satisﬁed at discrete level . Algebraically ( 17 ) is equivalent to d d t M ð t Þ 1 ð Þ ¼ g w ð t ; 1 Þ ¼ A ð t ; w ð t ÞÞ 1 ; where 1 2 R N indicates a vector of all unit elements , being N ¼ card ð N Þ . We may then aﬃrm that a time advancing scheme satisﬁes the GCL whenever it solves exactly the problem d M ð t Þ z ð t Þ d t ¼ A ð t ; w ð t ÞÞ z ð t Þ ; t 2 I z ð t 0 Þ ¼ 1 ; 8 < : ð 18 Þ i . e . it should return z n ¼ z ð t n Þ ¼ 1 for all n such that t n 6 T . In [ 4 ] we proposed another , stronger , characterization of the GCL that is more appropriate in a ﬁnite element context . Precisely , it is required that the discrete system should satisfy exactly the identity d d t Z X t w i w j d X ¼ Z X t w i w j $ x (cid:3) w d X ; 8 i ; j 2 N : ð 19 Þ In particular , this implies that , for any vector d 2 R N , the time advancing scheme should be able to solve exactly d M ð t Þ z ð t Þ d t ¼ A ð t ; w ð t ÞÞ z ð t Þ ; t 2 I z ð t 0 Þ ¼ d ; 8 < : ð 20 Þ i . e . it should return z n ¼ z ð t n Þ ¼ d for all n such that t n 6 T . L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4103 3 . First - order time discretization schemes Let t 0 < t 1 < (cid:3) (cid:3) (cid:3) < t M ¼ T be a uniform partition of I ¼ ½ t 0 ; T (cid:5) with time step D t and y n an approximation of y ð t n Þ . In [ 4 ] we have analyzed the following modiﬁed implicit Euler scheme , y n þ 1 (cid:4) y n ¼ D t X m l ¼ 0 x l g 1 ð t nl ; U n þ 1 Þ (cid:4) þ g w ð t nl ; U n þ 1 Þ (cid:5) ; ð 21 Þ where x l and t nl are the weights and knots of a quadrature rule I in ½ t n ; t n þ 1 (cid:5) such that I ð f Þ ¼ D t X m l ¼ 0 x l f ð t nl Þ (cid:8) Z t n þ 1 t n f ð s Þ d s : Observe that , if the quadrature rule is taken simply as I ð f Þ ¼ D tf ð t n þ 1 Þ , we recover the classic implicit Euler scheme . In the case of the conservative formulation ( y ¼ MU ) , it is immediately veriﬁed that scheme ( 21 ) , when applied to ( 18 ) , satisﬁes the GCL if and only if the chosen quadrature rule integrates exactly the term R t n þ 1 t n A ð s ; w ð s ÞÞ d s , that is , if the following relation holds 8 i 2 N int D t X m l ¼ 0 x l Z X tnl w i ð t nl Þ $ x (cid:3) w ð t nl Þ d X ¼ Z t n þ 1 t n Z X s w i ð s Þ $ x (cid:3) w ð s Þ d X d s : ð 22 Þ This relation guarantees that the conservation of the geometric quantities expressed by ( 17 ) also holds at discrete level . It can be shown [ 4 ] that ( 22 ) also implies , for all i ; j 2 N , D t X m l ¼ 0 x l Z X tnl w i ð t nl Þ w j ð t nl Þ $ x (cid:3) w ð t nl Þ d X ¼ Z t n þ 1 t n Z X s w i ð s Þ w j ð s Þ $ x (cid:3) w ð s Þ d X d s ; ð 23 Þ and consequently the time advancing scheme would solve exactly ( 20 ) as well . Apart from very particular cases , the domain movement , and thus A t and w , is not known a priori . For instance , this is the situation in ﬂuid structure interaction or free surface ﬂow problems . In these cases , however , in the course of the computation , the position of the computational domain boundary is given at time stations t j , with j ¼ 0 ; 1 ; . . . ; M , and an ALE mapping may be computed at those instants , for instance by employing an harmonic extension of the boundary position . The mapping A s at intermediate instants s 2 ½ t j ; t j þ 1 (cid:5) may then be obtained by interpolation from A t j þ 1 ; A t j ; A t j (cid:4) 1 ; . . . with a polynomial of degree p P 1 . Observe that the reconstructed ALE mapping A s ; 8 s 2 ½ t j ; t j þ 1 (cid:5) provides automatically the reconstruction for the domain velocity since w ¼ o A s o s (cid:1)(cid:1) Y . It is then reasonable to assume that the ALE map , and the domain velocity , is a piecewise polynomial in time . The following two results have been given in [ 4 ] : Proposition 1 . A sufficient condition for the scheme ( 21 ) to fulfill the GCL ( i . e . to satisfy ( 22 ) , or equivalently , ( 23 ) ) is to use a quadrature rule I of degree of exactness equal or grater than d (cid:3) p (cid:4) 1 , where d is the space dimension and p is the degree of the polynomial used to reconstruct in time the ALE mapping within each time step . For a linear in time reconstruction of the ALE mapping ( p ¼ 1 ) a mid - point quadrature rule is suﬃcient for a 2D problem to fulﬁll the GCL , whereas in a 3D problem we should employ , for instance , a two point Gaussian quadrature rule . 4104 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 Proposition 2 . Whenever the scheme ( 21 ) is applied to the conservative formulation ( 15 ) and the quadrature rule I is sufficient to fulfill the GCL and has positive weights x l ; l ¼ 0 ; . . . ; m , then the scheme ( 21 ) is unconditionally stable and the following a priory estimate holds : u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ þ D t l X n i ¼ 0 X m l ¼ 0 x l $ x u i þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X til Þ 6 u 0 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X t 0 Þ þ D t ð 1 þ C X Þ l X n i ¼ 0 X m l ¼ 0 x l f ð t il Þ (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X til Þ : ð 24 Þ Remark 2 . The quantity u nh ¼ P i 2 N u ni w i ð t n Þ may be readily extended to any other conﬁguration X ð s Þ with s 6¼ t n , since u nh (cid:7) A st n ¼ X i 2 N u ni w i ð s Þ : This extension has been implicitly assumed whenever required . In the cited reference it is also shown that the same scheme ( 21 ) , applied to the non - conservative for - mulation ( 12 ) is , in general , only conditionally stable , with a maximum allowable time step that depends on the domain velocity w . Remark 3 . The results of Proposition 2 also holds if the quadrature rule with the appropriate degree of exactness is applied just to the term g w , which is the only one actually involved in the GCL . In particular , we could have considered the following alternative GCL - satisfying scheme y n þ 1 ¼ y n þ D t g 1 ð t n þ 1 ; U n þ 1 Þ þ D t X m l ¼ 0 x l g w ð t nl ; U n þ 1 Þ : ð 25 Þ It can be easily shown that an a priori stability inequality very similar to ( 24 ) can be obtained as well . Yet , scheme ( 21 ) may be more convenient from a programming point of view since we will treat all the terms in the same way . 4 . Second - order time discretization schemes The stability result given in the previous section shows that for the implicit Euler scheme the GCL are suﬃcient conditions to preserve the stability properties that the scheme features when applied to a parabolic problem on a ﬁxed domain . Unfortunately , we will see in this section that this remarkable result is not so general as we would like . We will here consider two second - order time discretization schemes , namely , the Crank – Nicolson and the second - order backward diﬀerence ( hereafter BDF ( 2 ) ) . Both of them are unconditionally stable when applied to problems on a ﬁxed domain . We will show that , even in the case where the GCL are satisﬁed , standard techniques to produce energy estimates of the numerical solution lead to inequalities where a few terms , deriving from the domain movement , have a sign that cannot be a priori determined . The numerical tests presented in a later section conﬁrm that an additional energy contribution to the numerical solution may occur because of the boundary movement . We point out that in the a priori estimate ( 2 ) the domain deformation does not contribute to the energy of the system in the diﬀerential problem , therefore this extra energy contribution is a numerical artifact . L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4105 4 . 1 . The Crank – Nicolson method We will consider here a slight modiﬁcation to the classical Crank – Nicolson method that , for the problem ( 16 ) reads : y n þ 1 (cid:4) y n ¼ D t g 1 t n þ 12 ; U n þ 1 þ U n 2 (cid:7) (cid:8) (cid:9) þ g w t n þ 12 ; U n þ 1 þ U n 2 (cid:7) (cid:8)(cid:10) : ð 26 Þ More precisely , this scheme is a Gauss – Legendre implicit Runge – Kutta method of order 2 . However , with a little abuse on notations , we will refer to it as the Crank – Nicolson method , since it reduces to the latter for a linear advection – diﬀusion equation on a ﬁxed domain and with time - independent coeﬃcients . Observe that the right hand side of ( 26 ) is an approximation of Z t n þ 1 t n g 1 s ; U ð s Þ ð Þ ½ þ g w s ; U ð s Þ ð Þ(cid:5) d s ; by means of a mid - point rule . For 2D problems , this approximation , when applied to the conservative formulation , will automatically satisfy the GCL if the ALE mapping is reconstructed linearly in time in each time slab . In the more general case , we should employ a more accurate quadrature rule , at least for the terms in g w that are related to the domain movement , according to the criterion given in Proposition 1 . For instance we may use y n þ 1 (cid:4) y n ¼ D t X m l ¼ 0 x l g 1 t nl ; U n þ 1 þ U n 2 (cid:7) (cid:8) (cid:9) þ g w t nl ; U n þ 1 þ U n 2 (cid:7) (cid:8)(cid:10) : ð 27 Þ Here m , t nl and x l are chosen so that the resulting scheme satisﬁes the GCL . We are going now to study the stability of this scheme , when applied to the conservative formulation with homogeneous boundary conditions . Scheme ( 27 ) is then equivalent to Z X tn þ 1 u n þ 1 h w h d X (cid:4) Z X tn u nh w h d X þ D t X m l ¼ 0 x l Z X tnl l $ x u n þ 1 h þ u nh 2 (cid:3) $ x w h d X þ D t X m l ¼ 0 x l Z X tnl $ x (cid:3) ð b (cid:9) (cid:4) w ð t n l ÞÞ u n þ 1 h þ u nh 2 (cid:10) w h d X ¼ D t X m l ¼ 0 x l Z X tnl f ð t nl Þ w h d X ; 8 w h 2 X 0 ; h ð X t Þ ; n ¼ 0 ; 1 ; . . . ð 28 Þ with u ih ¼ 0 on o X t ; i 2 N n N int u 0 h ¼ u 0 h in X 0 : As mentioned before , this scheme satisﬁes the GCL . Thus , an immediate consequence of ( 23 ) is that v h k k 2 L 2 ð X tn þ 1 Þ (cid:4) v h k k 2 L 2 ð X tn Þ ¼ D t X m l ¼ 0 x l Z X tnl j v h j 2 $ x (cid:3) w ð t nl Þ d X : ð 29 Þ for any ﬁnite element function v h ð x ; t Þ ¼ P i 2 N v i w i ð x ; t Þ with coeﬃcients v i that do not depend on t . 4106 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 We will ﬁrst derive the following result : Lemma 1 . The discrete solution u nh of scheme ( 28 ) satisfies the inequality u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ þ D t 4 l X m l ¼ 0 x l $ x ð u n þ 1 h (cid:6)(cid:6) þ u nh Þ (cid:6)(cid:6) 2 L 2 ð X tnl Þ (cid:4) D t 4 X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h (cid:4) u nh j 2 d X 6 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ D t ð 1 þ C X Þ l X m l ¼ 0 x l f ð t nl Þ (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X tnl Þ ð 30 Þ for all n ¼ 0 ; 1 ; . . . : Proof . We take in ( 28 ) w h ¼ ð u n þ 1 h þ u nh Þ and we use the identity ð a ; a þ b Þ ¼ 1 2 k a k 2 þ 1 2 k a þ b k 2 (cid:4) 1 2 k b k 2 to write the ﬁrst two terms in ( 28 ) as Z X tn þ 1 u n þ 1 h ð u n þ 1 h þ u nh Þ d X (cid:4) Z X tn u nh ð u n þ 1 h þ u nh Þ d X ¼ 1 2 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ þ 1 2 u n þ 1 h (cid:6)(cid:6) þ u nh (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:4) 1 2 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:4) 1 2 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 2 u n þ 1 h (cid:6)(cid:6) þ u nh (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 2 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ ¼ u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:4) u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X (cid:4) 1 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u nh j 2 d X 2 4 (cid:4) Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h þ u nh j 2 d X 3 5 ¼ u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:4) u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þ u n þ 1 h u nh d X ; ð 31 Þ where we have exploited relation ( 29 ) with v h ¼ u n þ 1 h , v h ¼ u nh , and v h ¼ ð u n þ 1 h þ u nh Þ . Then , Eq . ( 28 ) , with w h ¼ ð u n þ 1 h þ u n h Þ , becomes , after integration by parts of the convective term u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:4) u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þ u n þ 1 h u nh d X þ D t l 2 X m l ¼ 0 x l $ x ð u n þ 1 h (cid:6)(cid:6) þ u nh Þ (cid:6)(cid:6) 2 L 2 ð X tnl Þ (cid:4) D t 4 X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h þ u nh j 2 d X 6 D t ð 1 þ C X Þ l X m l ¼ 0 x l f ð t nl Þ (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X tnl Þ þ D t l 4 X m l ¼ 0 x l $ x ð u n þ 1 h (cid:6)(cid:6) þ u nh Þ (cid:6)(cid:6) 2 L 2 ð X tnl Þ ð 32 Þ and the thesis follows immediately . h Remark 4 . This modiﬁed version of the Crank – Nicolson scheme allowed us to exploit directly the coer - civity of the bilinear form stemming from the Laplace operator to obtain our result . This would have not been possible with the standard scheme , as a consequence of the domain movement . L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4107 Remark 5 . If $ x (cid:3) w < 0 ; 8 x 2 X t and 8 t 2 I ( i . e . in the case of a uniform contraction of the domain ) , we can obtain from ( 30 ) an unconditioned stability result like the one previously obtained for the implicit Euler scheme . In the more general case we can only obtain a conditioned stability where the maximum allowable time step depends on $ x (cid:3) w . More details may be found in [ 10 ] . Remark 6 . In the previous example we enforced the GCL by employing a more accurate quadrature rule to both the terms g 1 and g w . Clearly , we could have applied the more sophisticated quadrature rule only to the term g w . This is enough , indeed , to fulﬁll the GCL . Yet , the former scheme may be preferable from a programming point of view since we will treat all terms in the same way . 4 . 2 . The second - order backward diﬀerence scheme BDF ( 2 ) The second - order backward diﬀerence scheme applied to ( 16 ) reads : 3 2 y n þ 1 (cid:4) 2 y n þ 1 2 y n (cid:4) 1 ¼ g 1 t n þ 1 ; U n þ 1 (cid:11) (cid:12) þ g w ð t n þ 1 ; U n þ 1 Þ ; n P 1 : ð 33 Þ This scheme can be initialized by a one - step second - order method such as , for instance , the Crank – Nicolson one presented in the previous section . This scheme does not satisfy the GCL in general , when applied to the conservative formulation . However , we observe that 3 2 y n þ 1 (cid:4) 2 y n þ 1 2 y n (cid:4) 1 ¼ 3 2 Z t n þ 1 t n g ð s ; U ð s ÞÞ d s (cid:4) 1 2 Z t n t n (cid:4) 1 g ð s ; U ð s ÞÞ d s ; ð 34 Þ where we have set g ¼ g 1 þ g w . We can thus modify scheme ( 33 ) by using a more accurate quadrature rule to integrate the two terms in the right hand side ( while keeping U ð t Þ ¼ U n þ 1 ) . If we carry out this procedure on the whole g , however , we will destroy the coerciveness of the form g 1 since the second integral appears with a negative sign . Consequently , to impose the GCL compliance to the BDF ( 2 ) scheme we are obliged to operate on the term g w only . The modiﬁed scheme reads then , in a general form : 3 2 y n þ 1 (cid:4) 2 y n þ 1 2 y n (cid:4) 1 ¼ g 1 ð t n þ 1 ; U n þ 1 Þ þ 3 2 D t X m l ¼ 0 x l g w ð t nl ; U n þ 1 Þ (cid:4) 1 2 D t X m l ¼ 0 x l g w ð t n (cid:4) 1 l ; U n þ 1 Þ : ð 35 Þ This scheme satisﬁes the GCL provided that the quadrature rule employed for g w fulﬁlls the require - ments given in Proposition 1 . This scheme has already been proposed by Farhat and Koobus [ 7 ] in the context of a ﬁnite volume approximation . In the remaining part of this section , we will derive a stability result for the BDF ( 2 ) scheme ( 35 ) . Again , for the sake of clarity , we rewrite this scheme in the equivalent form 3 2 Z X tn þ 1 u n þ 1 h w h d X (cid:4) 2 Z X tn u nh w h d X þ 1 2 Z X tn (cid:4) 1 u n (cid:4) 1 h w h d X þ D t Z X tn þ 1 l $ x u n þ 1 h (cid:3) $ x w h (cid:4) þ $ x (cid:3) ð b u n þ 1 h Þ (cid:5) w h d X (cid:4) 3 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) ð w ð t n l Þ u n þ 1 h Þ w h d X þ 1 2 D t X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) ð w ð t n (cid:4) 1 l Þ u n þ 1 h Þ w h d X ¼ D t Z X tn þ 1 f n þ 1 w h d X 8 w h 2 X 0 ; h ð X t Þ : ð 36 Þ 4108 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 We will prove the following result : Lemma 2 . The discrete solution u nh of scheme ( 36 ) satisfies the inequality e n þ 1 h þ D t l $ x u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ þ D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X þ D t X m l ¼ 0 Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ j u n þ 1 h j 2 (cid:13) (cid:4) 2 u n þ 1 h u nh (cid:14) d X 6 e nh þ D t ð 1 þ C X Þ l f n þ 1 (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X tn þ 1 Þ ð 37 Þ for all n ¼ 1 ; 2 ; . . . , where e n h ¼ 1 2 u n h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 2 2 u n h (cid:6)(cid:6) (cid:4) u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn (cid:4) 1 Þ : Proof . Let us take w h ¼ u n þ 1 h in ( 36 ) . The ﬁrst three terms can be developed in the following way I ¼ 3 2 Z X tn þ 1 j u n þ 1 h j 2 d X (cid:4) 2 Z X tn u nh u n þ 1 h d X þ 1 2 Z X tn (cid:4) 1 u n (cid:4) 1 h u n þ 1 h d X ¼ 3 2 Z X tn j u n þ 1 h j 2 d X (cid:4) 2 Z X tn u nh u n þ 1 h d X þ 1 2 Z X tn u n (cid:4) 1 h u n þ 1 h d X þ 3 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X (cid:4) 1 2 D t X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ u n (cid:4) 1 h u n þ 1 h d X ð 38 Þ where we have employed relation ( 29 ) with v h ¼ u n þ 1 h and v 2 h ¼ u n (cid:4) 1 h u n þ 1 h . Let us observe , now , that 3 2 Z X tn j u n þ 1 h j 2 d X (cid:4) 2 Z X tn u nh u n þ 1 h d X þ 1 2 Z X tn u n (cid:4) 1 h u n þ 1 h d X ¼ 1 2 Z X tn u n þ 1 h (cid:11) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:12) u n þ 1 h d X þ 1 2 Z X tn 2 u n þ 1 h (cid:11) (cid:4) u nh (cid:12) 2 u n þ 1 h d X (cid:4) Z X tn j u n þ 1 h j 2 d X ¼ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 4 2 u nh (cid:6)(cid:6) (cid:4) u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 4 2 u n þ 1 h (cid:6) (cid:6) (cid:6) (cid:6) 2 L 2 ð X tn Þ þ 1 4 2 u n þ 1 h (cid:6) (cid:6) (cid:4) u n h (cid:6) (cid:6) 2 L 2 ð X tn Þ (cid:4) 1 4 u n h (cid:6) (cid:6) (cid:6) (cid:6) 2 L 2 ð X tn Þ (cid:4) u n þ 1 h (cid:6) (cid:6) (cid:6) (cid:6) 2 L 2 ð X tn Þ ¼ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:7) þ 1 4 2 u n þ 1 h (cid:6)(cid:6) (cid:4) u nh (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:8) þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 4 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:7) þ 1 4 2 u nh (cid:6)(cid:6) (cid:4) u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:8) : ð 39 Þ Then , applying ( 39 ) in ( 38 ) we obtain I ¼ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 4 2 u n þ 1 h (cid:6)(cid:6) (cid:4) u nh (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 4 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:4) 1 4 2 u n h (cid:6)(cid:6) (cid:4) u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn Þ þ 3 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t n l Þj u n þ 1 h j 2 d X (cid:4) 1 2 D t X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ u n (cid:4) 1 h u n þ 1 h d X L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4109 ¼ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ (cid:7) þ 1 4 2 u n þ 1 h (cid:6)(cid:6) (cid:4) u nh (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:8) þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn (cid:4) 1 Þ (cid:4) 1 4 u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ (cid:7) þ 1 4 2 u nh (cid:6)(cid:6) (cid:4) u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn (cid:4) 1 Þ (cid:8) þ 5 4 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X þ D t 4 X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ u n þ 1 h (cid:11)h (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:12) 2 (cid:4) 2 u nh (cid:11) (cid:4) u n (cid:4) 1 h (cid:12) 2 (cid:4) 2 u n (cid:4) 1 h u n þ 1 h i d X ¼ 1 2 ð e n þ 1 h (cid:4) e nh Þ þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn (cid:4) 1 Þ þ 5 4 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X þ 1 4 D t X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ j u n þ 1 h j 2 (cid:13) (cid:4) 4 u n þ 1 h u nh (cid:14) d X : Finally , by integrating by parts the convective terms in ( 36 ) and employing the previous result we have 1 2 ð e n þ 1 h (cid:4) e nh Þ þ 1 4 u n þ 1 h (cid:6)(cid:6) (cid:4) 2 u nh þ u n (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X tn (cid:4) 1 Þ þ 1 2 D t X m l ¼ 0 x l Z X tnl $ x (cid:3) w ð t nl Þj u n þ 1 h j 2 d X þ 1 2 D t X m l ¼ 0 x l Z X tn (cid:4) 1 l $ x (cid:3) w ð t n (cid:4) 1 l Þ j u n þ 1 h j 2 (cid:13) (cid:4) 2 u n þ 1 h u nh (cid:14) d X þ D t l $ x u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ 6 D t ð 1 þ C X Þ 2 l f n þ 1 (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X tn þ 1 Þ þ D t l 2 $ x u n þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn þ 1 Þ ð 40 Þ from which inequality ( 37 ) follows . h Should the domain be ﬁxed , we would have the following global stability result e n þ 1 h þ 1 2 X n i ¼ 1 u i þ 1 h (cid:6)(cid:6) (cid:4) 2 u ih þ u i (cid:4) 1 h (cid:6)(cid:6) 2 L 2 ð X Þ þ D t l X n i ¼ 1 $ x u i þ 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X Þ 6 e 1 h þ D t ð 1 þ C X Þ l X n i ¼ 1 f i þ 1 (cid:6)(cid:6) (cid:6)(cid:6) 2 H (cid:4) 1 ð X Þ ð 41 Þ without any condition on D t . In the case where the domain moves , we may recover a conditional stability result where the time step is bounded by quantities depending on the domain movement ( more precisely on $ x (cid:3) w ) . Again we refer to [ 10 ] for more details . Remark 7 . In a ﬁxed domain problem , the quantity e nh turns out to be monotonically decreasing whenever f ¼ 0 . Observe that e nh ! u h ð t n Þ k k 2 L 2 ð X Þ when D t ! 0 . From ( 41 ) , we can also quantify the numerical dissi - pation of the scheme in the term 12 P ni ¼ 1 u i þ 1 h (cid:4) 2 u ih þ u i (cid:4) 1 h (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X Þ . 5 . Numerical assessment We have considered the model advection – diﬀusion problem ( 1 ) in a 2D domain . The ALE mapping has been constructed by solving a Laplace problem at each time step t n : D Y A t n ¼ 0 in X 0 A t n ¼ Y þ g n on o X 0 (cid:2) ð 42 Þ g n being the displacement of the domain boundary at time t n . 4110 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 We have considered both a piecewise linear and piecewise quadratic in time interpolations in each time slab ½ t n ; t n þ 1 (cid:5) . The latter is obtained by interpolating the mappings A t n þ 1 , A t n and A t n (cid:4) 1 . In both cases , we have taken w ð Y ; t n Þ ¼ lim t ! t n (cid:4) w ð Y ; t Þ since w is discontinuous at the time instants t n . All the numerical schemes proposed in the previous sections , i . e . the implicit Euler , the Crank – Nicolson and the BDF ( 2 ) schemes in both conservative and non - conservative formulation ( in the following indicated by the suﬃxes c and nc , respectively ) have been implemented . In the non - conservative case , we have implemented the ‘‘standard version’’ of the aforementioned schemes since there is no need to modify them in order to satisfy the GCL . On the other hand , for the conservative formulation , we have considered the ‘‘standard’’ time discretization , which , in general , does not satisfy the GCL ( in the following indicated with the suﬃx noGCL ) , the modiﬁed discretization that satisﬁes the GCL for a linear in time deformation of the domain ( suﬃx GCL1 ) and the one that satisﬁes the GCL for a quadratic in time domain deformation ( suﬃx GCL2 ) . The quadrature formula I utilized is the mid - point rule for the schemes GCL1 and the two point Gaussian quadrature formula for the schemes GCL2 . We remind that , for a 2D problem , the Crank – Nicolson scheme ( 28 ) always satisﬁes the GCL for a linear in time deformation of the domain . Then , in this case , scheme GCL0 coincides with GCL1 . We present hereafter two test cases . The ﬁrst one aims at validating the stability results derived in the previous sections while the second one will focus on time accuracy . 5 . 1 . First test case – – stability analysis We have taken as reference domain X 0 the unit 2D square . The domain deformation is given by x ¼ A t ð Y Þ : x 1 ¼ Y 1 ½ 2 (cid:4) cos ð 20 p t Þ(cid:5) x 2 ¼ Y 2 ½ 2 (cid:4) cos ð 20 p t Þ(cid:5) (cid:2) : ð 43 Þ We observe that the deformed domain is still a square that expands and contracts periodically with a period T ¼ 1 = 10 . Moreover , since A t ð Y Þ is linear in Y , by solving a Laplace problem at each time step t n for the discrete ALE mapping , we recover the deformation given in ( 43 ) exactly . Yet , this deformation is interpolated polynomially in time in each time - slab . Thus , the numerical rep - resentation of the domain is not exact for t 6¼ t n , n ¼ 1 ; 2 ; . . . . We have considered the problem o u o t (cid:4) 0 : 01 D u ¼ 0 ; in X t u ¼ 0 ; on o X t u ð 0 Þ ¼ 1600 Y 1 ð 1 (cid:4) Y 1 Þ Y 2 ð 1 (cid:4) Y 2 Þ ; in X 0 : 8 > > < > > : ð 44 Þ Observe that , as a consequence of the stability estimate ( 2 ) , for such a problem u ð t Þ k k L 2 ð X t Þ is a decreasing quantity . Problem ( 44 ) has been discretized in space with P 1 ﬁnite elements . The monotonicity property of the L 2 norm of the solution is clearly valid for the semi - discrete problem as well . When problem ( 44 ) is deﬁned on a ﬁxed domain , the implicit - Euler and the Crank – Nicolson schemes preserve that property , i . e . the computed solution u nh has a decreasing L 2 norm . On the other hand , when considering a moving domain , starting from our estimates , we should expect that only the implicit Euler scheme applied to the conservative formulation and satisfying the GCL will preserve that property . Figs . 1 and 2 show , for the two schemes and the two cases of a linear and a quadratic interpolation of the domain deformation , the computed quantity u nh (cid:6)(cid:6) (cid:6)(cid:6) 2 L 2 ð X tn Þ together with the ‘‘exact’’ norm u h ð t Þ k k 2 L 2 ð X t Þ of the solution of the semi - discrete problem ( computed on the same mesh but with a very small time step ) during L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4111 the time interval ½ 0 ; 0 : 4 (cid:5) ( corresponding to 4 periods of oscillation of the domain ) . In all cases we have used a time step D t ¼ 0 : 01 . We can observe that , only the implicit Euler discretization which satisﬁes the GCL , applied to the conservative formulation , is strictly monotone , as it was predicted by our estimates . Furthermore , for the Crank – Nicolson scheme , the L 2 norm increases during the expansion of the domain and decreases during the contraction phase , coherently with estimate ( 30 ) . The BDF ( 2 ) scheme , even when applied to problem ( 44 ) on a ﬁxed domain , does not feature the monotonicity property of the L 2 norm of the solution . On the other hand , as shown by estimate ( 37 ) , the quantity which turns out to be decreasing , for a problem on a ﬁxed domain , is e n h ¼ 12 u n h (cid:6) (cid:6) (cid:6) (cid:6) 2 L 2 ð X tn Þ þ 12 2 u n h (cid:4) (cid:6) (cid:6) u n (cid:4) 1 h k 2 L 2 ð X tn (cid:4) 1 Þ ( see Remark 7 ) . Fig . 3 shows the quantity e nh for the diﬀerent versions of the BDF ( 2 ) scheme and for the two cases of a linear and a quadratic in time interpolation of the domain deformation . On the same picture , we report also 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 Implicit Euler – linear displacement time IE - nc IE - c - noGCL IE - c - GCL1 exact 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 Implicit Euler – quadratic displacement time IE - nc IE - c - noGCL IE - c - GCL1 IE - c - GCL2 exact Fig . 1 . Test case 1 : L 2 norm of the computed and ‘‘exact’’ solution as a function of time for the implicit Euler scheme . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 Crank – Nicolson – linear displacement time CN - nc CN - c - GCL1 exact 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 Crank – Nicolson – quadratic displacement time CN - nc CN - c - GCL1 CN - c - GCL2 exact Fig . 2 . Test case 1 : L 2 norm of the computed and ‘‘exact’’ solution as a function of time for the Crank – Nicolson scheme . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . 4112 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 the norm u h ð t Þ k k L 2 ð X t Þ of the ‘‘exact’’ solution . It is evident that the quantity e nh is not decreasing , coherently with estimate ( 37 ) . Finally , in Fig . 4 , we report the L 2 norm u nh (cid:6)(cid:6) (cid:6)(cid:6) L 2 ð X tn Þ of the solution computed by the BDF ( 2 ) scheme . This ﬁgure highlights the dissipation properties of this scheme and should be compared to Figs . 1 and 2 . 5 . 2 . Second test case – – error analysis in time We have considered again as reference conﬁguration X 0 the unit 2D square . The domain deformation is given by x ¼ A t ð Y Þ : x 1 ¼ Y 1 ½ 2 (cid:4) cos ð 10 p t Þ(cid:5) x 2 ¼ Y 2 ½ 2 (cid:4) cos ð 10 p t Þ(cid:5) : (cid:2) ð 45 Þ 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 10 20 30 40 50 60 70 80 BDF ( 2 ) – linear displacement time BDF - nc BDF - c - noGCL BDF - c - GCL1 exact 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 20 30 40 50 60 70 80 90 BDF ( 2 ) – quadratic displacement time BDF - nc BDF - c - noGCL BDF - c - GCL1 BDF - c - GCL2 exact Fig . 3 . Test case 1 : quantity e nh as a function of time computed by the BDF ( 2 ) scheme , compared to the ‘‘exact’’ value u h ð t Þ k k L 2 ð X t Þ ¼ lim D t ! 0 e nh . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 BDF ( 2 ) – linear displacement time BDF - nc BDF - c - noGCL BDF - c - GCL1 exact 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 0 10 20 30 40 50 60 BDF ( 2 ) – quadratic displacement time BDFnc BDF - c - noGCL BDF - c - GCL1 BDF - c - GCL2 exact Fig . 4 . Test case 1 : L 2 norm of the computed and ‘‘exact’’ solution as a function of time for the BDF ( 2 ) scheme . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4113 The problem we have considered is o u o t (cid:4) 0 : 1 D u ¼ f ; in X t u ¼ 0 ; on o X t u ð 0 Þ ¼ 16 Y 1 ð 1 (cid:4) Y 1 Þ Y 2 ð 1 (cid:4) Y 2 Þ ; in X 0 : 8 > < > : ð 46 Þ The forcing term f has been chosen in such a way that the corresponding exact solution u ð Y ; t Þ is u ð Y ; t Þ ¼ 16 1 (cid:7) þ 1 2 sin ð 5 p t Þ (cid:8) Y 1 ð 1 (cid:4) Y 1 Þ Y 2 ð 1 (cid:4) Y 2 Þ : Problem ( 46 ) has been discretized in space with P 2 isoparametric elements . Fig . 5 shows the mesh used ( on the left ) and the initial solution ( on the right ) . We have taken a sequence of decreasing time steps D t ¼ 1 = 20 ; 1 = 40 ; . . . ; 1 = 320 and we have computed the L 2 norm of the error at time t ¼ 0 : 3 over the actual domain X t . In all cases the error is dominated by the time discretization . The results obtained are presented in Figs . 6 – 8 for the implicit Euler , the Crank – Nicolson and the BDF ( 2 ) schemes , respectively . We observe that all the diﬀerent implementations of the implicit Euler scheme are linearly convergent in time while all the Crank – Nicolson ones are quadratically convergent . 0 1 0 1 0 1 X Y Z 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8 0 . 9 0 . 9992 0 1 0 1 Fig . 5 . Mesh and initial solution of the problem illustrated in test case 3 . 10 – 3 10 – 2 10 – 1 10 – 4 10 – 3 10 – 2 10 – 1 10 0 Implicit Euler - linear displacement | | u ( t n ) – u hn | | | | u ( t n ) – u hn | | IE - nc IE - c - noGCL IE - c - GCL1 – 1 – 2 10 – 3 10 – 2 10 – 1 10 – 4 10 – 3 10 – 2 10 – 1 10 0 10 1 Implicit Euler - quadratic displacement IE - nc IE - c - noGCL IE - c - GCL1 IE - c - GCL2 – 1 – 2 Fig . 6 . Test case 3 : error in the L 2 norm as a function of the time step D t for the implicit Euler scheme . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . 4114 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 On the contrary , the BDF ( 2 ) scheme , applied to the non - conservative formulation or to the conservative one , without satisfying the GCL , is only linearly convergent when a linear in time interpolation of the domain deformation is considered . We recover a second - order accuracy when employing a quadratic interpolation of the domain deformation . Finally , we remark that the BDF ( 2 ) scheme that satisﬁes the GCL , applied to the conservative for - mulation , preserves the second - order accuracy even though the domain deformation is only linearly interpolated in time . 6 . Conclusions This work shows how a careful choice of the time integration formula and mesh movement / velocity reconstruction allows to maintain a high order time accuracy of a numerical scheme applied to a moving domain problem . However it also shows the diﬃculties , for the discrete problem , in maintaining unconditional stability in the moving mesh case , irrespectively on the domain velocity . This is a potential problem since in 10 – 3 10 – 2 10 – 1 10 – 3 10 – 2 10 – 1 10 – 4 10 – 3 10 – 2 10 – 1 10 0 10 1 10 – 4 10 – 3 10 – 2 10 – 1 10 0 10 1 | | u ( t n ) – u hn | | | | u ( t n ) – u hn | | Crank - Nicolson – linear displacement CN - nc CN - c - GCL1 – 1 – 2 Crank - Nicolson – quadratic displacement CN - nc CN - c - GCL1 CN - c - GCL2 – 1 – 2 Fig . 7 . Test case 3 : error in the L 2 norm as a function of the time step D t for the Crank – Nicolson scheme . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . 10 – 3 10 – 2 10 – 1 10 – 3 10 – 2 10 – 1 10 – 4 10 – 3 10 – 2 10 1 10 0 10 – 4 10 – 3 10 – 2 10 1 10 0 | | u ( t n ) – u hn | | | | u ( t n ) – u hn | | BDF ( 2 ) - linear displacement BDF - nc BDF - c - noGCL BDF - c - GCL1 – 1 – 2 BDF ( 2 ) - quadratic displacement BDF - nc BDF - c - noGCL BDF - c - GCL1 BDF - c - GCL2 – 1 – 2 Fig . 8 . Test case 3 : error in the L 2 norm as a function of the time step D t for the BDF ( 2 ) . Interpolation in time of the domain deformation : linear on the left and quadratic on the right . L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116 4115 ﬂuid - structure interaction the boundary velocity ( and consequently the domain velocity reconstructed through the ALE map ) is itself an unknown . In non - linear problems , this diﬃculties may be even ampliﬁed by non - linear instability issues . Another ﬁnding is that the satisfaction of the GCL is neither a necessary nor a suﬃcient condition for stability , apart from special cases like the backward Euler scheme . This in principle could reduce the interest in GCL - satisfying schemes . However , we may say , also in view of the results shown in [ 3 ] that satisfying the GCL might help in improving the accuracy of the scheme and , in special cases , also to en - hance stability . Therefore , in particular for ﬂuid structure problems , it might be a good idea to stick to GCL - satisfying schemes . Part of the analysis illustrated in this work has been extended to ﬂuid - structure interaction problems , where the ﬂuid is modeled by the incompressible Navier – Stokes equation [ 10 ] and has not been reported here for the sake of brevity . References [ 1 ] R . Aris , Vectors , Tensors , and the Basic Equations of Fluid Mechanics , Dover Publications Inc . , 1989 . [ 2 ] H . Brezis , Analyse Fonctionnelle , Th (cid:1) eorie et Applications , Masson , 1983 . [ 3 ] C . Fahrat , P . Geuzaine , C . Grandmont , The discrete geometric conservation law and the non - linear stability of ALE schemes for the solution of ﬂow problems on moving grids , J . Comp . Phys . 174 ( 2001 ) 669 – 692 . [ 4 ] L . Formaggia , F . Nobile , A stability analysis for the Arbitrary Lagrangian Eulerian formulation with ﬁnite elements , East – West J . Num . Math . 7 ( 1999 ) 105 – 132 . [ 5 ] P . Geuzaine , C . Grandmont , C . Fahrat , Design and analysis of ALE schemes with provable second - order time - accuracy for inviscid and viscous ﬂow simulations , J . Comp . Phys . 191 ( 2003 ) 206 – 227 . [ 6 ] H . Guillard , C . Farhat , On the signiﬁcance of the geometric conservation law for ﬂow computations on moving meshes , Comput . Methods Appl . Mech . Engrg . 190 ( 2000 ) 1467 – 1482 . [ 7 ] B . Koobus , C . Farhat , Second - order time - accurate and geometrically conservative implicit schemes for ﬂow computations on unstructured dynamic meshes , Comput . Methods Appl . Mech . Engrg . 170 ( 1999 ) 103 – 129 . [ 8 ] M . Lesoinne , C . Farhat , Geometric conservation laws for aeroelastic computations using unstructured dynamics meshes , AIAA - 95 - 1709 , Presented at the 12th AIAA Computational Fluid Dynamics Conference , San Diego , June 1995 . [ 9 ] M . Lesoinne , C . Farhat , Geometric conservation laws for ﬂow problems with moving boundaries and deformable meshes , and their impact in aeroelastic computations , Comput . Methods Appl . Mech . Engrg . 134 ( 1996 ) 71 – 90 . [ 10 ] F . Nobile , Numerical approximation of ﬂuid - structure interaction problems with application to haemodynamics , Ph . D . thesis , (cid:1) Ecole Polytechnique F (cid:1) ed (cid:1) erale de Lausanne , 2001 . Thesis No . 2458 . [ 11 ] A . Quarteroni , A . Valli , Numerical Approximation of Partial Diﬀerential Equations , Springer Verlag , 1994 . [ 12 ] P . D . Thomas , C . K . Lombard , Geometric conservation law and its application to ﬂow computations on moving grids , AIAA J . 17 ( 1979 ) 1030 – 1037 . [ 13 ] H . Zhang , M . Reggio , J . Y . Tr (cid:2) epanier , R . Camarero , Geometric form of the GCL for moving meshes and its implementation in CFD schemes , Comput . Fluids 22 ( 1 ) ( 1993 ) 9 – 23 . 4116 L . Formaggia , F . Nobile / Comput . Methods Appl . Mech . Engrg . 193 ( 2004 ) 4097 – 4116
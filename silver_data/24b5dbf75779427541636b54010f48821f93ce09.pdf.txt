Multiwfn : A Multifunctional Wavefunction Analyzer Tian Lu [ a ] * and Feiwu Chen [ a ] Multiwfn is a multifunctional program for wavefunction analysis . Its main functions are : ( 1 ) Calculating and visualizing real space function , such as electrostatic potential and electron localization function at point , in a line , in a plane or in a spatial scope . ( 2 ) Population analysis . ( 3 ) Bond order analysis . ( 4 ) Orbital composition analysis . ( 5 ) Plot density - of - states and spectrum . ( 6 ) Topology analysis for electron density . Some other useful utilities involved in quantum chemistry studies are also provided . The built - in graph module enables the results of wavefunction analysis to be plotted directly or exported to high - quality graphic file . The program interface is very user - friendly and suitable for both research and teaching purpose . The code of Multiwfn is substantially optimized and parallelized . Its efficiency is demonstrated to be significantly higher than related programs with the same functions . Five practical examples involving a wide variety of systems and analysis methods are given to illustrate the usefulness of Multiwfn . The program is free of charge and open - source . Its precompiled file and source codes are available from http : / / multiwfn . codeplex . com . V C 2011 Wiley Periodicals , Inc . DOI : 10 . 1002 / jcc . 22885 Introduction According to quantum theory , a system wavefunction contains all information needed . However , it is often a rather compli - cated function and may be viewed as a black box . In common quantum chemistry calculations only energy is usually extracted . Evidently , this is insufficient to fully interpret intrinsic characteristics of electron structures . To obtain more informa - tion of chemical interest , wavefunction analysis technologies [ 1 , 2 ] must be used for further disclosing the black box . Unfortu - nately , only minimal wavefunction analysis methods are avail - able in most of mainstream quantum chemistry packages . Although there are plenty of standalone wavefunction analysis programs , [ 3 – 8 ] some are limited to certain analysis techniques and some are inconvenient to use or have low efficiency . We feel that it is quite meaningful to develop a new program that integrated most of important wavefunction analysis methods , meanwhile , and is very easy to use and have high efficiency . Multiwfn is such a wavefunction analyzer running on Win - dows and Linux platform . It is especially good at visual study of real space functions such as electrostatic potential ( ESP ) and electron localization function ( ELF ) . [ 9 ] Multiwfn accepts wavefunctions in PROAIM format , which has been supported by many quantum chemistry packages . Some other file types such as Gaussian formatted checkpoint file and NBO plot files are also supported . Multiwfn is free and open source . Its size is very small ( about 3MB ) . The latest version can be down - loaded at http : / / multiwfn . codeplex . com . The rest of this article is organized as follows : Section ‘‘Theo - retical Backgrounds’’ briefs involved theoretical backgrounds , Section ‘‘Program’’ introduces various aspects of Multiwfn , in Section ‘‘Efficiency , ’’ efficiency comparison between Multiwfn and related programs is given , and Section ‘‘Practical Applica - tions’’ presents five practical applications to illustrate the use - fulness of Multiwfn . Theoretical Backgrounds Real space functions Visualization of real space functions is an important and con - venient way of studying electron structure . Multiwfn supports almost all valuable real space functions , and they will be sketched in turn . The functions involved from Sections ‘‘elec - tron density’’ to ‘‘sign ( k 2 ) * q ’’ are purely based on electron den - sity and , thus , they can be obtained not only by quantum chemistry calculations but also by experimental techniques such as X - ray diffraction . The functions involved from Sections ‘‘value of orbital wavefunction’’ to ‘‘Fermi hole and Fermi corre - lation factor function’’ are directly based on wavefunctions , and they are useful but unobservable experimentally . Three special real space functions presented in Multiwfn are briefed in Sections ‘‘ESP from nuclear or atomic charges’’ and ‘‘promo - lecular and deformation properties . ’’ Electron density q ð r Þ ¼ X i g i u i ð r Þ j j 2 ¼ X i g i X l C l : i v l ð r Þ (cid:1)(cid:1)(cid:1)(cid:1)(cid:1) (cid:1)(cid:1)(cid:1)(cid:1)(cid:1) 2 ; ( 1 ) where u and g correspond to the natural orbital and its occu - pation number , respectively . v denotes basis function , and C is coefficient matrix . [ a ] T . Lu , F . Chen Department of chemistry and chemical engineer , School of Chemical and Biological Engineering , University of Science and Technology Beijing , Beijing 100083 , People’s Republic of China E - mail : sobereva @ sina . com Contract / grant sponsor : National Natural Science foundation of China ; contract / grant number : 20773011 . V C 2011 Wiley Periodicals , Inc . 580 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG Gradient norm of electron density r q ð r Þ j j ¼ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ @ q ð r Þ @ x 8 > : 9 > ; 2 þ @ q ð r Þ @ y 8 > > : 9 > > ; 2 þ @ q ð r Þ @ z 8 > : 9 > ; 2 s : ( 2 ) Laplacian of electron density r 2 q ð r Þ ¼ @ 2 q ð r Þ @ x 2 þ @ 2 q ð r Þ @ y 2 þ @ 2 q ð r Þ @ z 2 : ( 3 ) The positive and negative values correspond to electron den - sity locally depleted and concentrated , respectively . The rela - tionships between ! 2 q and valence shell electron pair repulsion model , chemical bond type , electron localization , and chemical reactivity have been built . [ 10 – 12 ] Electron spin density and spin polarization parameter Spin den - sity is defined as follows : q s ð r Þ ¼ q a ð r Þ (cid:1) q b ð r Þ : ( 4 ) A similar function named spin polarization parameter [ 13 ] is expressed as follows : f ð r Þ ¼ q a ð r Þ (cid:1) q b ð r Þ q a ð r Þ þ q b ð r Þ : ( 5 ) The absolute value of f going from zero to unity corresponds to local region going from unpolarized case to completely polarized case . Electrostatic potential V tot ð r Þ ¼ V nu ð r Þ þ V ele ð r Þ ¼ X A Z A r (cid:1) R A j j (cid:1) Z q ð r 0 Þ r (cid:1) r 0 j j d r 0 : ( 6 ) 2This function measures the electrostatic interaction between a unit point charge placed at r and the system of interest . A positive ( negative ) value implies that current position is domi - nated by nuclear ( electronic ) charges . Molecular ESP has been widely used for prediction of nucleophilic and electrophilic sites for a long time . It is also valuable in studying hydrogen bonds , halogen bonds , molecular recognitions , and the inter - molecular interaction of aromatics . [ 14 ] Moreover , on the basis of statistical analysis , Murray et al . found a set of functions called GIPF , [ 15 ] which connects ESP in molecular surface and macroscopic properties . The links between ESP and covalent radii , electronegativity , and system energy were reviewed in Ref . [ 16 ] . Local information entropy : Information entropy [ 17 ] is a quantifi - cation of information , and this theory was proposed by Shan - non in his study of information transmission in noise channel ; nowadays , its application has been largely widened to other areas , including theoretical chemistry . For example , Aslangul et al . attempted to decompose diatomic and triatomic mole - cules into mutually exclusive space by minimizing information entropy [ 18 ] ; Parr et al . discussed the relationship between infor - mation entropy and atom partition as well as molecular simi - larity . [ 19 , 20 ] The formula of Shannon’s information entropy for normalized and continuous probability function is as follows : S ¼ (cid:1) Z P ð x Þ ln P ð x Þ dx : ( 7 ) For chemical system , if P ( x ) is replaced by q ( r ) / N , then the inte - grand may be called local information entropy of electrons s ð r Þ ¼ (cid:1) q ð r Þ = N ð Þ ln q ð r Þ = N ð Þ : ( 8 ) Reduced density gradient : Reduced density gradient ( RDG ) [ 21 ] is defined as ( constant coefficient is ignored ) follows : RDG ð r Þ ¼ jr q ð r Þj q 4 = 3 ð r Þ : ( 9 ) The original intention for introducing RDG is to convert den - sity gradient , namely eq . ( 2 ) , to a dimensionless quantity . Recently , Johnson et al . found that the isosurface of RDG is a very valuable tool for revealing weak interaction regions . [ 22 ] The mechanism is easy to be explained by Table 1 . From Table 1 , it is clear that different area can be distin - guished according to different magnitude of real space func - tions . In the low electron density area , the RDG isosurfaces with small isovalue reveal a weak interaction region . Sign ( k 2 ) * q : In Bader’s QTAIM theory [ 11 ] ( also see below ) , ( 3 , (cid:1) 1 ) type critical point ( CP ) usually appears in chemical bond path or between atom pairs that have weak attractive interaction , whereas ( 3 , þ 1 ) generally appears in the center of ring system and displays steric effect . The criterion for distinguishing ( 3 , (cid:1) 1 ) and ( 3 , þ 1 ) is the sign of k 2 , that is , the second largest eigenvalue of Hessian matrix of electron density . Besides , the strength of weak interaction has positive correlation with q ( r ) . Hence , a new function can be defined as follows [ 22 ] : K ð r Þ ¼ Sign ð k 2 ð r ÞÞ q ð r Þ : ( 10 ) where the Sign is the operator used to extract the sign of vari - able . If the value of K ( r ) is represented by colors and mapped onto RDG isosurfaces , then not only the region of weak interac - tion but also the type and strength are revealed visually . We will illustrate the power of this visual analysis method by practical examples in Section ‘‘weak interaction analysis of urea crystal . ’’ Weak interaction has significant influence on conformation of macromolecules and binding mode of proteins and ligands ; unfortunately , reproduction of electron density by ab initio and grid data calculation of RDG and Sign ( k 2 ) * q for such huge systems are always too time consuming . However , electron Table 1 . The magnitude of electron density , its gradient norm , and reduced density gradient in different area . Aroundnuclei Around chemicalbond Weak interactionregion Edge of molecule | ! q ( r ) | Large 0 – Minor 0 – Small Very small – Small q ( r ) Large Medium Small 0 – Small RDG ( r ) Medium 0 – Minor 0 – Medium Medium – Very large WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 581 density can be approximately constructed by superposing electron densities of free - state atoms , which are the so - called promolecular approximation . Johnson et al . found that weak interaction analysis under this approximate density is still rea - sonable . [ 22 ] The fitted densities of free - state atoms by Slater - type orbitals are already prebuilt in Multiwfn . Value of orbital wavefunction : u i ð r Þ ¼ X l C l ; i v l ð r Þ : ( 11 ) Hamiltonian kinetic energy density : The kinetic energy density is not uniquely defined , [ 11 , 23 ] because the expected value of ki - netic energy operator < w | (cid:1) ( 1 / 2 ) ! 2 | w > can be recovered by integrating kinetic energy density from alternative definitions . One of commonly used definition is as follows : K ð r Þ ¼ (cid:1) 1 2 X i g i u (cid:2) i ð r Þr 2 u i ð r Þ : ( 12 ) Lagrangian kinetic energy density : The shortcoming of Hamil - tonian kinetic energy density is that the value is not always positive and real , another definition that has more clear physi - cal meaning is as follows : G ð r Þ ¼ 1 2 X i g i r u i ð r Þ j j 2 : ( 13 ) Electron localization function : The larger the electron localization is in a region , the more likely the electron motion is confined within it . If electrons are completely localized , then they can be distinguished from the ones outside . Bader and Stephens found that the regions that have large electron localization must have large magnitudes of Fermi hole integration . [ 10 ] However , the Fermi hole is a six - dimensional function and , thus , difficult to be studied visually . Becke and Edgecombe noted that spherically averaged like - spin conditional pair probability has direct correla - tion with the Fermi hole and then suggested the following ELF [ 9 ] ELF ð r Þ ¼ 1 1 þ D ð r Þ = D 0 ð r Þ ð Þ 2 ; ( 14 ) where D ð r Þ ¼ 1 2 X occ i r u i j j 2 (cid:1) 1 8 r q a ð r Þ j j 2 q a ð r Þ þ r q b ð r Þ (cid:1)(cid:1) (cid:1)(cid:1) 2 q b ð r Þ " # D 0 ð r Þ ¼ 3 10 ð 6 p 2 Þ 2 = 3 q a ð r Þ 5 = 3 þ q b ð r Þ 5 = 3 h i : ð 15 Þ u i denotes spin orbital . D 0 ( r ) is the counterpart of D ( r ) for nonin - teraction homogenous electron gas . Note that above expression is a generalization of ELF for spin - polarized problems . [ 24 ] It reduces to its original definition [ 9 ] for closed - shell system when q a ( r ) is equal to q b ( r ) . Savin et al . have reinterpreted ELF in the view of kinetic energy , [ 25 , 26 ] which made ELF also meaningful for Kohn – Sham DFT wavefunction . [ 13 ] They indicated that D ( r ) reveals the excess kinetic energy density caused by Pauli repulsion , whereas D 0 ( r ) can be considered as Thomas – Fermi kinetic energy density . Because D 0 ( r ) is introduced into ELF as a reference , what the ELF reveals is actually a relative localization . ELF is within the range of [ 0 , 1 ] . A large ELF value means that electrons are greatly localized , indicating that there will be a cova - lent bond , a lone pair or inner shells of an atom involved . ELF has been widely used for a wide variety of systems , such as organic and inorganic small molecules , [ 27 ] atomic crystals , [ 25 ] coordination compounds , [ 28 ] clusters , [ 29 ] and for different problems , such as the atomic shell structure , [ 24 ] classifications of chemical bonding modes , [ 26 ] and verifications of charge - shift bond . [ 30 ] An approximate version of ELF has been put forward by Tsirelson and Stash , [ 31 ] in which the actual kinetic energy term is replaced by Kirzhnits - type second - order gradient expansion 1 2 X occ i r u i j j 2 (cid:3) D 0 ð r Þþð 1 = 72 Þ r q ð r Þ j j 2 = q ð r Þþð 1 = 6 Þr 2 q ð r Þ : ð 16 Þ With eq . ( 16 ) , ELF is completely independent of the wavefunc - tion of system of interest and then can be used conveniently to analyze electron density from X - ray diffraction data . Localized orbital locator : Localized orbital locator ( LOL ) pro - posed by Schmider and Becke [ 32 ] is another function for char - acterizing electron localization . LOL ð r Þ ¼ s ð r Þ 1 þ s ð r Þ : ( 17 ) The s ( r ) used in Multiwfn is a generalized form , which can be written as follows : s ð r Þ ¼ s LSDA s exact ¼ ð 3 = 10 Þð 6 p 2 Þ 2 = 3 ½ q a ð r Þ 5 = 3 þ q b ð r Þ 5 = 3 (cid:4) ð 1 = 2 Þ P occ i r u i ð r Þ j j 2 : ( 18 ) When only alpha or beta electrons presents , the above formula returns to the original form . [ 32 ] LOL has similar expression com - pared with ELF . Actually , the chemically significant regions that highlighted by LOL and ELF are generally qualitative compara - ble , whereas Jacobsen pointed out that LOL conveys more deci - sive and clearer picture than ELF . [ 33 ] Obviously , LOL can be interpreted in kinetic energy way as for ELF ; however , LOL can also be interpreted in view of localized orbital . Small ( large ) LOL value usually appears in boundary ( inner ) region of localized orbitals because the gradient of orbital wavefunction is large ( small ) in this area . The value range of LOL is the same as ELF , namely [ 0 , 1 ] . Like what they did for ELF , Tsirelson and Stash [ 34 ] substituted s exact in eq . ( 18 ) with the density expansion in eq . ( 16 ) and then obtained an approximate version of LOL . Average local ionization energy : Average local ionization energy [ 35 ] is written as follows : (cid:1) I ð r Þ ¼ P i q i ð r Þj e i j q ð r Þ ; ( 19 ) where q i ( r ) and e i are the electron density function and orbital energy of the i th molecular orbital , respectively . This function SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 582 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM has many uses , for example , reproducing atomic shell struc - ture , measuring electronegativity , quantifying local polarizabil - ity and hardness , and predicting sites for electrophilic or radi - cal attack . There are many potential uses of I ( r ) waiting for further investigation . An excellent review of I ( r ) has been given by Politzer et al . [ 36 ] Fermi hole and Fermi correlation factor function : Fermi hole function reveals the decrease of probability of finding another like - spin electron at r 2 owing to Pauli repulsion when a electron pres - ent at r 1 . The function for r spin electrons is defined as follows [ 23 ] : h rr ð r 1 ; r 2 Þ ¼ q rr 2 ð r 1 ; r 2 Þ q r ð r 1 Þ (cid:1) q r ð r 2 Þ : ( 20 ) The value range is from (cid:1) q r ( r 2 ) to zero . For single - determinant wavefunctions , this function can be explicitly written as follows : h rr ð r 1 ; r 2 Þ ¼ (cid:1) X occ i 2 r X occ j 2 r u i ð r 1 Þ u (cid:2) j ð r 1 Þ u (cid:2) i ð r 2 Þ u j ð r 2 Þ = X occ k 2 r u k ð r 1 Þ j j 2 : ð 21 Þ Fermi correlation factor is a function closely related to Fermi hole f rr ð r 1 ; r 2 Þ ¼ h rr ð r 1 ; r 2 Þ = q a ð r 2 Þ : ( 22 ) ESP from nuclear or atomic charges : V nu ð r Þ ¼ X A Z A r (cid:1) R A j j ; ( 23 ) where R A and Z A denote position vector and nuclear charge of atom A , respectively . When chg file ( see Section wavefunction types and file formats ) is used as input , Z will stand for the atomic charge recorded in the file , at this time eq . ( 23 ) is use - ful for analyzing the difference between exact ESP and the ESP reproduced by atomic charges . Promolecular and deformation properties : Promolecular real space function distribution , or say promolecular property , reflects the state after molecule formation but before electron relaxation , whereas deformation property displays the variation during elec - tron relaxation , and they are defined respectively as follows : P pro ð r Þ ¼ X A P free A ð r (cid:1) R A Þ ( 24 ) P def ð r Þ ¼ P mol ð r Þ (cid:1) P pro ð r Þ ; ( 25 ) where P mol ( r ) and P free ( r ) stand for any real space function mentioned above of present system and atom in free state , respectively . If real space function is chosen as electron den - sity , then the P def ( r ) is often referred as deformation density , which is very useful in bonding nature analysis . [ 37 , 38 ] The topology of electron density CPs of electron density are the positions at which | ! q | van - ishes ( except at infinity ) , [ 11 ] and they can be classified into four types : ( 3 , (cid:1) 3 ) , ( 3 , (cid:1) 1 ) , ( 3 , þ 1 ) , and ( 3 , þ 3 ) , which correspond to three , two , one , and none of eigenvalues of Hessian matrix of q are negative , respectively . As mentioned earlier , ( 3 , (cid:1) 1 ) gen - erally appears between attractive atom pairs and hence called bond CP ( BCP ) . The value of real space functions at BCP has great significance , for example , the value of q and the sign of ! 2 q at BCP are closely related to bonding strength and bond type , respectively [ 11 ] ; the potential energy density , namely ( 1 / 4 ) ! 2 q ( r ) (cid:1) 2 G ( r ) , at BCP has been shown to be highly correlated with hydrogen bond energies [ 39 ] ; Noorizadeh and Shakerzadeh found that local information entropy at BCP is a good indicator of aromaticity . [ 40 ] The maximal gradient path linking BCP and associated two local maxima of density , that is ( 3 , (cid:1) 3 ) , is termed ‘‘bond path , ’’ which reveals atomic interaction path for all kinds of bonding . The collection of bond paths is known as molecular graph , which provides an unambiguous definition of molecular structure . Population The main use of population analysis is to derive atomic charge , which is almost the simplest model describing charge distribution . Atomic charges are unobservable experimentally , so strictly speaking they do not have rigorous physical basis . However , the concept of atomic charge is very useful ; it helps to intuitively understand basic properties of molecules , and it also has important applications in the field of quantum chem - istry , molecular modeling , and chemical informatics . Hirshfeld population : Hirshfeld population [ 41 ] is a very popular method based on deformation density partition , and Hirshfeld charge is defined as follows : q A ¼ (cid:1) Z w Hirsh A ð r Þ q def ð r Þ d r ; ( 26 ) where q def ð r Þ ¼ q ð r Þ (cid:1) q pro ð r Þ q pro ð r Þ ¼ X A q free A ð r (cid:1) R A Þ w Hirsh A ð r Þ ¼ q free A ð r (cid:1) R A Þ = q pro ð r Þ : ( 27 ) q free ( r ) is spherically averaged electron density of atom in free state . Hirshfeld charge represents the charge variation in corre - sponding atomic space w Hirsh during molecule formation . Hirsh - feld charges are qualitative consistency with general chemical concepts and insensibility to the quality of wavefunction . [ 42 ] Atomic dipole moment corrected Hirshfeld population : Hirshfeld charges are always too small [ 43 ] and have poor reproducibility of observable quantity . The main reason may be that atomic dipole moments are completely neglected . In atomic dipole moment corrected Hirshfeld method ( ADCH ) , [ 44 ] Hirshfeld charges are corrected by expanding atomic dipole moments to correction charges placed at neighbor atoms . ADCH atomic charges are very reasonable in chemical sense . Molecular dipole moment is exactly reproduced , and the reproducibility WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 583 of ESP is also close to the atomic charges from fitting ESP . Compared with another correction method for Hirshfeld charges , namely Hirshfeld - I , [ 45 ] the computational cost of ADCH correction is almost zero . Voronoi deformation density population : The only difference between Voronoi deformation density ( VDD ) population [ 46 ] and Hirshfeld population is the partition manner of molecular space . In VDD , the Voronoi cell - like partition is used . The results of VDD are close to Hirshfeld population in general , because the magnitude of deformation density is relatively small so that different weighting function definitions would not cause too much difference in atomic charges . Becke population : In Ref . [ 47 ] , Becke proposed a weighting function for decomposing whole - space DFT integral to multi - ple single - center spherical integrals . Although this weighting function is not intended for population analysis , we still make an attempt to utilize it to evaluate atomic charges . The Becke charge can be defined as below , and the details of weighting function are given in original article . [ 47 ] q A ¼ Z A (cid:1) Z w Becke A ð r Þ q ð r Þ d r : ( 28 ) Mulliken population : Mulliken population ( MPA ) is the oldest population method . [ 48 – 50 ] Inserting linear combination equa - tion into orthonormality condition of spin orbital yields 1 ¼ X a C 2 a ; i þ 2 X a X b > a C a ; i C b ; i S a ; b ; ( 29 ) where S is a overlap matrix among basis functions . The first term in eq . ( 29 ) is a ‘‘local term , ’’ denoting the net population of basis function in orbital i . The second term is a ‘‘cross term , ’’ denoting the shared electrons between basis function pairs . Mulliken defined the composition of basis function a in spin orbital i as follows : H i ; a ¼ C 2 a ; i þ X b 6¼ a C a ; i C b ; i S a ; b : ( 30 ) It is clear that in MPA each cross term 2 C a , i C b , i S a , b is equally partitioned to corresponding basis functions . Mulliken atomic charge can be written as follows : q A ¼ Z A (cid:1) X i g i X a 2 A H i ; a : ( 31 ) MPA is deprecated for practical application because of serious shortcomings : ( 1 ) poor reproducibility of observable proper - ties ; ( 2 ) the equal partition of cross term has no strict physical meaning ; ( 3 ) very high basis - set dependence , especially when diffusion function is used ; and ( 4 ) occasionally meaningless result occurs ( population number is negative ) . Lo¨wdin population : In Lo¨wdin population , [ 51 ] Lo¨wdin ortho - gonalization [ 52 ] is performed first to eliminate cross terms in eq . ( 29 ) and then corresponding local terms are just popula - tion number . The advantage of Lo¨wdin population relative to MPA is that the negative population number never occurs , and reproducibility of molecular dipole moment is better . [ 53 ] How - ever , Lo¨wdin population does not possess stronger physical meaning than MPA , because the orthogonalization procedure itself is more or less arbitrary . Modified MPA : Some people had proposed various partition methods for cross term to improve MPA , we collectively refer them as modified MPA ( MMPA ) . In the method proposed by Ros and Schuit , [ 54 ] eq . ( 30 ) is replaced by H i ; a ¼ C 2 a ; i = X b C 2 b ; i : ( 32 ) Because only square of coefficients present in the formula , this method is also called C - squared population analysis ( SCPA ) . Evidently , this definition ensures H positivity . The H defined by Stout and Politzer [ 55 ] is as follows : H i ; a ¼ C 2 a ; i þ X b 6¼ a w a ; b 2 C a ; i C b ; i S a ; b ; ( 33 ) where w a ; b ¼ C 2 a ; i = ð C 2 a ; i þ C 2 b ; i Þ : ( 34 ) This definition has more consideration on the unbalanced na - ture of the cross term . The MMPA proposed by Bickelhaupt et al . [ 56 ] can be equiva - lently rewritten to the form of eq . ( 33 ) , but weighting function is different w a ; b ¼ P k g k C 2 a ; k P i g i C 2 a ; i þ P j g j C 2 b ; j : ( 35 ) Orbital composition Orbital composition analysis is helpful to understand orbital intrinsic characteristics , studying reaction sites , and identifying mode of charge transfer transition . Those H mentioned above can be utilized in orbital composition analysis , and the quan - tity H i , a (cid:5) 100 % is just the composition of basis function a in orbital i . Hirshfeld weighting function defined in eq . ( 27 ) can also be used for decomposing orbital to atoms , and the com - position of atom A in orbital i is Z u 2 i ð r Þ w Hirsh A ð r Þ d r (cid:2) 100 % : ( 36 ) We found that this partition has greater basis - set stability and is always more reliable than use of H to evaluate atom composition . Bond order Bond order is a useful tool for characterizing bond type and measuring bond strength , and this is an artificial index ; SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 584 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM however , some bond order definitions can be intimately con - nected with the experimentally measurable quantity—bond energies—the relationship is referred as BEBO in literature . [ 57 ] Wiberg bond order Wiberg bond order is defined in the foot - note of Ref . [ 58 ] B AB ¼ X a 2 A X b 2 B P 2 ab : ( 37 ) Where P is single particle density matrix . This definition is only suitable for the wavefunction represented by orthogonal basis sets . This constraint conflicts with most ab initio wavefunc - tions ; hence , Multiwfn automatically performs Lo¨wdin ortho - gonalization before the analysis . Mayer two - center , multicenter bond order and valence : Mayer bond order [ 59 ] is a natural extension of Wiberg bond order for nonorthogonal basis . Mayer bond order between atom A and B is defined as B AB ¼ B a AB þ B b AB ¼ 2 X a 2 A X b 2 B ½ð P a S Þ ab ð P a S Þ ba þ ð P b S Þ ab ð P b S Þ ba (cid:4) ; ð 38 Þ In general , Mayer bond order is in good agreement with em - pirical bond order ; for the classical single , double , and triple bonds the value is close to 1 . 0 , 2 . 0 , and 3 . 0 , respectively . Mayer bond order had been generalized to multicenter . [ 60 – 62 ] For arbitrary number of centers , the bond order can be expressed as follows : B AB … Z ¼ X a 2 A X b 2 B … X z 2 Z ð PS Þ ab ð PS Þ bc … ð PS Þ za (cid:3) (cid:4) : ( 39 ) Total valence measures atomic bonding capacity , and the expression given by Mayer is as follows [ 59 ] : V A ¼ 2 X a 2 A PS ð Þ aa (cid:1) X a 2 A X b 2 A PS ð Þ ab PS ð Þ ba : ( 40 ) Free valence is defined as follows : F A ¼ V A (cid:1) X B 6¼ A B AB ¼ X a 2 A X b 2 A P s S ð Þ ab P s S ð Þ ba ; ( 41 ) where P s is spin density matrix . This quantity displays remain - ing capacity of forming new bonds by sharing electron pairs . Mulliken bond order : Mulliken bond order [ 48 – 50 ] is the total cross term between corresponding two atoms B AB ¼ X i B iAB ¼ X i g i X a 2 A X b 2 B 2 C a ; i C b ; i S a ; b : ( 42 ) This bond order definition is deprecated for quantifying bonding strength , for which Mayer bond order generally performs better . However , Mulliken bond order is a good qualitative indicator for bonding ( positive value ) and antibonding ( negative value ) . Density - of - states of isolated systems Density - of - states ( DOS ) is an important concept in solid physics . [ 63 ] It denotes the number of states in unit energy interval . In isolated systems , the energy levels are discrete , and the concept of DOS is , thus , somewhat questionable . However , if the discrete energy levels are broadened to curves artificially , DOS graph becomes a valuable tool for visually characterizing orbital compositions . [ 64 – 66 ] Total DOS ( TDOS ) of isolated system can be written as follows : TDOS ð E Þ ¼ X i d ð E (cid:1) e i Þ ; ( 43 ) where e stands for eigenvalue of single - particle Hamiltonian , and d is dirac delta function . If d is replaced by a broadening function F ( x ) , continuous TDOS yields . Partial density - of - states ( PDOS ) is defined as follows : PDOS A ð E Þ ¼ X i N i ; A F ð E (cid:1) e i Þ ; ( 44 ) where N i , A is composition of fragment A in orbital i , and it can be evaluated by summing up corresponding H terms , which has been discussed above . The overlap density - of - states ( OPDOS ) between fragment A and B is defined as follows : OPDOS AB ð E Þ ¼ X i X iAB F ð E (cid:1) e i Þ ; ( 45 ) where X iAB denotes the composition of total cross term between fragment A and B in orbital i . Program Special features Several special features of Multiwfn are discussed as follows : 1 . Very user - friendly . Quantum chemistry softwares for aca - demic purpose are often inconvenient to use , and users need to write complex input file with consulting lengthy manual . To tackle this problem , Multiwfn is designed as an interactive pro - gram , prompts shown in each step clearly instructs users what need to do next , Multiwfn also never print obscure messages , and hence there is no any barrier even for beginners . Besides , there are more than 20 practical examples in the manual , which would be very helpful for new users . 2 . No third - part plotting softwares are required . A high - level graphical library DISLIN [ 67 ] is invoked internally and automatically by Multiwfn for visualizing results , and most of the plotting pa - rameters are adjustable by users in an interactive interface . Thus , the procedure of wavefunction analysis is remarkably simplified , especially for studying distribution of real space function . 3 . Multiwfn is a semi - GUI program , that is , the majority of operations are based on command - line mode , while graphical interfaces appear when necessary . The advantage over full - GUI WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 585 design is that Multiwfn can run in silent and batch mode eas - ily by redirection and shell scripts . 4 . High efficiency . The code of Multiwfn is substantially optimized . Most parts are parallelized by OpenMP technology . For time - consuming tasks , the efficiency of Multiwfn exceeds analogous programs significantly . Meanwhile , the memory requirement is very low . Wavefunction types and file formats Wavefunction type supported by Multiwfn includes restricted / unrestricted single - determinant wavefunction , restricted open - shell wavefunction , and post - HF wavefunction ( in natural orbital formalism ) . For basis function , Cartesian or spherical harmonic Gauss functions with angular moment up to g are supported . Input file format supported by Multiwfn includes : 1 . PROAIM wavefunction file ( wfn ) : The most popular format for exchanging wavefunction information , supported by Gaus - sian , [ 68 ] GAMESS - US [ 69 ] / UK , [ 70 ] Firefly , [ 71 ] and Q - Chem . [ 72 ] 2 . AIM extended wavefunction files ( wfx ) : A newly intro - duced format by Gaussian09 since B . 01 revision as an exten - sion of wfn format . 3 . Gaussian formatted checkpoint file ( fch ) : For the functions relied on basis function expansion , this file type is mandatory . 4 . Plot file of NBO program : Containing various orbital infor - mations generated by NBO program , [ 3 ] such as natural atomic orbitals and natural bond orbitals . 5 . Protein data bank format ( pdb ) : This file type can be used as structure input for the functions that only require atom coordinates , for example , evaluation of RDG and Sign ( k 2 ) * q under promolecular approximation . 6 . Charge files ( chg ) : A private format , only atom coordi - nates and atomic charges present , the main use of this format is for analysis of ESP reproduced by atomic charges . Graphs plotted by Multiwfn can be outputted to graphic file in publication quality ; abundant graphical formats are sup - ported , such as Postscript ( ps ) , Portable Document Format ( pdf ) , TIFF , Graphics Interchange Format ( gif ) , and Portable Network Graphics ( png ) . Main Functions Calculating and plotting real space functions : All real space functions mentioned in Section ‘‘real space functions’’ can be calculated at a point ( 0D ) , in a line ( 1D ) , in a plane ( 2D ) , or in a spatial scope ( 3D ) . Multiwfn provides very flexible ways to define the spatial region : ( 1 ) Determining by program auto - matically to accommodate system size . ( 2 ) Assign a center and then extend specified lengths in each direction to generate the region . The center can be assigned by inputting coordi - nate or defined as middle point of two atoms ; the latter man - ner is very convenient for study intermolecular interaction . ( 3 ) Input original point and translation vectors . The number of grid points in each dimension is controlled by users . All points are evenly distributed in the calculation region . Once the calculation is finished , users can select to visualize the data directly . For 1D and 3D cases , curve line graph and isosurface graph can be plotted , respectively . For 2D cases , five graph types are supported : ( 1 ) color - filled map ; ( 2 ) con - tour line map ; ( 3 ) relief map ; ( 4 ) shaded surface map with or without projection ; and ( 5 ) gradient line map with or without contour lines . The generated grid data can also be written to Gaussian cube file , which is a standard volumetric data format recognized by the majority of molecular graphics programs . For flexibility consideration , Multiwfn preserves a blank func - tion . This design enables the real space functions supported by Multiwfn to be arbitrarily and easily extended by users themselves . Assuming one wants to analyze Weizsa¨cker kinetic energy density . What is needed to do is simply filling the code userfunc ¼ fgrad ( x , y , z , ‘t’ ) * * 2 / 8 / fdens ( x , y , z ) into ‘‘userfunc’’ routine and recompile the program . Multiwfn is able to calculate and plot promolecular and defor - mation property for any supported real space function . The required wavefunctions for free - state atoms can be generated by Multiwfn automatically through invoking Gaussian program . User can also choose to use the atom wavefunctions provided by themselves or use the set of prebuilt atom wavefunctions under 6 - 31G * basis set . Notice that Multiwfn sphericalizes atom wavefunctions internally to avoid orientation dependency before evaluation of promolecular and deformation properties . Multiwfn permits operation between real space function from multiple wavefunctions . This function makes the studies related to multiple molecules or one molecule in different states very easy , for example , the analysis of Fukui function [ 73 ] and interfragment density transition . Population analysis and bond order analysis : All population methods mentioned in Section ‘‘population’’ are supported . For MPA , the atomic population number can be further decom - posed to basis functions , shells , and orbital contribution . Multiwfn supports bond order definitions discussed in Sec - tion ‘‘bond order . ’’ The maximum number of centers of Mayer multicenter bond order analysis is six . Orbital contribution for Mulliken bond order in each orbital is printable for analyzing orbitals that are favorable or unfavorable for specific bonding . Orbital composition analysis : In Multiwfn , orbitals can be decomposed to basis functions , shells , and atoms composition by MPA , SCPA , Stout - Politzer , and Hirshfeld methods . Frag - ments can be defined expediently in an interactive interface . Composition of intrafragment and interfragment in each or - bital can be analyzed in detail . Plotting DOS and spectrum : TDOS , PDOS , and OPDOS can be plotted by Multiwfn . Plain text file ( recorded energies levels ) , Gaussian output file , wfn , wfx , and fch format are acceptable as input . The broadening functions supported include Gaus - sian , Lorentzian , and pseudo - Voigt function . Multiwfn is able to plot IR , Raman , and UV / Vis spectrum too . Topology analysis of electron density : Multiwfn is able to search CPs of electron density by Newton’s method , and sev - eral modes are provided for setting up starting point : ( 1 ) input SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 586 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM coordinate directly ; ( 2 ) use nuclear positions , which are usually very close to ( 3 , (cid:1) 3 ) type CPs ; ( 3 ) use geometry center of two / three / four nuclear positions , and these modes are suitable for searching ( 3 , (cid:1) 1 ) / ( 3 , þ 1 ) / ( 3 , þ 3 ) type CPs , respectively ; and ( 4 ) set sphere center and radius , and then specified number of starting points are randomly distributed in the sphere . This mode is appropriate for searching the CPs that are difficult to be located by other modes . The search of CPs is very fast , once it is finished , one can choose to generate the gradient paths that linked CPs . The results can be visualized conveniently . Figure 1 shows the CPs and gradient paths of imidazole – magnesium porphyrin com - plex . The value of all supported real space functions with Hes - sian matrix at a given CP can be printed out ; CPs and paths are allowed to be added , deleted , or modified , and their detail informations can be exported out or imported in via formatted text file . Utilities Numerous utilities are provided in Multiwfn for facilitating wavefunction analysis and other quantum chemistry calcula - tions . Some of them will be mentioned below . Viewing molecular structure and orbitals : A convenient graphi - cal interface is integrated in Multiwfn for examining molecular structure and orbitals before wavefunction analysis , see Sup - porting Information for screenshot . Wavefunction examination and modification : There are plenty of options used for wavefunction examination and modification before analy - sis . They can be summarized into five categories : ( 1 ) Print - ing various informations of wavefunction in readable for - mat . ( 2 ) Discarding or only reserving wavefunction infor - mation of specified atoms or orbitals , in which their contri - butions for real space func - tions can be eliminated or evaluated . ( 3 ) Assigning and swapping various informations of specified Gauss functions . ( 4 ) Translating and duplicating wavefunction , which is a very useful function for extending primitive cell wavefunction outputted by Gaussian to peri - odic wavefunction . ( 5 ) Saving modified wavefunction to new file in wfn format . Analysis between two real space functions : This function enables grid data of two real space functions to be gener - ated and outputted at the same time with sharing grid setting , and then the scatter graph between them can be drawn , which is very useful for correlation analysis . Moreover , there are options used for setting the value of one real space function , where the value of another real space function is within or without of certain range . This design particularly facilitates the visual research of weak interaction by RDG and Sign ( k 2 ) * q , and one can screen the strong interaction regions where q is large . Integrating a real space function in whole space : This is a powerful function used to evaluate integral of selected real space function in whole space . By properly modifying the code of ‘‘userfunc’’ routine mentioned above ( that is the inte - grand ) by users , the quantity such as electric multipole moment and overlap between the norms of two orbitals can be easily obtained . The numerical method is based on the scheme proposed by Becke for integrating DFT functional . [ 47 ] Monitoring self - consistent field convergence : The progress of self - consistent field convergence of Gaussian program can be monitored . The variations of energy , density matrix , etc . in specified step range are summarized and plotted in terms of curve map , which helps users to analyze the behavior of con - vergence and find solutions in ill - convergence cases . Combining wavefunction of fragments : Multiwfn can generate Gaussian input file with initial guess that combined from multi - ple fragment wavefunctions . There are three primary purposes : ( 1 ) generating high - quality initial guess wavefunction for weakly interacting system . ( 2 ) Performing simple energy decomposition . Figure 1 . The interface for showing topology analysis result . Index of bond paths are labeled by red texts . Ma - genta , orange , and yellow spheres correspond to ( 3 , (cid:1) 3 ) , ( 3 , (cid:1) 1 ) , and ( 3 , þ 1 ) critical points , respectively . [ Color fig - ure can be viewed in the online issue , which is available at wileyonlinelibrary . com . ] WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 587 The energy difference between the first and the last round of self - consistent field iteration can be regarded as a cause of polarization of electron density and charge transfer between fragments . ( 3 ) Studying symmetry - broken singlet state . Efficiency Grid data calculation is very computationally expensive . There are already some programs aiming at generating grid data for various properties , for example , DGrid [ 6 ] and CheckDen . [ 8 ] Notice that none of them supports parallel implementation . To demon - strate the high efficiency of Multiwfn , we compared their calcu - lation speed of grid data of ELF and ! 2 q for acetic acid with 6 - 31G * * basis set [ 74 , 75 ] used . 88 * 92 * 77 ¼ 623 , 392 points are evenly distributed in the molecular region . In consistency with public version , Multiwfn is compiled by Intel Visual Fortran Compose XE 2011 only with low - level optimization option ‘‘ / O1’’ ( for compatibility consideration ) ; other programs are precom - piled version . The CPU we used is Intel Core2 Quad Q6600 . Notice that to improve calculation speed , Multiwfn checks if the exponent is smaller than a cutoff value (cid:1) 40 before exactly evaluating an exponential function ; if it is true , then the function will be ignored . This treatment is safe enough to ensure that loss of accuracy cannot be detected in any quantitative study of real space functions . From Table 2 , it can be seen that in serial mode , Multiwfn is one order of magnitude faster than CheckDen and several times faster than DGrid . Even if the cutoff treatment is disabled , Multiwfn is still at least one time faster than DGrid for ! 2 q . The speedup of Multiwfn from parallel implementation is significant . When four CPU cores are available , more than 70 % calculation time in serial mode could be reduced . We also tested the performance of generating grid data for RDG and Sign ( k 2 ) * q in Multiwfn , see Supporting Information . The time consuming by Multiwfn in serial mode is comparable to or less than NCIPLOT , [ 76 ] which is a program proposed spe - cifically for generating grid data for these two properties . Notice that NCIPLOT has not been parallelized yet . Practical Applications In this section , several practical examples are given to illustrate the capabilities of Multiwfn . All graphs except color - filled iso - surface map are directly generated by Multiwfn ; only trivial modifications have been made for clearer expression . All ge - ometry optimizations and wavefunction calculations are per - formed by Gaussian03 , [ 68 ] unless otherwise specified . B3LYP [ 77 ] hybrid functional is chosen as theoretical method . ELF and Fermi hole function of CH 3 Br ecause Fermi hole of KS - DFT wavefunction is not well defined , in this example , Hartree - Fock wavefunction is used instead in com - bination with 6 - 311 þ G * basis set . [ 74 , 78 ] Figure 2 depicts ELF and Fermi hole function in the line of C A Br bond of CH 3 Br molecule . The internal shells of the two atoms are clearly shown . Between carbon and bromine there is a wide and high electron localiza - tion region , which reveals that the bonding nature is covalent . As ELF is an abstract reflection of Fermi hole , it is interesting to check Fermi hole distribution when reference point is located at maximum of the bonding ELF domain . From the lower part of Figure 2 , it can be seen that Fermi hole function has relatively high magnitude in the C A Br bond ; meanwhile , around the two atomic nuclei there are several narrow regions with high magni - tude too . Because electron can go where its hole goes , [ 11 ] the electrons shared by the two atoms are localized in the covalent bonding region to some extent , yet they are not completely confined within that region . Molecular ESP of dihalogens Halogen bonding is the noncovalent interaction that occurs between a halogen atom ( Lewis acid ) and a negative site ( Lewis base ) . [ 14 , 79 , 80 ] It can be expressed as follows : D (cid:1) X (cid:6)(cid:6) (cid:6) B ; where the donor atom D could be an organic group or another halogen atom . It seems weird that the halogen atom X , which usually carries a negative charge , could act as Lewis Figure 2 . Electron localization function ( positive part ) and Fermi hole func - tion ( negative part ) of CH 3 Br along C A Br bond . The dashed line indicates reference position of Fermi hole function . [ Color figure can be viewed in the online issue , which is available at wileyonlinelibrary . com . ] Table 2 . Calculation speed of Multiwfn , DGrid , and CheckDen . ELF Laplacian of q Runtime ( s ) Speed [ a ] Runtime ( s ) Speed [ a ] CheckDen 107 . 3 0 . 10 130 . 2 0 . 10 DGrid 25 . 2 0 . 42 55 . 1 0 . 23 Multiwfn N ¼ 1 [ b , c ] 20 . 7 0 . 51 25 . 6 0 . 49 Multiwfn N ¼ 1 [ c ] 10 . 5 1 . 00 12 . 6 1 . 00 Multiwfn N ¼ 2 [ c ] 5 . 3 1 . 98 6 . 4 1 . 97 Multiwfn N ¼ 4 [ c ] 2 . 8 3 . 75 3 . 3 3 . 82 [ a ] The speed of Multiwfn in serial mode is considered as reference . [ b ] Cutoff for evaluating exponential functions is disabled , for other cases this treatment is enabled . [ c ] N denotes the number of threads in paral - lel implementation , similarly hereinafter . SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 588 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM acid . It has been found that the reason can be clearly explained by ESP . Here , we consider dihalogen molecule BrCl and ICl , in which chlorine is seen as X . Relativistic effective core potential Lanl [ 81 ] combining with Lanl2DZdp valence basis set [ 82 ] is utilized for iodine atom , for chlorine and bromine 6 - 311 þ G * is adopted . The isopotential lines are shown in Figure 3 , and the areas enclosed by blue lines are internal region of the molecule and will not be concerned . Because chlorine has larger electrone - gativity than bromine and iodine , most negative region of ESP appears in the vicinity of chlorine atom . There is an evident difference between BrCl and ICl in ESP distribution . In Figure 3a , the positive region dominated by nuclear charge of chlo - rine atom bulged out significantly owing to the diminution of electron density in corresponding region ; meanwhile , negative region is completely separated . This is a typical nature of the halogen bonding , that is , the attractive interaction caused by electrostatic effect between the positive potential site ( com - monly referred as ‘‘ r - hole’’ [ 79 ] ) of halogen atom and the elec - tron - rich site can make system energy decreased . Because more electrons can be pulled from iodine than bromine by chlorine atom , the r - hole in Figure 3b is largely contracted and chlorine atom is fully encompassed by dashed lines . Therefore , it can be expected that the halogen bonding is much harder to be formed in this situation . Electron localization of B 13 1 and Li 6 cluster The global minimum structure of B 13 þ cluster is planar with C 2 v symmetry . [ 83 ] Figure 4 depicts its electron structure characteris - tic by ELF under 6 - 311G * basis set . It can be seen that very high value occurs between each boundary boron atom , although electrons also localized between the central atoms as well as in some regions between central and boundary atoms ( e . g . , B1 – B11 ) , but the extend is evidently weaker . This observation sug - gests that only the bonding between boundary atoms is strong . By examining Mayer bond order , this conclusion can be further verified . All two - center bond orders of adjoining atoms in boundary exceed unity , whereas bond orders between any other adjoining atoms are less than 0 . 6 . Note that electron local - ization in some areas is very low , for example , between B1 and B9 , and around the center of B1 - B9 - B10 , corresponding two - cen - ter and three - center bond orders are very small ( 0 . 35 and 0 . 084 , respectively ) ; thus , these bonding can be expected to be very weak . Analysis of ! 2 q gives similar conclusions as discussed above , see Supporting Information . Planar D 3 h - type structure has been found to be a local but not a global minimum on potential energy surface of Li 6 clus - ter . [ 84 , 85 ] Figure 5 shows its LOL distribution under 6 - 311G * ba - sis set . It is clear that electrons are mainly localized within the three outside triangles . These regions have been known as three - center two - electron bond ( 3c - 2e ) . [ 29 ] Mayer three - center bond order analysis shows that the value of outside triangle , 0 . 086 , is much larger than the one of inner triangle , namely 0 . 026 . It is worth noting that the red color in Figure 5 some - what intrudes into the interstitial space between boundary atoms , and bond order of boundary Li A Li bond ( 0 . 33 ) is mark - edly larger than the inner one ( 0 . 11 ) . Moreover , high accurate calculation [ 84 ] shows that the former bond length is slightly smaller than the latter one ; hence , boundary Li A Li bonds turn out to be stronger than the inner ones . Figure 3 . Contour map of ESP of ( a ) BrCl and ( b ) ICl . Blue lines denote the position where electron density equals to 0 . 001 , which is generally regarded as molecular surface . Solid and dashed black lines are positive and negative isopotential lines , respectively . The isovalues are labeled on the graph , unit is in a . u . [ Color figure can be viewed in the online issue , which is available at wileyonlinelibrary . com . ] WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 589 Weak interaction analysis of urea crystal Here , we use RDG and Sign ( k 2 ) * q function to reveal weak interaction in urea crystal . The structure is taken from Ref . [ 86 ] , and the electron density is reproduced by B3LYP / 6 - 31G * * cal - culation . VMD [ 87 ] is used to plot the graph . The isosurfaces in Figure 6 depict where weak interactions occur ; the blue , red , and green ( or earth green ) colors indicate the strong attrac - tive , strong repulsive , and van der Waals interaction , respec - tively . As shown by blue dashed lines , each urea molecule in crystal environment forms eight hydrogen bonds in total , oxy - gen atom in the urea participates in four of them . Careful inspection shows that among the four hydrogen bonds , those vertical to urea plane are slightly stronger than those parallel to the plane , because the central area of the RDG surfaces cor - responding to former are more blue ; actually , the length of the vertical hydrogen bonds is 0 . 057A˚ shorter than the parallel ones , whereas the electron density at the BCP corresponding to the vertical one is 15 . 2 % larger than the parallel one . There is a small brown surface between each two adjacent ureas , as pointed out by orange arrow . This region implies the steric effect caused by close contact , which in turn is the conse - quence of the two hydrogen bonds around it . The surfaces crossed by magenta dashed lines , that is , the small green ellip - soids and the crooked slices , clearly exhibit the van der Waals interactions between adjacent ureas , which are easily over - looked in common interaction analysis . Another example using RDG and Sign ( k 2 ) * q function , namely the analysis of weak interaction between glycophorin A dimer , is given in Support - ing Information . DOS map of ferrocene The last example is analysis of TDOS , PDOS , and OPDOS map of ferrocene , see Figure 7 . Lanl2DZ basis set combining Lanl pseudopotential is used for iron , whereas 6 - 31G * for other ele - ments . Notice that only relative height rather than absolute height of curves is meaningful . Z - axis is perpendicular to cyclo - pentadienyl groups . The graph clearly exhibits orbital charac - teristics in different energy ranges . It is obvious that the major contribution from S , P x and P y basis functions of carbon ( ma - genta curve ) is due to low - lying MOs instead of frontier MOs . The major composition of MOs around (cid:1) 0 . 25 a . u . is P z orbital of carbon ( blue curve ) and iron atom ( red curve ) . Inspection of the green OPDOS curve , which expresses the bonding between carbon P z and iron atom , suggests that carbon P z Figure 6 . Reduced density gradient isosurface map with isovalue of 0 . 5 of urea crystal , the value of Sign ( k 2 ) * q in surfaces is represented by filling color according to the color bar in upper right corner . For clarity , the atom pairs mainly involved in hydrogen bonds and van der Waals interactions between central urea and neighbor ureas are marked by blue and magenta dashed line , respectively , orange arrow points at repulsive interaction region . Figure 5 . Relief map with projection of localized orbital locator of planar Li 6 cluster . Figure 4 . Color - filled map of electron localization function of planar B 13 þ cluster . SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 590 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM orbitals are very important for stabilization of ferrocene , because OPDOS has large positive value in these ranges . HOMO is almost purely contributed by iron orbitals ; however , its slight overlap with carbon P z is still beneficial to bonding . For all virtual MOs , OPDOS curve is in negative region and shows antibonding characteristic . This is due to the unfavora - ble overlapping in orbital phase , as can been seen from LUMO isosurface . Conclusions In this article , theory backgrounds , features , and functions of Multiwfn were described . The high efficiency of Multiwfn was demonstrated by comparison with related programs , and the five practical applications referring to a wide variety of systems and analysis methods were given to illustrate the capacities and usefulness of Multiwfn . Further , our program is also very easy to use for beginners . Multiwfn will be updated continuously in the future ; many new functions are already planned for succeeding versions , such as charge decomposition analysis , [ 64 , 88 ] plotting orbital interaction diagram , basin integral , and analysis of molecular surface properties . [ 7 ] Besides , several ELFs intended for corre - lation wavefunction [ 89 – 93 ] will be supported , and topology analysis module will be available for other real space func - tions soon . Keywords : wavefunction analysis (cid:6) orbital composi - tion (cid:6) population analysis (cid:6) real space function (cid:6) electron loca - lization function How to cite this article : T . Lu , F . Chen , J . Comput . Chem . 2012 , 33 , 580 – 592 . DOI : 10 . 1002 / jcc . 22885 Additional Supporting Information may be found in the online version of this article . Figure 7 . Total ( black ) , partial ( red , blue , and magenta ) , and overlap ( green , between Fe and carbon P z basis functions ) density - of - states map of ferrocene . Discrete lines represent original data , the curves broadened from which have been scaled by factor of 0 . 05 . Left axis is for total and partial density - of - states , right axis is for overlap density - of - states . Isovalue of MO isosurfaces is 0 . 05 . The plane of cyclopentadienyl groups is perpendicular to Z - axis . [ 1 ] F . Jensen , Introduction to Computational Chemistry ; Wiley : Chichester , 2007 ; pp . 293 – 314 . [ 2 ] J . Cioslowski , In Encyclopedia of Computational Chemistry ; P . v . R . Schleyer , Ed . ; Wiley : West Sussex , 1998 ; pp . 892 – 905 . [ 3 ] F . Weinhold , NBO , 5 . 0 ; 2001 . Available at : http : / / www . chem . wisc . edu / ~ nbo5 / . Accessed on November 24 , 2011 . [ 4 ] F . Biegler - Ko¨nig , J . Scho¨nbohm , J . Comput . Chem . 2002 , 23 , 1489 . [ 5 ] S . I . Gorelsky , AOMix , 6 . 53 ; 2011 . Available at : http : / / www . sg - chem . - net / aomix / . Accessed on November 24 , 2011 . [ 6 ] M . Kohout , DGrid , 4 . 6 ; 2011 . Available at : http : / / www . cpfs . mpg . de / ~ kohout / dgrid . php . Accessed on November 24 , 2011 . [ 7 ] F . Bulat , A . Toro - Labb (cid:2) e , T . Brinck , J . Murray , P . Politzer , J . Mol . Model . 2010 , 16 , 1679 . [ 8 ] L . F . Pacios , A . Fernandez , J . Mol . Graph . Model . 2009 , 28 , 102 . [ 9 ] A . D . Becke , K . E . Edgecombe , J . Chem . Phys . 1990 , 92 , 5397 . [ 10 ] R . F . W . Bader , M . E . Stephens , J . Am . Chem . Soc . 1975 , 97 , 7391 . [ 11 ] F . W . Bader , Atoms in Molecules : A Quantum Theory ; Oxford University Press : New York , 1994 . [ 12 ] C . F . Matta , R . J . Boyd , Eds . The Quantum Theory of Atoms in Mole - cules—From Solid State to DNA and Drug Design ; WILEY - VCH Verlag GmbH & Co . KGaA : Weinheim , 2007 . [ 13 ] R . G . Parr , W . Yang , Density Functional Theory of Atoms and Molecules ; Oxford University Press : New York , 1989 ; p . 176 . [ 14 ] J . S . Murray , P . Politzer , In Encyclopedia of Computational Chemistry ; P . v . R . Schleyer , Ed . ; Wiley : West Sussex , 1998 ; pp . 912 – 920 . [ 15 ] J . S . Murray , T . Brinck , P . Lane , K . Paulsen , P . Politzer , J . Mol . Struct . ( Theochem ) 1994 , 307 , 55 . [ 16 ] P . Politzer , J . S . Murray , Theor . Chem . Acc . 2002 , 108 , 134 . [ 17 ] C . E . Shannon , Bell Syst Tech J 1948 , 27 , 379 . [ 18 ] C . Aslangul , R . Constanciel , R . Daudel , P . Kottis , Adv . Quantum . Chem . 1972 , 6 , 93 . [ 19 ] R . G . Parr , P . W . Ayers , R . F . Nalewajski , J . Phys . Chem . A . 2005 , 109 , 3957 . [ 20 ] R . F . Nalewajski , R . G . Parr , Proc . Natl . Acad . Sci . USA 2000 , 97 , 8879 . [ 21 ] W . Koch , M . C . Holthausen , A Chemist’s Guide to Density Functional Theory ; Wiley - VCH Verlag GmbH : Germany , 2001 ; p . 76 . [ 22 ] E . R . Johnson , S . Keinan , P . Mori - Sa´nchez , J . Contreras - Garcı´a , A . J . Cohen , W . Yang , J . Am . Chem . Soc . 2010 , 132 , 6498 . [ 23 ] R . McWeeny , Methods of Molecular Quantum Mechanics ; Academic Press : San Diego , 1992 ; pp . 152 – 153 . [ 24 ] M . Kohout , A . Savin , Int . J . Quantum . Chem . 1996 , 60 , 875 . [ 25 ] A . Savin , O . Jepsen , J . Flad , O . K . Andersen , H . Preuss , H . G . von Schnering , Angew . Chem . Int . Ed . Engl . 1992 , 31 , 187 . [ 26 ] B . Silvi , A . Savin , Nature 1994 , 371 , 683 . [ 27 ] A . Savin , A . D . Becke , J . Flad , R . Nesper , H . Preuss , H . G . von Schnering , Angew . Chem . Int . Ed . Engl . 1991 , 30 , 409 . [ 28 ] M . Kohout , F . R . Wagner , Y . Grin , Theor . Chem . Acc . 2002 , 108 , 150 . WWW . C - CHEM . ORG SOFTWARE NEWS AND UPDATES Journal of Computational Chemistry 2012 , 33 , 580 – 592 591 [ 29 ] R . Rousseau , D . Marx , Chem . Eur . J . 2000 , 6 , 2982 . [ 30 ] S . Shaik , D . Danovich , B . Silvi , D . L . Lauvergnat , P . C . Hiberty , Chem . Eur . J . 2005 , 11 , 6358 – 6371 . [ 31 ] V . Tsirelson , A . Stash , Chem . Phys . Lett . 2002 , 351 , 142 . [ 32 ] H . L . Schmider , A . D . Becke , J . Mol . Struct . ( Theochem ) 2000 , 527 , 51 . [ 33 ] H . Jacobsen , Can J Chem 2008 , 86 , 695 . [ 34 ] V . Tsirelson , A . Stash , Acta . Crystallogr . B . 2002 , 58 , 780 . [ 35 ] P . Sjoberg , J . S . Murray , T . Brinck , P . Politzer , Can . J . Chem . 1990 , 68 , 1440 . [ 36 ] P . Politzer , J . Murray , F . Bulat , J . Mol . Model . 2010 , 16 , 1731 . [ 37 ] F . Wang , H . Du , J . Zhang , X . Gong , Struct . Chem . 2011 , 22 , 1067 . [ 38 ] L . Xu , J . Lv , P . Sang , J . - W . Zou , Q . - S . Yu , M . - B . Xu , Chem . Phys . 2011 , 379 , 66 . [ 39 ] E . Espinosa , E . Molins , C . Lecomte , Chem . Phys . Lett . 1998 , 285 , 170 . [ 40 ] S . Noorizadeh , E . Shakerzadeh , Phys . Chem . Chem . Phys . 2010 , 12 , 4742 . [ 41 ] F . L . Hirshfeld , Theor . Chem . Acc . 1977 , 44 , 129 . [ 42 ] B . Rousseau , A . Peeters , C . Van Alsenoy , Chem . Phys . Lett . 2000 , 324 , 189 . [ 43 ] E . R . Davidson , S . Chakravorty , Theor . Chem . Acc . 1992 , 83 , 319 . [ 44 ] T . Lu , F . Chen , J . Theor . Comput . Chem . ( in press ) . [ 45 ] P . Bultinck , C . Van Alsenoy , P . W . Ayers , R . Carbo - Dorca , J . Chem . Phys . 2007 , 126 , 144111 . [ 46 ] B . Rousseau , A . Peeters , C . Van Alsenoy , J . Mol . Struct . ( Theochem ) 2001 , 538 , 235 . [ 47 ] A . D . Becke , J . Chem . Phys . 1988 , 88 , 2547 . [ 48 ] R . S . Mulliken , J . Chem . Phys . 1955 , 23 , 1841 . [ 49 ] R . S . Mulliken , J . Chem . Phys . 1955 , 23 , 1833 . [ 50 ] R . S . Mulliken , J . Chem . Phys . 1955 , 23 , 2338 . [ 51 ] L . C . Cusachs , P . Politzer , Chem . Phys . Lett . 1968 , 1 , 529 . [ 52 ] P . - O . Lo¨wdin , Adv . Quantum . Chem . 1970 , 5 , 185 . [ 53 ] J . Li , T . Zhu , C . J . Cramer , D . G . Truhlar , J . Phys . Chem . A . 1998 , 102 , 1820 . [ 54 ] P . Ros , G . C . A . Schuit , Theor . Chem . Acc . 1966 , 4 , 1 . [ 55 ] E . W . Stout , P . Politzer , Theor . Chem . Acc . 1968 , 12 , 379 . [ 56 ] F . M . Bickelhaupt , N . J . R . van Eikema Hommes , C . Fonseca Guerra , E . J . Baerends , Organometallics 1996 , 15 , 2923 . [ 57 ] H . S . Johnston , C . Parr , J . Am . Chem . Soc . 1963 , 85 , 2544 . [ 58 ] K . B . Wiberg , Tetrahedron 1968 , 24 , 1083 . [ 59 ] I . Mayer , Chem . Phys . Lett . 1983 , 97 , 270 . [ 60 ] A . B . Sannigrahi , T . Kar , Chem . Phys . Lett . 1990 , 173 , 569 . [ 61 ] T . Kar , E . Sa´nchez Marcos , Chem . Phys . Lett . 1992 , 192 , 14 . [ 62 ] R . Ponec , I . Mayer , J Phys Chem A 1997 , 101 , 1738 . [ 63 ] A . R . Leach , Molecular Modelling Principles and Applications ; Pearson Education : Harlow , 2001 ; pp . 138 – 164 . [ 64 ] S . I . Gorelsky , S . Ghosh , E . I . Solomon , J . Am . Chem . Soc . 2005 , 128 , 278 . [ 65 ] S . Ghosh , S . I . Gorelsky , P . Chen , I . Cabrito , J . J . G . Moura , I . Moura , E . I . Solomon , J . Am . Chem . Soc . 2003 , 125 , 15708 . [ 66 ] C . Platas - Iglesias , D . Esteban - Go´mez , T . Enrı´quez - P (cid:2) erez , F . Avecilla , A . de Blas , T . Rodrı´guez - Blas , Inorg . Chem . 2005 , 44 , 2224 . [ 67 ] Michels , H . DISLIN , 10 . 0 ; 2011 . Available at : http : / / www . mps . mpg . de / dislin / . Accessed on November 24 , 2011 . [ 68 ] M . J . Frisch , G . W . Trucks , H . B . Schlegel , G . E . Scuseria , M . A . Robb , J . R . Cheeseman , J . A . Montgomery , Jr . , T . Vrevon , K . N . Kudin , J . C . Bur - ant , J . M . Millam , S . S . Iyengar , J . Tomasi , V . Barone , B . Menucci , M . Cossi , G . Scalmani , N . Rega , G . A . Petersson , H . Nakatsuji , M . Hada , M . Ehara , K . Toyota , R . Fukuda , J . Hasegawa , M . Ishida , T . Nakajima , Y . Honda , O . Kitao , H . Nakai , M . Klene , X . Li , J . E . Knox , H . P . Hratchian , J . B . Cross , C . Adamo , J . Jaramillo , R . Gomparts , R . E . Stratmann , O . Yazyev , A . J . Austin , R . Cammi , C . Pomelli , J . W . Ochterski , P . Y . Ayala , K . Morokuma , G . A . Voth , P . Salvador , J . J . Dannenberg , V . G . Zakrzew - ski , S . Dapprich , A . D . Daniels , M . C . Strain , O . Farkas , D . K . Malick , A . D . Rabuck , K . Raghavachari , J . B . Foresman , J . V . Ortiz , Q . Cui , A . G . Baboul , S . Clifford , J . Cioslowski , B . B . Stefanov , G . Liu , A . Liashenko , P . Piskorz , I . Komaromi , R . L . Martin , D . J . Fox , T . Keith , M . A . Al - Laham , C . Peng , A . Namayakkara , M . Challacombe , P . M . W . Gill , B . Johnson , W . Chen , M . Wong , C . Gonzalez , J . A . Pople . Gaussian 03 , E . 01 ; Gaussian , Inc . : Wallingford , CT , 2004 . [ 69 ] M . W . Schmidt , K . K . Baldridge , J . A . Boatz , S . T . Elbert , M . S . Gordon , J . H . Jensen , S . Koseki , N . Matsunaga , K . A . Nguyen , S . Su , T . L . Windus , M . Dupuis , J . A . Montgomery . J . Comput . Chem . 1993 , 14 , 1347 . [ 70 ] M . F . Guest , I . J . Bush , H . J . J . van Dam , P . Sherwood , J . M . H . Thomas , J . H . van Lenthe , R . W . A . Havenith , J . Kendrick , Mol . Phys . 2005 , 103 , 719 . [ 71 ] A . A . Granovsky , Firefly , 8 . 0 . 0 ; 2011 . Available at : http : / / classic . chem . m - su . su / gran / gamess / index . html . Accessed on November 24 , 2011 . [ 72 ] Y . Shao , L . F . Molnar , Y . Jung , J . Kussmann , C . Ochsenfeld , S . T . Brown , A . T . B . Gilbert , L . V . Slipchenko , S . V . Levchenko , D . P . O’Neill , R . A . DiS - tasio Jr , R . C . Lochan , T . Wang , G . J . O . Beran , N . A . Besley , J . M . Her - bert , C . Yeh Lin , T . Van Voorhis , S . Hung Chien , A . Sodt , R . P . Steele , V . A . Rassolov , P . E . Maslen , P . P . Korambath , R . D . Adamson , B . Austin , J . Baker , E . F . C . Byrd , H . Dachsel , R . J . Doerksen , A . Dreuw , B . D . Dunietz , A . D . Dutoi , T . R . Furlani , S . R . Gwaltney , A . Heyden , S . Hirata , C . Hsu , G . Kedziora , R . Z . Khalliulin , P . Klunzinger , A . M . Lee , M . S . Lee , W . Liang , I . Lotan , N . Nair , B . Peters , E . I . Proynov , P . A . Pieniazek , Y . Min Rhee , J . Ritchie , E . Rosta , C . David Sherrill , A . C . Simmonett , J . E . Subot - nik , H . Lee Woodcock III , W . Zhang , A . T . Bell , A . K . Chakraborty , D . M . Chipman , F . J . Keil , A . Warshel , W . J . Hehre , H . F . Schaefer III , J . Kong , A . I . Krylov , P . M . W . Gill , M . Head - Gordon . Phys . Chem . Chem . Phys . 2006 , 8 , 3172 . [ 73 ] R . G . Parr , W . Yang , J . Am . Chem . Soc . 1984 , 106 , 4049 . [ 74 ] P . C . Hariharan , J . A . Pople , Theor . Chem . Acc . 1973 , 28 , 213 . [ 75 ] W . J . Hehre , R . Ditchfield , J . A . Pople , J . Chem . Phys . 1972 , 56 , 2257 . [ 76 ] J . Contreras - Garcı´a , E . R . Johnson , S . Keinan , R . Chaudret , J . - P . Pique - mal , D . N . Beratan , W . Yang , J . Chem . Theory . Comput . 2011 , 7 , 625 . [ 77 ] A . D . Becke , J . Chem . Phys . 1993 , 98 , 1372 . [ 78 ] R . Krishnan , J . S . Binkley , R . Seeger , J . A . Pople , J . Chem . Phys . 1980 , 72 , 650 . [ 79 ] T . Clark , M . Hennemann , J . Murray , P . Politzer , J . Mol . Model . 2007 , 13 , 291 . [ 80 ] P . Politzer , P . Lane , M . Concha , Y . Ma , J . Murray , J . Mol . Model . 2007 , 13 , 305 . [ 81 ] W . R . Wadt , P . J . Hay , J . Chem . Phys . 1985 , 82 , 284 . [ 82 ] C . E . Check , T . O . Faust , J . M . Bailey , B . J . Wright , T . M . Gilbert , L . S . Sun - derlin , J . Phys . Chem . A . 2001 , 105 , 8111 . [ 83 ] A . Ricca , C . W . Bauschlicher , Chem . Phys . 1996 , 208 , 233 . [ 84 ] B . Temelso , C . D . Sherrill , J . Chem . Phys . 2005 , 122 , 064315 . [ 85 ] A . N . Alexandrova , A . I . Boldyrev , J Chem Theory Comput 2005 , 1 , 566 . [ 86 ] V . Zavodnik , A . Stash , V . Tsirelson , R . de Vries , D . Feil , Acta . Crystallogr . B . 1999 , 55 , 45 . [ 87 ] W . Humphrey , A . Dalke , K . Schulten , J . Mol . Graph . 1996 , 14 , 33 . [ 88 ] S . Dapprich , G . Frenking , J . Phys . Chem . 1995 , 99 , 9352 . [ 89 ] A . Scemama , M . Caffarel , R . Chaudret , J . - P . Piquemal , J . Chem . Theory . Comput . 2011 , 7 , 618 . [ 90 ] E . Matito , B . Silvi , M . Duran , M . Sola , J . Chem . Phys . 2006 , 125 , 024301 . [ 91 ] F . Feixas , E . Matito , M . Duran , M . Sola ` , B . Silvi , J . Chem . Theory . Comput . 2010 , 6 , 2736 . [ 92 ] M . Kohout , K . Pernal , F . R . Wagner , Y . Grin , Theor . Chem . Acc . 2004 , 112 , 453 . [ 93 ] M . Kohout , K . Pernal , F . R . Wagner , Y . Grin , Theor . Chem . Acc . 2005 , 113 , 287 . Received : 30 June 2011 Revised : 28 September 2011 Accepted : 21 October 2011 Published online on 8 December 2011 SOFTWARE NEWS AND UPDATES WWW . C - CHEM . ORG 592 Journal of Computational Chemistry 2012 , 33 , 580 – 592 WWW . CHEMISTRYVIEWS . COM
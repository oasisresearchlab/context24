nature methods | VOL . 7 NO . 5 | MAY 2010 | 339 correspondence We hope that the code and suggestions provided here will inspire other researchers to take advantage of the benefits of using MLE for analyzing Poisson - distributed data , reducing biases and errors in parametric results from histogram - based analysis . Note : Supplementary information is available on the Nature Methods website . acKnoWLedGments This work was performed under the auspices of the US Department of Energy by Lawrence Livermore National Laboratory under contract DE - AC52 - 07NA27344 . competInG FInancIaL Interests The authors declare no competing financial interests . ted a Laurence & Brett a chromy Physical and Life Sciences Directorate , Lawrence Livermore National Laboratory , Livermore , California , USA . e - mail : laurence2 @ llnl . gov 1 . Ross , S . M . Introduction to Probability and Statistics for Engineers and Scientists ( Wiley , New York , New York , 1987 ) . 2 . Turton , D . A . , Reid , G . D . & Beddard , G . S . Anal . Chem . 75 , 4182 – 4187 ( 2003 ) . 3 . Marquardt , D . W . J . Soc . Indust . Appl . Math . 11 , 431 – 441 ( 1963 ) . 4 . Bunch , D . S . , Gay , D . M . & Welsch , R . E . ACM T . Math . Software 19 , 109 – 130 ( 1993 ) . 5 . Gay , D . M . & Welsch , R . E . J . Am . Stat . Assoc . 83 , 990 – 998 ( 1988 ) . 6 . Nishimura , G . & Tamura , M . Phys . Med . Biol . 50 , 1327 – 1342 ( 2005 ) . QuickPALM : 3D real - time photoactivation nanoscopy image processing in ImageJ To the Editor : Although conventional microscopes have a reso - lution limited by diffraction to about half the wavelength of light , several recent advances have led to microscopy methods that achieve roughly tenfold improvements in resolution . Among them , photoactivated light microscopy ( PALM ) and stochastic optical resolution microscopy ( STORM ) have become particu - larly popular , as they only require relatively simple and affordable modifications to a standard total internal reflection fluorescence ( TIRF ) microscope 1 – 3 and have been extended to three - dimen - sional ( 3D ) super - resolution and multicolor imaging 4 , 5 . PALM and STORM achieve super - resolution by sequentially imaging sparse subsets of photoswitchable molecules . Positions of indi - vidual molecules are computed from individual low - resolution images with subdiffraction accuracy . These positions are then corrected for drifts and subsequently assembled into one or more super - resolution images . Unfortunately , in most current implementations , this reconstruction may take from several hours to days for a single dataset , thus forbidding visual inspec - tion of super - resolution images in real time . Additionally , PALM and STORM software used to date is generally not freely avail - able , strongly limiting the adoption of this otherwise relatively simple microscopy method . Two recent publications indepen - dently demonstrated two - dimensional ( 2D ) algorithms for real - time PALM and STORM reconstructions 6 , 7 . Here we present QuickPALM ( Supplementary Software 1 ) , a freely available and open - source algorithm as a plugin for the widely used ImageJ ( http : / / rsb . info . nih . gov / ij / ) software that combines real - time processing capability with additional important features includ - ing 3D reconstruction , drift correction and real - time acquisition control ( http : / / code . google . com / p / quickpalm / ) . PALM and STORM reconstruction algorithms usually rely on ‘fitting’ Gaussian kernels to detected diffraction - limited spots . Although they permit high - accuracy localizations , these itera - tive methods can require up to several hours of processing time . We have developed a high - speed reconstruction algorithm that uses the classical Högbom ‘CLEAN’ method 8 for spot finding , followed by a modified center of mass algorithm to compute the spot position and parameters defining spot shape along the hori - 10 particles per frame 100 particles per frame 300 200 100 0 P r o c e ss i ng t i m e ( m s ) 1 2 3 4 5 6 7 8 Number of CPUs Axial profile Lateral profile 1 . 0 0 . 5 0 N o r m a li z ed i n t en s i t y – 50 – 25 0 25 50 Distance ( nm ) A x i a l Lateral 1 . 0 0 . 5 0 N o r m a li z ed pa r t i c l e c oun t ( a . u . ) 500 250 0 250 A x i a l po s i t i on ( n m ) a b c d e f Figure 1 | Three - dimensional dSTORM imaging of β - III - tubulin – labeled microtubules in neuronal cells . ( a ) Per - formance of the complete algorithm analyzing a sequence of 512 × 512 pixel images including image reading , peak search , localization and super - resolution image rendering in parallel , benchmarked on an Intel Core 2 Quad 3 . 2 GHz personal computer . The dashed line represents the 32 ms readout speed of the EMCCD camera ( Andor iXion - 897 ) . Note that this is the lower - bound frame - rate hard limit imposed by the acquisition hardware itself . ( b ) Super - resolution reconstruction of a microtubule filament . ( c ) Intensity profile of the microtubule cross - section ( dotted line in b ) showing a 40 nm lateral and 50 nm axial full - width half maximum . ( d ) Particle distribution histogram of the marked cross - section in b . ( e ) The conventional widefield epifluorescence image , with the middle section showing the super - resolved reconstruction of the central portion of the image . ( f ) A 3D dSTORM image of the boxed area in e . Scale bars , 100 nm ( b ) , 50 nm ( d ) , 5 µ m ( e ) and 1 µ m ( f ) . © 2010 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . 340 | VOL . 7 NO . 5 | MAY 2010 | nature methods correspondence ate modifications to ensure precise alignment of differing color channels , multicolor PALM or STORM can be achieved by con - currently processing images from multiple color channels . In summary , QuickPALM in conjunction with the acquisition control features mentioned above ( Supplementary Discussion ) provides a complete solution for acquisition , reconstruction and visualization of 3D PALM or STORM images , achieving resolu - tions of ~ 40 nm in real time . This software package should great - ly facilitate the conversion of many laser - excitation widefield or TIRF microscopes into powerful super - resolution microscopes . Note : Supplementary information is available on the Nature Methods website . acKnoWLedGments We thank J . Enninga for assistance with experiments , and T . Duong and R . Fesce for helpful insight in the preparation of the manuscript . competInG FInancIaL Interests The authors declare no competing financial interests . ricardo henriques 1 , 2 , mickael Lelek 2 , eugenio F Fornasiero 3 , 4 , Flavia Valtorta 3 , 4 , christophe Zimmer 2 & musa m mhlanga 1 , 5 1 Unidade de Biofísica e Expressão Genética , Instituto de Medicina Molecular , Faculdade de Medicina Universidade de Lisboa , Lisboa , Portugal . 2 Institut Pasteur , Groupe Imagerie et Modélisation , Institut Pasteur , Groupe Imagerie et Modélisation ; Centre National de la Recherche Scientifique , Unité de Recherche Associée 2582 , Paris , France . 3 Istituto Scientifico San Raffaele , Università Vita - Salute , Milano , Italia . 4 Unità di Neuroscienze Molecolari , Istituto Italiano di Tecnologia , Milano , Italia . 5 Gene Expression and Biophysics Group , Synthetic Biology Emerging Research Area , Council for Scientific and Industrial Research , Pretoria , South Africa . e - mail : rhenriques @ fm . ul . pt 1 . Rust , M . J . , Bates , M . & Zhuang , X . Nat . Methods 3 , 793 – 795 ( 2006 ) . 2 . Hess , S . T . , Girirajan , T . P . & Mason , M . D . Biophys . J . 91 , 4258 – 4272 ( 2006 ) . 3 . Betzig , E . et al . Science 313 , 1642 – 1645 ( 2006 ) . 4 . Huang , B . , Jones , S . A . , Brandenburg , B . & Zhuang , X . Nat . Methods 5 , 1047 – 1052 ( 2008 ) . 5 . Huang , B . , Wang , W . , Bates , M . & Zhuang , X . Science 319 , 810 – 813 ( 2008 ) . 6 . Wolter , S . et al . J . Microsc . 237 , 12 – 22 ( 2010 ) . 7 . Hedde , P . N . , Fuchs , J . , Oswald , F . , Wiedenmann , J . & Nienhaus , G . U . Nat . Methods 6 , 689 – 690 ( 2009 ) . 8 . Högbom , J . A . Astron . Astrophys . 15 ( Suppl . ) , 417 – 426 ( 1974 ) . 9 . Stuurman , N . , Amodaj , N . & Vale , R . D . Microscopy Today 15 , 42 – 43 ( 2007 ) . 10 . Heilemann , M . et al . Angew . Chem . Int . Edn Engl . 47 , 617 – 6176 ( 2008 ) . zontal axes . These parameters allow not only precise 2D local - ization but also extraction of the axial ( z ) coordinate for each spot when using an astigmatic lens 5 ( Supplementary Fig . 1 and Supplementary Note 1 ) . A direct benefit of this method was our ability to achieve a typical processing time of 30 – 50 ms per image with a very weak dependence on the number of spots per image ( Fig . 1a ) ; these values are of the same order as the common elec - tron - multiplying charge - coupled device ( EMCCD ) maximum frame rates used in these techniques . Any drift on the microscope caused by vibrations or thermal dilation compromises resolution and can lead to artifacts in the reconstruction , such as the dou - bling of structures for sudden shifts ( Supplementary Fig . 1f , g ) . To address this , QuickPALM can trace the movement of fiduciary landmarks such as beads imaged in the sample to estimate the drift in two or three dimensions and subtract it from particle positions ( Supplementary Fig . 1d , e ) . As fiduciary landmarks might not be detected throughout the entire image sequence because of blinking or photobleaching , we interpolated missing positions for each landmark ( Supplementary Note 1 ) . By combining QuickPALM with the µManager 9 open source package for microscope hardware control and acquisition ( Supplementary Software 1 ) in tandem with a custom laser control system ( Supplementary Software 2 ) , we provide a full method for parallel acquisition and real - time visualization of PALM and STORM experiments . To test the potential of QuickPALM , we observed microtu - bules in mouse neurons labeled with a primary antibody to neu - ronal β - III - tubulin and a secondary Cy5 - conjugated antibody ( Fig . 1b – f and Supplementary Movie 1 ) . Using direct STORM ( dSTORM ) imaging 1 , 10 we collected 150 , 000 images , using the 635 nm laser for excitation and pulsing the 488 nm laser at decreasing intervals for Cy5 fluorophore reactivation . We intro - duced a cylindrical lens at the position of the polarization slider ( Supplementary Methods and Supplementary Fig . 2 ) to permit 3D probe localization 5 . Using QuickPALM , we obtained real - time 3D reconstructions of microtubules with a resolution ( as measured by the full - width half maximum of an intensity profile across a microtubule ) of 40 nm in x and y dimensions and 50 nm in the z dimension over a 1 µm depth ( Fig . 1b – f ) . With appropri - © 2010 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d .
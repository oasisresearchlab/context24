Precise Nanometer Localization Analysis for Individual Fluorescent Probes Russell E . Thompson , Daniel R . Larson , and Watt W . Webb Cornell University , School of Applied and Engineering Physics , Ithaca , New York 14853 USA ABSTRACT Calculation of the centroid of the images of individual fluorescent particles and molecules allows localization and tracking in light microscopes to a precision about an order of magnitude greater than the microscope resolution . The factors that limit the precision of these techniques are examined and a simple equation derived that describes the precision of localization over a wide range of conditions . In addition , a localization algorithm motivated from least - squares fitting theory is constructed and tested both on image stacks of 30 - nm fluorescent beads and on computer - generated images ( Monte Carlo simulations ) . Results from the algorithm show good agreement with the derived precision equation for both the simulations and actual images . The availability of a simple equation to describe localization precision helps investigators both in assessing the quality of an experimental apparatus and in directing attention to the factors that limit further improvement . The precision of localization scales as the inverse square root of the number of photons in the spot for the shot noise limited case and as the inverse of the number of photons for the background noise limited case . The optimal image magnification depends on the expected number of photons and background noise , but , for most cases of interest , the pixel size should be about equal to the standard deviation of the point spread function . INTRODUCTION The resolution of a visible light microscope is commonly taken to be about (cid:1) / 2 (cid:1) 250 nm ( James , 1976 ) , with any sparse objects smaller than this dimension appearing in the microscope as diffraction - limited spots . Although the de - tails within a spot are not resolvable , the center of the spot , and hence the location of the object , can be determined to a much greater precision . In cases where the image being viewed consists of a collection of sparse , punctate objects , it is therefore possible to determine the relative positions of the objects to a precision much better than the wavelength of light , and , in a sense , escape limitations on the resolution . Particle localization and tracking techniques have been used largely in the study of receptor diffusion on cell surfaces . Barak and Webb ( 1981 , 1982 ) pioneered the use of fluorescent particle tracking in the study of diI - LDL tagged low - density lipoproteins receptors on internalization - defi - cient human fibroblast cells . Gross and Webb ( 1986 , 1988 ) used similar techniques to analyze the clustering and mo - bility of low - density lipoprotein receptors . This work was later enhanced by Ghosh and Webb ( 1994 ) by the develop - ment of automated localization and tracking algorithms and the extensive application of these methods to molecular motions on living cell surfaces . In more recent work , par - ticle tracking was used to observe anomalous diffusion in major histocompatibility complex class 1 molecules in the plasma membrane of HeLa cells ( Smith et al . , 1999 ) , and extended domains ( corrals ) were observed restricting the diffusion of band 3 proteins in erythrocyte ghosts ( Tomi - shige et al . 1998 ) . Single - particle tracking has now been extended to dye molecules in model membranes ( Schutz et al . , 1997 ; Schmidt et al . , 1996 ) and individual proteins in solution and in cells ( Kubitscheck et al . , 2000 ; Goulian and Simon , 2000 ) . The development of new techniques , such as the use of astigmatic optics to study three - dimensional diffusion ( Kao and Verkman , 1994 ) and the combination of particle tracking with optical tweezers ( Edidin et al . , 1991 ; Sako et al . 1998 ; Peters et al . , 1999 ) promises to bring new insight into the dynamics of cell surface receptors . Reviews of the field are given by Cherry et al . ( 1998 ) and Saxton and Jacobson ( 1997 ) . In addition , Cheezum et al . ( 2001 ) have written a comparison of four algorithms used in particle tracking . Analysis of the trajectories of individual cell surface molecules has revealed a general anomalous subdiffusion phenomenon in which the mean square trajectories of mo - lecular displacements appear to grow as a power law in time with an exponent significantly less than unity , the value expected for conventional Brownian diffusion ( Ghosh and Webb , 1994 ; Feder et al . 1996 ) . Recent experiments have suggested that this anomalous subdiffusion may be ubiqui - tous in biological materials—thus renewing interest in mea - suring this phenomenon ( Schwille et al . , 1999 ; Brown et al . , 1999 ) . The localization analysis used in particle tracking de - pends on the fact that , although the size of the observed object is limited by the resolution of the microscope , the center of the object can be determined arbitrarily precisely , given a sufficient number of photons ( N ) in the spot ( Bo - broff , 1986 ) . The two important categories of noise are the shot noise of the photons in the spot and the background noise created by out - of - focus fluorescence , charge coupled device ( CCD ) readout noise , dark current , and other factors . For shot noise , the precision of localization scales as N (cid:2) 1 / 2 , Submitted July 16 , 2001 and accepted for publication February 11 , 2002 . Address reprint requests to Prof . Watt W . Webb , Cornell University School of Applied and Engineering Physics , 212 Clark Hall , Ithaca , NY 14853 . Tel . : 607 - 255 - 3331 ; Fax : 607 - 255 - 7658 ; E - mail : www2 @ cornell . edu . © 2002 by the Biophysical Society 0006 - 3495 / 02 / 05 / 2775 / 09 $ 2 . 00 2775 Biophysical Journal Volume 82 May 2002 2775 – 2783 whereas , for background noise , the precision scales as N (cid:2) 1 . Thus , at low light levels , it becomes more important to minimize the background noise . An equation is derived in this paper that can be used to predict the precision of localization for a wide range of circumstances . This analysis also provides the basis for a robust computational algorithm for single - particle localization . MATERIALS AND METHODS All measurements were made using a laser scanning microscope consisting of a Bio - Rad 1024 confocal scanbox ( Bio - Rad , Hercules , CA ) attached to a Zeiss Axiovert 135 microscope ( Zeiss , Jena , Germany ) . A linearly polarized 488 - nm argon laser line was used to excite 30 - nm - diameter orange beads ( 530 / 560 excitation / emission , Molecular Probes , Eugene , OR ) . The beads adhered to the coverslip and remained immobile through - out the experiment . The microscope was operated with the confocal iris fully open ( 8 mm ) , because there were no significant out - of - focus sources of fluorescence . The zoom level of 4 , in combination with the 40 (cid:3) objective ( Zeiss Fluar , 1 . 3 NA oil immersion ) , resulted in a pixel size of 130 nm . At this zoom setting , the standard deviation of the point spread function was 1 . 6 pixels , corresponding to a spot size of 208 nm . Thus the fluorescent spots were spread over only a small number of pixels . The microscope was operated in photon - counting mode . The gain calibration of the microscope was checked by imaging a rhodamine solu - tion at high zoom and varying the confocal iris to produce images of different brightness . The variance of the pixel values in each image was then plotted versus the mean value and fitted with a straight line to find the calibration factor ( pixel value / detected photons ) . The value found ( 0 . 93 ) differed little from the expected value of 1 for photon - counting mode . Sets of single - scan images were acquired ( typically 120 images / set ) , with each image within a set looking at the same area on the microscope slide . The images were fit off - line using custom programs written in Rlab ( Ian Searle , http : / / rlab . sourceforge . net ) , a matrix programming language similar to Matlab ( The Mathworks , Natick , MA ) . Although a simplified theoretical analysis predicts an Airy disk for the point - spread function ( Saxton and Jacobson , 1997 ) , a Gaussian is mathematically more tractable , and the differences between the two are minor in practice . For this reason , a Gaussian was used for the point - spread function throughout this paper . Two fitting algorithms were used . The first was a full least - squares fit to a Gaussian distribution that incorporated both photon - counting noise from the particle being measured and a general background noise ( see also Cheezum et al . , 2001 ) . Both the position and the number of photons in the spots were fitted . The second , termed “Gaussian mask , ” is a simplified technique similar to a centroid algorithm . It is equivalent to a least - squares fit to a Gaussian distribution , incorporating only the background noise and ignoring photon - counting noise that originates from the particle . The Gaussian mask fitting algorithm was derived from a simplified least - squares analysis and is intermediate in complexity between the simple centroid - based algorithm and a full nonlinear least - squares fit . Consider a one - dimensional pixel array where i and j are the indices of the pixel , S ij is the signal value of that pixel , and N ij is the expected value from a Gaussian distribution with a width s and centered at x 0 , y 0 defined in dimensions of pixels . Briefly , the (cid:2) 2 sum for a Gaussian fit is minimized , resulting in the equations , 0 (cid:3) d d x 0 (cid:1) (cid:4) S ij (cid:4) N ij (cid:5) 2 ( 1 ) (cid:3) (cid:1) S ij (cid:4) i (cid:4) x 0 (cid:5) N ij (cid:4) (cid:1) (cid:4) i (cid:4) x 0 (cid:5) N ij 2 , ( 2 ) where N ij (cid:3) exp (cid:2) (cid:2) (cid:4) i (cid:4) x 0 (cid:5) 2 2 s 2 (cid:4) (cid:4) j (cid:4) y 0 (cid:5) 2 2 s 2 (cid:3) . The estimated error (cid:5) i in the (cid:2) 2 expression was taken to be independent of x 0 . The second sum in Eq . 2 is approximately equal to zero by odd symmetry , resulting in the implicit equation , x 0 (cid:3) (cid:1) iS ij N ij (cid:1) S ij N ij , ( 3 ) for the position of the particle . The form of the above equation is very similar to the centroid calculation commonly used in particle tracking . The position x 0 is the average of the pixel coordinates weighted by the number of photons in each pixel , but with a mask N i that is smooth instead of binary and equal to the point - spread function of the imaging apparatus . Because the point - spread function in a pixelated imaging device is not strictly a Gaussian distribution , but instead a Gaussian distribution integrated over each pixel , we chose to use a Gaussian integrated over each pixel as the mask N i . Because the value of the mask N i depends on x 0 , the calculation for x 0 in Eq . 3 was iterated until it either converged or 200 iterations occurred . After the location of the particle was found , the estimated total number of photons in the spot N was calculated according to N (cid:3) (cid:1) S ij N ij (cid:1) N ij N ij . ( 4 ) In general , if the number of photons N found after the fitting procedure was less than 25 , then the spot was discarded as an artifact . Candidates for spots were found by first subtracting the mean pixel value from the image and then finding all pixels greater than a threshold value ( typically 8 standard deviations away from the mean ) . For each pixel above threshold , a surrounding region of the image was cut out and passed to the fitting routine described above . The resulting list of spot locations was culled to eliminate cases in which the same spot was found twice , as can happen due to multiple pixels in the spot being above threshold . The spots found in the images were assembled into trajectories by first assembling a master list of all found spot locations , culling the list by removing less bright spots that were within ten pixels of a brighter spot , computing a distance matrix between the spots in each image and the master list , and matching spots in the order of proximity . Standard devia - tions and means of x , y , and N were computed for each trajectory . To remove trends in the data caused by stage drift or photobleaching , standard deviations were calculated by taking the standard deviation of the differ - ences between consecutive points and dividing by 2 1 / 2 . This procedure for measuring the localization precision is similar to computing the standard deviation of the distance between two different spots and dividing by 2 1 / 2 ( Gelles et al . , 1988 ) , but instead uses the distance between the same spot measured on two separate occasions . Monte Carlo results for the precision of localization were generated by computing a large number of images with random positions , fitting each image , and computing the statistical errors in the fits . Images were formed by calculating the statistical average intensity of a Gaussian intensity distribution integrated over a square pixel , replacing the average with a random number generated from the Poisson distribution of the same average to simulate photon - counting noise , and adding a Gaussian random number with standard deviation of b to simulate background noise . THEORY In the following calculations , we derive expressions for the localization precision in two limiting cases based on the idea of least - squares fitting ( Bobroff , 1986 ) . For simplicity , 2776 Thompson et al . Biophysical Journal 82 ( 5 ) 2775 – 2783 the given analysis is limited to one dimension , because the extension to multiple dimensions is straightforward . As mentioned earlier , we chose to simplify the analysis by fitting to a Gaussian over alternatives such as an Airy function because recorded fluorescence images are rarely precise enough to distinguish between these two alterna - tives . The photon shot noise - limited case occurs when the noise in each pixel is dominated by photons originating from the particle being localized . The background noise - limited case occurs when the noise is caused by other sources . Common sources of background noise include readout error , dark current noise , extraneous fluorescence in the microscope ( caused for example by dust ) , and cellular autofluorescence . The photon noise - limited case is conceptually simple . Each photon collected in the image gives a measure of the position of the object , and the position error of each mea - surement is the same as the standard deviation of the point - spread function of the microscope . The best estimate of the position is then given by the average of the positions of the individual detected photons , with an error given by the common statistical formula for the standard error on the mean , (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) s 2 N , ( 5 ) where (cid:7) x is the error in localization , s is the standard deviation of the point - spread function ( Gaussian or other - wise ) , and N is the number of photons collected . More complexity is introduced by pixelation noise , or the increase in error due to the finite size a of the pixels in the image . Pixelation noise arises from the uncertainty of where the photon arrived in the pixel . The extra noise adds to the uncertainty of each individual photon , and hence can be added in quadrature to yield the equation , (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) s 2 (cid:6) a 2 / 12 N , ( 6 ) where a is the size of the pixel , and when s (cid:9) a . The factor a 2 / 12 is the variance of a top - hat distribution of size a . Pixelation noise thus increases the apparent size of the spot . Background noise , which occurs when detected photons do not necessarily originate from the particle , makes the analysis more complicated . We start from the criterion of least - squares fitting , that the sum of squared errors , (cid:2) 2 (cid:4) x (cid:5) (cid:3) (cid:1) (cid:4) y i (cid:4) N i (cid:4) x (cid:5)(cid:5) 2 (cid:5) i 2 , ( 7 ) is minimized , where y i are the actual pixel counts measured , N i ( x ) are the expected numbers of counts from a particle located at x , and (cid:5) i are the expected uncertainties in the counts . A subscript i is used to indicate the number of the pixel . The expected uncertainty (cid:5) i is given by the sum of the uncertainties due to photon - counting noise and background noise b , (cid:5) i 2 (cid:10) N i (cid:4) x (cid:5) (cid:6) b 2 , ( 8 ) where the variance of the photon - counting noise is equal to the expected number of photons . Note that this expression assumes that the background noise is constant across the region of the spot being localized . The condition for the minimum , d (cid:2) 2 / d x (cid:10) 0 , gives an equation for the measured position x in terms of the counted photons in each bin . Expanding N i ( x ) around the actual particle position x 0 , collecting terms to first order in (cid:7) x (cid:10) x (cid:2) x 0 , and assuming that the errors in counted photons are relatively small , gives the equation , (cid:7) x (cid:3) (cid:4) (cid:1) (cid:7) y i N (cid:11) i (cid:5) i 2 (cid:2) 1 (cid:4) (cid:7) y i 2 (cid:5) i 2 (cid:3) (cid:1) N (cid:11) i2 (cid:5) i 2 (cid:2) 1 (cid:2) (cid:7) y i (cid:5) i 2 (cid:3) ( 9 ) (cid:4) (cid:4) (cid:1) (cid:7) y i N (cid:11) i (cid:5) i2 (cid:1) N (cid:11) i2 (cid:5) i 2 ( 10 ) where N (cid:11) I is the derivative of N i evaluated at x 0 , and (cid:7) y i (cid:10) N i ( x 0 ) (cid:2) y i . By squaring Eq . 10 and calculating the expec - tation value , the mean square error can be shown to be (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) 1 (cid:1) (cid:4) N (cid:11) i2 / (cid:5) i2 (cid:5) . ( 11 ) This expression can be evaluated in the two limits of photon noise or background noise by the approximation of N i (cid:3) N (cid:5) 2 (cid:7) s e (cid:2) i 2 / 2s 2 , ( 12 ) and the replacement of the sum in Eq . 11 with an integral . For the case of photon noise , the integral simplifies to Eq . 5 above . For the case of pure background noise , we get (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) 4 (cid:5) (cid:7) s 3 b 2 aN 2 , ( 13 ) where the pixel size a has been inserted to make the units correct . Pixelation noise is not observed in Eq . 13 because the substitution of a sum with an integral has implicitly assumed the pixel size to be infinitesimal . However , it will be shown later that , in practice , the pixel size should be around the spot size , where the spot size is defined as the standard deviation of the point - spread function distribution . Precise Localization Analysis 2777 Biophysical Journal 82 ( 5 ) 2775 – 2783 The two expressions for the limiting cases of photon - counting noise and pixelation noise , and background noise can be combined into one equation , (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) s 2 (cid:6) a 2 / 12 N (cid:6) 4 (cid:5) (cid:7) s 3 b 2 aN 2 , ( 14 ) that is valid at each limit and provides an easy but approx - imate answer in between these two limits . Numerical inte - gration of Eq . 11 combined with Eq . 12 shows that the equation above underestimates the true error by 8 % in the transition region ( 10 % for the two - dimensional case de - scribed below ) . It can be seen that the uncertainty falls as 1 / N for background noise and as 1 / (cid:12) N for photon - counting noise . This gives rise to a transition point , N t (cid:3) 4 (cid:5) (cid:7) s 3 b 2 a (cid:4) s 2 (cid:6) a 2 / 12 (cid:5) . ( 15 ) The localization of spots with fewer numbers of photons will be dominated by background noise , whereas the local - ization of spots with greater numbers of photons will be dominated by photon - counting noise . Repeating the above analysis with a derivative taken with respect to N instead of x , gives an error for the estimated total number of photons ( or the integrated intensity ) in the spot , (cid:6)(cid:4) (cid:7) N (cid:5) 2 (cid:8) (cid:3) N (cid:6) 2 (cid:5) (cid:7) sb 2 a . ( 16 ) The photon - counting noise results in the expected counting error on the total number of photons , whereas the back - ground noise produces a floor at low intensities . The above results were calculated only for one - dimen - sional localization , but it is straightforward to generalize to two - dimensional localization . The sum (cid:2) 2 stretches over two indices , giving a two - dimensional integral to evaluate . The result is (cid:6)(cid:4) (cid:7) x (cid:5) 2 (cid:8) (cid:3) s 2 (cid:6) a 2 / 12 N (cid:6) 8 (cid:7) s 4 b 2 a 2 N 2 ( 17 ) for the uncertainty in each dimension , with a transition point of N t (cid:3) 8 (cid:7) s 4 b 2 a 2 (cid:4) s 2 (cid:6) a 2 / 12 (cid:5) . ( 18 ) The uncertainty in the total number of counts in two dimen - sions is given by (cid:6)(cid:4) (cid:7) N (cid:5) 2 (cid:8) (cid:3) N (cid:6) 4 (cid:7) s 2 b 2 a 2 . ( 19 ) RESULTS Theory Figure 1 presents the theoretical results for the dependence of the localization precision in two dimensions on the total number of detected photons ( Eqs . 17 and 19 ) . The localiza - tion precision and the photon - counting precision are calcu - lated for a spot size ( s ) and pixel size ( a ) of unity . The background noise values are 0 , 1 , 2 , 5 , and 10 detected photons . The spatial localization precision is shown in Fig . 1 A . As expected , at high photon numbers , the localization precision approaches Eq . 5 with a 1 / (cid:12) N power law , the limiting value when background noise becomes negligible . At low photon numbers , the noise is dominated by the background and begins to approach a 1 / N power law . Plots were terminated at the low signal point , where the peak intensity of the spot would be twice the background noise , at which point a spot becomes difficult to observe due to the noise . The transition between the two regimes occurs when b = 10 1E2 1E3 1E4 ∆ x r m s ( s po t s i z e ) total detected photons 10 100 1000 10000 ∆ N r m s ( pho t on s ) 0 . 01 0 . 1 1 1 10 100 1000 b = 0 b = 1 b = 2 b = 5 b = 10 A b = 0 b = 1 b = 2 b = 5 b = 10 B FIGURE 1 Theoretical results for the ( A ) localization precision (cid:7) x rms and ( B ) intensity uncertainty (cid:7) N rms are plotted as a function of the total number of photons detected N for background noise b (cid:10) 0 , 1 , 2 , 5 , 10 photons . Values plotted are the result of a numerical integration of Eq . 11 combined with Eq . 12 . The approximation Eq . 14 gives values that are lower than the numerical integration in the transition region by 10 % and 5 % for (cid:7) x rms and (cid:7) N rms , respectively . The pixel size a and the spot size s are both unity . 2778 Thompson et al . Biophysical Journal 82 ( 5 ) 2775 – 2783 the photon - counting noise is roughly equal to the back - ground noise , or when N (cid:10) 8 (cid:7) s 2 b 2 / a 2 . Corresponding results for the uncertainty in the total number of photons are shown in Fig . 1 B . Again , the result at high photon numbers is given by the photon - counting noise (cid:12) N . At low photon numbers , the noise is dominated by background , and hence the uncertainty approaches a plateau independent of the number of photons detected . Gaussian mask fits The theoretical predictions were compared to the experi - mental precision obtained by fitting artificially generated data ( Monte Carlo simulations ) and actual images of fluo - rescent beads . Figure 2 shows a set of images of a 30 - nm fluorescent bead that illustrates the changes in image quality with increasing numbers of photons . Images with different numbers of photons were created by accumulating , offline , varying numbers of frames from a time - series stack of a single bead . The background noise was sufficiently low in each frame that it remained negligible in the accumulated images . Figure 3 A shows the localization precision for the Gauss - ian mask algorithm plotted versus the total number of pho - tons in a spot for a Monte Carlo simulation ( dashed line ) , bead images ( circles ) , and the theoretical precision derived from Eq . 17 ( solid line ) . Figure 3 B shows the correspond - ing results for the uncertainty in the total number of photons for the simulation ( dashed line ) , experimental data ( circles ) , and the theoretical precision derived from Eq . 19 ( solid line ) . The theoretical precision and Monte Carlo simulations used a background noise of b (cid:10) 0 . 7 photons , a spot size of s (cid:10) 208 nm , and a pixel size of a (cid:10) 130 nm , which were chosen to match the values from the bead images . As can be seen in Fig . 3 , A and B , the uncertainty in the Gaussian mask algorithm is about 30 % greater than the localization uncertainty predicted by the theory , for both the Monte Carlo simulations and the actual image data . Figure 4 shows the theoretical ( solid line ) and Gaussian mask Monte Carlo results ( circles ) for the localization error as a function of the pixel size for a 100 - photon spot . The dashed line parallels the theoretical result with an additional 30 % error as observed in Fig . 3 A . Good agreement between the theory with the added 30 % error and the Monte Carlo results is seen at the smaller pixel sizes , where the signal is decreased compared to the background noise as a result of spreading the spot over a larger number of pixels . Note that our treatment of background noise as a property of the pixel is appropriate if the background noise is caused , for exam - ple , by CCD readout noise . For background noise caused by FIGURE 2 A series of images of a fluorescent bead illustrates the increase in image quality with larger numbers of photons N in the spot . Images with larger N were constructed by accumulating off - line either 2 , 4 , 8 , 16 , or 32 images . The number of photons N was estimated with the fitting program as described in Methods . 1E1 1E2 1E3 ∆ x r m s ( n m ) 10 100 total detected photons 10 100 1000 ∆ N r m s ( pho t on s ) 1 10 100 A B FIGURE 3 Results from tracking fluorescent beads ( circles ) and com - puter - generated images ( dashed line ) compare well with the theoretical prediction of Eqs 17 and 19 ( solid line ) . Bead trajectories were generated by passing a time series stack of 120 images through the fitting program . To compensate for drift in the microscope , the uncertainties ( A ) (cid:7) x rms and ( B ) (cid:7) N rms were calculated as the standard deviation of the difference series . This difference series is then divided by (cid:12) 2 to account for the propagation of error . The theoretical precision and Monte Carlo simulations use a background noise of b (cid:10) 0 . 7 , a spot size of s (cid:10) 208 nm , and a pixel size of a (cid:10) 130 nm . Both bead and computer - generated images show an excess noise of 30 % , which is likely due to the absence of photon - counting noise in the derivation of the fitting algorithm . Precise Localization Analysis 2779 Biophysical Journal 82 ( 5 ) 2775 – 2783 out - of - focus fluorescence , in contrast , the localization pre - cision will be virtually unchanged as the pixel size is made smaller . At larger pixel sizes , the theory systematically underestimates the localization error because it only takes the first order into account and neglects the fact that the error must become a / (cid:12) 12 independent of N when a (cid:9)(cid:9) s . The minimum in the curve , however , is accurate at ( a / s ) 4 (cid:10) 96 (cid:7) b 2 / N . An important characteristic of a fitting algorithm is that it shows no systematic deviations of either the localization precision or the average position of the particle , depending on where in the pixel the particle is located . Although this has been found true of the full least - squares fitting algo - rithm ( Cheezum et al . , 2001 ) , it was necessary to test it for the Gaussian mask algorithm . The test was performed by scanning over a 5 (cid:3) 5 grid of x , y positions within the lower right quadrant of a pixel ( the other locations are related by symmetry ) . In general , systematic deviations will become more apparent with greater numbers of photons in the spot , less background noise , and averaging over a greater number of spots . The parameters used were N (cid:10) 10 , 000 , b (cid:10) 0 . 7 , and s / a (cid:10) 1 . 6 . For each x , y position , the results of fitting 10 , 000 spots were averaged , giving an accuracy of 1 % in the means and standard deviations . No systematic devia - tions were found for either the Gaussian mask or the full least - squares algorithms . The 30 % discrepancy between the theory and the Gauss - ian mask algorithm can potentially be attributed to a variety of reasons . Up to 10 % of this error is due to the analytic interpolation between the two limits ( Eq . 17 ) , as opposed to an exact integral . Further error likely arises from the im - plicit assumption of infinitesimal pixel size involved in transforming the summation ( Eq . 11 ) to an integral . In addition , the derivation of Eq . 17 is only to first order in (cid:7) x ; terms of higher order in (cid:7) x and of higher order in 1 / N were dropped . In contrast , the Gaussian mask localization algo - rithm ( Eqs . 3 and 4 ) is based on a least - squares fit without photon - counting noise and is a simplification of the more general nonlinear least - squares fitting algorithm with prop - erly weighted terms . Although the simplification makes the algorithm easier to implement and faster to run , it will also adversely affect the accuracy of localization , especially at high photon numbers . Full least - squares Gaussian fits To better isolate which of the potential causes of the 30 % discrepancy in error estimate is at fault , a series of tests using full least - squares Gaussian fitting was performed . Figure 5 shows a comparison between the full least - squares fitting algorithm , the Gaussian mask localization algorithm , and the theoretical prediction of Eq . 17 . The theory and the full least - squares fitting agree well at high N , as is to be expected because the theory converges to pixel size / spot size ( a / s ) 0 1 2 ∆ x r m s ( s po t s i z e ) 0 . 15 0 . 20 0 . 25 FIGURE 4 The localization uncertainty (cid:7) x rms increases for small pixel sizes a due to increased background noise and for large pixel sizes due to pixelization noise . The theoretical prediction of Eq . 17 ( solid line ) is shown . Results from computer - generated images ( circles ) agree well with the theoretical prediction plus 30 % ( dashed line ) . The deviations at large pixel sizes are due to the inclusion of only the first - order dependence on the pixel size ( see text ) . The position of the minimum of the curve , however , is accurately given by ( a / s ) 4 (cid:10) 96 (cid:7) b 2 / N . Both the analytical theory and the computer - generated images used N (cid:10) 100 photons . 10 100 1000 10000 0 . 01 0 . 10 1 . 00 total detected photons ∆ X r m s ( p i x e l s i z e ) FIGURE 5 Theory and Monte Carlo simulations of two localization algorithms based on the Gaussian mask described in Methods ( filled circles ) or a general nonlinear least - squares minimization ( open circles ) . The parameters are the same as in Fig . 3 : b (cid:10) 0 . 7 , s (cid:10) 208 nm , and a (cid:10) 130 nm . The two methods result in similar localization precision for small N . For large N , the theory ( solid line ) agrees with the full least - squares minimization algorithm . At lower values of N , the prediction of Eq . 17 underestimates the error due to the analytic interpolation between low and high N limits , and to the neglect of higher - order terms in the derivation . At extremely low N , the error of the fitting algorithms increases rapidly due to the low signal to noise in the spots . The Gaussian mask algorithm has greater noise due to its neglect of photon - counting noise in the spot . 2780 Thompson et al . Biophysical Journal 82 ( 5 ) 2775 – 2783 the simpler Eq . 6 , whose derivation is based on assumptions that become very good at large photon numbers . By con - trast , the Gaussian mask algorithm has an excess uncertainty of localization of (cid:13) 30 % at high N , probably because it neglects the counting error on photons originating from the spot . The failure to model the noise correctly thus con - tributes an excess uncertainty of 30 % to the localization precision . At very low N , both fitting methods show considerable excess error above the theory . This is primarily due to the difficulty of consistently locating the spot at such low signal to noise . If the fitting algorithm “slips” from a subliminal spot , it is liable to travel far away from it , resulting in an outlying point in the standard deviation calculation . Thus , a single spot that is difficult to find can significantly bias the statistics upward . In the middle range , the theory slowly begins to under - estimate the full least - squares fit precision , up to a 17 % underestimate at N (cid:10) 50 . Part of this deviation is due to the analytic interpolation between the two limits ( Eq . 17 ) , which we expect to reach a magnitude of 10 % at the transition point of N (cid:10) 30 photons . The remainder of the deviation we ascribe to the discarding of higher - order terms in (cid:7) x and 1 / N in the derivation . The excess error of the Gaussian mask algorithm is expected to decrease with decreasing N as the counting error on the spot’s photons decreases relative to the background noise and the model of the noise becomes more accurate . In Fig . 5 , relative to the full least - squares fits , the Gaussian mask algorithm decreased from 30 % excess error at N (cid:10) 10 , 000 to 7 % excess error at N (cid:10) 50 . Thus , although the full least - squares fits were clearly better in our tests , the differ - ence between the two methods was small at the light levels relevant to many single - particle tracking experiments . Prac - titioners may still wish to use the Gaussian mask algorithm because of its simplicity of implementation and robust operation . To gain a better idea of when the theoretical Eqs . 17 and 19 may be relied upon , we tested the theory in relation to full least - squares fitting over a wide range of the variables N , a / s , and b . We varied N logarithmically between 30 and 10 , 000 photons , a / s between 0 . 33 and 2 , and b between 0 . 1 and 5 photons . We deemed the theory to have poorly predicted the fitted results when the two failed to agree within a factor of two . There were two situations in which the theory failed to accurately predict the full least - squares fits . The first situ - ation occurred with low numbers of photons N and high background noise b . Errors of this sort are seen in Fig . 5 and are responsible for the upward trend at very low N . In this case , as mentioned previously , there was very low signal to noise making it difficult for the fitting algorithms to find the spots , and hence giving a large deviation in position . Such errors greatly decreased the estimated accuracy of the fitting procedures . The second situation in which there were significant deviations between the theory and the least - squares fits occurred when the spot is spread over too few pixels , or when the value a / s was large . An example of this sort of error is evident in Fig . 4 at a / s (cid:9) 1 . 6 . In this case , pixelation noise becomes more significant , and the first - order treat - ment of pixelation noise in the theory is no longer adequate . As mentioned above , the theory neglects the fact that , at high values of a / s , the localization error must become a / (cid:12) 12 , independent of the value of N . In general , values of a / s (cid:14) 1 were well predicted by the theory . Testing of the Gaussian mask algorithm over the same range of variables showed that it performed similarly to the full least - squares fitting , taking into account the 30 % excess error . The algorithm appeared to perform worse than the full least - squares fits at high values of the pixel size a / s , but typically better at high values of background noise b . It disagreed with the theoretical results in the same two situ - ations that were described above . In general , the theory accurately predicted the localiza - tion error over a large portion of the gamut . It should thus serve well as a means of estimating the accuracy of an experiment , as an aid to designing and exploring the limits of proposed experiments , and as a tool for diagnosing and improving the experimental apparatus . DISCUSSION In seeking to optimize measurements for fluorescent - parti - cle localization and tracking , attention should be paid to maximizing the detected fluorescence and minimizing the measurement noise . Typical estimates for the photon - detec - tion efficiency in microscopes are around 1 % , reflecting the accumulated optical transfer efficiencies of the detection angle ( 30 % ) , objective ( 50 % ) , filters ( 80 % ) , beam steering optics ( 50 % ) , and detector quantum efficiency ( 20 % ) ( Sandison et al . 1995 ) . Because good fluorophores can yield on average as many as 10 5 photons before photobleaching , a single fluorophore could theoretically be tracked to a precision of 65 nm over 100 frames , or 20 nm over 10 frames , in the absence of background noise . Use of high numerical aperture objectives is essential both to decrease the spot size and to maximize the number of collected photons . Sources of noise include dark current , CCD readout noise , light leakage , extraneous sources of fluorescence , and cellular autofluorescence , which frequently dominates bio - logical experiments . For example , photomultiplier ( PMT ) - based laser scanning microscopes in photon - counting modes can offer zero readout noise and dark currents of (cid:14) 50 counts / s , giving extremely low intrinsic background noise . The background noise we measured ( 0 . 7 photons / pixel ) only becomes dominant for spots with fewer than 30 photons . Background noise in PMT - based microscopes is not likely to be a problem . Cooled CCD cameras , in con - Precise Localization Analysis 2781 Biophysical Journal 82 ( 5 ) 2775 – 2783 trast , typically have a relatively high readout noise of (cid:13) 5 photons , which will be the dominant source of error unless more than 1600 photons are collected per spot , assuming the same pixel size a as was used in the described experiments . CCD cameras have the advantage of a higher quantum efficiency than PMTs ( 80 vs . 40 % ) , but this higher effi - ciency is insufficient to make up for the associated increase in background , which can be comparable to the low num - bers of photons observed in typical fluorescence experi - ments . In general , a CCD camera can be used instead of a PMT - based system when the expected number of photons per spot N is large , and the increased quantum efficiency gained with a CCD camera overcomes the increase in back - ground noise . It should also be mentioned that the combi - nation of an image intensifier ( microchannel plate ) with some form of image integration ( on chip or electronic ) results in background noise characteristics that are similar to a scanning PMT - based system but in a wide - field configu - ration similar to that used by Ghosh and Webb ( 1994 ) . The analysis we have presented in this paper applies to any subresolution probe used in optical microscopy , includ - ing brightfield and differential interference contrast ( DIC ) probes and fluorescent probes . The expressions for local - ization precision and photon - summing precision ( Eqs . 17 and 19 ) are qualitatively similar to results obtained by Bobroff ( 1986 ) and Kubitscheck et al . ( 1999 ) but have the advantage of simplicity , and they are readily applicable to single - particle tracking experiments . The inverse depen - dence of the error on the number of photons collected means that brightfield or DIC - based strategies for localizing par - ticles are more precise than fluorescence techniques . Such strategies have been used to localize latex beads and col - loidal gold to within 2 nm at 30 frames / s ( Gelles et al . , 1988 ) , in a DIC - based experiment to localize a hair cell cilia to 1 pm / Hz 1 / 2 ( Denk et al . , 1989 ; Denk and Webb , 1990 ) , and in conjunction with optical trapping to localize latex beads in experiments on motor proteins ( Svoboda et al . 1993 ; Wang , 1999 ) . These brightfield and DIC experiments , however , use relatively large ( 1 - (cid:8) m - diameter ) latex beads or 30 – 40 - nm - diameter gold particles ( Geerts et al . , 1987 ; Edidin et al . , 1991 ; Sheets et al . , 1997 ) , which are likely to be more obstructive than typical fluorescent labels . Fluores - cent labels can also be targeted to specific proteins , and , unlike large probes , fluorescent labels are not limited to the extracellular environment . Multiphoton or confocal laser scanning microscopes can offer a distinct advantage when the major limitation on localization is background noise caused primarily by cellu - lar autofluorescence or other extraneous sources of fluores - cence . The intrinsic three - dimensional resolution and local - ization of the excitation volume ( Williams et al . , 1994 ) significantly reduces the extra noise caused by fluorescence from immersion oil , scattering inside the microscope , or parts of the cell out of the focal plane . In addition , mul - tiphoton laser scanning microscopes produce fluorescence at wavelengths far from the excitation wavelength , allowing for more efficient optical filtering . Although it is possible that some laser scanning microscopes might introduce ad - ditional errors due to fluctuations in the beam position , we searched for and found no evidence for such artifacts in our apparatus , as also indicated by the agreement between Monte Carlo results and data obtained from a confocal laser scanning microscope . Quantitative subresolution imaging has increasingly be - come more widely used in biology . As new probes become available and detector technology improves , the possibility of obtaining greater precision in the localization of point sources becomes more feasible . We have developed a sim - ple analytical expression for both localization precision and photon - counting precision based on the knowledge of ex - perimentally determined parameters such as background noise and pixel size . We have also described a simple , robust , and effective algorithm for localizing subresolution objects with a precision almost as good a full least - squares fit . R . T . was supported by National Institutes of Health Traineeships in Mo - lecular Biophysics GM08267 and in Pharmacology GM08210 . D . L . was supported by a National Institutes of Health Traineeship in Molecular Biophysics GM08267 . This research was performed in the Developmental Resource for Biophysical Imaging Opto - electronics and was made possible by Grant P41 - RR04224 from the National Center for Research Resources , National Institutes of Health . This material is based upon work supported by the National Science Foundation under Grant BIR - 8800278 . REFERENCES Barak , L . S . , and W . W . Webb . 1981 . Fluorescent low density lipoprotein for observation of dynamics of individual receptor complexes on cul - tured human fibroblasts . J . Cell Biol . 98 : 595 – 604 . Barak , L . S . , and W . W . Webb . 1982 . Diffusion of low density lipoprotein – receptor complex on human fibroblasts . J . Cell Biol . 95 : 846 – 852 . Bobroff , N . 1986 . Position measurement with a resolution and noise - limited instrument . Rev . Sci . Instrum . 57 : 1152 – 1157 . Brown , E . B . , E . S . Wu , W . Zipfel , and W . W . Webb . 1999 . Measurement of molecular diffusion in solution by multiphoton fluorescence photo - bleaching recovery . Biophys . J . 77 : 2837 – 2849 . Cheezum , M . K . , W . F . Walker , and W . H . Guilford . 2001 . Quantitative comparison of algorithms for tracking single fluorescent particles . Bio - phys . J . 81 : 2378 – 2388 . Cherry , R . J . , P . R . Smith , I . E . Morrison , and N . Fernandez . 1998 . Mobility of cell surface receptors : a re - evaluation . FEBS Lett . 430 : 88 – 91 . Denk , W . , and W . W . Webb . 1990 . Optical measurement of picometer displacements of transparent microscopic objects . Appl . Opt . 29 : 2382 – 2391 . Denk , W . , W . W . Webb , and A . J . Hudspeth . 1989 . The mechanical properties of sensory hair bundles are reflected in their Brownian motion measured with a laser differential interferometer . Proc . Natl . Acad . Sci . U . S . A . 86 : 5371 – 5375 . Edidin , M . , S . C . Kuo , and M . P . Sheetz . 1991 . Lateral movements of membrane glycoproteins restricted by dynamic cytoplasmic barriers . Science . 254 : 1379 – 1382 . 2782 Thompson et al . Biophysical Journal 82 ( 5 ) 2775 – 2783 Feder , T . J . , I . Brust - Mascher , J . P . Slattery , B . Baird , and W . W . Webb . 1996 . Constrained diffusion or immobile fraction on cell surfaces : a new interpretation . Biophys . J . 70 : 2767 – 2773 . Geerts , H . , M . DeBrabander , R . Nuydens , S . Geuens , M . Moeremans , J . De May , and P . Hollenbeck . 1987 . Nanovid tracking : a new automatic method for the study of mobility in living cells based on colloidal gold and video microscopy . Biophys . J . 52 : 775 – 782 . Gelles , J . , B . J . Schnapp , and M . P . Sheetz . 1988 . Tracking kinesin - driven movements with nanometre - scale precision . Nature . 331 : 450 – 453 . Ghosh , R . N . , and W . W . Webb . 1994 . Automated detection and tracking of individual and clustered cell surface low density lipoprotein receptor molecules . Biophys . J . 66 : 1301 – 1318 . Goulian , M . , and S . M . Simon . 2000 . Tracking single proteins within cells . Biophys . J . 79 : 2188 – 2198 . Gross , D . , and W . W . Webb . 1986 . Molecular counting of low - density lipoprotein particles as individuals and small clusters on cell surfaces . Biophys . J . 49 : 901 – 911 . Gross , D . , and W . W . Webb . 1988 . Cell surface clustering and mobility of the liganded LDL receptor measured by digital video fluorescence microscopy . In Spectroscopic Membrane Probes . Chap . 10 . L . M . Loew , editor . CRC Press . 19 – 45 . James , J . 1976 . Light Microscopic Techniques in Biology and Medicine . Martinus Nijhoff Medical Division , Amsterdam , the Netherlands . 75 – 82 . Kao , H . P . , and A . S . Verkman . 1994 . Tracking of single fluorescent particles in three dimensions : use of cylindrical optics to encode particle position . Biophys . J . 67 : 1291 – 1300 . Kubitscheck , U . , O . Kuckmann , T . Kues , and R . Peters . 2000 . Imaging and tracking of single GFP molecules in solution . Biophys . J . 78 : 2170 – 2179 . Kubitscheck , U . , T . Kues , and R . Peters . 1999 . Visualization of nuclear pore complex and its distribution by confocal laser scanning microscopy . Methods Enzymol . 307 : 207 – 230 . Peters , I . M . , Y . van Kooyk , S . J . van Vliet , B . G . de Grooth , C . G . Fygdor , and J . Greve . 1999 . 3D single - particle tracking and optical trap mea - surements on adhesion proteins . Cytometry . 36 : 189 – 194 . Sako , Y . , A . Nagafuchi , S . Tsukita , M . Takeichi , and A . Kusumi . 1998 . Cytoplasmic regulation of the movement of E - cadherin on the free cell surface as studied by optical tweezers and single particle tracking : corralling and tethering by the membrane skeleton . J . Cell Biol . 140 : 1227 – 1240 . Sandison , D . R . , R . M . Williams , K . S . Wells , J . Strickler , and W . W . Webb . 1995 . Quantitative fluorescence confocal laser scanning micros - copy ( CLSM ) . In The Handbook of Biological Confocal Microscopy . J . Pawley , editor . IMR Press , Madison WI . 39 – 53 . Saxton , M . J . , and K . Jacobson . 1997 . Single - particle tracking : applications to membrane dynamics . Annu . Rev . Biophys . Biomol . Struct . 26 : 373 – 399 . Schmidt , T . , G . J . Schutz , W . Baumgartner , H . J . Gruber , and H . Schindler . 1996 . Imaging of single molecule diffusion . Proc . Natl . Acad . Sci . U . S . A . 93 : 2926 – 2929 . Schutz , G . J . , H . Schindler , and T . Schmidt . 1997 . Single - molecule mi - croscopy on model membranes reveals anomalous diffusion . Biophys . J . 73 : 1073 – 1080 . Schwille , P . , J . Korlach , and W . W . Webb . 1999 . Fluorescence correlation spectroscopy with single - molecule sensitivity on cell and model mem - branes . Cytometry . 36 : 176 – 182 . Sheets , E . D . , G . M . Lee , R . Simson , and K . Jacobson . 1997 . Transient confinement of a glycosylphosphatidylinositol - anchored protein in the plasma membrane . Biochemistry . 36 : 12449 – 12458 . Smith , P . R . , I . E . Morrison , K . M . Wilson , N . Fernandez , and R . J . Cherry . 1999 . Anomalous diffusion of major histocompatibility complex class I molecules on HeLa cells determined by single particle tracking . Bio - phys . J . 76 : 3331 – 3344 . Svoboda , K . , C . F . Schmidt , B . J . Schnapp , and S . M . Block . 1993 . Direct observation of kinesin stepping by optical trapping interferometry . Na - ture . 365 : 721 – 777 . Tomishige , M . , Y . Sako , and A . Kusumi . 1998 . Regulation mechanism of the lateral diffusion of band 3 in erythrocyte membranes by the mem - brane skeleton . J . Cell Biol . 142 : 989 – 1000 . Wang , M . D . 1999 . Manipulation of single molecules in biology . Curr . Opin . Biotechnol . 10 : 81 – 86 . Williams , R . M . , D . W . Piston , and W . W . Webb . 1994 . Two - photon molecular excitation provides intrinsic 3 - dimensional resolution for la - ser - based microscopy and microphotochemistry . FASEB J . 8 : 804 – 813 . Precise Localization Analysis 2783 Biophysical Journal 82 ( 5 ) 2775 – 2783
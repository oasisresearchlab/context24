The Number of Large Graphs with a Positive Density of Triangles P . Collet 1 and J . - P . Eckmann 2 ; 3 1 Centre de Physique Th´eorique , Laboratoire CNRS UMR 7644 , Ecole Polytechnique , F - 91128 Palaiseau Cedex , France 2 D´ept . de Physique Th´eorique , Universit´e de Gen ` eve , CH - 1211 Gen ` eve 4 , Switzerland 3 Section de Math´ematiques , Universit´e de Gen ` eve , CH - 1211 Gen ` eve 4 , Switzerland Abstract . We give upper and lower bounds on the number of graphs of ﬁxed degree which have a positive density of triangles . In particular , we show that there are very few such graphs , when compared to the number of graphs without this restriction . We also show that in this case the triangles seem to cluster even at low density . 1 . Introduction and statement of results In a number of contexts involving large graphs ( such as the Web or Citation Networks ) it has been observed that such graphs contain a large number of triangles , and probably a positive density of them ( per node ) . We refer to [ EM ] for a detailed discussion . The importance of topology is also mentioned in [ AB ] , where the authors say ( p . 41 ) : “But if the topology of these networks indeed deviates from a random graph , we need to develop tools and measurements to capture in quantitative terms the underlying organizing principles . ” On the other hand , it is well known that in several models of random graphs with a bounded number of links per node the probability of observing a large number of triangles is vanishingly small when the number of nodes diverges . A natural question is therefore to estimate more precisely the number of graphs with a large number of triangles . It will become clear from the discussion of our paper that this result is beyond the “large deviation bounds” which are found in the literature [ VV , JLR ] . In this paper we study the cardinality of sets of graphs with a positive density of triangles per node . We consider ( random ) graphs with sparse sets of links , i . e . , random graphs in which the number of links is bounded by a ﬁxed constant times the number of nodes . We will consider three models of labeled graphs : G ) The model G n ; k comprises the graphs with n nodes and kn links . We call them k - general graphs . O ) The model G n ; k(cid:0) out is the set of all graphs with n nodes , and from each node there leave exactly k directed links ( directed from that node ) . We call these graphs k - out . R ) The model G n ; k(cid:0) reg is the set of all graphs where at each node exactly k links meet . ( This deﬁnition is only interesting if kn is even , which we tacitly assume in the sequel . ) These graphs are called k - regular . Graphs with a Density of Triangles 2 A well - studied question is that of the probability of ﬁnding triangles in such graphs , where the probability is relative to the uniform measure on the set of graphs , giving the same weight to each graph . For all of the above examples , it is known that the expected number of triangles in these graphs is bounded independently of n , by a quantity (cid:21) = O ( k 3 ) . Furthermore , for each t (cid:21) 1 , it has been shown that the probability to ﬁnd exactly t triangles is given , in the limit n ! 1 , by the Poisson distribution P ( t ) = e (cid:0)(cid:21) (cid:21) t t ! : Note however , that this limit is not at all uniform in t , as will be illustrated by our results in Sec . 4 . Further studies have greatly reﬁned this result , giving very precise estimates on the tails of this distribution , as a sort of large deviation result . Our study , in this paper , goes beyond that region , since we ask for the size of subsets of the three graph families with a positive density of triangles . We assume throughout that (cid:11) is a ﬁxed constant (cid:11) > 0 and we consider those graphs in the above classes which have (cid:11)n triangles ( or , more precisely [ (cid:11)n ] triangles , where [ x ] denotes the integer part of x ) . We denote these subsets by G n ; k ; (cid:11) , G n ; k(cid:0) out ; (cid:11) , G n ; k(cid:0) reg ; (cid:11) . If X is a ﬁnite set we denote by jXj its cardinality . Our main result is the following Theorem 1 . 1 . Fix k 2 N and (cid:11) > 0 . Forthethreegraph families wehavethebounds ( valid whenthelowerboundisnon - negative ) : lim n ! 1 log jG n ; k ; (cid:11) j log jG n ; k j = 1 ; ( 1 : 1 ) 1 (cid:0) 3 (cid:11) 4 ( k 2 (cid:0) 1 ) (cid:20) lim inf n ! 1 log jG n ; k(cid:0) out ; (cid:11) j log jG n ; k(cid:0) out j (cid:20) lim sup n ! 1 log jG n ; k(cid:0) out ; (cid:11) j log jG n ; k(cid:0) out j (cid:20) 1 (cid:0) (cid:11) 2 k 2 ( 5 k + 1 ) ; ( 1 : 2 ) 1 (cid:0) 12 (cid:11) k 2 (cid:0) 1 (cid:20) lim inf n ! 1 log jG n ; k(cid:0) reg ; (cid:11) j log jG n ; k(cid:0) reg j (cid:20) lim sup n ! 1 log jG n ; k(cid:0) reg ; (cid:11) j log jG n ; k(cid:0) reg j (cid:20) 1 (cid:0) 2 (cid:11) k ( k (cid:0) 1 ) : ( 1 : 3 ) We conjecture that in the statement above the limits exist ( assuming , of course , that kn is even in the k - regular case ) . Remark 1 . 2 : From the point of view of Information Theory or Statistical Mechanics / Large Deviations , thenumberoftrianglesisanextensivequantityrelativetothenumberofnodes . But thelogarithmicboundsweﬁndare not extensiveinthenumberofnodes : Theyareextensiveand smallonthescale ( ofthelogarithms ) ofthenumberofgraphs . Thissuggeststhatthepresence ofapositivedensityoftrianglesisaverystronginformationaboutthesystem . Indeed , imposingthatthenumberoftrianglesisproportionaltothenumberofnodesleads Graphs with a Density of Triangles 3 intuitively to the conclusion that if one considers two links emanating from a common node , thereisanonzeroprobabilitythattheirendsarealsolinked . Remark 1 . 3 : Weprovemorepreciseboundsin ( 3 . 2 ) . Remark 1 . 4 : Oneshouldnotethata k - regulargraphismorelikea k = 2 - outgraph ( becauseeach linkiscountedtwice ) . Remark 1 . 5 : Thelowerboundsareobtainedbyconstructinggraphscontainingcompletegraphs ofmaximalsize . Wedonotknowwhethertheseboundsareoptimal . Iftheyare , thiswouldmean thatcompletegraphsare“typical”amongrandomgraphswithapositivedensityoftriangles . The reader should observe that the lower bound is a little surprising . Indeed , assume (cid:11) > 0 is very close to 0 . Then , one might expect that since the density of triangles is very low , they will typically be ( edge and node ) disjoint in the set G n ; k(cid:0) out ; (cid:11) ( and similarly for G n ; k(cid:0) reg ; (cid:11) ) . For each such triangle , once one has placed 2 of the 3 links forming it , the third link is already determined when we close the triangle and thus , under the assumption of disjointness , only nk (cid:0) (cid:11)n links can be chosen freely [ in the case of the regular graphs this number is nk = 2 (cid:0) (cid:11)n ] leading to an upper bound of n nk(cid:0)(cid:11)n . But , our lower bound is larger than that . Therefore we conclude : Remark 1 . 6 : In the families of graphs G n ; k(cid:0) out ; (cid:11) and G n ; k(cid:0) reg ; (cid:11) the triangles have a natural tendencytocoagulateintoclusters . Another surprising result is that in the case of G k ; n ; (cid:11) of Eq . ( 1 . 1 ) , there is no loss in the number of graphs on the scale of n n . This might seem all the more surprising in view of the Poisson distribution of the expected number of triangles ( but is more credible in view of the non - uniform diagonal limit t = (cid:11)n ! 1 which we are considering ) . The paper proceeds from the k - regular graphs via the k - out graphs to the k - general graphs . We prove ﬁrst upper bounds and then the ( easier ) lower bounds . 2 . Upper bound for k - regular graphs This section should be considered as a warm - up for the next one . Therefore , many arguments are sketched , and the reader can ﬁnd longer explanations in the next section . On the other hand , the general line of proof should be more transparent . The reader will also notice that the k - regular case is much less delicate than the k - out case . We assume that nk is even because otherwise there are no k - regular graphs . For a k - regular graph , the general bound is [ B ] : jG n ; k(cid:0) reg j (cid:25) C ( k ) n n nk = 2 : ( 2 : 1 ) A given link cannot be an edge in more than k (cid:0) 1 triangles , because exactly k links meet at each node ( see also Lemma 3 . 3 ) . For every link we say that it is s times occupied if it occurs in Graphs with a Density of Triangles 4 s triangles , and every triangle occupies ( in this sense ) 3 links . Thus the total occupation number is 3 (cid:11)n , and therefore the number of links involved in edges of triangles is at least 3 (cid:11)n = ( k (cid:0) 1 ) ( and at most 3 (cid:11)n ) . We next bound the number of ways to draw (cid:11)n triangles . Label the nodes , and for every node i let t i be the number of triangles having i ; j ; m as corners with i the smallest of the three indices . The number of ways to choose the t i is (cid:18) (cid:11)n + n (cid:0) 1 n (cid:0) 1 (cid:19) (cid:20) 2 ( (cid:11) + 1 ) n ; ( 2 : 2 ) which is negligible on the scale we consider . With the t i ﬁxed , we draw the triangles at i = 1 ; 2 ; : : : . Note that in this process we will have to place at least ` = 3 (cid:11)n = ( k (cid:0) 1 ) links . Now , if we draw a triangle , several things can happen . Either the triangle is already drawn , because its 3 sides have been placed as sides of triangles which have been drawn earlier . No link needs to be placed in this case . In all other cases , between one and 3 links need to be drawn . The least favorable case occurs when 3 links have to be placed . Then , there are at most n ( n(cid:0) 1 ) possibilities to choose the ﬁrst 2 links and then at most 1 possibility for the third , and we get a factor of n 1 (cid:0) ( 1 = 3 ) per link . If only one new link is used , and it starts at i ( and the two others are already there ) , there are at most k 2 possible endpoints for that link and we get a factor k 2 n 1 (cid:0) 1 in this case . If the one missing link is between two links ( which are already there when this link has to be placed ) we get at most k ( k (cid:0) 1 ) n 0 = 2 possibilities . Finally , if two links are missing , there are 2 possibilities : Either it is two links starting at i , and this makes at most nk = kn 2 (cid:0) 1 ways , or one link starting at i and one not starting at i which makes at most nk = n 2 (cid:0) 1 k possibilities . Indeed , there are n possibilities to choose the end j of the link starting at i and then there are at most k possibilities for choosing the second link . Once two links are chosen , the triangle is completely determined since all its nodes are ﬁxed . Thus for all these links we get a bound of at most k 2 ` n ` (cid:0) ` = 3 ( 2 : 3 ) possibilities , that is , k 2 n 2 = 3 per link . Finally , the remaining kn = 2 (cid:0) ` links can be put in at most n kn = 2 (cid:0) ` ways . Summing over the possible number of links ( which is bounded by 3 (cid:11)n = ( k (cid:0) 1 ) (cid:20) ` (cid:20) 3 (cid:11)n and yields a factor which can be easily absorbed ) , and combining the two bounds , we get a bound C n n kn = 2 (cid:0) 3 (cid:11)n = ( 3 ( k(cid:0) 1 ) ) = C n n kn = 2 (cid:0)(cid:11)n = ( k(cid:0) 1 ) : ( 2 : 4 ) This completes the proof of the upper bound of ( 1 . 3 ) . Remark . A second proof could be derived from a modiﬁcation of the proof for the case of k - out graphs which we give below . Graphs with a Density of Triangles 5 3 . An upper bound for k - out graphs In this section , we consider the set G n ; k(cid:0) out of graphs where each node has k out - links . The cardinality of this set is jG n ; k(cid:0) out j = (cid:18) n (cid:0) 1 k (cid:19) n : ( 3 : 1 ) In other words , we allow for links which go back and forth between 2 nodes , but we do not allow double directed links in the same direction between 2 nodes . Also self - links ( loops ) are forbidden . We denote by G n ; k(cid:0) out ; (cid:11) the subset of G n ; k(cid:0) out with [ (cid:11)n ] triangles , where triangles are counted as follows : Once the links are placed , their orientation is neglected and unoriented triangles are counted , including the multiplicity of the edges ( which can be 1 or 2 by what we said above ) . For example , 3 nodes with the possible 6 directed links between them count as 8 = 2 3 triangles . By and large , these distinctions are not very essential for the proofs we are going to give and other choices will work with similar proofs . Since , for ﬁxed j , one has ( m (cid:0) j + 1 ) j j ! (cid:20) (cid:18) m j (cid:19) (cid:20) m j j ! ; we see that , for ﬁxed k , lim n ! 1 log jG n ; k(cid:0) out j n log n = k ; which we will sometimes write in the more suggestive form jG n ; k(cid:0) out j (cid:25) n nk : To be more precise , we deﬁne the notation F ( n ) (cid:25) n n to mean that there are constants C 1 > 0 and C 2 independent of n ( but not of k ) such that C n 1 n n (cid:20) F ( n ) (cid:20) C n 2 n n ; ( 3 : 2 ) so that the error term in the limit is subexponential . Another way to say this is log jG n ; k(cid:0) out j = n (cid:0) k log n + O ( 1 ) (cid:1) : Deﬁne % ( k ) = 1 2 k ( 5 k + 1 ) : Proposition 3 . 1 . Thereisa C = C ( (cid:11) ; k ) < 1 forwhichthequantity jG n ; k(cid:0) out ; (cid:11) j satisﬁesan upperboundoftheform jG n ; k(cid:0) out ; (cid:11) j (cid:20) C n n n ( k(cid:0)(cid:11) % ( k ) ) : ( 3 : 3 ) Remark 3 . 2 : Thisistheupperboundof ( 1 . 2 ) . To avoid the notation [ (cid:11)n ] , we assume henceforth that (cid:11)n is an integer . We consider a conﬁguration with (cid:11)n triangles . The triangles which can occur in a k - out graph are of two types , which we call type R ( for round ) and type F for ( for frustrated ) depending on the relative orientation of the links . Graphs with a Density of Triangles 6 a b a b R F Fig . 1 : “Round” and “frustrated” triangles . In the ﬁrst case all links “follow each other” while in the second there is a “reverse” ( frustrated ) link , the link . The corner with a circle is called the anchor of the triangle , and the links are then labeled in such a way that for a round triangle the a link leaves the anchor , and the others follow in order , while for the frustrated triangles , the a link leaves the anchor and the b link leaves the end of the a link . These rules determine a unique labeling of each triangle if we require the anchor for the round triangle to be at the node with lowest number . We next consider the number of triangles in which a given edge can occur . Because of the k - out model , edges of type b can occur in arbitrary many triangles of type F , by just connecting 2 lines from any node to a given edge . In this respect , the k - out model is more complicated than the k - regular model . However , the other lines can occur only in a small number of triangles . Lemma 3 . 3 . Boundsonthenumbertrianglesperlink : – Alinkcanbeanedgeoftype a inatmost k trianglesoftype R andinatmost k (cid:0) 1 triangles oftype F . – Alinkcanbeanedgeoftype b inatmost k trianglesoftype R . – Alinkcanbeanedgeoftype inatmost k trianglesoftype R andinatmost k (cid:0) 1 triangles oftype F . Proof . Consider ﬁrst the case R . The edge a can occur in at most k triangles . To see this , note that once a is placed , there are k edges of type b leaving its end , and then the triangle must be closed , so there are at most k such triangles . Since R is round , the same reasoning can be done for the other edges . In the case of a triangle of type F , we have already remarked that there is no bound possible for the link b , but we claim the others cannot be part of more than k (cid:0) 1 triangles of type F . Indeed , once link a is ﬁxed , we need to choose another out - link to become link ( and then the b link is ﬁxed ) . This gives k (cid:0) 1 as a bound . Finally , link can belong only to k (cid:0) 1 triangles of type F because for ﬁxed there remain only k (cid:0) 1 candidates for the edge of type a . An important consequence of Lemma 3 . 3 is that the number of edges belonging to at least one of the (cid:11)n triangles grows proportionally with (cid:11)n : Lemma 3 . 4 . Thenumberofedges ` triang belongingtoatleastoneofthe (cid:11)n trianglesinagraph oftype G n ; k(cid:0) out isboundedby (cid:11)n 2 k (cid:20) ` triang (cid:20) 3 (cid:11)n : ( 3 : 4 ) Proof . The upper bound is obvious . To prove the lower bound , note that every triangle involves a link of type a . Since there are k links leaving from the far end of that link , the number of Graphs with a Density of Triangles 7 triangles for which this link is an a link is bounded above by 2 k ( k of type F and k of type R ) . Thus , at least (cid:11)n 2 k links are needed just to draw all a links . Remark 3 . 5 : Notethatan a linkcan bealsoa b or linkformanyothertriangles , andsothe aboveargumentcannotbeeasilyimproved . When k = 2 and n = 3 thecompletegraphforms8 triangles , butneeds6links , insteadofthe4asgivenbythelowerbound . Forcomplete , directed , k - outgraphstheasymptoticboundfor k ! 1 is 3 (cid:11)n 4 k . To prove the bound of Proposition 3 . 1 we give an algorithm which constructs all the graphs with (cid:11)n triangles , and perhaps a few more with more triangles , and we bound the number of ways in which this can be done . To enumerate all the cases , we ﬁrst label the nodes in an arbitrary fashion from 1 to n . Once this is done , we consider any conﬁguration with (cid:11)n triangles . We associate each triangle with a node as follows : Triangles of type F are associated with the node from which the a and links originate . For triangles of type R we label the edges in such a way that the corner where the a and the edges meet has the lowest label among the 3 corners . We call the point from which the a link leaves the anchor of the triangle . Once this is done , there will be t i triangles anchored at node i , for i = 1 ; : : : ; n . Further - more , we denote by v i the number of links arriving at node i once the graph will have been completely constructed . Both t i and v i indicate the values at the end of constructing the graph . In order to construct all possible graphs with (cid:11)n triangles , we start by choosing the t i and the v i . Clearly , n X i = 1 t i = (cid:11)n ; ( 3 : 5 ) and therefore the number of ways of choosing the t i is bounded by A = (cid:18) (cid:11)n + ( n (cid:0) 1 ) n (cid:0) 1 (cid:19) (cid:20) 2 ( (cid:11) + 1 ) n : ( 3 : 6 ) The v i satisfy P i v i = kn , since each link arrives somewhere . The number of ways to distribute the ends of the kn links is therefore bounded above by B = (cid:18) kn + ( n (cid:0) 1 ) n (cid:0) 1 (cid:19) (cid:20) 2 ( k + 1 ) n : ( 3 : 7 ) We will need the following Lemma 3 . 6 . Theproductofthe v i + k satisﬁes n Y i = 1 ( v i + k ) (cid:20) ( 2 k ) n : ( 3 : 8 ) Proof . Since the sum of the v i + k equals 2 kn , the maximal value of the product is (cid:0) 2 kn = n (cid:1) n . Graphs with a Density of Triangles 8 Thus , once the t i and v i are ﬁxed , we have lost a ( negligible ) combinatorial factor C n 0 , with C 0 (cid:20) 2 (cid:11) + k + 2 ( k + 1 ) . Lemma 3 . 7 . Ateachnode , atmost k 2 roundtrianglesandatmost k ( k (cid:0) 1 ) frustratedtriangles canbeanchored . Proof . Consider ﬁrst the round triangles . There are k outgoing links from a given node , and from each of their ends there are another k outgoing links and then the triangle must be closed , and so there are at most k 2 round triangles . For the frustrated triangles , we ﬁrst choose a pair of outgoing links and then the direction of the link connecting their ends . Having ﬁxed the t i , v i , we now place the triangles starting with all those anchored at node 1 , proceeding to node 2 , 3 , and so on , until we arrive at node n . At each node i we construct ﬁrst all the F triangles and then all the R triangles . Assume the ﬁrst s (cid:0) 1 triangles have been drawn , and assume we are placing the next triangle anchored at node i . We will ﬁrst make a choice of which links of the new triangle are assumed to be present . This gives 8 = 2 3 choices . There are 2 more choices between type F and R , ( in fact less since we insist on building ﬁrst all the F before the R ) . For each of these choices , we bound the maximal number of ways a triangle can be placed . We call these bounds F j for the frustrated triangles and R j for the round triangles , j = 1 ; : : : ; 8 . An upper bound on the number of ways to place a triangle ( given its anchor ) is then 16 max ( F 1 ; : : : ; F 8 ; R 1 ; : : : ; R 8 ) : When we construct a triangle at i , it will be denoted by its corners ( i ; j ; m ) . If it is round its links are a = ij , b = jm , and = pq with p = m , q = i . If it is frustrated , its links are a = ij , b = jm , and = pq with p = i , q = m . Table I case new links # links = Æq R F min . gain 1 ab 3 n 2 n 2 n (cid:0) 1 2 ab 2 nv i nk ( v i + k ) n (cid:0) 1 3 a 2 nk nk kn (cid:0) 1 4 a 1 n n 1 ? 5 b 2 nk nk kn (cid:0) 1 6 b 1 kv i k 2 ( v i + k ) 2 n (cid:0) 1 7 1 k 2 k 2 k 2 n (cid:0) 1 8 none 0 k 2 k 2 k 2 ? Graphs with a Density of Triangles 9 The 16 cases are represented in Table I . The second column indicates which links are new in forming the triangle , and the next the number of these new links . The next two columns indicate the maximum number of ways the given case can appear . The last column will be explained below . Proof of Table I . To prove the bounds on the multiplicative factors is just a veriﬁcation . We indicate a few cases to guide the reader . In case 1 , we place 3 links of which 2 can be chosen freely ( the a link and then the b link ) , whereas the third link is then completely determined . Therefore , we get a factor ( n (cid:0) 1 ) ( n (cid:0) 2 ) , for both types of triangles , and we bound this by n 2 In case 2 , the link is already present . For a round triangle there are at most v i possibilities for a link to end in i . The a link can be chosen in n ways , and the b link must connect the end of a to one of the , and this can be done in v i ways . Thus we get a factor nv i . In the case of the frustrated triangles , there are only k (cid:0) 1 possibilities for the link ( which now originates at i ) since one link is used as the a link : The factor is therefore at most nk . All other cases are discussed similarly , for example , in case 7 , the link is missing , but the a and b links are present , and there are k possible ends for a and another k possible ends for each of the b attached to a . Finally , we explain case 4 which is the critical case . In it , the b link and the link are given . Since one link cannot be placed in more than n (cid:0) 1 ways , the factor n is an upper bound . Finally , the last column of Table I is calculated as follows . Its entry is an upper bound on the sup of the R and F column , divided by n # links . To explain the proof of Proposition 3 . 1 we will ﬁrst consider the simpler situation where the cases 4 and 8 do not appear . Indeed , in these two cases , the combinatorial factor of the last column in Table I is not small when n is large . In this simpliﬁed case , each time we place a triangle , the number of links increases by Æq and the number of possibilities is bounded by 16 n Æq n (cid:0) 1 ( v i + k ) 2 : Since 1 (cid:20) Æq (cid:20) 3 we can bound this from above by 16 n Æq ( 1 (cid:0) 1 = 3 ) ( v i + k ) 2 : From Lemma 3 . 4 , we know limits on ` triang , so that P ( Æq ) = ` triang , and ` triang 2 [ (cid:11)n = ( 2 k ) ; 3 (cid:11)n ] . We get , in the end , for constructing at least (cid:11)n triangles with ` triang links , an upper bound of 16 (cid:11)n n 2 ` triang = 3 n Y i = 1 ( v i + k ) 4 k 2 : The last factor is obtained by observing that there are at most k 2 + k ( k (cid:0) 1 ) triangles anchored at a given node by Lemma 3 . 7 . Placing the links not involved in making triangles gives at most a factor n per link , and therefore , using also Eqs . ( 3 . 6 ) and ( 3 . 7 ) , we get an upper bound n nk n (cid:0) ` triang = 3 2 ( (cid:11) + 1 ) n 16 (cid:11)n 2 ( k + 1 ) n ( 2 k ) n 4 k 2 : Graphs with a Density of Triangles 10 The sum over the possible values of ` triang is bounded by 3 (cid:11)n times the largest contribution ( which occurs for ` triang = (cid:11)n = ( 2 k ) ) , and we get a bound 3 (cid:11)n (cid:1) C n n nk n (cid:0)(cid:11)n = ( 6 k ) 2 ( (cid:11) + 1 ) n ; ( 3 : 9 ) with C = 16 (cid:11) 2 ( k + 1 ) ( 2 k ) 4 k 2 : What about the starred cases ? As is visible from Table I , there is no gain in the cases 4 and 8 . Since we count everything in terms of links , the case 8 is harmless : We have no gain , but we also place no link . Thus the bad case is 4 . We will show that case 4 cannot occur too often , and thus a ﬁxed minimal proportion of the cases will give a gain . In the case 4 ( for a frustrated triangle ) we are in the process of drawing a triangle in which only an a link is missing . In this case , we observe the “history” of the link . Note that the link originates at i , but its other end has an index m which can be greater or less than i . We distinguish several cases : F1 ) m > i : Then there are 2 subcases . F1a ) The link i ! m was placed when a triangle anchored at some node i 0 < i was formed . Then it must have been placed as a b link . F1b ) The link i ! m was placed when another triangle anchored at i was formed . Since we begin with the frustrated triangles , this must have been a frustrated triangle . Note , however , that when the ﬁrst frustrated triangle at i is being placed , this case cannot occur and we must begin with the case F1a ( or with a case other than case 4 ) . F2 ) m < i : There are 4 subcases : F2a ) The link i ! m was a b link when it was placed . F2b ) The link was placed as a link of an R triangle anchored at m . F2c ) The link was placed as a link of another F triangle anchored at i . F2d ) The link was placed as an a link of another frustrated triangle anchored at i . Note , however , that when the ﬁrst frustrated triangle at i is being placed , this case cannot occur and we must begin with one of the cases F2a – F2c ( or with a case other than case 4 ) . In the case 4 ( for a round triangle ) we complete a round triangle with a missing a link . In this case , we observe the “history” of the b link . There is only one possibility : R ) The b link of such a triangle will connect nodes j ! m with both j and m greater than i . Therefore , it can only have been placed as a b link when we constructed a triangle anchored at a node with label i 0 (cid:20) i . To keep track of the conditions mentioned above , we introduce counters which “distribute” the gain which comes from placing a b or link onto those further uses of this link in case 4 , where no gain is possible . To do the bookkeeping , we introduce for every link ij a counter ij . Each of these is 0 as we start the inductive procedure to be described below : ij ; 0 = 0 ; for all i 6 = j 2 f 1 ; : : : ; ng . If a link ij is placed for the ﬁrst time and it is a b link or a link as it is placed , we set ij = 2 k (cid:0) 2 . Each time a link ij is used as a link in one of the cases F1a Graphs with a Density of Triangles 11 or F2a – F2c ( and only in those ) the counter ij is reduced by one . The maximal number of uses in Case 4 of a link placed originally as a b link is 2 k (cid:0) 2 ( used k (cid:0) 1 times for the link of an F triangle and another k (cid:0) 1 times for the b link of an R triangle ) . Similarly , a link placed as a link can be used in Case 4 another k (cid:0) 2 times as a link in an F triangle . Since the number of uses is less than 2 k (cid:0) 2 , none of the counters ij will ever become negative . Our last counters keep track of the occurrence of the number of times we are in case F1b or F2d at a given node i . At the beginning of the induction , we set a i ; 0 = 0 for all i 2 f 1 ; : : : ; ng . Each time we encounter a case among 1 – 3 , 5 – 7 , F1a , F2a – F2c , or R , at node i , we increase a i by k . Each time , we encounter case F1b or F2d , we decrease a i by 1 . Note that since these latter cases cannot occur more than k times , and they can not occur for the ﬁrst triangle at node i , we conclude that none of the counters a i ever becomes negative . We now prove recursively that at any given step of the construction after adding triangle t , we have a bound on the total number of possibilities which is of the form N t (cid:20) n q t ( 1 (cid:0)(cid:12) ) n (cid:0)(cid:27) P rs rs ; t = ( k(cid:0) 2 ) n (cid:0) % P s a s = k t Y s = 1 (cid:0) 16 ( v i s + k ) 2 (cid:1) ; ( 3 : 10 ) where q t is the number of links already drawn , i s is the number of the node at which the s th triangle is anchored and (cid:27) > 0 , (cid:12) > 0 , and % > 0 will be given later on . If we can show that there is a positive (cid:12) for which these inequalities hold , then we have shown a bound of the type of Proposition 3 . 1 , since none of the counters ever becomes negative . The recursive proof starts when there is no link and all counters are equal to 0 , hence the bound is trivially true , ( N 0 = 1 ) . We now explain the action at node i . During the construction of the triangles anchored at i , some counters will be updated , and the bound on the combinatorial factor will evolve correspondingly . We now inspect the evolution of the bound during the different possible actions taken at step i . Assume that t (cid:0) 1 triangles have been placed , and that we are placing now triangle t which is anchored at i t = i . Case 1 : According to column R or F of Table I , we have N t (cid:20) N t(cid:0) 1 n 2 : But according to the second and third columns of Table I , the number of links increases by 3 , thus q t = q t(cid:0) 1 + 3 . The link jm was empty at time t (cid:0) 1 and will be ﬁlled at time t . Therefore , jm ; t(cid:0) 1 = 0 and jm ; t = 2 k (cid:0) 2 , and similarly [ m ; i ] ; t(cid:0) 1 = 0 and [ m ; i ] ; t = 2 k (cid:0) 2 . Finally , a i ; t = a i ; t(cid:0) 1 + k . The other counters are unchanged . Therefore , we ﬁnd n 2 (cid:1)n (cid:0)(cid:27) jm ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 3 ( 1 (cid:0)(cid:12) ) n (cid:0)(cid:27) jm ; t = ( 2 k(cid:0) 2 ) n (cid:0)(cid:27) [ m ; i ] ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k (cid:1) n 2 (cid:0) 3 ( 1 (cid:0)(cid:12) ) + 2 (cid:27) + % ; ( 3 : 11 ) where [ m ; i ] = mi or im according to the orientation of the link ( R or F case ) . 1 Since q t = q t(cid:0) 1 + 3 , we see that N t satisﬁes the inductive bound provided the last factor in 1 Note that (cid:0)(cid:27) jm ; t(cid:0) 1 = ( 2 k (cid:0) 2 ) = (cid:0)(cid:27) jm ; t = ( 2 k (cid:0) 2 ) + (cid:27) ; Graphs with a Density of Triangles 12 ( 3 . 11 ) is (cid:20) 1 , which is the case if 1 (cid:21) 3 (cid:12) + 2 (cid:27) + % : ( 3 : 12 ) Case 2 : Two new links ( an a and a b ) appear and the combinatorial factor is max ( nv i ; nk ) (cid:20) n ( v i + k ) . The counter jm is increased by 2 k (cid:0) 2 and the counter a i is increased by k . Also , q t = q t(cid:0) 1 + 2 . The bound analogous to ( 3 . 11 ) is therefore n ( v i + k ) (cid:1) n (cid:0)(cid:27) jm ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 2 ( 1 (cid:0)(cid:12) ) n (cid:0)(cid:27) jm ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k n 1 (cid:0) 2 ( 1 (cid:0)(cid:12) ) + (cid:27) + % ( v i + k ) ; which proves the inductive assumption if 1 (cid:21) 2 (cid:12) + (cid:27) + % : ( 3 : 13 ) Case 3 : The counter [ m ; i ] is increased by 2 k (cid:0) 2 and a i is increased by k , and the inductive bound is nk n (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 2 ( 1 (cid:0)(cid:12) ) n (cid:0)(cid:27) [ m ; i ] ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k n 1 (cid:0) 2 ( 1 (cid:0)(cid:12) ) + (cid:27) + % ( v i + k ) ; which proves the inductive assumption if ( 3 . 13 ) holds . Case 5 : The counters jm and [ m ; i ] are increased by 2 k(cid:0) 2 , and a i is increased by k . Therefore , nk(cid:1)n (cid:0)(cid:27) jm ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 2 ( 1 (cid:0)(cid:12) ) n (cid:0)(cid:27) jm ; t = ( 2 k(cid:0) 2 ) n (cid:0)(cid:27) [ m ; i ] ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k n 1 (cid:0) 2 ( 1 (cid:0)(cid:12) ) + 2 (cid:27) + % ( v i + k ) ; which proves the inductive assumption if 1 (cid:21) 2 (cid:12) + 2 (cid:27) + % : ( 3 : 14 ) Case 6 : The counter jm is increased by 2 k (cid:0) 2 , and a i is increased by k . Therefore we get n 0 ( v i + k ) 2 (cid:1) n (cid:0)(cid:27) [ jm ] ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 1 (cid:0)(cid:12) n (cid:0)(cid:27) [ jm ] ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k n (cid:0) ( 1 (cid:0)(cid:12) ) + (cid:27) + % ( v i + k ) 2 ; and also (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( 2 k (cid:0) 2 ) = (cid:0)(cid:27) [ m ; i ] ; t = ( 2 k (cid:0) 2 ) + (cid:27) ; and this exactly compensates the factor n 2 (cid:27) . Similarly , (cid:0) % a i ; t(cid:0) 1 = k = (cid:0) % a i ; t = k + % ; which compensates the factor n % at the end of ( 3 . 11 ) . Graphs with a Density of Triangles 13 which proves the inductive assumption if 1 (cid:21) (cid:12) + (cid:27) + % : ( 3 : 15 ) Case 7 : The counter [ m ; i ] is increased by 2 k (cid:0) 2 , and a i is increased by k . Therefore we get n 0 k 2 (cid:1) n (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 1 (cid:0)(cid:12) n (cid:0)(cid:27) [ m ; i ] ; t = ( 2 k(cid:0) 2 ) n (cid:0) % a i ; t = k n (cid:0) ( 1 (cid:0)(cid:12) ) + (cid:27) + % ( v i + k ) 2 ; which proves the inductive assumption if ( 3 . 15 ) holds . Case 8 : This case occurs if we want to draw a triangle anchored at i which has appeared in an earlier phase of the construction ( for example , if its sides are all sides of type b from triangles anchored at i 0 < i ) . In this case , no new link , but 1 new triangle and a factor appear k 2 (cid:20) ( v i + k ) 2 ; and the inductive assumption evidently holds , since only the number of triangles increases , but not the number of links . The conditions we require so far on (cid:12) , (cid:27) , and % are all satisﬁed if 1 (cid:21) 3 (cid:12) + 2 (cid:27) + % : ( 3 : 16 ) We now come to Case 4 : Whenever one of the subcases F1a , F1b , or F2a – F2c applies , the link i ! m was placed earlier as a b or a link , and we decrease the corresponding counter im by one unit , and in the case R the counter mi is decreased . The counter a i is unchanged in these cases . Therefore , we ﬁnd that n (cid:1) n (cid:0)(cid:27) [ m ; i ] ; t(cid:0) 1 = ( k(cid:0) 2 ) (cid:20) n 1 (cid:0)(cid:12) n (cid:0)(cid:27) [ m ; i ] ; t = ( k(cid:0) 2 ) n (cid:12)(cid:0)(cid:27) = ( 2 k(cid:0) 2 ) ; and this proves the inductive assumption provided (cid:12) (cid:20) (cid:27) = ( 2 k (cid:0) 2 ) : ( 3 : 17 ) The remaining cases are F1b and F2d . In these cases the counter a i becomes useful : It is decreased by 1 and all other counters are unchanged . Therefore , we get n (cid:1) n (cid:0) % a i ; t(cid:0) 1 = k (cid:20) n 1 (cid:0)(cid:12) n (cid:0) % a i ; t = k n (cid:12)(cid:0) % = k ; and the inductive assumption holds provided (cid:12) (cid:20) % = k : ( 3 : 18 ) We have now discussed all cases . It remains to see that the constants (cid:12) , (cid:27) , and % can be chosen consistently . They have to satisfy ( 3 . 16 ) , ( 3 . 17 ) , and ( 3 . 18 ) . We ﬁnd that the optimal solution is % = k(cid:12) ; (cid:27) = ( 2 k (cid:0) 2 ) (cid:12) ; and 1 = 3 (cid:12) + 2 ( 2 k (cid:0) 2 ) (cid:12) + k(cid:12) : Graphs with a Density of Triangles 14 Thus , we ﬁnd (cid:12) = 1 2 k ( 5 k + 1 ) ; and the proof of the inductive assumption is complete . Recall that to draw t triangles we need at least t = ( 2 k ) links , and no more than 3 t links . We therefore conclude ( combining the bound on N t with ( 3 . 6 ) and ( 3 . 7 ) ) that the number of graphs with t triangles is bounded by 3 t (cid:1) 16 t 2 t + n n nk(cid:0)(cid:12)t = ( 2 k ) 2 ( k + 1 ) n ( 2 k ) n ( 2 k 2 (cid:0)k ) ; where the last factor follows from ( 3 . 10 ) and the observation that the number of triangles anchored at a node is bounded by 2 k 2 (cid:0) k by Lemma 3 . 7 . The proof of Proposition 3 . 1 is complete . 4 . A lower bound for k - general graphs Here , we consider the class G n ; k of graphs with n nodes and kn links which can be placed anywhere we please . ( This model is close to the well known model G n ; p where any of the links is chosen with probability p = 2 k = n . ) Lemma 4 . 1 . Fix any (cid:11) > 0 . The numberof graphs with (cid:11)n triangles in the class of graphs with n nodesand kn linksis ( forlargeenough n ) atleast jG n ; k ; (cid:11) j (cid:21) e (cid:0)O ( n 2 = 3 ) n (cid:0) ( (cid:11)n ) 2 = 3 jG n ; k j : Remark 4 . 2 : ThisisclearlymuchlargerthantheboundofProposition3 . 1 , andalmostaslarge as n nk , infact lim n ! 1 log jG n ; k ; (cid:11) j n log n = k : Thisalsoproves ( 1 . 1 ) , since jG n ; k j = (cid:18)(cid:0) n 2 (cid:1) nk (cid:19) (cid:25) n nk : Proof . Among the n nodes choose (cid:11) 1 = 3 n 1 = 3 . This can be done in (cid:18) n (cid:11) 1 = 3 n 1 = 3 (cid:19) (cid:21) 1 ( 4 : 1 ) Graphs with a Density of Triangles 15 ways . ( Here and throughout the proof we do not worry about the integer parts . ) With these nodes we build a complete graph , this consumes about (cid:11) 2 = 3 n 2 = 3 links and gives (cid:11)n triangles ( and it can be done in 1 way ) . Now among the remaining n (cid:0) (cid:11) 1 = 3 n 1 = 3 nodes distribute the kn (cid:0) (cid:11) 2 = 3 n 2 = 3 links so that there is no triangle . The number of ways this can be done can be estimated from below using the well known result on the number of graphs without triangles ( see [ B ] ) , namely this number is bounded below by O ( 1 ) (cid:18) (cid:0) n(cid:0)(cid:11) 1 = 3 n 1 = 3 2 (cid:1) kn (cid:0) (cid:11) 2 = 3 n 2 = 3 (cid:19) (cid:21) e (cid:0)O ( n 2 = 3 ) n (cid:0) ( (cid:11)n ) 2 = 3 (cid:18)(cid:0) n 2 (cid:1) nk (cid:19) : ( 4 : 2 ) Combining ( 4 . 1 ) and ( 4 . 2 ) we get the lower bound . Remark 4 . 3 : In somesense , thisresultcan beviewedas acomplementtothelargedeviation resultsofVu [ VV ] , seealso [ JLR ] . Considerthepolynomialassociatedwithtrianglesinagraph with n nodes : Y = X 1 (cid:20)i < j < m(cid:20)n t ij t jm t mi : Forthispolynomial ( inthecaseofthemodel G 0 n ; p wherelinksappearwithprobability p = k = n ) onehas E ( Y ) = O ( 1 ) ; E 0 ( Y ) = O ( n (cid:0) 1 ) ; with E the expectation in the random set . Taking Theorem 1 . 1 in [ VV ] and choosing (cid:21) = O ( (cid:11) 1 = 3 n 1 = 2 ) onegetsanupperboundoftheform P ( jY j (cid:21) (cid:11)n ) (cid:20) e (cid:0)O ( (cid:11) 1 = 3 n 1 = 2 ) : NotethatthisisconsistentwiththelowerboundofLemma4 . 1 . 5 . A lower bound for k - out graphs ( and for k - regular graphs ) Consider the graphs G n ; k(cid:0) out which are of type k - out . Recall that jG n ; k(cid:0) out j (cid:25) n nk : We will consider graphs K k + 1 which are complete in the sense that there are k + 1 nodes , and from each node k out - links are leaving ( to another node of K k + 1 ) . Counting in this case gives k + 1 nodes , k ( k + 1 ) links ( one for each direction ) and 8 (cid:0) k + 1 3 (cid:1) triangles ( the factor 8 accounting for the 8 ways to use the 6 links on each triangle , one back and one forth for each pair of nodes ) . We now distribute the (cid:11)n triangles into 2 C n = (cid:11)n 8 (cid:0) k + 1 3 (cid:1) 2 To simplify the discussion , which is in terms of orders of magnitude , we assume that all quotients are integers . Graphs with a Density of Triangles 16 disjoint complete graphs K k + 1 , and this leaves R n = n (cid:0) ( k + 1 ) (cid:11)n 8 (cid:0) k + 1 3 (cid:1) nodes which will not have been used when making the complete graphs of type K k + 1 . All links originating from the nodes of the clusters are used up in forming the K k + 1 . The number of ways to place the C n complete graphs is (cid:18) n (cid:11)n ( k + 1 ) 8 ( k + 1 3 ) (cid:19) (cid:16) (cid:11)n ( k + 1 ) 8 ( k + 1 3 ) (cid:17) ! ( k + 1 ) ! (cid:11)n = ( 8 ( k + 1 3 ) ) (cid:16) (cid:11)n 8 ( k + 1 3 ) (cid:17) ! (cid:25) n Q n ; ( 5 : 1 ) with Q n = (cid:11)n ( k + 1 ) 8 (cid:0) k + 1 3 (cid:1) (cid:0) (cid:11)n 8 (cid:0) k + 1 3 (cid:1) : The ﬁrst factor in ( 5 . 1 ) counts the number of ways to choose the nodes involved , and the quotient counts the number of ways the ( k + 1 ) C n nodes are grouped into clusters of k + 1 each . Since the graphs use k links per node , the graph we can construct with the remaining R n nodes will be disjoint from the C n clusters , and we want to bound the number of ways in connecting the remaining nodes without adding any triangles . A lower bound on the number of such graphs is obtained by constructing again a k - out bi - partite graph on the remaining R n nodes . The number of ways to place the remaining links is therefore bounded below by (cid:18) R n = 2 k (cid:19) R n (cid:25) n S n ; with S n = k n (cid:0) (cid:11)n ( k + 1 ) 8 (cid:0) k + 1 3 (cid:1) ! : Note that we do not insist on making a connected graph . So we ﬁnd a lower bound of E n n T n , where E depends only on k and T n = Q n + S n = n (cid:18) k (cid:0) 6 (cid:11) 8 ( k + 1 ) k ( k (cid:0) 1 ) (cid:0) k ( k + 1 ) (cid:0) ( k + 1 ) + 1 (cid:1) (cid:19) = n (cid:18) k (cid:0) 3 (cid:11) 4 k ( 1 + 1 k 2 (cid:0) 1 ) (cid:19) = nk (cid:18) 1 (cid:0) 3 (cid:11) 4 ( k 2 (cid:0) 1 ) (cid:19) : ( 5 : 2 ) Remark 5 . 1 : The above calculation proves the lower bound for ( 1 . 2 ) . The lower bound for ( 1 . 3 ) isan easy variant , observingthefact thatinsteadof8 trianglesinacompletegraph on3 nodesinthe k - outmodelthereisonly1inthe k - regularmodel . Acknowledgments . We thank E . Moses four helpful discussions and encouragements . This work was partially supported by the Fonds National Suisse . Graphs with a Density of Triangles 17 References [ AB ] R . Albert and A . - L . Barab´asi : Statistical mechanics of complex networks . Rev . Mod . Phys . 47 , 47 – 97 ( 2002 ) . [ B ] B . Bollobas : Random Graphs , New York , Academic Press ( 1985 ) . [ EM ] J . - P . Eckmann and E . Moses : Curvature of Co - Links Uncovers Hidden Thematic Layers in the World Wide Web . PNAS ( in print ) . [ JLR ] J . Janson , T . Łuczak , and A . Ruci´nski : An exponential bound for the probability of nonexistence of a speciﬁed subgraph in a random graph . In Random Graphs 87 , ( M . Karo´nski et al . eds . ) . Wiley , New York , 73 – 87 ( 1990 ) . [ VV ] H . Vu : On the concentration of multi - variate polynomials with small expectation . Random Structures and Algorithms 16 , 344 – 363 ( 2000 ) .
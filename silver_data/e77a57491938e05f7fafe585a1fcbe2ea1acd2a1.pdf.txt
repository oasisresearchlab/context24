Journal of Mathematical Biology ( 2023 ) 86 : 60 https : / / doi . org / 10 . 1007 / s00285 - 022 - 01861 - w Mathematical Biology Epidemic modeling with heterogeneity and social diffusion Henri Berestycki 1 , 2 · Benoît Desjardins 3 , 4 · Joshua S . Weitz 5 , 6 , 7 · Jean - Marc Oury 4 Received : 30 August 2022 / Revised : 12 December 2022 / Accepted : 13 December 2022 / Published online : 25 March 2023 © The Author ( s ) 2023 Abstract We propose and analyze a family of epidemiological models that extend the clas - sic Susceptible - Infectious - Recovered / Removed ( SIR ) - like framework to account for dynamic heterogeneity in infection risk . The family of models takes the form of a sys - tem of reaction – diffusion equations given populations structured by heterogeneous susceptibility to infection . These models describe the evolution of population - level macroscopic quantities S , I , R as in the classical case coupled with a microscopic variable f , giving the distribution of individual behavior in terms of exposure to contagion in the population of susceptibles . The reaction terms represent the impact of sculpting the distribution of susceptibles by the infection process . The diffusion and drift terms that appear in a Fokker – Planck type equation represent the impact of behavior change both during and in the absence of an epidemic . We ﬁrst study the mathematical foundations of this system of reaction – diffusion equations and prove a number of its properties . In particular , we show that the system will converge back to the unique equilibrium distribution after an epidemic outbreak . We then derive a simpler system by seeking self - similar solutions to the reaction – diffusion equations in the case of Gaussian proﬁles . Notably , these self - similar solutions lead to a sys - tem of ordinary differential equations including classic SIR - like compartments and To the memory of Fred Brauer . B Henri Berestycki Henri . berestycki @ ehess . fr 1 École des hautes études en sciences sociales and CNRS , CAMS , Paris , France 2 Institute for Advanced Study , Hong Kong University of Science and Technology , Sai Kung , Hong Kong 3 ENS Paris - Saclay , CNRS , Centre Borelli , Université Paris - Saclay , 91190 Gif - sur - Yvette , France 4 Geobiomics , 75 Av . des Champs Elysées , 75008 Paris , France 5 School of Biological Sciences , Georgia Institute of Technology , Atlanta , GA , USA 6 School of Physics , Georgia Institute of Technology , Atlanta , GA , USA 7 Institut de Biologie , École Normale Supérieure , Paris , France 123 60 Page 2 of 59 H . Berestycki et al . a new feature : the average risk level in the remaining susceptible population . We show that the simpliﬁed system exhibits a rich dynamical structure during epidemics , including plateaus , shoulders , rebounds and oscillations . Finally , we offer perspectives and caveats on ways that this family of models can help interpret the non - canonical dynamics of emerging infectious diseases , including COVID - 19 . Keywords Epidemiology · COVID - 19 · SIR model · Fokker – Planck equation · Reaction – diffusion system · Non - linear differential system · Heterogeneity · Social diffusion Mathematics Subject Classiﬁcation 92D30 · 35K57 · 35Q92 · 35Q84 · 60J60 · 92C60 1 Introduction 1 . 1 Objectives of this paper In this paper we propose , derive , and study a family of epidemiological models that extend the classic Kermack - McKendrick models of epidemics by structuring popu - lations according to individual - level infection risk . The infection process modulates both the number of individuals in different compartments ( e . g . , susceptibles , infected , or recovered ) as well as the infection risk amongst individuals who remain susceptible . The family of epidemiological models also includes a social diffusion mechanism by which infection risk changes both during and in the absence of epidemics . In doing so , the present work extends a previous model framework ( Berestycki et al . 2021 ) , proposed by a subset of the present author group . This prior article introduced a reaction – diffusion system to model epidemics in populations structured by heteroge - neous infection risk , yielding non - canonical dynamics including plateaus , shoulders , and rebounds . However , this prior article only considered a particular framework with constant diffusion and no drift and did not provide a derivation of the model . Further - more , the prior article did not include restorative mechanisms by which infection risk could stabilize during and after epidemics—as we will show , this feature provides the basis for both generalizations and useful simpliﬁcations in real - world contexts . The scope of the study is as follows . First , in Sect . 2 , we derive a general family of epidemiological models including heterogeneity in dynamic infection risk , extending the model proposed in Berestycki et al . ( 2021 ) . Our initial analysis focuses on the evolution of the distribution of the risk parameter in the susceptible population . For this purpose , we represent the effect of the epidemic as a transport phenomenon that drives down the mean risk parameter through a process we term “sculpting” , consistent with similar proposals in Rose et al . ( 2021 ) . The distribution is also sculpted by a mechanism of social diffusion that we represent as random variation with a reversion drift that are associated to a drift - diffusion stochastic process . This SfIR – model describes the evolution of macroscopic ( or bulk ) quantities : S ( t ) , I ( t ) and R ( t ) , as in the classical framework , coupled with a microscopic description of the probability distribution function of risk behavior in the susceptible population 123 Epidemic modeling with heterogeneity and social diffusion Page 3 of 59 60 that we denote f ( t , a ) , where a is a risk factor variable . We are thus led to a system coupling SIR dynamics with a Fokker – Planck equation for the distribution f . The SfIR – model admits a unique equilibrium distribution of risk in the absence of an epidemic . Our analysis begins by showing in Sect . 3 that the risk distribution will con - verge from an arbitrary initial distribution to this unique equilibrium distribution after the passage of an epidemic ( Sect . 3 ) . This section focuses on mathematical features of convergence , both in a general case and in the case of Gaussian proﬁles . The key take - away from an epidemiological perspective is that there is a unique equilibrium for the distribution f associated with ﬁxed points in which the disease is not circu - lating , i . e . , I ∗ = 0 . This unique equilibrium distribution is structured by parameters of social diffusion—balancing dynamic variations in infection risk with a tendency for individuals to reduce their infection risk subject to a minimum constraint . Pre - cisely because the PDE model involves several parameters it is desirable to identify a reduced number of governing parameters to aid analysis and to apply model insights to real - world outbreaks . Hence , we look for parsimonious versions of the family of models that still retain key dynamical features of the full PDE model . In Sect . 4 , we derive such a parsimonious ODE system by assuming a Gaussian ini - tial distribution of infection risk in the population . The number of free parameters in the ODE system is then considerably reduced with respect to the PDE model . This model reduction is achieved by looking for self - similar solutions of the system . The resulting ODE system includes the fraction of individuals in different disease compartments as in classical models ( e . g . , susceptibles , infectious , and recovered / removed ) , while augmenting these models with a state variable that represents the mean infection risk of individuals who remain susceptible ( similar to an approach in the absence of social diffusion shown in Rose et al . 2021 ) . In this way , the ODE system includes a statistical property of the complete distribution modeled in the PDE system . We show in Sect . 4 . 4 that this ODE system gives rise to a rich variety of dynamical behaviors . Remarkably , while much simpler , the ODE system exhibits hallmark qualitative features of dynam - ical complexity as found in the full PDE model—including plateaus , shoulders , and oscillations . We also prove some key mathematical properties of this reduced system . In Sect . 6 we further derive higher order models to account for more general initial distributions beyond the Gaussian lol . This is achieved by using a spectral method with the eigenfunctions of the harmonic oscillator for a better approximation of the PDE system . As we show , the SfIR model generates non - canonical features of epidemic dynam - ics as a direct result of incorporating changes in susceptibility that take place on the time scale of disease spread . In future work we plan to study extensions of the model developed here to include the dynamics of multiple variants , spatial propagation , feed - back between awareness and behavior change , and to improve model - data integration through connections with surveillance data including wastewater - based epidemiology . 1 . 2 Background SIR and related epidemic models categorize individuals in a population according to their disease status , e . g . , susceptible , infectious , and recovered / removed . There is a 123 60 Page 4 of 59 H . Berestycki et al . long history of expanding such models to incorporate population - level heterogeneity in the risk of infection , transmission , and / or outcome , e . g . , by further differentiat - ing individuals based on age , job type , race , gender , and / or socioeconomic status , etc . ( Auchincloss and Diez Roux 2008 ; Stroud et al . 2007 ; Ibuka 2016 ; Leung 2017 ; Zhang 2020 ; Brauer 2005 ; Prem et al . 2017 ) . Extensions to SIR models that include such heterogeneity assume that relevant epidemic parameters and interactions vary across categories ( e . g . , between ages as in Prem et al . 2021 ) . The SARS - CoV - 2 pan - demic has accelerated a diversiﬁcation of modeling approaches to examine the basis for and consequences of heterogeneity for the emergence of an outbreak , the speed of population - level spread and the size and severity of the outbreak at the population - scale . A key motivating factor was the early observation of plateaus and shoulders in SARS - CoV - 2 case data—shapes that are seemingly incompatible with classic pre - dictions of SIR - like models in which qualitative changes in dynamics are driven by susceptible depletion ( Weitz et al . 2020a ) . As a result , multiple categories of models have been proposed to reconcile apparent slowdowns in spread , plateaus , shoulders , and oscillations in epidemic dynamics . In doing so , we distinguish three main classes of approaches : ( i ) bottom - up structured epidemic models ; ( ii ) top - down behavioral models ; ( iii ) mesoscopic models . Structured epidemic models differentiate individual characteristics , including inter - actions and behavior , allowing for the inclusion of impacts on transmission from different types of interventions ( e . g . , school closing , case isolation , physical distanc - ing ) ( Ferguson et al . 2020 ; Di Domenico et al . 2020 ) . In the absence of interventions , structured epidemic models are expected to exhibit a single epidemic peak followed by a susceptible decline and elimination , whereas interventions can lead to delays , oscillations , rebounds , and / or asymmetric peaks . Even in the absence of interven - tions , classic outcomes predicted from SIR models can change when populations are structured . A key early example along these lines extended SIR - like models to account for the impacts of age - and activity - structure on the size of the ongoing SARS - CoV - 2 outbreak ( Britton et al . 2020 ) . Numerical simulations revealed that herd immunity thresholds and ﬁnal sizes of simulated outbreaks were smaller than that expected from classical theory when accounting for age - dependent mixing and activity differences . Other papers used more detailed features of social contacts such as social distance , indoor / outdoor environment , and the cumulative duration of contacts ( Béraud et al . 2015 ) . Likewise , a series of previous works described population heterogeneity in terms a ﬁnite number of transmission rate coefﬁcients in the contact matrix in a SIR or SEIR modeling framework . ( See for instance Arino et al . 2005 ; Dolbeault and Turinici 2021 , 2020 ; Magal et al . 2018 . ) In all of these cases , non - homogeneous interactions in a structured population leads , in effect , to changes in transmission rates relative to those in homogeneous populations . In contrast , top - down behavioral models neglect individual differences ; instead rel - evant epidemic parameters change over time as a result of time - dependent rates or explicit feedback between spread , awareness , and behavior change . The merits and limits of these contrasting approaches to epidemic modeling are listed in Sukumar and Nutaro ( 2012 ) . For example , in epidemic models with awareness - based feedback increasing fatalities leads to a decrease in interactions that correspondingly decreases transmission ( Weitz et al . 2020a ) . In effect , the transmission rate β is directly mod - 123 Epidemic modeling with heterogeneity and social diffusion Page 5 of 59 60 ulated by the number of cumulative ( or daily ) deaths . Depending on the degree of awareness , this model class can yield plateaus , “shoulder” like patterns and oscillations for the dynamics of infectious individuals—initial peaks are unrelated to susceptible depletion . Whether or not a population experiences , oscillations , a single peak , or sustained plateau in new infections may depend on the extent to which individuals become fatigued or substitute actions ( e . g . , mask - wearing or increasing ventilation ) even as mobility increases . Similarly , other models have assumed that individuals face a behavioral trade - off described as a mathematical utility function ( Arthur et al . 2021 ) . In the absence of an epidemic , people try to improve their utility though social interactions—working , attending school , or socializing—so as to reach an ideal level of social contact . In the presence of an epidemic , interactions becomes risky . People then cut back their contacts to a level that balances the beneﬁt of interactions with costs associated with catching the disease . The model is expressed as a SIS system where the transmission rate depends on the optimal contact rate . In this framework , there is a theoretical endemic equilibrium , which means that multiple ﬂuctuation waves are possible for a long time around equilibrium values . Finally , mesoscopic models represent an effort to bridge the gap between bottom - up agent - based modeling and top - down imposition of behavioral feedback in an otherwise homogeneous population . Mesoscopic models structure populations via an explicit representation of a distribution of traits that play a role in the infection process . Thus , these mesoscopic models are of an intermediate type in terms of complexity and dimensionality relative to the bottom - up and top - down modeling frameworks . For example , in Rose et al . ( 2021 ) , the authors incorporate population - level het - erogeneity in infection susceptibility . They show that behavioral variation strongly inﬂuences the rate of infection , while the infection process simultaneously sculpts the susceptibility distribution . In doing so , they show how the sculpting process can drive distributions towards a characteristic stable shape ( e . g . , gamma - type susceptibility distributions ) . Precisely because individuals with greater susceptibility are infected earlier , the remaining population tends to be less susceptible than initially . As a result , the epidemic slows down , leading naturally to power - law behavior in the strength of infection , where the power - law like behavior is generic while the power - law expo - nent depends on the shape of the heterogeneous distribution . This work suggests that ﬁrst - order epidemic models that are parameterized in the exponential - like phase may systematically over - estimate the ﬁnal size and severity of the epidemic , similar to ﬁndings by Brauer ( 2011 , 2019 ) and by Eksin et al . ( 2019 ) . However , because indi - viduals do not change their behavior , the model in Rose et al . ( 2021 ) does not generate oscillations or long - term plateaus . ( See Tkachenko et al . 2021 for an effort to link dynamical heterogeneity to the ﬁnding of plateaus and multiple waves . ) There are multiple other examples—including Almeida et al . ( 2021 ) who intro - duced social diffusion together with behavior heterogeneity as a multidimensional risk variable x in a SIR - type framework . In this model , social diffusion appears as a linear diffusion of susceptible and infected populations ( or only infected populations ) in terms of x . Such models follow the kinetic modeling approach where the SIR ( or SEIR ) dynamics are coupled with Boltzmann or Fokker – Planck type equations and local equilibria being expressed as gamma - type distributions . 123 60 Page 6 of 59 H . Berestycki et al . One may view the present work in the spirit of mesoscopic models . As such , we provide here a comprehensive and consistent derivation of a family of epidemiological models of reduced complexity encompassing both individual level risk heterogeneity and variability of individual behaviors ( rather than variability in aggregate behaviors of the population as a whole ) . We term this a SfIR family of models . Such models describe the evolution of the distribution of population level quantities ( S , I , and R ) and the dynamics of a microscopic distribution f that captures variability in susceptibility to infection at the individual scale . 2 The epidemiological model with heterogeneous and variable behaviors 2 . 1 Stochastic framework The model we introduced in Berestycki et al . ( 2021 ) involves a risk trait variable a ∈ ( 0 , 1 ) . More generally , here we will assume that a varies either in A = R + or in A = ( 0 , 1 ) . This parameter structures the population of susceptibles S so that S = S ( t , a ) . We can think of a as a lumped variable characterizing the relative vulnerability of individuals to infection . Low levels of a are associated with cautious behaviors while high values correspond to increasing risk of infection . Here , cautious behaviorinvolvesboththenumberofcontactsandtheprobabilityofinfectioninagivencontact . However , in our approach , we do not explicitly include the effect of cautious individuals reducing contacts with others , perceived as more at risk . This effect of preferential mixing , described in the work of Feng ( 2014 ) , which also appears in the work of Weitz et al . ( 2020b ) , would lead to a different term for the force of infection . The lumped variable a inﬂuences both the transmission rate factor proﬁle a (cid:4)→ β ( a ) and the initial distribution of susceptible individuals : a (cid:4)→ S 0 ( a ) = S ( 0 , a ) . The effect of a is to yield high levels of transmission rates β ( a ) for high values of a and small ones when a is small . Thus we always assume that β ( a ) is increasing with a . Because behaviors ﬂuctuate in time , it is natural to consider a as a random variable . Our purpose in this section is to provide a detailed derivation of the generalized SIR system in the framework of a population structured by the variable a . The dynamics of the distribution of the variable a in the susceptible population results from two joint effects . First , by the very nature of the risk factor , individuals with high a become infected at a higher rate than those with a low level of a . Thus , the epidemics has a dynamic effect on the probability distribution of a . Second , owing to the stochas - tic nature of the parameter a , it is subject to its own stochastic evolution which we describe below by the stochastic differential equation ( 9 ) . Thus , our generalized model describes the coupled evolution of behavior and epidemic dynamics . 123 Epidemic modeling with heterogeneity and social diffusion Page 7 of 59 60 2 . 2 Dynamics of risk parameter a induced by heterogeneity : transport equation and Lagrangian viewpoint We ﬁrst derive the purely epidemic evolution of a . It can be considered as deterministic , in the framework of heterogeneous population with respect to disease transmission rate a (cid:4)→ β ( a ) . In particular we aim at determining the corresponding transport equation for the sculpting of the distribution of susceptibles . In an heterogeneous population , stratiﬁed by the risk parameter a ∈ A , ( where A denotes either ( 0 , 1 ) or R + ) , the purely epidemic depletion of S ( t , a ) is given by the ﬁrst equation of the SIR model : ∂ S ( t , a ) ∂ t = − I ( t ) N β ( a ) S ( t , a ) . ( 1 ) Here , we only consider the stratiﬁcation of the population of susceptibles . As was already mentioned in Berestycki et al . ( 2021 ) , one can also envision a situation in which the population of infected is structured by a parameter b and write I = I ( t , b ) . We leave this for further studies . We introduce the probability density or distribution f ( t , a ) of the population of susceptibles as a function of the level a at time t . That is , we write : f ( t , a ) : = S ( t , a ) S ( t ) , where S ( t ) : = (cid:2) A S ( t , a ) da . Thus , S ( t ) denotes the total susceptible population at time t . From the heterogeneous SIR equation ( 1 ) above , we get dS ( t ) dt = − I ( t ) S ( t ) N (cid:2) A β ( a ) f ( t , a ) da , ( 2 ) and ∂ f ( t , a ) ∂ t = − I ( t ) N f ( t , a ) (cid:3) β ( a ) − (cid:2) A β ( b ) f ( t , b ) db (cid:4) . ( 3 ) The meaning of ( 3 ) is clear . The effect of the epidemic is to deplete the fraction of population with high a and to increase the fraction of population a whose β = β ( a ) is below the average β in the population . Let F denote the cumulative distribution function , that is F ( t , a ) = (cid:2) a 0 f ( t , b ) db . Integrating the right hand side of Eq . ( 3 ) with respect to a yields : ∂ f ∂ t = − ∂ ∂ a (cid:5) μ ep f (cid:6) , ( 4 ) 123 60 Page 8 of 59 H . Berestycki et al . where μ ep ( t , a ) = I ( t ) N (cid:2) a 0 β ( b ) f ( t , b ) db − F ( t , a ) (cid:2) A β ( b ) f ( t , b ) db f ( t , a ) , ( 5 ) so that denoting β ( t ) the average transmission rate at time t , one has μ ep ( t , a ) = I ( t ) N (cid:2) a 0 (cid:5) β ( b ) − β ( t ) (cid:6) f ( t , b ) db f ( t , a ) . ( 6 ) Equation ( 4 ) is a transport equation . It describes how the distribution of population S ( t , a ) reorganizes itself under the effect of the epidemics . Note that in the neighbor - hood of a = 0 , one has μ ep ( t , a ) ∼ a ( β ( 0 ) − β ( t ) ) I ( t ) / N . Then , to represent the solutions of the transport Eq . ( 4 ) , we use the method of characteristics . To this end , we introduce the associated Lagrangian ﬂow ( t , α ) (cid:4)→ a ( t , α ) that follows the dynamics ∂ a ( t , α ) ∂ t = μ ep ( t , a ( t , α ) ) , with a ( 0 , α ) = α . ( 7 ) As a matter of fact , one has d dt [ f ( t , a ( t , α ) ) ∂ α a ( t , α ) ] = ∂ α a ( t , α ) (cid:3) ∂ f ∂ t + μ ep ∂ f ∂ a + f ∂μ ep ∂ a (cid:4) ( t , a ( t , α ) ) = 0 . Hence , introducing the initial probability distribution f 0 and denoting a − 1 ( t , · ) the inverse of a ( t , · ) for all given t > 0 , one gets f ( t , α ) = ∂ α a − 1 ( t , α ) f 0 ( a − 1 ( t , α ) ) . This means that the probability measure of susceptibles P ( t ) ( associated with the density f ( t , · ) ) at time t is the pushforward of the initial probability measure P 0 by the ﬂow a ( t , · ) : P ( t ) = a ( t , · ) (cid:5) P 0 , That is , for all G ⊂ A , the measure of G at time t is deduced from the measure of the image of G by the inverse of the ﬂow a − 1 ( t , · ) : P ( t ) ( G ) = P 0 (cid:7) a − 1 ( t , G ) (cid:8) . 123 Epidemic modeling with heterogeneity and social diffusion Page 9 of 59 60 Remarks Let us ﬁrst observe that the right hand side μ ep of ( 7 ) is always non - positive as soon as β is a non - decreasing function of a . In fact , one has (cid:2) a 0 β ( b ) f ( t , b ) db − F ( t , a ) (cid:2) A β ( b ) f ( t , b ) db = (cid:2) A \ ( 0 , a ) dc (cid:2) a 0 db f ( t , b ) f ( t , c ) ( β ( b ) − β ( c ) ) ≤ 0 , where A \ ( 0 , a ) denotes ( a , 1 ) ( resp . ( a , + ∞ ) ) when A = ( 0 , 1 ) ( resp . A = ( 0 , + ∞ ) ) . This means that the risk a decreases along the Lagrangian characteristic curves gov - erned by ( 7 ) . Another useful observation is that the right hand side μ ep ( t , a ) of ( 7 ) vanishes for a ∈ ∂ A , i . e . for a = 0 and for a = 1 ( resp . a → + ∞ ) in the case A = ( 0 , 1 ) ( resp . A = ( 0 , + ∞ ) ) . As in the SIR model , using the dynamics of R compartment ( d R / dt = γ I ) , we deduce that the Lagrangian paths associated with ( 5 ) can be naturally expressed in terms of R instead of t : da d R = (cid:2) a 0 β ( b ) f ( R , b ) db − F ( R , a ) (cid:2) A β ( b ) f ( R , b ) db γ N f ( R , a ) . ( 8 ) In the case of homogeneous transmission rate β ( a ) ≡ β , the epidemic drift vanishes μ ep ( t , a ) ≡ 0 : epidemics do not create heterogeneity if there is none initially . Let us ﬁnally give a computable example of non - zero epidemic drift . Starting from the exponential distribution f 0 ( a ) = exp ( − a ) over A = ( 0 , + ∞ ) , β ( a ) = β 1 a for some positive constant β 1 , one gets : f ( R , a ) = f 0 ( a ) exp (cid:3) − β 1 aR γ (cid:4) (cid:9) + ∞ 0 f 0 ( b ) exp (cid:3) − β 1 bR γ N (cid:4) db , f ( R , a ) = (cid:3) 1 + β 1 R γ N (cid:4) exp (cid:3) − a (cid:3) 1 + β 1 R γ N (cid:4)(cid:4) , so that the dynamical system ( 8 ) becomes da d R = − β 1 a γ N (cid:3) 1 + β 1 R γ N (cid:4) , 123 60 Page 10 of 59 H . Berestycki et al . i . e . a ( R ) = a ( 0 ) 1 + β 1 R γ N . This example illustrates the aforementioned monotonicity of t (cid:4)→ a ( t ) : in this case , traits decrease with the same rate regardless of their initial value . Then , since μ ep ( t , a ) = − β 1 γ I ( t ) γ N + β 1 R ( t ) a , the transport equation satisﬁed by the distribution f ( t , a ) rewrites as ∂ f ( t , a ) ∂ t = ∂ ∂ a (cid:3) β 1 γ I ( t ) af ( t , a ) γ N + β 1 R ( t ) (cid:4) . 2 . 3 Derivation of the model In order to account for random ﬂuctuations of the distribution of the variable a , we consider that it is governed by a stochastic process that we write as a t . We will assume that , in the absence of epidemics , its distribution results from the following stochastic differential equation or Itô drift diffusion process : da t = μ b ( t , a t ) dt + σ ( t , a t ) dW t , ( 9 ) where W t is a standard Wiener process , σ ( t , a ) > 0 , and μ b ( t , a ) represents back - ground volatility and drift coefﬁcients . This equation corresponds to a Lagrangian point of view and is the stochastic analogue of the deterministic part ( 7 ) . We impose reﬂecting boundary conditions at the endpoints of the interval A , i . e . at a ∈ { 0 , 1 } when A = ( 0 , 1 ) or at a = 0 when A = ( 0 , ∞ ) . Let us now consider a population stratiﬁed by the variable a subject to the combined effect of two effects : the stochastic differential equation ( SDE ) ( 9 ) on one hand and depletion caused by the epidemics driven by transport equation ( 4 ) ( or equivalently ) by the ordinary differential equation ( ODE ) ( 7 ) on the other hand . We assume that the superposition principle applies to these two effects . Then , under this joint effect , the evolution of a includes a drift or transport term with coefﬁcient μ ep + μ b , whereas the stochastic part remains the same . Thus , the random process is given by the following SDE : da t = (cid:5) μ ep + μ b (cid:6) dt + σ dW t . where : 123 Epidemic modeling with heterogeneity and social diffusion Page 11 of 59 60 • μ b is an additional drift and the diffusion σ ≥ 0 both possibly depending on t and a . The two variables μ b and σ need to comply with boundary conditions : μ b − 1 2 ∂σ 2 ∂ a = 0 on R + × ∂ A . • W t is a Wiener process with reﬂecting boundary conditions . Then , the dynamics of the associated probability density f ( t , a ) is given by the fol - lowing Fokker – Planck equation ( or forward Kolmogorov equation ) : ∂ f ∂ t = − ∂ ∂ a (cid:5) ( μ ep + μ b ) f (cid:6) + ∂ 2 ∂ a (cid:3) σ 2 2 f (cid:4) in R + × A . For the sake of completeness , we sketch the proof . This will allow us to derive the boundary condition . Let a (cid:4)→ φ ( a ) be a smooth function over A . Then Itô’s formula leads to : d φ ( a t ) = (cid:3)(cid:5) μ ep + μ b (cid:6) ∂φ ∂ a + σ 2 2 ∂ 2 φ ∂ a 2 (cid:4) dt + ∂φ ∂ a σ dW t . ( 10 ) Then , taking the time derivative of the expectation of φ ( t , a ) yields on the one hand d dt E [ φ ( a t ) ] = d dt (cid:2) A φ ( a ) f ( t , a ) da = (cid:2) A φ ∂ f ∂ t da , and on the other hand from ( 10 ) d dt E [ φ ( a t ) ] = E [ d φ ( a t ) ] dt = E (cid:10)(cid:5) μ ep + μ b (cid:6) ∂φ ∂ a + σ 2 2 ∂ 2 φ ∂ a 2 (cid:11) , = (cid:2) A f (cid:3)(cid:5) μ ep + μ b (cid:6) ∂φ ∂ a + σ 2 2 ∂ 2 φ ∂ a 2 (cid:4) da . Hence , one has for all smooth enough φ (cid:2) A φ ∂ f ∂ t da = (cid:2) A f (cid:3)(cid:5) μ ep + μ b (cid:6) ∂φ ∂ a + σ 2 2 ∂ 2 φ ∂ a 2 (cid:4) da , so that integrating by parts the right hand side of the above equation leads to (cid:2) A φ ∂ f ∂ t da = − (cid:2) A φ ∂ ∂ a (cid:5)(cid:5) μ ep + μ b (cid:6) f (cid:6) da − (cid:2) A ∂φ ∂ a ∂ ∂ a (cid:3) σ 2 2 f (cid:4) da + (cid:10)(cid:5) μ b + μ ep (cid:6) φ f + σ 2 2 f ∂φ ∂ a (cid:11) 1 or + ∞ 0 , = (cid:2) A (cid:3) − φ ∂ ∂ a (cid:5)(cid:5) μ ep + μ b (cid:6) f (cid:6) + φ ∂ 2 ∂ a (cid:3) σ 2 2 f (cid:4)(cid:4) da 123 60 Page 12 of 59 H . Berestycki et al . + (cid:10)(cid:5) μ b + μ ep (cid:6) φ f + σ 2 2 f ∂φ ∂ a − φ f ∂ ∂ a (cid:3) σ 2 2 (cid:4) − φ σ 2 2 ∂ f ∂ a (cid:11) 1 or + ∞ 0 . Taking test functions φ compactly supported in A , one therefore gets the dynamics of the probability density ( t , a ) (cid:4)→ f ( t , a ) of risk parameter a ∂ f ∂ t = − ∂ ∂ a (cid:5) ( μ ep + μ b ) f (cid:6) + ∂ 2 ∂ a (cid:3) σ 2 2 f (cid:4) in R + × A . Given the above assumptions on μ and σ on the boundary ∂ A , the following boundary conditions lead to a consistent weak formulation ∂ f ( t , a ) ∂ a = 0 on R + × ∂ A . In other words , one has ∂ f ( t , a ) ∂ t = − I ( t ) N (cid:3) β ( a ) f ( t , a ) − f ( t , a ) (cid:2) A β ( b ) f ( t , b ) db (cid:4) − ∂ ∂ a ( μ b f ) + ∂ 2 ∂ a (cid:3) σ 2 2 f (cid:4) . Using ( 2 ) , which is unchanged ( the effect of random variations reshufﬂe a in a con - servative way ) , we deduce that S ( t , a ) = S ( t ) f ( t , a ) satisﬁes ∂ S ( t , a ) ∂ t = S ( t ) ∂ f ( t , a ) ∂ t − f ( t , a ) I ( t ) S ( t ) N (cid:2) A β ( a ) f ( t , a ) da , = − I ( t ) β ( a ) S ( t , a ) N − ∂ ∂ a ( μ b ( t , a ) S ( t , a ) ) + ∂ 2 ∂ a (cid:3) σ 2 ( t , a ) 2 S ( t , a ) (cid:4) . On the other hand , the dynamics of the total infected is not modiﬁed by random ﬂuctuations of a : dI ( t ) dt = I ( t ) (cid:3) 1 N (cid:2) A β ( a ) S ( t , a ) da − γ (cid:4) . We conclude by the expression of the full PDE system of epidemiology with hetero - geneous and variable behaviors : ⎧ ⎪⎪ ⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎩ ∂ S ∂ t = − β I S N − ∂ ( μ b S ) ∂ a + 1 2 ∂ 2 ( σ 2 S ) ∂ a 2 dI dt = I (cid:3) 1 N (cid:2) A β S da − γ (cid:4) d R dt = γ I ( 11 ) 123 Epidemic modeling with heterogeneity and social diffusion Page 13 of 59 60 supplemented with boundary conditions ∂ S ∂ a = 0 on R + × ∂ A , where μ and σ are given functions satisfying the boundary conditions μ b − 1 2 ∂σ 2 ∂ a = 0 on R + × ∂ A . We recover in particular the model we studied in our earlier work ( Berestycki et al . 2021 ) from the case μ b ≡ 0 and σ constant . Note that we mentioned there the more general form of the equation when σ = σ ( a ) depends on the risk trait a but we did not explain precisely how to derive it . 2 . 4 General SfIR epidemiologic model To summarize , we rewrite the general system describing the dynamics of S , I and f variables ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪ ⎩ dS dt = − β SI N , dI dt = I (cid:16) β S N − γ (cid:17) , β ( t ) = (cid:2) A β ( a ) f ( t , a ) da , ∂ f ( t , a ) ∂ t = − (cid:5) β ( a ) − β ( t ) (cid:6) f ( t , a ) I ( t ) N − ∂ ( μ b ( t , a ) f ( t , a ) ) ∂ a + ∂ 2 ∂ a 2 (cid:3) σ 2 ( t , a ) f ( t , a ) 2 (cid:4) , ∂ f ( t , a ) ∂ a = 0 for ( t , a ) ∈ R + × ∂ A , (cid:2) A f ( t , a ) da = 1 for t ∈ R + . ( 12 ) The model parameters are assumed to satisfy ⎧⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎩ γ > 0 , S ( 0 ) > 0 , I ( 0 ) > 0 such that S ( 0 ) + I ( 0 ) ≤ N , β ( a ) ≥ 0 , σ ( t , a ) ≥ 0 in R + × A . μ b ( t , a ) − 1 2 ∂σ 2 ( t , a ) ∂ a = 0 over R + × ∂ A . ( 13 ) In spite of its simple appearance , the evolution equation for f in ( 12 ) is rather involved . In fact , this equation is non - linear , not only because of the term f I ( as in the quadratic term in the SIR model ) , but also owing to the term β f since β is linear in f . Note also that because of this term , the equation is non - local . 123 60 Page 14 of 59 H . Berestycki et al . 3 Convergence to equilibrium There is a vast literature related to the convergence to equilibrium of solutions to the Fokker – Planck equations in the whole space R d , d ≥ 1 starting with the seminal results of Bakry and Émery ( 1985 ) . We refer the reader to Markowich and Villani ( 1999 ) for a survey as well as to the book of Bakry et al . ( 2014 ) . These works about convergence to equilibrium chieﬂy rely on a so - called “hyper - contractivity” condition of D . Bakry and M . Emery . We describe below this condition on the coefﬁcients . In vague terms , it guarantees the existence of a “spectral gap” for the Fokker – Planck operator , which is shown to yield exponential convergence to equilibrium distribution in L 1 . A key quantity is the “relative entropy” E involving the probability distribution f and the equilibrium distribution that we also describe here . Then , one shows that E is bounded by its dissipation rate by using the logarithmic Sobolev inequality that we state below . In Sect . 3 . 1 , we establish the convergence to equilibrium of the distribution f ( t , · ) solution of the coupled SfIR system ( 12 ) under general assumptions on the coefﬁcients and initial data . Among these , we assume a hyper - contractivity condition which is sufﬁcient for a logarithmic Sobolev inequality to hold . Actually , we might have con - sidered alternative hyper - contractivity conditions involving the Ricci curvature of the Riemannian structure underlying the Fokker – Planck operator as in Arnold et al . ( 2001 ) without epidemic coupling . We leave this for future work . Then , in Sect . 3 . 2 , we consider a more speciﬁc framework for the coefﬁcients β , μ b and D in which the equilibrium distribution is of Gaussian type . It allows for much simpler proofs , making the argument more transparent . Furthermore , it allows one to derive stronger results such as the convergence of the average transmission rate β ( t ) . Besides these advantages , this Gaussian framework has interesting mathematical properties such as the existence of exact self - similar solutions . Searching for such self - similar solutions leads to low complexity system of ordinary differential equations ( ODEs ) instead of the PDE system ( 12 ) . We develop this point of view in Sect . 4 at ﬁrst order and then extend it to higher order approximations in Sect . 6 . 1 using spectral decomposition of the distribution f . 3 . 1 The general case with time - independent coefficients From now on , we assume that A = R + and we consider the SfIR system ( 12 ) in the case when the drift and diffusion coefﬁcients , μ b and D = σ 2 / 2 , do not depend on time . We consider here solutions S , f , I and R of ( 12 ) with the following assumptions on the model coefﬁcients ⎧⎪⎨ ⎪⎩ γ > 0 , β ( a ) ≥ 0 , D ( a ) ≥ 0 for a ∈ R + , μ b ( 0 ) − D (cid:12) ( 0 ) = 0 . 123 Epidemic modeling with heterogeneity and social diffusion Page 15 of 59 60 After the epidemic has peaked , one expects that the number of infected individuals I ( t ) will go to zero and that the probability density f ( t , · ) will converge to the equi - librium distribution . This distribution denoted f ∞ is the unique stationary solution of System ( 12 ) in the absence of epidemic . It satisﬁes : ⎧⎪⎪⎨ ⎪⎪⎩ d da (cid:3) μ b ( a ) f ∞ ( a ) − d da ( D ( a ) f ∞ ( a ) ) (cid:4) = 0 in R + , f (cid:12)∞ ( 0 ) = 0 and (cid:2) R + f ∞ ( a ) da = 1 . ( 14 ) Let us introduce a (cid:4)→ α ( a ) deﬁned up to an additive constant by α (cid:12) ( a ) = D (cid:12) ( a ) − μ b ( a ) D ( a ) . We assume that a (cid:4)→ exp ( − α ( a ) ) is integrable over R + and we set the constant in such a way that (cid:2) + ∞ 0 exp ( − α ( a ) ) da = 1 . Then , we deduce from ( 14 ) that f ∞ ( a ) = exp ( − α ( a ) ) . Associated to this equilibrium probability density , we deﬁne the measure ν by d ν ( a ) = f ∞ ( a ) da and related L p functional spaces L p (cid:5) R + ; ν (cid:6) = (cid:18) g ; (cid:2) R + | g ( a ) | p d ν ( a ) < + ∞ (cid:19) , p ∈ [ 1 , + ∞ ) . We now state some assumptions on the coefﬁcients β , μ b and D that we shall use later on to study the convergence to equilibrium . The ﬁrst one requires that the average initial and asymptotic transmission rates are ﬁnite : ( H 1 ) β ( 0 ) = (cid:2) R + β ( a ) f ( 0 , a ) da < + ∞ and β ∞ = (cid:2) R + β ( a ) f ∞ ( a ) da < + ∞ . Next , we assume that the diffusion coefﬁcient is non - degenerate , that is : ( H 2 ) There exists D ∗ > 0 such that D ( a ) ≥ D ∗ for all a ∈ R + . In order to keep the average transmission rate bounded over time , we also require the following technical assumption : there exist positive constants C 1 and C 2 such that ( H 3 ) β (cid:12) ( 0 ) ≥ 0 , D ( a ) β (cid:12)(cid:12) ( a ) + μ b ( a ) β (cid:12) ( a ) ≤ C 1 − C 2 β ( a ) for all a ∈ R + . 123 60 Page 16 of 59 H . Berestycki et al . We will see that it is veriﬁed in the case we discuss in the next subsection . Finally , the following Assumption ( H 4 ) is the Bakry – Emery hyper - contractivity condition ( Bakry and Émery 1985 ; Bakry et al . 2014 ; Bakry 1994 ; Arnold et al . 2001 ; Courtade and Fathi 2020 ) which allows one to control the convergence rate to equilibrium of solutions of the Fokker – Planck equations in the absence of epidemic . It simply writes in terms of a (cid:4)→ α ( a ) as : ( H 4 ) α (cid:12)(cid:12) ( a ) ≥ λ 1 , for all a ∈ R + for some λ 1 > 0 . Equivalently , we formulate ( H 4 ) in terms of the D and μ b parameters as follows for all a ∈ R + : ( H 4 ) D (cid:12)(cid:12) ( a ) D ( a ) − D (cid:12) ( a ) 2 D ( a ) 2 + μ b ( a ) D (cid:12) ( a ) D ( a ) 2 − μ (cid:12) b ( a ) D ( a ) ≥ λ 1 > 0 . A classical result stated in Bakry et al . ( 2014 ) , Courtade and Fathi ( 2020 ) is the following Sobolev type estimate : Theorem 1 ( Bakry – Emery ) Let a (cid:4)→ α ( a ) be a twice differentiable function over R such that for some λ 1 > 0 , α (cid:12)(cid:12) ( a ) ≥ λ 1 > 0 for all a ∈ R , and f ∞ = exp ( − α ) is a probability measure over R . Then , deﬁning the measure ν by d ν ( a ) = f ∞ ( a ) da , for all g ∈ L 2 ( R ; ν ) such that g (cid:12) = dg / da ∈ L 2 ( R ; ν ) , there holds : (cid:2) R g 2 log g 2 d ν − (cid:3)(cid:2) R g 2 d ν (cid:4) log (cid:3)(cid:2) R g 2 d ν (cid:4) ≤ 2 λ 1 (cid:2) R | g (cid:12) | 2 d ν , ( 15 ) As a consequence , for the probability density distributions f over R + , we obtain the following Logarithmic Sobolev inequality : (cid:2) R + f ( a ) ψ ( a ) da ≤ 1 2 λ 1 (cid:2) R + f ( a ) (cid:20)(cid:20)(cid:20)(cid:20) d ψ ( a ) da (cid:20)(cid:20)(cid:20)(cid:20) 2 da , where ψ = log f f ∞ . ( 16 ) This inequality is easily derived from ( 15 ) by extending f / 2 and f ∞ / 2 as even func - tions on the whole real line , and considering g = √ f / f ∞ . It holds true as long as g (cid:12) ∈ L 2 ( R + ; ν ) . The left hand side of ( 16 ) is called the relative entropy 1 . This inequality allows one to estimate this entropy by what turns out to be its dissipation rate through the dynamics of Fokker – Planck equations in the right hand side . On the one hand , in the classical Fokker – Planck equation case , that is , in the absence of coupling with epidemic model , this Logarithmic Sobolev inequality leads to a convergence of f ( t , · ) to f ∞ in L 1 ( R + ) norm at speed exp ( − λ 1 t ) ( see Bakry and Émery 1985 ; Bakry 1994 ; Bakry et al . 2014 ) . On the other hand , in the classical SIR model , in the absence of social diffusion , the quantities S ( t ) , I ( t ) also converge exponentially to their limits as t → ∞ . 1 It is often denoted E ( f | f ∞ ) . 123 Epidemic modeling with heterogeneity and social diffusion Page 17 of 59 60 Here , the novelty lies in the coupling of the Fokker – Planck equation with the epi - demiological system which is not covered by previous results . Still , we are able to prove the following result . Theorem 2 Under Assumptions ( H1 ) ( H2 ) ( H3 ) ( H4 ) , I ( t ) converges to 0 , S ( t ) con - verges to S ∞ and f ( t , · ) converges to f ∞ in L 1 ( R + ) as time t goes to + ∞ for some S ∞ such that 0 ≤ S ∞ < S ( 0 ) . More precisely , assuming that f 0 log ( f 0 / f ∞ ) ∈ L 1 ( R + ) , there exists C ∗ > 0 such that for all t > 0 (cid:3) (cid:2) R + | f ( t , a ) − f ∞ ( a ) | da (cid:4) 2 ≤ C ∗ (cid:2) t 0 I ( s ) N exp ( η ( s − t ) ) ds + 2 exp ( − η t ) (cid:2) R + f 0 ( a ) log f 0 ( a ) f ∞ ( a ) da , ( 17 ) where η = 2 D ∗ λ 1 . Letusexplainwhy ( 17 ) leadstotheconvergencein L 1 ( R + ) of f ( t , · ) to f ∞ as t goes to + ∞ . As we shall see in the ﬁrst step of the proof of Theorem 2 , the convergence of S ( t ) ( resp . I ( t ) ) to S ∞ ∈ [ 0 , S ( 0 ) ) ( resp . 0 ) followsfromstraightforwardmonotonicity arguments . Then , given T > 0 and splitting the integral over ( 0 , t ) in the right hand side of ( 17 ) into ( 0 , T ) and ( T , t ) yields for t > T : (cid:2) t 0 I ( s ) N exp ( η ( s − t ) ) ds ≤ 1 η (cid:16) sup s ≥ T | I ( s ) | + exp ( − η ( t − T ) ) (cid:17) , which leads to the convergence in L 1 ( R + ) of f ( t , · ) . We also observe that Estimate ( 17 ) means that the rate of convergence of the prob - ability density f to equilibrium is determined by the smallest decay between that of I ( t ) and the exponential decay associated with the convergence rate to equilibrium solutions of the Fokker – Planck equations . As a matter of fact , using Fatou’s lemma , the convergence of f ( t , · ) to f ∞ in L 1 ( R + ) leads to : β ∞ = (cid:2) R + lim inf t →∞ β ( a ) f ( t , a ) da ≤ lim inf t → + ∞ β ( t ) . Therefore , we deduce from the convergence of S ( t ) to S ∞ that β ∞ S ∞ − γ ≤ lim inf t → + ∞ (cid:5) β ( t ) S ( t ) − γ (cid:6) . Recalling that dI / dt = I ( β S − γ ) , we deduce that if ¯ δ = − lim inf t → + ∞ (cid:5) β ( t ) S ( t ) − γ (cid:6) > 0 , which requires β ∞ S ∞ < γ , then for all δ ∈ ( 0 , ¯ δ ) , there is some C δ > 0 such that I ( t ) ≤ C δ exp ( − δ t ) . 123 60 Page 18 of 59 H . Berestycki et al . Then , L 1 ( R + ) convergence to equilibrium occurs at exponential speed (cid:2) R + | f ( t , a ) − f ∞ ( a ) | da ≤ C (cid:12)∗ exp ( − κ t ) , for some positive constant C (cid:12)∗ , where κ = D ∗ λ 1 if 2 D ∗ λ 1 < ¯ δ , κ ∈ ( 0 , ¯ δ / 2 ) otherwise . The case when β ∞ S ∞ = γ , however , is more intricate regarding the convergence speed of I ( t ) to 0 . Still , Theorem 2 holds even if I ( t ) were to converge more slowly to zero than exponential decreasing functions . We now turn to the proof of Theorem 2 . Proof In order to prove the large time convergence of solutions ( S , I , f ) of ( 12 ) to some equilibrium ( S ∞ , 0 , f ∞ ) , we need to adapt the Lyapunov function introduced in the classical works in the absence of epidemic ( Frank 2001 ) . The so - called relative entropy E ( t ) = (cid:2) R + f ( t , a ) log f ( t , a ) f ∞ ( a ) da plays the role of such a Lyapunov function . The ﬁrst step consists in proving that ( S ( t ) , I ( t ) ) converge . The second one is to prove that the average transmission rate t (cid:4)→ β ( t ) isbounded . Thethirdstepistoderiverelativeentropyestimatesintermsofits dissipation rate and the rate of infected individuals I ( t ) / N . Then logarithmic Sobolev inequality ( 16 ) and Csiszár - Kullback - Pinsker inequality will allow us to conclude . Step 1 : Convergence of ( S ( t ) , I ( t ) ) From the evolution equations of S and I , we deduce that S ( t ) ≥ 0 and I ( t ) ≥ 0 for all t ≥ 0 . If follows that S ( t ) is non - increasing with time t so that it converges to some S ∞ ∈ [ 0 , S ( 0 ) ) . Introducing the recovered population R ( t ) = N − S ( t ) − I ( t ) = γ (cid:2) t 0 I ( s ) ds , which is bounded from above by N and non - decreasing , we see that R ( t ) converges to some R ∞ . We conclude that I ( t ) = N − S ( t ) − R ( t ) converges to some value ¯ I ∞ = N − S ∞ − R ∞ , which is zero ( it would otherwise contradict the convergence of R ( t ) ) . Step 2 : Bounds on t (cid:2)→ ˇ ( t ) Recalling the epidemiological model , it is natural to expect that the average transmis - sion rate β ( t ) should remain bounded as time goes to + ∞ . Integrating the evolution 123 Epidemic modeling with heterogeneity and social diffusion Page 19 of 59 60 equation of f multiplied by β ( a ) , we deduce that t (cid:4)→ β ( t ) is governed by d β ( t ) dt = − I ( t ) N Var β ( t ) + (cid:2) R + β (cid:12) ( a ) (cid:3) μ b ( a ) f ( t , a ) − ∂ ∂ a ( D ( a ) f ( t , a ) ) (cid:4) da , where we have used μ b ( 0 ) = D (cid:12) ( 0 ) and where Var β ( t ) = (cid:2) R + (cid:5) β ( a ) − β ( t ) (cid:6) 2 f ( t , a ) da . Then , one has d β ( t ) dt + I ( t ) N Var β ( t ) + β (cid:12) ( 0 ) D ( 0 ) f ( t , 0 ) = (cid:2) R + (cid:5) β (cid:12) ( a ) μ b ( a ) + β (cid:12)(cid:12) ( a ) D ( a ) (cid:6) f ( t , a ) da . The above computations are formal . Their rigorous justiﬁcation requires sufﬁcient regularity and decay at inﬁnity of solutions f . These aspects are proved in Appendix C . Recalling that f ≥ 0 , Var β ( t ) ≥ 0 and using the non - degeneracy assumption ( H 2 ) and Condition ( H 3 ) , we deduce that d β ( t ) dt ≤ C 1 − C 2 β ( t ) . ( 18 ) Since β ( 0 ) < + ∞ by ( H 1 ) , we infer that t (cid:4)→ β ( t ) is bounded by some positive constant B for all time t ≥ 0 . Step 3 : Relative entropy estimate Next , we observe that the partial differential equation satisﬁed for f can be expressed in the following way involving f ∞ : ∂ f ( t , a ) ∂ t = ∂ ∂ a (cid:3) f ( t , a ) D ( a ) ∂ψ ( t , a ) ∂ a (cid:4) − (cid:5) β ( a ) − β ( t ) (cid:6) f ( t , a ) I ( t ) N , where ψ ( t , a ) = log f ( t , a ) f ∞ ( a ) . Using the fact that ∂ a ψ ( t , 0 ) = 0 and deﬁning the non - negative function x (cid:4)→ ξ ( x ) for positive x as ξ ( x ) = x log x − x + 1 , integration by parts yields d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da + (cid:2) R + f ( t , a ) D ( a ) (cid:3) ∂ψ ( t , a ) ∂ a (cid:4) 2 da ( 3 . 1 ) 123 60 Page 20 of 59 H . Berestycki et al . + I ( t ) N (cid:2) R + β ( a ) ξ (cid:3) f ( t , a ) f ∞ ( a ) (cid:4) f ∞ ( a ) da = I ( t ) N (cid:5) β ∞ − β ( t ) (cid:6) + β ( t ) I ( t ) N (cid:2) R + f ( t , a ) ψ ( t , a ) da . Here we have used Assumption ( H 1 ) . Again , we made formal computations requiring sufﬁcient regularity and decay of f that are proved in Appendix C . We then infer from ( 3 . 1 ) that d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da + (cid:2) R + f ( t , a ) D ( a ) (cid:3) ∂ψ ( t , a ) ∂ a (cid:4) 2 da ≤ I ( t ) N (cid:3) β ∞ + β ( t ) (cid:2) R + f ( t , a ) ψ ( t , a ) da (cid:4) . Therefore , we infer that (cid:2) R + f ( t , a ) ψ ( t , a ) da ≤ exp (cid:3)(cid:2) t 0 β ( s ) I ( s ) / Nds (cid:4) (cid:2) R + f ( 0 , a ) ψ ( 0 , a ) da + (cid:2) t 0 β ∞ I ( s ) N exp (cid:3)(cid:2) t s β ( τ ) I ( τ ) / Nd τ (cid:4) ds . Hence , for some positive constant C 3 , using the fact that R ∞ = γ (cid:9) + ∞ 0 I ( t ) dt ≤ N , there exists some constant B > 0 such that for all time t ≥ 0 (cid:2) R + f ( t , a ) ψ ( t , a ) da ≤ exp ( B ) (cid:2) R + f ( 0 , a ) ψ ( 0 , a ) da + C 3 exp ( B ) . Going back to ( 3 . 1 ) , we deduce that there exists a positive constant C ∗ such that d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da + (cid:2) R + f ( t , a ) D ( a ) (cid:3) ∂ψ ( t , a ) ∂ a (cid:4) 2 da ≤ C ∗ I ( t ) N . ( 19 ) Step 4 : Logarithmic Sobolev inequality In the absence of epidemic , the following quantity is usually viewed as the relative entropy dissipation rate (cid:2) R + f ( t , a ) D ( a ) (cid:3) ∂ψ ( t , a ) ∂ a (cid:4) 2 da . In order to estimate it , we make use of the Logarithmic Sobolev inequality stated in ( 16 ) and the lower bound on D ( a ) from Assumption ( H 2 ) . Thus , we get (cid:2) R + f ( t , a ) ψ ( t , a ) da ≤ 1 2 D ∗ λ 1 (cid:2) R + f ( t , a ) D ( a ) (cid:3) ∂ψ ( t , a ) ∂ a (cid:4) 2 da . 123 Epidemic modeling with heterogeneity and social diffusion Page 21 of 59 60 From ( 19 ) , we infer d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da + 2 D ∗ λ 1 (cid:2) R + f ( t , a ) ψ ( t , a ) da ≤ C ∗ I ( t ) N , so that (cid:2) R + f ( t , a ) ψ ( t , a ) da ≤ exp ( − η t ) (cid:2) R + f ( 0 , a ) ψ ( 0 , a ) da + C ∗ (cid:2) t 0 exp ( η ( s − t ) ) I ( s ) N ds , ( 20 ) where η = 2 D ∗ λ 1 . Step 5 : Conclusion In order to conclude , we rely on the Csiszár - Kullback - Pinsker inequality . It allows us to estimate the squared L 1 distance of the probability distribution f ( t , · ) to the equilibrium f ∞ in terms of the relative entropy ( Csiszár 1967 ; Kullback 1967 ; Pinsker 1964 ) . R . Theorem 3 ( Csiszár – Kullback – Pinsker ) Let f and g be two non - negative real func - tions in L 1 ( R + ) with (cid:14) f (cid:14) 1 = (cid:14) g (cid:14) 1 = 1 . Then , the following inequality holds : (cid:14) f − g (cid:14) 21 ≤ 2 (cid:2) R + f log f g . ( 21 ) For the reader’s convenience and because most of the related references are stated in R and not in the half space R + , we recall a simple proof due to J . A . Canizo ( https : / / canizo . org / page / 28 ) in Appendix B . Using the above estimate ( 21 ) , we conclude that (cid:3)(cid:2) R + | f ( t , a ) − f ∞ ( a ) | da (cid:4) 2 ≤ 2 (cid:2) R + f ( t , a ) ψ ( t , a ) da , so that ( 20 ) allows us to complete the proof of Theorem 2 up to a change of C ∗ by a factor 2 . (cid:15)(cid:16) Additional results and comments Given the convergence in L 1 ( R + ) of the distribution f ( t , · ) to f ∞ , it is natural to expect that the average transmission rate β ( t ) will converge to β ∞ . From the L 1 convergence property , Fatou’s Lemma yields : β ∞ ≤ lim inf t → + ∞ β ( t ) . 123 60 Page 22 of 59 H . Berestycki et al . However , additional assumptions seem necessary to infer the convergence of β ( t ) to β ∞ . For instance , assuming C 1 ≤ C 2 β ∞ yields this convergence where C 1 , C 2 are the constants in condition ( H 3 ) . Indeed , in that case , we infer from ( 18 ) that β ( t ) − β ∞ ≤ exp ( − C 2 t ) ( β ( 0 ) − β ∞ ) , so that lim sup t → + ∞ β ( t ) ≤ β ∞ , and therefore lim t → + ∞ β ( t ) = β ∞ . Such an apparently ad hoc assumption neverthe - less applies to some interesting situations described in Sect . 3 . 2 . Open problems The analysis of long term behavior for the system SfIR we have provided here opens the way to many mathematical questions . 1 ) It is of interest to relax the ( H 2 ) condition and address the case of degenerate diffusion functions a (cid:4)→ D ( a ) . 2 ) Condition ( H 4 ) to estimate the relative entropy in terms of its dissipation rate is not optimal . Following Arnold et al . ( 2001 ) in the absence of epidemiological coupling , one may replace ( H 4 ) by the following assumption ( H 5 ) leading to a more accurate convergence to equilibrium associated with the spectral gap of the uncoupled Fokker – Planck dynamical system : there exists λ 2 > 0 such that ( H 5 ) − 1 4 D (cid:12) 2 ( a ) D ( a ) + D (cid:12)(cid:12) ( a ) 2 + μ b ( a ) D (cid:12) ( a ) 2 D ( a ) − μ (cid:12) b ( a ) ≥ λ 2 > 0 . Note that in this assumption we do not require that D be non - degenerate . We expect to be able to derive the convergence Theorem 2 under this condition . 3 ) The approach extends naturally to the case when the trait a covers a d dimensional space , provided ( H 1 ) … ( H 4 ) assumptions incorporate suitable dependence on d . 4 ) The degenerate case where β ∞ S ∞ = γ raises interesting open questions since large time exponential convergence of infected population I ( t ) to 0 does not seem to hold any longer . Describing the convergence of I ( t ) to zero is one of the open questions . Likewise , in this case , it would be of interest to identify the rate of convergence of f to f ∞ in L 1 . 3 . 2 The Gaussian case The previous subsection is rather technical and involves some intricate assumptions in order to prove the large time convergence of the probability distribution f ( t , · ) to equilibrium . In order to make the arguments of Theorem 2 more transparent , we provide a separate comprehensive proof in the Gaussian case . That is , we consider henceforth the following framework . 123 Epidemic modeling with heterogeneity and social diffusion Page 23 of 59 60 ( i ) The background drift term μ b has linear dependence in a : μ b ( t , a ) = − μ 0 a , for some positive constant μ 0 . The coefﬁcient σ and hence the diffusion coefﬁcient D are constant . ( ii ) The transmission rate takes the form β ( a ) = β 0 + β 1 a 2 . where β 0 ≥ 0 and β 1 > 0 are two constants . ( iii ) The initial probability distribution f 0 has a ﬁnite second moment , that is : (cid:2) R + a 2 f 0 ( a ) da < + ∞ . In the absence of epidemic , Assumption ( i ) means that the trait a satisﬁes the Ornstein - Uhlenbeck Stochastic Differential Equation ( SDE ) da t = − μ 0 a t dt + σ dW t , ( 22 ) with reﬂecting boundary condition at a = 0 . Denoting again D = σ 2 / 2 , the corre - sponding Fokker – Planck equation then writes : ⎧⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎩ ∂ f ( t , a ) ∂ t = μ 0 ∂ ( af ( t , a ) ) ∂ a + D ∂ 2 f ( t , a ) ∂ a 2 for ( t , a ) ∈ R + × R + , ∂ a f ( t , 0 ) = 0 for t ∈ R + , (cid:2) R + f ( t , a ) da = 1 for t ∈ R + , with initial condition f 0 ≥ 0 such that (cid:2) R + f 0 ( a ) da = 1 . In the presence of epidemic propagation , ( 22 ) is replaced by da t = (cid:5) μ ep ( t , a t ) − μ 0 a t (cid:6) dt + σ dW t . Then , using ( 6 ) , the coupled model ( 12 ) in terms of the variables S ( t ) , I ( t ) , f ( t , a ) has now μ b ( t , a ) = − μ 0 a , D ( a ) = D and β ( a ) = β 0 + β 1 a 2 . In this framework , the stationary ( i . e . time independent ) distribution f ∞ of ( 12 ) is given by the Gaussian probability distribution truncated over R + f ∞ ( a ) = exp ( − α ( a ) ) , where α ( a ) = μ 0 a 2 2 D + 1 2 log π D 2 μ 0 , 123 60 Page 24 of 59 H . Berestycki et al . that is , f ∞ ( a ) = (cid:21) 2 μ 0 π D exp (cid:3) − μ 0 a 2 2 D (cid:4) Since α (cid:12)(cid:12) ( a ) = μ 0 / D the logarithmic Sobolev inequality ( 16 ) writes in this case : (cid:2) R + f ( a ) ψ ( a ) da ≤ D 2 μ 0 (cid:2) R + f ( a ) (cid:20)(cid:20) (cid:20)(cid:20) d ψ ( a ) da (cid:20)(cid:20) (cid:20)(cid:20) 2 da , where ψ = log f f ∞ . ( 23 ) The statement of Theorem 2 in this case writes with a further result about conver - gence of the average transmission rate . Theorem 4 UnderAssumptions ( i ) , ( ii ) and ( iii ) , t (cid:4)→ I ( t ) convergesto 0 andt (cid:4)→ S ( t ) converges to S ∞ as time t goes to + ∞ for some S ∞ such that 0 ≤ S ∞ < S ( 0 ) . Moreover , as soon as f 0 log ( f 0 / f ∞ ) ∈ L 1 ( R + ) , there exists C ∗ > 0 such that for all t > 0 (cid:3)(cid:2) R + | f ( t , a ) − f ∞ ( a ) | da (cid:4) 2 ≤ C ∗ (cid:2) t 0 I ( s ) N exp ( 2 μ 0 ( s − t ) ) ds + 2 exp ( − 2 μ 0 t ) (cid:2) R + f 0 ( a ) log f 0 ( a ) f ∞ ( a ) da , Moreover , the average transmission rate β ( t ) converges to β ∞ = (cid:2) R + β ( a ) f ∞ ( a ) da = β 0 + D β 1 / μ 0 , as t goes to + ∞ . Under Assumptions ( i ) , ( ii ) and ( iii ) , the requirements ( H 1 ) ( H 2 ) ( H 3 ) and ( H 4 ) are satisﬁed . Therefore , Theorem 4 is contained in Theorem 2 above . Nonetheless , we provide here a detailed proof of Theorem 4 since it is simpler . It follows the lines of the proof of Theorem 2 with some algebraic and technical simpliﬁcations that make the whole argument more transparent . It also yields a stronger results regarding the convergence of the average transmission rate . Proof Step 1 : Convergence of ( S ( t ) , I ( t ) ) This is unchanged with respect to the previous proof . Step 2 : Dynamics of t (cid:4)→ β ( t ) The evolution equation of f multiplied by β ( a ) yields after integration over a variable : d β ( t ) dt = − I ( t ) N Var β ( t ) − (cid:2) R + 2 β 1 a (cid:3) μ 0 af ( t , a ) + D ∂ f ( t , a ) ∂ a (cid:4) da , 123 Epidemic modeling with heterogeneity and social diffusion Page 25 of 59 60 where Var β ( t ) = (cid:2) R + (cid:5) β ( a ) − β ( t ) (cid:6) 2 f ( t , a ) da ≥ 0 . Then , introducing β ∞ = β 0 + D β 1 / μ 0 , usingtheresultsofAppendixCandintegration by parts lead to d β ( t ) dt + I ( t ) N Var β ( t ) = (cid:2) R + ( 2 μ 0 ( β 0 − β ( a ) ) + 2 β 1 D ) f ( t , a ) da . = 2 μ 0 (cid:5) β ∞ − β ( t ) (cid:6) . It follows that β ( t ) − β ∞ ≤ (cid:5) β ( 0 ) − β ∞ (cid:6) exp ( − 2 μ 0 t ) , so that β ( t ) is bounded and lim sup t → + ∞ β ( t ) ≤ β ∞ . Step 3 : Entropy estimate As before , we write the evolution equation of f in terms of f ∞ and ψ = log ( f / f ∞ ) : ∂ f ( t , a ) ∂ t = D ∂ ∂ a (cid:3) f ( t , a ) ∂ψ ( t , a ) ∂ a (cid:4) − (cid:5) β ( a ) − β ( t ) (cid:6) f ( t , a ) I ( t ) N , so that multiplying the above equation by ψ leads to ∂ ∂ t ( f ( t , a ) ψ ( t , a ) − f ( t , a ) ) = D ∂ ∂ a (cid:3) f ( t , a ) ψ ( t , a ) ∂ψ ( t , a ) ∂ a (cid:4) − Df ( t , a ) (cid:20)(cid:20) (cid:20)(cid:20) ∂ψ ( t , a ) ∂ a (cid:20)(cid:20) (cid:20)(cid:20) 2 − (cid:5) β ( a ) − β ( t ) (cid:6) f ( t , a ) ψ ( t , a ) I ( t ) N . Integrating over R + , using the homogeneous Neumann boundary conditions on ψ , and introducingthenon - negativefunction ξ deﬁnedforpositive x by ξ ( x ) = x log x − x + 1 , we obtain d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da = (cid:10) Df ( t , a ) ψ ( t , a ) ∂ψ ( t , a ) ∂ a (cid:11) + ∞ 0 − D (cid:2) R + f ( t , a ) (cid:20)(cid:20)(cid:20)(cid:20) ∂ψ ( t , a ) ∂ a (cid:20)(cid:20)(cid:20)(cid:20) 2 da − I ( t ) N (cid:2) R + β ( a ) f ∞ ( a ) f ( t , a ) f ∞ ( a ) log f ( t , a ) f ∞ ( a ) da 123 60 Page 26 of 59 H . Berestycki et al . + I ( t ) N (cid:2) R + β ( a ) f ∞ ( a ) (cid:3) f ( t , a ) f ∞ ( a ) − 1 (cid:4) da + I ( t ) N (cid:5) β ∞ − β ( t ) (cid:6) + I ( t ) N β ( t ) (cid:2) R + f ( t , a ) ψ ( t , a ) da . The ﬁrst term of the right hand side vanishes : for a = 0 because of the homogeneous Neumann boundary condition on ψ ( t , · ) = f ( t , · ) / f ∞ , and for a = + ∞ because f ( t , · ) decays like f ∞ as proved in Appendix C . We therefore end up with d dt (cid:2) R + f ( t , a ) ψ ( t , a ) da + D (cid:2) R + f ( t , a ) (cid:20)(cid:20)(cid:20)(cid:20) ∂ψ ( t , a ) ∂ a (cid:20)(cid:20)(cid:20)(cid:20) 2 da + I ( t ) N (cid:2) R + β ( a ) ξ (cid:3) f ( t , a ) f ∞ ( a ) (cid:4) f ∞ ( a ) da = I ( t ) N (cid:5) β ∞ − β ( t ) (cid:6) + I ( t ) N β ( t ) (cid:2) R + f ( t , a ) ψ ( t , a ) da . ( 24 ) Then , denoting the relative entropy E ( t ) = (cid:2) R + f ( t , a ) ψ ( t , a ) da , ( 25 ) we deduce that d E ( t ) dt + D (cid:2) R + f ( t , a ) (cid:20)(cid:20)(cid:20)(cid:20) ∂ψ ( t , a ) ∂ a (cid:20)(cid:20)(cid:20)(cid:20) 2 da ≤ I ( t ) N (cid:5) β ∞ + β ( t ) E ( t ) (cid:6) . Finally , using the logarithmic Sobolev inequality ( 23 ) , we obtain d E ( t ) dt + 2 μ 0 E ( t ) ≤ I ( t ) N (cid:5) β ∞ + β ( t ) E ( t ) (cid:6) . Gronwall type lemma then leads to E ( t ) ≤ C ∗ (cid:2) t 0 I ( s ) N exp ( − 2 μ 0 ( s − t ) ) ds + E ( 0 ) exp ( − 2 μ 0 t ) , for some positive constant C ∗ . Estimate ( 4 ) then follows from Csiszár - Kullback - Pinsker’s inequality ( 6 ) up to a change of C ∗ by a factor 2 . Step 4 : Convergence of β ( t ) to β ∞ We have obtained the L 1 convergence of f ( t , · ) to f ∞ , so that application of Fatou’s lemma leads to (cid:2) R + lim inf t → + ∞ β ( a ) f ( t , a ) da ≤ lim inf t → + ∞ (cid:2) R + β ( a ) f ( t , a ) da , 123 Epidemic modeling with heterogeneity and social diffusion Page 27 of 59 60 which means that lim inf t → + ∞ β ( t ) ≥ β ∞ . Since lim sup t → + ∞ β ( t ) ≤ β ∞ as estab - lished above , we conclude that β ( t ) converges to β ∞ . (cid:15)(cid:16) The simpler assumptions above also turn out to exhibit interesting properties regard - ing self - similar solutions . Such a viewpoint is developed in Sects . 4 and 6 . 4 The parsimonious model in the case of a Gaussian distribution In order to obtain a parsimonious model , i . e . with as few parameters as possible , we look for self - similar solutions of ( 11 ) . Dimarco et al . ( 2021 ) introduced a similar approach combining behavioral heterogeneity with social diffusion in the framework of kinetic theory and using gamma - type distributions of the susceptible population . Heterogeneity of susceptibles is described by a trait b ∈ R + with transmission rate expressed as power laws of b . In this section , we focus on Gaussian distribution proﬁles truncated on A = R + , which as explained later is connected to the Dimarco et al . ( 2021 ) modeling approach . 4 . 1 Assumptions In order to compute the reduced complexity model arising from self - similar solutions , we make the following assumptions : • Truncated Gaussian distribution The initial distribution f 0 ( a ) = S 0 ( a ) / S 0 of the susceptible population is described in terms of the continuous risk variable a ∈ R + f 0 ( a ) = 1 λ 0 φ (cid:3) a λ 0 (cid:4) where λ 0 > 0 and φ ( a ) = (cid:21) 2 π exp (cid:3) − a 2 2 (cid:4) . The approach in Dimarco et al . ( 2021 ) consists in considering Maxwellians in the kinetic theory framework expressed as gamma type distributions . The two approaches are connected through a change of variables in the probability mea - sures : introducing trait b as b = a 2 / 2 , one has φ ( a ) da = ( π b ) − 1 / 2 exp ( − b ) db , which is nothing but a gamma distribution with parameter 1 / 2 . Let us also observe that the expression as truncated Gaussian distributions allows to derive more general models representing solutions of the original PDE model ( 11 ) inamoreaccurateway . Thebasicideaistoexpandsolutions ( t , a ) (cid:4)→ S ( t , a ) along even eigenfunctions of the underlying linear operator which turns out to coincide with the Schrödinger operator associated with harmonic oscillator potential . We provide a detailed derivation of the corresponding high order model in Appendix B , Sect . 6 , together with numerical simulations illustrating the convergence of high order model to solutions of the full partial differential equation system . 123 60 Page 28 of 59 H . Berestycki et al . • Constant diffusion coefﬁcient with respect to a , possibly time dependent σ 2 2 = D ( t ) for some positive function t (cid:4)→ D ( t ) . • The transmission rate function β is a quadratic function of a β ( a ) = β 0 + β 1 a 2 . Note that this expression differs from Dimarco et al . ( 2021 ) , which does not include the constant coefﬁcient β 0 . • Background drift effect μ b ( t , a ) = − μ 0 ( t ) a . Note that one may replace μ 0 ( t ) by any function of time only , related or not to epidemic variables ( it may be used for instance to account for the inﬂuence of public health policy ) . • The susceptible population S ( t , a ) is assumed to be expressed as a self - similar proﬁle S ( t , a ) = S ( t ) λ ( t ) φ (cid:3) a λ ( t ) (cid:4) , ( 26 ) for some functions of time t (cid:4)→ S ( t ) and t (cid:4)→ λ ( t ) such that S ( 0 ) = S 0 and λ ( 0 ) = λ 0 . Let us observe at this stage that φ (cid:12) ( A ) = − A φ ( A ) and φ (cid:12)(cid:12) ( A ) = ( A 2 − 1 ) φ ( A ) , which will be used in computations below . 4 . 2 Derivation We deduce from the ﬁrst equation of ( 11 ) that (cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) φ ( A ) − A φ (cid:12) ( A ) ˙ λ S λ 2 = − I (cid:5) β 0 + β 1 λ 2 A 2 (cid:6) S N λ φ ( A ) + (cid:16) − μ 0 S λ + DS λ 3 (cid:17) (cid:7) A 2 − 1 (cid:8) φ ( A ) , hence φ ( A ) (cid:22)(cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) + I β 0 S N λ − μ 0 S λ + DS λ 3 (cid:23) 123 Epidemic modeling with heterogeneity and social diffusion Page 29 of 59 60 = A 2 φ ( A ) (cid:22) − ˙ λ S λ 2 − I β 1 λ 2 S N λ − μ 0 S λ 2 + DS λ 3 (cid:23) We therefore require that the two time dependent functions on the left and right hand side of ( 27 ) are equal to zero : ˙ λ λ = − I β 1 λ 2 N − μ 0 + D λ 2 (cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) + I β 0 S N λ − μ 0 S λ + DS λ 3 = 0 hence substituting ( 27 ) into ( 27 ) , one gets on the one hand ˙ S S = − I (cid:5) β 0 + β 1 λ 2 (cid:6) N . On the other hand , the second equation of ( 11 ) leads to dI dt = I (cid:16) S ( β 0 + β 1 λ 2 ) N − γ (cid:17) As a consequence , the derived model writes as follows ⎧ ⎪ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ dS dt = − SI (cid:5) β 0 + β 1 λ 2 (cid:6) N d λ dt = − I β 1 λ 3 N − μ 0 λ + D λ dI dt = SI ( β 0 + β 1 λ 2 ) N − γ I d R dt = γ I , ( 27 ) with initial conditions S ( 0 ) = S 0 , λ ( 0 ) = λ 0 , I ( 0 ) = I 0 and R ( 0 ) = 0 . Let us observe that the average of the risk parameter a is linked to the λ parameter : ¯ a ( t ) = (cid:21) 2 π λ ( t ) Var ( a ) ( t ) = λ ( t ) 2 (cid:3) 1 − 2 π (cid:4) . 123 60 Page 30 of 59 H . Berestycki et al . 4 . 3 Dynamics of the average transmission rate ˇ Let us recall the equation governing the probability density function f ( t , a ) = S ( t , a ) / S ( t ) of susceptible individuals ∂ t f ( t , a ) = − I ( t ) N f ( t , a ) (cid:5) β ( a ) − β ( t ) (cid:6) + μ 0 ∂ ∂ a ( af ( t , a ) ) + ∂ 2 ∂ a 2 ( Df ( t , a ) ) . Then , we introduce the notation ϕ ( t ) = (cid:2) R + ϕ ( a ) f ( t , a ) da , so that one has d β ( t ) dt = − I ( t ) N ( β 2 ( t ) − β ( t ) 2 ) − μ 0 (cid:2) R + β (cid:12) ( a ) af ( t , a ) da − D (cid:2) R + β (cid:12) ( a ) ∂ f ( t , a ) ∂ a da β ( t ) = (cid:2) R + β ( a ) f ( t , a ) da Var ( β ) ( t ) = β 2 ( t ) − β ( t ) 2 . Then , inserting the self similar proﬁles into ( 27 ) , f ( t , a ) = λ ( t ) − 1 φ ( a / λ ( t ) ) , one gets β ( t ) = β 0 + β 1 λ 2 . β 2 ( t ) = (cid:2) R + ( β 20 + 2 β 0 β 1 λ 2 A 2 + λ 4 β 21 A 4 ) φ ( A ) d A = β 20 + 2 β 0 β 1 λ 2 + 3 β 21 λ 4 , where we used the fact that A 2 φ = φ (cid:12)(cid:12) + φ and A 4 φ = ( A 2 φ (cid:12) + 3 φ (cid:12) ) (cid:12) + 3 φ . The variance Var ( β ) ( t ) can then be expressed as Var ( β ) ( t ) = 2 β 21 λ 4 ( t ) = 2 ( β − β 0 ) 2 It means that the dynamics of t (cid:4)→ λ ( t ) is directly linked to the average value of the β parameter . Therefore , the equation on λ can be replaced by the dynamics of the average transmission rate β in System ( 27 ) d β dt = − 2 I N ( β − β 0 ) 2 − 2 μ 0 ( β − β 0 ) + 2 D β 1 . 123 Epidemic modeling with heterogeneity and social diffusion Page 31 of 59 60 Therefore , ( 27 ) becomes ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪ ⎪⎪⎪⎪⎪⎪⎪⎩ dS dt = − β S I N d β dt = − 2 I N ( β − β 0 ) 2 − 2 μ 0 ( β − β 0 ) + 2 D β 1 dI dt = β S I N − γ I d R dt = γ I , ( 27 ) withinitialconditions I ( 0 ) = I 0 ∈ ( 0 , N ) , S ( 0 ) ∈ ( 0 , N − I 0 ] , R ( 0 ) = N − I ( 0 ) − S ( 0 ) and β ( 0 ) = β 0 ≥ β 0 . We have thus reduced the PDE system ( 11 ) to an ODE system with four unknowns . It is worth emphasizing that this ODE system , albeit simple , retains the memory of the PDE system , through the diffusion D and the drift μ 0 . This system is a simple extension of the SIR model involving a parameter for social diffusion D and an additional equation for the dynamics of the average transmission rate β ( t ) . This last effect is indeed a major characteristic of the evolution of the epidemics . Indeed , from the second equation in System ( 27 ) , we see that , on the one hand , β ( t ) has a tendency to decrease under the effect of the epidemics sculpting the distribution of a by removing relatively more high a values , while , on the other hand , the social diffusion parameter tends to offset this tendency . 4 . 4 A rich variety of dynamical behaviors We now show that this reduced form still yields a wealth of various dynamical behav - iors . In fact , we recover nearly all the dynamical features we reported in our earlier work ( Berestycki et al . 2021 ) for the full PDE model ( 11 ) . All the ﬁgures we show here are obtained from numerical simulations of System ( 27 ) over a period of 18 months with realistic values of epidemic parameters , initialized with a very small sub - population of infected individuals in an otherwise susceptible population . In Fig . 1 , we consider the case in which R = 4 given an average infectious period of 10 days ( full parameters included in the caption ) . The initial value of f is set to the equilibrium value expected in the absence of an epidemic . We then evaluate dynamics given an initial infected population fraction of 10 − 6 . We observe an expo - nential growth , followed by a decay and then a smaller shoulder pattern . This is a representative sequence observed in epidemic data . Note that during the exponential growth phase , the average susceptibility remains close to the equilibrium level . How - ever , when a sufﬁciently large number of individuals are infected , then the average susceptibility drops , leading to a decrease in susceptibility which then relaxes over time , enabling the re - emergence of a longer term shoulder . Over time , the infections decay and the susceptibility relaxes slowly towards β ∗ ( over a multi - year period given 123 60 Page 32 of 59 H . Berestycki et al . 0 50 100 150 200 250 300 350 400 450 500 - 6 - 5 - 4 - 3 - 2 - 1 0 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 0 . 35 0 . 4 Fig . 1 Epidemic dynamics leading to a single peak followed by a shoulder . Dynamics shown are that of infected fraction , I ( t ) ( black , solid ) in logarithmic scale , and Average susceptibility , β ( t ) ( red , dashed ) . Parameters are β ( 0 ) = 0 . 4days − 1 , β 0 = 0days − 1 , μ 0 = 5 × 10 − 3 day − 1 , γ = 0 . 1days − 1 , 2 D β 1 = 0 . 004days − 2 , R 0 = 4 , I ( 0 ) = 10 − 6 Fig . 2 Epidemic dynamics leading to multiple peaks . Dynamics shown are that of infected fraction , I ( t ) ( black , solid ) in logarithmic scale , and Average susceptibility , β ( t ) ( red , dashed ) . Parameters are : β ( 0 ) = 0 . 8day − 1 , β 0 = 0 . 0day − 1 , I ( 0 ) = 1 E − 6 , 2 D β 1 = 0 . 008day − 2 , μ 0 = 5 E − 3day − 1 , γ = 0 . 2day − 1 this parameter set ) . We emphasize that , though much simpliﬁed with respect to the full PDE model , this system of ODEs can generate complex features . As we already pointed out in our previous article ( Berestycki et al . 2021 ) rebounds appear as part of the intrinsic dynamics of the epidemics even without variants . This is illustrated in Fig . 2 with larger amplitudes of oscillations . In this case however , as should be expected , further rebounds reach lower maximal levels than the ﬁrst peak because of the dissipative nature of the underlying PDE model . As before , the β ( t ) decreases as infections increase and then revert back towards the equilibrium , enabling the second oscillation . The initial decrease in susceptibility reﬂects how the ODE retains the sculpting feature of the PDE while the rebound is a result of the drift back to the mean of the unique equilibrium distribution in f . 123 Epidemic modeling with heterogeneity and social diffusion Page 33 of 59 60 Note that for suitable parameters System ( 27 ) also exhibits the typical SIR behavior of an exponential growth followed by a ( nearly ) exponential decay . We perform more systematic comparison of PDE and ODE based dynamics in Sect . 6 . 1 . 5 Mathematical analysis of the ODE system 5 . 1 Properties of the ODE system This section is devoted to deriving several mathematical properties of the ODE system ( 27 ) . Our purpose here is to show that this reduced system displays natural features of the heterogeneous system . We mainly discuss here the large time behavior of ( S ( t ) , β ( t ) , I ( t ) , R ( t ) ) in terms of the parameters μ 0 , D and β ( 0 ) . The results and their dependence on the parameters are summarized in Table 1 at the end of the subsection . Throughout this section , without loss of generality , we normalize the population in such a way that N = 1 . Consistency with SIR model We ﬁrst observe that ( 27 ) reduces to the standard SIR model in the absence of hetero - geneity i . e . β 1 = 0 , when β ( 0 ) = β 0 . Clearly , in this case there holds β ( t ) = β 0 for all t ≥ 0 and we get the solution of the corresponding SIR system . Bounds on the average transmission rate ˇ We claim that the following proposition holds Proposition 1 Assume that β ( 0 ) ≥ β 0 , μ 0 ≥ 0 and D ≥ 0 . Then , for all t ≥ 0 , one has β ( t ) ≥ β 0 . Proof We argue by contradiction . In the case D > 0 , suppose there is a ﬁrst time t ∗ where β ( t ∗ ) = β 0 . Then , from the equation we get β (cid:12) ( t ∗ ) > 0 which is a contradiction . In the case D = 0 , the equation for x = β − β 0 is of the form ˙ x ( t ) = g ( t , x ) x ( t ) , so that x ( t ) > 0 when x ( 0 ) > 0 . (cid:15)(cid:16) Asymptotic limit of ( S , I , R ) As in the conventional SIR model , the solution converges to a constant state in the large time limit . Proposition 2 The solution of ( 27 ) ( S ( t ) , I ( t ) , R ( t ) ) converges to ( S ∞ , 0 , R ∞ ) as t goes to + ∞ , with S ∞ ∈ [ 0 , 1 ) , R ∞ ∈ ( 0 , 1 ] such that S ∞ + R ∞ = 1 . Proof t (cid:4)→ R ( t ) is non - decreasing and bounded by 1 , so that R ( t ) → R ∞ ∈ ( 0 , 1 ] as t → + ∞ . Moreover , t (cid:4)→ S ( t ) is non - increasing and positive , so that S ( t ) → S ∞ for some S ∞ ∈ [ 0 , 1 ) . It follows that I ( t ) = 1 − S ( t ) − R ( t ) converges to some I ∞ ≥ 0 . Since R ( t ) converges to some ﬁnite limit R ∞ , one has I ∞ = 0 . (cid:15)(cid:16) 123 60 Page 34 of 59 H . Berestycki et al . The case (cid:2) 0 > 0 Proposition 3 In the case when μ 0 > 0 , the average transmission coefﬁcient β ( t ) remains bounded and converges to β ∞ = β 0 + D β 1 / μ 0 as t goes to + ∞ . Moreover , the limits satisfy β ∞ S ∞ ≤ γ . ( 28 ) Proof First one has d β dt ≤ − 2 μ 0 ( β − β 0 ) + 2 D β 1 , so that t (cid:4)→ β ( t ) satisﬁes β ( t ) ≤ β 0 + ( β ( 0 ) − β 0 ) exp ( − 2 μ 0 t ) + D β 1 μ 0 ( 1 − exp ( − 2 μ 0 t ) ) and thus remains bounded : there exists M > 0 such that β ( t ) ≤ M for all t ∈ R + . Then , taking β ∞ as deﬁned in the above proposition , one also has β ( t ) − β ∞ = ( β ( 0 ) − β ∞ ) exp ( − 2 μ 0 t ) − (cid:2) t 0 2 ( β ( s ) − β 0 ) 2 I ( s ) exp ( − 2 μ 0 ( t − s ) ) ds . ( 29 ) Given ε > 0 , for T large enough , and t > T one has (cid:2) t T 2 ( β ( s ) − β 0 ) 2 I ( s ) exp ( − 2 μ 0 ( t − s ) ) ds ≤ 2 M 2 (cid:2) + ∞ T I ( s ) ds ≤ ε / 2 . Hence , taking T large enough and , say , t > 2 T , we see that the right hand side of ( 29 ) is less than ε . This proves the convergence of β ( t ) to β ∞ as t → + ∞ . Finally , in view of the equation satisﬁed by I , it is straightforward to see that inequality ( 28 ) holds . (cid:15)(cid:16) Notice that β ( t ) converges to the same limit β ∞ as in the case of solutions of the full PDE system ( 12 ) in the Gaussian case ( compare the above Theorem 4 ) . It is interesting to observe that if initially I ( 0 ) = I 0 > 0 , and β ( 0 ) = β ∞ , then t (cid:4)→ β ( t ) is decreasing in the early stages of the epidemic . Indeed , one has d β dt ( 0 ) = − 2 I 0 ( β ( 0 ) − β 0 ) 2 = − 2 I 0 D 2 β 21 μ 20 < 0 . Thus , if initially the epidemic depletes more the fraction of the population with large a , eventually , for large time , this trend will be reversed and β ( t ) will increase to converge to its equilibrium value β ∞ . We also established this property in the full PDE model ( compare Theorem 4 ) . 123 Epidemic modeling with heterogeneity and social diffusion Page 35 of 59 60 The case (cid:2) 0 = 0 and D > 0 In the case when μ 0 = 0 and D > 0 , the following properties hold Proposition 4 In the case when μ 0 = 0 and D > 0 , the limit susceptibles satisfy S ∞ = 0 , R ∞ = 1 , and β ( t ) → + ∞ as t goes to + ∞ . Let us observe that the case μ 0 = 0 is singular , since in that case all susceptibles become infected at the end of the epidemic . This property is related to the fact that Model ( 27 ) derives from the underlying partial differential equation model ( 11 ) where the risk trait a covers the unbounded domain R + . Proof First , we observe that τ = 1 / ( β − β 0 ) satisﬁes d τ dt = 2 I − 2 D β 1 τ 2 , so that 2 D β 1 (cid:2) t 0 τ ( s ) 2 ds = 2 (cid:2) t 0 I ( s ) ds − τ ( t ) + τ ( 0 ) . Using the fact that τ ≥ 0 , the integral on the left hand side converges since I itself is integrable over R + . As a consequence , τ ( t ) converges to some ﬁnite value τ ∞ ≥ 0 as t goes to + ∞ . The convergence of the integral of τ 2 requires that τ ∞ = 0 , i . e . β ( t ) tends to + ∞ as t goes to + ∞ . Finally , assuming that S ∞ > 0 the dynamics of I would be exponentially growing since β ( t ) S ( t ) − γ would tend to + ∞ , which does not make sense . We conclude that S ∞ = 0 , so that R ∞ = 1 . (cid:15)(cid:16) The case D = 0 We derive here comparisons with the classical SIR model . To this end , we introduce the notation S SI R , α ( t ) for the solution of the SIR model with transmission rate β = α ( constant ) and a ﬁxed parameter γ . We write S SI R , α ∞ for the ﬁnal size of the susceptible population . In the case when μ 0 > 0 and D = 0 , the following properties hold Proposition 5 When D = 0 , theaveragetransmissionratet (cid:4)→ β ( t ) is non - increasing and converges to β 0 as t goes to + ∞ . Moreover , if β ( 0 ) S 0 > γ and I 0 > 0 , then t (cid:4)→ I ( t ) has a unique maximum as in the homogeneous SIR model . Finally , the limit susceptible populations satisﬁes S SI R , β ( 0 ) ∞ ≤ S ∞ ≤ S SI R , β 0 ∞ . 123 60 Page 36 of 59 H . Berestycki et al . Proof As in the case of the homogeneous SIR model , the dynamics of susceptibles S in terms of R instead of time leads to the expression S ( R ) = S 0 exp ⎛ ⎜⎜⎜⎝ − (cid:2) R R 0 β ( ρ ) d ρ γ ⎞ ⎟⎟⎟⎠ for R ∈ [ R 0 , R ∞ ] . Here R ∞ is the ﬁnal size of the R - population . It is given by the relation : R ∞ + S 0 exp ⎛ ⎜⎜⎜⎝ − (cid:2) R ∞ R 0 β ( ρ ) d ρ γ ⎞ ⎟⎟⎟⎠ = 1 . We introduce the notations : F α ( x ) = x + S 0 exp (cid:3) − α ( x − R 0 ) γ (cid:4) for all x ∈ [ R 0 , + ∞ ) , F ( x ) = x + S 0 exp ⎛ ⎜⎜⎝ − (cid:2) x R 0 β ( ρ ) d ρ γ ⎞ ⎟⎟⎠ for all x ∈ [ R 0 , R ∞ ] . From the equation for β in System ( 27 ) , we see that β ( t ) is decreasing ( aside from the obvious case β ( t ) ≡ β 0 ) . Thus , in view of Proposition 1 , we know that for all t ≥ 0 , one has β ( 0 ) ≥ β ( t ) ≥ β 0 . Therefore , we infer that : F β ( 0 ) ( x ) ≤ F ( x ) ≤ F β 0 ( x ) for all x ∈ [ R 0 , R ∞ ] . From the classical ﬁnal size relation in the SIR model , we deduce that S SI R , β ( 0 ) ∞ ≤ S ∞ ≤ S SI R , β 0 ∞ . (cid:15)(cid:16) 123 Epidemic modeling with heterogeneity and social diffusion Page 37 of 59 60 Expression in terms of R in the general case D ≥ 0 As in the case of SIR model , we observe that we can express all the variables S , β , I in terms of R : ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎩ dS d R = − β S γ d β d R = − 2 γ ( β − β 0 ) 2 − 2 μ 0 ( β − β 0 ) γ I + 2 D β 1 γ I dI d R = β S γ − 1 . ( 30 ) From the ﬁrst equation of ( 30 ) , we infer S ( R ) = S 0 exp (cid:3) − B ( R ) γ (cid:4) , where B ( R ) = (cid:2) R R 0 β ( ρ ) d ρ , so that the infected write as I ( R ) = 1 − R − S 0 exp (cid:3) − B ( R ) γ (cid:4) . The second equation then leads to B (cid:12)(cid:12) ( R ) = − 2 ( B (cid:12) ( R ) − β 0 ) 2 γ + 2 D β 1 − 2 μ 0 ( B (cid:12) ( R ) − β 0 ) γ (cid:3) 1 − R − S 0 exp (cid:3) − B ( R ) γ (cid:4)(cid:4) . Without social diffusion D = 0 and without drift (cid:2) 0 = 0 In the absence of social diffusion D = 0 and drift μ 0 = 0 , the system describes a heterogeneous population without random ﬂuctuations of the risk factor . It turns out that in this case , we can solve explicitly System ( 27 ) in terms of R to get : B ( R ) = β 0 ( R − R 0 ) + γ 2 log (cid:16) 1 + 2 ( R − R 0 ) ( β ( 0 ) − β 0 ) γ (cid:17) , ( 31 ) i . e . β ( R ) = β 0 + β ( 0 ) − β 0 1 + 2 ( R − R 0 ) γ ( β ( 0 ) − β 0 ) . 123 60 Page 38 of 59 H . Berestycki et al . The infected then write in terms of R as I ( R ) = 1 − R − S 0 exp (cid:3) − β 0 ( R − R 0 ) γ (cid:4) (cid:16) 1 + 2 ( R − R 0 ) ( β ( 0 ) − β 0 ) γ (cid:17) 1 / 2 . When β ( 0 ) = β 0 , one recovers the classical formulas of the conventional SIR model . Furthermore , at the initial stage , when R is close to R 0 , we get I ( R ) ≈ I 0 + ( R − R 0 ) (cid:16) β ( 0 ) S 0 γ − 1 (cid:17) . This formula generalizes the classical criterion R 0 > 1 for epidemic expansion . Here , it is expressed in terms of the parameter R 0 = β ( 0 ) S 0 / γ . Entropy estimates when (cid:2) 0 > 0 and D > 0 Let us translate Estimate ( 24 ) of the relative entropy ( 25 ) in the framework of self - similar solutions as developed in Sect . 4 . Denoting θ ( t ) = λ ( t ) 2 λ 2 ∞ where λ ∞ = (cid:30) D μ 0 , we infer from self similar expression ( 26 ) of f ( t , · ) that E ( t ) = (cid:2) R + f ( t , a ) log f ( t , a ) f ∞ ( a ) da = 1 2 ( θ ( t ) − 1 − log θ ( t ) ) , whereas its dissipation rate rewrites as the simple equation D ( t ) = D (cid:2) R + f ( t , a ) (cid:20)(cid:20)(cid:20)(cid:20) ∂ψ ( t , a ) ∂ a (cid:20)(cid:20)(cid:20)(cid:20) 2 da = μ 0 ( 1 − θ ( t ) ) 2 θ ( t ) . Then , Estimate ( 24 ) rewrites in terms of θ as d E dt + D ( t ) = 0 We observe that the Logarithmic Sobolev inequality is then associated to the property that for all x ∈ R + 0 ≤ x − 1 − log x ≤ ( x − 1 ) 2 x . 123 Epidemic modeling with heterogeneity and social diffusion Page 39 of 59 60 Hence , we obtain the exponential convergence of the relative entropy E ( t ) ≤ E ( 0 ) exp ( − 2 μ 0 t ) , which provides another proof of convergence of λ ( t ) to λ ∞ ( hence proving the con - vergence of β ( t ) to β ∞ ) . We summarize the previous results in the following synthetic Table 1 . The new systems we have introduced here beg for further study . These concern both the PDE system ( 12 ) and the ODE system ( 27 ) . They lead to several open problems among which we mention the following three . • What is the dependence of S ∞ in the PDE system ( 12 ) with respect to model parameters μ 0 , D , β 1 etc . ? • Derive the asymptotics for the PDE model ( 12 ) when μ 0 → + ∞ . We conjecture that the probability distribution f ( t , a ) converges to a Dirac distribution δ a = 0 , and β ( t , a ) → β 0 for any t > 0 . Therefore , in the limit , we should get the SIR model with β 0 as the transmission rate . The same question is also relevant for the ODE model . • Derive the asymptotics when D → ∞ in the ODE and PDE modeling frameworks . Here we conjecture that this situation should be analogous to the case μ 0 = 0 and that β ( t ) → ∞ , I ( t ) → 0 , S ( t ) → 0 for any ﬁxed t > 0 . 5 . 2 Oscillations : heuristic arguments In the unfolding of epidemics , when there is a plateau , one often observes oscillatory behavior of the level of infected . Therefore , it is useful to check the ability of a model to reproduce this stylized fact . We provide here heuristic evidence that oscillations may indeed occur in the simpliﬁed model ( 27 ) . We only consider the case μ 0 = 0 , and β 0 = 0 . As for other epidemic features , we ﬁnd it more convenient to work in logarithmic scale , that is , with the variable log I rather than I . We seek some constant value I p that we will choose adequately later on , such that there is a plateau at the level I (cid:18) I p . We set X = log ( I / I p ) . Again , we assume that N = 1 for simplicity . Introducing η = 2 D β 1 , the system ( 27 ) takes the form : ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ dS d R = − β S γ d β d R = − 2 β 2 γ + η γ I d X d R = (cid:16) β S γ − 1 (cid:17) 1 I . 123 60 Page 40 of 59 H . Berestycki et al . T a b l e 1 S u mm a r y o f l a r g e - ti m e b e h a v i o r o f s o l u ti on s o f ( 27 ) A ss u m p ti on s L a r g e ti m e p r op e r ti e s μ 0 D β ( 0 ) β ( t ) ( S ( t ) , I ( t ) , R ( t ) ) ≥ 0 ≥ 0 ≥ β 0 β ( t ) ≥ β 0 ( S ( t ) , I ( t ) , R ( t ) ) → ( S ∞ , 0 , R ∞ ) , S ∞ ∈ [ 0 , 1 ) a nd R ∞ ∈ ( 0 , 1 ] > 0 ≥ 0 ≥ β 0 β ( t ) → β ∞ w it h β ∞ = β 0 + D β 1 / μ 0 β ∞ S ∞ ≤ γ = 0 > 0 ≥ β 0 β ( t ) → + ∞ S ∞ = 0 , R ∞ = 1 = 0 = 0 > β 0 β ( t ) → β ∞ > β 0 β ∞ = β 0 + β ( 0 ) − β 0 1 + 2 ( R ∞ − R 0 ) ( β ( 0 ) − β 0 ) / γ > 0 = 0 ≥ β 0 β ( t ) → β 0 S S I R , β ( 0 ) ∞ ≤ S ∞ ≤ S S I R , β 0 ∞ 123 Epidemic modeling with heterogeneity and social diffusion Page 41 of 59 60 Hence , computing the second derivative of X with respect to R we get d 2 X d R 2 = − (cid:16) β S γ − 1 (cid:17) 2 1 I 2 + S γ 2 (cid:7) η I − 3 β 2 (cid:8) 1 I . Denoting ρ = β S / γ − 1 , we reformulate the above ODE as follows d 2 X d R 2 = 1 I 2 (cid:16) − ρ 2 + η S γ 2 (cid:17) − 3 ( 1 + ρ ) 2 I S . ( 32 ) In a plateau , one expects the right hand side of this equation to be very small . It is then natural to introduce the value of I that makes the right hand side vanish . We denote it by ˜ I p : ˜ I p = η S 2 − ρ 2 γ 2 S 3 γ 2 ( 1 + ρ ) 2 . Note that ˜ I p varies in time like S . Thus , Eq . ( 32 ) rewrites as d 2 X d R 2 = 3 ( 1 + ρ ) 2 S (cid:16) ˜ I p I 2 − 1 I (cid:17) . ( 33 ) The idea now is to seek a constant plateau value I p close to ˜ I p for which we can ﬁnd oscillations around it . To this end , since I = I p exp ( X ) , it is convenient to reformulate Eq . ( 33 ) in the following manner : d 2 X d R 2 = 3 ( 1 + ρ ) 2 S (cid:16) ˜ I p I 2 p exp ( − 2 X ) − 1 I p exp ( − X ) (cid:17) . This ODE is of the form d d R (cid:16) XdX d R (cid:17) = M · (cid:16) XdX d R (cid:17) + ⎛ ⎜⎝ 0 3 ( 1 + ρ ) 2 SI p (cid:16) ˜ I p I p − 1 (cid:17) exp ( − 2 X ) ⎞ ⎟⎠ where M = (cid:3) 0 1 − ω 2 0 (cid:4) , ω 2 = 3 ( 1 + ρ ) 2 SI p (cid:3) exp ( − X ) − exp ( − 2 X ) X (cid:4) We then consider ranges of R such that ˜ I p ∈ ( 0 , 1 ) which requires that 0 < η S 2 − ρ 2 γ 2 S < 3 γ 2 ( 1 + ρ ) 2 . 123 60 Page 42 of 59 H . Berestycki et al . We interpret this relation as a necessary condition for a plateau to exist . Assume moreover that | ρ | (cid:19) 1 and I p is such that (cid:20) (cid:20) (cid:20) (cid:20)(cid:20) ˜ I p I p − 1 (cid:20) (cid:20) (cid:20) (cid:20)(cid:20) (cid:19) 1 . Then , the complex eigenvalues of M are purely imaginary numbers which means that I oscillates around I p in logarithmic scale . Thus we ﬁnd oscillations in this plateau regime . For the above heuristic arguments to make sense , we surmise that in a plateau regime , S varies more slowly than the oscillations of X . Further mathematical devel - opments need to be achieved to rigorously justify this reasoning . 6 Higher order Gaussian based model 6 . 1 Model derivation An intermediate complexity model , which covers the case of the aforementioned Gaussianbasedmodel , canbederivedusingmathematicalpropertiesoftheeigenvalues and eigenfunctions of the linear operator associated with Model ( 12 ) . Incidentally , such operator coincides with the Schrödinger operator associated with the harmonic oscillator potential : − ψ (cid:12)(cid:12) n ( A ) + A 2 ψ n ( A ) = ( 2 n + 1 ) ψ n ( A ) , A ∈ R . The eigenfunctions write in terms of the so called Hermite polynomials : ψ n ( A ) = H n ( A ) exp (cid:7) − A 2 / 2 (cid:8) / α n , where H n ( A ) = ( − 1 ) n exp ( A 2 ) d n d A n exp ( − A 2 ) , α n = ( 2 n − 1 n ! √ π ) 1 / 2 α n being taken in such a way that for all n ∈ N (cid:2) + ∞ 0 ψ n ( A ) 2 d A = 1 . 123 Epidemic modeling with heterogeneity and social diffusion Page 43 of 59 60 Such eigenfunctions satisfy the properties √ 2 n ψ n − 1 ( A ) = A ψ n ( A ) + ψ (cid:12) n ( A ) , ψ (cid:12) n ( A ) = (cid:21) n 2 ψ n − 1 ( A ) − (cid:21) n + 1 2 ψ n + 1 ( A ) , A ψ n ( A ) = (cid:21) n 2 ψ n − 1 ( A ) + (cid:21) n + 1 2 ψ n + 1 ( A ) , so that A ψ (cid:12) n = n ψ n − A 2 ψ n + (cid:31) n ( n − 1 ) ψ n − 2 , and ( A ψ n ( A ) ) (cid:12) = ( n + 1 ) ψ n − A 2 ψ n + (cid:31) n ( n − 1 ) ψ n − 2 . Because we restrict to A ∈ ( 0 , + ∞ ) , we only consider the case of even integers n = 2 k , k ∈ N . As a matter of fact , ψ 2 k ( resp . ψ 2 k + 1 ) are even functions ( resp . odd functions ) : in order to comply with homogeneous Neumann boundary conditions on A = 0 , n needs to be even . Let us also observe that (cid:2) + ∞ 0 ψ 2 k ( A ) d A = ˜ α k , where ˜ α k = (cid:3) ( 2 k ) ! √ π 2 2 k ( k ! ) 2 (cid:4) 1 / 2 for all k ≥ 1 . Then , in order to represent solutions of ( 11 ) we decompose S ( t , a ) as a ﬁnite sum of ( ψ 2 k ) k ∈ N ) eigenfunctions : S ( t , a ) = K k = 0 S k ( t ) ψ 2 k (cid:3) a λ ( t ) (cid:4) 1 λ ( t ) . We provide detailed computations below ( where A = a / λ ) ∂ t S ( t , a ) = K k = 0 (cid:16) ˙ S k λ − S k ˙ λ λ 2 (cid:17) ψ 2 k ( A ) − S k ˙ λ λ 2 A ψ (cid:12) 2 k ( A ) , − (cid:7) β 0 + a 2 β 1 (cid:8) I S = − K k = 0 (cid:7) β 0 + λ 2 A 2 β 1 (cid:8) I S k λ ψ 2 k ( A ) , − ∂ a ( μ b S ) = μ 0 λ K k = 0 ∂ A ( A ψ 2 k ( A ) ) S k , D ∂ 2 a S = D λ 3 K k = 0 S n ψ (cid:12)(cid:12) 2 k ( A ) . 123 60 Page 44 of 59 H . Berestycki et al . Therefore , one has K k = 0 (cid:16) ˙ S k λ − S k ˙ λ λ 2 − 2 k S k ˙ λ λ 2 (cid:17) ψ 2 k ( A ) + K k = 0 S k ˙ λ λ 2 A 2 ψ 2 k ( A ) − K k = 0 (cid:31) 2 k ( 2 k − 1 ) S k ˙ λ λ 2 ψ 2 k − 2 ( A ) = K k = 0 (cid:16) − β 0 I S k λ + ( 2 k + 1 ) μ 0 S k λ − ( 4 k + 1 ) DS k λ 3 (cid:17) ψ 2 k ( A ) + K k = 0 (cid:16) − β 1 λ 2 I S k λ + DS k λ 3 − μ 0 S k λ (cid:17) A 2 ψ 2 k ( A ) + K k = 0 (cid:31) 2 k ( 2 k − 1 ) μ 0 S k λ ψ 2 k − 2 ( A ) . Identifying for each k ∈ { 1 . . . K } the coefﬁcients in front of A 2 ψ 2 k ( A ) then gives ˙ λ λ = − β 1 I λ 2 − μ 0 + D λ 2 . On the other hand , the dynamics of the K coefﬁcients is given by ˙ S k λ − ( 2 k + 1 ) S k ˙ λ λ 2 − (cid:31) 2 ( k + 1 ) ( 2 k + 1 ) S k + 1 ˙ λ λ 2 = − β 0 I S k λ + ( 2 k + 1 ) μ 0 S k λ − ( 4 k + 1 ) DS k λ 3 + (cid:31) 2 ( k + 1 ) ( 2 k + 1 ) μ 0 S k + 1 λ , for k = 0 , . . . , K − 1 and for k = K ˙ S K λ − ( 2 K + 1 ) S K ˙ λ λ 2 = − β 0 I S K λ + ( 2 K + 1 ) μ 0 S K λ − ( 4 K + 1 ) DS k λ 3 . Hence for k = 0 , . . . , K − 1 ˙ S k = − β 0 I S k − ( 2 k + 1 ) β 1 λ 2 I S k − 2 k DS k λ 2 + (cid:31) 2 ( k + 1 ) ( 2 k + 1 ) S k + 1 (cid:3) D λ 2 − β 1 I λ 2 (cid:4) , 123 Epidemic modeling with heterogeneity and social diffusion Page 45 of 59 60 and for k = K ˙ S K = − β 0 I S K − ( 2 K + 1 ) β 1 λ 2 I S K − 2 K DS K λ 2 . ( 34 ) In other words , one has d S dt = − (cid:7) β 0 + β 1 λ 2 (cid:8) I S + (cid:3) D λ 2 − β 1 I λ 2 (cid:4) G 1 · S − (cid:3) 2 β 1 I λ 2 + 2 D λ 2 (cid:4) G 0 · S ( 35 ) where S = ⎡ ⎢⎣ S 0 . . . S K ⎤ ⎥⎦ , G 0 = Diag ( 0 , 1 , . . . , K − 1 , K ) , G 1 = ⎡ ⎢⎢⎢⎢⎢⎢⎢⎣ 0 ν 0 . . . . . . . . . ν K − 2 . . . ν K − 1 0 ⎤ ⎥⎥⎥⎥⎥⎥⎥⎦ where ν k = (cid:31) 2 ( k + 1 ) ( 2 k + 1 ) . The dynamics of infected follows from the computation (cid:2) + ∞ 0 (cid:7) β 0 + β 1 λ 2 A 2 (cid:8) ψ 2 k ( A ) d A = ˜ α k (cid:7) β 0 + λ 2 ( 4 k + 1 ) β 1 (cid:8) , so that dI dt = β I K k = 0 ˜ α k S k − γ I . where β = β 0 + β 1 λ 2 (cid:16) 1 + 4 ’ Kk = 0 k ˜ α k S k ’ Kk = 0 ˜ α k S k (cid:17) . ( 36 ) Note that contrary to the case K = 0 , it is more convenient to keep λ as a variable rather than β . To summarize , denoting S = K k = 0 ˜ α k S k , 123 60 Page 46 of 59 H . Berestycki et al . the generalized model expresses as ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪ ⎪⎪⎪⎩ d S dt = − β I S , dI dt = I (cid:5) β S − γ (cid:6) , d R dt = γ I , d λ dt = − β 1 I λ 3 − μ 0 λ + D λ , ( 37 ) where β is deﬁned by ( 36 ) and the dynamics of ( S k ) k = 0 . . . K is given by ( 35 ) . The initial conditions read as : ⎧⎪⎨ ⎪⎩ λ ( 0 ) = 1 , S k ( 0 ) = S k , 0 , k = 0 . . . K I ( 0 ) = I 0 ≥ 0 , ( 38 ) In such a way that I 0 + k = 0 , . . . , K ˜ α k S k , 0 = 1 . We claim that Theorem 5 Let ( S k ) k = 0 . . . K , I and R be solution of ( 37 ) , ( 36 ) , ( 35 ) with initial condi - tions ( 38 ) . Assume that μ 0 > 0 and D > 0 . Then , as time t goes to + ∞ , λ ( t ) → λ ∞ = (cid:30) D μ 0 > 0 , S 0 ( t ) → S ∞ 0 > 0 , S k ( t ) → 0 , k ≥ 1 , I ( t ) → 0 , S ( t ) → S ∞ = ˜ α 0 S ∞ 0 ∈ ( 0 , N ) , R ( t ) → R ∞ ∈ ( 0 , N ) , where S ∞ + R ∞ = N . Proof Since most of the arguments are similar to the case K = 1 , we only sketch the proof . First the convergence of S , I and R to limit values S ∞ , 0 and R ∞ follows from the same arguments . Next , the convergence of λ ( t ) to λ ∞ is also identical to the case K = 1 . Then , the convergence of S K ( t ) to 0 follows from ( 34 ) . The case k = 0 . . . K − 1 follows from the following lemma : Lemma 1 Let t (cid:4)→ x ( t ) be deﬁned over R + satisfy ˙ x ( t ) = − c ( t ) x ( t ) + b ( t ) , for some c ( t ) > 0 and b ( t ) such that ( c ( t ) , b ( t ) ) → ( c ∞ , b ∞ ) with c ∞ > 0 . Then x ( t ) → 0 as t goes to + ∞ . 123 Epidemic modeling with heterogeneity and social diffusion Page 47 of 59 60 Sketch of proof : replacing x by x − b ∞ / c ∞ , one may assume that b ∞ = 0 . Then , x ( t ) = exp (cid:3) − (cid:2) t 0 c ( s ) ds (cid:4) x 0 + (cid:2) t 0 exp (cid:3) − (cid:2) t s c ( τ ) d τ (cid:4) b ( s ) ds . The ﬁrst term in the above right hand side converges to zero because of asymptotic properties of c ( t ) , and the second one can be estimated for instance by splitting the integral over ( 0 , T ) and ( T , t ) for t ≥ T > 0 . (cid:15)(cid:16) Let us ﬁnally observe that the limit transmission rate satisﬁes β ∞ = β 0 + β 1 D μ 0 , which is the same as the average limit transmission rate β ∞ associated with solutions of the partial differential equation model . 6 . 2 Numerical simulations WemakecomparisonsbetweensolutionsofthefullpartialdifferentialequationsmodelandsolutionsobtainedfromOrdinaryDifferentialEquationsoforderKasderivedinthepreviousSect . 6 . 1 . The initial proﬁle of susceptible individuals in terms of trait variable a ∈ R + is taken as follows : S 0 ( a ) = S 0 a exp ( − a ) , with S 0 = 1 − I 0 and initial rate of infected individuals I 0 = 3 × 10 − 5 ( considering N = 1 ) . The transmission rate model parameters are β 0 = 0 . 01 days − 1 , β 1 = 0 . 18 days − 1 Drift and diffusion coefﬁcients are equal to μ 0 = 5 × 10 − 3 days − 1 , D = 0 . 08 days − 1 , and γ = 0 . 25 days − 1 , i . e . R = 2 . 89 . The simulation is performed over time interval [ 0 , 200 ] ( in days ) for both PDE or ODE approaches . Space discretization indicates that 200 points in space are enough to achieve reasonable convergence of solutions of the full PDE system . Simulations of the ODE system associated with K = 0 , 1 , 2 , 3 , 4 , 7 are illustrated in Fig . 3 above . 2 We observe a somehow monotonous convergence behavior when K becomes large enough , in particular for the maximum level of I ( t ) and time for such maximum and the period of oscillations . Further investigations will be needed to assess the epidemiolog - ical relevance of such higher order approximation models , which allows us to consider general initial probability densities f 0 beyond truncated Gaussian distributions . 2 The corresponding python code and parameters are available at https : / / github . com / bdsbds / 20220819 _ JMB / . 123 60 Page 48 of 59 H . Berestycki et al . Fig . 3 Rate of infected individuals I ( t ) / N solution of ODE for several orders of approximations K = 0 , 1 , 2 , 3 , 4 and 7 , and PDE solution ( black curve ) 7 Discussion 7 . 1 Main results We have derived here a system describing the evolution of epidemics taking into account the behavioral heterogeneity and variability of the population of susceptibles . Individual behaviors are characterized by a compound risk variable a ∈ R + associated with the susceptibility with respect to the epidemic . Larger values of a correspond to increasing exposure to contagion , whereas low values are associated with little exposed behaviors . Thus , the population of susceptibles is structured by this variable a : S = S ( t , a ) , and the classical transmission coefﬁcient β = β ( a ) is an increasing function of a . Rather than working with S ( t , a ) , we found it more revealing to write the equations in terms of the total population S ( t ) = (cid:9) ∞ 0 S ( t , a ) da and the probability distribution of the trait a in the population : f ( t , a ) = S ( t , a ) / S ( t ) . We ﬁrst expressed the effect of the epidemics on the distribution f ( t , a ) as a trans - port equation . We also assumed that this distribution is subject to random ﬂuctuations according to a drift - diffusion stochastic process . Combining these two effects , we derived a Fokker – Planck equation governing the evolution of the distribution f . This equation is coupled with the evolution equations for S ( t ) and I ( t ) , the total numbers of infected . We then derived a system , that we call the SfIR system , standing for the variables S ( t ) , f ( t , a ) , I ( t ) and the population of recovered R ( t ) . This new system is non - linear and non - local and combines a partial differential equation of Fokker – Planck type and ordinary differential equations for S and I . The SfIR model is a natural extension of the classical SIR compartmental model to populations when considering heterogeneity and variability of individual behaviors . 123 Epidemic modeling with heterogeneity and social diffusion Page 49 of 59 60 Numerical simulations of this system showed that it exhibits some of the trademark dynamics of the unfolding of epidemics such as the current COVID - 19 epidemic . Namely , we observed plateaus , shoulders , oscillations and rebounds . These aspects do not emerge in the classical SIR model and can be viewed as a consequence of including individual behaviors , heterogeneity , and variability . We then studied the question of large time behavior for this system . There is a long - standing literature devoted to this question in the case of the scalar Fokker – Planck equation by itself which turns out to be rather delicate . This new context of a coupled non - linear and non - local system further complicates matters and requires new developments on this question . Under some assumptions on the model coefﬁcients , i . e . transmission rate , drift and diffusion , we were able to prove the convergence of the probability distribution f ( t , · ) to a unique equilibrium distribution f ∞ . This result extends the classical convergence to equilibrium results for solutions to Fokker – Planck equations in the absence of epidemic coupling , under classical Bakry – Emery ( Bakry and Émery 1985 ) hyper - contractivity assumptions on drift and diffusion coefﬁcients . Wepaidparticular attentiontothecaseof constant diffusion D , linear dependenceof the drift with respect to a and afﬁne dependence of the transmission rate with respect to a 2 . We showed that this framework is associated with an Ornstein - Uhlenbeck process for the ﬂuctuations of a . In this case , we further derived a model of reduced complexity . This ODE system was obtained by looking for self - similar solutions of the equation governing the distribution f involving Gaussian probability distributions truncated over R + . We showed that this ODE system even though quite simple still captures epidemic patterns such as rebounds , shoulders , and plateaus . We also obtained higher order ODE models approximating the solutions of the PDE system through spectral type methods involving the eigenfunctions of some associated operator akin to the quantum harmonic oscillator . Furthermore , we illustrated the convergence to the PDE solution in the presence of oscillations as the model order increases . Finally , we stated and proved some mathematical properties of the reduced com - plexity ODE system such as large time behavior depending on various assumptions on the model coefﬁcients . 7 . 2 Perspectives The derivation of the SfIR model , and our ﬁrst analytical results naturally open many perspectives , both in the epidemiological modeling and in the mathematical analysis of these systems . The present paper is a ﬁrst stage of a research program on epidemi - ological modeling in this vein . The new system we introduced here raises a number of open mathematical ques - tions . To start with , the existence and uniqueness of the solution to the Cauchy problem associated with this system is still open . As already noted , this system combines the difﬁculties of being non - linear and non - local . The extension of the convergence to equilibrium result by relaxing the assumptions and allowing as general a framework as possible is a natural question . In particular , deriving regularity and integrability of solutions for a wide class of initial data is open . It would be interesting to fur - 123 60 Page 50 of 59 H . Berestycki et al . ther describe the total number of infected individuals after the epidemic has subsided and how this number depends on the various parameters . More generally , it would be desirable to better understand the qualitative properties of dependence of solutions and their ﬁnal states with respect to the parameters . Further mathematical developments are needed to rigorously justify this reasoning and to explore the qualitative basis for and quantitative levels of oscillations . From an epidemiological point of view , one is naturally led to investigate exten - sions of the approach developed here . First , our model here rested on the assumption of homogeneous mixing . It would be interesting to expand our approach to the more com - plex and more realistic framework of preferential mixing ( Feng 2014 ) . Other natural extensions of the SIR model take into account additional epidemiological phenomena , e . g . , loss of immunity and subsequent reinfection ( Lavine et al . 2021 ) and the inclusion of an explicit exposed period before contagion as in SEIR models or via the use of realistic generation interval distributions ( Park et al . 2022 ) . Second , as observed in the current COVID - 19 pandemic , the succession of vari - ants plays a major role in the unfolding of epidemics . It is therefore natural to use the SfIR methodology in the presence of variants . Such an approach could be used to model competition phenomenon between variants characterized by different param - eters regarding transmission rate β and average infection duration γ − 1 . In all these frameworks , it is natural to seek models of reduced complexity . Third , the recent COVID - 19 pandemic also showed the importance of “awareness” and “fatigue” phenomena , which were modeled in Weitz et al . ( 2020a ) via a top - down approach . In the spirit of that work , embedding state - and / or time - dependence in the PDE framework or in the ODE model parameters is likely to enrich the capacity of SfIR modeling approach to capture more complex global phenomena . Speciﬁcally , we note that in the SfIR PDE framework , awareness - driven changes in behavior can dynamically shift susceptibility distributions in a way that is different than contagion - driven sculpting—evaluating the combination of both sculpting and shifting could lead to productive avenues for both theory and model - data integration . Finally , combining the SfIR modeling approach with spatial diffusion of infection is undoubtedly a challenging but very relevant issue to address in the future . One may contemplate combining the models we have introduced here for a single location to include spatial diffusion ( Roques et al . 2020 ) or coupling between locations that may differ in their response policies ( Kortessis et al . 2020 ) . In doing so , recent measurement campaigns of SARS - CoV - 2 in wastewater in the framework of surveillance networks throughout the world is a motivation to extend our modeling approach to Wastewa - ter Based Epidemiology—as a means to link ongoing changes in local incidence to forecasting and mitigation . Acknowledgements This work was supported in part by the Chaires Blaise Pascal program of the Île - de - France region ( to JSW ) . Declarations Conﬂictofinterest The authors have no conﬂict of interest to declare that are relevant to the content of this article . 123 Epidemic modeling with heterogeneity and social diffusion Page 51 of 59 60 OpenAccess ThisarticleislicensedunderaCreativeCommonsAttribution4 . 0InternationalLicense , which permits use , sharing , adaptation , distribution and reproduction in any medium or format , as long as you give appropriate credit to the original author ( s ) and the source , provide a link to the Creative Commons licence , and indicate if changes were made . The images or other third party material in this article are included in the article’s Creative Commons licence , unless indicated otherwise in a credit line to the material . If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use , you will need to obtain permission directly from the copyright holder . To view a copy of this licence , visit http : / / creativecommons . org / licenses / by / 4 . 0 / . A Appendix : Parsimonious model with more general probability distribution proﬁles Section 4 focused on Gaussian distribution proﬁles . We consider here more general proﬁles of susceptible individuals for which self similar solutions exist . A . 1 Assumptions We make the following assumptions : • The initial distribution f 0 of susceptible population is described in terms of the continuous risk variable a ∈ R + S 0 ( a ) = S 0 f 0 ( a ) with f 0 ( a ) = 1 λ 0 φ ( a λ 0 ) , where for some given real k > 0 φ ( a ) = k − 1 / k exp (cid:3) − a k k (cid:4) / (cid:22) (cid:3) 1 k + 1 (cid:4) , ( 39 ) where (cid:22) denotes the classical Gamma function (cid:22) ( z ) = (cid:2) + ∞ 0 x z − 1 exp ( − x ) dx . • Diffusion coefﬁcient depending on a and t σ 2 2 = D ( t ) a 2 − k for some positive function t (cid:4)→ D ( t ) . • The transmission rate function β is a power function of a β ( a ) = β 0 + β 1 a k . ( 40 ) • Background drift effect μ b ( t , a ) = − μ 0 ( t ) a k − 1 + D ( t ) ( k − 2 ) a 2 − k . 123 60 Page 52 of 59 H . Berestycki et al . Note again that μ 0 ( t ) may be any non - negative function of time only , and that ( unless k = 2 ) an extra diffusion dependent drift is also needed . • The susceptible population S ( t , a ) is assumed to be expressed as a self - similar proﬁle S ( t , a ) = S ( t ) λ ( t ) φ (cid:3) a λ ( t ) (cid:4) , ( 41 ) for some functions of time t (cid:4)→ S ( t ) and t (cid:4)→ λ ( t ) such that S ( 0 ) = S 0 and λ ( 0 ) = λ 0 . Let us observe at this stage that φ (cid:12) ( A ) = − A k − 1 φ ( A ) . A . 2 Derivation We deduce from the ﬁrst equation of ( 11 ) that (cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) φ ( A ) − A φ (cid:12) ( A ) ˙ λ S λ 2 = − I (cid:5) β 0 + β 1 λ k A k (cid:6) S N λ φ ( A ) + μ 0 S λ d [ A φ ( A ) ] d A + DS ( k − 2 ) λ k + 1 d ( A 1 − k φ ( A ) ) d A + DS λ k + 1 d 2 ( A 2 − k φ ( A ) ) d A 2 . Observing that d [ A φ ( A ) ] d A = φ ( A ) − A k φ ( A ) , d ( A 1 − k φ ( A ) ) d A = ( 1 − k ) A − k φ ( A ) − φ ( A ) , and d 2 ( A 2 − k φ ( A ) ) d A 2 = ( 2 − k ) ( 1 − k ) A − k φ ( A ) + ( k − 3 ) φ ( A ) + A k φ ( A ) , one concludes that φ ( A ) (cid:22)(cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) + I β 0 S N λ − μ 0 S λ + DS λ k + 1 (cid:23) = A k φ ( A ) (cid:22) − ˙ λ S λ 2 − I β 1 λ k S N λ − μ 0 S λ + DS λ k + 1 (cid:23) ( 42 ) 123 Epidemic modeling with heterogeneity and social diffusion Page 53 of 59 60 We therefore require that the two time dependent functions on the left and right hand side of ( 27 ) are equal to zero : ˙ λ λ = − I β 1 λ k N − μ 0 + D λ k ( 43 ) (cid:16) ˙ S λ − ˙ λ S λ 2 (cid:17) + I β 0 S N λ − μ 0 S λ + DS λ k + 1 = 0 ( 44 ) hence substituting ( 27 ) into ( 27 ) , one gets on the one hand ˙ S S = − I (cid:5) β 0 + β 1 λ k (cid:6) N . ( 45 ) On the other hand , the second equation of ( 11 ) leads to dI dt = I (cid:16) S ( β 0 + β 1 λ k ) N − γ (cid:17) ( 46 ) As a consequence , the derived model writes as follows ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪ ⎪ ⎩ dS dt = − SI (cid:5) β 0 + β 1 λ k (cid:6) N d λ dt = − I β 1 λ k + 1 N − μ 0 λ + D λ dI dt = SI ( β 0 + β 1 λ k ) N − γ I d R dt = γ I , ( 47 ) with initial conditions S ( 0 ) = S 0 , λ ( 0 ) = λ 0 , I ( 0 ) = I 0 and R ( 0 ) = 0 . A . 3 Dynamics of the average transmission rate ˇ Le us recall the equation governing the probability density function f ( t , a ) = S ( t , a ) / S ( t ) of susceptible individuals ∂ t f ( t , a ) = − I ( t ) N f ( t , a ) (cid:5) β ( a ) − β ( t ) (cid:6) − ∂ a ( μ b ( t , a ) f ( t , a ) ) + ∂ 2 aa (cid:7) Da 2 − k f ( t , a ) (cid:8) . Then , we introduce the notation ψ ( t ) = (cid:2) R + ψ ( a ) f ( t , a ) da , 123 60 Page 54 of 59 H . Berestycki et al . so that one has β ( t ) = (cid:2) R + β ( a ) f ( t , a ) da Var ( β ) ( t ) = β 2 ( t ) − β ( t ) 2 . Then , inserting the self similar proﬁles into ( 4 . 3 ) , f ( t , a ) = λ ( t ) − 1 φ ( a / λ ( t ) ) , so that one gets β ( t ) = β 0 + β 1 λ k . β 2 ( t ) = (cid:2) R + ( β 20 + 2 β 0 β 1 λ k A k + λ 2 k β 21 A 2 k ) φ ( A ) dA = β 20 + 2 β 0 β 1 λ k + ( k + 1 ) β 21 λ 2 k . The variance Var ( β ) ( t ) can then be expressed as Var ( β ) ( t ) = k β 21 λ 2 k ( t ) = k ( β − β 0 ) 2 It means that the dynamics of t (cid:4)→ λ ( t ) is directly linked to the average value of the β parameter . Therefore , the equation λ can be replaced by the dynamics of the average transmission rate β in System ( 27 ) d β dt = − k I N ( β − β 0 ) 2 − k μ 0 ( β − β 0 ) + kD β 1 λ k − 2 . Therefore , ( 27 ) becomes ⎧⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪ ⎨ ⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩ dS dt = − β S I N d β dt = − k I N ( β − β 0 ) 2 − k μ 0 ( β − β 0 ) + kD β 3 − k 1 ( β − β 0 ) k − 2 dI dt = β S I N − γ I d R dt = γ I , ( 48 ) with initial conditions I ( 0 ) = I 0 ∈ ( 0 , N ) , S ( 0 ) = N − I 0 , R ( 0 ) = 0 and β ( 0 ) = β 0 ≥ β 0 . B Appendix : Csiszár – Kullback – Pinsker inequality One of the key estimate in the proof of convergence to equilibrium of the distribution f in Theorems 2 and 4 is the estimate of the L 1 ( R + ) distance of two probability distributions in terms of the associated relative entropy . This is known as Csiszár – Kullback – Pinsker’s inequality : 123 Epidemic modeling with heterogeneity and social diffusion Page 55 of 59 60 Theorem 6 ( Csiszár – Kullback – Pinsker ) Let f , g be two non - negative real functions in L 1 ( R + ) with (cid:14) f (cid:14) 1 = (cid:14) g (cid:14) 1 = 1 . It holds that (cid:14) f − g (cid:14) 21 ≤ 2 (cid:2) R + f log f g . ( 49 ) For the readers convenience , we provide here a simple and elegant proof due to J . A . Canizo ( https : / / canizo . org / page / 28 ) . Proof A preliminary step is to observe that for all r ≥ 0 , one has : (cid:23) ( r ) : = r log r − r + 1 ≥ 3 2 ( r − 1 ) 2 r + 2 . Then , such estimate combined by Cauchy - Schwarz inequality leads (cid:14) f − g (cid:14) 21 = (cid:3)(cid:2) R + (cid:20)(cid:20)(cid:20)(cid:20) f g − 1 (cid:20)(cid:20)(cid:20)(cid:20) g (cid:4) 2 ≤ (cid:2) R + (cid:3) f g − 1 (cid:4) 2 f g + 2 g (cid:2) R + (cid:3) f g + 2 (cid:4) g , = 3 (cid:2) R + (cid:3) f g − 1 (cid:4) 2 f g + 2 g ≤ 2 (cid:2) R + (cid:23) (cid:3) f g (cid:4) g = 2 (cid:2) R + f log f g . (cid:15)(cid:16) C Appendix : Decay at inﬁnity of solutions of the SfIR system We consider the System ( 12 ) and focus here on the case when μ b and D do not depend on time t . The aim of this appendix is to provide some decay properties of solutions f of System ( 12 ) which allows us to justify multiple integration by parts and other formal computations we carried in Sect . 3 , at least in the Gaussian like case . We leave the general case open . Assuming that conditions ( H 2 ) and ( H 4 ) hold , that is that diffusion is non - degenerate and the probability density f ∞ decreases at inﬁnity at least as a Gaussian distribution . In this appendix , in addition to the assumptions of Sect . 3 , we suppose that the following conditions hold . First , the diffusion D is bounded : D ( a ) ≤ D ∗ < + ∞ for all a ∈ R + . The transmission rate β is growing at most linearly in a 2 : β ( a ) ≤ C ( 1 + a 2 ) for all a ∈ R + 123 60 Page 56 of 59 H . Berestycki et al . ( where here and in the following C denotes a generic positive constant ) . Lastly , the equilibrium f ∞ satisﬁes : (cid:20)(cid:20)(cid:20)(cid:20) f (cid:12)∞ ( a ) f ∞ ( a ) (cid:20)(cid:20)(cid:20)(cid:20) = (cid:20)(cid:20) α (cid:12) ( a ) (cid:20)(cid:20) ≤ C ( 1 + a ) for all a ∈ R + . In this framework , we have the following a priori estimate . Theorem 7 Assume that ( H 2 ) , ( H 4 ) and the previous assumptions on D , β , f ∞ hold . Furthermore , suppose that the initial proﬁle of susceptibles S 0 satisﬁes S 0 ∈ L 1 ( R + ) , (cid:2) R + S 0 ( a ) da ≤ 1 , and 0 ≤ S 0 ( a ) ≤ M f ∞ ( a ) < + ∞ for a . e . a ∈ R + for some positive constant M > 0 . Then , the solution S of ( 12 ) is bounded . More precisely , it satisﬁes : 0 ≤ S ( t , a ) ≤ M f ∞ ( a ) < + ∞ for all ( t , a ) ∈ R + × R + . Proof This result is a consequence of the maximum principle applied to v where v ( t , a ) = S ( t , a ) / f ∞ ( a ) . The evolution equation on v writes as f ∞ ( a ) ∂v ( t , a ) ∂ t + β ( a ) I ( t ) N f ∞ ( a ) v ( t , a ) = ∂ ∂ a (cid:3) D ( a ) f ∞ ( a ) ∂v ( t , a ) ∂ a (cid:4) for ( t , a ) ∈ R + × R + , ∂v ( t , 0 ) ∂ a = 0 for t ∈ R + . ( 50 ) Hence , ∂v ( t , a ) ∂ t + β ( a ) I ( t ) N v ( t , a ) − ∂ ∂ a (cid:3) D ( a ) ∂v ( t , a ) ∂ a (cid:4) = D ( a ) f (cid:12)∞ ( a ) f ∞ ( a ) ∂v ( t , a ) ∂ a for ( t , a ) ∈ R + × R + , ∂v ( t , 0 ) ∂ a = 0 for t ∈ R + . ( 51 ) Then , by the parabolic maximum principle in R + , since v ( 0 , a ) ≤ M it follows that v ( t , a ) ≤ M on R + for all t > 0 . Indeed , we use the fact that for some positive 123 Epidemic modeling with heterogeneity and social diffusion Page 57 of 59 60 constant C (cid:20)(cid:20)(cid:20)(cid:20) f (cid:12)∞ ( a ) f ∞ ( a ) (cid:20)(cid:20)(cid:20)(cid:20) ≤ C ( 1 + a ) and β ( a ) ≤ C ( 1 + a 2 ) . (cid:15)(cid:16) Let us observe that it means that the probability distribution f ( t , a ) is bounded from above by a distribution proportional to f ∞ , i . e . 0 ≤ f ( t , a ) ≤ M S ( t ) f ∞ ( a ) for ( t , a ) ∈ ( 0 , T ) × R + , which leads to the justiﬁcation of formal computations performed in Sect . 3 since S ( t ) decreases with t and remains positive . Note also that we are able to obtain H 1 type regularity properties on f or more precisely on v = S / f ∞ Theorem 8 Assuming ( H 2 ) and ( H 4 ) , and that the initial proﬁle of susceptibles S 0 is such that v 0 = S 0 / f ∞ satisﬁes v 0 ∈ L 2 ( R + ; ν ) where d ν ( a ) = f ∞ ( a ) da . Then , the solutions v of Eq . ( 50 ) satisfy v ∈ L ∞ ( R + ; L 2 ( R + ; ν ) ) , ∂ a v ∈ L 2 ( R + ; L 2 ( R + ; ν ) ) and 1 2 sup t ≥ 0 (cid:14) v ( t , · ) (cid:14) 2 L 2 ( R + ; ν ) + D ∗ (cid:2) + ∞ 0 ds * * * * ∂v ( s , · ) ∂ a * * * * 2 L 2 ( R + ; ν ) ≤ 1 2 (cid:14) v 0 (cid:14) 2 L 2 ( R + ; ν ) . Proof This result is the consequence of multiplication of Eq . ( 50 ) by v and integration by parts , using the fact that v , β and I are non - negative . (cid:15)(cid:16) We leave open the derivation of such estimates on the behavior at inﬁnity in the more general case of System ( 12 ) . References Almeida L , Bliman PA , Nadin G , Perthame B , Vauchelet N ( 2021 ) Final size and convergence rate for an epidemic in heterogeneous population . Math Models Methods Appl Sci 31 : 1021 – 1051 ArinoJ , DavisJR , HartleyD , JordanR ( 2005 ) Amulti - species epidemic modelwith spatial dynamics . Math Med Biol 22 ( 2 ) : 129 – 142 Arnold A , Markowich P , Toscani G , Unterreiter A ( 2001 ) On convex Sobolev inequalities and the rate of convergence to equilibrium for Fokker - Planck type equations . Commun Partial Differ Equ 26 ( 1 – 2 ) : 43 – 100 Arthur RF et al ( 2021 ) Adaptive social contact rates induce complex dynamics during epidemics . PLoS Comput Biol 17 ( 2 ) : e1008639 Auchincloss AH , Diez Roux AV ( 2008 ) A new tool for epidemiology : the usefulness of dynamic - agent models in understanding place effects on health . Am J Epidemiol 168 ( 1 ) : 1 – 8 123 60 Page 58 of 59 H . Berestycki et al . Bakry D ( 1994 ) L’hypercontractivité et son utilisation en théorie des semigroupes . Lectures on Probability Theory , pp 1 – 114 Bakry D , Émery M ( 1985 ) Diffusions hypercontractives . Séminaire de probabilités de Strasbourg 19 : 177 – 206 Bakry D , Gentil I , Ledoux M ( 2014 ) Analysis and geometry of Markov diffusion operators Grundlehren der mathematischen Wissenschaften . Springer , Cham Béraud G , Kazmercziak S , Beutels P , Levy - Bruhl D , Lenne X , Mielcarek N , Yazdanpanah Y , Boëlle PY , Hens N , Dervaux B ( 2015 ) The French connection : the ﬁrst large population - based contact survey in France relevant for the spread of infectious diseases . PLoS ONE 10 ( 7 ) : 1 – 22 Berestycki H , Desjardins B , Heintz B , Oury JM ( 2021 ) Plateaus , rebounds and the effects of individual behaviours in epidemics . Nat Sci Rep 11 : 2045 – 2322 Brauer F ( 2005 ) The Kermack - McKendrick epidemic model revisited . Math Biosci 198 ( 2 ) : 119 – 131 Brauer F ( 2011 ) A simple model for behavior change in epidemics . BMC Public Health 11 ( 1 ) : S3 Brauer F ( 2019 ) The ﬁnal size of a serious epidemic . Bull Math Biol 81 ( 3 ) : 869 – 877 BrittonT , BallF , TrapmanP ( 2020 ) Amathematicalmodelrevealstheinﬂuenceofpopulationheterogeneity on herd immunity to SARS - CoV - 2 . Science 369 ( 6505 ) : 846 – 849 Cañizo JA . The Csiszár - Kullback inequality . https : / / canizo . org / page / 28 Courtade TA , Fathi M ( 2020 ) Stability of the Bakry - Emery theorem on R n . J Funct Anal 279 ( 2 ) : 108523 Csiszár I ( 1967 ) Information - type measures of difference of probability distributions and indirect observa - tions . Studia Sci Math Hungar 2 : 299 – 318 Di Domenico L , Pullano G , Sabbatini CE , Boëlle P - Y , Colizza V ( 2020 ) Impact of lockdown on COVID - 19 epidemic in Ile - de - France and possible exit strategies . BMC Med 18 ( 1 ) : 1 – 13 Dimarco G , Perthame B , Toscani G , Zanella M ( 2021 ) Kinetic models for epidemic dynamics with social heterogeneity . J Math Biol 83 ( 1 ) : 1 – 32 Dolbeault J , Turinici G ( 2020 ) Heterogeneous social interactions and the COVID - 19 lockdown outcome in a multi - group SEIR model . Math Model Nat Phenom 15 : 36 Dolbeault J , Turinici G ( 2021 ) Social heterogeneity and the COVID - 19 lockdown in a multi - group SEIR model . Comput Math Biophys 9 ( 1 ) : 14 – 21 Eksin C , Paarporn K , Weitz JS ( 2019 ) Systematic biases in disease forecasting - the role of behavior change . Epidemics 27 : 96 – 105 Feng Z ( 2014 ) Applications of epidemiological models to public health policymaking : the role of hetero - geneity in model predictions . World Scientiﬁc , Singapore Ferguson NM , Laydon D , Nedjati - Gilani G , Imai N , Ainslie K , Baguelin M , Bhatia S , Boonyasiri A , Cucunubá Z , Cuomo - Dannenburg G et al ( 2020 ) Impact of non - pharmaceutical interventions ( NPIs ) to reduce COVID - 19 mortality and healthcare demand Frank TD ( 2001 ) Lyapunov and free energy functionals of generalized Fokker - Planck equations . Phys Lett A 290 ( 1 ) : 93 – 100 Ibuka Y et al ( 2016 ) Social contacts , vaccination decisions and inﬂuenza in Japan . J Epidemiol Community Health 70 : 152 – 167 Kortessis N , Simon MW , Barﬁeld M , Glass GE , Singer BH , Holt RD ( 2020 ) The interplay of move - ment and spatiotemporal variation in transmission degrades pandemic control . Proc Natl Acad Sci 117 ( 48 ) : 30104 – 30106 KullbackS ( 1967 ) Alowerboundfordiscriminationinformationintermsofvariation ( corresp ) . IEEETrans Inf Theory 13 ( 1 ) : 126 – 127 LavineJS , BjornstadON , AntiaR ( 2021 ) ImmunologicalcharacteristicsgovernthetransitionofCOVID - 19 to endemicity . Science 371 ( 6530 ) : 741 – 745 Leung K et al ( 2017 ) Social contact patterns relevant to the spread of respiratory infectious diseases in Hong Kong . Nat Sci Rep 7 : 7974 Magal P , Seydi O , Webb G ( 2018 ) Final size of a multigroup sir epidemic model : irreducible and non - irreducible modes of transmission . Math Biosci 301 : 59 – 67 Markowich PA , Villani C ( 1999 ) On the trend to equilibrium for the Fokker – Planck equation : an interplay between physics and functional analysis ( 1999 ) Park SW , Bolker BM , Funk S , Metcalf CJE , Weitz JS , Grenfell BT , Dushoff J ( 2022 ) The importance of the generation interval in investigating dynamics and control of new SARS - CoV - 2 variants . J R Soc Interface 19 ( 191 ) : 20220173 Pinsker MS ( 1964 ) Information and information stability of random variables and processes . Holden - Day series in time series analysis , Holden - Day , San Francisco 123 Epidemic modeling with heterogeneity and social diffusion Page 59 of 59 60 Prem K , Cook AR , Jit M ( 2017 ) Projecting social contact matrices in 152 countries using contact surveys and demographic data . PLoS Comput Biol 13 ( 9 ) : e1005697 Prem K , van Zandvoort K , Klepac P , Eggo RM , Davies NG , entre for the mathematical modelling of infectious diseases COVID - 19 Working Group , Cook AR , Jit M ( 2021 ) Projecting contact matrices in 177 geographical regions : an update and comparison with empirical data for the COVID - 19 era . PLoS Comput Biol 17 ( 7 ) : e1009098 RoquesL , BonnefonO , BaudrotV , SoubeyrandS , BerestyckiH ( 2020 ) Aparsimoniousapproachforspatial transmission and heterogeneity in the COVID - 19 propagation . R Soc Open Sci 7 ( 12 ) : 201382 Rose C , Medford AJ , Goldsmith CF , Vegge T , Weitz JS , Peterson AA ( 2021 ) Heterogeneity in susceptibility dictates the order of epidemic models . J Theor Biol 528 : 110839 Stroud P , del Valle S , Sydoriak S , Riese J , Minszewski S ( 2007 ) Spatial dynamics of pandemic inﬂuenza in a massive artiﬁcial society . J Artif Soc Soc Simul 10 ( 4 ) : 9 Sukumar SR , Nutaro JJ ( 2012 ) Agent - based vs . equation - based epidemiological models : a model selection case study . In : 2012 ASE / IEEE international conference on biomedical computing ( BioMedCom ) , pp 74 – 79 Tkachenko AV , Maslov S , Wang T , Elbana A , Wong GN , Goldenfeld N ( 2021 ) Stochastic social behavior coupled to COVID - 19 dynamics leads to waves , plateaus , and an endemic state . eLife 10 : e68341 Weitz JS , Park SW , Eksin C , Dushoff J ( 2020a ) Awareness - driven behavior changes can shift the shape of epidemics away from peaks and toward plateaus , shoulders , and oscillations . Proc Natl Acad Sci 117 ( 51 ) : 32764 – 32771 Weitz JS , Beckett SJ , Coenen AR et al ( 2020b ) Modeling shield immunity to reduce COVID - 19 epidemic spread . Nat Med 26 : 849 – 854 Zhang J et al ( 2020 ) Changes in contact pattern shape the dynamics of the COVID - 19 outbreak in China . Science 368 : 1481 – 1486 Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional afﬁliations . 123
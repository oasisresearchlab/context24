Finding the optimal contact function and path in nanomanipulation process - based on AFM nanorobot Hesam Khaksar School of Mechanical Engineering , Iran University of Science and Technology Tehran , Iran Hesamkhaksar @ mecheng . iust . ac . ir Abstract —In the area of the body of literature based on AFM nanorobot , various contact theories have been presented . But , choosing the best contact theory entails taking in different situations . Also , during the nanomanipulation of particles , finding the optimal path to move takes on importance . Therefore , in this research , choosing the optimal contact equation to be applied in manipulation and also finding the optimal path of movement using hybrid genetic algorithm method have been investigated . The findings of this study reflect that Jamari theory with an area of 21 . 689 nm2 creates the highest level of contact compared to the two JKR and Hertz models . Also , in the sphere of finding the optimal path on a real path , it was found that the optimal length of the created path is 13 . 29 μ m on a plate full of silver . Keywords— AFM nanorobot , Manipulation , Path planning , Hybrid genetic algorithm . I . I NTRODUCTION ( H EADING 1 ) Today , nanorobotics plays a crucial role in the industry and medicine . The mechanics of contact and the length of created path in the movement , are the two major factors in the process of nanomanipulation . In the area of analyzing contact theories , extensive research has been carried out . Abidine et al . studied the contact of cancer cells with base soft surface [ 1 ] . Daeinabi et al . elicited the indentation and indentation depth of spherical nanoparticles [ 2 ] . Wu studied the contact mechanics of a cylinder and a half space in the presence of adhesive force [ 3 ] . Lin et al . worked on the nanomechanics of polymeric gels and biological tissues [ 4 ] . Korayem et al . looked for the dynamics of the manipulation of spherical nanoparticles on rough surfaces . Not much researches have been conducted about the routing of movement [ 5 ] . Varol et al . examined the movement of different microparticles using the virtual reality environment [ 6 ] . Korayem et al . tracked the movements of one or more nanoparticles using hybrid genetic algorithm method in the presence of fixed obstacles [ 7 ] . Ju et al . investigated the manipulation of biological microparticles by means of optical scissors using RPT optimal routing algorithm [ 8 ] . Using an optical scissors and Estar algorithm , Wu et al . studied the manipulation process and attempted to find an optical path in a dynamic environment considering moving obstacles [ 9 ] . Furthermore , the direction of movement has been investigated with a set of molecular dynamic relations based on tapping and contact mode microscopes [ 10 , 11 ] . As was pointed out earlier , no investigation has been done about choosing the optimal contact relation . Moreover , in the previous studies , moving obstacles for oval nanoparticles in the area of routing have not been considered . In this study , first , used contact equations are presented . Next , the relations connected with dynamic manipulation and the used algorithm to find the path are examined . Finally , the results of the simulations are analyzed . II . C HOOSING THE OPTIMAL CONTACT EQUATION OF NANOPARTICLES TO BE APPLIED IN THE NANOMANIPULATION OF PARTICLES . Considering the reality of the topic of nanomanipulation and considering the relevant fact that the surface on which the manipulation is implemented is rough and the distance between the particle and surface is unknown , choosing the more fitting contact equation will be significance . Thus , when selecting optimal contact equation , the rough nanoparticles equations must be employed . Generally speaking , the general contact surface At and the general force Ft will be calculated from the set of contact surfaces and the forces of every single roughness and from the equations 1 and 2 [ 12 ] .  + − = i d d elliptic n t dz z d z A A A δ φ κ ) ( ) ( ( 1 )  + − = i d d elliptic n t dz z d z F A F δ φ κ ) ( ) ( ( 2 ) Where ,   − − = 2 2 2 ) ( exp 2 1 ) ( σ μ π σ φ z z ( 3 ) In equations 1 to 3 , d , µ and σ are among the unknowns of the math problem . All of the defined parameters in these equations have been described in detail in the reference number [ 12 ] . Also , in this research , the three contact models of Hertz [ 13 ] , JKR [ 14 ] and Jamari [ 15 ] have been explored . The aim of this section is to minimize the amount of indentation depth . Allowing for the defined Gaussian function and also the relation between the force and indentation depth in defined contact equations , the integral of the equation 2 cannot be solved analytically . Moreover , an integral relation in the genetic algorithm can increase the time and complexity of finding the answer to the math problem . To fix this problem , we can maximize the contact surface instead of minimizing indentation depth . Obviously , the more level of contact surface means lower dipping of particles into each other and generating lower indentation depth . This way , the integral of equation 1 can be described as equation 4 . i d d z erf d z erf z z e tA δ σ μ π μ σ μ π μσ σ μ μ σ σ ξ +   + − +   + − − − + − − = ) ) 2 2 2 ( 2 2 1 ) . . . 2 2 2 ( 2 2 1 2 2 2 ( 2 2 2 2 ( 4 ) Where , π π κ ξ 2 ) ( 1 e n R i f A = ( 5 ) 588 Proceedings of the 7th RSI International Conference on Robotics and Mechatronics ( ICRoM 2019 ) November 20 - 21 , 2019 , Tehran , Iran 978 - 1 - 7281 - 6604 - 9 / 19 / $ 31 . 00 ©2019 IEEE As shown , in equation 5 , the parameters σ , µ and d are the unknowns of the math problem and the rest are the knowns of the problem . So , the case study is a three - variable optimization math problem . The math problem constraints are actually the change conditions and intervals of these three parameters .  In the Gaussian function , μ is the symmetry axis that can take any real value in the defined range . Also , this point is the mean , mode and distribution middle .  In Gaussian function , σ is the center of the peak of function  d or the separation distance should also be defined in a way that contact be made . The amount of this parameter is in the area of nano and close to the surface roughness . III . O PTIMIZATION OF THE PATH OF OVAL NANOPARTICLES USING GENETIC ALGORITHM METHOD The main purpose of nanomanipulation based on the atomic force microscope , is to move the nanoparticle from the starting point to an intended target . Selecting a suitable path for the movement of nanoparticle can occupy its role in two axis : • Not doing any harm to the particle along the way • Reducing the costs and saving time and energy During manipulation , a predetermined force is applied from the operator so it can move the particle . This force is able to move the particle . Bearing in mind the conducted research , the chosen method for this study is the genetic algorithm method . A . The cost function of the math problem The cost function of this research can generally be solved from equation 6 : s s N i i i L s S w L L w c × + × =  − = + 1 1 1 ) , ( α ( 6 ) Which in equation 6 , w is the weight coefficient , ) , ( 1 i i L L + α is the surface smoothness function and Ss is the level below the critical force - time graph . To work out the presented dynamic relations and to obtain the force - time graph , the change of angle is presented in relation to time . The equation 7 shows the changes of angle . t H V Sub = θ ( 7 ) Thus , finally , the final force - time relation for oval nanoparticles can be acquired from equation 8 [ 16 ] . 2 1 ) 2 ) sin ) ) sin ( 2 ) ( ( 2 ) cos ( ( 2 ) ) ) cos ( ) ) cos ( ( 2 2 ) ( cos ( ) 2 sin ( 2 ) ( 2 cos ) sin ( 2 ( (       − + + + + + + − − +   = ϕ δ δ ϕ δ θ tip t H SubV H SubV H m t H SubV V PyyK t HSubV sub t HSubV tip H Sub V t HSubV m t HSubV PyyK t HSubV PZzK t HSubV H t SubV K TF    ( 8 ) Finally  = critical t T s dt F S 0 ( 9 ) B . The math problem constraints of the optimization of the movement path of nanoparticles The general constraints of this problem are as follows :  Existing irregularities in the movement path  Obstacles including fixed and moving obstacles  The dimensions of the sample surface on which the nanomanipulation can be performed  The initial force that is considered to be the essential force for the movement C . The methods for solving the math problem of genetic algorithm In this study , three different models for the mutation and four different models for the crossover to produce the samples have been used . Eventually , the lowest carried cost in each of these methods is calculated and described . These methods are :  Swap mutation method , reversion mutation method , insertion mutation method  single sight crossover method , two - point crossover method , multi - point crossover method and uniform crossover method . IV . T HE CALCULATION OF THE BEST CONTACT RELATION TO CREATE THE HIGHEST LEVEL OF CONTACT SURFACE Taking into consideration the existing various contact equations and also in view of the fact that the exact distance between the particle and surface is unknown , the genetic algorithm can be applied to choose the best contact function used in the process of manipulation . Figure 1 presents the general flowchart of finding the optimal contact equation . The results of simulation in this section have been presented for three roughness theories of Hertz , JKR and Jamari . As was explained , non - linear terms in the contact mechanics appear in roughness theories . Therefore , in the optimization of roughness theories , the topic of optimization can be extended to other contact relations and to any geometry . The roughness results for three theories of Hertz , JKR and Jamari are selected considering the level of RMS of the silicon surface which is about 20 nm . Figure 2 displays the maximum contact surface in three theories of Hertz , JKR and Jamari . As shown in Figure 2 , the highest level of contact surface is related to Jamari theory and then the two theories of Hertz and JKR . The reason for the behavioral process of this graph is in fact the random numbering properties in the genetic algorithm program . Thus , about indentation depth , it can be said that the theory of JKR will create the highest amount of indentation depth and the theories of Hertz and Jamari will produce lower indentation depth . 589 Fig . 1 . Problem flochart Thus , the Jamari theory is proposed to use contact relations in order to find the highest level of contact and the lowest amount of indentation depth . a . Hertz theory b . Jamari theory c . JKR theory Fig . 2 . Maximum area for determaining the best contact model Table 1 shows the required values to obtain the maximum contact surface in three theories . As has been shown in Table 1 , the amount of two parameters σ and μ takes place in the maximum range . Therefore , the separation distance from the surface plays a determining role in finding the maximum contact surface . Table1 . The amount of effective parameters in calculating maximum contact area in three Hertz , JKR and Jamari theories ) ( nm d ) ( nm μ ) ( nm σ ) ( 2 nmA 56 . 510 100 99 . 7 20 . 486 Hertz 10 . 731 100 100 21 . 689 Jamari 30 . 309 100 99 . 8 14 . 73 JKR V . F INDING THE OPTIMAL PATH IN THE PROCESS OF NANOMANIPULATION IN THE PRESENCE OF MOVING OBSTACLE . In this section , we investigate the influence of moving obstacle in the area of routing nanomanipulation . For better analysis , first , we assume the effect of moving obstacle type . The moving obstacle moves from the point ( 6 , 6 ) linearly . As can be seen from Figure 3 ( a ) , the particle will need to change its direction in the presence of moving and fixed obstacles with low height ( obstacles over which the particle can pass ) . Figure 3 ( b ) displays the simultaneous effect of fixed obstacles with great height . Figure 3 ( c ) also presents the routing in the presence of a set of obstacles . To receive the precise answer , this math problem has been processed for 50 different times and finally , the optimal final answer has been shown in Figure 3 ( d ) . a . In the presence of constant obstacles with low height 0 500 1000 1500 2000 17 . 5 18 18 . 5 19 19 . 5 20 20 . 5 Optimization of Area Iteration B e s t c o s t o f a r ea ( n m 2 ) Hertz 0 500 1000 1500 2000 20 . 8 21 21 . 2 21 . 4 21 . 6 21 . 8 Optimization of Area Iteration B e s t c o s t o f a r ea ( n m 2 ) Jamari 0 500 1000 1500 2000 12 . 5 13 13 . 5 14 14 . 5 15 Optimization of Area Iteration B e s t c o s t o f a r ea ( n m 2 ) JKR S D 590 b . In the presence of constant obstacles with high height c . In the presence of all obstacles d . Cost function and length Fig . 3 . Examine different routing modes VI . F INDING THE OPTIMAL PATH USING THE IMAGES TAKEN IN LABORATORY First , the image of a surface full of silver nanoparticles is taken in a laboratory way . Then , this image is captured on the math problem potential model and the primary map will be produced . Figure 4 ( a ) shows the laboratory image of the sample and Figure 4 ( b ) displays the routing done on this surface . As can be seen in Figure , the optimal length is 13 . 29 . a . Sample laboratory image b . Path planning on nanosilvers particle Fig . 4 . Path planning on a real surface VII . V ALIDATION OF RESULTS This section examines the validity of existing research results . For this , the results were compared with the Ref . [ 17 ] results . All of the terms of reference mentioned above apply . The error results are shown in Table 2 . Table2 . Validation of results Percentage error Cost function Length 5 . 47 8 . 16 VIII . C ONCLUSION As an advanced nanorobot , the atomic force microscope is used to move objects at the nano scale . The mechanics of contact is generally recognized as an influential parameter in this process . Various contact theories have been presented for oval nanoparticles . But in view of the rough surface in the contact , choosing an optimal contact theory takes priority . To this end , we used a three - variable optimization problem using the genetic algorithm method . The findings of this research appear to suggest that Jamari contact model is the most suitable model taking into account the less destruction of nanoparticles . Having found the suitable contact model , the optimization of the path in the presence of fixed and moving obstacles was studied . The results revealed that the optimal length is 28 . 36 μ m in the presence of fixed obstacles . This value is 27 . 57 μ m for fixed obstacles with great height and is 31 . 43 μ m in the presence of all obstacles . Finally , for better analysis , the routing was done on a real laboratory sample and the optimal length was 13 . 29 μ m in a 10×10 plate . S D S D 39 . 2095 37 . 0943 47 . 5873 27 . 5725 28 . 3605 31 . 4328 0 10 20 30 40 50 60 Unmovable Movable all Cost Length S D 591 IX . R EFERENCES [ 1 ] Y . Abidine , A . Constantinescu , V . M . Laurent , V . S . Rajan , R . Michel , V . Laplaud , A . Duperray , and C . Verdier , “Mechanosensitivity of Cancer Cells in Contact with Soft Substrates Using AFM , ” Biophys . j , vol . 114 , no . 5 , pp . 1165 – 1175 , 2018 . [ 2 ] K . Daeinabi and M . H . Korayem , “Indentation analysis of nano - particle using nano - contact mechanics models during nano - manipulation based on atomic force microscopy” , J . Nanopart . Res , Vol . 13 , No . 3 , pp 1075 - 1091 , 2011 . [ 3 ] J . - J . Wu , “Adhesive contact between a cylinder and a half - space , ” J . Phys . D . Appl . Phys , vol . 42 , no . 15 , p . 155302 , Jun . 2009 . [ 4 ] D . C . Lin and F . Horkay , “Nanomechanics of polymer gels and biological tissues : A critical review of analytical approaches in the Hertzian regime and beyond , ” Soft Matter , vol . 4 , no . 4 , p . 669 , 2008 . [ 5 ] M . H . Korayem , and M . Zakeri , “Dynamic modeling of manipulation of micro / nanoparticles on rough surfaces” , Appl . Surf . Sci , Vol . 257 , No . 15 , pp . 6503 - 6513 , 2011 [ 6 ] A . Varol , I . Gunev , and C . Basdogan , “AVirtual Reality Toolkit for Path Planning and Manipulation at Nano - scale , ” IEEE . Virtual . Real . Conf ( VR06 ) , pp . 485 – 489 , 2006 . [ 7 ] M . H . Korayem , A . K . Hoshiar , and M . Nazarahari , “A hybrid co - evolutionary genetic algorithm for multiple nanoparticle assembly task path planning , ” Int . J . Adv . Manuf . Technol . , vol . 87 , no . 9 – 12 , pp . 3527 – 3543 , 2016 . [ 8 ] T . Ju , S . Liu , J . Yang , and D . Sun , “Apply RRT - based path planning to robotic manipulation of biological cells with optical tweezer , ” IEEE . Int . Conf . Mechatron . Auto , pp . 221 – 226 , 2011 . [ 9 ] Y . Wu , D . Sun , W . Huang , and Y . Li , “Path planning in automated manipulation of biological cells with optical tweezers , ” IEEE Int . Conf . Control . Auto , pp . 2021 – 2026 , 2009 . [ 10 ] M . H . Korayem , S . Sadeghzadeh , and , V . Rahneshin “A new multiscale methodology for modeling of single and multi - body solid structures” , J . Comput . Material Sci , Vol . 63 , pp . 1 – 11 , 2012 . [ 11 ] M . H . Korayem , and A . H . Homayouni , “The size - dependent analysis of multilayer micro - cantilever plate with piezoelectric layer incorporated voltage effect based on a modified couple stress theory” , European Journal of Mechanics - A / Solids , Vol . 61 , pp . 59 - 72 , 2017 . [ 12 ] M . H . Korayem , H . Khaksar , and H . J . Sharahi , “Modeling and simulation of contact parameters of elliptical and cubic nanoparticles to be used in nanomanipulation based on atomic force microscope , ” Ultramicroscopy , vol . 206 , p . 112808 , 2019 . [ 13 ] C . Jin , A . Jagota , and C . - Y . Hui , “An easy - to - implement numerical simulation method for adhesive contact problems involving asymmetric adhesive contact , ” J . Phys . D . Appl . Phys . , vol . 44 , no . 40 , p . 405303 , 2011 . [ 14 ] K . L . Johnson , “Contact Mechanics , Cambridge University Press , Cambridge , 1985 . ” [ 15 ] J . Jamari and D . J . Schipper , “An elastic – plastic contact model of ellipsoid bodies , ” Tribol . Lett . , vol . 21 , no . 3 , pp . 262 – 271 , 2006 . [ 16 ] M . H . Korayem and H . Khaksar , “Estimation of critical force and time required to control the kinematics and friction of rough ellipsoidal and cubic nanoparticles using mechanics of contact surfaces , ” Tribol . Int , vol . 137 , pp . 11 – 21 , 2019 . [ 17 ] A . K . Hoshiar , M . Kianpour , M . Nazarahari , and M . H . Korayem , “Path planning in the AFM nanomanipulation of multiple spherical nanoparticles by using a coevolutionary Genetic Algorithm , ” International Conference on Manipulation , Automation and Robotics at Small Scales ( MARSS ) , pp . 1 - 6 , 2016 . 592
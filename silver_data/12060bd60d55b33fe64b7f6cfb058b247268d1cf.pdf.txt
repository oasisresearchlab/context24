1 / 23 Indoor Localization Without Infrastructure Using the Acoustic Background Spectrum Stephen P . Tarzia ∗ Peter A . Dinda ∗ Robert P . Dick † Gokhan Memik ∗ ∗ Northwestern University , EECS Dept . † University of Michigan , EECS Dept . Presented at MobiSys 2011 Bethesda , MD , USA June 30 , 2011 http : / / empathicsystems . org 2 / 23 Video demonstration of Batphone app Current acoustic fingerprint Location estimate 3 / 23 Deﬁnition : indoor localization without infrastructure Given : X A smartphone X A building composed of many rooms X At least one prior visit to each room for training Without : × Specialized hardware × Anything installed in the environment × Cooperation from the building owner Goal : I Determine which room the smartphone is currently located in 4 / 23 Summary Motivation : I Indoor localization is important I Wi - Fi is imperfect and not always available I Improved accuracy is desired Distinctive elements of our method : I Listen to background sounds I Look at frequency domain I Rank - order ﬁlter for noise Results : I 69 % accuracy for 33 rooms using sound alone I Publicly - available app I Eﬀectively combined Wi - Fi and sound 5 / 23 Related Work : mobile acoustic sensing M . Azizyan , I . Constandache , and R . R . Choudhury . SurroundSense : mobile phone localization via ambience ﬁngerprinting . MobiCom’09 . I Characterized rooms by loudness distribution I Did not use sound exclusively H . Lu , W . Pan , N . D . Lane , T . Choudhury , and A . T . Campbell . SoundSense : scalable sound sensing for people - centric applications on mobile phones . MobiSys’09 . I Focused on transient sounds I Activity detection , not localization 6 / 23 Acoustic Background Spectrum ( ABS ) A location ﬁngerprint should be : I D istinctive I r E sponsive I C ompact I E ﬃciently - computable I N oise - robust I T ime - invariant X 69 % matching accuracy X 4 – 30 second sample X ∼ 1 kB per ﬁngerprint X ∼ 12 % mobile CPU usage ∼ sometimes can adapt X tested on diﬀerent days 6 / 23 Acoustic Background Spectrum ( ABS ) A location ﬁngerprint should be : I D istinctive I r E sponsive I C ompact I E ﬃciently - computable I N oise - robust I T ime - invariant X 69 % matching accuracy X 4 – 30 second sample X ∼ 1 kB per ﬁngerprint X ∼ 12 % mobile CPU usage ∼ sometimes can adapt X tested on diﬀerent days 7 / 23 Signal Processing Discard rows > 7 kHz Record audio samples Divide samples into frames Compute power spectrum of each frame time time f r eq . Sort each remaining row spectrogram audio sample time series f r eq . increasing magnitude Extract 5 th percentile column and take logarithm [ ] = Acoustic Background Spectrum microphone input * * * * * * * * * * * * * * * * * * Multiply frames by a window function S t a nd a r d s p ec t r a l a n a l ys i s A B S f i ng e r p r i n t ex t r ac t i on 8 / 23 ABS Fingerprints Various rooms 10 - 2 10 0 10 2 10 4 10 6 10 8 Room 15 10 - 2 10 0 10 2 10 4 10 6 10 8 no r m a li ze d , l og - s c a l e e n e r gy Room 16 10 - 2 10 0 10 2 10 4 10 6 10 8 0 1 2 3 4 5 6 7 frequency ( kHz ) Room 17 Diﬀerent positions and days 10 - 2 10 0 10 2 10 4 10 6 10 8 Room 15 10 - 2 10 0 10 2 10 4 10 6 10 8 no r m a li ze d , l og - s ca l e e n e r gy Room 16 10 - 2 10 0 10 2 10 4 10 6 10 8 0 1 2 3 4 5 6 7 frequency ( kHz ) Room 17 8 / 23 ABS Fingerprints Various rooms 10 - 2 10 0 10 2 10 4 10 6 10 8 Room 15 10 - 2 10 0 10 2 10 4 10 6 10 8 no r m a li ze d , l og - s c a l e e n e r gy Room 16 10 - 2 10 0 10 2 10 4 10 6 10 8 0 1 2 3 4 5 6 7 frequency ( kHz ) Room 17 Diﬀerent positions and days 10 - 2 10 0 10 2 10 4 10 6 10 8 Room 15 10 - 2 10 0 10 2 10 4 10 6 10 8 no r m a li ze d , l og - s c a l e e n e r gy Room 16 10 - 2 10 0 10 2 10 4 10 6 10 8 0 1 2 3 4 5 6 7 frequency ( kHz ) Room 17 9 / 23 Experimental Platforms ( a ) Zoom H4n ( b ) Apple iPod Touch 10 / 23 Experimental Rooms 0 5 10 15 20 o ff i ce l oung e c o m pu t e r l a b c l a ss r oo m l ec t u r e h a ll I n s t a n ce s Room type 0 2 4 6 8 10 12 14 16 4 8 16 32 64 128 256 512 I n s t a n ce s Maximum room capacity 11 / 23 Fingerprint - based localization Supervised learning with two phases : I Training – gather labeled ﬁngerprints I Testing / operation – observe new , unlabeled ﬁngerprints I Experiments use leave - one - out simulation Our classiﬁer : I Euclidean distance metric for comparing ﬁngerprints ( equivalent to RMS error ) I Nearest - neighbor classiﬁcation In summary To guess the current location ﬁnd the “closest” ﬁngerprint in a database of labeled ﬁngerprints . 12 / 23 Accuracy Scaling 0 10 20 30 40 50 60 70 80 90 100 2 4 8 17 33 A cc u r ac y ( % ) Number of rooms in database ( log scale ) Proposed Acoustic Background Spectrum SurroundSense [ Azizyan et al . ] Random chance I SurroundSense is used in a way not intended by the authors : using the microphone alone 13 / 23 ABS Parameters Presented now : I Filter rank I Listening time I Fingerprint size / resolution In paper : I Frequency band I Distance metric I Spectrogram window 14 / 23 Rank - order Filtering 0 20 40 60 80 100 m ea n m i n p05 p10 p25 m e d i a n p95 m a x A cc u r ac y ( % ) Fingerprint type standard spectrum proposed rank - order filtered spectrum I 33 rooms in database I Rank - order ﬁlters outperforms simple mean ⇒ our transient noise ﬁltering technique is eﬀective 15 / 23 Listening time 0 10 20 30 40 50 60 70 80 1 2 4 8 15 30 A cc u r ac y ( % ) Sample time , in seconds 16 / 23 Frequency resolution 0 10 20 30 40 50 60 70 80 1 10 100 1000 A cc u r ac y ( % ) Frequency bins / fingerprint vector length 17 / 23 Batphone app in iTunes store I Uses a 10 second sliding window I Streaming signal processing I Combines Wi - Fi with acoustic ﬁngerprint 18 / 23 Batphone results 0 20 40 60 80 100 L i n ea r c o m b i n a ti on A B S C o mm e r c i a l W i - F i R a ndo m A cc u r ac y ( % ) Batphone localization accuracy proposed methods I 43 rooms in database I Similar ABS accuracy for iPod and audio recorder I Linear combination of Wi - Fi and ABS works well I Didn’t compare to state - of - the - art Wi - Fi localization 19 / 23 Orthogonality of Wi - Fi and Acoustics 2D histograms of physical and fingerprint distances 0 20 40 60 80 100 120 140 160 0 10 20 30 40 50 60 W i - F i d i s t a n ce ( m ) Real physical distance ( m ) 0 100 200 300 400 500 600 700 800 0 10 20 30 40 50 60 A B S d i s t a n ce ( d B ) I Wi - Fi ﬁngerprints from distant rooms are always diﬀerent I ABS ﬁngerprints from nearby rooms can be quite diﬀerent 20 / 23 http : / / stevetarzia . com / listen 21 / 23 Conclusion ABS ﬁngerprint can be used for indoor localization and it requires no infrastructure See the paper for : I Full parameter study I Noise robustness experiment I More Wi - Fi combination results I Battery - drain measurements 22 / 23 Future work I Improved noise robustness I Train the various noise states I Adaptively chose ﬁngerprint frequency band I Use ﬂoorplan and history : Markov movement model I Isolate factors that contribute to the ABS I Add other sensors , as in SurroundSense I In - pocket detection 23 / 23 Thanks ! For your enjoyment : I App on the iTunes store : search for Batphone I Listening demo at http : / / stevetarzia . com / listen I Data and Matlab scripts at http : / / stevetarzia . com I See our other projects at http : / / empathicsystems . org 24 / 23 Room 1 : Ford 2221 ( office ) Accuracy : 100 % Room 2 : Ford 2227 ( lounge ) Accuracy : 38 % Room 3 : Ford 2230 ( office ) Accuracy : 25 % Room 4 : Ford 3317 ( lounge ) Accuracy : 100 % Room 5 : Tech F235 ( classroom ) Accuracy : 0 % Room 6 : Tech F252 ( computer lab ) Accuracy : 100 % Room 7 : Tech L158 ( classroom ) Accuracy : 88 % Room 8 : Tech L160 ( classroom ) Accuracy : 100 % Room 9 : Tech L168 ( classroom ) Accuracy : 0 % Room 10 : Tech L170 ( classroom ) Accuracy : 0 % 1 2 3 4 5 6 7 Room 11 : Tech L211 ( lecture hall ) Accuracy : 50 % Room 12 : Tech L221 ( classroom ) Accuracy : 100 % Room 13 : Tech L251 ( classroom ) Accuracy : 0 % Room 14 : Tech L361 ( lecture hall ) Accuracy : 75 % Room 15 : Tech LG62 ( classroom ) Accuracy : 100 % Room 16 : Tech LG66 ( classroom ) Accuracy : 100 % Room 17 : Tech LG68 ( classroom ) Accuracy : 100 % Room 18 : Tech LG76 ( classroom ) Accuracy : 100 % Room 19 : Tech LR2 ( lecture hall ) Accuracy : 88 % Room 20 : Tech LR3 ( lecture hall ) Accuracy : 100 % Room 21 : Tech LR4 ( lecture hall ) Accuracy : 88 % 1 2 3 4 5 6 7 Frequency ( kHz ) Room 22 : Tech LR5 ( lecture hall ) Accuracy : 63 % Room 23 : Tech M120 ( classroom ) Accuracy : 100 % Room 24 : Tech M128 ( classroom ) Accuracy : 50 % Room 25 : Tech M152 ( classroom ) Accuracy : 63 % Room 26 : Tech M164 ( classroom ) Accuracy : 100 % Room 27 : Tech M166 ( classroom ) Accuracy : 88 % Room 28 : Tech M338 ( computer lab ) Accuracy : 0 % Room 29 : Tech M345 ( lecture hall ) Accuracy : 0 % Room 30 : Tech M349 ( classroom ) Accuracy : 100 % Room 31 : Tech MG51 ( computer lab ) Accuracy : 100 % Room 32 : Tech RYAN ( lecture hall ) Accuracy : 100 % 1 2 3 4 5 6 7 Room 33 : Tech XPRS ( lounge ) Accuracy : 75 % 25 / 23 Parameter Study ( a ) Frequency band Accuracy full ( 0 – 48 kHz ) 59 . 8 % audible ( 0 – 20 kHz ) 64 . 8 % low ( 0 – 7 kHz ) * 69 . 3 % very low ( 0 – 1 kHz ) 61 . 0 % ( 0 – 600 Hz ) 51 . 5 % ( 0 – 400 Hz ) 44 . 3 % ( 0 – 300 Hz ) 40 . 9 % ( 0 – 200 Hz ) 30 . 7 % ( 0 – 100 Hz ) 15 . 5 % high ( 7 – 20 kHz ) 28 . 4 % ultrasonic ( 20 – 48 kHz ) 25 . 0 % 26 / 23 Parameter Study ( cont . ) ( b ) Distance metric Accuracy Euclidean * 69 . 3 % city block 66 . 7 % ( c ) Spectrogram window Accuracy rectangular 65 . 2 % Hamming * 69 . 3 % Hann 68 . 2 % Blackman 67 . 4 % 27 / 23 Optimal Parameters symbol meaning optimal value Batphone R s sampling rate 96 kHz 44 . 1 kHz n spec spectral resolution 2048 bins 1024 bins n fp ABS size 299 bins 325 bins t spec frame size 0 . 1 s 0 . 1 s t samp sampling time 30 s 10 s frequency band 0 – 7 kHz 0 – 7 kHz window function Hamming rectangular 28 / 23 Dealing with Noise by changing Frequency band Occupancy Noise State Frequency band Quiet Conversation Chatter ( a ) Tech LR5 lecture hall low ( 0 – 7 kHz ) 89 . 2 % 2 . 5 % 0 . 0 % ( 0 – 300 Hz ) 75 . 7 % 63 . 4 % 0 . 0 % ( b ) Ford 3 . 317 lounge low ( 0 – 7 kHz ) 98 . 2 % 47 . 2 % — ( 0 – 300 Hz ) 87 . 7 % 79 . 2 % — 29 / 23 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 10 C u m u l a ti v e p r ob a b ilit y Ranking of correct room ( log scale ) Error characteristics of localization methods Linear combination Two - step combinationABSWi - Fi Random chance I Batphone ( ABS ) beats Wi - Fi at ﬁne granularity I Wi - Fi beats Batphone ( ABS ) at coarse granularity . I Combination is best overall
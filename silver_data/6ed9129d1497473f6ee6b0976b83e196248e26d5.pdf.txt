SIRS epidemics with individual heterogeneity of immunity waning Mohamed El Khalifi and Tom Britton November 2 , 2023 Abstract In the current paper we analyse an extended SIRS epidemic model in which immunity at the individual level wanes gradually at exponential rate , but where the waning rate may differ between individuals , for instance as an effect of differences in immune systems . The model also includes vaccination schemes aimed to reach and maintain herd immunity . We consider both the informed situation where the individual waning parameters are known , thus allowing selection of vaccinees being based on both time since last vaccination as well as on the individual waning rate , and the more likely uninformed situation where individ - ual waning parameters are unobserved , thus only allowing vaccination schemes to depend on time since last vaccination . The optimal vaccination policies for both the informed and uniformed heterogeneous situation are derived and compared with the homogeneous waning model ( meaning all individuals have the same immunity waning rate ) , as well as to the classic SIRS model where immunity at the individual level drops from complete immunity to complete susceptibility in one leap . It is shown that the classic SIRS model requires least vaccines , followed by the SIRS with homogeneous gradual waning , followed by the informed situation for the model with heterogeneous gradual waning . The situa - tion requiring most vaccines for herd immunity is the most likely scenario , that immunity wanes gradually with unobserved individual heterogeneity . For parameter values chosen to mimic COVID - 19 and assuming perfect initial immunity and cumulative immunity of 12 months , the classic homogeneous SIRS epidemic suggests that vaccinating individuals every 15 months is sufficient to reach and maintain herd immunity , whereas the unin - formed case for exponential waning with rate heterogeneity corresponding to a coefficient of variation being 0 . 5 , requires that individuals instead need to be vaccinated every 4 . 4 months . 1 Introduction Among other things , the COVID - 19 pandemic showed that immunity waning as well as im - munity escape for new virus strains play important roles when designing vaccination schemes to reduce and ultimately stop the spreading of an epidemic . In the current paper the focus lies on immunity waning for a fixed and specific strain and we thus study an epidemic model for an infectious disease where immunity , both from vaccination as well as natural infection , wanes gradually and monotonically following an exponential mode [ 1 ] . The classic SIRS model [ 2 , 3 ] is the first model to consider immunity waning , and in this model population immunity decays gradually , but at the individual level each individual is either fully immune or fully susceptible . In the last few years this assumption has been relaxed ( e . g . [ 4 , 5 , 6 , 7 ] ) thus allowing for gradual waning of immunity also at the individual level , resulting in individuals having different immunity levels , defined either discretely or continu - ously . These models still assume that immunity wanes in a similar fashion for all individuals , most often defined by a waning rate ω common for all individuals . For these models it has 1 a r X i v : 2311 . 00592v1 [ q - b i o . P E ] 1 N ov 2023 been shown that such gradual immunity waning requires more frequent vaccination to reach and maintain herd immunity as compared to the classic SIRS model which assumes one single jump from fully immune to fully susceptible ( having the same average cumulative immunity ) [ 7 ] . Empirical measurements of antibodies however suggest large individual differences in an - tibody decay between individuals [ 8 , 9 , 10 , 11 ] thus suggesting different waning rates between individuals . In the present paper we therefore extend a model with homogeneous gradual immunity waning to a situation where the waning rate may differ between individuals . The general situation , where waning rates of individuals are drawn independently from some gen - eral random distribution is complicated to analyse , so here we focus on the situation where there are two types of waning rates ω 1 and ω 2 with population frequencies p and 1 − p respec - tively . We compare the heterogeneous situation with the homogeneous case having the same cumulative immunity ( = 1 / ω ) and we quantify the amount of heterogeneity by the coefficient of variation of the immunity distribution . This paper is structured as follows . In the next section we present the SIRS models with heterogeneity under both situations : sudden loss and continuous waning of immunity . In Section 3 we formulate the SIR ( k ) S model with heterogeneity . In Section 4 , we introduce vaccination into the model by taking into account the effect of the available information on individuals immunity . To illustrate the results for our models , in Section 5 , we compare the long term prevalence and the optimal vaccination schemes under parameter values mimicking the COVID - 19 pandemic . We conclude the paper in Section 6 with a discussion and draw some perspectives . 2 Models First , we define a model where immune individuals lose their immunity at once . Next we modify the model to allow for gradual ( exponential ) waning of individual immunity . For both models we divide the population into two immunity waning classes with waning rates ω 1 and ω 2 with fractions p and 1 − p , allowing for a certain degree of heterogeneity . We compare the homogeneous case with cumulative immunity 1 / ω to the heterogeneous case with 1 / ω 1 = ( 1 − α ) ( 1 / ω ) and 1 / ω 2 = ( 1 + α p 1 − p ) ( 1 / ω ) for some α ( 0 ≤ α ≤ 1 ) so that the cumulative immunity is set to 1 / ω . The coefficient of variation of the immunity distribution is given by σ = α (cid:112) p / ( 1 − p ) which from now on is used as heterogeneity parameter rather than α . Hence , we have 1 ω 1 = 1 ω (cid:18) 1 − σ (cid:114) 1 − p p (cid:19) and 1 ω 2 = 1 ω (cid:18) 1 + σ (cid:114) p 1 − p (cid:19) . 2 . 1 The SIRS model with heterogeneity The model that we consider in this section , also taking births and deaths into account , is defined as follows . Let l ∈ { 1 , 2 } be the index of the immunity waning classes and de - note s l ( t ) , i l ( t ) , and r l ( t ) the community fractions of susceptible , infectious , and recovered l - individuals at time t , respectively . The model parameters are as defined in Table 1 . Then , the differential equations for the SIRS model with heterogeneity are given by s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) − µs l ( t ) + ω l r l ( t ) , i ′ l ( t ) = βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , ( 1 ) r ′ l ( t ) = γi l ( t ) − ( µ + ω l ) r l ( t ) , 2 Table 1 : Model Parameters and interpretation . Parameter Description µ Birth and death rate β Effective infection rate γ Recovery rate ω Immunity waning rate σ Coefficient of variation of immunity distribution with l ∈ { 1 , 2 } ( so s l ( t ) + i l ( t ) + r l ( t ) = p l ) , p 1 = p and p 2 = 1 − p . We define the basic reproduction number to be R 0 = βγ + µ representing the average number of new infections generated by an infectious person in an entirely susceptible population . We have the following standard result for our model . Proposition 1 . The solution to Eq . ( 1 ) has a unique endemic equilibrium if and only if R 0 > 1 . When the endemic equilibrium exist , the endemic level is given by the sum of the constant fractions of infectives ˆ i 1 and ˆ i 2 in the type - 1 and type - 2 communities respectively . We also have the following result regarding the dependence of the endemic level on the population heterogeneity . Recall the p is the community fraction having lower immunity and hence higher waning rate ω 1 . Proposition 2 . Assume that R 0 > 1 and 1 / 2 ≤ p < 1 . Then , the endemic level is an increasing function of the coefficient of variation σ on [ 0 , (cid:112) p / ( 1 − p ) ) . The proofs of the Propositions 1 and 2 are given in the Appendix A . Although the mono - tonicity in Proposition 2 is only proved for a fraction p satisfying 1 / 2 ≤ p < 1 , numerical simulations suggest that the endemic level is also increasing in σ on [ 0 , (cid:112) p / ( 1 − p ) ) for any 0 < p < 1 / 2 . 2 . 2 The SIR ( ∞ ) S model with heterogeneity When immunity wanes continuously and following an exponential decay , the recovered equa - tion could be modelled using a PDE evolving in calendar time t and time - since - recovery a , and the model equations become s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) − µs l ( t ) , i ′ l ( t ) = β (cid:18) s l ( t ) + (cid:90) ∞ 0 (cid:0) 1 − e − ω l a (cid:1) r l ( t , a ) da (cid:19) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , ( 2 ) ∂r l ( t , a ) ∂t + ∂r l ( t , a ) ∂a = − β (cid:0) 1 − e − ω l a (cid:1) r l ( t , a ) ( i 1 ( t ) + i 2 ( t ) ) − µr l ( t , a ) , a > 0 , with the boundary condition r l ( t , 0 ) = γi l ( t ) , l ∈ { 1 , 2 } where p 1 = p and p 2 = 1 − p . We call the model ( 2 ) the SIR ( ∞ ) S model with heterogeneity as it can be seen as the k - limit of the heterogeneous SIR ( k ) S model where immunity drops in k steps , 1 / k each time [ 7 ] . We refer to [ 7 ] for more details on the construction ( see also Section 3 ) . We have the following expected result for the model ( 2 ) . 3 Proposition 3 . • Assume that R 0 ≤ 1 . Then , the solution to Eq . ( 2 ) converges to the disease - free equi - librium . • Assume that R 0 > 1 . Then , Eq . ( 2 ) has a unique endemic equilibrium . The proof of the Proposition 3 is given in Appendix A . 1 . 3 . 3 SIR ( k ) S model with heterogeneity Similarly to the approach in [ 7 ] , we approximate the SIR ( ∞ ) S model ( 2 ) by a system of ODEs allowing immunity to wane in k steps for some large value of k . We now describe how this reduction of immunity in k small steps down to no immunity , each step having a high rate to drop to the next level . This can be done in several ways still reaching the same continuous limit as k → ∞ and it is convenient to choose different choices for different constructions why we define the general construction . The most important thing is however that for large k immunity jumps in many small steps , each having a high jump rate . Let { r l , j ( t ) } k − 1 j = 1 , l ∈ { 1 , 2 } be the fractions of recovered individuals , at time t , with the immunity levels { 1 − f l , j } k − 1 j = 1 ( or susceptibility levels { f l , j } k − 1 j = 1 ) , l ∈ { 1 , 2 } , and { c l , j } kj = 1 , l ∈ { 1 , 2 } be the rates at which recovered individuals lose immunity portions through the k steps . Since k is fixed and typically large , we drop it from the notation . The resulting model equations are given by s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) + c l , k r l , k − 1 ( t ) − µs l ( t ) , i ′ l ( t ) = β (cid:0) s l ( t ) + k − 1 (cid:80) j = 1 f l , j r l , j ( t ) (cid:1) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , r ′ l , 0 ( t ) = γi l ( t ) − ( c l , 1 + µ ) r l , 0 ( t ) , r ′ l , j ( t ) = c l , j r l , j − 1 ( t ) − βf l , j r l , j ( t ) ( i 1 ( t ) + i 2 ( t ) ) − ( c l , j + 1 + µ ) r l , j ( t ) , ( 3 ) for j = 1 , · · · , k − 1 and l ∈ { 1 , 2 } where p 1 = p and p 2 = 1 − p . We call this model the SIR ( k ) S model with heterogeneity . See Fig . 1 for a transition scheme and the Appendix A . 2 for a derivation of the immunity jumps and the transition rates ( see also [ 7 ] ) . 4 SIR ( k ) S model with heterogeneity and vaccination When immunity wanes over time , it is important to allow the vaccination strategies to depend on time since last vaccination and vaccines should not be uniformly distributed . Hence the vaccination rate in the j ’th susceptibility class of an l - type individuals might depend on both l and j . Let η l , j to denote this vaccination rate . A vaccination strategy is hence specified by these rates { η l , j } , many rates often being 0 since strategies would often be defined by vaccinating once immunity drops to a certain level . Then , the SIR ( k ) S model with vaccination is given by the following equations s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) + c l , k r l , k − 1 ( t ) − ( µ + η l , k ) s l ( t ) , i ′ l ( t ) = β (cid:0) s l ( t ) + k − 1 (cid:80) j = 1 f l , j r l , j ( t ) (cid:1) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , r ′ l , 0 ( t ) = η l , k s l ( t ) + k − 1 (cid:80) j = 1 η l , j r l , j ( t ) + γi l ( t ) − ( c l , 1 + µ ) r l , 0 ( t ) , r ′ l , j ( t ) = c l , j r l , j − 1 ( t ) − βf l , j r l , j ( t ) ( i 1 ( t ) + i 2 ( t ) ) − ( c l , j + 1 + µ + η l , j ) r l , j ( t ) , ( 4 ) 4 s l ( t ) i l ( t ) r l , 0 ( t ) r l , 1 ( t ) r l , k − 1 ( t ) µ µ µ µ µ p l µ β ( i 1 ( t ) + i 2 ( t ) ) γ c l , 1 βf l , k − 1 ( i 1 ( t ) + i 2 ( t ) ) c l , k βf l , 1 ( i 1 ( t ) + i 2 ( t ) ) Figure 1 : Diagram of the SIR ( k ) S epidemic model in the l - type individuals , l = 1 , 2 . for j = 1 , · · · , k − 1 and l ∈ { 1 , 2 } where p 1 = p and p 2 = 1 − p . What is the best , or optimal , vaccination strategy differs depending on amount of available information . In the situation where no information is available , a potential strategy could be to randomly vaccinate in all non - infectious classes , including individuals with partial immunity . Here we distinguish between two situations : both individual time since last vaccination and waning rates are known ( informed situation ) , and only time since last vaccination is known ( uninformed situation ) . 4 . 1 Informed situation When the individual waning rate and time since last vaccination for all individuals are known , vaccines will be administrated to those with faster waning at different frequency compared to individuals with slower waning . In this situation , we assume that the susceptibility levels { f l , j } k − 1 j = 1 are the same for both types and f l , j = j k , j = 1 , · · · , k − 1 . Hence the transition rates { c l , j } kj = 1 , l ∈ { 1 , 2 } ( depend on l ) are such that the average cumulative immunity equals 1 / ω 1 and 1 / ω 2 respectively ( see Appendix A . 2 ) . For any l ∈ { 1 , 2 } , we denote by η l , j the vaccination rate in the class r l , j for j = 1 , · · · , k − 1 , and by η l , k the vaccination rate of fully susceptible individuals s l . The resulting model equations are given by s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) + c l , k r l , k − 1 ( t ) − ( µ + η l , k ) s l ( t ) , i ′ l ( t ) = β (cid:0) s l ( t ) + k − 1 (cid:80) j = 1 jk r l , j ( t ) (cid:1) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , r ′ l , 0 ( t ) = η l , k s l ( t ) + k − 1 (cid:80) j = 1 η l , j r l , j ( t ) + γi l ( t ) − ( c l , 1 + µ ) r l , 0 ( t ) , r ′ l , j ( t ) = c l , j r l , j − 1 ( t ) − β jk r l , j ( t ) ( i 1 ( t ) + i 2 ( t ) ) − ( c l , j + 1 + µ + η l , j ) r l , j ( t ) , ( 5 ) for j = 1 , · · · , k − 1 , and l ∈ { 1 , 2 } where p 1 = p and p 2 = 1 − p . Here the immunity class of each individual is known . The best vaccination scheme is then to vaccinate 1 - individuals once they have lost j 1 steps of immunity and 2 - individuals 5 once they have lost j 2 immunity steps , for some values of j 1 and j 2 ( see Fig . 2a ) . This corresponds to vaccinating the two types of individuals at ( possible different ) fixed times , t 1 and t 2 respectively , since last vaccination ( or infection ) . Clearly , the smaller j 1 and j 2 the more vaccines are needed , and the optimal relation between j 1 and j 2 will depend on the immunity waning rates ω 1 and ω 2 . 0 1 - j 1 k 1 - j 2 k 1 t 1 t 2 Time since vaccination / recovery Immunity level ( a ) 0 1 - f 1 , j 1 - f 2 , j 1 t Time since vaccination / recovery Immunity level ( b ) Figure 2 : Examples showing the vaccination strategy when immunity wanes in k = 10 steps in ( a ) the informed situation ( b ) the uninformed situation . 4 . 2 Uninformed situation Here we consider the more realistic situation where only time since last recovery / vaccination is known . In this situation , we let the transition rates { c l , j } kj = 1 , l ∈ { 1 , 2 } to be independent on l , and then the susceptibilities { f l , j } kj = 1 are no longer the same for l ∈ { 1 , 2 } ( see Appendix A . 2 ) . In addition , for both l ∈ { 1 , 2 } we let η j to be the vaccination rate in the class r l , j for j = 1 , · · · , k − 1 , and η k to be the vaccination rate of fully susceptible individuals s l ( the vaccination rate must be the same for both types in the uninformed situation ) . The resulting model equations are given by s ′ l ( t ) = p l µ − βs l ( t ) ( i 1 ( t ) + i 2 ( t ) ) + c k r l , k − 1 ( t ) − ( µ + η k ) s l ( t ) , i ′ l ( t ) = β (cid:0) s l ( t ) + k − 1 (cid:80) j = 1 f l , j r l , j ( t ) (cid:1) ( i 1 ( t ) + i 2 ( t ) ) − ( γ + µ ) i l ( t ) , r ′ l , 0 ( t ) = η k s l ( t ) + k − 1 (cid:80) j = 1 η j r l , j ( t ) + γi l ( t ) − ( c 1 + µ ) r l , 0 ( t ) , r ′ l , j ( t ) = c j r l , j − 1 ( t ) − βf l , j r l , j ( t ) ( i 1 ( t ) + i 2 ( t ) ) − ( c j + 1 + µ ) r l , j ( t ) − η j r l , j ( t ) , ( 6 ) for j = 1 , · · · , k − 1 , and l ∈ { 1 , 2 } where p 1 = p and p 2 = 1 − p . Here vaccination is the same for both types since they are unobserved , and all individuals are vaccinated ( at the same time , t ) once they have lost j steps of immunity ( see Fig . 2b ) . 4 . 3 Extending to imperfect ( leaky ) vaccines In the previous section , both infection and vaccination are assumed to initially confer per - fect immunity . This could be relaxed by considering imperfect vaccines producing partial protection level to any vaccinated person . Although , these partial immunities could differ between the two subpopulations , we here consider a leaky vaccine conferring immunity e to all vaccinated individuals in both subpopulations . 6 4 . 4 Reproduction number and optimal vaccination Recall that e is the protection level that vaccines are assumed to confer to any vaccinated individual . Each constant vaccination scheme gives rise to a disease free equilibrium E 0 = ( ˆ s 1 , ˆ s 2 , ˆ r 1 , 0 , ˆ r 2 , 0 , · · · , ˆ r 1 , k − 1 , ˆ r 2 , k − 1 ) ( see Appendix A . 3 ) . The corresponding reproduction num - ber R v is given by R v = R 0 2 (cid:88) l = 1   ˆ s l + e k − 1 (cid:88) j = 1 f kl , j ˆ r l , j   . ( 7 ) In the expressions E 0 and R v , we omit the dependence on the vaccination strategy ( informed or uninformed ) for the sake of convenience . Within a certain class of vaccination schemes , the optimal is the one solving the following optimization problem θ kc = min η θ k ( η ) subject to R v ≤ 1 , where θ k ( η ) is the vaccine usage given by θ k ( η ) = 2 (cid:88) l = 1 η l , k ˆ s l + k − 1 (cid:88) j = 1 η l , j ˆ r l , j , ( 8 ) for a ( 2 × k ) - matrix of vaccination rates η within the class of possible vaccination schemes . Informed optimal vaccination strategy Within each type it is always better to vaccinate less immune individuals compared to more immune individuals . The optimal vaccination strategy in the informed situation is hence to vaccinate 1 - individuals and 2 - individuals as soon as their immunities drop below some levels ι 1 = 1 − j 1 / k and ι 2 = 1 − j 2 / k , respectively , for some j 1 and j 2 . For finite k and by referring to model ( 5 ) , this is equivalent to not vaccinate type - 1 individuals in states ( r 1 , 0 , r 1 , 1 , · · · , r 1 , j 1 − 1 ) ( and ( r 2 , 0 , r 2 , 1 , · · · , r 2 , j 2 − 1 ) for type - 2 individuals ) up to some j 1 , j 2 ∈ { 1 , · · · , k } , to vaccinate in r 1 , j 1 ( resp . r 1 , j 2 ) at some rate η ⋆ 1 , j 1 ( resp . η ⋆ 1 , j 2 ) , and to immediately vaccinate individuals leaving the state r 1 , j 1 ( resp . r 1 , j 2 ) . The states ( j 1 , j 2 ) and the rates ( η ⋆ 1 , j 1 , η ⋆ 1 , j 2 ) correspond to the minimal immunity levels and the minimal vaccination rates respectively , satisfying R v ≤ 1 . For large k this means we vaccinate type - 1 and type - 2 individuals once their immunities have dropped to 1 − j 1 / k and 1 − j 2 / k respectively . What are the optimal values of j 1 and j 2 for a given overall vaccination rate θ we solve numerically . Uninformed optimal vaccination strategy As only individual time since vaccination is known , the optimal vaccination strategy consists of vaccinating all individuals , irrespective of type , as soon as they reach some time t since their last vaccination . The shorter t , the bigger the vaccine coverage θ kc . For finite k and by referring to model ( 6 ) , this is to not vaccinate up to some j ∈ { 1 , · · · , k } , to vaccinate in both r 1 , j and r 2 , j at some rate η ⋆j , and immediately vaccinate individuals leaving the states r 1 , j and r 2 , j . The state j and the rate η ⋆j correspond to the minimal immunity levels and the minimal vaccination rate respectively , satisfying R v ≤ 1 and this we also solve numerically . At time t , individuals immunities are different and equal to ι u , 1 = 1 − f 1 , j and ι u , 2 = 1 − f 2 , j for type - 1 individuals and type - 2 individuals respectively . Remark : While both informed and uninformed vaccination strategies will be considered 7 when immunity wanes gradually , only the informed situation is considered when immunity wanes in one jump . Indeed , introducing an uninformed vaccination in the SIRS model neces - sitates the change of the distribution of immunity duration and probably using a PDE model for the dynamics of vaccinated / recovered individuals , something which we do not consider in this paper . 5 Results We now illustrate our results numerically , studying the effect of heterogeneity of the gradual waning , for parameter values consistent with Covid - 19 ( of course lacking many other features of reality ) . Our primary focus is to study the effect of heterogeneity measured by its coefficient of variation σ , but also to compare the informed situation , which assumes the individual heterogeneities to be known , to the uninformed case . We also compare our model to the classical homogeneous SIRS epidemic model as well as to the heterogeneous SIRS ( loosing all immunity at once ) . To illustrate how various waning assumptions affect disease prevalence and the vaccination frequency needed to avoid an outbreak to occur , we use the following parameter values . The life expectancy is set to µ − 1 = 80 years , the mean infectious period is set to γ − 1 = 0 . 02 years ( one week ) and the average cumulative immunity is to ω − 1 = 1 year . These parameter values are reasonable for several infectious diseases including COVID - 19 , influenza , common cold , etc [ 12 , 13 , 14 , 15 ] . Although the waning rate ω could be estimated using for instance the antibody decay data [ 16 , 17 ] , we do not attempt to do so here . The amount of waning heterogeneity is measured by the coefficient of variation σ of immunity heterogeneity , which is always smaller than (cid:112) p / ( 1 − p ) . We vary β ( or equivalently R 0 ) and σ ( often with p = 50 % fixed but sometimes also varying p ) . Using the different models we compare the endemic prevalence levels without vaccination , and the required amount of vaccines to reach a sustainable herd immunity . 5 . 1 Endemic prevalence Fig . 3 shows heatmaps of the endemic level for the heterogeneous SIRS model ( 1 ) and our new heterogeneous SIR ( ∞ ) S model ( 2 ) , as functions of R 0 and σ ( without vaccination ) . It can be seen from Figs . 3a - 3b that the long term prevalence is increasing in R 0 ( as expected ) but also in population heterogeneity σ . Moreover , Fig . A . 1 in the Appendix A shows that the difference between homogeneous and heterogeneous populations increases with p ( the community fraction having the lower immunity , i . e . higher waning rate ) . The homogeneous models ( σ = 0 ) have the lowest endemic levels irrespective of the immunity waning mode ( sudden or gradual loss ) . 5 . 2 Optimal vaccination : Perfect vaccine 5 . 2 . 1 Possible vaccination times Fig . 4 shows the best vaccination strategies for the informed and uninformed situations . The optimal strategy always vaccinate type 1 ( with higher waning rate ) at a lower immunity level compared to type 2 individuals ( both informed and uninformed ) . In the informed situation it may even be optimal to only vaccinate type 2 individuals , e . g . when R 0 is small enough ( Fig . 4a ) or if ω 1 is very large so these individuals loose their immunity very quickly implying that there is not much gain in vaccinating them . However , the time ( since vaccination ) at which we vaccinate type 1 could be bigger or smaller than the time for type 2 . Plot 4a shows that only type - 2 need to be vaccinated , at time t 2 , when R 0 = 1 . 6 , but later on also type - 1 have 8 0 . 00 0 . 25 0 . 50 0 . 75 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 0 . 3 E nde m i c l e v e l ( a ) 0 . 00 0 . 25 0 . 50 0 . 75 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 0 . 3 E nde m i c l e v e l ( b ) Figure 3 : Heatmaps of the endemic level for different values of R 0 and σ ( p = 50 % ) in ( a ) the heterogeneous SIRS model and ( b ) the heterogeneous SIR ( ∞ ) S model . The value at the origin is 0 and the contour interval is 2 % of the population . to be vaccinated , at time t 1 , when R 0 increases to 2 as shown in Fig . 4b . When R 0 = 2 . 4 , the vaccination time t 1 of type - 1 becomes smaller compared to t 2 for type - 2 as seen in Fig . 4c . In the uninformed situation all individuals need to be vaccinated after the same time t since their last vaccination . 5 . 2 . 2 Optimal vaccination scheme Fig . 5 shows the minimum number of vaccine doses per person per year to achieve and maintain herd immunity according to the heterogeneous SIR ( ∞ ) S model . It is evident from the plots that the critical amount of vaccine supply in the continuous waning situation ( for fixed p ) is increasing in the coefficient of variation of population heterogeneity σ . Moreover , the bigger the fraction p ( of immune - weak type 1 individuals ) , the bigger the critical amount of vaccine supply . This indicates that heterogeneity in population immunity requires more frequent vaccination . It is worth mentioning that the optimal vaccine supply is not always increasing in heterogeneity when immunity wanes in one sudden leap as illustrated in Fig . A . 2 in the Appendix . Table 2 compares the critical vaccination frequency for different models when R 0 = 5 ( and σ = 0 . 5 for the heterogeneous models ) . While the simple SIRS model suggests to vaccinate individuals every 15 months ( 0 . 81 doses per year ) to maintain herd immunity , the hetero - geneous exponentially waning immunity model increases this vaccination frequency to every ≈ 4 . 6 months in the informed situation ( ≈ 2 . 62 doses per person per year ) , and to ≈ 4 . 4 months in the more realistic uninformed situation ( ≈ 2 . 76 doses per person per year ) . Table 3 compares the value of R v for a given vaccine supply per year and shows that knowing individ - uals immunity status reduce the effective reproduction number compared to the uninformed situation , the difference is however moderate . 5 . 3 Optimal vaccination : Leaky vaccine Table 4 compares the optimal vaccination frequency in case of a leaky vaccine for the consid - ered models . It is clear from the table that the optimal vaccination frequency increases as the protection e becomes smaller . While herd immunity could be achieved with imperfect vaccines with relatively high efficacy when immunity wanes at once ( e . g . by approximately adminis - trating 80 % - effective vaccines every 8 . 9 months on average – Table 4 ) , herd immunity under 9 0 i u , 2 i 2 1 t 2 t Time since vaccination I mm un i t y l e v e l ( a ) R 0 = 1 . 6 . i 1 i u , 1 i u , 2 i 2 1 t 2 t t 1 Time since vaccination I mm un i t y l e v e l ( b ) R 0 = 2 . i u , 1 i 1 i 2 i u , 2 1 t 1 t t 2 Time since vaccination I mm un i t y l e v e l ( c ) R 0 = 2 . 4 . Figure 4 : Informed and the uninformed optimal vaccination times for different values of R 0 with σ = 0 . 5 ( p = 50 % ) . Blue and Red solid curves are immunity waning functions of type - 1 and type - 2 individuals respectively . The best informed vaccination strategy is to vaccinate 1 - individuals at time t 1 ( with the immunity level ι 1 ) and 2 - individuals at time t 2 ( with the immunity level ι 2 ) . The best uninformed vaccination strategy is to vaccinate everyone at time t , that is , 1 - individuals and 2 - individuals at the immunity levels ι u , 1 and ι u , 2 respectively . 10 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 5 10 15 20 Y ea r l y # do s e s pe r pe r s on ( a ) p = 25 % . 0 . 00 0 . 25 0 . 50 0 . 75 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 5 10 15 20 Y ea r l y # do s e s pe r pe r s on ( b ) p = 50 % . 0 . 0 0 . 5 1 . 0 1 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 5 10 15 20 Y ea r l y # do s e s pe r pe r s on ( c ) p = 75 % . Figure 5 : Heatmaps of the critical vaccine supply for different values of p in the uninformed scenario of the SIR ( ∞ ) S model . The value at the origin is 0 and the contour interval is 1 yearly dose per person . continuous waning would require very high vaccine efficacy and that in both homogeneous and heterogeneous situations . 5 . 4 Two extreme models comparison In [ 7 ] , the standard SIRS model and the homogeneous SIR ( ∞ ) S model were compared and found that the latter has the larger endemic level and the higher critical vaccine supply . Fig . 6 added a comparison with the heterogeneous SIR ( ∞ ) S model , with the critical vaccine supply plotted under the uninformed situation . It is clear that the biggest effect comes from the continuous waning of immunity compared to the sudden loss assumption . Still , heterogeneity makes the situation worse as it increases long - term prevalence and the critical vaccine coverage , in particular when heterogeneity is substantial . 6 Discussion In the current paper we have shown that if immunity wanes gradually but at different rates for different individuals , the effect of such heterogeneity is that endemic prevalence becomes higher , and when introducing vaccinations , more vaccines are required to reach and sustain herd immunity . This effect is shown to be substantial even when heterogeneity of immunity waning is moderate ( e . g . coefficient of variation 0 . 5 ) . An additional feature treated in our 11 Table 2 : Critical vaccination schemes for R 0 = 5 for the different models . The heterogeneous models are computed with σ = 0 . 5 and p = 50 % . Vaccination frequency ( in months ) Yearly # doses per person Hom . SIRS 15 0 . 81 Het . SIRS : informed 12 . 8 ( 10 / 17 . 7 ) 1 0 . 94 Hom . exp . waning 5 . 5 2 . 15 Het . exp . waning : informed 4 . 6 ( 3 . 8 / 5 . 7 ) 2 . 62 Het . exp . waning : uninformed 4 . 4 2 . 76 1 x ( y / z ) means that vaccines are given to type - 1 individuals every y time units and type - 2 every z time units , resulting in vaccinating everyone every x time units on average . Table 3 : Reproduction number for different values of individual vaccine supply per year given R 0 = 5 and σ = 0 . 5 ( p = 50 % ) under exponential waning of immunity . Yearly # doses per person θ = 0 θ = 1 / 2 θ = 1 θ = 2 θ = 3 Informed 5 2 . 99 2 . 08 1 . 26 0 . 90 Uninformed 5 3 . 01 2 . 09 1 . 29 0 . 93 analysis is to distinguish between the informed situation where the waning heterogeneity is known and taken into account when designing vaccination policies , and the more likely uninformed scenario where such heterogeneities are unobserved . It is shown that the informed and uniformed situations differ in vaccination policies , but the required amount of vaccines for maintaining herd immunity is only moderately higher for the more likely uninformed situation . This comparison between the homogeneous and heterogeneous situations , calibrated by assuming the same population average of cumulative immunity , hence has the heterogeneous situation as the worse case . As a consequence , models neglecting waning heterogeneities can estimate too low vaccination rates . This result is in contrast with many other comparisons in epidemic models in which the homogeneous situation is often the worst case scenario . Two such examples are [ 18 ] who considers variable susceptibility to the homogeneous situation where all individuals have the same susceptibility ( see also [ 19 ] ) , and the second example is epidemics on networks where the final size is maximized when all individuals have equal degree ( if the transmission rate is large enough ) [ 20 ] . Our new epidemic model with gradual waning rate with individual heterogeneity neglects many other factors affecting diseases dynamics . Such factors may for example include demo - graphic structure , behaviour change of the population , elements of chance , individual hetero - geneity also with respect to infectivity and susceptibility , social population structures , and so on . Here we neglect such aspects and focus on heterogeneity of immunity waning . It would be of interest to study the effect of waning heterogeneity also when including other realistic model features . It is our belief that the same qualitative observation remains : heterogeneity in immunity waning makes the situation worse , but clearly this needs to be shown . 12 Table 4 : Critical vaccination frequency ( in months ) for the different models when R 0 = 5 ( σ = 0 . 5 and p = 50 % in heterogeneous settings ) . Vaccine efficacy e = 100 % ( perfect ) e = 95 % e = 90 % e = 80 % SIRS 15 14 13 . 2 11 . 8 Het . SIRS : informed 12 . 8 ( 10 / 17 . 7 ) 1 11 . 7 ( 8 . 7 / 17 . 7 ) 10 . 7 ( 7 . 7 / 17 . 7 ) 8 . 9 ( 6 / 17 . 7 ) Hom . exp . waning 5 . 5 4 . 5 3 . 3 – Het . exp . waning : informed 4 . 6 ( 3 . 8 / 5 . 7 ) 3 . 7 ( 2 . 7 / 4 . 8 ) 2 . 6 ( 1 . 8 / 3 . 4 ) – Het . exp . waning : uninformed 4 . 4 3 . 5 2 . 5 – 1 12 . 8 ( 10 / 17 . 7 ) means that vaccines are given to type - 1 individuals every 10 months and type - 2 every 17 . 7 months , resulting in vaccinating individuals every 12 . 8 months on average . 0 . 00 0 . 03 0 . 06 0 . 09 2 . 5 5 . 0 7 . 5 10 . 0 R 0 Hom . SIRS Hom . SIR ¥ S Het . SIR ¥ S Endemic level ( a ) 0 2 4 2 . 5 5 . 0 7 . 5 10 . 0 R 0 Hom . SIRS Hom . SIR ¥ S Het . SIR ¥ S Critical vaccine supply ( b ) Figure 6 : Comparison of the standard SIRS model , the homogeneous SIR ( ∞ ) S model , and the heterogeneous SIR ( ∞ ) S model with σ = 0 . 5 ( p = 50 % ) . ( a ) endemic levels and ( b ) the yearly number of vaccine doses per person required for herd immunity . Acknowledgement The authors are grateful to Gianpaolo Scalia - Tomba for helpful discussions . Funding M . E . K . is grateful to NordForsk ( project 105572 ) and T . B . is grateful to The Swedish Research Council ( grant 2020 - 0474 ) for financial support . Ethics declarations The authors declare no competing interests . 13 Data availability All data generated or analysed during this study are included in this published article and its supplementary information files . References [ 1 ] Wheatley AK , Juno JA , Wang JJ , Selva KJ , Reynaldi A , Tan HX , et al . Evolution of im - mune responses to SARS - CoV - 2 in mild - moderate COVID - 19 . Nature communications . 2021 ; 12 ( 1 ) : 1162 . [ 2 ] Hethcote HW . Qualitative analyses of communicable disease models . Mathematical biosciences . 1976 ; 28 ( 3 - 4 ) : 335 - 56 . [ 3 ] Hethcote HW . An immunization model for a heterogeneous population . Theoretical population biology . 1978 ; 14 ( 3 ) : 338 - 49 . [ 4 ] Reluga TC , Medlock J , Perelson AS . Backward bifurcations and multiple equilibria in epi - demic models with structured immunity . Journal of theoretical biology . 2008 ; 252 ( 1 ) : 155 - 65 . [ 5 ] Martcheva M . An introduction to mathematical epidemiology . vol . 61 . Springer ; 2015 . [ 6 ] Forien R , Pang G , Pardoux ´E , et al . Stochastic epidemic models with varying infectivity and susceptibility . arXiv preprint arXiv : 221004667 . 2022 . [ 7 ] El Khalifi M , Britton T . Extending SIRS epidemics to allow for gradual waning of immunity . Journal of the Royal Society Interface . 2022 , in press . [ 8 ] Fabiani M , Puopolo M , Morciano C , Spuri M , Alegiani SS , Filia A , et al . Effectiveness of mRNA vaccines and waning of protection against SARS - CoV - 2 infection and severe covid - 19 during predominant circulation of the delta variant in Italy : retrospective cohort study . bmj . 2022 ; 376 . [ 9 ] Shrotri M , Navaratnam AM , Nguyen V , Byrne T , Geismar C , Fragaszy E , et al . Spike - antibody waning after second dose of BNT162b2 or ChAdOx1 . The Lancet . 2021 ; 398 ( 10298 ) : 385 - 7 . [ 10 ] Widge AT , Rouphael NG , Jackson LA , Anderson EJ , Roberts PC , Makhene M , et al . Durability of responses after SARS - CoV - 2 mRNA - 1273 vaccination . New England Jour - nal of Medicine . 2021 ; 384 ( 1 ) : 80 - 2 . [ 11 ] P´erez - Al´os L , Armenteros JJA , Madsen JR , Hansen CB , Jarlhelt I , Hamm SR , et al . Modeling of waning immunity after SARS - CoV - 2 vaccination and influencing factors . Nature communications . 2022 ; 13 ( 1 ) : 1614 . [ 12 ] Byrne AW , McEvoy D , Collins AB , Hunt K , Casey M , Barber A , et al . Inferred duration of infectious period of SARS - CoV - 2 : rapid scoping review and analysis of available evidence for asymptomatic and symptomatic COVID - 19 cases . BMJ open . 2020 ; 10 ( 8 ) : e039856 . [ 13 ] Davies NG , Klepac P , Liu Y , Prem K , Jit M , Eggo RM . Age - dependent effects in the transmission and control of COVID - 19 epidemics . Nature medicine . 2020 ; 26 ( 8 ) : 1205 - 11 . 14 [ 14 ] Hall V , Foulkes S , Insalata F , Kirwan P , Saei A , Atti A , et al . Protection against SARS - CoV - 2 after Covid - 19 vaccination and previous infection . New England Journal of Medicine . 2022 ; 386 ( 13 ) : 1207 - 20 . [ 15 ] CDC . How Flu Spreads ; 2022 . Available from : https : / / www . cdc . gov / flu / about / disease / spread . htm . [ 16 ] Goldberg Y , Mandel M , Bar - On YM , Bodenheimer O , Freedman L , Haas EJ , et al . Wan - ing immunity after the BNT162b2 vaccine in Israel . New England Journal of Medicine . 2021 ; 385 ( 24 ) : e85 . [ 17 ] Bobrovitz N , Ware H , Ma X , Li Z , Hosseini R , Cao C , et al . Protective effectiveness of previous SARS - CoV - 2 infection and hybrid immunity against the omicron variant and severe disease : a systematic review and meta - regression . The Lancet Infectious Diseases . 2023 . [ 18 ] Ball F . Deterministic and stochastic epidemics with several kinds of susceptibles . Ad - vances in applied probability . 1985 ; 17 ( 1 ) : 1 - 22 . [ 19 ] Elbasha EH , Gumel AB . Vaccination and herd immunity thresholds in heterogeneous populations . Journal of mathematical biology . 2021 ; 83 ( 6 - 7 ) : 73 . [ 20 ] Britton T , Trapman P . Maximizing the size of the giant . Journal of Applied Probability . 2012 ; 49 ( 4 ) : 1156 - 65 . 15 A Appendix A . 1 Proof A . 1 . 1 Proposition 1 First , it is easy to see that only the disease free equilibrium exists when R 0 < 1 . Next , we assume that R 0 > 1 and let ˆ i = ˆ i 1 + ˆ i 2 to denote the endemic level . By equating the right hand side equations of ( 1 ) to 0 and after some simplifications , we get into ˆ i = pR 0 ( µ + γ ) ( µ + ω 1 ) ˆ i (cid:16) R 0 ( µ + γ ) ˆ i + µ (cid:17) ( µ + γ + ω 1 ) + ω 1 γ + ( 1 − p ) R 0 ( µ + γ ) ( µ + ω 2 ) ˆ i (cid:16) R 0 ( µ + γ ) ˆ i + µ (cid:17) ( µ + γ + ω 2 ) + ω 2 γ , ( 9 ) where we replaced β by R 0 ( µ + γ ) . That is , ˆ i is the ( positive ) fixed point of the function ψ defined by ψ ( x ) = pR 0 ( µ + γ ) ( µ + ω 1 ) x ( R 0 ( µ + γ ) x + µ ) ( µ + γ + ω 1 ) + ω 1 γ + ( 1 − p ) R 0 ( µ + γ ) ( µ + ω 2 ) x ( R 0 ( µ + γ ) x + µ ) ( µ + γ + ω 2 ) + ω 2 γ , which is increasing on the positive real half line and verifies lim x →∞ ψ ( x ) < 1 . Moreover , it can be shown that its derivative at x = 0 satisfies ψ ′ ( 0 ) > 1 as long as R 0 > 1 ( and equals to 1 when R 0 = 1 ) . Hence , ψ has a unique positive fixed point ˆ i , the endemic level , provided that R 0 > 1 . Consequently , the equation ( 1 ) has a unique endemic equilibrium if and only if R 0 > 1 . A . 1 . 2 Proposition 2 Now , we recall that ω 1 = ω / (cid:16) 1 − σ (cid:112) ( 1 − p ) / p (cid:17) and ω 2 = ω / (cid:16) 1 + σ (cid:112) p / ( 1 − p ) (cid:17) with 0 ≤ σ < (cid:112) p / ( 1 − p ) . To prove that the endemic level is increasing in σ , it is enough to show that the right hand side Eq . ( 9 ) is increasing in σ . This function could be defined by f ( σ ) = p ( µ + ω ) − σµ (cid:112) p ( 1 − p ) ( βi + µ ) ( µ + γ ) + ω ( βi + µ + γ ) − σ (cid:112) ( 1 − p ) / p ( βi + µ ) ( µ + γ ) + ( 1 − p ) ( µ + ω ) + σµ (cid:112) p ( 1 − p ) ( βi + µ ) ( µ + γ ) + ω ( βi + µ + γ ) + σ (cid:112) p / ( 1 − p ) ( βi + µ ) ( µ + γ ) , Then , by differentiating , we obtain that the sign of f ′ ( σ ) is the same as the sign of 2 ( ( βi + µ ) ( µ + γ ) + ω ( βi + µ + γ ) ) + σ ( βi + µ ) ( µ + γ ) (cid:18)(cid:114) p 1 − p − (cid:114) 1 − p p (cid:19) , which is positive provided that p ≥ 1 / 2 . Hence , f is increasing in σ , and so is the endemic level . A . 1 . 3 Proposition 3 From the infective equations in Eq . ( 2 ) , and using the fact that s 1 ( t ) + s 2 ( t ) + (cid:90) t 0 r 1 ( τ ) dτ + (cid:90) t 0 r 2 ( τ ) dτ = 1 − ( i 1 ( t ) + i 2 ( t ) ) , the differential equation of the total infective fraction i = i 1 + i 2 verifies i ′ ( t ) ≤ βi ( t ) ( − i ( t ) + 1 − 1 / R 0 ) . ( 10 ) 16 For any positive initial point z 0 , the solution to the ODE z ′ ( t ) = βz ( t ) ( − z ( t ) + 1 − 1 / R 0 ) converges to 0 when R 0 ≤ 1 . Then from the Ineq . ( 10 ) , we obtain that i ( t ) → 0 as t → ∞ when R 0 ≤ 1 . Hence , the infective and recovered fractions vanish . Moreover , the total susceptible fraction s 1 + s 2 converges to 1 . This proves the first assertion of the Proposition 3 . Now , we proceed to prove the second assertion of Proposition 3 . Solving the endemic equilibrium of system ( 2 ) allows to write µ 2 − βs l ( i 1 + i 2 ) − µs l = 0 , ( 11 ) ∂r l ( a ) ∂a = − β (cid:0) 1 − e − ω l a (cid:1) r l ( a ) ( i 1 + i 2 ) − µr l ( a ) , r l ( 0 ) = γi l , ( 12 ) for l ∈ { 1 , 2 } , coupled with i 1 = p − s 1 − (cid:90) ∞ 0 r 1 ( τ ) dτ , and i 2 = 1 − p − s 2 − (cid:90) ∞ 0 r 2 ( τ ) dτ . ( 13 ) It is easy to see that an endemic equilibrium verifies both i 1 ̸ = 0 and i 2 ̸ = 0 . Set i = i 1 + i 2 , then solving the ordinary differential equation for the recovered equations , we obtain r l ( τ ) = γi l ϕ l ( i ) , l ∈ { 1 , 2 } , ( 14 ) where ϕ l , l = 1 , 2 , are the functions defined by ϕ l ( x ) = (cid:90) ∞ 0 exp (cid:18) − µτ − βx (cid:90) τ 0 (cid:0) 1 − e − ω l a (cid:1) da (cid:19) dτ . ( 15 ) Then , we arrived to i 1 = p (cid:18) 1 − µ βi + µ − γi 1 ϕ 1 ( i ) (cid:19) , i 2 = ( 1 − p ) (cid:18) 1 − µ βi + µ − γi 2 ϕ 2 ( i ) (cid:19) . ( 16 ) Re - arranging both equations allows to write i 1 and i 2 in terms of i as i 1 = βi βi + µ p 1 + γϕ 1 ( i ) , i 2 = βi βi + µ 1 − p 1 + γϕ 2 ( i ) . ( 17 ) Taking the sum , it yields that i = βi βi + µ (cid:18) p 1 + γϕ 1 ( i ) + 1 − p 1 + γϕ 2 ( i ) (cid:19) . ( 18 ) As i ̸ = 0 , we cancel one i and get to the following equation i = (cid:18) p 1 + γϕ 1 ( i ) + 1 − p 1 + γϕ 2 ( i ) (cid:19) − µ β . ( 19 ) The right - hand side of ( 19 ) is increasing in i and smaller than 1 − µ / β . Moreover , it converges to µ ( R 0 − 1 ) / β as i → 0 . On the other hand , as ϕ l , l = 1 , 2 , are convex functions , the right - hand side of ( 19 ) is a concave down function . That is , Eq . ( 19 ) has a unique positive solution when R 0 > 1 and no positive solution when R 0 ≤ 1 . Since the right - hand side functions of ( 17 ) are increasing in i , the steady points i 1 and i 2 are defined from i uniquely . This completes the proof . 17 A . 2 Formulation of the SIR ( k ) S model with heterogeneity Here we present the details of the determination of the immunity levels { 1 − f l , j } k − 1 j = 1 and the immunity jumps rates { c l , j } kj = 1 in the model ( 3 ) in the main text for fixed l ∈ { 1 , 2 } . Let { f l , j } k − 1 j = 1 be an increasing sequence of elements of ( 0 , 1 ) . An l - individual recently recovered stays perfectly immune for an exponentially time with mean duration 1 / c l , 1 , after that im - munity drops to 1 − f l , 1 . Each 1 − f l , j immunity level lasts for an exponentially time with mean 1 / c l , j + 1 for j = 1 , · · · , k − 1 . The susceptibility levels and the rates are chosen to fit the exponential waning with rate w l and to satisfy the constant average cumulative immunity equation 1 c l , 1 + k − 1 (cid:88) j = 1 ( 1 − f l , j ) 1 c l , j + 1 = 1 ω l . ( 20 ) We mention that there is no unique way to define the immunity jumps and the rates above , yet their choice would not affect the results for typically large k as long as all jumps become small and rates large . In the informed situation , we choose f l , j = j / k so the immunity jumps by 1 / k each step . We then define the rates by 1 c l , 1 = − 1 w l log (cid:18) k − 1 k + x k (cid:19) , ( 21 ) 1 c l , j = 1 w l (cid:18) − log (cid:18) k − j k + x k (cid:19) + log (cid:18) k − j + 1 k + x k (cid:19)(cid:19) , j = 2 , · · · , k , ( 22 ) where x ∈ ( 0 , 1 ) solves the cumulative immunity equation ( 20 ) , that is , the equation − log (cid:18) k − 1 k + x k (cid:19) + k − 1 (cid:88) j = 1 k − j k (cid:18) − log (cid:18) k − j k + x k (cid:19) + log (cid:18) k − j + 1 k + x k (cid:19)(cid:19) = 1 . ( 23 ) In the uninformed situation we assume fixed ( in l ) immunity jump rates , that is c 1 , j = c 2 , j = c j and set c j = k − j + 1 . We define the susceptibility levels by f l , j = 1 − exp (cid:32) − ω l ( 1 + x l ) j (cid:88) n = 1 1 c j (cid:33) , ( 24 ) with x l ∈ ( 0 , 1 ) is the solution to the the cumulative immunity equation ( 20 ) , that is , the equation k − 1 (cid:88) j = 0 1 k − j exp (cid:32) − ω l ( 1 + x l ) j (cid:88) n = 1 1 c j (cid:33) = 1 ω l . ( 25 ) A . 3 Disease - free equilibria Informed situation : The disease - free equilibrium E inf 0 = ( ˆ s 1 , ˆ s 2 , ˆ r 1 , 0 , ˆ r 2 , 0 , · · · , ˆ r 1 , k − 1 , ˆ r 2 , k − 1 ) of the models ( 5 ) is given by ˆ s l = p l µ µ + η 1 , k (cid:16) 1 − c k l , k A l k B l k − 1 (cid:17) , l = 1 , 2 , ( 26 ) ˆ r l , j = η l , k A lk B lj ˆ s l , j = 1 , · · · , k − 1 , l = 1 , 2 , ( 27 ) ˆ r l , 0 = 1 2 − ˆ s l − k − 1 (cid:88) j = 1 ˆ r l , j , l = 1 , 2 , ( 28 ) 18 where A lk = (cid:32) µ + c l , 1 − k − 1 (cid:80) j = 1 η l , j B lj (cid:33) − 1 and B lj = j (cid:81) n = 1 c l , n µ + c l , n + 1 + η l , n , for j = 1 , · · · , k − 1 and l = 1 , 2 . Uninformed situation : The disease - free equilibrium E uni 0 = ( ˆ s 1 , ˆ s 2 , ˆ r 1 , 0 , ˆ r 2 , 0 , · · · , ˆ r 1 , k − 1 , ˆ r 2 , k − 1 ) of the models ( 6 ) is given by ˆ s l = p l µ µ + η k (cid:0) 1 − c kk A k B k − 1 (cid:1) , l = 1 , 2 , ( 29 ) ˆ r l , j = η k A k B j ˆ s l , j = 1 , · · · , k − 1 , l = 1 , 2 , ( 30 ) ˆ r l , 0 = 1 2 − ˆ s l − k − 1 (cid:88) j = 1 ˆ r l , j , l = 1 , 2 , ( 31 ) where A k = (cid:32) µ + c 1 − k − 1 (cid:80) j = 1 η j B j (cid:33) − 1 and B j = j (cid:81) n = 1 c n µ + c n + 1 + η n , for j = 1 , · · · , k − 1 . A . 4 Endemic level : varying p Fig . A . 1 shows how the endemic level varies with R 0 and σ for different values of p for the heterogeneous SIRS model ( sudden loss of immunity ) and the heterogeneous SIR ( ∞ ) S model ( continuous waning ) . A . 5 Critical vaccine supply when immunity wanes in one sudden leap Fig . A . 2 plots the critical vaccine supply for different values of p for the informed case of the heterogeneous SIRS model with sudden loss of immunity . 19 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 025 0 . 050 0 . 075 0 . 100 E nde m i c l e v e l ( a ) p = 5 % . 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 025 0 . 050 0 . 075 0 . 100 E nde m i c l e v e l ( b ) p = 5 % . 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 05 0 . 10 E nde m i c l e v e l ( c ) p = 25 % . 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 05 0 . 10 E nde m i c l e v e l ( d ) p = 25 % . 0 . 0 0 . 5 1 . 0 1 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 E nde m i c l e v e l ( e ) p = 75 % . 0 . 0 0 . 5 1 . 0 1 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 E nde m i c l e v e l ( f ) p = 75 % . 0 1 2 3 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 0 . 3 E nde m i c l e v e l ( g ) p = 95 % . 0 1 2 3 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 0 . 1 0 . 2 0 . 3 E nde m i c l e v e l ( h ) p = 95 % . Figure A . 1 : Heatmaps of the endemic level for different values of R 0 and σ . Left hand panel : Heterogeneous SIRS model . Right hand panel : Heterogeneous SIR ( ∞ ) S model . The value at the origin is 0 and the contour interval is 2 % of the population . 20 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 2 4 6 8 C r i t i c a l v a cc i ne s upp l y ( a ) p = 5 % . 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 2 4 6 8 C r i t i c a l v a cc i ne s upp l y ( b ) p = 25 % . 0 . 00 0 . 25 0 . 50 0 . 75 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 2 4 6 8 C r i t i c a l v a cc i ne s upp l y ( c ) p = 50 % . 0 . 0 0 . 5 1 . 0 1 . 5 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 2 4 6 8 C r i t i c a l v a cc i ne s upp l y ( d ) p = 75 % . 0 1 2 3 2 . 5 5 . 0 7 . 5 10 . 0 R 0 s 2 4 6 8 C r i t i c a l v a cc i ne s upp l y ( e ) p = 95 % . Figure A . 2 : Heatmaps of the critical vaccine supply for different values of p in the informed SIRS model with sudden loss of immunity . The value at the origin is 0 and the contour interval is 1 yearly dose per person . 21
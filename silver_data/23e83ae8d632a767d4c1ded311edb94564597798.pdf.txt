Generalized contact matrices for epidemic modeling Adriana Manna 1 , Lorenzo Dall’Amico 2 , Michele Tizzoni 3 , M´arton Karsai 1 , 4 , Nicola Perra 5 1 Department of Network and Data Science , Central European University , Vienna , Austria 2 ISI Foundation , Turin , Italy 3 Department of Sociology and Social Research , University of Trento , Trento , Italy 4 R´enyi Institute of Mathematics , Budapest , Hungary 5 School of Mathematical Sciences , Queen Mary University of London , UK July 3 , 2023 Abstract Contact matrices have become a key ingredient of modern epidemic models . They account for the stratiﬁcation of contacts for the age of individuals and , in some cases , the context of their interactions . However , age and context are not the only factors shaping contact structures and aﬀecting the spreading of infectious diseases . Socio - economic status ( SES ) variables such as wealth , ethnicity , and education play a major role as well . Here , we introduce generalized contact matrices capable of stratifying contacts across any number of dimensions including any SES variable . We derive an analytical expression for the basic reproductive number of an infectious disease unfolding on a population characterized by such generalized contact matrices . Our results , on both synthetic and real data , show that disregarding higher levels of stratiﬁcation might lead to the under - estimation of the reproductive number and to a mis - estimation of the global epidemic dynamics . Furthermore , including generalized contact matrices allows for more expressive epidemic models able to capture heterogeneities in behaviours such as diﬀerent levels of adoption of non - pharmaceutical interventions across diﬀerent groups . Overall , our work contributes to the literature attempting to bring socio - economic , as well as other dimensions , to the forefront of epidemic modeling . Tackling this issue is crucial for developing more precise descriptions of epidemics , and thus to design better strategies to contain them . Contact matrices have become an integral part of realistic epidemic models for respiratory infections . Usually , they encode contact patterns through age - speciﬁc contact rates describing how frequently and for how long individuals of diﬀerent ages meet each other . The stratiﬁcation of contacts by age groups allows capturing heterogeneous mixing rates that are observed among individuals of diﬀerent ages [ 1 – 6 ] . Young adults , for example , are usually very active and tend to interact more with other young adults [ 7 ] . Elderly individuals , instead , tend to report the fewest number of contacts and their role in the transmission dynamics of many respiratory infections is less relevant [ 6 ] . Contact matrices can be further stratiﬁed by the setting where interactions take place since the number and type of contacts vary considerably by context too ( i . e . in household , workplace , school , community ) [ 5 , 8 ] . Mixing patterns disaggregated by age and context are key to estimating age - speciﬁc and context - speciﬁc transmission parameters for epidemic models , which are then used to guide health policy , evaluate intervention strategies and assess the risk of infection across population groups [ 9 – 12 ] . Despite their essential role , however , age and context are far from being the only important variables shaping contact patterns , disease dynamics , and epidemic outcomes . Individual characteristics related to socio - economic status ( SES ) such as wealth , race , ethnicity , occupation , and education , among others , have been shown to play a key role in the transmission of infectious diseases [ 13 – 16 ] . From the Inﬂuenza pandemics of 1918 and 2009 [ 17 , 18 ] to the West African Ebola outbreak [ 19 ] and the COVID - 19 pandemic [ 16 , 20 – 30 ] belonging to lower SES has been consistently associated with higher rates of infections , deaths , as well as reduced access to care and ability to comply with non - pharmaceutical interventions ( NPIs ) . Despite the recognised importance of SES in the transmission dynamics of close - contact infections , the overwhelming majority of epidemic models neglect these dimensions [ 13 – 16 ] . Socio - economic status is often considered only a posteriori in analyses of models’ outputs ( e . g . , number of deaths or cases ) but rarely enters at the core of their formulation as age does . The roots of this shortcoming can be traced 1 a r X i v : 2 3 06 . 17250v1 [ phy s i c s . s o c - ph ] 29 J un 2023 δ δ γ γ Figure 1 : Generalized contact matrices . a ) Schematic representation of generalized contact matrices . We can transform a K × K age - structured contact matrix C ( ﬁrst matrix on the left ) into a generalized matrix G with m new dimensions . Such transformation can be done according to diﬀerent generalization schemes that we discuss in the Methods and the Supplementary Information . In the plot , we consider m = 2 . Hence , the second matrix describes the stratiﬁcation of contacts across a second dimension i . e . , α , β ∈ [ 1 , 2 , 3 ] . The third matrix describes a further stratiﬁcation , i . e . , γ , δ ∈ [ 1 , 2 , 3 ] . For simplicity we show the stratiﬁcation across the new dimensions only for one entry of the lower level respectively . b ) Example of a ﬂatten generalized contact matrix including 3 dimensions G ( 72 × 72 ) . back to the lack of i ) modelling frameworks designed to consider SES ( or other variables ) as one , or more , of their structural features [ 16 ] , ii ) empirical surveys of social contact data including characteristics of the respondents to account for SES [ 7 , 31 ] . Here , we tackle the ﬁrst limitation by developing a general epidemic framework able to accommodate generalized contact matrices stratiﬁed by multiple dimensions . We focus on prototypical Susceptible - Exposed - Infectious - Recovered ( SEIR ) compartmental models and derive a closed - form expression for the basic reproductive number , R 0 , for any number of dimensions . In doing so , we quantify how much the R 0 computed from a generalized contact matrix diﬀers from classic models considering only one demographic attribute such as age . By inspecting the spectral properties of the classic and generalized contact matrices , we prove that models fed with the latter are characterized by a R 0 which is necessarily either equal to or higher than the corresponding value computed in single - attribute models . Interestingly , for a given set of disease parameters , we ﬁnd that correlations in contact patterns , such as mixing assortativity and heterogeneous activity , increase the value of R 0 . After validating our mathematical formulation with numerical simulations in theoretical scenarios , we showcase how the use of generalized contact matrices allows for more expressive epidemic models able to describe the eﬀects of NPIs during an outbreak accounting for possible heterogeneities in their adoption across population subgroups . Finally , we apply our approach to real data from Hungary and we quantify the possible misrepresentation induced by neglecting SES in simulated outbreaks . The results conﬁrm signiﬁcant diﬀerences between models . The use of generalized contact matrices , that stratify contacts by age and one SES dimension , in accordance with the mathematical derivations , leads to higher values of R 0 for a given disease , to lower values of attack rates for a given R 0 , and allows to capture heterogeneity in disease’s burden across SES groups . Results We consider a Susceptible - Exposed - Infectious - Recovered ( SEIR ) compartmental model where susceptible ( S ) are healthy individuals at risk of infection , exposed ( E ) are infected but not yet infectious , infectious ( I ) are able to spread the disease , and recovered ( R ) are no longer infectious nor susceptible to the disease [ 32 ] . Within this setting , we propose a modelling framework that extends classic approaches by including generalized contact matrices that stratify contacts across multiple dimensions . We provide an overview of standard contact matrices in epidemic models in the Supplementary Information . Generalized contact matrices We present an extension of classic epidemic models by introducing generalized contact matrices further stratiﬁed by other dimensions besides age or context . In what follows , we consider indicators of SES as new dimensions , but the formulation is general and could accommodate any other relevant categorical feature of the population under study . The proposed framework goes from the classic contact matrices C ij , where individuals are grouped according to their age bracket ( i , j ) , to G a , b , where individuals 2 are characterized by their age and m other categorical variables . Hence , a = ( i , α , β , . . . , γ ) and b = ( j , η , ν , . . . , ξ ) are index vectors ( i . e . , tuples ) representing individual’s membership to each category . We use Greek letters to highlight the diﬀerence between age and other dimensions . To provide a concrete example of a generalized contact matrix , we can imagine stratifying the population according to age ( i ∈ [ 1 , . . . , K ] ) , income ( α ∈ [ 1 , . . . , V 1 ] ) , and education attainment ( β ∈ [ 1 , . . . , V 2 ] ) . In this case the generalized contact matrix G a , b would describe the average number of contacts that an individual in age bracket i , income α , and education β has with individuals in age group j , income η , and education ν in a given time window ( see Figure 1 ) . From this perspective , the matrix C ij can be thought of as an aggregation of contact rates at lower levels of stratiﬁcation . As with any aggregated metric , the elements C ij are agnostic about the structure of contacts across other dimensions . We denote with K the number of age groups , while with V p the p ∈ [ 1 , . . . , m ] the number of groups in each of the other dimensions . While the generalized matrix G ( whose elements are G a , b ) can be naturally described as a multi - dimensional object , the use of T = K (cid:81) mp = 1 V p × K (cid:81) mp = 1 V p index vectors allows for a ﬂattened representation in a squared 2 - dimensional ( 2D ) matrix of size √ T × √ T . We note how the formulation can easily consider diﬀerent contexts where interactions take place , i . e . , G a , b = (cid:80) l ω l G ( l ) a , b , where ω l captures the relative importance of the diﬀerent social settings in the transmission [ 5 ] . Epidemic model As mentioned above , we study diseases whose natural history can be described by an SEIR compartmental model . Similar results can be obtained for others such as the SIS and SIR models . To include the generalized contact matrices G , we deﬁne X a as the number of individuals in groups a and compartment X where X ∈ [ S , E , I , R ] . The dynamics of the model are described by the following set of diﬀerential equations : d t S a ( t ) = − Λ a ( t ) S a ( t ) d t E a ( t ) = Λ a ( t ) S a ( t ) − Ψ E a ( t ) d t I a ( t ) = Ψ E a ( t ) − Γ I a ( t ) d t R a ( t ) = Γ I a ( t ) ( 1 ) where Γ is the recovery rate , Ψ is the rate at which exposed become infectious , the force of infection Λ a ( t ) = Φ (cid:80) b G a , b I b ( t ) N b describes the per capita rate at which susceptible individuals in categories a acquire the infection , and Φ is the transmissibility of the disease . For simplicity of exposition , we neglect demography ( i . e , birth and death rates ) hence the size of the population is ﬁxed . To avoid confusion with the indices of the additional dimensions , the parameters regulating the disease dynamics are denoted with capital Greek letters . Basic reproductive number The basic reproductive number R 0 is one of the most important quantities of epidemiological rele - vance [ 32 ] . It is deﬁned as the number of secondary infections generated by a single infected seed in an otherwise susceptible population . In the case of standard contact matrices C , the R 0 of an SEIR model can be obtained using the next - generation matrix approach ( see Refs . [ 33 , 34 ] for overviews of this method ) . The expression reads R 0 = ΦΓ ρ ( ˜ C ) , where ρ denotes the spectral radius of the matrix ˜ C whose elements are ˜ C ij = C ij N j N i , N i and N j describe the number of individuals in age - bracket i and j respectively . How does this expression change when we consider generalized contact matrices ? In the following , we show that the generalisation to contact matrices featuring any number of dimensions can be still tackled with the next - generation matrix approach . First , we focus our attention only on the compartments E and I , which capture individuals in one of the two possible stages of infection . Furthermore , as a ﬁrst step , we consider the simplest form of generalized contact matrices featuring only one additional variable besides age , which we generally denote as an SES variable , i . e . , a = ( i , α ) . Let us deﬁne x as a vector of size 2 KV 1 such that x = ( E 11 , E 12 , . . . E KV 1 , I 11 , I 12 , . . . I KV 1 ) , where , for simplicity , we omitted the time dependence . We can express the set of diﬀerential equations for these compartments as d t x = f ( x ) − w ( x ) , where f ( x ) describes all terms that lead to new infections and w ( x ) all other transitions in and out of the compartments . The expression of R 0 is linked to the early epidemic dynamics , which can be linearized by calculating the Jacobian at the disease - free equilibrium ( DFE ) ( S ∗ iα , E ∗ iα , I ∗ iα , R ∗ iα ) = ( N iα , 0 , 0 , 0 ) for all age groups and SES . Note how N iα is the population in 3 age - group i and SES α . Using the Jacobian matrix J ( which has size 2 KV 1 × 2 KV 1 ) at the DFE we can write d t x = Jx . This expression can be conveniently factorized as d t x = ( F − W ) x where the matrix F is Jacobian applied to f ( x ) and similarly the matrix W is the Jacobian applied to w ( x ) . As shown in the Supplementary Information , the two matrices can be expressed as : F = Φ (cid:18) 0 ˜G 0 0 (cid:19) , W = (cid:18) Ψ I 0 − Ψ I Γ I (cid:19) ( 2 ) where 0 describes square blocks of zeros , I is the identity matrix , and ˜ G is a matrix whose element are ˜ G iα , jβ = G iα , jβ N jβ N iα . All these matrices have a size of KV 1 × KV 1 . Following the next - generation approach , we can obtain a closed - form expression for the basic reproductive number : R 0 = ρ ( FW − 1 ) = Φ Γ ρ ( ˜G ) ( 3 ) It is interesting to note how the structural features of all matrices , and thus R 0 , are analogous to the simple case of C . The key diﬀerence is in the size and composition of the matrices . Indeed , we shift from indices i and j to tuples a = ( i , α ) and b = ( j , β ) describing the contacts across groups and dimensions . As shown in the Supplementary Information , the same structure holds for any size of the index vectors . Hence , Eq . 3 is valid for any number of dimensions where ˜ G a , b = G a , b N b N a , a = ( i , α , . . . , γ ) , and b = ( j , η , . . . , ξ ) . Eq . 3 is valid also in case contacts are further stratiﬁed according to the context where they take place ( see Supplementary Information ) . As mentioned above , the contact matrix C can be considered as an aggregation of its generalized counterpart G , along all dimensions but the age . Since the total number of contacts in the population is independent of the aggregation , we can write C ij N i = (cid:80) a (cid:48) b (cid:48) G a (cid:48) , b (cid:48) N a (cid:48) , where a (cid:48) = a − { i } and b (cid:48) = b − { j } are the index vectors of size m capturing all dimensions but age . Similarly , we can obtain an expression for the average number of contacts that individuals in one SES , say α , have with others in the same SES β aggregating over all other groups C αβ N α = (cid:80) a (cid:48) b (cid:48) G a (cid:48) , b (cid:48) N a (cid:48) , where now a (cid:48) = a − { α } and b (cid:48) = b − { β } . In general , C ij (cid:54) = C αβ . Indeed , the number of groups and the number of individuals in each of them might be diﬀerent . Looking at contact patterns from multiple dimensions of stratiﬁcation highlights how the way interactions are aggregated ( i . e . , by age or other dimensions ) might aﬀect the estimation of key epidemiological parameters and the epidemic dynamics . For example , the spectral radius of standard contact matrices , as we saw , directly inﬂuences the basic reproductive number of the disease . Interestingly , in the Supporting Information , we prove how the spectral radius of generalized contact matrices is always larger than or equal to the corresponding value of the traditional and aggregated contact matrices . Hence , the estimation of R 0 might be aﬀected by the dimensions that are aggregated and also by those , which are explicitly considered in the stratiﬁcation . In particular , we show that strict equality can be attained under the random mixing hypothesis , i . e . , when the contacts are set proportional to the product of the subpopulation sizes . Overall , the variables used to capture the stratiﬁcation of contacts might aﬀect the description of epidemic processes , especially in the presence of non trivial correlations between explicit and implicit ( i . e . , aggregated ) variables . Indeed , the estimation of the spreading potential of disease via a model is not only a function of the total number of contacts but also of how these contacts are arranged across groups . This observation is one of the key insights from network - based epidemiology : the epidemic threshold ( i . e . , R 0 ) in two populations with the same number of individuals and number of contacts is drastically inﬂuenced by the way interactions are organized ( i . e . , the topology of the network ) [ 35 ] . Numerical simulations : synthetic data We test the analytical results obtained in the previous section by considering synthetic generalized contact matrices ﬁrst . To ground the results with some empirical observations , we build on real traditional contact matrices , where interactions are stratiﬁed only according to age groups . Here , we rely on data from Hungary by using a pre - COVID - 19 age contact matrix [ 36 ] , while we also report analogous ﬁndings for a diﬀerent country in the Supplementary Information . We create generalized contact matrices by adding more dimensions to the empirical matrices and by deﬁning the contact rates in the added groups with a simple model . We explore two cases . In the ﬁrst case , contact rates for the additional dimensions are set to be proportional to the product of the population sizes of the diﬀerent groups . This is the aforementioned random mixing . In the second case , instead , we investigate scenarios where contact rates among subgroups are deﬁned by parameters . This allows us to introduce correlations , such as assortativity , where members in a given group ( e . g . , in a SES class ) are more likely to contact people 4 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 35 . 74 a ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 35 . 74 b ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e c ) w / G ab w / C ij w / C 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 i n f e c t e d d ) dim2 123 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 52 . 5 e ) L M H dim2 L M H d i m 2 ( C ) : 43 . 89 f ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e g ) w / G ab w / C ij w / C 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 i n f e c t e d h ) dim2 123 5 10 15 20 25 2 . 5 5 . 0 7 . 5 10 . 0 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMHLMHLMHLMHLMHLMH 10 20 30 10 20 30 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMHLMHLMHLMHLMHLMH 0 . 004 0 . 006 0 . 008 0 . 0 0 . 1 0 . 2 0 . 3 0 . 004 0 . 006 0 . 008 0 . 0 0 . 1 0 . 2 0 . 3 0 200 0 . 00 0 . 05 0 . 10 w / G ab w / C ij w / C 0 100 0 . 00 0 . 05 0 . 10 w / G ab w / C ij w / C Figure 2 : Impact of generalized contact matrices on epidemic spreading . ( a ) Example of a classic age contact matrix C ( 8 × 8 ) ; ( b ) and ( e ) generalized contact matrices with an additional dimension with three groups G ( 24 × 24 ) in the case of random mixing ( b ) and in the case of assortative mixing ( e ) in the second dimension ; ( f ) depicts the case when we integrate the generalized contact matrix over all age classes . The ρ values indicate the spectral radius corresponding to each matrix . In panel ( c ) we show the attack rate as a function of R 0 and disease prevalence . In panel ( d ) the attack rate is shown as a function of time in the case of random mixing ; ( g ) and ( h ) are as the previous two plots but for the case of assortative mixing with diﬀerent levels of activity . Results refer to the median of 500 runs . Epidemiological parameters : Γ = 0 . 25 , Ψ = 0 . 4 , and R 0 = 2 . 7 . Simulations start with a number I 0 = 100 of initial infectious seeds . in the same group . Furthermore , in the second case , we introduce activity parameters to regulate the activity ( i . e . , share of contacts ) of the diﬀerent groups . As shown in Fig . 2 , when considering real data from Hungary with an additional dimension , non trivial correlations and heterogeneity appear . We refer the reader to the Material and Methods and the Supplementary Information for details about the construction of the synthetic generalized contact matrices . In Fig . 2 - a we display the real age contact matrix C for Hungary , which stratiﬁes interactions in K = 8 age brackets . While until the 45 - 60 age group , the highest values of contact rates are within the same age bracket ( i . e . , diagonal elements ) , we observe also strong oﬀ - diagonal values for age groups that range from 15 to 60 years . In Fig . 2 - b we show the ﬂatten 2D representation of a generalized contact matrix where , besides age , we have a second dimension . We imagine a simple case where the second dimension contains three groups , i . e . , V 1 = 3 . We assume that respectively 35 % , 45 % , and 20 % of the population belong to these three categories across all age groups for simplicity . The matrix is formed by K × V 1 = 24 distinct groups . Random mixing scenario First , we consider that contacts – when it comes to the second dimension – are proportional to the product of the population size in each group . Hence , they are the expected value of a random mixing process . As mentioned above , this assumption leads to a generalized contact matrix with the same spectral radius as the original contact matrix . The eﬀects of this property on an epidemic model , that used to study the unfolding of a virus in the population , are shown in Fig . 2 - c . We plot the attack rate ( i . e . , epidemic size ) as a function of R 0 for i ) a model fed only with the contact matrix C ij ( grey circles ) , ii ) a model fed with the generalized contact matrix G a , b described above ( green triangles ) , iii ) a model fed with the matrix C αβ where contacts are stratiﬁed only according to the second dimension ( red stars ) . As a result we observe , in perfect agreement with the analytical formulation , that R 0 = 1 divides the phase space into two regions . For values below this threshold , the disease is not able to spread in any of the three models . Only for values larger than one , the disease aﬀects a ﬁnite fraction of the population . We observe that the threshold and the attack rates for diﬀerent values of R 0 are the same in the ﬁrst two models . Hence , the description of the epidemic in a model that either neglects or considers a second dimension of contact stratiﬁcation does not change in case of random mixing in the second dimension 5 of contacts . As a consequence , the evolution of the fraction of infected individuals in the groups of the additional category is also the same ( see Fig . 2 - d ) . We note however clear diﬀerences with respect to the third model ( red stars ) that features a 3 × 3 contact matrix capturing the stratiﬁcation of contacts only for the additional category . A description of the epidemic in these settings leads to higher attack rates for any given R 0 > 1 . This observation conﬁrms how within the same population the chosen stratiﬁcation of contacts might aﬀect the description of an epidemic unfolding in the system . In the inset of Fig . 2 - c we show the attack rate as a function of the transmissibility Φ . The vertical dashed line denotes the analytical critical value of Φ obtained by setting Eq . 3 equal to one for the model featuring the generalized contact matrix . The plot shows the equivalence between the ﬁrst model and the second as well as the diﬀerence with respect to the third . Assortative scenario We now consider the second scenario : assortative mixing . In Fig . 2 - e we display the 2D ﬂattened generalized contact matrix obtained by assuming that 60 % , 50 % , and 65 % of the contacts in the ﬁrst , second , and third group of the additional category take place within each group , this way inducing assortativity . Furthermore , we assume some levels of heterogeneity also in the activity of the diﬀerent groups setting as 20 % , 40 % , and 40 % the share of contacts of the three groups , respectively . Even a qualitative visual inspection of the generalized contact matrix shows how the introduction of assortativity and activity visibly changes the contact rates ( see panel Fig . 2 - e ) with respect to the previous case of random mixing ( panel Fig . 2 - b ) . This is conﬁrmed by the value of the spectral radius which is around 46 % larger , increasing from ρ ( G ab ) = 35 . 74 to 52 . 5 . In Fig . 2 - f we show the matrix C αβ obtained after integrating the generalized contact matrix over all age classes . As imposed by construction , the third group is characterized by a higher assortativity than the others . It is the group featuring the smallest fraction of the population , and is the most active ( together with the second group ) . These characteristics explain the high diagonal value in the matrix describing the contact rate between people in that group . As a result , the spectral radius is 24 % higher ( being ρ ( C αβ ) = 43 . 89 ) with respect to the contact matrix stratiﬁed for age ( with ρ ( C ij ) = 35 . 74 ) . The impact of the diﬀerent contact matrices on the estimated attack rate is shown in Fig . 2 - g where we plot it as function of R 0 . The ﬁgure shows in each case that the critical point falls at R 0 = 1 , thus the analytical solutions match the numerical simulations very well . Contrary to the previous case of random mixing , the attack rate of the model that is informed with the contact matrix C ij and with the generalized matrix G a , b are diﬀerent for R 0 > 1 . Interestingly , the strong assortativity of contacts in the population constrains the spreading of the disease , resulting in a smaller fraction of the population aﬀected by the spreading ( see the green triangles ) . Furthermore , the most active group is also the smallest one in this setting . A similar behaviour is observed on contagion processes unfolding on explicit contact networks organized in clusters , where the local topological correlations might slow down the spreading of contagion processes that in turn do not evolve into an endemic state ( i . e . , SIR - like dynamics ) [ 37 ] . In case the contacts are stratiﬁed only according to the second dimension ( red stars ) , the attack rates are closer to those emerging from the generalized contact matrices ( green triangles ) . In the inset of the ﬁgure we show the attack rate as function of the transmissibility Φ . The vertical dashed line denotes the theoretical prediction of its critical value when considering the generalized contact matrices . Due to the diﬀerences in the spectral radius of the various matrices , the critical values of Φ do not coincide . In the setting considered here , neglecting the assortativity and activity across the second dimension in favour of simpler representations focused only on age or the additional variable leads to a possibly large underestimation of the critical value of Φ . Assortativity and activity introduce variations also in the burden of the diseases across the secondary dimension . Indeed , Fig . 2 - h shows how , in these settings , individuals in the third class are aﬀected earlier and more intensely than the others . This is due to their high activity and assortativity . Finally , in the inset of Fig . 2 - h we show the incidence for three models ﬁxing a given value of R 0 = 2 . 7 . Those standard contact matrices feature a smaller and later peak with respect to the other two . Even though these results are driven by the assumptions made when constructing the generalized contact matrix , they show how descriptions of epidemics with models , that include or neglect further stratiﬁcation of contacts beside age , might be extremely diﬀerent . In the Supplementary Information , we report a larger exploration of the parameter spaces , which conﬁrms the validity of the analytical solutions . In addition , we include also scenarios with additional dimensions . The results conﬁrm that Eq . 3 provides a good description of the epidemic dynamics even in generalized contact matrices with three dimensions . 6 25 100 175 time 0 . 00 0 . 05 0 . 10 % i n f e c t e d a ) dim2 123 25 100 175 time b ) 25 100 175 time c ) 25 100 175 0 . 00 0 . 05 0 . 10 w / G ab w / C ij w / C 25 100 175 0 . 00 0 . 02 0 . 04 25 100 175 0 . 00 0 . 02 0 . 04 Figure 3 : Modeling the adoption of non - pharmaceutical interventions ( NPIs ) . Disease preva - lence in ( a ) baseline scenario ( b ) and ( c ) with NPIs introduced at t ∗ = 50 that induce reduction of 35 % in total number of contacts with respect to the baseline scenario . In case of ( b ) the three groups reduce equally the number of contacts , while in ( c ) the NPIs induce a redistribution of the number of contacts . Curves in the main plot indicate the prevalence for the three groups of the additional dimension , while in the inset they represent the prevalence for models featuring generalized contact matrices ( green line ) , standard age - stratiﬁed contact matrices ( gray line ) , and contact matrices stratiﬁed by the additional dimensions ( red line ) . Results refer to the median of 500 runs with conﬁdence intervals . Epidemiological parameters : Γ = 0 . 25 , Ψ = 0 . 4 , and R 0 = 2 . 7 . Simulations start with I 0 = 100 initial infectious seeds . Modeling the adoption of non - pharmaceutical interventions As mentioned above , epidemic models featuring generalized contact matrices are more expressive with respect to traditional approaches . They allow capturing possible heterogeneities in behaviors that might span from the adoption of NPIs , to vaccination uptake across diverse groups of the population . Indeed , the COVID - 19 pandemic has been a stark reminder that the ability to comply with NPIs and vaccination rates are far from homogeneous . They correlate and are inﬂuenced by many SES variables [ 13 , 14 , 20 , 30 ] . Standard models allow describing such heterogeneities only partially , considering for example contact reductions as a function of age and location [ 38 ] . To showcase the potential of generalized contact matrices in this context , we explore hypothetical scenarios where a given population , featuring an additional dimension beside age , is changing behavior as a result of the introduction of NPIs . We consider the ability to reduce contacts to be related to the membership of a particular group of the population . We start with a pre - epidemic baseline where 33 % , 50 % and 60 % of the contacts in the ﬁrst , second , and third group of the additional category takes place within each group . In the baseline 25 % , 45 % , and 30 % are the shares of contacts of the three groups . For simplicity , we assume an even distribution of the population across the three groups . In Fig . 3 - a , we show the incidence of a disease that unfolds undisturbed by any NPIs in a population described by such baseline . Individuals in the second group are the most aﬀected as result of their higher activity . The inset shows the estimation of the overall incidence considering , as before , the three epidemic models featuring generalized contact matrices ( green line ) , standard age - stratiﬁed matrices ( grey line ) , and contact matrices stratiﬁed only for the second dimension ( red line ) . In these settings the ﬁrst model peaks a bit earlier , but the three curves are overall very similar . Then , we imagine two scenarios where at time t ∗ = 50 , due to NPIs , the population changes behaviors . We refer to the Supporting Information for the details about the implementation . In Fig . 3 - b we show what would happen to the epidemic in case of a homogeneous reduction scenario , when all groups would be able to reduce their contacts by 35 % . The impact of the NPIs is quite strong and induces a clear reduction of the peak across the three groups of the population . The inset of Fig . 3 - b shows how in this scenario the overall incidence , estimated with a model featuring generalized contact matrices ( green line ) , peaks earlier and higher than with the other two . The model fed with standard age - stratiﬁed contact matrices ( gray line ) is very similar . The third model ( red line ) instead is rather diﬀerent as the peak is not only lower but also delayed . This is another reminder of how the representation of contacts , the choice of which variables are considered or integrated , might aﬀect the estimation of the epidemic dynamics . In Fig . 3 - c , we explore a scenario where the ﬁrst group ( e . g . representing the lowest SES class ) is not able to protect itself as the other two manage to aﬀord . We model this by reducing the overall number 7 od contacts by 35 % but assuming that the NPIs introduce changes in both assortativity and activity . We imagine that due to the NPIs 50 % , 60 % and 70 % of the contacts in the ﬁrst , second , and third group of the additional category take place within each group . Hence , across the groups , assortativity increases , but more signiﬁcantly for the second and third group . Furthermore , we imagine that the NPIs shift activities to 37 % , 37 % , and 26 % across the three groups . Hence , while activity decreases for the second and third group , it relatively increases for the ﬁrst . Observing the incidence curves , we see how the NPIs bring a general reduction , but the changes in the contact patterns aﬀect the ﬁrst group more negatively . Indeed , we observe a switch from a baseline where this group was the least aﬀected to a scenario where it becomes the most aﬀected ( together with the third group ) . The inset of the ﬁgure shows the overall incidence for the three models which is very close to the previous . Numerical simulations : real data We applied the model to real data describing social contacts stratiﬁed by age and one SES variable ( self - perceived wealth with respect to the average ) in Hungary . The data has been collected via com - puter assisted surveys from 1 , 000 respondents describing a representative sample of the Hungarian adult population in terms of gender , age , education level and type of settlement [ 36 ] . We refer the reader to the Materials and Methods section and to the Supplementary Information for more details about the data and its collection . In Fig . 4 - a we show the traditional contact matrix that focuses only on age . Though similar , the structure of contact patterns diﬀers with respect to the equivalent matrix for the same country shown above in Fig . 2 - a . This discrepancy is due to the diﬀerent period these matrices represent . While the matrix in Fig . 2 - a has been collected for the pre - COVID - 19 period , data in Fig . 4 - a records typical contact patterns during the COVID - 19 pandemic , in particular in June 2022 . Although at that time the vaccination campaign was in full swing and the number of conﬁrmed cases and deaths was relatively low , the previous wave had peaked only a few months before and some level of social dis - tancing was still in place ( for more details about the construction and normalization of this matrix see the Supplementary Materials ) . The matrix conﬁrms that children and young adults are the most active and that their interactions are largely assortative . However , the matrix features a rather smaller spectral radius with respect to the pre - pandemic contact matrix . This highlights the reduction in contacts caused by the COVID - 19 emergency . In Fig . 4 - b , we show the stratiﬁcation of contacts considering only the SES variable , which divides the population into three SES classes with Low , Medium , and High wealth . Similar to other studies [ 39 , 40 ] , we observe a strong diagonal component , conﬁrming high levels of assortativity within SES groups . The population belonging to mid - low SES features lower assortativity and activity . Furthermore , the oﬀ - diagonal elements display higher levels of segregation for people in the low SES bracket , as individuals in mid and high SES tend to interact more with each other . In Fig . 4 - c we show the ﬂattened representation of the generalized contact matrix . Its spectral radius is higher than the other two , but the diﬀerence is clearly more limited with respect to the synthetic case we discussed in the previous section . In Fig . 4 - d we show the attack rate as a function of R 0 for a disease spreading in a susceptible population described with each of the three contact matrices discussed . It is important to stress that these simulations do not aim to reproduce the evolution of the COVID - 19 pandemic in Hun - gary . Instead , they describe a hypothetical disease spreading on diﬀerent representations of the contact patterns measured in June 2022 to showcase the possible variations in the description of an epidemic . The theoretical critical value for the basic reproductive number ( being at R 0 = 1 ) well captures the numerical simulations . Furthermore , for a given value of R 0 > 1 the attack rate estimated with a model featuring the generalized contact matrix ( green triangles ) is always smaller than any of the two other models . Also in this case , the more realistic description of contacts across multiple dimensions constrains the unfolding of the disease with respect to scenarios that neglect one of the two dimensions . However , the model featuring the contact matrix stratiﬁed by SES only ( red stars ) leads to higher attack rates than the model featuring an age - stratiﬁed contact matrix . The inset conﬁrms the validity of the mathematical formulation and highlights how a higher spectral radius results in a lower critical value for Φ . In Fig . 4 - e , we plot the incidence of the disease for the model with generalised contact matrix , splitting the three SES groups . Interestingly , we observe that individuals in the high SES group are the most aﬀected in terms of contracted infections . This is due to their higher contact activity . Those in the mid - SES follow very closely , partially due to the strong interaction activities with the ﬁrst group . Individuals in the low SES group , instead , are aﬀected later and with a lower incidence rate . In this scenario , where the population is not subject to further NPIs nor spontaneously changing behavior during the epidemic , the higher level of segregation experienced by the low SES group has the silver lining eﬀect of shielding that group from the epidemic , in accordance with empirical observations in the country [ 41 ] . In the inset of 8 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 8 . 55 a ) L M H dim2 L M H d i m 2 ( C ) : 7 . 92 b ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 8 . 95 c ) 0 . 6 0 . 7 0 . 8 0 . 9 1 . 0 1 . 1 1 . 2 1 . 3 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e d ) w / G ab w / C ij w / C 0 20 40 60 80 100 120 time 0 . 00 0 . 05 0 . 10 i n f e c t e d e ) SES lowmidhigh 1 2 3 4 5 1 2 3 4 5 6 0 1 2 3 4 5 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMHLMHLMHLMHLMHLMH 0 . 020 0 . 025 0 . 030 0 . 035 0 . 040 0 . 0 0 . 1 0 . 2 50 100 150 0 . 00 0 . 05 0 . 10 w / G ab w / C ij w / C Figure 4 : Real world generalized contact matrices . ( a ) Age contact matrix C ( 8 × 8 ) ; ( b ) Socio - economic status ( SES ) contact matrix C αβ ( 3 × 3 ) and ( c ) Generalized contact matrix with age and socio - economic status G ( 24 × 24 ) ; ( d ) attack rate as a function of R 0 and ( d ) disease prevalence as a function of time . In panels ( a - c ) ρ indicates the corresponding spectral radius . Results in panels ( d ) and ( e ) refer to the median of 500 runs . Epidemiological parameters : Γ = 0 . 25 , Ψ = 0 . 4 , and R 0 = 2 . 7 . Simulations start with I 0 = 100 initial infectious seeds . The matrices have been computed using the contact diaries coming from the MASZK data collected in Hungary during June 2022 . Fig . 4 - e we show the overall evolution of the disease obtained by modeling the epidemic with each one of the three contact matrices . The plot highlights how the chosen representation of contacts inﬂuences the description of the disease . Considering diﬀerent numbers or types of dimensions , in this case , induces diﬀerences in the estimation of peak time , which is a key variable used to inform public health measures . In the Supplementary Information , we repeat the same analyses considering data collected at diﬀerent time points of the COVID - 19 pandemic , in April and November 2021 . While the overall results conﬁrm the picture that emerged here , models fed with standard and generalized contact matrices lead to estima - tions of the attack rates , for a given R 0 , which are closer to each other . Nevertheless , the model featuring generalized contact matrices allows capturing heterogeneities in the incidence across SES groups , which are invisible to standard approaches . Discussion In this study , we developed a novel mathematical epidemic modelling framework featuring generalized contact matrices , that is , contact matrices that are stratiﬁed according to multiple dimensions such as variables linked to socio - economic status ( SES ) . The goal of our work is to move beyond the traditional representation of mixing patterns , based on age - speciﬁc or context - speciﬁc contact rates , allowing for the development of structured epidemic models that incorporate multiple groups of the population at the same time . First , we showed that the basic reproductive number , R 0 , of a model featuring generalized contact matrices can still be obtained analytically via the next - generation matrix approach developed for traditional compartmental models [ 33 , 34 ] . We then formally proved how the generalization to multiple dimensions leads to a value of R 0 , which is necessarily equal to or larger than for models considering only one grouping dimension . Interestingly , we found how non - trivial correlations of contacts across and within groups , such as assortativity and heterogeneous activity , increase the value of R 0 . Finally , through numerical simulations , we showed how models featuring generalized contact matrices better capture heterogeneous behaviours across population subgroups , such as varying rates of adherence to NPIs , as observed in reality [ 23 , 25 , 26 , 42 ] . By using both synthetic and real data from Hungary , we demonstrated how neglecting additional dimensions in favour of simpler representations of social contacts may result in large misrepresentations of attack rates , epidemic thresholds , and disease burden across 9 diﬀerent groups of a population . The COVID - 19 pandemic has tragically reminded us that health emergencies do not aﬀect popula - tions equally and that social , economic , and cultural forces fundamentally shape the outcome of disease outbreaks , reﬂecting the socio - economic inequalities of the society at large [ 43 – 46 ] . These observations are in stark contrast with the traditional structure of epidemic models , which generally neglect all vari - ables but age as the key demographic feature deﬁning disease transmission in a population [ 32 ] . Recent studies have highlighted the urgent need for novel modelling approaches that can account for the multiple social dimensions that deﬁne the risk of infection and infection outcomes [ 13 , 14 , 16 ] . In the wake of the COVID - 19 pandemic , works have introduced social contact matrices stratiﬁed by alternative demo - graphic groups , such as racial and ethnic subpopulations [ 47 ] , but usually without considering more than one dimension at once . As an alternative , scholars have developed large - scale individual - based models that reconstruct synthetic populations of millions of agents with extreme realism , including many key socio - economic characteristics [ 12 , 48 – 50 ] . Such models , however , require the availability of highly re - solved mobility data derived e . g . , from mobile phone logs , and large computational infrastructures for data processing and simulations . Previous studies have compared diﬀerent data representation methods , ranging from fully homogeneous mixing to temporal networks , to identify the relevant trade - oﬀs between compactness and realism [ 51 – 53 ] . Our work attempts to strike a balance between traditional approaches that are too simplistic and the complexity of large - scale synthetic populations , providing a general and ﬂexible scheme to deﬁne epidemic models with multiple interacting population subgroups . As for any structured epidemic modelling approach , our model requires data to parameterize social contact rates across subgroups . Social contact surveys have been and will continue to be an important asset for the study of mixing behaviors both in normal conditions and during epidemic outbreaks [ 2 , 31 , 54 – 58 ] . Future contact surveys could include additional demographic and socio - economic dimensions beyond the usual age / gender components . The work we presented here shows how such dimensions can be easily integrated by generalizing traditional epidemic models . In some cases , large - scale contact surveys including several population attributes can be unfeasible , especially in resource - poor settings . Alternative approaches could infer contact patterns from the analysis of demographic data that are routinely collected by census surveys [ 5 , 8 ] . Other proxies of contact rates , derived from mobility data , could be similarly used to infer contact patterns among diﬀerent socio - economic groups , as demonstrated by recent studies focusing on experienced segregation in large US metropolitan areas [ 59 , 60 ] . It is important to mention the limitations of our work and the directions for future developments of our study . Admittedly , the model we developed to generate synthetic generalized contact matrices does not attempt to reproduce empirical observations from real data , but rather to provide a general test bed for investigation . This choice was guided by the lack of available data about the stratiﬁcation of contacts across multiple dimensions in diﬀerent countries . As described , we had access to real - world data only for Hungary . Arguably , one country is not enough to develop a general model and more work is needed to design and test other approaches . Similarly , the methodology we used to simulate the eﬀects of NPIs was driven by simplicity rather than realism . Our intention was to showcase the potential of our model to capture possible heterogeneities in behaviours rather than reality . Data from Hungary contained limited information about social contacts of children . Hence , we had to introduce a few assumptions about their structure . Another important assumption we made is about the independence of age and other socio - economic dimensions . While this assumption was necessary to showcase our methodology , future work is needed to investigate the impact of such correlations on the description of epidemic processes and to explore the applicability / extension of methods for dimensionality reduction . Finally , it is important to acknowledge important ethical and privacy concerns linked with data collection eﬀorts that inspect individuals about several variables . Indeed , by increasing the number of dimensions the size of each surveyed group rapidly decreases . Risks of re - identiﬁcation are real and of particular concern , especially for minorities and underrepresented groups [ 61 ] . Progresses in the direction we have proposed here are necessarily linked to progress in data collection and dissemination that reconcile the development of better public health tools on the one side with privacy rights on the other [ 62 ] . Arguably , it is this unresolved tension that , among other reasons , has so far limited the collection and sharing of contact surveys data including more dimensions besides age . Nevertheless , the data we use demonstrates that such data collection is possible in an anonymous and privacy protected way . Overall , our work contributes to the literature by attempting to bring socio - economic and other dimensions to the forefront of epidemic modelling . Tackling this issue is crucial for developing more precise descriptions of epidemics , and thus to design better strategies to contain them . 10 Materials and Methods Synthetic generalized contact matrices We developed a model to build synthetic generalized contact matrices G a , b . For simplicity and clarity of exposition let us consider here only two dimensions : age and an additional variable as for example one SES indicator . In these settings a = ( i , α ) and b = ( j , β ) . The indices i and j refer to the age group while α and β to the SES of the ego and the alter respectively . The model takes as input a real contact matrix C ij describing the contact rates between age - brackets . As described above R ij = C ij N i is the total number of contact between the two groups in a given period . To build the generalized contact matrices G a , b we ﬁrst split the total contacts R ij across the second dimension and then we compute the contacts rates . In other words R ij = (cid:80) α , β R iα , jβ . Furthermore , the model must respect a key symmetry of these matrices : R iα , jβ = R jβ , iα . In words , the number of contacts that individuals in age group i and SES α have with individuals in age group j and SES β , must be equal to the number of contacts that individuals in age group j and SES β have with individuals in age group i and SES α . Hence R iα , jβ = R (cid:62) iα , jβ . This property implies that for all i = j R iα , iβ = R iβ , iα . In general this is not the case for i (cid:54) = j . For a given pair i and j the matrix R iα , jβ is of size V 1 × V 1 . Hence , for any i (cid:54) = j , we need a model to set W = V 21 − 1 elements of the matrix . For all i = j instead , the symmetry of the matrix is such that we need to set only Y = V 1 + V 1 ( V 1 − 1 ) 2 − 1 elements . We deﬁne the W and Y values of the matrices via simple model where , for any i and j pair , i ) each SES α is responsible for a fraction P α of R ij connections , ii ) a fraction q α of these are on the diagonal ( i . e . , in - group connections ) and 1 − q α are instead oﬀ - diagonal . This parameter controls the assortativity of connections within each group . The fractions P α and q α are input parameters . In case W or Y are equal to this number ( 2 V 1 − 1 ) , the constraints imposed by our assumptions allow to deﬁne all the entries of the matrix . If instead W > 2 V 1 − 1 , other W − 2 V 1 + 1 free parameters are required for each i and j pair . Interestingly , in case P α = q α = N α N it is easy to show how the contacts between groups become the expectation value of a random mixing process . We refer the reader to the Supplementary Information for more details about synthetic generalized contact matrices . Real generalized contact matrices We built generalized contact matrices stratiﬁed in two dimensions by using real data from the MASZK study [ 36 , 63 ] ( for more information about the data set see Supplementary Materials ) . The data provided us with a range of information about the anonymous participants including their perceived wealth with respect to the average , which is one SES variable we rely on . Information on social interactions have been collected in two diﬀerent ways i ) in an aggregate form , such that each participant reported the number of contacts they had with individuals in each of the eight age bracket considered , ii ) in a diary in which each participant listed one by one the interactions they had on a given day by reporting some meta information of the contactee such as their age and SES . In particular , the average number of contacts of an individual in age class i , and SES α with an individual in age class j , and SES β is G a , b where a = [ i , α ] and b = [ j , β ] . However , the MASZK data provided us with diary information only for the adult population ( individuals older than 15 years old ) . For the children , their average number of contacts is available only in the aggregate form for the eight age brackets considered . Thus , we assigned the average number of contactee to the diﬀerent SES as follow : G iα , jβ = G iα , j u αβ , where G iα , j is the average number of contacts that individual of age group i and SES α has with all the individuals of age group j , and u αβ is a parameter that controls how these contacts are distributed among individuals of diﬀerent SES . Numerical simulations To investigate the eﬀect of the generalized contact matrices G a , b on infection transmission dynam - ics , we developed a stochastic , discrete - time , compartmental model where the transitions among com - partments are simulated through chain binomial processes . In particular , at time step t the num - ber of individuals in group a and compartment X transiting to compartment Y is sampled from PrBin ( X a ( t ) , p X a −→ Y a ( t ) ) , where p X a −→ Y a ( t ) is the transition probability . Acknowledgements The authors gratefully thank Ciro Cattuto and Alessandro Vespignani for useful discussions . A . M . and M . K . were supported by the Accelnet - Multinet NSF grant . A . M . is grateful for the support from CEU and NetSI ( Northeastern University ) . M . K . acknowledges support from the ANR project DATAREDUX ( ANR - 19 - CE46 - 0008 ) ; the SoBigData + + H2020 - 871042 ; the EMOMAP CIVICA 11 projects ; and the National Laboratory for Health Security , Alfr´ed R´enyi Institute , RRF - 2 . 3 . 1 - 21 - 2022 - 00006 . L . D . acknowledges support from the Fondation Botnar and from the Lagrange Project of the ISI Foundation funded by CRT Foundation . Authors Contribution A . M . performed the numerical simulations and data analysis . A . M . , L . D . , and N . P . developed the analytical formulation . A . M . , M . T . , and N . P . wrote the ﬁrst draft of the manuscript . All authors designed the study , interpreted the results , edited and approved the manuscript . To whom correspondence should be addressed . E - mail : n . perra @ qmul . ac . uk References [ 1 ] W John Edmunds , CJ O’callaghan , and DJ Nokes . Who mixes with whom ? A method to determine the contact patterns of adults that may lead to the spread of airborne infections . Proceedings of the Royal Society of London . Series B : Biological Sciences , 264 ( 1384 ) : 949 – 957 , 1997 . [ 2 ] Jo¨el Mossong , Niel Hens , Mark Jit , Philippe Beutels , Kari Auranen , Rafael Mikolajczyk , Marco Massari , Stefania Salmaso , Gianpaolo Scalia Tomba , Jacco Wallinga , et al . Social contacts and mixing patterns relevant to the spread of infectious diseases . PLoS medicine , ( 3 ) : e74 , 2008 . [ 3 ] Kiesha Prem , Alex R Cook , and Mark Jit . Projecting social contact matrices in 152 countries using contact surveys and demographic data . PLoS computational biology , 13 ( 9 ) : e1005697 , 2017 . [ 4 ] Pejman Rohani , Xue Zhong , and Aaron A King . Contact network structure explains the changing epidemiology of pertussis . Science , 330 ( 6006 ) : 982 – 985 , 2010 . [ 5 ] Dina Mistry , Maria Litvinova , Ana Pastore y Piontti , Matteo Chinazzi , Laura Fumanelli , Marcelo F C Gomes , Syed A Haque , Quan - Hui Liu , Kunpeng Mu , Xinyue Xiong , M Elizabeth Halloran , Ira M Longini , Stefano Merler , Marco Ajelli , and Alessandro Vespignani . Inferring high - resolution human mixing patterns for disease modeling . Nature Communications , 12 ( 1 ) : 323 , 2021 . [ 6 ] Jacco Wallinga , Peter Teunis , and Mirjam Kretzschmar . Using data on social contacts to estimate age - speciﬁc transmission parameters for respiratory - spread infectious agents . American journal of epidemiology , 164 ( 10 ) : 936 – 944 , 2006 . [ 7 ] Thang Hoang , Pietro Coletti , Alessia Melegaro , Jacco Wallinga , Carlos G Grijalva , John W Ed - munds , Philippe Beutels , and Niel Hens . A systematic review of social contact surveys to inform transmission models of close - contact infections . Epidemiology ( Cambridge , Mass . ) , 30 ( 5 ) : 723 , 2019 . [ 8 ] Laura Fumanelli , Marco Ajelli , Piero Manfredi , Alessandro Vespignani , and Stefano Merler . Inferring the structure of social contacts from demographic data in the analysis of infectious diseases spread . PLOS Computational Biology , 8 ( 9 ) ( e1002673 ) , 2012 . [ 9 ] Niel Hens , Girma Minalu Ayele , Nele Goeyvaerts , Marc Aerts , Joel Mossong , John W Edmunds , and Philippe Beutels . Estimating the impact of school closure on social mixing behaviour and the transmission of close contact infections in eight European countries . BMC infectious diseases , 9 ( 1 ) : 1 – 12 , 2009 . [ 10 ] Nele Goeyvaerts , Niel Hens , Benson Ogunjimi , Marc Aerts , Ziv Shkedy , Pierre Van Damme , and Philippe Beutels . Estimating infectious disease parameters from data on social contacts and sero - logical status . Journal of the Royal Statistical Society Series C : Applied Statistics , 59 ( 2 ) : 255 – 277 , 2010 . [ 11 ] Nele Goeyvaerts , Eva Santermans , Gail Potter , Andrea Torneri , Kim Van Kerckhove , Lander Willem , Marc Aerts , Philippe Beutels , and Niel Hens . Household members do not contact each other at random : implications for infectious disease modelling . Proceedings of the Royal Society B , 285 ( 1893 ) : 20182201 , 2018 . [ 12 ] Alberto Aleta , David Mart´ın - Corral , Michiel A Bakker , Ana Pastore y Piontti , Marco Ajelli , Maria Litvinova , Matteo Chinazzi , Natalie E Dean , M Elizabeth Halloran , Ira M Longini Jr , et al . Quanti - fying the importance and location of SARS - CoV - 2 transmission events in large metropolitan areas . Proceedings of the National Academy of Sciences , 119 ( 26 ) : e2112182119 , 2022 . 12 [ 13 ] Caroline Buckee , Abdisalan Noor , and Lisa Sattenspiel . Thinking clearly about social aspects of infectious disease transmission . Nature , 595 ( 7866 ) : 205 – 213 , 2021 . [ 14 ] Michele Tizzoni , Elaine O Nsoesie , Laetitia Gauvin , M´arton Karsai , Nicola Perra , and Shweta Bansal . Addressing the socioeconomic divide in computational modeling for infectious diseases . Nature Communications , 13 ( 1 ) : 1 – 7 , 2022 . [ 15 ] Jamie Bedson , Laura A Skrip , Danielle Pedi , Sharon Abramowitz , Simone Carter , Mohamed F Jalloh , Sebastian Funk , Nina Gobat , Tamara Giles - Vernick , Gerardo Chowell , et al . A review and agenda for integrated disease models including social and behavioural factors . Nature human behaviour , 5 ( 7 ) : 834 – 846 , 2021 . [ 16 ] Jon Zelner , Nina B Masters , Ramya Naraharisetti , Sanyu A Mojola , Merlin Chowkwanyun , and Ryan Malosh . There are no equal opportunity infectors : epidemiological modelers must rethink our approach to inequality in infection risk . PLoS computational biology , 18 ( 2 ) : e1009795 , 2022 . [ 17 ] Kyra H Grantz , Madhura S Rane , Henrik Salje , Gregory E Glass , Stephen E Schachterle , and Derek AT Cummings . Disparities in inﬂuenza mortality and transmission related to sociodemo - graphic factors within Chicago in the pandemic of 1918 . Proceedings of the National Academy of Sciences , 113 ( 48 ) : 13839 – 13844 , 2016 . [ 18 ] Svenn - Erik Mamelund , Clare Shelley - Egan , and Ole Rogeberg . The association between so - cioeconomic status and pandemic inﬂuenza : systematic review and meta - analysis . PLoS One , 16 ( 9 ) : e0244346 , 2021 . [ 19 ] Kathleen A Alexander , Claire E Sanderson , Madav Marathe , Bryan L Lewis , Caitlin M Rivers , Jeﬀrey Shaman , John M Drake , Eric Lofgren , Virginia M Dato , Marisa C Eisenberg , et al . What factors might have led to the emergence of Ebola in West Africa ? PLoS neglected tropical diseases , 9 ( 6 ) : e0003652 , 2015 . [ 20 ] Nicola Perra . Non - pharmaceutical interventions during the COVID - 19 pandemic : A review . Physics Reports , 913 : 1 – 52 , 2021 . [ 21 ] Romain Garnier , Jan R Benetka , John Kraemer , Shweta Bansal , et al . Socioeconomic disparities in social distancing during the COVID - 19 pandemic in the United States : observational study . Journal of medical Internet research , 23 ( 1 ) : e24591 , 2021 . [ 22 ] Won Do Lee , Matthias Qian , and Tim Schwanen . The association between socioeconomic status and mobility reductions in the early stage of England’s COVID - 19 epidemic . Health & place , 69 : 102563 , 2021 . [ 23 ] Nicol ` o Gozzi , Michele Tizzoni , Matteo Chinazzi , Leo Ferres , Alessandro Vespignani , and Nicola Perra . Estimating the eﬀect of social inequalities on the mitigation of COVID - 19 across communities in Santiago de Chile . Nature communications , 12 ( 1 ) : 1 – 9 , 2021 . [ 24 ] Samuel Heroy , Isabella Loaiza , Alex Pentland , and Neave O’Clery . COVID - 19 policy analysis : labour structure dictates lockdown mobility behaviour . Journal of the Royal Society Interface , 18 ( 176 ) : 20201035 , 2021 . [ 25 ] Laetitia Gauvin , Paolo Bajardi , Emanuele Pepe , Brennan Lake , Filippo Privitera , and Michele Tizzoni . Socio - economic determinants of mobility responses during the ﬁrst wave of COVID - 19 in Italy : from provinces to neighbourhoods . Journal of The Royal Society Interface , 18 ( 181 ) : 20210092 , 2021 . [ 26 ] Joakim A Weill , Matthieu Stigler , Olivier Deschenes , and Michael R Springborn . Social distancing responses to COVID - 19 emergency declarations strongly diﬀerentiated by income . Proceedings of the National Academy of Sciences , 117 ( 33 ) : 19658 – 19660 , 2020 . [ 27 ] Jonathan Jay , Jacob Bor , Elaine O Nsoesie , Sarah K Lipson , David K Jones , Sandro Galea , and Julia Raifman . Neighbourhood income and physical distancing during the COVID - 19 pandemic in the United States . Nature human behaviour , 4 ( 12 ) : 1294 – 1302 , 2020 . 13 [ 28 ] Giovanni Bonaccorsi , Francesco Pierri , Matteo Cinelli , Andrea Flori , Alessandro Galeazzi , Francesco Porcelli , Ana Lucia Schmidt , Carlo Michele Valensise , Antonio Scala , Walter Quattrociocchi , et al . Economic and social consequences of human mobility restrictions under COVID - 19 . Proceedings of the National Academy of Sciences , 117 ( 27 ) : 15530 – 15535 , 2020 . [ 29 ] Spencer J Fox , Emily Javan , Remy Pasco , Graham C Gibson , Briana Betke , Jos´e L Herrera - Diestra , Spencer Woody , Kelly Pierce , Kaitlyn E Johnson , Maureen Johnson - Le´on , et al . Disproportionate impacts of COVID - 19 in a large US city . PLOS Computational Biology , 19 ( 6 ) : e1011149 , 2023 . [ 30 ] Nicol ` o Gozzi , Matteo Chinazzi , Natalie E Dean , Ira M Longini Jr , M Elizabeth Halloran , Nicola Perra , and Alessandro Vespignani . Estimating the impact of COVID - 19 vaccine inequities : a mod - eling study . Nature Communications , 14 ( 1 ) : 3272 , 2023 . [ 31 ] Andria Mousa , Peter Winskill , Oliver John Watson , Oliver Ratmann , M´elodie Monod , Marco Ajelli , Aldiouma Diallo , Peter J Dodd , Carlos G Grijalva , Moses Chapa Kiti , et al . Social contact patterns and implications for infectious disease transmission – a systematic review and meta - analysis of contact surveys . ELife , 10 : e70294 , 2021 . [ 32 ] P Rohani M Keeling . Modeling Infectious Diseases in Humans and Animals . Princeton University Press , 2008 . [ 33 ] Odo Diekmann , JAP Heesterbeek , and Michael G Roberts . The construction of next - generation matrices for compartmental epidemic models . Journal of the royal society interface , 7 ( 47 ) : 873 – 885 , 2010 . [ 34 ] Julie C Blackwood and Lauren M Childs . An introduction to compartmental modeling for the budding infectious disease modeler . 2018 . [ 35 ] Alain Barrat , Marc Barthelemy , and Alessandro Vespignani . Dynamical processes on complex net - works . Cambridge university press , 2008 . [ 36 ] J´ulia Koltai , Orsolya V´as´arhelyi , Gergely R¨ost , and M´arton Karsai . Reconstructing social mixing patterns via weighted contact matrices from online and representative surveys . Scientiﬁc Reports , 12 ( 1 ) : 1 – 12 , 2022 . [ 37 ] Kaiyuan Sun , Andrea Baronchelli , and Nicola Perra . Contrasting eﬀects of strong ties on SIR and SIS processes in temporal networks . The European Physical Journal B , 88 : 1 – 8 , 2015 . [ 38 ] Laura Di Domenico , Giulia Pullano , Chiara E Sabbatini , Pierre - Yves Bo¨elle , and Vittoria Colizza . Impact of lockdown on COVID - 19 epidemic in ˆIle - de - France and possible exit strategies . BMC medicine , 18 ( 1 ) : 1 – 13 , 2020 . [ 39 ] Yannick Leo , Eric Fleury , J Ignacio Alvarez - Hamelin , Carlos Sarraute , and M´arton Karsai . So - cioeconomic correlations and stratiﬁcation in social - communication networks . Journal of The Royal Society Interface , 13 ( 125 ) : 20160598 , 2016 . [ 40 ] Xiaowen Dong , Alfredo J Morales , Eaman Jahani , Esteban Moro , Bruno Lepri , Burcin Bozkaya , Carlos Sarraute , Yaneer Bar - Yam , and Alex Pentland . Segregated interactions in urban and online space . EPJ Data Science , 9 ( 1 ) : 20 , 2020 . [ 41 ] Beatrix Oroszi , Attila Juh´asz , Csilla Nagy , Judit Krisztina Horv´ath , Krisztina Eszter Koml´os , Gerg˝o T´uri , Martin McKee , and R´oza ´Ad´any . Characteristics of the Third COVID - 19 Pandemic Wave with Special Focus on Socioeconomic Inequalities in Morbidity , Mortality and the Uptake of COVID - 19 Vaccination in Hungary . Journal of personalized medicine , 12 ( 3 ) : 388 , 2022 . [ 42 ] Eugenio Valdano , Jonggul Lee , Shweta Bansal , Stefania Rubrichi , and Vittoria Colizza . Highlight - ing socio - economic constraints on mobility reductions during COVID - 19 restrictions in France can inform eﬀective and equitable pandemic response . Journal of travel medicine , 28 ( 4 ) : taab045 , 2021 . [ 43 ] Monita Karmakar , Paula M Lantz , and Renuka Tipirneni . Association of social and demographic factors with COVID - 19 incidence and death rates in the US . JAMA network open , 4 ( 1 ) : e2036462 – e2036462 , 2021 . 14 [ 44 ] Jon Zelner , Rob Trangucci , Ramya Naraharisetti , Alex Cao , Ryan Malosh , Kelly Broen , Nina Masters , and Paul Delamater . Racial disparities in coronavirus disease 2019 ( COVID - 19 ) mortality are driven by unequal infection risks . Clinical Infectious Diseases , 72 ( 5 ) : e88 – e95 , 2021 . [ 45 ] Judy Yuen - man Siu . Health inequality experienced by the socially disadvantaged populations during the outbreak of COVID - 19 in Hong Kong : An interaction with social inequality . Health & social care in the community , 29 ( 5 ) : 1522 – 1529 , 2021 . [ 46 ] Sedona Sweeney , Theo Prudencio Juhani Capeding , Rosalind Eggo , Maryam Huda , Mark Jit , Don Mudzengi , Nichola R Naylor , Simon Procter , Matthew Quaife , Lela Serebryakova , et al . Exploring equity in health and poverty impacts of control measures for SARS - CoV - 2 in six countries . BMJ global health , 6 ( 5 ) : e005521 , 2021 . [ 47 ] Kevin C Ma , Tigist F Menkir , Stephen Kissler , Yonatan H Grad , and Marc Lipsitch . Modeling the impact of racial and ethnic disparities on COVID - 19 epidemic dynamics . Elife , 10 : e66601 , 2021 . [ 48 ] Serina Chang , Emma Pierson , Pang Wei Koh , Jaline Gerardin , Beth Redbird , David Grusky , and Jure Leskovec . Mobility network models of COVID - 19 explain inequities and inform reopening . Nature , 589 ( 7840 ) : 82 – 87 , 2021 . [ 49 ] Alberto Aleta , David Martin - Corral , Ana Pastore y Piontti , Marco Ajelli , Maria Litvinova , Matteo Chinazzi , Natalie E Dean , M Elizabeth Halloran , Ira M Longini Jr , Stefano Merler , et al . Modelling the impact of testing , contact tracing and household quarantine on second waves of COVID - 19 . Nature Human Behaviour , 4 ( 9 ) : 964 – 971 , 2020 . [ 50 ] Marco Pangallo , Alberto Aleta , R Chanona , Anton Pichler , David Mart´ın - Corral , Matteo Chinazzi , Fran¸cois Lafond , Marco Ajelli , Esteban Moro , Yamir Moreno , et al . The unequal eﬀects of the health - economy tradeoﬀ during the COVID - 19 pandemic . arXiv preprint arXiv : 2212 . 03567 , 2022 . [ 51 ] Anna Machens , Francesco Gesualdo , Caterina Rizzo , Alberto E Tozzi , Alain Barrat , and Ciro Cattuto . An infectious disease model on empirical networks of human contact : bridging the gap between dynamic network data and contact matrices . BMC infectious diseases , 13 ( 1 ) : 1 – 15 , 2013 . [ 52 ] Alberto Aleta , Guilherme Ferraz de Arruda , and Yamir Moreno . Data - driven contact structures : from homogeneous mixing to multilayer networks . PLoS computational biology , 16 ( 7 ) : e1008035 , 2020 . [ 53 ] Joel C Miller and Erik M Volz . Incorporating disease and population structure into models of SIR disease in contact networks . PloS One , 8 ( 8 ) : e69162 , 2013 . [ 54 ] Petra Klepac , Stephen Kissler , and Julia Gog . Contagion ! the bbc four pandemic – the model behind the documentary . Epidemics , 24 : 49 – 59 , 2018 . [ 55 ] Alessia Melegaro , Emanuele Del Fava , Piero Poletti , Stefano Merler , Constance Nyamukapa , John Williams , Simon Gregson , and Piero Manfredi . Social Contact Structures and Time Use Patterns in the Manicaland Province of Zimbabwe . PLOS ONE , 12 ( 1 ) : 1 – 17 , 01 2017 . [ 56 ] Marco Ajelli and Maria Litvinova . Estimating contact patterns relevant to the spread of infectious diseases in Russia . Journal of theoretical biology , 419 : 1 – 7 , 2017 . [ 57 ] Juanjuan Zhang , Maria Litvinova , Yuxia Liang , Yan Wang , Wei Wang , Shanlu Zhao , Qianhui Wu , Stefano Merler , C´ecile Viboud , Alessandro Vespignani , et al . Changes in contact patterns shape the dynamics of the COVID - 19 outbreak in China . Science , 368 ( 6498 ) : 1481 – 1486 , 2020 . [ 58 ] Amy Gimma , James D Munday , Kerry LM Wong , Pietro Coletti , Kevin van Zandvoort , Kiesha Prem , CMMID COVID - 19 working group , Petra Klepac , G James Rubin , Sebastian Funk , et al . Changes in social contacts in England during the COVID - 19 pandemic between March 2020 and March 2021 as measured by the CoMix survey : A repeated cross - sectional study . PLoS medicine , 19 ( 3 ) : e1003907 , 2022 . [ 59 ] Esteban Moro , Dan Calacci , Xiaowen Dong , and Alex Pentland . Mobility patterns are associated with experienced income segregation in large US cities . Nature communications , 12 ( 1 ) : 4633 , 2021 . 15 [ 60 ] Takahiro Yabe , Bernardo Garc´ıa Bulle Bueno , Xiaowen Dong , Alex Pentland , and Esteban Moro . Behavioral changes during the COVID - 19 pandemic decreased income diversity of urban encounters . Nature Communications , 14 ( 1 ) : 2310 , 2023 . [ 61 ] Luc Rocher , Julien M Hendrickx , and Yves - Alexandre De Montjoye . Estimating the success of re - identiﬁcations in incomplete datasets using generative models . Nature communications , 10 ( 1 ) : 1 – 9 , 2019 . [ 62 ] Nuria Oliver , Bruno Lepri , Harald Sterly , Renaud Lambiotte , S´ebastien Deletaille , Marco De Nadai , Emmanuel Letouz´e , Albert Ali Salah , Richard Benjamins , Ciro Cattuto , et al . Mobile phone data for informing public health actions across the COVID - 19 pandemic life cycle . Science advances , 6 ( 23 ) : eabc0764 , 2020 . [ 63 ] M´arton Karsai , J´ulia Koltai , Orsolya V´as´arhelyi , and Gergely R¨ost . Hungary in mask / maszk in Hungary . Corvinus Journal of Sociology and Social Policy , ( 2 ) , 2020 . [ 64 ] Rajendra Bhatia . Matrix analysis , volume 169 . Springer Science & Business Media , 2013 . [ 65 ] Nemzeti adatv´edelmi ´es inform´aci´o szabads´ag hat´os´ag , date of access 2023 . 05 . 23 . [ 66 ] Surveillance deﬁnitions for COVID - 19 , European Centre for Disease Prevention and Control , date of access 2023 . 05 . 23 . [ 67 ] Sergio Arregui , Alberto Aleta , Joaqu´ın Sanz , and Yamir Moreno . Projecting social contact matrices to diﬀerent demographic structures . PLoS computational biology , 14 ( 12 ) : e1006638 , 2018 . 16 Supporting Information Epidemic models with age - stratiﬁed contact matrices Standard approaches to model the spreading of infectious diseases often acknowledge the stratiﬁcation of contacts across age - brackets . To this end , contact matrices C are introduced . The element C ij quantiﬁes the average number of contacts that an individual in age - bracket i has with individuals in age group j within a certain time window [ 2 , 3 , 5 ] . The population hence , it is divided into age brackets so that N = (cid:80) Ki = 1 N i . The variables N i capture the number of individual in age group i while K indicates the number of diﬀerent age - groups . Given the deﬁnition of contact matrices , we can deﬁne R ij = C ij N i as the total number of contacts that individuals in i have with those in j . This matrix is clearly symmetric : R ji = R ij . However since in general N i (cid:54) = N j the entries of the contact matrices are not , i . e . , C ij = R ij N i (cid:54) = C ji = R ji N j . Let us now consider a disease whose natural history can be described with a Susceptible - Exposed - Infected - Recovered model [ 32 ] . The epidemic dynamics are encoded in the following set of diﬀerential equations : d t S i ( t ) = − Λ i ( t ) S i ( t ) , d t E i ( t ) = Λ i ( t ) S i ( t ) − Ψ E i ( t ) , d t I i ( t ) = Ψ E i ( t ) − Γ I i ( t ) , d t R i ( t ) = Γ I i ( t ) . ( 4 ) Susceptible individuals , in contact with infected , might be exposed to the virus with a rate driven by the force of infection Λ i ( t ) ; exposed are not yet infectious and transition to the infected compartment with rate Ψ ; infected individuals recover with rate Γ . The force of infection is then deﬁned as the per - capita rate at which susceptibles are exposed to the disease : Λ i ( t ) = Φ K (cid:88) j = 1 C ij I j ( t ) N j ( 5 ) where Φ is the transmissibility of the disease and the temporal dependence is induced by the variation in the number of infected across age brackets . Derivation of R 0 A fundamental quantity to understand the epidemic dynamics is the basic reproductive number , R 0 , deﬁned as the number of secondary infections generated by a single infected individual in a otherwise susceptible population [ 32 ] . The basic reproductive number is function of the features of the disease and the contact patterns of the population . The next generation matrix approach can be used to determine a closed form expression of R 0 . While we refer the reader to Ref . [ 34 ] for an overview of the method , in the following we provide a summary of its derivation . To keep equations more readable , we henceforth drop the explicit time dependence notation . The ﬁrst step is to focus our attention only on the compartments that describe any stages of the infection : E i and I i i ∈ [ 1 , K ] in our case . It is convenient to re - write the diﬀerential equations for these compartment as d t x = f ( x ) − w ( x ) ( 6 ) where x ∈ [ E 1 , . . . E K , I 1 , . . . I K ] , f ( x ) encodes all terms that lead to new infections and w ( x ) all other transitions in and out of the compartments . More explicitly , we can write d t x =    d t E 1 . . . d t E K d t I 1 . . . d t I K    = f ( x ) − w ( x ) =    Λ 1 S 1 . . . Λ K S K 0 . . . 0    −    Ψ E 1 . . . Ψ E K Γ I 1 − Ψ E 1 . . . Γ I K − Ψ E K    ( 7 ) As alluded above , the expression of R 0 is linked to the early epidemic dynamics which can be linearized by calculating the Jacobian at the disease free equilibrium ( DFE ) ( S ∗ i , E ∗ i , I ∗ i , R ∗ i ) = ( N i , 0 , 0 , 0 ) for all 17 age groups . Using the Jacobian matrix J ( which has size 2 K × 2 K ) at the DFE we can write d t x = Jx ( 8 ) This expression can be conveniently factorized as d t x = ( F − W ) x where the matrix F is Jacobian applied to f ( x ) and similarly the matrix W is the Jacobian applied to w ( x ) . In particular , we have : F =   ∂ E 1 ( Λ 1 N 1 ) . . . ∂ E K ( Λ 1 N 1 ) ∂ I 1 ( Λ 1 N 1 ) . . . ∂ I K ( Λ 1 N 1 ) ∂ E 1 ( Λ 2 N 2 ) . . . ∂ E K ( Λ 2 N 2 ) ∂ I 1 ( Λ 2 N 2 ) . . . ∂ I K ( Λ 2 N 2 ) . . . . . . . . . . . . . . . . . . ∂ E 1 ( Λ K N K ) . . . ∂ E K ( Λ K N K ) ∂ I 1 ( Λ K N K ) . . . ∂ I K ( Λ K N K ) 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0   =   0 . . . 0 ∂ I 1 ( Λ 1 N 1 ) . . . ∂ I K ( Λ 1 N 1 ) 0 . . . 0 ∂ I 1 ( Λ 2 N 2 ) . . . ∂ I K ( Λ 2 N 2 ) . . . . . . . . . . . . . . . . . . 0 . . . 0 ∂ I 1 ( Λ K N K ) . . . ∂ I K ( Λ K N K ) 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0   ( 9 ) We stress how the components of each gradient , are computed at the DFE , i . e . , S i → N i . By looking at Eq . 5 we note how each partial derivative in p selects the p - th element of the sum hence : F = Φ    0 . . . 0 C 11 N 1 N 1 . . . C 1 K N K N 1 0 . . . 0 C 21 N 1 N 2 . . . C 2 K N K N 2 . . . . . . . . . . . . . . . . . . 0 . . . 0 C K 1 N 1 N K . . . C KK N K N K 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0      = Φ (cid:20) 0 ˜C 0 0 (cid:21) ( 10 ) where we denoted with 0 K × K blocks of zeros and the generic entry of ˜C is ˜ C ij = C ij N j N i . Using the same method we can easily write the expression of the matrix W as : W =   Ψ . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . Ψ 0 . . . 0 − Ψ . . . 0 Γ . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . − Ψ 0 . . . Γ   = (cid:20) Ψ I 0 − Ψ I Γ I (cid:21) ( 11 ) where I are identity matrices of size K × K . The expression for R 0 is linked to the two matrices as R 0 = ρ ( FW − 1 ) , where ρ denotes the spectral radius . It is easy to show how FW − 1 = Φ (cid:20) 0 ˜C 0 0 (cid:21) (cid:20) 1Ψ I 0 1 Γ I 1Γ I (cid:21) = Φ Γ (cid:20) ˜C ˜C 0 0 (cid:21) ( 12 ) hence , we ﬁnally can write R 0 = Φ Γ ρ ( ˜C ) ( 13 ) Contact matrices are often stratiﬁed also for the context ( i . e . , location l ) where interactions take place [ 5 ] . The entries C ij are then expressed as C ij = (cid:88) l ω l C ( l ) ij ( 14 ) where ω l are weights capturing possible heterogeneities in the relevance of contacts in each context in the transmission of the disease . In this formulation , the inclusion of the diﬀerent contexts does not change the expression of R 0 as the ω l are assumed to be homogeneous across age - brackets . 18 Generalized contact matrices In this work , we shift from the standard contact matrices that stratify contacts for age and possibly context , to a generalized version that allows for m other dimensions . Here , we focus the attention towards socio - economic status ( SES ) variables as additional dimensions . However , the framework is general and can be applied to any categorical variable of epidemiological interest . In more details , we describe the generalized contact matrices as G a , b , where a = ( i , α , β , . . . , γ ) and b = ( j , η , µ , . . . , ξ ) are tuples ( i . e . , index vectors ) representing individuals membership to each category . We note how we adopted Greek letters for the additional dimensions , though not necessary . With these matrices we can , for example , capture contacts stratiﬁcation according to age , income ( α ) , and education attainment ( β ) . In this scenario G a , b would describe the average number of contacts that an individual in age bracket i , income α , and education β has with people in age group j , income η , and education µ in a given time window . From this perspective , the matrix C can be thought as an aggregation of contacts patterns at a lower levels of stratiﬁcation . In other words , the standard matrices can be viewed as aggregation along all dimensions aﬀecting the organization of contacts but age . The total number of contacts of individuals in a given age group i with other in j can be written as R ij = C ij N i . Considering the generalized contact matrices we have C ij N i = (cid:80) a (cid:48) b (cid:48) G a (cid:48) , b (cid:48) N a (cid:48) , where a (cid:48) = a − { i } and b (cid:48) = b − { j } are the index vectors m capturing all dimensions but age . Since the matrices G has m + 1 dimensions , we can aggregate contacts in m + 1 possible ways , for example computing the average contacts that individual in one of the SES α has with others in same SES β obtaining C αβ N α = (cid:88) a (cid:48) b (cid:48) G a (cid:48) , b (cid:48) N a (cid:48) ( 15 ) where now a (cid:48) = a − { α } and b (cid:48) = b − { β } . In general , C ij (cid:54) = C αβ . Indeed , the number of groups and the number of individuals in each of them might be diﬀerent . Looking at contacts patterns from multiple dimensions of stratiﬁcation allows us to observe how the way interactions are aggregated ( i . e . , by age or other dimensions ) might aﬀect the estimation of key epidemiological parameters and of the dynamics . We denote with K the number of age groups , while with V p the number of groups in each of the m other dimensions ( i . e . , p ∈ [ 1 , m ] ) . While the generalized matrix G can be naturally described as a multidimensional matrix , the use of T = K (cid:81) mp = 1 V p × K (cid:81) mp = 1 V p index vectors allows for ﬂattened representation in a squared bi - dimensional matrix of size K (cid:81) mp = 1 V p × K (cid:81) mp = 1 V p . We note how the formulation can easily consider diﬀerent contexts where interactions take places , i . e . , G a , b = (cid:80) l ω l G ( l ) a , b where ω l captures the relative importance of the diﬀerent social settings in the transmission [ 5 ] . Synthetic generalized contact matrices In this section , we provide details about the generation of synthetic generalized contact matrices we built to explore the possible eﬀects of diﬀerent mixing patterns among individuals . For simplicity we ﬁrst consider only two dimensions : age and a socio - economic status ( SES ) variable ( though any other categorical variable could be used ) . We developed a model to derive G a , b where a = ( i , α ) and b = ( j , β ) , and i and j refers to the age group while α and β to the SES of the ego and the alter respectively . We start from a real contact matrix C ij describing the contact rates between age - brackets i and j . We can deﬁne R ij = C ij N i as the total number of contacts between the two groups in the a given period . While the matrix C ij is not symmetric , R ij is since the number of raw contacts between two groups is the same , i . e . , R ij = C ij N i = R ji = C ji N j . To build the generalized contact matrices G a , b we ﬁrst split the total contacts R ij across the second dimension and then we compute the contacts rates . In other words R ij = (cid:80) α , β R iα , jβ . The problem is then how to get values for the elements R iα , jβ . It is useful to reﬂect on the properties of these matrix . First , R iα , jβ = R jβ , iα . In words , the number of contacts that individuals in age group i and SES α have with individuals in age group j and SES β , must equal the number of contacts that individuals in age group j and SES β have with individuals in age group i and SES α . This property implies that R iα , jβ = R (cid:62) iα , jβ . Indeed , for a given pair of indices i and j , one can think about R iα , jβ as a V 1 × V 1 matrix ( since α , β ∈ [ 1 , . . . , V 1 ] ) , which describes the contact patterns between those two age groups across SES . The matrix obtained by switching the indices for age ( i . e . , R jα , iβ ) is the transpose of the ﬁrst . This property has another implication : for all i = j the matrix R iα , iβ must be symmetric : R iα , iβ = R iβ , iα . 19 In general this is not the case for i (cid:54) = j . Second , as mentioned above the sum over all α and β is set by the number of contacts between age group i and j : R ij = (cid:80) α , β R iα , jβ . Given these features , how can we set the entries of these matrices ? As mentioned , for a given pair i and j the matrix R iα , jβ is of size V 1 × V 1 since α , β ∈ [ 1 , . . . , V 1 ] . For any i (cid:54) = j , we need a model to set W = V 21 − 1 elements of the matrix ( the minus one is due to the constraint introduced by the second property deﬁned above ) . For all i = j instead , the symmetry of the matrix is such that we need to set only Y = V 1 + V 1 ( V 1 − 1 ) 2 − 1 elements . The ﬁrst V 1 come from the diagonal ( i . e . , α = β ) , the V 1 ( V 1 − 1 ) 2 are instead the oﬀ - diagonal values , the minus one is due to the constraint of the total number of contacts which is set by R ij . To set the W and Y values of the matrices we consider that for any i and j pair : 1 . each SES α is generally responsible for P α fraction of R ij connections , where (cid:80) α P α = 1 2 . we assume that a fraction q α of these are on the diagonal ( i . e . , in - group connections ) and 1 − q α are instead oﬀ - diagonal . This parameter controls the assortativity of connections within each group . In what follows , we consider the fractions P α and q α as input parameters . In case W or Y are equal to this number ( 2 V 1 − 1 ) , the constraints imposed by our assumptions allow to deﬁne all the entries of the matrix . If instead W > 2 V 1 − 1 , other W − 2 V 1 + 1 parameters are required . Let us consider ﬁrst the case in which V 1 = 3 , α , β ∈ [ 1 , 2 , 3 ] . In these settings W = 8 , and Y = 5 which is equal to 2 V 1 − 1 . Hence , deﬁning the two set of input parameters is enough to obtain the matrix for any i = j , while still 3 additional parameters are needed for i (cid:54) = j . It is important to stress how the ﬁrst property described above implies that we need to deﬁne only this number for all i < j . The correspondent values for i > j are readily obtained just transposing the matrices . It is useful , to split the two cases : Case i = j . For all i = j the matrices R iα , iβ take the form of R iα , iβ = R ii   q 1 P 1 p i 1 , i 2 p i 1 , i 3 p i 1 , i 2 q 2 P 2 p i 2 , i 3 p i 1 , i 3 p i 2 , i 3 q 3 P 3   ( 16 ) where each p iα , iβ ∈ [ 0 , 1 ] is deﬁned such that R iα , iβ = R ii p iα , iβ . As the matrix needs to be symmetric we have written , for example , p i 1 , i 2 instead of p i 2 , i 1 . Due to our assumptions the sum of the oﬀ - diagonal elements of each rows should sum to ( 1 − q α ) P α = Φ α , while on the diagonal we have q α P α . Thus the following system of equations must be respected :   p i 1 , i 2 + p i 1 , i 3 = Φ 1 p i 1 , i 2 + p i 2 , i 3 = Φ 2 p i 1 , i 3 + p i 2 , i 3 = Φ 3 ( 17 ) The solution , if any , is unique and can be written as ˆp = A − 1 Φ = 1 2   Φ 1 + Φ 2 − Φ 3 Φ 1 + Φ 3 − Φ 2 Φ 2 + Φ 3 − Φ 1   ( 18 ) where A =   1 1 0 1 0 1 0 1 1   , Φ =   Φ 1 Φ 2 Φ 3   , ˆp =   p i 1 , i 2 p i 1 , i 3 p i 2 , i 3   ( 19 ) Let us consider now the case in which V 1 = 4 . In this case , Y = 9 . As before , 2 V 1 − 1 parameters are inputs ( three P α and four q α ) . In this case , Y > 2 V 1 − 1 . Hence , the system of V 1 diﬀerential equations in V 1 ( V 1 − 1 ) / 2 = 6 ( oﬀ - diagonal ) elements required Y − 2 V 1 + 1 = 2 free parameters . Indeed , the matrix R iα , iβ can be written as : R iα , iβ = R ii   q 1 P 1 p i 1 , i 2 p i 1 , i 3 p i 1 , i 4 p i 1 , i 2 q 2 P 2 p i 2 , i 3 p i 2 , i 4 p i 1 , i 3 p i 2 , i 3 q 3 P 3 p i 3 , i 4 p i 1 , i 4 p i 2 , i 4 p i 3 , i 4 q 4 P 4   ( 20 ) 20 Considering that the sum of each oﬀ - diagonal element in each row α should sum to ( 1 − q α ) P α we obtain a system of four equations :   p i 1 , i 2 + p i 1 , i 3 + p i 1 , i 4 = Φ 1 p i 1 , i 2 + p i 2 , i 3 + p i 2 , i 4 = Φ 2 p i 1 , i 3 + p i 2 , i 3 + p i 3 , i 4 = Φ 3 p i 1 , i 4 + p i 2 , i 4 + p i 3 , i 4 = Φ 4 ( 21 ) As before , we can write the system of 6 equations in matrix form as Aˆp = Φ where : A =   1 1 1 0 0 0 1 0 0 1 1 0 0 1 0 1 0 1 0 0 1 0 1 1   , ˆp =   p i 1 , i 2 p i 1 , i 3 p i 1 , i 4 p i 2 , i 3 p i 2 , i 4 p i 3 , i 4   , Φ =   Φ α Φ β Φ γ Φ Γ   ( 22 ) Clearly the system is under - determined as it has four equations and six variables . To ﬁnd the solution we need to ﬁx two of such variables as for example p i 2 , i 4 and p i 3 , i 4 . Doing so , we can write the system of equations as A r ˆp r = Φ r where A r =   1 1 1 0 1 0 0 1 0 1 0 1 0 0 1 0   , ˆp r =   p i 1 , i 2 p i 1 , i 3 p i 1 , i 4 p i 2 , i 3   , Φ r =   Φ 1 Φ 2 − p i 2 , i 3 Φ 3 − p i 3 , i 4 Φ 4 − p i 2 , i 3 − p i 3 , i 4   ( 23 ) The subscript r stands for reduced , as by ﬁxing the Y − 2 V 1 + 1 variables we can move from a 4 × 6 matrix to a 4 × 4 . The solution , if any , is now unique and can be written as : ˆp r = A − 1 r Φ r ( 24 ) For any general V 1 , the method described above allows to deﬁne the matrix R iα , iβ passing through an under - deﬁned system of linear equations . By setting the potential Y − 2 V 1 + 1 free parameters the solution , if it exists , is unique . However , we expect that some solutions might not physical . Indeed , the entries of the matrix must be all equal or larger than zero . Any solution that leads to negative values is not physical and must be neglected . This condition adds constraints to the possible values of the Y parameters . It is important to notice how the free - parameters are in general function of i . For simplicity , and to avoid having to set K × ( Y − 2 V 1 + 1 ) values across all age groups , could be set equal for all age groups . Case i < j . For all i < j the matrices R iα , jβ take the form of R iα , jβ = R ij   q 1 P 1 p i 1 , j 2 p i 1 , j 3 p i 2 , j 1 q 2 P 2 p i 2 , j 3 p i 3 , j 1 p i 3 , j 2 q 3 P 3   ( 25 ) where each p iα , jβ ∈ [ 0 , 1 ] is deﬁned such that R iα , jβ = R ij p iα , jβ . The diﬀerence with respect to the previous case is that now the matrix is not , in general , symmetric . As such , we need to ﬁnd a model to set the W = V 21 − 1 values . However , as in the previous case , due to our assumptions , the sum of the oﬀ - diagonal elements of each rows should sum to ( 1 − q α ) P α = Φ α , while on the diagonal we have q α P α . Thus the following system of equations must be respected :   p i 1 , j 2 + p i 1 , j 3 = Φ 1 p i 2 , j 1 + p i 2 , j 3 = Φ 2 p i 3 , j 1 + p i 3 , j 2 = Φ 3 ( 26 ) The system of equations is clearly under deﬁned . Hence , even for the scenario with V 1 = 3 we have three parameters ( one per equation ) . For example , we could set as parameters p i 1 , j 3 , p i 2 , j 3 , and p i 3 , j 1 . Since 21 the values of all the entries are deﬁned between 0 and 1 , each parameter is bounded by the following conditions : 0 ≤ p i 1 , j 3 ≤ Φ 1 , 0 ≤ p i 2 , j 3 ≤ Φ 2 , and 0 ≤ p i 3 , j 1 ≤ Φ 3 . It is important to stress how once we have picked these three parameters , the matrix R iα , jβ is fully deﬁned as well as the matrix R jβ , iα which is the transpose . Furthermore , we have three parameters for each i < j , since the entries are in principle function of the age groups . However , for simplicity we set the same three free parameters across all age combinations . Let us consider now the case in which V 1 = 4 . In this case , W = V 21 − 1 = 15 . As before , 2 V 1 − 1 parameters are inputs ( three P α and four q α ) . In this case , W > 2 V 1 − 1 . Hence , the system of V 1 diﬀerential equations in V 1 ( V 1 − 1 ) ( oﬀ - diagonal ) elements required W − 2 V 1 + 1 = 8 free parameters . Random mixing regime By setting P α = q α = N α / N ( where N α = (cid:80) i N iα ) the model drastically simpliﬁes and the contacts division of the total contact R ij between age groups i and j across α and β equal the product of the fraction of these two groups ( independently of age ) . This is the random mixing regime , indeed , if contacts are random across groups the expectation value of this process leads to the aforementioned product . To provide a concrete example , let us consider a simple case where we have only one SES dimension and V 1 = 3 . As described above , for all i < j in these settings W = 8 and p iα , jβ = R ij   q 1 P 1 p i 1 , j 2 p i 1 , j 3 p i 2 , j 1 q 2 P 2 p i 2 , j 3 p i 3 , j 1 p i 3 , j 2 q 3 P 3   ( 27 ) Now we can set the parameters in the diagonal equal to the fraction of the population of each group : p iα , jβ = R ij   N 1 N N 1 N p i 1 , j 2 p i 1 , j 3 p i 2 , j 1 N 2 N N 2 N p i 2 , j 3 p i 3 , j 1 p i 3 , j 2 N 3 N N 3 N   ( 28 ) The oﬀ - diagonal values are deﬁned similarly p iα , jβ = R ij   N 21 N 2 N 1 N 2 N 2 N 1 N 3 N 2 N 1 N 2 N 2 N 22 N 2 N 2 N 3 N 2 N 1 N 3 N 2 N 2 N 3 N 2 N 23 N 2   ( 29 ) The assumption that the division of the R ij contacts for SES depends only on the total fraction of individuals in SES induces symmetry in these matrices even for the case i < j . We note how , indepen - dently on the number of SES groups , by assigning contacts at random proportionally to the populations allows to deﬁne matrices without the need to set free parameters . It is easy to show how by setting P α = q α = N α / N , the matrices are deﬁned in such a way that the on - diagonal elements have a P α q α fraction of contacts while the oﬀ - diagonal elements in each row sums to P α ( 1 − q α ) = Φ α Finally , we note how another way to deﬁne an homogeneous mixing scenario could be done considering R iα , jβ = R ij N iα N i N jα N j . In this case , we still split the total contacts considering the fraction of individuals in each age and SES group . This model does not , in general , lead to the symmetry of the matrices for i < j . However , this case reduces to the previous assuming that N iα N i = N α N for ∀ i , hence when the fraction of individuals in each SES is independent of age . Epidemic models with generalized contact matrices In this section , we provide the detailed description of epidemic models featuring generalized contact ma - trices . As done above , let us consider a disease whose natural history can be described with a Susceptible - Exposed - Infected - Recovered model [ 32 ] . By considering the population sliced in m + 1 dimensions the epidemic dynamics are encoded in the following set of diﬀerential equations : d t S a ( t ) = − Λ a ( t ) S a ( t ) , d t E a ( t ) = Λ a ( t ) S a ( t ) − Ψ E a ( t ) , d t I a ( t ) = Ψ E a ( t ) − Γ I a ( t ) , d t R a ( t ) = Γ I a ( t ) . ( 30 ) 22 where a = ( i , α , . . . , γ ) is the index vector describing the membership of individuals in the m + 1 groups . In other words , the unfolding of the disease is captured by 4 × K (cid:81) mp = 1 V p compartments . The force of infection , deﬁned as the per - capita rate at which susceptible are exposed to the disease , can be written as : Λ a ( t ) = Φ (cid:88) b G a , b I b ( t ) N b ( 31 ) where Φ is the trasmissibility of the disease and the temporal dependence is induced by the variation in the number of infected across age brackets . Derivation of R 0 The derivation of the basic reproductive number is done following the next generation matrix ap - proach [ 34 ] . As done for standard contact matrices above , the ﬁrst step is to focus the attention only on the compartments that describe any stages of the infection : E a and I a . It is convenient to re - write the diﬀerential equations for these compartment as d t x = f ( x ) − w ( x ) ( 32 ) where x ∈ [ E 1 , . . . E T , I 1 , . . . I T ] , f ( x ) encodes all terms that lead to new infections and w ( x ) all other transitions in and out of the compartments . Furthermore , we denote with a ( a ∈ [ 1 , T ] and T = K (cid:81) mp = 1 V p ) the index vectors . In other words , 1 describes the index vector ( 1 , 1 , . . . , 1 ) of size m + 1 , 2 the index vector ( 1 , 1 , . . . , 2 ) , and T instead ( K , V 1 , . . . , V m ) . Using this notation , we map the generalized problem to the same structure described above for only one dimension ( i . e . , age ) . Indeed , we can write , once again dropping the time dependence for convenience , d t x =   d t E 1 . . . d t E T d t I 1 . . . d t I T   = f ( x ) − w ( x ) =   Λ 1 S 1 . . . Λ T S T 0 . . . 0   −   Ψ E 1 . . . Ψ E T Γ I 1 − Ψ E 1 . . . Γ I T − Ψ E T   ( 33 ) Which is has exactly the same structure of the analogous described above , but where i → a and a = ( i , α 1 , . . . , α m ) . As shown above , the expression of R 0 is linked to the early epidemic dynamics which can be linearized by calculating the Jacobian at the disease free equilibrium ( DFE ) ( S ∗ j , E ∗ j , I ∗ j , R ∗ j ) = ( N j , 0 , 0 , 0 ) for all age groups . Using the Jacobian matrix J ( which has size 2 K (cid:81) mp = 1 V p × 2 K (cid:81) mp = 1 V p ) at the DFE we can write d t x = Jx ( 34 ) This expression can be conveniently factorized as d t x = ( F − W ) x where the matrix F is Jacobian applied to f ( x ) and similarly the matrix W is the Jacobian applied to w ( x ) . In particular we have : F =   ∂ E 1 ( Λ 1 N 1 ) . . . ∂ E T ( Λ 1 N 1 ) ∂ I 1 ( Λ 1 N 1 ) . . . ∂ I T ( Λ 1 N 1 ) ∂ E 1 ( Λ 2 N 2 ) . . . ∂ E T ( Λ 2 N 2 ) ∂ I 1 ( Λ 2 N 2 ) . . . ∂ I T ( Λ 2 N 2 ) . . . . . . . . . . . . . . . . . . ∂ E 1 ( Λ T N T ) . . . ∂ E T ( Λ T N T ) ∂ I 1 ( Λ T N T ) . . . ∂ I T ( Λ T N T ) 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0   =   0 . . . 0 ∂ I 1 ( Λ 1 N 1 ) . . . ∂ I T ( Λ 1 N 1 ) 0 . . . 0 ∂ I 1 ( Λ 2 N 2 ) . . . ∂ I T ( Λ 2 N 2 ) . . . . . . . . . . . . . . . . . . 0 . . . 0 ∂ I 1 ( Λ T N T ) . . . ∂ I T ( Λ T N T ) 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0   ( 35 ) 23 The components of each gradient are computed at the DFE , i . e . , S j → N j . By looking at Eq . 31 we note how each partial derivative in j selects the j - th index vector : F = Φ   0 . . . 0 G 1 , 1 N 1 N 1 . . . G 1 , T N T N 1 0 . . . 0 G 2 , 1 N 1 N 2 . . . G 2 , T N T N 2 . . . . . . . . . . . . . . . . . . 0 . . . 0 G K , 1 N 1 N T . . . G T , T N T N T 0 . . . 0 0 . . . 0 0 . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . 0 . . . 0 0 . . . 0   = Φ (cid:20) 0 ˜G 0 0 (cid:21) ( 36 ) where we denoted with 0 K (cid:81) mp = 1 V p × K (cid:81) mp = 1 V p blocks of zeros and the generic entry of ˜G is ˜ G a , b = G a , b N b N a . Using the same method we can easily write the expression of the matrix V 1 as : W =    Ψ . . . 0 0 . . . 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 . . . Ψ 0 . . . 0 − Ψ . . . 0 Γ . . . 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 . . . − Ψ 0 . . . Γ    = (cid:20) Ψ I 0 − Ψ I Γ I (cid:21) ( 37 ) where I are diagonal matrices of size K (cid:81) mp = 1 V p × K (cid:81) mp = 1 V p . The expression for R 0 is linked to the two matrices as R 0 = ρ ( FW − 1 ) , where ρ denotes the spectral radius . It is easy to show how FW − 1 = Φ (cid:20) 0 ˜G 0 0 (cid:21) (cid:20) 1Ψ I 0 1Γ I 1Γ I (cid:21) = Φ Γ (cid:20) ˜G ˜G 0 0 (cid:21) ( 38 ) hence , we can ﬁnally write R 0 = Φ Γ ρ ( ˜G ) ( 39 ) The expression has the same general form of the one derived for standard contact matrices stratiﬁed just for age . However , the entries of the matrix are diﬀerent and those encode the multiple dimensions . Contact matrices are often stratiﬁed also for the context ( location ) where they take place [ 5 ] . The entries G a ; b are then expressed as G a , b = (cid:88) l ω l G ( l ) a , b ( 40 ) where ω s are weights capture possible heterogeneities in the relevance of contacts in each context in the transmission of the disease . In this formulation , the inclusion of the diﬀerent contexts does not change the expression of R 0 as the ω l are assumed to be homogeneous across age - brackets . On the spectral radius of generalized contact matrices We provide some formal relations between the spectral radius of the generalized contacts matrices and the classical ones . We denote ˜ C in matrix form as ˜ C = RN − 1 , where N is diagonal and stores the number of individuals in each age group and R is symmetric and contains the number of contacts between pairs . We can similarly denote the generalized contact matrix ˜G = R G N G − 1 , where N G is now the diagonal matrix of the generalized populations sizes . As we stated already , these two contact matrices have clearly diﬀerent sizes that we denote as ˜ C ∈ R K × K and ˜ G ∈ R KV 1 × KV 1 . To move from ˜ C to ˜ G we thus need an “inﬂation” process that turns every element of ˜C into a matrix of size V × V . We deﬁne three inﬂation techniques and provide a theorem relating the spectral radius of ˜ C and ˜ G in these three cases . As a fundamental remark , we here only treat inﬂation strategies that go from the indexing ( i , j ) to ( iα , jβ ) , i . e . , that add only one dimension . This can be done without loss of generality , because if multiple dimensions exist , one can simply add them iteratively one by one . 24 Theorem enunciation Deﬁnition 1 ( Homogeneous mixing inﬂation ) . The homogeneous mixing inﬂation creates ˜G from ˜C as - suming nothing is known about the newly added dimension . In this case we get ˜G hom = R G , hom N − 1 G , hom , where ( R G , hom ) iα , jβ = R ij V 2 ( N G , hom ) iα , jβ = N i V 1 δ ij δ αβ . The second inﬂation technique is the random mixing Deﬁnition 2 ( Random mixing inﬂation ) . The random mixing inﬂation is obtained assuming that the sub - population sizes are known and that the number of contacts is proportional to the product of interacting group sizes . More precisely , ˜G rdn = R G , rdn N − 1 G , rdn , where ( R G , rdn ) iα , jβ = R ij N α N β N 2 ( N G , rdn ) iα , jβ = N i N α N δ ij δ αβ , where N α is the size of group α and N is the total number of individuals . We ﬁnally consider a third inﬂation strategy that is general and model - free . This technique includes all possible ways to move from ˜C to ˜G , including the two we just described , the assortative mixing model and the real matrix ˜G . Deﬁnition 3 ( Arbitrary inﬂation ) . An arbitrary inﬂation is obtained without assuming any contact pattern and just requiring to preserve the population sizes and the number of contacts . More precisely , we let ˜G a = R G , a N − 1 G , a , where (cid:88) αβ ( R G , a ) iα , jβ = R ij (cid:88) αβ ( N G , a ) iα , jβ = N ij . We now provide our main result relating the spectral radius of ˜G with that of ˜C in these three cases . Theorem 4 ( Spectral radius of generalized contact matrices ) . Consider a contact matrix ˜C and its generalized version ˜G obtained with arbitrary inﬂation as per Deﬁnition 3 . Then , ρ ( ˜G ) ≥ ρ ( ˜C ) . Moreover , the strict equality is obtained for the homogeneous and random mixing ( Deﬁnitions 1 , 2 ) . Proof We now proceed with the proof . For simplicity , we hereby summarize the strategy . First we show that in the two cases in which the equality holds , the leading eigenvector can be easily derived analytically hence its related eigenvalue . Then , exploiting the fact that both ˜C , ˜G have the same eigenvalues of a symmetric matrix , we compute the Rayleigh quotient of ˜G a for a guess vector and prove that it equals ρ ( ˜G hom ) thus concluding the proof . Deﬁnition of the symmetrized contact matrices To ease the calculation , we adopt a symmetrized version of ˜C , ˜G that share the same eigenvalues [ 64 , Corollary 111 . 4 . 6 ] : ˜C sym = N − 1 / 2 RN − 1 / 2 ˜G sym = N G − 1 / 2 R G N G − 1 / 2 . 25 Since the symmetric matrices are similar to their non - symmetric counterpart , we can write ρ ( ˜G sym ) ≥ ρ ( ˜C sym ) ⇐⇒ ρ ( ˜G ) ≥ ρ ( ˜C ) . For simplicity and uniformity we now only work with the symmetric matrices . Spectral radius for the homogeneous inﬂation Given Deﬁnition 1 , we can write the ( iα , jβ ) element of ˜G symhom as (cid:16) ˜G symhom (cid:17) iα , jβ = ˜C sym ij V 1 . Let x ∈ R K be the leading eigenvector of ˜C sym and let ρ be its associated eigenvalue . Then we deﬁne y ∈ R KV 1 so that y iα = x i . We now show that y is the ( un - normalized ) leading eigenvector of ˜G symhom with eigenvalue ρ , in fact (cid:16) ˜G symhom y (cid:17) iα = (cid:88) jβ (cid:16) ˜G symhom (cid:17) iα , jβ y jβ = 1 V 1 (cid:88) jβ ˜C sym ij x j = (cid:88) j ˜C sym ij x j = (cid:16) ˜C sym ij x (cid:17) i = ρ x i = ρ y iα . Note that , due to Perron - Frobenius theorem , ρ must be the largest eigenvalue of ˜G symhom . Spectral radius under the random inﬂation Given Deﬁnition 2 we may write the ( iα , jβ ) component of ˜G symrdn as (cid:16) ˜G symrdn (cid:17) iα , jβ = (cid:115) N α N β N i N j · R ij N . Once again , we denote with x ∈ R K the leading eigenvector of ˜C sym and with ρ its associated eigenvalue . We deﬁne y ∈ R KV 1 so that y iα = x i √ N α and we show that it is the ( un - normalized ) leading eigenvector of ˜G symrdn with eigenvalue ρ . (cid:16) ˜G symrdn y (cid:17) iα = (cid:88) jβ (cid:16) ˜G symrdn (cid:17) iα , jβ y jβ = (cid:88) jβ (cid:115) N α N β N i N j · R ij N x j (cid:112) N β = √ N α N (cid:88) β N β (cid:88) j ˜C sym ij x j = ρ (cid:112) N α x i = ρ y iα . Once again , this is the largest eigenvalue due to Perron - Frobenius theorem . Spectral radius for arbitrary inﬂation We here provide an inequality for the spectral radius of ˜G syma , exploiting a known property that the largest eigenvalue of a Hermitian matrix is the maximum of the Rayleigh quotient . By deﬁnition , we can write (cid:16) ˜G syma (cid:17) = ( R G , a ) iα , jβ (cid:113) ( N G , a ) iα ( N G , a ) jβ . Consider the vector y ∈ R K × V 1 so that y iα = (cid:113) ( N G , a ) iα N i x i , where x is the usual vector . We can write 26 ρ (cid:16) ˜G syma (cid:17) = max z ∈ R VK (cid:54) = 0 z T ˜G syma z z T z ≥ y T ˜G syma y y T y = (cid:80) iα (cid:80) jβ (cid:114) ( N G , a ) iα ( N G , a ) jβ N i N j ( R G , a ) iα , jβ √ ( N G , a ) iα ( N G , a ) jβ x i x j (cid:80) iα ( N G , a ) iα N i x 2 i = (cid:80) ij x i x j √ N i N j (cid:80) αβ ( R G , a ) iα , jβ (cid:80) i x 2 i N i (cid:80) α ( N G , a ) iα = (cid:80) ij x i x j √ N i N j R ij (cid:80) i x 2 i N i N i = (cid:80) ij ˜C sym ij x i x j (cid:107) x (cid:107) 2 = ρ , thus ρ (cid:16) ˜G syma (cid:17) ≥ ρ , concluding the proof . Data The MASZK questionnaire In this study we used data coming from the MASZK survey study [ 36 , 63 ] , a large data collection eﬀort on social mixing patterns made during the COVID - 19 pandemic , conducted in Hungary from April 2020 to July 2022 . The study involved 26 monthly cross - sectional anonymous phone surveys using Computer Assisted Telephone Interview ( CATI ) methodology , with a nationally representative sample of 1000 participants each month . The recorded population was representative in terms of gender , age , education level and type of settlement ; sampling errors were further corrected by post - stratiﬁcation weights . The data collection adhered to European and Hungarian privacy regulations , approved by the Hungarian National Authority for Data Protection and Freedom of Information [ 65 ] , as well as the Health Science Council Scientiﬁc and Research Ethics Committee ( resolution number IV / 3073 - 1 / 2021 / EKU ) . Relevant to this study , the questionnaires recorded information about the proxy social contacts , deﬁned as interactions where the respondent and a peer stayed within 2 meters for more than 15 min - utes [ 66 ] , at least one of them without wearing a mask . Approximate contact numbers were recorded between the respondents and their peers from diﬀerent age groups of 0 – 4 , 5 – 14 , 15 – 29 , 30 – 44 , 45 – 59 , 60 – 69 , 70 – 79 , and 80 + . Contact number data about underage children were collected by asking legal guardians to estimate daily contact patterns . Participants during the while data collection were asked to report contacts referring ( i ) to the previous day ( that we use for the analysis in Fig 4 in the main text ) and , during the ﬁrst data collection campaigns ( ii ) to an average pre - pandemic day ( that we use for the analysis in Fig 2 and 3 in the main text ) . Additionally , in three data collection waves : April 2021 , November 2021 and June 2022 contact have been collected in the form of diaries . Namely , par - ticipants were asked to list one by one the contacts they had on the previous day by providing some socio - demographic information about the contacts such as their wealth situation . Beyond information on contacts before and during the pandemic , the MASZK dataset provided us with information on social - demographic characteristics of participants , such as their perceived wealth situation , gender , vaccination status , etc . Other contacts data Beyond to the data on Hungary , we use data on Zimbabwe age - contact patterns [ 55 ] . Also in this case , the contacts numbers among age classes have been collected trough surveys . Age - contact matrices Although theoretically contacts ( i . e . , raw contacts ) are expected to be symmetrical , due to survey lim - itations and reporting errors they do not achieve perfect reciprocity . Given that our model to build synthetic generalized contact matrices respect the symmetric assumption on the raw contacts , we needed to ensure that also the matrix R that we fed to these models respects this assumption as well . Thus , all the raw contact matrices used in this study have been corrected for reciprocity a priori . This consists in averaging the total number of contacts measured in one direction , from i to j , and the reciprocal from j to i ( Eq 41 ) [ 67 ] . C ij = C dataij N i + C dataji N j 2 N i = R ij N i ( 41 ) Where , N i indicates the number of participants in age class i in each study , and C dataij N i is the total number of contacts reported in the survey from individuals in age class i with individuals in age class j . 27 0 . 1 0 . 2 0 . 3 p o p u l a t i o n f r a t c t i o n Hungary Zimbabwe [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i 10 20 2 4 6 8 Figure 5 : ( 1 st row ) Population distribution by age ( 2 nd row ) Age - contact matrices refered to the pre - pandemic period for Hungary and Zimbabwe . Parameters and implementation In order to ensure reproducibility of our work , in this section we include a comprehensive list of all the parameters employed to generate the synthetic and real - world generalized contact matrices utilized in the analysis presented in the main text . In addition , we provide all the technical details on the implement of the analysis . Figure 2 In Table 1 we report the list of parameters used to generate the generalized contact matrices for the analysis presented in Figure 2 in the main text . For the random mixing scenario the only set of parameters of interest is the population distribution . While , for the assortative regime we also report the values of the activity , assortativity and for the free parameters . Level 1 2 3 Population distribution 35 % 45 % 20 % Assortativity ( q i ) 60 % 50 % 65 % Activity ( P i ) 20 % 40 % 40 % Free parameters 0 . 6 0 . 6 0 . 5 Table 1 : List of parameters used to generate Figure 2 in the main text . 1 , 2 and 3 refers to the three categories of dimension two . Figure 3 To demonstrate the ﬂexibility of the proposed approach to model NPIs in Figure 3 we analyze three diﬀerent scenarios : ( i ) Baseline , ( ii ) NPI 1 and ( iii ) NPI 2 . In particular , in the scenario of NPI 1 , we assume that all the individuals reduce their contacts by 35 % at t ∗ = 50 , while in the scenario of NPI 2 , we assume that the introduction of NPI also aﬀects the structure of the matrix . Thus , to model these scenarios , we ﬁrst reduce by 35 % the age - contact matrix of the total number of contacts such that R NPIij = 0 . 65 R ij . Then , we feed R NPIij to our model to generate synthetic generalized contact matrices . For the ﬁrst scenario ( NPI 1 ) , the parameters of the model are equal to one of the baseline scenario , while , the parameters of the second scenario ( NPI 2 ) change accordingly to the assumption that we made on the new structure of contacts . In Table 2 we report the list of parameters used to generate the generalized contact matrices used for this analysis . Figure 4 We built generalized contact matrices stratiﬁed in two dimensions by using real data from the MASZK study . 28 Baseline NPI 2 Level 1 2 3 1 2 3 Population distribution 33 , 3 % 33 , 3 % 33 , 3 % 33 , 3 % 33 , 3 % 33 , 3 % Assortativity 33 , 3 % 50 % 60 % 50 % 60 % 70 % Activity ( P i ) 25 % 45 % 30 % 37 % 37 % 26 % Free parameters 0 . 5 0 . 5 0 . 5 0 . 5 % 0 . 4 % 0 . 4 % Table 2 : List of parameters used to generate Figure 3 in the main text , for ( i ) baseline and , ( ii ) NPI 2 scenarios . 1 , 2 and 3 refers to the three categories of dimension two . Information on social interactions have been collected in two diﬀerent ways i ) in an aggregate form , such that each participant reported the number of contacts they had with individuals in each of the eight age bracket considered , ii ) in a diary in which each participant listed one by one the interactions they had on a given day by reporting some meta information of the contactee such as their age and SES . In particular , the average number of contacts of an individual in age class i , and SES α with an individual in age class j , and SES β is G a , b where a = [ i , α ] and b = [ j , β ] . However , the MASZK data provided us with diaries information only for the adult population ( individuals older than 15 years old ) . For the children , their average number of contacts is available only in the aggregate form for the eight age brackets considered . Thus , we assigned the average number of contactee to the diﬀerent SES as follow : G iα , jβ = G iα , j u αβ , where G iα , j is the average number of contacts that individual of age group i and SES α has with all the individuals of age group j , and u αβ is a parameter that controls how these contacts are distributed among individuals of diﬀerent SES . In particular , to mimic assortativity patterns among SES , the values of u αβ is are set as follow . u αβ =   0 . 7 0 . 2 0 . 1 0 . 1 0 . 7 0 . 2 0 . 1 0 . 2 0 . 7   ( 42 ) The average number of contact of these matrices includes the contacts of the family members . However there contacts have been added afterwords to the matrix by assuming that individual belonging to the same family have the same SES . Impact of generalised contact matrices on epidemic modeling Zimbabwe To provide evidence of the robustness of the proposed approach we analyze contact data coming from another country . In particular , we consider the age - contact matrix C of Zimbabwe [ 55 ] ( Fig . 6 - a ) . We note how the age contact matrix contact is diﬀerent from the Hungarian one . Indeed , although the age assortative and the inter - generational interaction are still clear , it shows a high activity rate for the 80 + . By applying the same analysis that we did for the Hungarian data we study the impact of generalized contact matrices on epidemic modelling in ( i ) the random mixing ( Fig . 6 - b ) and , ( ii ) the assortative mixing ( Fig . 6 - e ) regimes . As in the main text , we imagine a simple case where the second dimension contains three groups : 1 , 2 , 3 . We assume that respectively 35 % , 45 % , and 20 % of the population belong to these three categories across all age groups for simplicity . For the assortative nixing scenario we assume that 60 % , 50 % , and 65 % of the contacts in the ﬁrst , second , and third group of the additional category take place within each group . Additionally , we assume some levels of heterogeneity also in the activity of the diﬀerent groups setting as 20 % , 40 % , and 40 % the share of contacts of the three groups . In Fig . 6 - f we show the matrix C αβ obtained by integrating the latter generalized contact matrix over all age classes . We use these matrices to study the unfolding of a virus in the population . In Fig . 6 - c we plot the attack rate ( i . e . , epidemic size ) as a function of R 0 and as a function of the transmissibility parameter Φ ( inset ) for 1 ) a model fed only with the contact matrix C ij ( grey circles ) , 2 ) a model fed with the generalized contact matrix G a , b ( green triangles ) , 3 ) a model fed with the matrix C αβ where contacts are stratiﬁed only according to the second dimension ( red stars ) . In Fig . 6 - d we show the prevalence of infected overtime of the three dimensions as predicted by the model fed with G a , b for the three groups . Instead in the inset , we show the the overall prevalence of infected predicted by the three models . We 29 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 11 . 94 a ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 11 . 94 b ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e c ) w / G ab w / C ij w / C 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 i n f e c t e d d ) dim2 123 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 17 . 33 e ) 1 2 3 dim2 1 2 3 d i m 2 ( C ) : 15 . 4 f ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e g ) w / G ab w / C ij w / C 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 0 . 20 i n f e c t e d h ) dim2 123 2 4 6 8 1 2 3 4 123123123123123123123123 123123123123123123123123 2 . 5 5 . 0 7 . 5 10 . 0 12 . 5 2 4 6 8 10 123123123123123123123123 123123123123123123123123 0 . 015 0 . 020 0 . 025 0 . 0 0 . 1 0 . 2 0 . 3 0 . 015 0 . 020 0 . 025 0 . 0 0 . 1 0 . 2 0 . 3 0 200 0 . 00 0 . 05 0 . 10 0 . 15 w / G ab w / C ij w / C 0 100 0 . 00 0 . 05 0 . 10 0 . 15 w / G ab w / C ij w / C Figure 6 : Impact of generalized contact matrices on epidemic spreading . ( a ) Example of a classic age contact matrix C ij ( 8 × 8 ) ; ( b ) and ( e ) Generalized contact matrices with an additional dimension with three levels G ab ( 24 × 24 ) in the case of random mixing among the second level groups ( b ) and in the case of assortative mixing and diﬀerent activity levels among the second dimension ( e ) ; ( c ) attack rate as a function of R 0 and disease prevalence ( d ) as a function of time in the case of random mixing ; ( g ) and ( h ) as the previous two plots but for the case of assortative mixing with diﬀerent levels of activity . Results refer to the median of 500 runs . Epidemiological parameters : µ = 0 . 25 , (cid:15) = 0 . 4 , R 0 = 2 . 5 , I 0 = 100 perform the same analysis for the assortative scenario and we show the results respectively in Fig . 6 - g and Fig . 6 - h . All the results are in perfect agreement with the ones discussed in the main text . Sensitivity analysis In this section , we perform a sensitivity analysis of the model we propose to build synthetic generalized contact matrices . In particular , we show how the spectral radius of G ab diﬀers from the one computed on the aggregate age contact C ij when we vary some of the parameters of the model . We create nine diﬀerent scenarios one for each combination of three sets of values for the population distribution of the second dimension and three sets of parameters for the assortativity . For each of these scenarios in Fig . 7 we show the ratio of the ρ ( G ab ) over ρ ( C ij ) as function of the activity of individuals in dim1 ( P 1 ) and , of individuals in dim2 ( P 2 ) . Given that (cid:80) 31 P i = 1 for each P 1 and P 2 , P 3 = 1 − P 1 − P 2 , thus each pair of values of P 1 , P 2 deﬁnes also the value of P 3 . As shown above , ρ ( G ab ) is always grater or equal to ρ ( C ij ) as expected from the theory . From Fig . 7 we can observe how the parameter sets of the diﬀerent scenarios are inﬂuencing the magnitude of this relation , suggesting that diﬀerent interaction patterns arising from correlation to an additional dimension eﬀectively impact the estimation of the basic reproductive number . 30 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 2 0 . 0 0 . 25 0 . 5 0 . 75 1 . 0 P 1 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y 1 . 0 1 . 2 1 . 4 1 . 6 1 2 3 dim2 0 . 0 0 . 5 p o p d i m 2 1 2 3 dim2 0 . 0 0 . 5 a ss o r t a t i v i t y Figure 7 : Sensitivity analysis . Variation of the ratio of the ρ ( G ab ) over ρ ( C ij ) as function of the activities P 1 , P 2 . Given that (cid:80) 31 P i = 1 for each P 1 and P 2 , P 3 = 1 − P 1 − P 2 . In each subplot G ab is computed according to our synthetic model using diﬀerent parameters distribution of population distribution of the second dimension ( left inset ) and assortativity along the second dimension ( right inset ) . The grey area refers to the non - physical solutions of the model . 31 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 35 . 74 a ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 52 . 5 b ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e c ) w / G ab w / C ij 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 i n f e c t e d d ) dim3 123 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 , dim3 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 , d i m 3 ( G ab ) : 57 . 76 e ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 , dim3 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 , d i m 3 ( G ab ) : 52 . 5 f ) 0 . 6 0 . 8 1 . 0 1 . 2 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e g ) w / G ab w / C ij 50 100 150 time 0 . 00 0 . 05 0 . 10 0 . 15 i n f e c t e d h ) dim3 123 5 10 15 20 25 10 20 30 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMHLMHLMHLMHLMHLMH 5 10 15 20 25 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 123123123123123123123123123123123123123123123123123123123123123123123123 123123123123123123123123123123123123123123123123123123123123123123123123 5 10 15 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3 123123123123123123123123123123123123123123123123123123123123123123123123 123123123123123123123123123123123123123123123123123123123123123123123123 0 . 005 0 . 010 0 . 0 0 . 1 0 . 2 0 . 3 0 . 005 0 . 010 0 . 0 0 . 1 0 . 2 0 . 3 0 100 0 . 00 0 . 05 0 . 10 w / G ab w / C ij 0 100 0 . 00 0 . 05 0 . 10 w / G ab w / C ij Figure 8 : Three dimensions generalized contact matrices . ( a ) Example of a classic age contact matrix C ij ( 8 × 8 ) ; ( b ) Generalized contact matrices with an additional dimension with two levels G ab ( 24 × 24 ) in the case of assortative mixing and diﬀerent activity levels among the second dimension ( e ) and ( f ) Generalized contact matrices with three levels G ab ( 72 × 72 ) ( e ) in the case of assortative mixing and diﬀerent activity levels among the third dimension and ( f ) in the case of random mixing among the third dimension ( e ) ; ( c ) attack rate as a function of R 0 and disease prevalence ( d ) as a function of time in the case of random mixing ; ( g ) and ( h ) as the previous two plots but for the case of assortative mixing with diﬀerent levels of activity . The results in panel ( c ) , ( d ) , ( g ) , ( h ) refers to the model with three levels . Results refer to the median of 500 runs . Epidemiological parameters : µ = 0 . 25 , (cid:15) = 0 . 4 , R 0 = 2 . 5 , I 0 = 100 Testing the model with three dimensions To show the validity of our approach beyond the two dimensions here we present the results of our analysis when we stratify the matrix along three dimensions ( age , dim2 and dim3 ) . We assume that also the third dimension has three possible groups . Starting from a generalized contact matrix with two dimensions ( Fig . 8 - b ) we build a generalized contact matrix with the assumption of random mixing among the third dimension ( Fig . 8 - f ) and assortative assumption along the third dimension ( Fig . 8 - e ) . We assume the same parameters as for the assortative regime of Fig . 2 in the main text to build the 2D matrix . While for the third dimension , we assume that individuals are respectively 30 % , 30 % and 40 % in the three dimensions . Additionally , we assume that 34 % , 33 % and 46 % represent the respective proportion of assortative contacts for the three groups and that 40 % , 40 % and 20 % indicate the relative activity of the three groups . Also in this case , we use these matrices to study the unfolding of a virus in the population . We can observe that , in the assortative mixing scenario , the spectral radius of the G a , b with three dimensions ( Fig . 8 - e ) is higher of the one of G a , b with two dimensions ( Fig . 8 - b ) . This implies that , given R 0 = 1 , the critical value of Φ predicted by the model with three dimensions is going to be higher than the one predicted by the model with two dimensions . In Fig . 8 - c we plot the attack rate ( i . e . , epidemic size ) as a function of R 0 and as a function of the transmissibility parameter Φ ( inset ) for 1 ) a model fed only with the contact matrix C ij ( grey circles ) , 2 ) a model fed with the generalized contact matrix G a , b with three dimensions ( purple squares ) . In Fig 8 - d we show the prevalence of infected overtime of the three dimensions as predicted by the model fed with G a , b with three dimensions for the three groups of dim 3 . Instead , in the inset we show the overall prevalence of infection predicted by the two models . We perform the same analysis for the assortative scenario and we show the results respectively in Fig 8 - g and Fig 8 - h . All the results are in perfect agreement with the ones discussed in the main text . 32 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 6 . 81 a ) L M H dim2 L M H d i m 2 ( C ) : 6 . 39 b ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 6 . 94 c ) 0 . 6 0 . 7 0 . 8 0 . 9 1 . 0 1 . 1 1 . 2 1 . 3 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e d ) w / G ab w / C ij w / C 0 20 40 60 80 100 120 time 0 . 00 0 . 05 0 . 10 i n f e c t e d e ) SES lowmidhigh 1 2 3 1 2 3 4 5 0 1 2 3 4 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMHLMHLMHLMHLMHLMH 0 . 030 0 . 035 0 . 040 0 . 045 0 . 0 0 . 1 0 . 2 50 100 150 0 . 00 0 . 05 0 . 10 w / G ab w / C ij w / C Figure 9 : Real world generalized contact matrices . ( a ) Age contact matrix C ij ( 8 × 8 ) ; ( b ) Socio - economic status ( SES ) contact matrix C αβ ( 3 × 3 ) and ( c ) Generalized contact matrix with age and socio - economic status G ab ( 24 × 24 ) ; ( d ) attack rate as a function of R 0 and ( d ) disease prevalence as a function of time . Results refer to the median of 500 runs . Epidemiological parameters : µ = 0 . 25 , (cid:15) = 0 . 4 , R 0 = 2 . 7 , I 0 = 100 . The matrices have been computed using the contact diaries coming from the MASZK data collected in Hungary during April 2021 . Real world generalized contact data The MASZK questionnaire provide us with three diaries that we were able to use to generate the generalized contact matrices stratifying by age and SES of participants . Here we show the results of the same analysis shown in the main text for two additional periods : April ( Fig . 9 ) and November ( Fig . 10 ) 2021 . While the overall results conﬁrm the one presented in the main text , models fed with standard and generalized contact matrices lead to estimations of the attack rates , for a given R 0 , which are closer to each other . Nevertheless , the model featuring generalized contact matrices allows capturing heterogeneities in the incidence across SES groups which are invisible to standard approaches . 33 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j ( C ij ) : 11 . 06 a ) L M H dim2 L M H d i m 2 ( C ) : 7 . 95 b ) [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) age class i , dim2 [ 0 - 5 ) [ 5 - 15 ) [ 15 - 30 ) [ 30 - 45 ) [ 45 - 60 ) [ 60 - 70 ) [ 70 - 80 ) [ 80 + ) a g e c l a ss j , d i m 2 ( G ab ) : 11 . 18 c ) 0 . 6 0 . 7 0 . 8 0 . 9 1 . 0 1 . 1 1 . 2 1 . 3 1 . 4 R 0 0 . 0 0 . 2 0 . 4 0 . 6 a tt a c k r a t e d ) w / G ab w / C ij w / C 0 20 40 60 80 100 120 time 0 . 00 0 . 05 0 . 10 i n f e c t e d e ) SES lowmidhigh 2 4 6 8 1 2 3 4 5 6 0 2 4 6 8 LMHLMHLMHLMHLMHLMHLMHLMH LMHLMHLMH LMHLMHLMHLMHLMH 0 . 020 0 . 025 0 . 030 0 . 035 0 . 0 0 . 1 0 . 2 100 200 0 . 00 0 . 05 w / G ab w / C ij w / C Figure 10 : Real world generalized contact matrices . ( a ) Age contact matrix C ij ( 8 × 8 ) ; ( b ) Socio - economic status ( SES ) contact matrix C αβ ( 3 × 3 ) and ( c ) Generalized contact matrix with age and socio - economic status G ab ( 24 × 24 ) ; ( d ) attack rate as a function of R 0 and ( d ) disease prevalence as a function of time . Results refer to the median of 500 runs . Epidemiological parameters : µ = 0 . 25 , (cid:15) = 0 . 4 , R 0 = 2 . 7 , I 0 = 100 . The matrices have been computed using the contact diaries coming from the MASZK data collected in Hungary during November 2021 . 34
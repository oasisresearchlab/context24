SMILE : Encounter‐Based Trust for Mobile Social Services Jus ; n Manweiler Ryan Scudellari Landon P . Cox CCS 2009 Chicago , Illinois Mobile Social Services on the Rise Trust in Mobile Social Services  Lessons from Online Social Networks  Inadvertent data leakage  Exposure by hackers  Abuse by system administrators  Loca ; on privacy is par ; cularly sensi ; ve  Why trust service providers ?  Root‐of‐trust should match the applica ; on  End users may be more appropriate  Must we pre‐deﬁne all social network relaFonships ? ( limits applicaFons , e . g . , Social Serendipity ) Revoca ; on errors Outline  Security in “Mobile Social Services”  An example applica ; on : “Missed Connec ; ons”  OpportuniFes  PiKalls  Our approach , relocate root‐of‐trust  Remove the need for a trusted third party  Novel protecFon mechanisms  Rely on peers , but without pre‐established relaFonships  Comparison to current prac ; ce  Suitability of our techniques to human behavior What is a Missed Connec ; on ?  How can Alice contact Bob ?  Not just for da ; ng  Retrieve leO‐behind items  Discussion aOer a lecture  Lost phone number  … Is there really a demand ?  Plenty of online missed connec ; ons  Craigslist , Gumtree , I Saw You , ChancedIt , Qwaro…  Social networking : a growing industry  Projected $ 7 . 3B by 2013 [ Juniper Research ]  Online da ; ng  Third‐largest revenue of all online paid content ( aOer music , gaming ) [ Forrester Research ]  Da ; ng as a Mobile Social Service  “Mobile daFng” $ 1 . 4B by 2013 [ Juniper ] Alice Bob “We saw each other on the subway…” Indirect Approach : Craigslist craigslist Chicago lisFngs Diﬃcult ! Many security ﬂaws Bob “Hi , I’m Bob ! ” Impersona ; on Mobile “Missed Connec ; ons” Service Provider Alice Subway 1 : 00 PM Bob Subway 1 : 00 PM … … Trustworthy ? Leaked / Stolen Data Snooping , De‐anonymiza ; on “Remember me ? ” Alice @ { Subway , 1 : 00 PM } Bob @ { Subway , 1 : 00 PM } Internal Abuse Secure Missed Connec ; ons  User‐to‐user matching  On the basis of encounters ( incidents of co‐locaFon )  Encounter event provides the root‐of‐trust  Preserve par ; cipant privacy  LocaFon privacy = Where have I been ?  Encounter privacy = Whom have I met ?  Establishment of a secure messaging channel  Message anonymity / conﬁdenFality / integrity  Veriﬁable encounter proofs  Unobservable to any absent party SMILE S ecure Mi ssed Connec4ons through L ogged E ncounters High‐level Approach  Create “shared knowledge” of encounter  Peers establish cryptographically‐secure secrets  Diﬃcult for absent adversaries to guess  Secret never revealed to any third party Key Techniques  Passive key exchange  Short‐range wireless for co‐located devices  Enables encrypted communicaFon ( shared key )  Key hashes  Hashed shared key provides logical rendezvous  Can be ( parFally ) revealed to the server  Server never sees locaFons ( locaFon privacy )  Collisions in the key‐hash domain  Hash collisions at server ( induced by parFcipants )  End‐users resolve ambiguiFes with original keys Subway 1 : 00 PM Key D Subway 1 : 00 PM Key B Subway 1 : 00 PM Key B Key A Key B Subway 1 : 00 PM Key A Subway 1 : 00 PM Key A Passive Key Exchange Keys create shared knowledge Periodic , no explicit user interacFon Only known to co‐located devices Encounter Key = Key A + Key B Encounter Key = Key A + Key B Keys and Key Hashes Alice H ( K A + K B ) Bob H ( K A + K B ) Service Provider Alice @ H ( K A + K B ) Bob @ H ( K A + K B ) H ( K A + K B ) K A + K B Subway , 1 : 00 PM H ( K X + K Y ) K X + K Y Lecture , 8 : 00 AM Alice @ H ( K A + K B ) ; { “Hi…” } KA + KB Bob @ H ( K A + K B ) ; { “Hi…” } KA + KB Protects loca ; on privacy End‐to‐end secure channel H ( K A + K B ) K A + K B Subway , 1 : 00 PM H ( K R + K S ) K R + K S Store , 7 : 45 PM What about encounter privacy ? Key‐hash Collisions  Link between encountered peers clear  Shared key‐hash idenFﬁes Alice / Bob pair  Encounter privacy guards user interac ; ons  Protect whom Alice encounters , messages  Idea : induce hash collisions at service provider  Send a key‐hash preﬁx , instead of complete hash Alice H ( K A + K B ) Bob H ( K A + K B ) Service Provider Unique match makes encounter obvious Key‐hash Collisions Alice Pre ( H ( K A + K B ) ) Bob Pre ( H ( K A + K B ) ) Chris Pre ( H ( K C + K D ) ) Dave Pre ( H ( K C + K D ) ) Service Provider Alice @ Pre ( H ( K A + K B ) ) Bob @ Pre ( H ( K A + K B ) ) H ( K A + K B ) K A + K B Subway , 1 : 00 H ( K X + K Y ) K X + K Y Lecture , 8 : 00 Chris @ Pre ( H ( K C + K D ) ) Dave @ Pre ( H ( K C + K D ) ) Alice @ Pre ( H ( K A + K B ) ) ; { “Hi…” } KA + KB Pre ( H ( K A + K B ) ) ; { “Hi…” } KA + KB Pre ( H ( K A + K B ) ) = Pre ( H ( K C + K D ) ) Only Bob can decrypt ? H ( K A + K B ) K A + K B Subway , 1 : 00 H ( K R + K S ) K R + K S Store , 7 : 45 Key‐hash Collisions  Trading communica ; on overhead for privacy  Must select appropriate preﬁx length ( diﬃcult )  Op ; mal preﬁx length depends on…  Desired privacy level ( k ‐anonymity )  Number of users and messaging rate ( uFlizaFon )  User mobility ( encounter frequency , distribuFon )  Acceptable messaging latency ( Fming ajacks )  In paper : model of privacy / overhead tradeoﬀ Evalua ; on  Analy ; cal model of privacy / overhead ( paper )  Craigslist missed‐connec ; ons survey  Wanted to characterize typical behavior  Looked at 100 posts from 8 US ciFes  Manual content classiﬁcaFon  SMILE implementa ; on  Can we detect encounters fast enough ? Types of Manual Checks Type of Confirmation Requested 5 10 15 20 25 30 35 40 45 Personal Description Things Present Memorable Event Time or Place Other Observable Privately Shared % C l a ss i f i ed E n c oun t e r s 0 Encounter Distance Estimated Physical Distance of Encounter 10 20 30 40 50 Intimate < 1m % C l a s s i f i ed E n c oun t e r s 0 Nearby 1 - 5m Around 5 - 10m Distant > 10m Encounter Dura ; on Extended ( > 1 minute ) Short ( 15 seconds ! 1 minute ) Instantaneous ( < 15 seconds ) 0 80 100 % C l a ss i f i e d E n c oun t e r s 40 20 60 Atlanta SF Bay Area NYC Bluetooth Detec ; on Accuracy Partial Detection ( sufficient ) No Detection ( failure ) Full Detection ( bidirectional ) 0 80 100 5 10 20 30 45 60 % D e t e c t ed E n c oun t e r s Encounter Duration ( seconds ) 40 20 60 Two devices running SMILE , each pausing 15s between scans Related Work  Loca ; on proofs  Saroiu and Wolman ( HotMobile ’09 )  Lenders et al ( HotMobile ’08 )  Relies on external infrastructure  Local key exchange  SPATE ( Mobisys ’09 )  Assumes pre‐established user trust  Loca ; on privacy and mobile services  Adeona ( USENIX Security ’08 ) Limita ; ons  Diﬃcult to es ; mate op ; mal preﬁx length  Requires some diﬃcult‐to‐acquire parameters  Incomplete evalua ; on of system impact  Energy , CPU performance on device  Social impact  Risk of co‐located adversaries ( e . g . , stalking ) Conclusion  Eﬃcient missed‐connec ; ons service  Convenient user‐to‐user messaging service  Non‐centralized root‐of‐trust  Rely on encounter co‐locaFon event  No pre‐established trust relaFonships  Key hashes and key‐hash collisions  Novel mechanisms for locaFon privacy , anonymity Ques : ons ? Thank you http : / / www . cs . duke . edu / ~ jgm /
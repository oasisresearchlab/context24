a r X i v : m a t h / 0611263v1 [ m a t h . S T ] 9 N ov 2006 The Annals of Statistics 2006 , Vol . 34 , No . 4 , 1814 – 1826 DOI : 10 . 1214 / 009053606000000407 c (cid:13) Institute of Mathematical Statistics , 2006 AFFINELY INVARIANT MATCHING METHODS WITH DISCRIMINANT MIXTURES OF PROPORTIONAL ELLIPSOIDALLY SYMMETRIC DISTRIBUTIONS By Donald B . Rubin and Elizabeth A . Stuart 1 Harvard University and Johns Hopkins University In observational studies designed to estimate the eﬀects of in - terventions or exposures , such as cigarette smoking , it is desirable to try to control background diﬀerences between the treated group ( e . g . , current smokers ) and the control group ( e . g . , never smokers ) on covariates X ( e . g . , age , education ) . Matched sampling attempts to eﬀect this control by selecting subsets of the treated and con - trol groups with similar distributions of such covariates . This pa - per examines the consequences of matching using aﬃnely invariant methods when the covariate distributions are “discriminant mixtures of proportional ellipsoidally symmetric” ( DMPES ) distributions , a class herein deﬁned , which generalizes the ellipsoidal symmetry class of Rubin and Thomas [ Ann . Statist . 20 ( 1992 ) 1079 – 1093 ] . The re - sulting generalized results help indicate why earlier results hold quite well even when the simple assumption of ellipsoidal symmetry is not met [ e . g . , Biometrics 52 ( 1996 ) 249 – 264 ] . Extensions to conditionally aﬃnely invariant matching with conditionally DMPES distributions are also discussed . 1 . Background . The goal in many applied projects is to estimate the causal eﬀect of a treatment ( e . g . , cigarette smoking ) from nonrandomized data by comparing outcomes ( e . g . , lung cancer rates ) in treated ( e . g . , cur - rent smokers ) and control ( e . g . , never smokers ) groups , after adjusting for covariate diﬀerences ( e . g . , age , education ) between the groups . A common method is to form matched subsamples of the treated and control groups such that the distributions of covariates X are more similar in the matched samples than in the original groups . The use of matched sampling has been Received July 2005 ; revised September 2005 . 1 Supported in part by a National Science Foundation Graduate Research Fellowship . AMS 2000 subject classiﬁcations . Primary 62D05 , 62H05 ; secondary 60E05 , 62H30 , 62K99 . Key words and phrases . Causal inference , equal percent bias reducing ( EPBR ) , matched sampling , propensity scores . This is an electronic reprint of the original article published by the Institute of Mathematical Statistics in The Annals of Statistics , 2006 , Vol . 34 , No . 4 , 1814 – 1826 . This reprint diﬀers from the original in pagination and typographic detail . 1 2 D . B . RUBIN AND E . A . STUART receiving more and more attention in ﬁelds such as statistics ( e . g . , [ 11 , 15 ] ) , economics ( e . g . , [ 4 , 7 , 10 , 21 ] ) , political science ( e . g . , [ 9 ] ) , sociology ( e . g . , [ 20 ] ) and medicine ( e . g . , [ 1 ] ) as a class of methods for controlling bias in such observational studies . Here we provide theoretical guidance for choos - ing matching methods that reduce bias in the matched groups , as well as guidance on the amount of bias reduction that can be achieved with ﬁxed distributions and ﬁxed sample sizes . We begin with random samples from the treated and control groups of ﬁxed sizes N t and N c , respectively , with X measured in both samples . Matching chooses subsamples of ﬁxed sizes N mt and N mc from the origi - nal groups on which to measure the outcome variables , as well as possibly measure additional covariates . Throughout , we use the subscripts t and c to indicate quantities in the original random samples from the treated and control groups , and the subscripts mt and mc to indicate the corresponding quantities in the matched treated and control groups . We restrict attention to a particular but general class of matching meth - ods , those that are aﬃnely invariant . In practice , many matching methods are aﬃnely invariant in the sense that the same matched samples will be obtained after any full - rank aﬃne transformation of X . For example , the same matches will be obtained if people’s heights are measured in inches or centimeters , or if their temperatures are measured in degrees Fahren - heit or degrees Kelvin . Formally , let X t and X c be data matrices ( units by variables ) . A matching method is a mapping from ( X t , X c ) to a pair of sets of indices ( T , C ) representing the units chosen in the matched samples . An aﬃnely invariant matching method results in the same output ( T , C ) after any ( full - rank ) aﬃne transformation A of the X : ( X t , X c ) → ( T , C ) implies ( A ( X t ) , A ( X c ) ) → ( T , C ) . Aﬃnely invariant matching methods include Mahalanobis metric , discrimi - nant or propensity score matching . Non - aﬃnely invariant methods include methods where one coordinate of X is treated diﬀerently from the others or where nonlinear estimators of the discriminant ( or other metric ) are used , as discussed by Rubin and Thomas [ 16 ] . Theoretical results in papers by Rubin and Thomas [ 16 , 17 ] describe the eﬀects of aﬃnely invariant matching on bias reduction , as well as on variance , in the matched treated and matched control groups , when X has ellipsoidally symmetric distributions ( e . g . , the normal distribution or the multivariate t ) in the treated and control groups , with proportional covariances . Rubin and Thomas [ 18 ] used these theoretical results to obtain a series of approxima - tions for the bias and variance reduction possible in a particular matching setting using true and estimated propensity scores , with no subsampling of the treated sample and normal distributions . They then examined the per - formance of these approximations by simulation with ellipsoidal nonnormal MATCHING WITH DMPES DISTRIBUTIONS 3 distributions and found that the approximations based on the normal dis - tribution held remarkably well , even for a t - distribution with 5 degrees of freedom . They also explored the performance of the approximations with real data from a study of prenatal hormone exposure , with 15 ordinal or dichotomous covariates . Again , the approximations based on the normal distribution were found to hold well , despite the clear deviations from the underlying assumptions . Later work by Hill , Rubin and Thomas [ 8 ] also showed that the Rubin and Thomas [ 18 ] approximations held quite well with real data in the con - text of an evaluation of the New York School Choice Scholarship Program , which utilized randomization to award scholarships to eligible participants . Out of the large pool of possible controls , a matched sample was chosen for follow - up , where the matching was done using an aﬃnely invariant match - ing method based on 21 ordinal or dichotomous covariates . Hill , Rubin and Thomas compared the bias and variance beneﬁts of choosing matched con - trols rather than a random sample of controls . The Rubin and Thomas [ 18 ] results predict a gain of eﬃciency for diﬀerences in covariate means by a factor of approximately two , and Hill et al . showed that this predicted gain in eﬃciency was achieved , despite the markedly nonnormal distributions of some of the covariates . In this paper we generalize the results of Rubin and Thomas [ 16 , 17 , 18 ] to the setting where the treated and control groups’ covariate distributions are “discriminant mixtures of proportional ellipsoidally symmetric” ( DMPES ) distributions . We see that most , but not all , of the basic results in fact hold under these more general conditions , which support the broader applicability of these results , as suggested by the empirical evidence referenced above . We use as a running example the estimation of the eﬀects of smoking on lung cancer , where the results here were used to motivate diagnostics for the results of matching [ 15 ] . 2 . Discriminant mixtures of ellipsoidally symmetric distributions . An ellipsoidal distribution for p - component X is a distribution such that a linear transformation of X leads to a spherically symmetric distribution , which is deﬁned by the distribution on the radii of concentric hyperspheres on which there is a uniform probability density . Thus , an ellipsoidal distribution is speciﬁed by its center , inner product and distribution on the radius [ 5 ] . Definition . The distribution on X , F ( X ) , is a “discriminant mixture of proportional ellipsoidally symmetric” ( DMPES ) distribution if it possesses the following properties : 4 D . B . RUBIN AND E . A . STUART ( i ) F ( X ) is a mixture of K ellipsoidally symmetric distributions { F k ; k = 1 , . . . , K } , F ( X ) = K X k = 1 α k F k ( X ) , ( 1 ) where α k ≥ 0 for all k = 1 , . . . , K , and P Kk = 1 α k = 1 , where F k has center µ k and inner product Σ k . Hence , the “mixture” ( M ) and “ellipsoidally symmet - ric” ( ES ) parts of DMPES . ( ii ) The K inner products are proportional : Σ i ∝ Σ j for all i , j = 1 , . . . , K . ( 2 ) Hence , the “proportional” ( P ) part of DMPES . ( iii ) The K centers are such that all best linear discriminants between any two components are proportional : ( µ i − µ j ) Σ − 1 k ∝ ( µ i ′ − µ j ′ ) Σ − 1 k ′ for all i , j , k , i ′ , j ′ , k ′ = 1 , . . . , K . ( 3 ) Hence , the “discriminant” ( D ) in DMPES , because all mixture component centers lie along the common best linear discriminant . In [ 16 , 17 , 18 ] , K = 2 , corresponding to the treated and control groups , and ( 2 ) is assumed ; ( 3 ) is superﬂuous in the case with K = 2 . With DMPES distributions , there exists an aﬃne transformation to a special canonical form , which is a simple extension of results in [ 3 , 6 ] and [ 14 ] . This canonical form has , for each mixture component , the property that the distribution of X is spherical , so that all inner products can be written as σ 2 k I , where I is the p × p identity matrix and σ 2 k is a positive scalar constant , k = 1 , . . . , K . Moreover , the canonical form has the component centers lying along the unit vector ( unless all µ i = µ j ) so that the centers are δ k U , where U = ( 1 , . . . , 1 ) ′ , the p - component unit vector , and the δ k are scalar constants , k = 1 , . . . , K ; if all µ i = µ j , then all δ k = 0 . Therefore , in their canonical form , the distribution of each component of X is the same , and thus , the distribution of X is exchangeable , not only within each of the K mixture components , but also for any collection of mixture components deﬁned by a subset of the indices { 1 , . . . , K } . Moreover , further symmetry results can be stated for a DMPES distribu - tion by decomposing X into its projection along the best linear discriminant , Z , and its projection orthogonal to Z . Speciﬁcally , the standardized best lin - ear discriminant can be written as Z = U ′ X / p 1 / 2 , ( 4 ) MATCHING WITH DMPES DISTRIBUTIONS 5 unless all δ k = 0 , in which case Z is deﬁned to be 0 , the zero vector . Also , let W be a standardized one - dimensional linear combination of X orthogonal to Z , W = γ ′ X , γ ′ Z = 0 , γ ′ γ = 1 . ( 5 ) All such W have the identical distribution in each mixture component , and the identical distribution for any collection of mixture components deﬁned by a subset of the indices { 1 , . . . , K } . Thus , the distribution of X orthogonal to Z has rotational symmetry , that is , is spherically symmetric . Now suppose K t of the K mixture components comprise the treatment group , and K c components comprise the control group , K t + K c = K ; K t , K c ≥ 1 . Denote the set of treatment group component indices by T and the set of control group component indices by C , T ∪ C = { 1 , . . . , K } . For example , T identiﬁes current smokers and C identiﬁes never smokers . The previous discussion implies that the distribution of X is exchangeable in the treated group and in the control group , and moreover , the distribution of X orthog - onal to the discriminant Z is spherically symmetric in the treated group and in the control group . This is the theoretical distributional setting for our re - sults . In the more restrictive setting of [ 16 ] with proportional ellipsoidally symmetric distributions , X is spherically symmetric in both groups . 3 . Results of matching with aﬃnely invariant methods . When aﬃnely invariant matching methods are used with DMPES distributions , the canon - ical form given in Section 2 can be assumed without loss of generality . The following results , stated in canonical form , closely parallel results from [ 16 ] . The main symmetry arguments do not change with the use of mixtures of distributions . Although most of our results can be written without assuming ﬁnite ﬁrst two moments in each mixture component and without restricting K to be ﬁnite , the extra generality complicates notation and appears to be of little practical importance . Theorem 3 . 1 . Suppose an aﬃnely invariant matching method is applied to random treated and control samples with DMPES distributions . Then E ( X mt ) ∝ E ( X mc ) ∝ U and var ( X mt − X mc ) ∝ I + cUU ′ , c ≥ − 1 / p , where X mt and X mc are the mean vectors in the matched treated and control samples , and E ( · ) and var ( · ) are the expectation and variance over repeated random draws from the initial treated and control populations . Also , E ( ν mt ( X ) ) ∝ I + c t UU ′ , c t ≥ − 1 / p , E ( ν mc ( X ) ) ∝ I + c c UU ′ , c c ≥ − 1 / p , 6 D . B . RUBIN AND E . A . STUART where ν mt ( X ) and ν mc ( X ) are the sample covariance matrices of X in the matched treated and control groups , respectively . Corresponding formulas also hold within each of the mixture components . When Z = 0 , E ( X mt ) = E ( X mc ) = 0 , the zero vector , and c = c t = c c = 0 . Proof . The proof follows directly from symmetry arguments and is essentially the same as that of Theorem 3 . 1 in [ 16 ] . Brieﬂy , with aﬃnely invariant matching methods , the matching treats each coordinate of X the same and , hence , the exchangeability of the DMPES distributions of X in matched treated and control samples is not aﬀected . Thus , the expectations of the matched sample means of all coordinates of X must be the same and , hence , the expectation of X must be proportional to U in each matched group . Analogously , the covariance matrices of X must be exchangeable in each matched group . The general form for the covariance matrix of ex - changeable variables is proportional to I + cUU ′ , c ≥ − 1 / p . When Z = 0 , the direction U is no diﬀerent from any other , that is , there is complete rotational symmetry and , hence , the simpliﬁcation . (cid:3) Corollary 3 . 1 . The quantities var ( W mt − W mc ) , E ( ν mt ( W ) ) and E ( ν mc ( W ) ) take the same three values for all standardized W orthogonal to Z . In addition , for each mixture component , E ( ν mk ( W ) ) takes the same value for all W , where ν mk ( W ) is the sample variance of W in the matched mixture component k ∈ T or C . Proof . The corollary follows from the fact that , due to the rotational symmetry in matched samples implied by Theorem 3 . 1 orthogonal to the discriminant , any W will have the same distribution . (cid:3) 4 . The eﬀects on a linear combination of X of aﬃnely invariant matching relative to random sampling . As in [ 16 , 17 , 18 , 19 ] , it is natural to describe the results of matching by its eﬀects on a linear combination of X , Y = β ′ X , where , for convenience , we assume Y is standardized , β ′ β = 1 . Any such Y can be expressed as the sum of projections along and orthogonal to the best linear discriminant , Y = ρZ + ( 1 − ρ 2 ) 1 / 2 W , ( 6 ) where ρ is the correlation between Y and Z . When Z = 0 , Y = W and ρ ≡ 0 . It is also natural , as in [ 16 , 17 , 18 , 19 ] , to compare the results of the match - ing to random sampling done in an aﬃnely invariant way , such as randomly sampling from the original treated and control groups , thereby sampling from each component in proportion to its fraction in the population [ the α ’s in ( 1 ) ] , or randomly sampling from each component with ﬁxed proportions , MATCHING WITH DMPES DISTRIBUTIONS 7 where the same ﬁxed proportions would be used in matching . We will refer to the treated and control samples generated by any such random sampling by indices rt and rc , respectively , where N rt = N mt and N rc = N mc , but generally , of course , N t ≥ N rt and N c ≥ N rc . The following corollaries decompose the eﬀects on Y of aﬃnely invariant matching on X into the eﬀects of the matching on Z and on W , relative to random sampling . Assuming the formulation from Section 2 , we have the following results . Corollary 4 . 1 . ( a ) When E ( Z rt − Z rc ) 6 = 0 , the matching is equal percent bias reducing ( EPBR ) , as deﬁned by [ 14 ] , E ( Y mt − Y mc ) E ( Y rt − Y rc ) = E ( Z mt − Z mc ) E ( Z rt − Z rc ) . ( 7 ) Because the right - hand side of the above equation takes the same value for all Y , the percent bias reduction is the same for all Y . ( b ) When Z = 0 , the numerator and denominator of both ratios in equa - tion ( 7 ) are 0 . ( c ) When E ( Z rt − Z rc ) = 0 but Z 6 = 0 , the denominators of both ratios in equation ( 7 ) are 0 , and then E ( Y mt − Y mc ) = ρE ( Z mt − Z mc ) . Proof . The proof of result ( a ) parallels the proof of Corollary 3 . 2 in [ 16 ] ; however , here , rather than simple averages of Z , W and Y , the averages are weighted averages of the mixture components , weighted , for example , by the α ’s in ( 1 ) . Using the deﬁnition of Y , E ( Y mt − Y mc ) = ρE ( Z mt − Z mc ) + ( p 1 − ρ 2 ) E ( W mt − W mc ) , where , by the deﬁnition of W , E ( W mt − W mc ) = γ ′ E ( X mt − X mc ) . From Theorem 3 . 1 , E ( X mt − X mc ) ∝ U and again from the deﬁnition of W in equation ( 5 ) , γ ′ Z = 0 . Thus , E ( Y mt − Y mc ) = ρE ( Z mt − Z mc ) . Similarly , E ( Y rt − Y rc ) = ρE ( Z rt − Z rc ) because E ( W rt − W rc ) = 0 and result ( a ) of Corollary 4 . 1 follows . Results ( b ) and ( c ) follow by analogous arguments . Situation ( c ) cannot arise when K = 2 because , with only one treated and one control compo - nent , E ( Z rt − Z rc ) = 0 implies that Z = 0 . However , with multiple compo - nents in the treated and control groups , the diﬀerence in weighted averages ( E ( Z rt − Z rc ) ) can equal 0 without all of the mixture component centers ( { µ k } ) being 0 . (cid:3) This corollary implies that aﬃnely invariant matching that reduces bias in one direction cannot create bias in some other direction . If bias reduction is obtained along Z , it is also obtained for all Y . 8 D . B . RUBIN AND E . A . STUART Corollary 4 . 2 . The matching is ρ 2 proportionate modifying of the variance of the diﬀerence in matched sample means , var ( Y mt − Y mc ) var ( Y rt − Y rc ) = ρ 2 var ( Z mt − Z mc ) var ( Z rt − Z rc ) + ( 1 − ρ 2 ) var ( W mt − W mc ) var ( W rt − W rc ) , ( 8 ) where the ratios var ( Z mt − Z mc ) var ( Z rt − Z rc ) and var ( W mt − W mc ) var ( W rt − W rc ) take the same two values for all Y . Proof . Using the deﬁnitions of Z and W in ( 4 ) and ( 5 ) , cov ( Z mt − Z mc , W mt − W mc ) = 1 √ pU ′ var ( X mt − X mc ) γ , which from Theorem 3 . 1 is proportional to U ′ ( I + cUU ′ ) γ = U ′ γ + cpU ′ γ = 0 , again using the deﬁnition of W in ( 5 ) . Then , from the deﬁnition of Y in ( 6 ) , var ( Y mt − Y mc ) = ρ 2 var ( Z mt − Z mc ) + ( 1 − ρ 2 ) var ( W mt − W mc ) . Equation ( 8 ) follows because , in random subsamples , the samples from each treated and control mixture component are independent with var ( Y rt − Y rc ) = var ( Z rt − Z rc ) = var ( W rt − W rc ) . Also , var ( Y rt ) = var ( Z rt ) and var ( Y mc ) = var ( Z mc ) , and each is a weighted linear combination of the variances in each of the treated and control mixture components , respectively . The ﬁnal statement of Corollary 4 . 2 follows from Corollary 3 . 1 . (cid:3) Corollary 4 . 3 . Within each of the mixture components , the matching is ρ 2 proportionate modifying of the expectation of the sample variances , E ( ν mk ( Y ) ) E ( ν rk ( Y ) ) = ρ 2 E ( ν mk ( Z ) ) E ( ν rk ( Z ) ) + ( 1 − ρ 2 ) E ( ν mk ( W ) ) E ( ν rk ( W ) ) , ( 9 ) where ν rk ( · ) is the sample variance of n k randomly chosen units from com - ponent k , and ν mk ( · ) is the sample variance of n k matched units from com - ponent k ( k ∈ T or C ) , and the ratio E ( ν mk ( W ) ) E ( ν rk ( W ) ) takes the same value for all Y . The same is true for E ( ν mk ( Z ) ) / E ( ν rk ( Z ) ) . MATCHING WITH DMPES DISTRIBUTIONS 9 Proof . In the matched sample from component k ∈ T or C , the ex - pected covariance of Z and W is E ( cov mk ( Z , W ) ) = 1 √ pE ( U ′ ν mk ( X ) γ ) ∝ U ′ ( I + c k pUU ′ ) γ = 0 , from Theorem 3 . 1 and the deﬁnition of W in ( 5 ) , and ν mk ( X ) ∝ I + c k UU ′ , where the constants c k ≥ − 1 / p . Then , from ( 6 ) , E ( ν mk ( Y ) ) = ρ 2 E ( ν mk ( Z ) ) + ( 1 − ρ 2 ) E ( ν mk ( W ) ) . Equation ( 9 ) follows because E ( ν rk ( Y ) ) = E ( ν rk ( Z ) ) = E ( ν rk ( W ) ) . The ﬁ - nal statement follows from Corollary 3 . 1 . (cid:3) Note that the version of Corollary 4 . 3 stated for the full treated and control groups does not hold . In the special case considered in [ 16 ] , there is only one component in each group . 5 . Conditionally aﬃnely invariant matching with conditionally DMPES distributions . We now extend the results of the previous sections to a set - ting where a subset of the covariates is treated diﬀerently from the remain - der of the covariates , for example , exact matching on gender followed by discriminant matching , or Mahalanobis matching on key covariates within propensity score calipers [ 13 ] . Such matching was done , for example , in [ 15 ] when creating matched samples of current smokers and never smokers . We deﬁne X ( s ) to be the s “special covariates” spanning an s - dimensional subspace ( e . g . , gender , race in the smoking example ) and X ( r ) to be the r = p − s remaining covariates spanning an r - dimensional subspace ( e . g . , education , age ) . The methods considered are “conditionally aﬃnely invariant matching methods” [ 16 ] , which have the property that the result of the matching is the same following any ( full - rank ) aﬃne transformation of the “remainder” covariates X ( r ) : ( ( X ( s ) t , X ( r ) t ) , ( X ( s ) c , X ( r ) c ) ) → ( T , C ) implies ( ( X ( s ) t , A ( X ( r ) t ) ) , ( X ( s ) c , A ( X ( r ) c ) ) ) → ( T , C ) . In parallel with Section 2 , we consider the case where each mixture compo - nent of the full covariate distribution has mean vectors µ ( s ) k and µ ( r ) k , covari - ance matrices Σ ( s ) k and Σ ( r ) k , and conditional means and covariance matrices given by µ ( r | s ) k and Σ ( r | s ) k . The full distribution of X = ( X ( r ) , X ( s ) ) across both groups is a conditional DMPES distribution if ( i ) the conditional dis - tribution X ( r ) | X ( s ) is ellipsoidal in each mixture component , ( ii ) it has pro - portional conditional covariance matrices , Σ ( r | s ) k ∝ Σ ( r | s ) k ′ for all k and k ′ , and 10 D . B . RUBIN AND E . A . STUART ( iii ) it has centers such that ( µ ( r | s ) i − µ ( r | s ) j ) Σ ( r | s ) − 1 k ∝ ( µ ( r | s ) i ′ − µ ( r | s ) j ′ ) Σ ( r | s ) − 1 k ′ for all i , j , k , i ′ , j ′ , k ′ = 1 , . . . , K . Notice that condition ( ii ) implies a common ( across all mixture components ) linear regression of the r covariates in X ( r ) on the s covariates in X ( s ) , with coeﬃcients B . As noted by [ 16 ] , the special case with X ( s ) binomial or multinomial and X ( r ) multivariate normal relates to the logistic regression model for predicting treated or control status given the covariates , thus relating it to the methods of propensity score estimation developed by Rosenbaum and Rubin [ 12 , 13 ] . We again can use a canonical form when a conditionally aﬃnely invariant matching method is used with a conditionally DMPES distribution . The covariates X ( r ) are redeﬁned as the components of X ( r ) uncorrelated with X ( s ) : X ( r ) − B ′ X ( s ) . The following notation is then used for the moments of the distribution of X ( r ) [ and the conditional moments of X ( r ) given X ( s ) ] : µ ( r ) k = δ ( r ) k U , Σ ( r ) k = σ 2 k I , k = 1 , . . . , K , where δ ( r ) k and σ 2 k are scalar constants , U is now the r - dimensional unit vector , and I is now the r × r identity matrix . Thus , the distributions of ( X ( s ) , X ( r ) ) and X ( r ) given X ( s ) are exchangeable under permutations of components of X ( r ) conditional on X ( s ) in each of the mixture components . Theorem 5 . 1 . Suppose a conditionally aﬃnely invariant matching method is applied to random treated and control samples with conditional DMPES distributions . Then , in canonical form , E ( X ( r ) mt ) ∝ U , E ( X ( r ) mc ) ∝ U and var ( X mt − X mc ) = " var ( X ( s ) mt − X ( s ) mc ) CU ′ UC ′ k ( I + c 0 UU ′ ) # , where k ≥ 0 , c 0 ≥ − 1 / r and C ′ = ( c 1 , . . . , c s ) . Also , E ( ν mt ( X ) ) = " E ( ν mt ( X ( s ) ) ) C t U ′ UC ′ t k t ( I + c t 0 UU ′ ) # , where k t ≥ 0 , c t 0 ≥ − 1 / r , C ′ t = ( c t 1 , c t 2 , . . . , c ts ) , with an analogous result and notation for the matched control group . When Z = 0 , E ( X ( r ) mt ) = E ( X ( r ) mc ) = 0 , C = C t = C c = 0 , the zero vector , and c 0 = c t 0 = c c 0 = 0 . Proof . The proof of this theorem parallels that of Theorem 3 . 1 , with the exception of the existence of the covariances between components in X ( s ) and X ( r ) . Due to the symmetry , these covariances are also exchangeable in the coordinates of X ( r ) . (cid:3) MATCHING WITH DMPES DISTRIBUTIONS 11 6 . Eﬀect on Y of matching with special covariates . In parallel with the earlier formulation , we express an arbitrary linear combination of X as Y = ρ Z + ( 1 − ρ 2 ) 1 / 2 W , where Z and W are the standardized projections of Y along and orthogonal to the subspace spanned by ( X ( s ) , Z ) , respectively , and ρ is the correlation between Y and Z . In this framework , Z is the standardized discriminant of the covariates uncorrelated with X ( s ) , again expressed in canonical form as Z = U ′ X ( r ) / r 1 / 2 . When µ ( r ) k = 0 for all k , Z is deﬁned to be the zero vector , and then Z is deﬁned to be the projection of Y in the subspace spanned by X ( s ) . We write Z and W as Z = ψ ′ X = ( ψ ( s ) ′ , ψ ( r ) ′ ) (cid:18) X ( s ) X ( r ) (cid:19) , ( 10 ) W = γ ′ X = ( γ ( s ) ′ , γ ( r ) ′ ) (cid:18) X ( s ) X ( r ) (cid:19) . ( 11 ) Lemma 6 . 1 . The coeﬃcients γ and ψ satisfy γ ( s ) = ( 0 , . . . , 0 ) ′ , γ ( r ) ′ ψ ( r ) = Zγ ( r ) = 0 and ψ ( r ) ∝ U . ( 12 ) Proof . Equation ( 12 ) follows because W is a linear combination of X uncorrelated with { X ( s ) , Z } , and thus uncorrelated with { X ( s ) } , and because Z is uncorrelated with W . The other results follow from these and the deﬁnition of Z in canonical form . (cid:3) Because the symmetry results of Theorem 5 . 1 for X orthogonal to Z imply that all W orthogonal to Z have the same distribution , we immediately have the following corollary to Theorem 5 . 1 . Corollary 6 . 1 . The quantities var ( W mt − W mc ) , E ( ν mt ( W ) ) , and E ( ν mc ( W ) ) take the same three values for all standardized Y . Analogous results hold for statistics in random subsamples indexed by rt and rc . In ad - dition , E ( ν mk ( W ) ) takes the same value for all W within each of the mixture components , k ∈ T or C . However , the corresponding expressions involving Z generally do depend on the choice of Y . Corollary 6 . 2 . ( a ) When E ( Z rt −Z rc ) 6 = 0 , the percent bias reduction in Y equals the percent bias reduction of Y in the subspace { X ( s ) , Z } , E ( Y mt − Y mc ) E ( Y rt − Y rc ) = E ( Z mt − Z mc ) E ( Z rt − Z rc ) . 12 D . B . RUBIN AND E . A . STUART ( b ) When E ( Z rt − Z rc ) = 0 , the denominators of both ratios in ( a ) equal 0 , and E ( Y mt − Y mc ) = ρE ( Z mt − Z mc ) . Proof . The proof parallels that of Corollary 4 . 1 because W = γ ′ ( r ) X ( r ) from the deﬁnition of W in ( 11 ) and Lemma 6 . 1 , and from Theorem 5 . 1 and Lemma 6 . 1 , γ ′ ( r ) E ( X ( r ) mt − X ( r ) mc ) = 0 . Thus , E ( W mt − W mc ) = 0 . (cid:3) Corollary 6 . 3 . The matching is ρ 2 proportionate modifying of the variance of the diﬀerence in matched sample means , var ( Y mt − Y mc ) var ( Y rt − Y rc ) = ρ 2 var ( Z mt − Z mc ) var ( Z rt − Z rc ) + ( 1 − ρ 2 ) var ( W mt − W mc ) var ( W rt − W rc ) , where the ratio var ( W mt − W mc ) / var ( W rt − W rc ) takes the same value for all Y . Proof . The proof is analogous to that of Corollary 4 . 2 using Theo - rem 5 . 1 and Lemma 6 . 1 , and parallels the proof of Corollary 4 . 3 in [ 16 ] , where , in that proof , there is a typographical error : Z mt − Z mc and W mt − W mc should be replaced by Z mt − Z mc and W mt − W mc , respectively . (cid:3) Corollary 6 . 4 . Within each mixture component , the matching is ρ 2 proportionate modifying of the expectation of the sample variances , E ( ν mk ( Y ) ) E ( ν rk ( Y ) ) = ρ 2 E ( ν mk ( Z ) ) E ( ν rk ( Z ) ) + ( 1 − ρ 2 ) E ( ν mk ( W ) ) E ( ν rk ( W ) ) for all k ∈ T or C , where the ratio E ( ν mk ( W ) ) / E ( ν rk ( W ) ) takes the same value for all Y within each mixture component . Proof . The proof of this corollary parallels that of Corollary 4 . 3 , with modiﬁcations similar to those in the proof of Corollary 6 . 3 . Again , as in Corollary 4 . 2 , this result generally holds only in each of the individual treated and control group components , and the analogous result in the overall sam - ples does not hold . (cid:3) 7 . Discussion . Here we have shown that most of the results proven by Rubin and Thomas [ 16 ] can be extended to discriminant mixtures of pro - portional ellipsoidally symmetric ( DMPES ) distributions , as deﬁned in Sec - tion 2 , and provides some theoretical rationale for why the earlier Rubin and Thomas [ 16 , 17 , 18 ] results hold well even when the assumption of el - lipsoidally symmetric distributions is not met . These results show that even with the more complicated setting of DMPES distributions , the eﬀects of matching on an arbitrary linear combination of the covariates can be sum - marized by its eﬀects along and orthogonal to the discriminant . MATCHING WITH DMPES DISTRIBUTIONS 13 Although the class of DMPES distributions is still restrictive , previous ex - perience has indicated that mathematically convenient conditions for match - ing can provide guidance in real - world examples . A classic example is in [ 2 ] on the bias reduction possible from stratiﬁed matching . Although Cochran’s results were proved assuming inﬁnite samples sizes and a linear relationship between a single covariate and the outcome , the approximations and their implied guidance have found applicability and use for a much wider range of situations . For a speciﬁc example here , the implications of our results were the basis for the applied diagnostics in [ 15 ] used to assess the quality of the matched samples of smokers and never smokers in the National Medical Expenditure Survey , based on decomposing the comparisons of the distribu - tions in the matched samples into components along and orthogonal to the discriminant . Acknowledgments . The authors would like to thank the previous and current Editors , anonymous referees and Neal Thomas for exceptionally helpful comments . This work was done while Elizabeth Stuart was a grad - uate student in the Department of Statistics , Harvard University . REFERENCES [ 1 ] Christakis , N . A . and Iwashyna , T . J . ( 2003 ) . The health impact of health care on families : A matched cohort study of hospice use by decedents and mortality outcomes in surviving , widowed spouses . Social Science and Medicine 57 465 – 475 . [ 2 ] Cochran , W . G . ( 1968 ) . The eﬀectiveness of adjustment by subclassiﬁcation in removing bias in observational studies . Biometrics 24 295 – 313 . MR0228136 [ 3 ] Cochran , W . G . and Rubin , D . B . ( 1973 ) . Controlling bias in observational studies : A review . Sankhy¯a Ser . A 35 417 – 446 . [ 4 ] Dehejia , R . H . and Wahba , S . ( 1999 ) . Causal eﬀects in nonexperimental studies : Re - evaluating the evaluation of training programs . J . Amer . Statist . Assoc . 94 1053 – 1062 . [ 5 ] Dempster , A . P . ( 1969 ) . Elements of Continuous Multivariate Analysis . Addison – Wesley , Reading , MA . [ 6 ] Efron , B . ( 1975 ) . The eﬃciency of logistic regression compared to normal discrimi - nant analysis . J . Amer . Statist . Assoc . 70 892 – 898 . MR0391403 [ 7 ] Gerfin , M . and Lechner , M . ( 2002 ) . A microeconometric evaluation of the active labour market policy in Switzerland . The Economic Journal 112 854 – 893 . [ 8 ] Hill , J . , Rubin , D . B . and Thomas , N . ( 2000 ) . The design of the New York School Choice Scholarship Program evaluation . In Research Design : Donald Campbell’s Legacy ( L . Bickman , ed . ) 155 – 180 . Sage , Thousand Oaks , CA . [ 9 ] Imai , K . ( 2005 ) . Do get - out - the - vote calls reduce turnout ? The importance of sta - tistical methods for ﬁeld experiments . American Political Science Review 99 283 – 300 . [ 10 ] Imbens , G . W . ( 2004 ) . Nonparametric estimation of average treatment eﬀects under exogeneity : A review . Rev . Econom . Statist . 86 4 – 29 . [ 11 ] Rosenbaum , P . R . ( 2002 ) . Observational Studies , 2nd ed . Springer , New York . MR1899138 14 D . B . RUBIN AND E . A . STUART [ 12 ] Rosenbaum , P . R . and Rubin , D . B . ( 1983 ) . The central role of the propensity score in observational studies for causal eﬀects . Biometrika 70 41 – 55 . MR0742974 [ 13 ] Rosenbaum , P . R . and Rubin , D . B . ( 1985 ) . Constructing a control group using multivariate matched sampling methods that incorporate the propensity score . Amer . Statist . 39 33 – 38 . [ 14 ] Rubin , D . B . ( 1976 ) . Multivariate matching methods that are equal percent bias reducing . I . Some examples . Biometrics 32 109 – 120 . MR0400555 [ 15 ] Rubin , D . B . ( 2001 ) . Using propensity scores to help design observational studies : Application to the tobacco litigation . Health Services and Outcomes Research Methodology 2 169 – 188 . [ 16 ] Rubin , D . B . and Thomas , N . ( 1992 ) . Aﬃnely invariant matching methods with ellipsoidal distributions . Ann . Statist . 20 1079 – 1093 . MR1165607 [ 17 ] Rubin , D . B . and Thomas , N . ( 1992 ) . Characterizing the eﬀect of matching using linear propensity score methods with normal distributions . Biometrika 79 797 – 809 . MR1209479 [ 18 ] Rubin , D . B . and Thomas , N . ( 1996 ) . Matching using estimated propensity scores : Relating theory to practice . Biometrics 52 249 – 264 . [ 19 ] Rubin , D . B . and Thomas , N . ( 2000 ) . Combining propensity score matching with additional adjustments for prognostic covariates . J . Amer . Statist . Assoc . 95 573 – 585 . [ 20 ] Smith , H . ( 1997 ) . Matching with multiple controls to estimate treatment eﬀects in observational studies . Sociological Methodology 27 325 – 353 . [ 21 ] Smith , J . and Todd , P . ( 2005 ) . Does matching overcome LaLonde’s critique of nonexperimental estimators ? J . Econometrics 125 305 – 353 . MR2143379 Department of Statistics Harvard University 1 Oxford St . Cambridge , Massachusetts 02138 USAE - mail : rubin @ stat . harvard . edu Johns Hopkins Bloomberg School of Public Health 624 N . Broadway , Room 804 Baltimore , Maryland 21205 USAE - mail : estuart @ jhsph . edu
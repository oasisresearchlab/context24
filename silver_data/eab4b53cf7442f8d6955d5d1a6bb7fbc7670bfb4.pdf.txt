Inferring high - resolution human mixing patterns for disease modeling Dina Mistry 1 , Maria Litvinova 2 , 3 , Ana Pastore y Piontti 2 , Matteo Chinazzi 2 , Laura Fumanelli 4 , Marcelo F . C . Gomes 5 , Syed A . Haque 2 , Quan - Hui Liu 6 , Kunpeng Mu 2 , Xinyue Xiong 2 , M . Elizabeth Halloran 7 , 8 , Ira M . Longini Jr . 9 , Stefano Merler 4 , Marco Ajelli † 4 , and Alessandro Vespignani † 2 , 3 1 Institute for Disease Modeling , Bellevue , WA , USA 2 Northeastern University , Boston , MA , USA 3 Institute for Scientiﬁc Interchange Foundation , Turin , Italy 4 Bruno Kessler Foundation , Trento , Italy 5 Funda¸c˜ao Oswaldo Cruz , Rio de Janeiro , Brazil 6 College of Computer Science , Sichuan University , Chengdu , Sichuan , China 7 Fred Hutchinson Cancer Research Center , Seattle , WA , USA 8 Department of Biostatistics , University of Washington , Seattle , WA , USA 9 Department of Biostatistics , College of Public Health and Health Professions , University of Florida , Gainesville , FL , USA March 4 , 2020 † To whom correspondence should be addressed . Abstract Mathematical and computational modeling approaches are increasingly used as quantitative tools in the analysis and forecasting of infectious disease epidemics . The growing need for realism in addressing complex public health questions is however calling for accurate models of the human contact patterns that govern the disease transmission processes . Here we present a data - driven approach to generate eﬀective descriptions of population - level contact patterns by using highly detailed macro ( census ) and micro ( survey ) data on key socio - demographic features . We produce age - stratiﬁed contact matrices for 277 sub - national administrative regions of countries covering approximately 3 . 5 billion people and reﬂecting the high degree of cultural and societal diversity of the focus countries . We use the derived contact matrices to model the spread of airborne infectious diseases and show that sub - national heterogeneities in human mixing patterns have a marked impact on epidemic indicators such as the reproduction number and overall attack rate of epidemics of the same etiology . The contact patterns derived here are made publicly available as a modeling tool to study the impact of socio - economic diﬀerences and demographic heterogeneities across populations on the epidemiology of infectious diseases . Keywords : Human mixing patterns — Computational modeling — Infectious diseases — Inﬂuenza 1 a r X i v : 2003 . 01214v1 [ q - b i o . P E ] 25 F e b 2020 Mathematical and computational models of infectious disease transmission are increasingly used to provide situational awareness and forecasts during epidemic outbreaks and quantitative answers to complex public health questions such as evaluating the eﬀectiveness of control strategies ( vaccination , school closure , etc . ) [ 1 ] . Modeling approaches have thus moved away from the classic homogeneous and stylized framework [ 2 , 3 ] , progressively incorporating heterogeneities that depend on between - and within - country population variability , disease time scale , transmission settings , as well as the speciﬁc pathogen characteristics . For instance , geographically structured models allow evaluation of spatially heterogeneous interventions in both animal and human diseases [ 4 , 5 ] , while individual - based models lay down the possibility of simulating all micro - details of the transmission process and tracking in time and space each individual of the simulated population [ 6 , 7 , 8 ] . These data - driven approaches have highlighted the importance of the social , demographic , and economic characteristics of the population in determining the actual mesh of contacts underlying disease spreading among individuals . For this reason a broad range of methodologies has been used to study human mixing patterns , including surveys [ 9 ] , contact diaries [ 10 , 11 , 12 , 13 , 14 , 15 , 16 ] , wearable sensors [ 17 , 18 ] , analysis of time - use data [ 19 ] , development of synthetic populations [ 20 , 21 , 22 ] , and mixed approaches [ 23 , 24 , 25 ] , although a general modeling framework is still lacking because contact patterns among individuals vary according to the geographical scale ( from census blocks to the national level ) , the disease under consideration , and the detailed socio - economic and demographic characteristics of the population . Here we present a data - driven approach to generate eﬀective descriptions of complex contact patterns that can be used to inform infectious disease modeling approaches , including the widely adopted compartmental modeling framework . We make use of highly detailed macro ( census ) and micro ( survey ) data from publicly available sources on key socio - demographic features ( e . g . , age structure , household composition and members’ age gaps , employment rates , school structure ) to construct synthetic populations of interacting agents , each one representing an hypothetical indi - vidual in the real population . The proposed method relies on both macro - and micro - level data for multiple socio - economic characteristics and can be adapted to diﬀerent geographical contexts and diseases ; something that is not possible in a “one - model - ﬁts - all” approach . We provide synthetic contact networks for nations around the world with substantially large and diverse populations . Speciﬁcally , we report contact patterns at the subnational level in the following countries : Australia , Canada , China , India , Israel , Japan , Russia , South Africa , and the United States of America . These populations account for 277 sub - national administrative regions ( such as states , provinces , prefectures , territories , etc . depending on the considered country ) , cover nearly 38 % of the world’s surface area , and account for approximately 3 . 5 billion people of the world’s 7 . 6 billion population . The resulting synthetic populations are used to derive a mesoscopic description of the human contact patterns by deﬁning age - stratiﬁed contact matrices for the most common social settings in which individuals spend their time interacting with each other ( i . e . , households , schools , workplaces , and the general community ) . The resulting contact matrices capture diﬀerences at the subnational level that reﬂect the high degree of cultural and societal diversity of the focus countries . To illustrate the importance of considering national and sub - national heterogeneities in the anal - ysis of infectious disease epidemiology , we construct the overall contact matrix relevant for airborne infectious diseases by calibrating the combination of setting - speciﬁc contact matrices using as ground truth seven diary - based contact matrices ( six European countries [ 11 ] and Russia [ 15 ] ) . The result - ing matrices are validated against out of sample contact data collected in France [ 26 ] , Japan [ 27 ] , and China [ 28 ] . These contact matrices are then used in the modeling of inﬂuenza transmission pat - terns at national and sub - national level . The inﬂuenza modeling simulations , although considering identical disease etiology , highlights considerable heterogeneities in reproduction number and attack rates across regions of the world reﬂecting diﬀerences in key demographic drivers such as average 2 Figure 1 : Modeling framework . Schematic representation of the workﬂow for modeling human mixing patterns and infection transmission dynamics . age and student population . As a service to the community , a database containing the inferred setting - speciﬁc matrices as well as the overall contact matrices for all locations ( and countries ) is available on the dedicated website : https : / / github . com / mobs - lab / mixing - patterns . Python codes to work with the contact matrices and examples of how to use them in age - structured compartmental models are available on the same website as well . This presented work can be easily generalized to other countries and settings , and arm the community with a general framework that can be used to make inference on important epidemiological parameters in the modeling of infectious diseases . Results We use a data - driven computational approach to infer the contact networks in the social settings where people interact and spend most of their time . In particular , we focus on four social settings ( household , school , workplace , and the general community ) , which are particularly relevant for inﬂuenza transmission [ 7 , 29 ] . To reconstruct the synthetic population in each context we use a wide variety of national and sub - national micro - level , census and demographic data that provide the guidelines not only on separate characteristics of the population , but also on the interconnection of multiple characteristics . Microlevel data extrapolated from socio - demographic surveys is especially useful as no assumptions on the rules of disaggregation are required ( the data is already on the required level of disaggregation ) . Contacts between individuals in the real - world populations are inferred by analysis of the gener - ated data - driven synthetic networks by measuring the frequency of links between individuals ( living , going to school , or working together ) in the synthetic contact networks of the diﬀerent social set - 3 Figure 2 : Age mixing patterns by setting . Each heatmap represents the average frequency of contact between an individual of a given age ( x - axis ) and all of their possible contacts ( y - axis ) . A Matrices of household contacts by age at the national level for China , the United States , and India . The six smaller panels in the center and on the left show household contact matrices at the subnational level in two provinces of China ( Beijing , Guizhou ) , two locations of the United States ( the state of New York and the District of Columbia ) , and two states of India ( Maharashtra , Meghalaya ) . B Matrices of school contacts by age at the national level ( from top to bottom : China , the United States , India ) . C Matrices of work contacts by age at the national level ( from top to bottom : China , the United States , India ) . tings . Then we compare summary statistics derived from the generated synthetic population for each geographical area to those reported in oﬃcial ( macro ) statistics ( e . g . , census data ) . Examples of the summary statistics used in the approach are the age structure of the population , distributions of household size , type , number of children by household size , and so on , depending on the sum - mary statistics available from oﬃcial sources . The generated data is compared to the distributions of summary statistics by using goodness of ﬁt tests at the desired level of signiﬁcance ( generally 5 % ) . We use a non - parametric bootstrap procedure to test the uncertainty level of our sampling . This procedure is iterated until a satisfactory ﬁt is reached . In the case of inadequate micro data ( e . g . , sub - optimal sample size ) , we use the available micro data to extrapolate rules on the age gaps between household members conditioned on the age of the household head , household size , and the 4 relation between the members ( e . g . , age gap between spouses , age gap between siblings ) . Note that the same arguments are extended to other settings ( e . g . , schools , workplaces , hospitals ) and can be extended to further stratiﬁcations relevant for other diseases ( e . g . , easy access to health care facilities ) . An illustration of the matrices construction workﬂow is reported in Fig . 1 , while the full technical description is reported in the Methods section and the Supplementary Material ( SM ) . Setting speciﬁc contact matrices We report here the results for populations of 277 sub - national administrative regions of Australia , Canada , China , India , Israel , Japan , Russia , South Africa , and the United States of America , characterizing contact patterns for about 3 . 5 billion individuals . We also include data at the national level for 26 European countries [ ] FUM12 . The inferred age - speciﬁc contact matrices reveal striking patterns , of which many are common to the diverse locations under study . Figure 2 shows the age mixing patterns F kij deﬁned as the per capita frequency of contact of an individual of age i with an individual of age j in setting k . Starting with the households setting in Fig . 2A , we observe that contacts between individuals can largely be characterized as that between couples living together , and parents and their children in the same household [ 11 , 20 ] . The increased frequency of contact between adults of similar ages along the main diagonal of the household contact matrix represents couples of similar ages living together , while the bands of high frequency above and below the main diagonal indicate contact between parents and children . While most locations share these overall features , the contact matrices show diﬀerent age - mixing patterns . For instance , in China ( Fig . 2A ) , the lower frequency of contact between children within households is the reﬂection of the country’s so - called “One - child policy” . The policy , enacted in 1979 , has resulted in over a generation of many Chinese youth growing up without siblings , and hence having less contact on average with other children in this setting . This is in stark contrast with the United States and India ( Fig . 2A ) , where the presence of multiple children born to a family results in an increased frequency of contact between this age group in the household matrix . The presence of multigenerational families in countries like India is also evident from the increased frequency of contact between all age groups , notably between the elderly ( 60 years and older ) and young children . Even within the same country , contact patterns may be markedly diﬀerent . Fig 2A shows the age - mixing patterns within households for two diﬀerent provinces of China : Beijing and Guizhou . While the household contact patterns in Beijing show a clear signal of the “One - child policy” , Guizhou shows the presence of multigenerational families , as well as an increased presence of multiple children living in the same household . This can be traced back to the fact that the Guizhou Province is characterized by a large frequency of minority groups and the “One - child policy” was less strictly applied for minorities . Fig 2B , C show the inferred contact matrices in the school and workplace settings for China , the United States , and India . In both settings , the age mixing patterns vary strongly , reﬂecting diﬀerences in the educational systems , and economic conditions unique to each location . For all locations in our study , the school setting consistently exhibits the highest frequencies of contact between children and young adults attending school together . Interaction with older adults in this setting reﬂects the contact students have with instructors and other staﬀ members in school . The variability of age mixing patterns between children in India ( Fig 2B ) also reﬂects the many diﬀerent kinds of schools that children can attend throughout the country and the diﬀerent age groups found in those schools . In the workplace environment most interaction takes place between individuals in the range of 20 to 65 years of age , with the age range depending on local retirement , employment regulations , and culture . For instance , in many parts of the world it is common for teenagers to be fully or partially employed ( see the work contact matrix for the US - Fig . 2C ) ; in India , census 5 Figure 3 : Comparison to out - of - sample survey matrices . A Density plots showing the cor - relation of survey - based contact matrices for three out of sample locations ( France , Japan , and the Shanghai Province of China ) and their respective synthetic contact matrices ( all normalized to sum to one ) . The points represent the actual values of the survey and synthetic contact matrices . The linear correlation between the elements of each survey matrix and the corresponding elements of the synthetic matrix is reported in terms of Pearson correlation coeﬃcient , whose values are reported in each plot . B Heatmaps representing the normalized survey matrices and the normalized overall synthetic matrices for France , Japan , and the Shanghai Province of China . records for employment list even children among the population of workers . Statistical validation of the contact matrices against summary statistics of a large set of socio - demographic indicators has been performed to validate our results ( see SM ) . 6 Human mixing patterns for inﬂuenza transmission The contact matrices obtained in each settings acquire epidemiological relevance when combined together to generate the eﬀective descriptions of human mixing patterns relevant to the spreading of a speciﬁc disease . Here we deﬁne the matrix of eﬀective contacts relevant to inﬂuenza transmission based on the relative contribution of the household , school , and workplace . In addition to these three social settings , we consider also the contribution of less structured causal encounters in the population [ 30 ] , by considering a community contact matrix that assumes individuals as potentially fully mixed [ 20 ] . To combine the diﬀerent matrices , we propose a weighted linear combination of the derived matrices for the four considered social settings , and compute the overall matrix of contacts between individuals of age i and individuals of age j , M ( whose elements are denoted as M ij ) , as a weighted linear combination of setting speciﬁc contact matrices : M ij = (cid:88) k ω k F kij where the element M ij represents the average number of contacts with individuals of age j for an individual of age i per day , and each ω k ≥ 0 is indicating the number of contacts in each setting k . Generally the ω k are unknown disease - speciﬁc weights accounting for the relative importance of the diﬀerent social settings in the transmission of a speciﬁc infectious disease . In the case of airborne infectious diseases we leverage data from diary - based survey contact matrices reported in [ 11 , 15 ] for Finland , Germany , Italy , Luxembourg , The Netherlands , the United Kingdom , and the Tomsk Oblast region of Russia . Namely we perform a multiple linear regression analysis to ﬁnd the values of ω k such that the resulting M ij best ﬁts the empirical data . Note that the empirical matrices derived in [ 11 , 15 ] describe the average number of contacts of age j for an individual of age i , and in the Methods section we show how ω k is related to average number of contacts < c > per individual . The regression yields 4 . 11 contacts ( standard error , SE 0 . 41 ) in the household setting , 11 . 41 contacts ( SE 0 . 27 ) in schools , 8 . 07 contacts ( SE 0 . 52 ) in workplaces , and 2 . 79 contacts ( SE 0 . 48 ) for the general community setting . It is worth remarking that this approach provides overall best matching ω k and that , in principle , some of the diﬀerence of social behavior of speciﬁc countries may not be captured by this approach . For this reason , as a validation of this calibration method , in Fig . 3A we report the correlation between the resulting synthetic matrices for France , Japan , and the Shanghai Province of China and the available empirical matrices for these additional locations [ 26 , 27 , 28 ] . We ﬁnd signiﬁcant ( p - value < 0 . 001 ) Pearson correlations of 0 . 92 , 0 . 9 , and 0 . 8 for France , Japan , and Shanghai Province , respectively . Moreover , we use the Canberra distance as a measure of the similarity between two contact matrices [ 20 ] ( see Methods section for the deﬁnition of the Canberra distance ) . We estimate the distance between the seven survey - based matrices used in the calibration phase and their respective synthetic matrices to be 0 . 21 on average ( range : 0 . 17 - 0 . 28 ) . ( Note that the resulting Canberra distance is normalized by the square of the number of elements of the contact matrix to account for the diﬀerent number of age groups considered by the diﬀerent diary - based contact surveys ) . When considering the three locations used as out - of - sample validation , we estimate a slightly larger average distance of 0 . 29 ( range : 0 . 21 - 0 . 37 ) , suggesting the adequacy of the employed methodology . Finally , Fig . 3B shows a visual comparison between the synthetic and survey matrices , which highlights that the synthetic contact matrices are able to capture the speciﬁc features of each location such as contact patterns at school and the relative intensity of the main diagonals . Figure 4A shows the synthetic overall contact matrices for China , the United States , and India at the country level . The contact matrices for all locations share many similarities : bands of increased contact along the main and oﬀ diagonals reﬂect the familiar household contact patterns , increased 7 Figure 4 : Overall contact matrices . Each heatmap represents the overall average number of contacts relevant for airborne infectious disease transmission by age at the national level for China , the United States , and India . contact between adults age 20 to approximately 65 years old account for the interactions between the population’s workforce , and the dominant contact patterns in the lower left of the contact matrices reﬂect the high number of interactions between school aged individuals . Depending on the age structure of the population the intensity of interactions occurring in the school setting can vary , however this feature consistently dominates the contact matrix for all locations in our study . To quantify the similarity between the overall contact matrices in diﬀerent locations , we use a hierarchical clustering algorithm based on the Canberra distance to identify clusters of locations ( dis ) similar to each other [ 20 ] . We ﬁnd that locations tend to cluster together by country ( Fig . 5A ) , indicating that overall the contact patterns within a single country are more similar to each other than to the patterns observed in other countries . Strikingly , though not surprisingly , locations within developed countries such as Australia , Canada , and the United States are similar to each other and are clustered together , while at the same time locations throughout India , South Africa , and the North Caucasus region of Russia also cluster together , indicating a similarity in patterns between locations in the developing and transition world . Interestingly , a few territories of Canada , Russia , and India are outliers , indicating that the contact patterns in these locations are diﬀerent from what is observed in all other locations ( including their respective countries ) . A more detailed discussion is reported in the SM . If we consider the US state of New York as reference and compute the distance from all other locations to it , a geographical pattern clearly emerges ( Fig . 5B ) . Indeed , the contact patterns in most states of the US , and the urbanized areas of Canada and Australia appear to be very closely related to the one inferred for New York . In contrast , most of India , South Africa , and of the territories in Canada , Russia , and Australia have contact patterns noticeably diﬀerent from those obtained for the state of New York . Epidemiological relevance To investigate the eﬀect of the contact matrices on the infection transmission dynamics , we develop an age - structured SIR model to describe inﬂuenza transmission dynamics . The SIR model describes the spread of inﬂuenza in terms of the transition of individuals between diﬀerent epidemiological compartments . Susceptible individuals ( i . e . , those at risk of acquiring the infection - S ) can become infectious ( i . e . , capable to transmit the infection - I ) after coming into contact with infectious 8 Figure 5 : Clustering of contact matrices . A Clustered matrix of the Canberra distance between subnational contact matrices and associated dendrogram using hierarchical clustering to organize subnational locations . Lighter colors indicate locations more similar to each other ( distance closer to 0 ) . B World map of the subnational level where colors represent the Canberra distance between each subnational location and the US state of New York ( used as a reference point ) . The gray color means that no data is available . Note that the country of Israel is treated at the national level , rather than the subnational level , due to both its relatively small population and area , and the resolution of data available for reconstruction . 9 Figure 6 : Epidemic impact . A Scatter plot of the attack rate and the reproduction number R 0 from an age - structured SIR model using the contact matrix for each subnational location . European countries are included . The black line shows the results of the classic homogeneous mixing SIR model ( no age groups ) B Scatter plot of attack rates and average age in each location . The black line represents the best ﬁtting linear model demonstrating a negative linear correlation between attack rates and average age of the population . C Scatter plot of attack rates and percentage of the population attending educational institutions in each location . The black line represents the best ﬁtting linear model . individuals . Subsequently infectious individuals recover from the infection and become removed ( R ) after a certain amount of time ( the infectious period ) . In an age structured implementation of the model , individuals are now identiﬁed also by their age , and the contact matrix is introduced to describe the number of contacts between susceptible individuals of age i and all of their possible infectious contacts of age j [ 2 , 10 ] ( see Sec . Methods for details ) . More speciﬁcally we considered a transmission model with identical disease parameters . The contact matrices are thus the only factor driving the diﬀerence in dynamics and attack rate ( total number of infected individuals ) of the simulated epidemic . Compared to the case of homogeneous mixing , where all individuals are assumed to be in con - tact with each other in equal proportions , the inclusion of the contact matrices in the epidemic model consistently yields a lower overall attack rate for all locations ( Fig . 6A ) . This diﬀerence is also reﬂected in the strong variability of the basic reproduction number R 0 , representing the num - ber of cases generated by a typical index case in a fully susceptible population , which depends on the spectral radius of the matrix M as well as population structure ( see SM ) . To provide further validation of the adequacy of the matrices in characterizing the speciﬁc dynamics of inﬂuenza trans - mission in the SM we report the simulations of the age - structured SIR model calibrated on real data from the H1N1 inﬂuenza pandemic in multiple locations . The model adequately reproduces the the age - speciﬁc seroprevalence proﬁles in Israel , Italy , Japan , the UK and the US [ 31 , 32 , 33 , 34 , 35 ] . To understand the underlying factors of the observed heterogeneities across geographical loca - tions , we use a linear regression model to compare the attack rates and various socio - demographic features of each location ( see SM ) . We identiﬁed two socio - demographic features that correlate strongly with the attack rate : the average age of the population ( Fig . 6B ) and the fraction of the population in the educational system including instructors ( Fig . 6C ) . Indeed , if we examine the at - tack rates by age and setting ( see SM ) , we observe that the greatest proportion of infections occur as a result of contact due to the school setting , and that attack rates in general are highest for school - 10 Figure 7 : Sub - national heterogeneity . A The black dots represent the estimated attack rates in each province of China by using the country - level contact matrix and the location - speciﬁc age structure of the population . Colored dots represent the estimated attack rates in each location by using both location - speciﬁc contact matrix and age structure of the population . The colored lines connect the two estimated values of attack rate for each location . The transmission rate is set such that R 0 = 1 . 5 when using the country - level matrix . Each map shows the percentage variation of the attack rate using the location - speciﬁc contact matrix with respect to using the national contact matrix as a proxy for the subnational contact patterns ( i . e . , ( AR c − AR l ) / AR c , where AR c is the attack rate estimated by using the country - level contact matrix , and AR l is that estimated by using the location - speciﬁc matrix ) . Colors towards astra in the color scale indicate an overestimation of the attack rate in the location when using the country - level contact matrix as a proxy for the subnational contact patterns . Conversely , colors towards grape in the color scale indicate an underestimation of the attack rate in the location when using the country - level matrix as a proxy for the subnational contact patterns . B Same as A , but for the United States . C Same as A , but for India . aged individuals . Going further , inspection of the incidence proﬁle by age ( see SM ) also clearly shows that individuals with high contact frequencies with others in the school setting are infected earlier in higher proportions . These results mirror well known inﬂuenza spreading trends / patterns observed in the real world [ 11 , 20 ] . The observed results are robust ( although with quantitative diﬀerences ) to changes in transmissibility patterns and susceptibility to infection by age ( see SM ) . Taken together , our results suggest that developing countries with younger populations , and thus more school - aged individuals , are likely to experience higher overall attack rates when compared to older , developed countries . We can also investigate how the attack rate and R 0 for each location would diﬀer if we only had 11 knowledge of the contact patterns at the national level . In this scenario , we use the country - level inﬂuenza transmission contact matrices in each location ( note that each location is still character - ized by its own speciﬁc age structure ) and compare the results with those obtained by using the location - speciﬁc contact matrices everything else kept identical for the disease transmission model ( Fig . 7A - C ) . By using the country - level matrix we observe a much lower variability than by using location - speciﬁc mixing patterns . Moreover , location - speciﬁc attack rates and R 0 show a nonlinear relation with the results obtained using country - level contact patterns . Interestingly , we can observe clear geographical trends in the percent diﬀerence in attack rate using location - speciﬁc contact pat - terns in comparison to the corresponding country - level ones . For instance in much of the western area of China where most of the nation’s ethnic minorities live , using the average matrix would lead to underestimating the ﬁnal impact of an epidemic , while we would overestimate it in the more tra - ditionally urbanized / industrialized areas in the north - east of the country , like Beijing , and Shanghai ( Fig . 7A ) . Conclusion We have presented a general framework for the synthetic generation of age - stratiﬁed mixing patterns in key social settings ( the household , school , workplace ) for the transmission of airborne infectious diseases . The contact patterns we derived are not directly measured via survey or other direct methods ( e . g . , wearable sensors ) . Rather , we infer these age - based relationships between individuals by measuring them in synthetic populations developed using a novel approach that combines macro and micro data available from public sources . While , this is a limitation as , in general , a direct measure is preferred with respect to a derived one , this approach allows us to : i ) be ﬂexible in the deﬁnition of eﬀective contacts and thus to adapt our methodology to study of diﬀerent infectious diseases which require alternative deﬁnitions of “eﬀective contact for transmission” ; and ii ) focus on broad arrays of countries for which a direct measure is not available , especially at the subnational scale . The use of age mixing patterns in age - structured epidemic models provides insight into the epi - demiology and dynamics of infectious diseases both within and between diﬀerent countries around the world , as we have shown for the case of inﬂuenza . Our approach allows the integration in model - ing approaches of contact patterns that vary according to the geographical scale ( from census blocks to the national level ) , the disease under consideration , and the detailed socio - economic and demo - graphic characteristics of the population . The use of data - driven heterogeneous mixing patterns , especially at the subnational level , opens up the door to potential applications in the more realistic modeling of the worldwide circulation of pathogens with epidemic / pandemic potential . The devel - oped contact matrices also allow the study of the impact on the epidemiology of infectious diseases of socio - economic disparities and demographic peculiarities ( e . g . , one - child policy ) . Eventually , by making all of the derived mixing patterns ( in the form of readily usable contact matrices by age ) publicly available , the presented results may beneﬁt the research community actively working on the development of infectious disease forecasting approaches and mathematical models in support of the public health decision - making processes . 12 Methods Development of the synthetic populations To construct synthetic populations in diﬀerent countries , we made use of a wide array of data sources ( see SM ) . These data provide distributions of key socio - demographic characteristics such as the age structure , household size , age of the head of the household , age gaps between household members , household composition , employment rates , the educational system and enrollment rates , etc . Dis - tributions such as these are typically available either as macro - level data from census databases and other governmental sources , or as micro - level data coming from surveys conducted on a sample of the population . Census databases routinely provide information at a broader scope such as the age structure of a population , or the fertility rates , however they often lack more detailed information related to the household composition and age relationships between household members . For this , we rely on micro - level surveys which collect data at the household and individual level and ask par - ticipants for information in regards to their health , household condition and composition , economic conditions , and more . The kind of data available also varies by country and even at the subnational level , thus necessitating the development of adaptive algorithms that can take in the available data and accommodate for variability in data organization to produce a faithful reconstruction of each population . With this in mind , the procedure implemented can be summarized as follows . The ﬁrst step in the reconstruction of a real - world population is the generation of households . In this process we use two types of multinomial sampling . The ﬁrst is based on the probability distri - bution M ( y ) of an independent socio - demographic characteristic y . For instance , such characteristic y can be the household size or composition , depending on the data available . The second type of multinomial sampling is based on the probability M ( x | y 1 = i 1 , y 2 = i 2 , . . . , y n = i n ) of characteristic x conditional on the value i of a previously determined variable ( s ) y . In this case x and y are assumed ( when supported by available data ) to have bivariate or multivariate joint distributions . Typically , the larger the number of joint distributions incorporated , the more precise the reconstruc - tion of the real - world population . The precision of such a reconstruction is however often limited by the scope of the data ( such as the survey sample size for each characteristic y ) and its availability . For example , of the multinomial joint distributions used here one is the distribution of the age of the head of the household by the size of the household and the household composition ( whether a couple , a single parent with children , siblings , multigenerational families , etc . ) . The bivariate joint distributions incorporated is considerably long and includes ( but is not limited to ) distributions of the age of household members by the age of the head of the household , the age gap between couples living together by the age of one in the pair , the mother’s age at child birth by the age of the child , the number of household members by their relation to the age of the household head ( such as a spouse , parent , child , grandchild , sibling , in - law , etc . ) by the age of the household head and the household composition . These joint distributions were either found in the macro data or estimated from the micro survey data . Characteristics of the resulting synthetic households are compared to the distributions of the summary statistics available from the macro - level data using a goodness of ﬁt test at the desired level of signiﬁcance ( generally 5 % ) . A similar procedure is used to assign those individuals to their respective schools and workplaces based on enrollment and employment records . These records detail the enrollment and employment rates by age , institutional sizes and their age structures , as well as the student - to - teacher ratios in the case of schools . A more detailed explanation of the construction of the synthetic population can be found in the SM together with the results of the comparison between the synthetic and actual population statistics . 13 Construction of age based contact matrices We use the synthetic contact networks to infer average age - based contact patterns within each social setting . For each location , these age - based contact patterns are encoded in a contact matrix F k , whose elements F kij describes the average frequency of contact between a given individual of age i and individuals of age j in setting k . We focus on 4 social settings : the households ( H ) , schools ( S ) , workplaces ( W ) , and the general community ( C ) . Speciﬁcally , here we adopt the frequency dependent ( mass action ) transmission model , with the implicit assumption that an increased popu - lation density has no eﬀect on the per capita contact rate between individuals [ 36 ] . This choice of modeling mechanism was already proved to represent a good approximation for the description of the transmission patterns of several infectious diseases [ 2 ] . Moreover , it allows us to readily compare epidemiological parameters between social settings and locations with disparate population density , and thus makes for an appropriate framework when modeling the transmission dynamics of hetero - geneous populations around the world . The calculation of the contact matrices can be described as follows . First , we compute the relative abundance of contacts between individuals of age i and individuals of age j in each instance s of setting k , Γ k ( s ) ij . Γ k ( s ) ij = φ k ( s ) i ( φ k ( s ) j − δ ij ) ν k ( s ) − 1 , where φ k ( s ) i is the number of individuals of age i in the instance s ( i . e . , a speciﬁc household , school , or workplace ) of setting k ; δ ij is the Kronecker delta function , which we use to omit the individual i from their own set of contacts ; ν k ( s ) is the number of individuals ( of all ages ) in instance s of setting k . Note that to compute Γ k ( s ) ij we assume homogeneous mixing within each instance of the setting , and as a result the matrix Γ k ( s ) ij has the expected symmetric property Γ k ( s ) ij = Γ k ( s ) ji . Second , we compute the per capita probability of contact of an individual of age i with an individual of age j in setting k as F kij . F kij = (cid:88) { s : ν k ( s ) > 1 } Γ k ( s ) ij / N i where N i is the total number of individuals of age i . Note that matrix F k ( i . e . , the matrix of elements F kij ) is not symmetric . Third , we combine the setting - speciﬁc contact matrices by age F k to derive a matrix of the overall contacts by age M . We propose a weighted linear combination of the derived matrices in the four focus settings , calibrated to match the empirically estimated contact matrices from two contact diary survey studies in 7 locations throughout Western Europe and Russia [ 11 , 15 ] . We perform a multiple linear regression to calibrate the weights of the synthetic setting contact matrices such that their linear combination matches the overall contact matrix for all 7 locations coming from the survey studies ( see SM for details and for a comparison between the empirical and synthetic contact matrices ) . Average number of contacts The average number of contacts < c > can be computed as < c > = 1 N (cid:88) i N i (cid:88) j M ij 14 where N = (cid:80) i N i is the total number of individuals in the population . Therefore , < c > = 1 N (cid:88) i N i (cid:88) j (cid:88) k ω k F kij = 1 N (cid:88) i N i (cid:88) j (cid:88) k ω k (cid:88) s Γ k ( s ) ij / N i = 1 N (cid:88) k ω k (cid:88) i (cid:88) j (cid:88) s N i Γ k ( s ) ij / N i = 1 N (cid:88) k ω k (cid:88) i (cid:88) j (cid:88) s Γ k ( s ) ij = (cid:88) k ω k (cid:88) s (cid:88) i (cid:88) j Γ k ( s ) ij / N = (cid:88) k ω k Z k / N where Z k is the number of individuals having at least one contact in setting k . Canberra distance To make side - by - side comparisons of the inferred contact matrices by age , we use the Canberra distance [ 20 ] . Speciﬁcally , each matrix is treated as a vector on which the Canberra distance is deﬁned as d ( x , y ) Canberra = (cid:88) i (cid:40) | x i − y i | | x i | + | y i | for x i , y i (cid:54) = 0 1 for x i , y i = 0 This yields a distance value of 0 for two locations with identical contact matrices , and increasingly larger distance values for two locations with increasingly diﬀerent contact matrices . Age structured disease transmission model For each location l the transmission dynamics of inﬂuenza are modeled through an age - structured SIR model , where the mixing patterns are deﬁned by the contact matrix previously introduced , M ij . The model is deﬁned by the following set of equations : ˙ S i = − λ i S i ˙ I i = λ i S i − γI i ˙ R i = γI i where S i is the number of susceptible individuals of age i , I i is the number of infected individuals of age i , R i is the number of recovered or removed individuals of age i ; γ − 1 is the infectious periods ( which corresponds to the generation time in the simple SIR model [ 37 , 38 ] ) , which is set to 2 . 6 days [ 39 ] ; and λ i represents the force of infection to which an individual of age i is exposed to other infected individuals and expressed as λ i = β (cid:88) j M ij I j N j 15 where β is the transmissibility of the infection , N i is the total number of individuals of age i , and M ij measures the average number of contacts for an individual of age i with all of their contacts of age j . The basic reproduction number R 0 , representing number of cases generated by a typical index case in a fully susceptible population , can be deﬁned for this model as R 0 = β γ ρ ( M ) where ρ ( M ) is the dominant eigenvalue of the matrix M [ 40 ] . Data Availability A database containing the inferred setting - speciﬁc matrices as well as the contact matrices for inﬂuenza transmission for all locations ( and countries ) is publicly available on the dedicated website : https : / / github . com / mobs - lab / mixing - patterns . Python routines to work with the contact matrices and examples of how to use them in age - structured compartmental models are also available . Acknowledgements APyP , MC , KM , XX , MEH , IML , and AV acknowledge funding from Models of Infectious Disease Agent Study , National Institute of General Medical Sciences Grant U54GM111274 . References [ 1 ] Van Kerkhove , M . D . & Ferguson , N . M . Epidemic and intervention modelling : a scientiﬁc rationale for policy decisions ? Lessons from the 2009 inﬂuenza pandemic . Bull World Health Organ 90 , 306 – 310 ( 2012 ) . [ 2 ] Anderson , R . M . & May , R . M . Infectious diseases of humans : dynamics and control ( Oxford University Press ; Oxford , UK , 1991 ) . [ 3 ] Metcalf , C . J . E . , Edmunds , W . J . & Lessler , J . Six challenges in modelling for public health policy . Epidemics 10 , 93 – 96 ( 2015 ) . [ 4 ] Keeling , M . , Woolhouse , M . , May , R . , Davies , G . & Grenfell , B . T . Modelling vaccination strategies against foot - and - mouth disease . Nature 421 , 136 – 142 ( 2003 ) . [ 5 ] Colizza , V . , Barrat , A . , Barthelemy , M . , Valleron , A . - J . & Vespignani , A . Modeling the world - wide spread of pandemic inﬂuenza : baseline case and containment interventions . PLoS Med 4 , e13 ( 2007 ) . [ 6 ] Longini , I . M . et al . Containing pandemic inﬂuenza at the source . Science 309 , 1083 – 1087 ( 2005 ) . [ 7 ] Ferguson , N . M . et al . Strategies for containing an emerging inﬂuenza pandemic in Southeast Asia . Nature 437 , 209 – 214 ( 2005 ) . [ 8 ] Merler , S . & Ajelli , M . The role of population heterogeneity and human mobility in the spread of pandemic inﬂuenza . Proc R Soc B 277 , 557 – 565 ( 2010 ) . 16 [ 9 ] Fenton , K . A . et al . Sexual behaviour in Britain : reported sexually transmitted infections and prevalent genital Chlamydia trachomatis infection . The Lancet 358 , 1851 – 1854 ( 2001 ) . [ 10 ] Wallinga , J . , Teunis , P . & Kretzschmar , M . Using data on social contacts to estimate age - speciﬁc transmission parameters for respiratory - spread infectious agents . Am J Epidemiol 164 , 936 – 944 ( 2006 ) . [ 11 ] Mossong , J . et al . Social contacts and mixing patterns relevant to the spread of infectious diseases . PLOS Med 5 , e74 ( 2008 ) . [ 12 ] Hens , N . et al . Mining social mixing patterns for infectious disease models based on a two - day population survey in Belgium . BMC Infect Dis 9 , 5 ( 2009 ) . [ 13 ] Horby , P . et al . Social contact patterns in Vietnam and implications for the control of infectious diseases . PLOS One 6 , e16965 ( 2011 ) . [ 14 ] Read , J . M . et al . Social mixing patterns in rural and urban areas of southern China . Proc R Soc B 281 , 20140268 ( 2014 ) . [ 15 ] Ajelli , M . & Litvinova , M . Estimating contact patterns relevant to the spread of infectious diseases in Russia . J Theor Biol 419 , 1 – 7 ( 2017 ) . [ 16 ] Melegaro , A . et al . Social Contact Structures and Time Use Patterns in the Manicaland Province of Zimbabwe . PLOS One 12 , e0170459 ( 2017 ) . [ 17 ] Cattuto , C . et al . Dynamics of person - to - person interactions from distributed RFID sensor networks . PLOS One 5 , e11596 ( 2010 ) . [ 18 ] Kiti , M . C . et al . Quantifying social contacts in a household setting of rural kenya using wearable proximity sensors . EPJ Data Sci 5 , 21 ( 2016 ) . [ 19 ] Zagheni , E . et al . Using time - use data to parameterize models for the spread of close - contact infectious diseases . Am J Epidemiol 168 , 1082 – 1090 ( 2008 ) . [ 20 ] Fumanelli , L . , Ajelli , M . , Manfredi , P . , Vespignani , A . & Merler , S . Inferring the structure of social contacts from demographic data in the analysis of infectious diseases spread . PLOS Comput Biol 8 , e1002673 ( 2012 ) . [ 21 ] Grefenstette , J . J . et al . FRED ( A Framework for Reconstructing Epidemic Dynamics ) : an open - source software system for modeling infectious diseases and control strategies using census - based populations . BMC Public Health 13 , 940 ( 2013 ) . [ 22 ] Gallagher , S . , Richardson , L . F . , Ventura , S . L . & Eddy , W . F . SPEW : Synthetic populations and ecosystems of the world . J Comput Graph Stat 27 , 773 – 784 ( 2018 ) . [ 23 ] Iozzi , F . et al . Little Italy : an agent - based approach to the estimation of contact patterns - ﬁtting predicted matrices to serological data . PLoS Comput Biol 6 , e1001021 ( 2010 ) . [ 24 ] Prem , K . , Cook , A . R . & Jit , M . Projecting social contact matrices in 152 countries using contact surveys and demographic data . PLOS Comput Biol 13 , e1005697 ( 2017 ) . [ 25 ] Litvinova , M . , Liu , Q . - H . , Kulikov , E . S . & Ajelli , M . Reactive school closure weakens the network of social interactions and reduces the spread of inﬂuenza . Proc Natl Acad Sci USA 116 , 13174 – 13181 ( 2019 ) . 17 [ 26 ] B´eraud , G . et al . The French connection : the ﬁrst large population - based contact survey in France relevant for the spread of infectious diseases . PloS One 10 , e0133203 ( 2015 ) . [ 27 ] Munasinghe , L . , Asai , Y . & Nishiura , H . Quantifying heterogeneous contact patterns in Japan : a social contact survey . Theor Biol Med Model 16 , 6 ( 2019 ) . [ 28 ] Zhang , J . et al . Patterns of human social contact and contact with animals in Shanghai , China . Sci Rep 9 , 1 – 11 ( 2019 ) . [ 29 ] Ajelli , M . , Poletti , P . , Melegaro , A . & Merler , S . The role of diﬀerent social contexts in shaping inﬂuenza transmission during the 2009 pandemic . Sci Rep 4 , 7218 ( 2014 ) . [ 30 ] Ajelli , M . & Merler , S . The impact of the unstructured contacts component in inﬂuenza pan - demic modeling . PLoS One 3 , e1519 ( 2008 ) . [ 31 ] Weil , M . et al . The dynamics of infection and the persistence of immunity to A ( H1N1 ) pdm09 virus in Israel . Inﬂuenza Other Respir Viruses 7 , 838 – 846 ( 2013 ) . [ 32 ] Merler , S . et al . Pandemic inﬂuenza A / H1N1pdm in Italy : age , risk and population suscepti - bility . PLOS One 8 , e74785 ( 2013 ) . [ 33 ] Japanese Infectious Disease Surveillance Center . Inﬂuenza antibody holding status survey in FY 2010 - First Report ( 2010 ) . Online ; accessed June 14 , 2018 . [ 34 ] Hardelid , P . et al . Assessment of baseline age - speciﬁc antibody prevalence and incidence of infection to novel inﬂuenza A / H1N1 2009 . Health Technol Assess 14 , 115 – 92 ( 2010 ) . [ 35 ] Reed , C . , Katz , J . M . , Hancock , K . , Balish , A . & Fry , A . M . Prevalence of seropositivity to pandemic inﬂuenza A / H1N1 virus in the United States following the 2009 pandemic . PLOS One 7 , e48187 ( 2012 ) . [ 36 ] Keeling , M . J . & Rohani , P . Modeling infectious diseases in humans and animals ( Princeton University Press , 2011 ) . [ 37 ] Wallinga , J . & Lipsitch , M . How generation intervals shape the relationship between growth rates and reproductive numbers . Proc R Soc B 274 , 599 – 604 ( 2006 ) . [ 38 ] Liu , Q . - H . et al . Measurability of the epidemic reproduction number in data - driven contact networks . Proc Natl Acad Sci USA 115 , 12680 – 12685 ( 2018 ) . [ 39 ] Vink , M . A . , Bootsma , M . C . J . & Wallinga , J . Serial intervals of respiratory infectious diseases : a systematic review and analysis . Am J Epidemiol 180 , 865 – 875 ( 2014 ) . [ 40 ] Diekmann , O . , Heesterbeek , J . A . P . & Metz , J . A . On the deﬁnition and the computation of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous populations . J Math Biol 28 , 365 – 382 ( 1990 ) . 18
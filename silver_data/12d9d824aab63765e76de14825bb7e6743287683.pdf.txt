Accurate Tight - Binding Hamiltonian Matrices from Ab - Initio Calculations : Minimal Basis Sets Luis A . Agapito , 1 , 2 Sohrab Ismail - Beigi , 3 Stefano Curtarolo , 4 , 5 Marco Fornari , 6 , 4 and Marco Buongiorno Nardelli 2 , 4 , ∗ 1 Department of Mechanical Engineering and Materials Science , Duke University , Durham , NC 27708 , USA 2 Department of Physics , University of North Texas , Denton , TX 76203 , USA 3 Department of Applied Physics and Center for Research on Interface Structures and Phenomena ( CRISP ) , Yale University , New Haven , CT 06511 , USA 4 Center for Materials Genomics , Duke University , Durham , NC 27708 , USA 5 Materials Science , Electrical Engineering , Physics and Chemistry , Duke University , Durham , NC 27708 , USA 6 Department of Physics , Central Michigan University , Mt . Pleasant , MI 48859 ( Dated : October 20 , 2015 ) Projection of Bloch states obtained from quantum - mechanical calculations onto atomic orbitals is the fastest scheme to construct ab - initio tight - binding Hamiltonian matrices . However , the presence of spurious states and unphysical hybridizations of the tight - binding eigenstates has hindered the applicability of this construction . Here we demonstrate that those spurious eﬀects are due to the inclusion of Bloch states with low projectability . The mechanism for the formation of those eﬀects is derived analytically . We present an improved scheme for the removal of the spurious states which results in an eﬃcient scheme for the construction of highly accurate ab - initio tight - binding Hamiltonians . I . INTRODUCTION The tight - binding method , even in its simplest imple - mentation , is a useful tool in the study of the electronic structure of molecules and solids . 1 , 2 The advantage of the method is the tractable and intuitive understanding it af - fords by distilling the electronic structure of complex sys - tems into physically transparent Hamiltonian matrices ex - pressed on a minimal basis set of atomic orbitals ( AO ) . For realistic materials , the tight - binding ( TB ) matrix elements have been typically calculated by ﬁtting to experiments or higher levels of theory . The resulting models were success - fully applied in a panoply of complex materials with large supercells 3 – 5 and for problems where a localized basis sets are essential . 6 A major shortcoming of the tight - binding approach is the demanding ﬁtting procedure that limits the application of the approach to well known materials and hinders the transferability of the parameters to bond - ing environments outside the assumed training set . In recent years , the accuracy and reliability of the TB models have been largely improved with the introduction of ab - initio tight - binding Hamiltonians . Here , the Hamil - tonian resulting from a fully self - consistent quantum - mechanical calculation either within Density functional Theory ( DFT ) or other ﬁrst principles approaches , gets mapped into a much smaller space spanned by a set of atomic or atomic - like ( i . e . Wannier functions ) orbitals . The representation of the electronic structure of the ma - terials on a minimal TB basis set has been obtained with two main approaches : ( i ) The “downfolding” of the ab - initio electronic structure ( solved in the large basis ) into a model containing only a few bands of interest which are disentangled from the rest ; ( ii ) the explicit calculation of the matrix elements ¯ H αβ = (cid:104) φ α | ˆ H | φ β (cid:105) using predeter - mined and ﬁxed localized functions , typically AOs . In the ﬁrst approach , one proceeds by selecting a sub - space B ( spanned by N Bloch states | ψ n (cid:105) of interest ) of the K - dimensional space of the solutions of the orig - inal quantum mechanical problem . The latter is found by representing and diagonalizing the Hamiltonian ˆ H of the system using a very high - quality basis set of size K , e . g . plane - waves with a large cut - oﬀ , a dense spatial grid , a large number of atomic - orbital - like Gaussian functions , etc . The subspace B is then projected onto a space A gen - erated by the atomic - like orbital functions , | φ α (cid:105) where α = 1 , . . . , M . Typically , the dimension of the B sub - space , N is much smaller of K , while the number of atomic orbitals is M ≥ N and is deﬁned by the choice of the local - ized basis set in A . Typically , in order to obtain a faithful representation of the electronic properties of the system in the smaller basis , the basis functions need to be iteratively optimized , thus adding a substantial computational eﬀort . Implementations of this approach include : muﬃn - tin or - bitals of arbitrary order ( N MTO ) 7 , maximally - localized Wannier functions ( MLWF ) 8 , quasi - minimal basis orbitals ( QUAMBO ) 9 , etc . While the optimized functions can be used to compute the TB matrix elements , their primary advantage is exploiting the information they contain to study the physics of the handpicked bands . For example , they can be used in mapping correlated bands into Hub - bard models . 10 Implementations of the second approach 11 have used the non - self - consistent Harris - Foulkes 12 , 13 func - tional for ˆ H with the input charge density taken from the converged large - basis ab - initio calculation . The compu - tational bottleneck in this approach is the calculation of multi - center integrals ( three - center and up ) for the func - tional . This approach can be readily extended to ﬁnd the charge density self - consistently , thus , allowing eﬃcient im - plementations of order - N ab - initio DFT codes . 14 , 15 In this work we follow the principles outlined above but without resorting to an explicit basis set optimization . Us - ing the eigenstates | ψ n (cid:105) of ˆ H with n = 1 , . . . , N , one can a r X i v : 150 9 . 02558v2 [ c ond - m a t . m t r l - s c i ] 19 O c t 2015 2 always write ¯ H αβ = (cid:104) φ α | ˆ H | φ β (cid:105) ≈ N (cid:88) n = 1 (cid:104) φ α | ψ n (cid:105) E n (cid:104) ψ n | φ β (cid:105) . Here the ≈ sign is introduced because we restrict the sum to N elements ( the subspace B ) instead of K ( the “com - plete” basis within the limits of convergence ) . Deﬁning the matrix of overlaps B αn = (cid:104) φ α | ψ n (cid:105) and the diagonal matrix E = diag ( E 1 , E 2 , . . . , E N ) , the TB Hamiltonian matrix , ¯ H , is expressed as ¯ H = BEB † , ( 1 ) where B is a rectangular M × N matrix . In this way , the computation of the TB matrix reduces to a straightfor - ward matrix operation which does not require any special iterative procedure as needed by some of the methods dis - cussed above in ( i ) . This construction takes advantage of the full knowledge of the eigenenergies and eigenfunc - tions obtained in the large - basis calculation , in contrast to using the charge density only as in ( ii ) . This scheme , also known as direct projection , has been tried in the past but was considered unreliable : even though it yielded an overall resemblance to the large - basis band structure , it in - troduces spurious states “randomly” scattered across the energy spectrum and unphysical hybridizations . See for instance the band structures in Fig . 5b as well as Ref . 8 ( Figs . 5 and 7 , see also Ref . 16 ) 17 and Figs . 1 , 2 , 4 in Ref . 18 . We have previously shown that accurate TB Hamil - tonians can be straightforwardly obtained from Eq . 1 if only Bloch states | ψ n (cid:105) that project well on the selected AO basis set ( high projectability > 95 % ) are included in the subspace B , i . e . , ﬁltering . This process introduces a null space , which is shifted outside the energy window of interest . 18 In this work we present a generalized scheme for the construction of TB Hamiltonians in a minimal ba - sis set , suitable for cases when states with moderately high projectability ( (cid:38) 85 % ) are needed to be included . The new scheme further enhances the accuracy of the TB Hamiltonian and has the added advantage of making the TB eigenvalues insensitive to the shifting operation . Furthermore , we use perturbation theory to analytically demonstrate that the spurious states and unphysical hy - bridizations previously observed in the direct projection scheme are due to the presence of low projectability states . II . METHODOLOGY In our work we use plane - waves ( PW ) as the large ba - sis for the ab - initio calculation of the Bloch states | ψ n (cid:105) . The wave vector k index is suppressed so the analysis for a periodic system can be understood to be at a particu - lar k point . We choose dim ( A ) = M atomic - like localized orbitals | φ α (cid:105) ( with M ≥ N = dim ( B ) ) which we assume to be an orthonormal set (cid:104) φ α | φ β (cid:105) = δ αβ . These could be Wannier functions or , more pragmatically , L¨owdin or - bitals . The restriction to this subspace is obtained through the projector operator ˆ P = (cid:80) α | φ α (cid:105)(cid:104) φ α | that is hermitian and idempotent . Let us consider a set of column vectors { | B n (cid:105) } obtained from direct projection of each Bloch wave | ψ n (cid:105) of the B subspace onto the chosen orthonormal atomic orbitals , ˆ P | ψ n (cid:105) = (cid:80) α B αn | φ α (cid:105) . The elements of the vector | B n (cid:105) are the projection coeﬃcients B αn = (cid:104) φ α | ψ n (cid:105) . The ex - plicit expression for the computation of these coeﬃcients is given in Eq . A8 . The projector ˆ P is represented as P B = B † B , a N × N matrix with entries ( B † B ) nm = (cid:104) ψ n | ˆ P | ψ m (cid:105) . The diagonal elements are the “projectabilities” , deﬁned as p n ≡ ( B † B ) nn = (cid:104) B n | B n (cid:105) = (cid:104) ψ n | ˆ P | ψ n (cid:105) , that measure to what extend the eigenstate ψ n is well - described in the space A speciﬁed by the projector ˆ P . While by construction tr ( ˆ P ) = M , the trace of the ma - trix P B in B becomes tr ( P B ) = N (cid:88) n = 1 (cid:104) ψ n | ˆ P | ψ n (cid:105) ≤ N ≤ M . If A is complete , all ψ n states project perfectly ( p n = 1 ) and the trace equals N , the size of B . The deviation from N is a criteria to assess the accuracy of the TB represen - tation in A with respect to the electronic structure in the B subspace . High projectabilities are expected for the states in the lowest bands and poor projectabilities at higher energies . One would expect to obtain accurate TB eigenvalues and eigenvectors for the states with the largest p n ≈ 1 ; how - ever , as proved in Sec . III states with low projectability , when folded in the TB Hamiltonian , hinder the accuracy of the results . In order to represent well the electronic structure of the system one needs to exclude from B the “bad” states with low projectability by choosing N accordingly ( p n larger than a chosen threshold for each n = 1 , . . . , N ) . The procedure involves the construction of the tight - binding Hamiltonian following Eq . 1 with a normalized set of col - umn vectors | A n (cid:105) = | B n (cid:105) / √ p n such that (cid:104) A n | A n (cid:105) = 1 . These states are used to build the initial TB Hamilto - nian : ¯ H = AEA † , ( 2 ) where the N columns of the matrix A are the vectors | A n (cid:105) . This product is an M × M matrix constructed using only N states . Because of this construction , ¯ H is singular with an unphysical null space , N , of size M − N that com - promises the accuracy of the eigenvalues ( see Sec . III ) . In order to remove the eﬀect of the null space we perform an 3 orthogonal projection ( see Ref . 19 ) using the set of vectors { | A n (cid:105) } Q N = I M − A ( A † A ) − 1 A † , ( 3 ) where I M is the M × M identity matrix . Reconstructing the TB Hamiltonian as ¯ H κ = ¯ H + κQ N , ( 4 ) is possible to shift the eigenenergies corresponding to the null space elements to an arbitrary energy κ , away from the band with good projectability . In practice , if only very high - projectability states are considered , A † A is close to the identity , and the shifting matrix can be approximated by Q N ≈ I M − AA † , avoiding the matrix inversion . This approximation introduces a small κ dependence into the states of the TB subspace . This dependence can be safely neglected when using a very high - projectability ﬁltering criteria ( e . g . p n > 0 . 95 in Ref . 18 ) or applying only small values of κ , otherwise the exact expression in Eq . 3 is required for a faithful description of the energy bands . III . THE EFFECT OF LOW PROJECTABILITY STATES IN THE TB HAMILTONIAN Minimal basis set have proved satisfactory to achieve accurate TB matrices for periodic systems using the ﬁl - tering procedure . However , if more unoccupied bands of high projectability are needed for a particular application , one can achieve that by progressively increasing the size of the AO basis set , e . g . from single zeta ( SZ ) ( minimal ) to double zeta ( DZ ) , etc . eﬀectively increasing the size of ¯ H κ . 20 Nonetheless , for most cases it is more advantageous to trade - oﬀ some accuracy away from the Fermi energy for the convenience of still dealing with TB matrices of smaller sizes , i . e . to keep the basis minimal , especially in the study of systems with large number of atoms . This can be achieved by including bands with moderately high projectability ( p n (cid:38) 0 . 85 ) in the construction of the TB matrix . However , as we discussed in Sec . II , bands with low projectability aﬀect the accuracy of the TB represen - tation in A . To learn about the eigenvalues of ¯ H κ , we start by ap - plying it to A . One gets ¯ H κ A = ¯ HA + κQ N A = ¯ HA = AEP , where P = A † A . To ﬁnd an analytical expression for the eigenvalues of ¯ H κ , we assume the number of states ψ n to be equal to the number of AOs ( N = M ) , so that A is square and invertible . 21 Then , the expression above , ¯ H κ A = A ( EP ) , has a M × M square matrix EP which is the representation of ¯ H in some linearly independent basis ( columns of A ) and its eigenvalues are also those of ¯ H k ( and ¯ H ) that we call ¯ E . EP , with the diagonal pulled out as a perturbation is then : EP = diag ( P 11 E 1 , . . . , P MM E M ) +   0 P 12 E 1 P 13 E 1 . . . P 21 E 2 0 P 23 E 2 . . . P 31 E 3 P 32 E 3 0 . . . . . . . . . . . . P M − 1 , M E M − 1 P M , M − 1 E M 0   . First of all , if any p n = 1 , then that column and row of the perturbation are zero . The diagonal element is decou - pled from the rest of the matrix so one eigenvalue will be exactly ¯ E n = E n . In other words , a perfect representation of the exact wavefunction means the basis is complete for that state and that the action of ˆ H in that basis will be perfectly described . Second , if one ignores the oﬀ diagonal entries , it can be seen that the eigenvalues of ¯ H κ would be scaled versions of ˆ H where each eigenvalue is being scaled by its pro - jectability so the energies of ¯ H κ would be ¯ E n ≈ P nn E n . Therefore , bad projectability will incorrectly deliver a TB eigenvalue close to zero . This has been the source of much trouble in previous TB methods without ﬁltering . Third , the oﬀ - diagonal elements of the perturbation ma - trix lead to hybridization . Namely , the lack of perfect projectability leads to level repulsion and further changes of the TB eigenvalues , beyond the scaling by P nn men - tioned above . The perturbation matrix is small , since ( i ) the oﬀ - diagonal elements of P are negligible for all states with high projectability ; and ( ii ) they are still consider - ably small for the states with lower projectability ( See Appendix C ) . Second order perturbation theory on the oﬀ - diagonal elements gives the analytical expression for the n - th eigenvalue of ¯ H , which is called ¯ E n , changing from P nn E n to ¯ E n = P nn E n + (cid:88) j (cid:54) = n | P jn | 2 E n E j P nn E n − P jj E j + O ( P 3 ) . ( 5 ) In addition to showing that the hybridization changes the energies , the formula shows that the changes due to hy - bridization can be much larger than one would naively ex - pect based only on looking at the small P jn entries : ﬁrst the numerator has an additional E j energy factor , and sec - ond , the energy diﬀerence in the denominator is based on the scaled energies which means the energy diﬀerence can be smaller than between the actual eigenvalues ( especially when both P nn and P jj are signiﬁcantly smaller than one ) thus enhancing the contribution of the hybridization . IV . RESULTS AND DISCUSSION Here we illustrate the eﬀects of low - projectability bands on the accuracy of the TB matrices derived for a molec - ular system , benzene , and a crystal , cobalt antimonide . 4 The ab - initio calculations were performed with plane - wave DFT codes : vasp 22 and / or quantum espresso . 23 A . Benzene In the case of benzene we computed the electronic structure using vasp within the projector - augmented - wave ( PAW ) method 24 and the Perdew - Burke - Ernzerhof ( PBE ) 25 functional . We determined the molecular wave - functions ψ n ( molecular orbitals ) of an isolated benzene molecule in a large cubic supercell of 15 ˚A side using Γ - point to sample the reciprocal space and a kinetic - energy cutoﬀ of 29 . 4 Ry . The detailed procedure to compute the projection coef - ﬁcients , B αn , is discussed in Appendix A . The states ψ n are projected onto a minimal basis set of M = 30 AOs ( C : 2 s , 2 p ; and H : 1 s ) taken from public repositories . 26 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8 0 . 9 1 . 0 22 17 11 FIG . 1 . ( Color online ) Projector matrix | P B | of benzene on a minimal AO basis set for the 23 molecular orbitals of lowest energy . The diagonal elements are the projectability numbers p n . The presence of non - zero oﬀ - diagonal elements (cid:104) B m | B n (cid:105) ( m (cid:54) = n ) reﬂects the non - orthonormality of the vectors | B n (cid:105) . The diagonal elements of the projector matrix P B = B † B shown Fig . 1 are the projectability numbers p n for each Bloch state ψ n . In the chosen AO basis set , the 17 Bloch states of lowest energy have high projectability ( p n > 0 . 88 ) whereas states 18 ≤ n ≤ 20 have low pro - jectability ( 0 . 20 < p n < 0 . 32 ) . Moreover , higher - energy states ( 21 ≤ n ≤ 23 ) are not projectable in this particu - lar AO set ( p n = 0 . 1 , 0 . 005 , 0 . 076 , respectively . ) As dis - cussed above , an accurate TB Hamiltonian matrix can be constructed by ﬁltering out states with low projectabil - ity . Therefore , considering only the lowest N = 17 states ( p n > 0 . 88 ) yields TB eigenenergies that are in excellent agreement with the DFT values . The black dots in Fig . 2a for N = 17 show a maximum deviation from the DFT en - ergies ( gray lines ) of only 5 meV . In order to study the eﬀect of states with lower pro - 17 18 19 20 21 22 23 N − 10 − 8 − 6 − 4 − 2 0 2 4 E n e r gy - E F ( e V ) n = 4 , 5 6 7 8 9 , 10 11 12 , 13 14 , 15 16 , 17 18 23 ( a ) ( b ) ( c ) 18 19 20 21 22 23 0 . 0 0 . 4 0 . 8 1 . 2 N = 18 N = 19 N = 20 0 1020 ¯ E n − ¯ E ∗ n ( m e V ) N = 21 N = 22 2 4 6 8 10 12 14 16 TB state n N = 23 FIG . 2 . ( Color online ) ( a ) Evolution of the tight - binding eigenvalues with increasing number of low - projectability Bloch states . N is the number of states used in the construction of the TB matrix , where the ﬁrst 17 states are those of high pro - jectability . In all case , the null states ( not seen ) are shifted by κ = 8 eV . ( b ) Zoom - in around the low - projectability TB eigen - values . The red dots mark the TB eigenenergy corresponding to the 18th Bloch state . ( c ) Energy variation of each TB state n against increasing N . The reference energy ¯ E ∗ n corresponds to the Hamiltonian without low - projectability states ( N = 17 ) . jectability on the accuracy of the TB eigenenergies , we intentionally relax the ﬁltering criterion to progressively include some states with lower projectability ( N > 17 ) in the B subspace . The vectors | A n (cid:105) corresponding to the low - projectability states are left unnormalized , i . e . , | A n (cid:105) = (cid:40) | B n (cid:105) / √ p n , if p n ≥ 0 . 85 | B n (cid:105) otherwise , ( 6 ) The normalization of the high - projectability vectors | A n (cid:105) artiﬁcially makes the corresponding diagonal elements ( P B ) nn = p n ( ≈ 1 ) equal to 1 , but this small change does not alter the analysis that follows . Expectedly , the TB eigenenergies ¯ E n corresponding to low - projectability states largely underestimate the DFT values E n . Those TB energies are seen in the zoom - in box in Figs . 2a and b . The inclusion of the lower projectability state n = 18 , for instance , yields the “bad” TB eigenvalue ¯ E 18 = 0 . 9732 eV . The large underestimation with respect to E 18 , seen in 5 Fig . 2 , is accounted by directly scaling the DFT values by the projectability , i . e . P 18 , 18 E 18 = 0 . 9903 eV , as discussed before . The evolution of ¯ E 18 with increasing N is shown in Fig . 2b using red dots for visual aid . Including the degenerate states n = 19 , 20 also yields strongly underestimated values ¯ E 19 = ¯ E 20 = 0 . 7621 eV and in agreement with P 19 , 19 E 19 = 0 . 7877 eV . Moreover , including the states 21 ≤ n ≤ 23 , which have even smaller projectabilities , yields TB eigenvalues close to zero : 0 . 0 , 0 . 0 , 0 . 2949 eV , respectively . Ex - cept for ¯ E 21 , these values compare well to P nn E n = 0 . 3984 , 0 . 0218 , 0 . 3117 eV , respectively . The departure of ¯ E 21 from P 21 , 21 E 21 is due to hybridization eﬀects discussed later in the text . As hinted by Eq . 5 , a state | A n (cid:105) hybridizes with an - other states | A j (cid:105) via a non - zero oﬀ - diagonal element of P nj = (cid:104) A n | A j (cid:105) . The two diagonal blocks , of size 17 × 17 and 6 × 6 , seen in Fig . 1 , correspond to high and low pro - jectability states . The 17 × 6 and 6 × 17 oﬀ - diagonal blocks allow hybridizations between both types of states . Since all elements in the oﬀ - diagonal blocks are small ( ≤ 0 . 0729 eV ) , the low - projectability states are expected to have only a small impact on the high projectability ones . This is conﬁrmed by inspecting the variations of the “good” TB eigenenergies ( ¯ E n , n = 1 – 17 ) while increasing the size N of the subspace B . The variations are small and not notice - able in Fig . 2a . Instead , we plot the TB energies relative to reference values ¯ E ∗ n in Fig . 2c . ¯ E ∗ n are the TB eigenen - ergies when N = 17 , that is , the high - projectability case . The maximum variation found is 21 . 8 meV and happens for ¯ E 11 in the ﬁfth panel ( once state n = 22 is included ) . This is consistent with the maximum element of the oﬀ - diagonal block happening at | P 11 , 22 | = 0 . 0714 . We ﬁnd that P 11 , 22 is the only non - zero oﬀ - diagonal element in the 11th row ( and column ) of the projector matrix , the energy variation can be directly attributed to the overlap between | A 11 (cid:105) and | A 22 (cid:105) following the hybridization mech - anism depicted by the yellow circles and arrows in Fig . 1 . The variation is well estimated by the second - order per - turbation model , Eq . 5 , which reduces to : ∆ ¯ E 11 ≈ | P 11 , 22 | 2 E 11 E 22 P 11 , 11 E 11 − P 22 , 22 E 22 = 21 . 7 meV . All hybridizations due to the oﬀ - diagonal elements in Fig . 1 ( or similarly , of the matrix P ) translate into peaks in Fig . 2c . The number of peaks in each panel increases as more low - projectability states are progressively included . Every new peak n that appears in a particular panel N reﬂects the hybridization between a low - projectability state—the one newly introduced in panel N —and the “good” TB eigenstate n . Each new peak can be directly traced to a non - zero oﬀ - diagonal element in Fig . 1 . For instance , the peaks at n = 1 , 6 in panel N = 18 are due to P 1 , 18 , P 6 , 18 ; peaks n = 3 , 10 in panel N = 19 to P 3 , 19 , P 10 , 19 ; etc . The elements of the oﬀ - diagonal blocks yield only small ﬂuctuations ; however , the overall maximum oﬀ - diagonal element | P 18 , 21 | = 0 . 1757 is inside the smaller 6 × 6 di - agonal block . This indicates that hybridizations between the low - projectability states | A 18 (cid:105) and | A 21 (cid:105) are stronger . Hybridization causes the level repulsion of ¯ E 18 ( red dot ) along the upward arrow observed in Fig . 2b at the in - troduction of n = 21 . The repulsion shifts up the level by 0 . 3953 eV from P 18 , 18 E 18 , which is the value expected in the absence of hybridization , marked by the red cross . The leading hybridization mechanism is depicted using green circles and lines in Fig . 1 . The perturbative estimate of the level repulsion is ∆ ¯ E 18 ≈ | P 18 , 21 | 2 E 18 E 21 P 18 , 18 E 18 − P 21 , 21 E 21 = 0 . 6656 eV . ¯ E 21 has the opposite level repulsion ∆ ¯ E 21 = − ∆ ¯ E 18 ( downward arrow ) , which explains the discrepancy between the value in the absence of hybridization P 21 , 21 E 21 = 0 . 3984 eV ( black cross ) and the actual TB energy ¯ E 21 ≈ 0 eV discussed earlier . − 10 − 8 − 6 − 4 − 2 0 2 4 E ne r g y - E F ( e V ) N = 17 ( a ) 0 5 κ ( eV ) N = 18 N = 19 N = 17 ( b ) 0 5 κ ( eV ) N = 18 n = 4 , 5 6 78 9 , 10 11 12 , 13 14 , 15 16 , 17 18 23 N = 19 FIG . 3 . ( Color online ) Behavior of the null and low - projectability TB eigenstates under the shifting operation using ( a ) the exact Q N = I M − A ( A † A ) − 1 A † or ( b ) the approxi - mated Q N ≈ I M − AA † shifting matrix . The construction in Eq . 2 introduces a null space N containing ( M − N ) degenerate eigenenergies ¯ E N = 0 eV . The matrix Q N = I M − A ( A † A ) − 1 A † is used to selectively move the null subspace upwards in energy by the control 6 parameter κ , without aﬀecting the remaining TB energies . With the exact Q N the TB values do not acquire a depen - dence on κ . The evolution of the TB eigenvalues with κ in Fig . 3a readily shows that only the degenerate null eigenenergies have a dependence on κ ( marked with solid black lines ) . The low - projectability TB states ( dots about 0 . 85 eV in panels N = 18 and N = 19 ) do not belong to the null space and therefore are also independent of κ . As ar - gued in Sec . II , the shifting matrix can be approximated by Q N ≈ I M − AA † , which avoids a matrix inversion , but at the cost of introducing a small κ dependence to the good TB values . The approximation is safe when using a high - projectability ﬁltering criterion ( N = 17 ) . In this case both the exact ( ﬁrst panel in Fig . 3 ( a ) ) and the approximated Q N ( ﬁrst panel in Fig . 3 ( b ) ) yield the same TB eigenval - ues . Nonetheless , the energy deviation due to the κ de - pendence introduced by the approximated Q N can become signiﬁcant when low - projectability Bloch states are intro - duced , for instance , compare the second ( and third ) panels in Figs . 3 ( a ) and 3 ( b ) . With the exact Q N ( Fig . 3 ( a ) ) the low - projectability TB eigenvalues around 0 . 85 eV remain ﬂat whereas they acquire a chieﬂy linear κ dependence ( marked with blue lines ) when using the approximated Q N ( Fig . 3 ( b ) ) . 30 35 40 45 50 55 n 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 p n 0 . 00 0 . 25 0 . 50 0 . 75 1 . 00 1 : Co y t ili b a t ce j o r P etats hcolB ( a ) ( b ) 58 44 55 FIG . 4 . ( Color online ) ( a ) Minimum projectability p n per band n over all k points for CoSb 3 on the chosen minimal basis set . A sharp decline of the projectability ( p n < 0 . 2 ) is seen for states n ≥ 58 . ( b ) Projector matrix | P B | at k 0 = ( 0 . 4 , − 0 . 4 , 0 . 5 ) , in reciprocal coordinates . Only the matrix elements from 44 ≤ n ≤ 58 are shown . B . CoSb 3 We analyze CoSb 3 as an example of a periodic solid . CoSb 3 is a typical binary skutterudite compound with cu - bic structure and space group # 204 . Skutterudites are among the most promising thermoelectric materials . 28 We use the quantum espresso suite of ab - initio codes to obtain the Bloch wavefunctions and the matrix B of projection coeﬃcients . The wavefunctions are obtained using the PBE functional with an energy cutoﬀ of 50 Ry and the PAW data set from the PSlibrary 1 . 0 . 0 . 20 We choose a minimal basis set to project onto composed of M = 84 AOs ( Co : 4 s , 4 p , 3 d and Sb : 5 s , 5 p , taken from the PAW data set ) . The projectability of all occupied DFT bands ( n ≤ 48 ) is very high p n > 0 . 97 and progressively decreases for the unoccupied bands at higher energies ( see Fig . 4 ( a ) ) . The basis set supports 9 unoccupied bands with high pro - jectability of p n > 0 . 87 ( 49 ≤ n ≤ 57 ) before declining to poor values of p n < 0 . 15 for n ≥ 58 . An accurate TB Hamiltonian is obtained when considering only Bloch states of high - projectability ( N = 57 ) as conﬁrmed by the excellent match between the TB ( black and red dots ) and the DFT bands ( gray lines ) seen in Fig . 5 ( a ) . The band n = 55 is shown in red . To illustrate the eﬀect of hybridization on the accuracy of the TB Hamiltonian , we include one Bloch state n = 58 of low projectability ( p 58 = 0 . 15 ) in the construction of the Hamiltonian . The corresponding TB band ( not present in panel a ) is shown in Fig . 5b in blue . First , it is seen that the TB band n = 58 ( blue dots in panel b ) does not reproduce the reference DFT band , es - pecially in regions of reciprocal space with the lowest pro - jectability ( around H ) where the TB eigenvalues strongly underestimate the DFT values and are consistent with be - ing scaled by their projectabilities , i . e . P nn E n ∼ 0 . 4 eV . Second , the ﬁdelity of the band n = 55 ( red dots ) is no - ticeably reduced around H , with respect to panel ( a ) , due to hybridization with the low - projectability band n = 58 ( blue dots ) , which leads to level repulsions . The in - set in Fig . 5b shows the repulsion of the eigenstates at k 0 = ( 0 . 4 , − 0 . 4 , 0 . 5 ) , in reciprocal coordinates . The crosses mark the values of ¯ E 55 ( red ) and ¯ E 58 ( blue ) ex - pected in the absence of hybridization ( ≈ P nn E n ) . The level repulsion due to hybridization is shown along the arrows . As seen in Fig . 4b , the predominant non - zero oﬀ - diagonal element at k 0 is P 55 , 58 , which indicates that the hybridization primarily involves only | A 55 (cid:105) and | A 58 (cid:105) as depicted by the green circles and lines in Fig . 4 . There - fore , the repulsion of ¯ E 55 —the magnitude of which is given by the size of the arrows in the inset—can be analytically estimated by the perturbation formula as ∆ ¯ E 55 = − ∆ ¯ E 58 ≈ | P 55 , 58 | 2 E 55 E 58 P 55 , 55 E 55 − P 58 , 58 E 58 = 0 . 1928 eV , which in agreement to the actual value of 0 . 1381 eV . All the eigenenergies seen in both panels ( a ) and ( b ) of Fig . 5 , i . e . the TB subspace , are insensitive to any cho - sen value of κ since the exact shifting matrix Q N is used . The null subspace ( eigenvalues not seen ) have been rigidly shifted by κ = 2 eV outside the region of interest . In panel 7 Γ H N Γ P H − 1 . 5 − 1 . 0 − 0 . 5 0 . 0 0 . 5 1 . 0 1 . 5 2 . 0 E n e r gy - E F ( e V ) ( a ) Γ H N Γ P H ( b ) ( c ) Γ H N Γ P H k 0 ∆ ¯ E 58 FIG . 5 . ( Color online ) Tight - binding eigenenergies for CoSb 3 . ( a ) Accurate TB bands are obtained when adopting a high - projectability ﬁltering criterion ( p n > 0 . 87 ) in the TB Hamiltonian . The band n = 55 is shown in red . ( b ) The inclusion of a low - projectability band ( p 58 = 0 . 1474 ) introduces the eigenenergies seen in blue , which induces unphysical hybridizations with the band n = 55 . The arrows in the inset , whose size is | ∆ ¯ E 58 | , illustrates the level repulsion at k 0 = ( 0 . 4 , − 0 . 4 , 0 . 5 ) , in reciprocal coordinates , due to hybridization . ( c ) The TB Hamiltonian is built with the approximated shifting matrix Q N and κ = 1 . 0 eV to show the distinct dependences on κ of the eigenstates . The reference DFT bands are shown with gray lines . Brillouin zone integration follows the AFLOW standard as discussed in Ref . [ 27 ] ( c ) we re - compute the TB Hamiltonian from ( b ) but us - ing the approximated shifting matrix ( Q N ≈ I M − AA † ) and κ = 1 . 0 eV . Diﬀerent shifting patterns are observed : ( i ) The eigenvalues of the null subspace shift rigidly with the value of κ and , thus , are pinned along the horizontal line at 1 . 0 eV . ( ii ) The “unhybridized” bands of the TB subspace ( black dots ) show no noticeable diﬀerence with respect to panel Fig . 5b . This conﬁrms that while they for - mally acquire a κ dependence , introduced by the approx - imated Q N , the eﬀect is negligible for bands with high projectability . ( iii ) The high - projectability band n = 55 ( red dots ) should also be insensitive to κ ; nonetheless , it acquires a more noticeable dependence indirectly via its hybridization to the κ - dependent low - projectability band n = 58 . Consequently , the most noticeable changes of this band with respect to ( b ) 29 happen around H where the hy - bridization is stronger . ( iv ) The low - projectability band n = 58 ( blue dots ) shows a noticeable dependence on κ , especially around the lowest - projectability k points . For instance , the value of κ = 1 . 0 eV eﬀectively shifts the states around H by ∼ 0 . 9 eV , i . e . from ∼ 0 . 4 eV [ as in Fig . 5 ( b ) 29 ] to ∼ 1 . 3 eV . V . CONCLUSIONS In this paper we have outlined a noniterative scheme to derive highly accurate ab - initio TB Hamiltonian matrices in a minimal basis set representation . Minimal basis sets may be insuﬃcient to converge self - consistent quantum - mechanical calculations with linear combination of atomic orbitals , however , they are ade - quate for the purpose of projecting wavefunctions obtained with fully converged basis and building the reduced TB matrices . Low - projectability Bloch states have spurious eﬀects when included in the construction of the TB matrix . We have unambiguously shown the underlying mechanism for the formation of the spurious states . The removal of those states , via the application of a shifting matrix , delivers accurate TB matrices . We have introduced an expression for the shifting ma - trix of a nonorthogonal set of vectors . This expression improves the quality of the TB Hamiltonian by removing any unwanted dependence that the shifting procedure had on the TB eigenstates of interest . Appendix A : Projection of Bloch states on pseudo atomic orbitals The pseudo - wavefunction Bloch state | ˜ ψ n k (cid:105) is expanded in plane - wave basis | k + G (cid:105) as | ˜ ψ n k (cid:105) = (cid:88) G C G n k | k + G (cid:105) . ( A1 ) The plane - wave basis (cid:104) r | k + G (cid:105) = 1 √ Ω 0 e i ( k + G ) · r ( A2 ) 8 is deﬁned to be normalized to 1 over the volume of the primitive unit cell Ω 0 . The orthonormality of the basis (cid:104) k + G | k + G (cid:48) (cid:105) = δ GG (cid:48) allows the expansion coeﬃcients to be deﬁned by the projection C G n k = (cid:104) k + G | ˜ ψ n k (cid:105) ( A3 ) In the US / PAW pseudopotential formalisms , the pro - jection of the all - electron ( AE ) wavefunctions ψ n k onto an atomic orbital φ k µ is computed in terms of their corre - sponding pseudized quantities ˜ ψ n k and ˜ φ k µ , and the overlap operator ˆ S = ˆ1 + (cid:80) Iij | β k Ii (cid:105) Q Iij (cid:104) β k Ij | . The pseudo atomic orbitals ( PAO ) and beta projectors are deﬁned as ˜ φ µ ( r ) = R φµ ( r ) Y ml ( (cid:98) r ) ( A4 ) where µ ≡ { Ilm } is a composite index of the ion center I and quantum numbers { lm } of the PAO . The real - space beta projectors are analogously deﬁned 30 , with i ≡ { lm } , as : β Ii ( r ) = R βIi ( r ) Y ml ( (cid:98) r ) ( A5 ) The localized basis | ˜ φ k µ (cid:105) for periodic calculations is con - structed from Bloch sums of the PAOs . (cid:104) r | ˜ φ k µ (cid:105) = 1 N (cid:88) R e i k · R ˜ φ µ ( r − τ µ − R ) , ( A6 ) where N is the number of lattice vectors R . The Bloch sum for the AO basis | φ k µ (cid:105) follows the same deﬁnition . Notice that the factor 1 N implies normalization of | ˜ φ k µ (cid:105) to 1 over the primitive unit cell , which is consistent with the normalization of the plane - wave basis in Eq . A2 . Then , the projection coeﬃcients are calculated in term of the pseudized quantities : B k µn = (cid:104) φ k µ | ψ n k (cid:105) = (cid:104) ˜ φ k µ | ˆ S | ˜ ψ n k (cid:105) = (cid:104) ˜ φ k µ | ˜ ψ n k (cid:105) + (cid:88) GG (cid:48) Iij (cid:104) ˜ φ k µ | β k Ii (cid:105) Q Iij (cid:104) β k Ij | ˜ ψ n k (cid:105) . ( A7 ) The integrals are more eﬃciently computed in the | G (cid:105) basis . Using the identity ˆ 1 = (cid:80) G | G (cid:105)(cid:104) G | = (cid:80) G | k + G (cid:105)(cid:104) k + G | one has B k µn = (cid:88) GG (cid:48) (cid:104) ˜ φ k µ | k + G (cid:105)(cid:104) k + G | ˜ ψ n k (cid:105) + (cid:88) GG (cid:48) Iij (cid:104) ˜ φ k µ | k + G (cid:105)(cid:104) k + G | β k Ii (cid:105) Q Iij (cid:104) β k Ij | k + G (cid:48) (cid:105)(cid:104) k + G (cid:48) | ˜ ψ n k (cid:105) . Using the deﬁnition in Eq . A3 for the expansion coeﬃ - cients : B k µn = (cid:104) φ k µ | ψ n k (cid:105) = (cid:88) G (cid:104) ˜ φ k µ | k + G (cid:105) C G n k + (cid:88) GG (cid:48) Iij (cid:104) ˜ φ k µ | k + G (cid:105)(cid:104) k + G | β k Ii (cid:105) Q Iij (cid:104) β k Ij | k + G (cid:48) (cid:105) C G (cid:48) n k , where the objects in brackets are given in Eqs . B6 and B7 . The coeﬃcients B k µn expand the Bloch state on a PAO basis { φ µ } . Furthermore , the coeﬃcients on a L¨owdin orthonormal basis { ¯ φ µ } are readily obtained by ¯ B k µn = (cid:88) i ( S k − 12 ) iµ B k µn , ( A8 ) where the upper bar symbol is used to indicate orthonor - mality and S k µν = (cid:104) φ k µ | φ k µ (cid:105) is the matrix of overlaps be - tween PAOs . L¨owdin coeﬃcients and orbitals are assumed through - out the main text where we drop the upper bar and k superscript in the notation of ¯ B k . Appendix B : Projection of the plane - waves basis on pseudo atomic orbitals Using the relation ˆ1 = (cid:82) | r (cid:105)(cid:104) r | d r and Eqs . A2 and A6 to evaluate the projection (cid:104) ˜ φ k µ | k + G (cid:105) one has (cid:104) ˜ φ k µ | k + G (cid:105) = (cid:90) d r (cid:104) ˜ φ k µ | r (cid:105)(cid:104) r | k + G (cid:105) ( B1 ) = 1 N √ Ω 0 (cid:88) R e − i k · R (cid:90) d r e i ( k + G ) · r ˜ φ ∗ µ ( r − τ µ − R ) ( B2 ) = e i ( k + G ) · τ µ N √ Ω 0 (cid:88) R e i G · R (cid:90) d r e i ( k + G ) · r ˜ φ ∗ µ ( r ) ( B3 ) = e i ( k + G ) · τ µ √ Ω 0 (cid:90) d r e i ( k + G ) · r ˜ φ ∗ µ ( r ) . ( B4 ) Using the plane - wave expansion e i ( k + G ) · r = (cid:80) l (cid:48) m (cid:48) 4 πi l (cid:48) j l (cid:48) ( | k + G | r ) Y m (cid:48) ∗ l (cid:48) ( (cid:92) k + G ) Y m (cid:48) l (cid:48) ( (cid:98) r ) , where the hat notation indicates the directional angles of the vector under it ; Eq . A4 ; and d r = r 2 sin θdrdθdϕ , the last expression reduces to (cid:104) ˜ φ k µ | k + G (cid:105) = 4 πe i ( k + G ) · τ µ √ Ω 0 (cid:88) l (cid:48) m (cid:48) i l (cid:48) Y m (cid:48) ∗ l (cid:48) ( (cid:92) k + G ) × (cid:90) r 2 R φµ ( r ) j l (cid:48) ( | k + G | r ) dr (cid:90) Y m ∗ l ( (cid:98) r ) Y m (cid:48) l (cid:48) ( (cid:98) r ) sin θdθdϕ . ( B5 ) With the the normalization identity (cid:82) Y m ∗ l ( θ , φ ) Y m (cid:48) l (cid:48) ( θ , φ ) sin θdθdϕ = δ ll (cid:48) δ mm (cid:48) , we arrive to the ﬁnal expression : (cid:104) ˜ φ k µ | k + G (cid:105) = f G µ k Y m ∗ l ( (cid:92) k + G ) (cid:90) r 2 R φµ ( r ) j l ( | k + G | r ) dr , ( B6 ) with f G µ k = 4 πi l Ω 0 − 12 e i ( k + G ) · τ µ . 9 Analogously for the projection on the beta functions : (cid:104) β k Ii | k + G (cid:105) = f G µ k Y m ∗ l ( (cid:92) k + G ) (cid:90) r 2 R βIi ( r ) j l ( | k + G | r ) dr . ( B7 ) Appendix C : Oﬀ - diagonal elements of the projector matrix Given the projector matrix P nm = ( B † B ) nm = (cid:104) ψ n | ˆ P | ψ m (cid:105) , since ψ n forms a complete Hilbert space , the matrix P will also be a projection operator by closure . Namely , P nm = ( P 2 ) nm = (cid:88) j P nj P jm , so there is a constraint for the important diagonal elements ( and using the Hermitian nature of the matrix P ) : p n = p 2 n + (cid:88) m (cid:54) = n | P nm | 2 . This expression puts an upper bound of 1 on the diago - nal elements . One can also deﬁne an upper bound on any oﬀ diagonal element via | P nm | ≤ min ( (cid:112) p n − p 2 n , (cid:112) p m − p 2 m ) . Notice that if p n = 1 ( or ≈ 1 ) which means perfect projection , then P nm = P mn = 0 ( or ≈ 0 ) ∀ m (cid:54) = n so the entire n - th column and row of P is zero ( excluding the diagonal which is 1 ) . For cases of smaller projectability p n < 1 , each oﬀ di - agonal entry will still be much smaller than p n since there are many of them in the sum rule ; but the sum of their squares must add up to p n − p 2 n . ACKNOWLEDGMENTS We want to thank Dr . Dmitri Volja for helpful discus - sions , the Texas Advanced Computing Center ( TACC ) at the University of Texas Austin for providing computing facilities , and the funding provided by the ONR - MURI under Contract No . N00014 - 13 - 1 - 0635 . The authors ac - knowledge the Duke University Center for Materials Ge - nomics for computational assistance . ∗ mbn @ unt . edu 1 E . H¨uckel , Quantentheoretische Beitr¨age zum Benzolprob - lem , Zeitschriftf¨ur Physik 70 , 628 ( 1931 ) . 2 H . Jones , N . F . Mott , and H . W . B . Skinner , A Theory of the Form of the X - Ray Emission Bands of Metals , Phys . Rev . 45 , 379 – 384 ( 1934 ) . 3 D . A . Papaconstantopoulos and M . J . Mehl , The Slater - Koster tight - binding method : a computationally eﬃcient and accurate approach , J . Phys . : Conden . Matt . 15 , R413 ( 2003 ) . 4 C . M . Goringe , D . R . Bowler , and E . Hernandez , Tight - binding modelling of materials , Reports on Progress in Physics 60 , 1447 ( 1997 ) . 5 L . Colombo , Large Scale Simulations Using Tight Bind - ing Molecular Dynamics , in Large Clusters of Atoms and Molecules , edited by T . Martin ( Springer Netherlands , 1996 ) , NATO ASI Series , vol . 313 , pp . 495 – 510 , doi : 10 . 1007 / 978 - 94 - 009 - 0211 - 4˙21 . 6 V . Heine , Electronic structure from the point of view of the local atomic environment , Solid State Physics 35 , 1 ( 1980 ) . 7 O . K . Andersen and T . Saha - Dasgupta , Muﬃn - tin orbitals of arbitrary order , Phys . Rev . B 62 , R16219 – R16222 ( 2000 ) . 8 N . Marzari , A . A . Mostoﬁ , J . R . Yates , I . Souza , and D . Van - derbilt , Maximally localized Wannier functions : Theory and applications , Rev . Mod . Phys . 84 , 1419 – 1475 ( 2012 ) . 9 W . C . Lu , C . Z . Wang , T . L . Chan , K . Ruedenberg , and K . M . Ho , Representation of electronic structures in crys - tals in terms of highly localized quasiatomic minimal basis orbitals , Phys . Rev . B 70 , 041101 ( 2004 ) . 10 L . A . Agapito , S . Curtarolo , and M . Buongiorno Nardelli , Reformulation of DFT + U as a Pseudohybrid Hubbard Den - sity Functional for Accelerated Materials Discovery , Phys . Rev . X 5 , 011006 ( 2015 ) . 11 A . P . Horsﬁeld , Eﬃcient ab - initio tight binding , Phys . Rev . B 56 , 6594 – 6602 ( 1997 ) . 12 J . Harris , Simpliﬁed method for calculating the energy of weakly interacting fragments , Phys . Rev . B 31 , 1770 – 1779 ( 1985 ) . 13 W . M . Foulkes and R . Haydock , Tight - binding models and density - functional theory , Phys . Rev . B 39 , 12520 – 12536 ( 1989 ) . 14 O . F . Sankey and D . J . Niklewski , Ab initio multicenter tight - binding model for molecular - dynamics simulations and other applications in covalent systems , Phys . Rev . B 40 , 3979 – 3995 ( 1989 ) . 15 J . M . Soler , E . Artacho , J . D . Gale , A . Garc´ıa , J . Junquera , P . Ordej´on , and D . S´anchez - Portal , The SIESTA method for ab initio order - N materials simulation , J . Phys . : Conden . Matt . 14 , 2745 ( 2002 ) . 16 H . Teichler , Best Localized Symmetry - Adapted Wannier Functions of the Diamond Structure , Phys . Stat . Solidi B 43 , 307 – 318 ( 1971 ) . 17 Projection onto AO - like functions are used as the ﬁrst itera - tion in the construction of MLWF functions . TB band struc - tures obtained with these trial Wannier functions are equiv - alent to those from the construction in Eq . 1 , see Ref . 16 . 18 L . A . Agapito , A . Ferretti , A . Calzolari , S . Curtarolo , and M . Buongiorno Nardelli , Eﬀective and accurate representa - tion of extended Bloch states on ﬁnite Hilbert spaces , Phys . Rev . B 88 , 165127 ( 2013 ) . 10 19 C . D . Meyer , Matrix analysis and applied linear algebra ( Siam , 2000 ) . 20 L . A . Agapito , A . Ferretti , S . Curtarolo , M . Buongiorno Nardelli , in preparation . 21 This is possible as one can always compute more PW states to increase the number of columns of A . One can start with M DFT states with the highest projectability p n to form A . If for some reason the corresponding M columns vectors are not linearly independent , A will not be invertible . In that case one can proceed in a organized iterative fashion : start with large pool of column vectors sorted by descending p n , initialize a collection with the ﬁrst vector and iteratively add another vector only if is linearly independent to the collection otherwise proceed to the next vector . 22 G . Kresse and J . Furthm¨uller , Eﬃcient iterative schemes for ab initio total - energy calculations using a plane - wave basis set , Phys . Rev . B 54 , 11169 – 11186 ( 1996 ) . 23 P . Giannozzi , S . Baroni , N . Bonini , M . Calandra , R . Car , C . Cavazzoni , D . Ceresoli , G . L . Chiarotti , M . Cococcioni , I . Dabo , A . Dal Corso , S . de Gironcoli , S . Fabris , G . Fratesi , R . Gebauer , U . Gerstmann , C . Gougoussis , A . Kokalj , M . Lazzeri , L . Martin - Samos , N . Marzari , F . Mauri , R . Maz - zarello , S . Paolini , A . Pasquarello , L . Paulatto , C . Sbrac - cia , S . Scandolo , G . Sclauzero , A . P . Seitsonen , A . Smo - gunov , P . Umari , and R . M . Wentzcovitch , QUANTUM ESPRESSO : a modular and open - source software project for quantum simulations of materials , J . Phys . : Conden . Matt . 21 , 395502 ( 2009 ) . 24 P . E . Bl¨ochl , Projector augmented - wave method , Phys . Rev . B 50 , 17953 – 17979 ( 1994 ) . 25 J . P . Perdew , K . Burke , and M . Ernzerhof , Generalized gradient approximation made simple , Phys . Rev . Lett . 77 , 3865 – 3868 ( 1996 ) . 26 The pseudo atomic orbitals used in this work are from public data sets : http : / / www . quantum - espresso . org / pseudopotentials / C . pbe - n - kjpaw psl . 0 . 1 . UPF H . pbe - kjpaw psl . 0 . 1 . UPF http : / / qe - forge . org / gf / project / pslibrary / Co . pbe - n - kjpaw psl . 1 . 0 . 0 . UPF Sb . pbe - n - kjpaw psl . 1 . 0 . 0 . UPF . 27 W . Setyawan and S . Curtarolo , High - Throughput Electronic Structure Calculations : Challenges and Tools , Comp . Mat . Sci . 49 , 299 – 312 ( 2010 ) . 28 Y . Tang , Z . M . Gibbs , L . A . Agapito , G . Li , H . - S . Kim , M . Buongiorno - Nardelli , S . Curtarolo , and G . J . Snyder , Convergence of multi - valley bands as the electronic origin of high thermoelectric performance in CoSb 3 skutterudites , Nature Mater . ( 2015 ) . 29 The TB matrix constructed using the approximated Q N and κ = 0 eV yields the same non - null eigenvalues than when using the exact Q N with any value of κ . 30 A . Ferretti , A . Calzolari , B . Bonferroni , and R . Di Felice , Maximally localized Wannier functions constructed from projector - augmented waves or ultrasoft pseudopotentials , J . Phys . : Conden . Matt . 19 , 036215 ( 2007 ) .
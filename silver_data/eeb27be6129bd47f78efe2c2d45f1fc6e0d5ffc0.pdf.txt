rsif . royalsocietypublishing . org Research Cite this article : House T , Ford A , Lan S , Bilson S , Buckingham - Jeffery E , Girolami M . 2016 Bayesian uncertainty quantification for transmissibility of influenza , norovirus and Ebola using information geometry . J . R . Soc . Interface 13 : 20160279 . http : / / dx . doi . org / 10 . 1098 / rsif . 2016 . 0279 Received : 8 April 2016 Accepted : 25 July 2016 Subject Category : Life Sciences – Mathematics interface Subject Areas : computational biology , biomathematics Keywords : shedding , Markov chain Monte Carlo , compartmental model Author for correspondence : Thomas House e - mail : thomas . house @ manchester . ac . uk Electronic supplementary material is available at http : / / dx . doi . org / 10 . 1098 / rsif . 2016 . 0279 or via http : / / rsif . royalsocietypublishing . org . Bayesian uncertainty quantification for transmissibility of influenza , norovirus and Ebola using information geometry Thomas House 1 , 2 , Ashley Ford 5 , Shiwei Lan 3 , Samuel Bilson 2 , Elizabeth Buckingham - Jeffery 2 , 4 and Mark Girolami 3 1 School of Mathematics , University of Manchester , Oxford Road , Manchester M13 9PL , UK 2 Warwick Infectious Disease Epidemiology Research Centre ( WIDER ) , Warwick Mathematics Institute , 3 Department of Statistics , and 4 Complexity Science Doctoral Training Centre , University of Warwick , Gibbet Hill Road , Coventry CV4 7AL , UK 5 School of Mathematics , University of Bristol , Bristol BS8 1TW , UK TH , 0000 - 0001 - 5835 - 8062 Infectious diseases exert a large and in many contexts growing burden on human health , but violate most of the assumptions of classical epidemiolo - gical statistics and hence require a mathematically sophisticated approach . Viral shedding data are collected during human studies—either where vol - unteers are infected with a disease or where existing cases are recruited—in which the levels of live virus produced over time are measured . These have traditionally been difficult to analyse due to strong , complex correlations between parameters . Here , we show how a Bayesian approach to the inverse problem together with modern Markov chain Monte Carlo algorithms based on information geometry can overcome these difficulties and yield insights into the disease dynamics of two of the most prevalent human pathogens—influenza and norovirus—as well as Ebola virus disease . 1 . Introduction Infectious diseases continue to pose a major threat to human health , with transmission dynamic models playing a key role in developing scientific under - standing of their spread and informing public health policy [ 1 ] . These models typically require many parameters to make accurate predictions , which interact with data in complex , nonlinear ways . It is seldom possible to perform a series of individual controlled experiments to calibrate these models , meaning that the use of multiple datasets is often necessary [ 2 ] . At the population level , infectious disease models most frequently involve a ‘compartmental’ approach in which individuals progress between different dis - crete disease states , usually at constant rates [ 3 ] . We note that alternatives to such a compartmental approach exist , for example , use of a deterministic time - varying infectivity , or allowing for non - Markovian state transitions in a stochastic context [ 4 ] . There are theoretical differences between these and com - partmental models for predictive epidemic modelling ( see [ 5 ] for additional discussion ) , but from the point of view of inference they pose very similar challenges and therefore the rest of this paper will consider a compartmental modelling framework . At the individual level , there are three separate events that can be represented using different compartments : ( i ) an individual receiving an infectious dose of a pathogen , ( ii ) the individual becoming infectious and able to infect new cases , and ( iii ) the individual ceasing to be infectious and becoming unable to infect new cases . For some pathogens , there are also events relating to changes in disease progression during the infectious period . The times elapsed between & 2016 The Authors . Published by the Royal Society under the terms of the Creative Commons Attribution License http : / / creativecommons . org / licenses / by / 4 . 0 / , which permits unrestricted use , provided the original author and source are credited . these events are important for understanding the epidemiol - ogy of infectious diseases as well as designing control and mitigation strategies [ 6 , 7 ] . Here , we consider how the rates of moving between com - partments in standard epidemic models can be estimated from shedding data generated either when individuals are given an infectious dose of a virus under controlled conditions , or when existing cases are enrolled in a study , and the level of live virus that they produce ( shed ) is measured over time . The nature of these models and data means that there are not simple optimal values for the rate parameters , but instead the data constrain the parameters to lie close to a nonlinear curve in parameter space . We show that modern computationally intensive Bayesian methods that make use of information geometry can be used to calculate the posterior density for models of influenza , norovirus and Ebola . We then use forward modelling based on this posterior knowledge to show that some epidemiological conclusions are robust under the remaining uncertainty , but others require additional information to determine . In particular , for influenza , we show that the predicted effectiveness of quarantine - type inter - ventions is unaffected by the remaining uncertainty , but antiviral - like interventions have a bimodal uncertainty struc - ture . For norovirus , we show that the frequency of epidemics is predictable under the remaining uncertainty , but the severity and timing of each seasonal epidemic is not . For Ebola , we are able to distinguish between high - and low - viraemic infectious disease progression , giving results that are consistent with population - level observations of the case fatality ratio . 2 . Methods 2 . 1 . Overview Our methodological approach involves three related com - ponents . We start by defining the different compartmental disease models that we use in § 2 . 2 . These are defined in terms of each case’s natural history , which we represent mathematically as a continuous - time Markov chain . We also show how these models can be used to make population - level predictions by assuming , for example , that an infectious individual will cause new cases at a rate b . Then in § 2 . 3 we consider how the natural history parameters can be estimated from shedding data . An important distinction will be between the expected rate at which individuals infect in the population ( quantified using a rate like b above ) and the measured intensity of shedding ( quantified using log titre ) . We will generally assume a simple linear relationship between these using a scaling parameter that we call t . Finally in § 2 . 4 , we present the Bayesian approach to uncer - tainty quantification as well as the algorithms necessary to implement this for the complex posterior distributions that arise in the analysis of shedding data . 2 . 2 . Compartmental models of infectious disease In a compartmental approach , we model the state of an individ - ual who has been infected with a pathogen at time t ¼ 0 as an integer random variable X ( t ) . We label the possible states after infection i , j , . . . [ f 1 , . . . , m g ; while more general structures are needed for other pathogens , for both influenza and norovirus we consider the ‘linear chain’ case where an individual spends an exponentially distributed period of time with mean 1 = g i in each state i , m before progressing to state i þ 1 , and where m is the ‘recovered’ state , corresponding to the end of the infection , from which the individual does not move . In the electronic supplementary material , we provide a general solution for the probability of being in disease compartment i at time t , p i ð t ; g Þ : ¼ Pr ½ X ð t Þ ¼ i j X ð 0 Þ ¼ 1 ; g (cid:2) , ð 2 : 1 Þ and its derivatives with respect to the rates f g i g . For Ebola , we consider a chain that branches , which introduces parameters relating to the probability of following one path or another in addition to rate constants . We also assume that an individual has ‘infection rate’ l i in state i ( with l m ¼ 0 ) , which is proportional to the rate at which they would infect new cases in a population - level epidemic model . A key quantity is the expected infectiousness of an individual over time L ð t ; u Þ : ¼ X m i ¼ 1 l i p i ð t ; g Þ , ð 2 : 2 Þ where the model parameters are u ¼ ð g , l Þ ¼ ð u a Þ . Perhaps the most important quantity in any epidemiological model of infec - tions is the basic reproductive ratio , R 0 , defined as the expected number of secondary infections produced by a typical infectious individual early in the epidemic [ 4 ] . Under the simplifying ( but frequently made ) assumption of a homogeneous population , this quantity is given by R 0 ð u Þ ¼ ð 1 t ¼ 0 L ð t ; u Þ d t : ð 2 : 3 Þ Note that the constants of proportionality l depend on the nature and strength of interactions in the population and therefore cannot be determined from measurements of individuals alone . 2 . 2 . 1 . The SIR model One of the simplest models in mathematical epidemiology is the SIR model , in which individuals are susceptible , infectious or removed . We use this model as a simple example of the methodology we propose . An individual infected at time t ¼ 0 spends an exponentially distributed period of time in the infectious class , with rate g , before recovering , and has infectiousness b . Therefore , p 1 ð t ; g Þ ¼ e (cid:3) g t and L ð t ; b , g Þ ¼ b e (cid:3) g t : ð 2 : 4 Þ At the population level , supposing that we can ignore demo - graphic processes such as births and deaths so the population size is fixed at N , we have a set of ordinary differential equations describing the evolution of an epidemic : d S d t ¼ (cid:3) b SI N , d I d t ¼ b SI N (cid:3) g I and d R d t ¼ g I : ð 2 : 5 Þ Here S ( t ) is the expected number of susceptible individuals in the population , I ( t ) is the expected number of infectious cases and R ( t ) is the expected number of removed indivi - duals ; we will use a similar notation below generalized in a natural way . In this work , we will consider how to fit expressions such as ( 2 . 4 ) to shedding data in such a way that population - level models such as ( 2 . 5 ) can be parametrized accounting for uncertainty . 2 . 2 . 2 . Influenza Influenza is commonly modelled using the ‘SEEIIR’ or ‘SE 2 I 2 R’ framework , for example , in the work that was used to inform vaccination policy during the recent H1N1 pandemic [ 8 ] . Here m ¼ 5 and individuals spend a 2 - Erlang distributed period of time with mean 1 / v in a non - infectious ‘exposed’ state , and then a 2 - Erlang distributed period of time with mean 1 / g in the infectious state , before recovering . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 2 To show the possible different impacts of uncertainty in par - ameter values , we will consider two models for delayed intervention ( implemented after a time period of length d after infection ) during an influenza pandemic . The first of these assumes that the intervention is ‘quarantine - like’ and completely halts transmission after administration , leading to an epidemic with reproduction number R ð 1 Þ d ¼ ð d t ¼ 0 L ð t ; u Þ d t : ð 2 : 6 Þ The second , however , assumes that the individual must not have progressed from the ‘latent’ to the ‘infectious’ class and is there - fore similar to some models of administration of antiviral medication like Tamiflu [ 9 , 10 ] , leading to an epidemic with reproduction number R ð 2 Þ d ¼ ð 1 (cid:3) Pr ½ X ð d Þ , 3 (cid:2)Þ R 0 : ð 2 : 7 Þ We note from standard results in mathematical epidemiology [ 4 ] that if the infection rate is b , and the mean infectious period is 1 / g , then the basic reproductive ratio is R 0 ¼ b / g , and for an epi - demic with reproduction number R the epidemic final size Z is given by the solution to the transcendental equation Z ¼ 1 (cid:3) e (cid:3) RZ , ð 2 : 8 Þ which we solve numerically for the two different reproduction numbers R ð 1 Þ d and R ð 2 Þ d above , a range of delays , and fitted values of the parameters ( v , g ) at a fixed value of R 0 ¼ 1 . 4 ( as in [ 8 ] ) to make a direct comparison , although it would be straightforward to place a distribution on R 0 . We note that while all parameter values agree on the value of R 0 ¼ lim d ! 1 R d , and that lim d ! 0 R d ¼ 0 , at finite non - zero d the uncertainty in parameters will lead to posterior variability in R d and hence Z . Temporal features of an influenza epidemic are often more relevant for policy than the final size [ 11 , 12 ] and are typically considered using systems of differential equations . As we are considering an intervention with fixed delay , we couple the stan - dard ODE system [ 8 ] to a set of terms modelling the delayed intervention leading to the delay - differential equation system d S d t ¼ (cid:3) b N S ð t Þ I ð t Þ , d E 1 d t ¼ b N S ð t Þ I ð t Þ (cid:3) 2 v E 1 ð t Þ (cid:3) p 1 ð d ; v , g Þ b N S ð t (cid:3) d Þ I ð t (cid:3) d Þ , d E 2 d t ¼ 2 v ð E 1 ð t Þ (cid:3) E 2 ð t ÞÞ (cid:3) p 2 ð d ; v , g Þ b N S ð t (cid:3) d Þ I ð t (cid:3) d Þ , d I 1 d t ¼ 2 ð v E 2 ð t Þ (cid:3) g I 1 ð t ÞÞ (cid:3) ep 3 ð d ; v , g Þ b N S ð t (cid:3) d Þ I ð t (cid:3) d Þ and d I 2 d t ¼ 2 g ð I 1 ð t Þ (cid:3) I 2 ð t ÞÞ (cid:3) ep 4 ð d ; v , g Þ b N S ð t (cid:3) d Þ I ð t (cid:3) d Þ , 9 > > > > > > > > > > > > > > > > = > > > > > > > > > > > > > > > > ; ð 2 : 9 Þ where the variable e is 1 if the intervention works for any infected individual and 0 if it only works during the latent period , and d is the intervention delay . p i ð t ; v , g Þ is the prob - ability of being in state i time t after starting in state 1 at time 0 as in ( 2 . 1 ) above and is also determined by the parameters in the shedding model . 2 . 2 . 3 . Norovirus Norovirus is usually assumed to follow the ‘SEIRS’ framework [ 13 ] , where after infection an individual spends an exponentially distributed period of time with mean 1 / v in a ‘latent’ class , then an exponentially distributed period of time with mean 1 / g in the infectious class . In contrast to influenza , individuals move from the ‘recovered’ class back to the ‘susceptible’ class with rate m ; this loss of immunity is a relatively slow process that does not impact on the analysis of shedding data . It does , however , influence the population - level disease dynamics of norovirus , which can be described using a set of ordinary differential equations , where S ( t ) stands for the expected number of people who are susceptible and similarly for other compartments : d S d t ¼ d N þ m R (cid:3) b ð t Þ SI N (cid:3) d S , d E d t ¼ b ð t Þ SI N (cid:3) v E (cid:3) d E , d I d t ¼ v E (cid:3) g I (cid:3) d I and d R d t ¼ g I (cid:3) m R (cid:3) d R : 9 > > = > > ; ð 2 : 10 Þ Here we have assumed a constant effective population size N and have a time - varying infection rate ( which is necessary to repro - duce the regular seasonality seen in real data [ 13 ] ) that we assume takes a sinusoidal form b ð t Þ¼ b 0 ð 1 þ A sin ð a t ÞÞ . Because such external forcing in transmission is typically believed to arise from school terms [ 14 ] , we take A ¼ 1 / 3 to be close to exist - ing empirical estimates of the impact of school closures on disease spreading [ 15 , 16 ] , and a can be set to 2 p yr (cid:3) 1 . The demo - graphic rate d is standardly set to 1 / 70 yr – 1 . From the results of [ 17 ] , we have that R 0 ¼ b 0 = g ; we vary this and the rate of waning immunity m within ranges suggested by Simmons et al . [ 13 ] , and then run the model ( 2 . 10 ) to determine its long - term behaviour for different fitted values of the parameters ( v , g ) . A norovirus vaccine is likely to be available in the future [ 18 ] , and we model the impact of a vaccination policy starting at time u and with effective coverage v ( defined as the product of cover - age and efficacy ) by modification of the demographic term for S and addition of a vaccinated V compartment : d S d t ¼ d ð 1 (cid:3) v Q ð t (cid:3) u ÞÞ N þ m R (cid:3) b ð t Þ SI N (cid:3) d S and d V d t ¼ d ð v Q ð t (cid:3) u Þ N (cid:3) V Þ : 9 > > = > > ; ð 2 : 11 Þ Here Q is the step function , leaving us with a set of time - inhomogeneous ordinary differential equations . 2 . 2 . 4 . Ebola Ebola is both much less common than influenza and norovirus and much more dangerous . This means that the modelling fra - mework for it is less established—although it is typically assumed to follow an SEIR - type framework [ 19 , 20 ] —and also that challenge studies cannot be performed . Instead , existing cases are recruited and their viral loads are monitored . Our mod - elling approach is based on the results of such studies [ 21 ] . This is shown diagrammatically in figure 1 and is described by equations d J 1 d t ¼ (cid:3) u 1 J 1 , d J 2 d t ¼ u 1 J 1 (cid:3) u 1 J 2 , d I 1 d t ¼ u 2 u 1 J 2 (cid:3) u 3 I 1 , d I 2 d t ¼ u 3 I 1 (cid:3) u 3 I 2 , d H 1 d t ¼ ð 1 (cid:3) u 2 Þ u 1 J 2 (cid:3) u 4 H 1 , d H 2 d t ¼ u 4 H 1 (cid:3) u 4 H 2 , d R d t ¼ u 3 I 2 and d D d t ¼ u 4 H 2 : 9 > > > > > > > > > > > > = > > > > > > > > > > > > ; ð 2 : 12 Þ In this study design , the latent E states are not observed and so the initial condition is J 1 ð 0 Þ ¼ 1 with all other quantities initially 0 . Parameter interpretations and priors are given in table 1 . The transmission rates for low - and high - viraemic pathways are , respectively , L l ¼ b ð u 5 ( J 1 þ J 2 ) þ u 6 ð I 1 þ I 2 ÞÞ and L h ¼ b ð u 5 ( J 1 þ J 2 ) þ u 7 ð H 1 þ H 2 ÞÞ : ) ð 2 : 13 Þ 2 . 3 . Shedding model and data Our aim is to extract parameter estimates for compartmental epi - demic models from challenge studies in which human volunteers are infected with a pathogen , or observational studies based on r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 3 existing cases , and the level of live virus they produce ( or ‘shed’ ) is measured over time . The concentration of live virus is quanti - fied as a ‘titre’ , which is essentially an estimate of the concentration of live virus . The relationship between this quan - tity and transmissibility is complex , but generally agreed to be sub - linear [ 22 , 23 ] . We assume here that at each time point t the log titre y is proportional to the expected intensity of infection L ( t ) plus additive Gaussian noise representing experimental error and other factors such as individual - level variability , lead - ing to likelihood functions based on products of normal distribution probability mass functions . The details are , however , different for the four scenarios we consider and so we define our models separately below . 2 . 3 . 1 . The SIR model For the SIR model , we assume one observation y of shedding with standard deviation s at time t leading to likelihood function L ð y j t , g Þ ¼ N ð y j t e (cid:3) g ; s Þ : ð 2 : 14 Þ We will use this as a toy model to demonstrate our methodologi - cal approach , using numerical values y ¼ 1 , s ¼ 0 . 02 and t ¼ 1 . Note that here and throughout , we write the probability density function for the normal distribution with mean m and standard deviation s evaluated at x as N ð x j m ; s Þ ¼ 1 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 s 2 p p exp (cid:3)ð x (cid:3) m Þ 2 2 s 2 ! : ð 2 : 15 Þ 2 . 3 . 2 . Influenza For influenza , we use the meta - analysis data of Carrat et al . [ 24 ] for viral titre in the nasal passages of individuals infected with influenza A H1N1 , which is shown in figure 2 a . Here , obser - vations are made at regularly spaced times belonging to a set T . Under our general modelling assumptions , the likelihood of observing a set of mean log - titres ( y t ) among participants , with associated standard deviations ( s t ) , given the model parameters , is L ð y , s j u Þ ¼ Y t [ T N ð y t ; ð t = b Þ L ð t j u Þ , s t Þ , ð 2 : 16 Þ where N is the normal distribution probability density function intended to capture various sources of experimental error and individual - level variability as would be expected due to the cen - tral limit theorem . Here , we assume that the variance at each time point is measured , as given in [ 24 ] . Because the infection rate b depends inter alia on the rate of contact between individuals , which cannot be estimated from shedding data , we rescale the infectiousness L using the scaling parameter t meaning that our parameters for estimation are u ¼ ð t , v , g Þ . 2 . 3 . 3 . Norovirus For norovirus , we use data from the study of Atmar et al . [ 25 ] , where individuals were infected under controlled conditions and observations of viral titre in faeces made irregularly at times belonging to a set T : These data are shown in figure 3 a and since they do not aggregate in the same way as the influenza data the likelihood function is L ð y j u , s Þ ¼ Y t [ T N y t ; t b (cid:3) (cid:4) L ð t j u Þ , s (cid:3) (cid:4) , ð 2 : 17 Þ so s is here an additional parameter that must be estimated , and we have rescaled the infectiousness as before using t . This makes the norovirus parameter space dimension 4 , in contrast to dimen - sion 3 for influenza , with u ¼ ð t , v , g , s Þ . 2 . 3 . 4 . Ebola For Ebola , we use the data of Ksiazek et al . [ 21 ] on viral titre in the blood of hospitalized Ebola cases , which are stratified into low - and high - viraemic disease pathways as shown in figure 1 , together with the model described by equations ( 2 . 12 ) . This leads to a likelihood function that takes the form of a product of low and high trajectories , each of which is similar to the influenza likelihood : L ð y , s j u Þ ¼ Y t [ T l N y l , t ; 1 b (cid:3) (cid:4) L l ð t j u Þ , s l , t (cid:3) (cid:4) (cid:4) Y t [ T h N y h , t ; 1 b (cid:3) (cid:4) L h ð t j u Þ , s h , t (cid:3) (cid:4) , ð 2 : 18 Þ where we use a natural subscripting of ‘l’ for low and ‘h’ for high , and the parameters for estimation are ð u 1 , . . . , u 7 Þ as shown in table 1 . 2 . 4 . Statistical framework 2 . 4 . 1 . The Bayesian approach to identifiability It is long - established that fitting of a sum of exponentials to data is potentially troublesome ; in particular , Acton [ 26 ] high viraemia initialviraemia J 1 J 2 H 1 H 2 D I 1 I 2 R q 3 q 3 q 1 q 2 q 4 q 5 q 7 q 4 q 6 q 1 q 1 ( 1 – q 2 ) low viraemia recovery death Figure 1 . Ebola model compartmental structure and role of parameters . Compartments are shown as circles ; flows between compartments are shown as thin black arrows labelled with parameters ; and infectiousness is indicated by outward facing block arrows labelled with parameters . Table 1 . Parameters of the Ebola model , their interpretation and prior distribution . parameter interpretation prior u 1 2 / ( mean time in initial viraemic state ) Exp ( 0 . 01 ) u 2 proportion entering high - viraemic state Uniform ( [ 0 , 1 ] ) u 3 2 / ( mean time in low - viraemic state ) Exp ( 0 . 01 ) u 4 2 / ( mean time in high - viraemic state ) Exp ( 0 . 01 ) u 5 scaling parameter for initial viraemic state Exp ( 0 . 1 ) u 6 scaling parameter for low - viraemic state Exp ( 0 . 1 ) u 7 scaling parameter for high - viraemic state Exp ( 0 . 1 ) r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 4 considers fitting the model y ¼ A e (cid:3) at þ B e (cid:3) bt to ( y , t ) pairs and notes that ‘there are many combinations of ( a , b , A , B ) that will fit most exact data quite well indeed [ . . . ] and when exper - imental noise is thrown into the pot , the entire operation becomes hopeless’ . Our compartmental models are more complex than sums of exponentials , but exhibit the same lack of a clear mode in the likelihood function . While there are various methods to address this issue in other applications ( e . g . [ 27 ] ) , another response is ( informally speaking ) to consider all parameter combinations that fit well , and to investigate the epidemiological consequences of this uncertainty in parameter values . More formally , we work in a Bayesian framework , meaning that we attempt to calculate the posterior density p over par - ameters u from the likelihood function L and the prior function f using Bayes’ rule p ð u j y Þ ¼ L ð y j u Þ f ð u Þ Ð L ð y j q Þ f ð q Þ d q : ð 2 : 19 Þ Given fixed data y , the measure p ð u j y Þ d u is higher in more cred - ible regions of parameter space , and can be multi - modal and / or with many combinations of parameters having the same level of posterior support . Here , we attempt to use priors that are broadly speaking uninformative—either uniform or improper if there is sufficient data , or low - rate exponential if there is less data . It is important to note , however , that use of strongly informative priors is another method for restoration of identifiability , in the sense of an approximately multivariate normal posterior distribution that is concentrated in the region of a unique mode . 0 2 4 6 8 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 3 . 5 time ( days ) l og tit r e 0 20 40 0 2 4 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 r e c o v e r y r a t e , g t r a n s m i ss i b ilit y , t l a t e n t r a t e , w ( b ) ( a ) ( c ) 0 10 20 0 . 05 0 . 1 po s t e r i o r d e n s it y e s ti m a t e 0 10 20 30 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 0 10 20 30 0 . 4 0 . 6 0 . 8 1 . 0 t r a n s m i ss i b ilit y , t t r a n s m i ss i b ilit y , t 0 1 2 3 10 20 30 0 1 2 0 . 5 1 . 0 1 . 5 2 . 0 0 1 2 0 . 4 0 . 6 0 . 8 1 . 0 0 . 4 0 . 6 0 . 8 0 10 20 30 0 . 4 0 . 6 0 . 8 0 1 2 3 0 . 4 0 . 6 0 . 8 0 5 10 15 20 r ec ov e r y r a t e , g r ec ov e r y r a t e , g po s t e r i o r d e n s it y e s ti m a t e po s t e r i o r d e n s it y e s ti m a t e l a t e n t r a t e , w l a t e n t r a t e , w transmissibility , t transmissibility , t transmissibility , t recovery rate , g recovery rate , g recovery rate , g latent rate , w latent rate , w latent rate , w Figure 2 . Analysis of influenza shedding data . ( a ) Data and empirical confidence intervals ( black ) against model mean and 95 % credible interval ( red ) . ( b ) Posterior samples obtained using WHLMC . ( c ) Diagonal plots : marginal posterior density estimates for each parameter . Bottom left plots : marginal log posterior for pairs of parameters—first - order gradients will be perpendicular to contours . Top right plots : samples ( black ) with visualizations of the metric—based on expectations of second - order derivatives as detailed in the main text—as red curves , centred on evenly spaced points , whose radius is inversely proportional to the infinitesimal distance at that angle as defined in ( 2 . 28 ) . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 5 2 . 4 . 2 . Markov chain Monte Carlo Typically , the integral in the denominator of ( 2 . 19 ) is not tractable so we adopt the popular methodology of defining a Markov chain on parameter space whose stationary distribution has probability density function p , i . e . Markov chain Monte Carlo ( MCMC ) [ 28 , 29 ] , in particular the Metropolis – Hastings algor - ithm [ 30 , 31 ] . This is a discrete - time Markov chain in which a change of state from u n to u (cid:5) is proposed with probability q ð u (cid:5) j u n Þ and the proposal is accepted with probability a ¼ 1 ^ L ð y j u (cid:5) Þ f ð u (cid:5) Þ q ð u n j u (cid:5) Þ L ð y j u n Þ f ð u n Þ q ð u (cid:5) j u n Þ : ð 2 : 20 Þ We shall now outline five popular approaches to MCMC , three that do not make use of derivatives and two that do , with all being in some sense a special case of ( 2 . 20 ) . 2 . 4 . 3 . Derivative - free Markov chain Monte Carlo algorithms ( i ) Independence sampling . In independence sampling , there is no dependence on the current state for the proposal distribution . A popular choice is simply to sample from the prior so that q ð u 0 j u Þ ¼ f ð u 0 Þ : ð 2 : 21 Þ Intuitively , such an approach is expected to work well when the posterior is ‘close’ to the prior . ( ii ) Random walk . In a random walk approach , the current state of the Markov chain is only used to inform the mean of the propo - sal distribution . The most popular choice is the multivariate normal q ð u 0 j u Þ ¼ N ð u 0 j u , S Þ , ð 2 : 22 Þ where the constant matrix S is often adaptively tuned to optimize algorithmic performance [ 32 ] . ( iii ) Gibbs . If it is possible to sample from the marginal posterior for a parameter u a then we can propose with density q ð u 0 j u Þ ¼ p ð u 0 a j u 1 , . . . , u a (cid:3) 1 , u a þ 1 , . . . , u n , y Þ : ð 2 : 23 Þ From ( 2 . 19 ) and ( 2 . 20 ) , we then see that the acceptance prob - ability for such a proposal is 1 . If the marginal posteriors for 5 10 15 time ( days ) transmissibility , t transmissibility , t transmissibility , t transmissibility , t po s t e r i o r d e n s it y e s ti m a t e po s t e r i o r d e n s it y e s ti m a t e 00 0 20 40 0 1 2 0 0 . 60 0 . 65 0 . 70 0 . 75 0 . 60 0 . 65 0 . 70 0 . 75 0 . 60 0 . 65 0 . 70 0 . 75 0 . 60 0 . 80 0 . 5 1 . 0 0 0 . 5 1 . 0 0 0 . 5 1 . 0 1 . 5 0 1 . 0 0 1 0 1 2 0 1 2 50 0 50 0 50 0 . 05 0 . 10 0 . 15 r ec ov e r y r a t e , g r ec ov e r y r a t e , g r ec ov e r y r a t e , g 0 1 2 0 0 . 5 1 . 0 1 . 5 0 . 5 0 . 6 0 . 7 0 . 8 recovery rate , g recovery rate , g recovery rate , g recovery rate , g latent rate , w latent rate , w latent rate , w latent rate , w variability , s variability , s variability , s variability , s t r a n s m i ss i b ilit y , t t r a n s m i ss i b ilit y , t t r a n s m i ss i b ilit y , t 0 20 40 0 20 40 0 20 40 p o s t e r i o r d e n s it y e s ti m a t e 0 1 2 l a t e n t r a t e , w l a t e n t r a t e , w l a t e n t r a t e , w 0 0 . 5 1 . 0 1 . 5 0 . 5 0 . 6 0 . 7 0 . 8 0 1 2 po s t e r i o r d e n s it y e s ti m a t e 0 2 4 6 v a r i a b ilit y , s v a r i a b ilit y , s v a r i a b ilit y , s 0 . 5 0 . 6 0 . 7 0 . 8 0 1 2 0 0 . 5 1 . 0 0 5 10 15 ( b ) ( a ) Figure 3 . Analysis of norovirus shedding data . ( a ) Data ( black circles ) with 67 % ( solid black line ) and 95 % ( dotted black line ) against model mean and 95 % credible interval ( red ) . ( b ) Diagonal plots : marginal posterior density estimates for each parameter . Bottom left plots : marginal log posterior for pairs of parameters—first - order gradients will be perpendicular to contours . Top right plots : samples ( black ) with visualizations of the metric—based on the empirical Fisher information as detailed in the main text—as red curves , centred on evenly spaced points , whose radius is inversely proportional to the infinitesimal distance at that angle as defined in ( 2 . 28 ) . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 6 all parameters are known , then pure Gibbs sampling can be undertaken and involves cycling through proposals ( 2 . 23 ) for all a . 2 . 4 . 4 . Derivative - based Markov chain Monte Carlo In the field of numerical optimization , methods such as gradient descent that make use of the first - order derivatives of the func - tion to be optimized are popular . Significant care must be taken when extending these to stochastic algorithms such as MCMC , but there are two popular methods that make use of the first - order derivatives of L : ¼ ln ð Lf Þ . We use the following notation : @ a L : ¼ @ L @ u a and @ L ¼ ð @ a L Þ ; ð 2 : 24 Þ note that throughout we write ( x i ) for the vector x with i th element x i and ( M ij ) for the matrix M with ( i , j ) th element M ij . There are then two main families of derivative - based MCMC algorithms that we consider . ( i ) MALA . The first algorithm family starts with the Langevin equation d u ¼ 12 @ L d t þ d W : ð 2 : 25 Þ This stochastic differential equation model has a stationary distri - bution equal to the posterior distribution as defined in ( 2 . 19 ) , and the Metropolis - adjusted Langevin algorithm ( MALA ) uses the Euler approximation to ( 2 . 25 ) : D u (cid:6) 1 2 @ L e þ e 1 = 2 U (cid:2) N e 2 (cid:5) (cid:6) @ L , e I (cid:5) (cid:6) , ð 2 : 26 Þ where U is a vector of independent standard normal random variables and I is the identity matrix . The approximation ( 2 . 26 ) can then be used as a proposal within the Metropolis – Hastings algorithm [ 33 ] . ( ii ) HMC . The second family of algorithms starts from the follow - ing system of ordinary differential equations that are a special case of Hamiltonian dynamics : d u d t ¼ v and d v d t ¼ @ L : ð 2 : 27 Þ The randomness in the proposals arises as a result of the starting value of a vector of auxiliary variables v , by default chosen as a vector of standard normal random variables . MCMC algorithms based on Hamilton’s equations ( 2 . 27 ) are called hybrid [ 34 ] or Hamiltonian [ 35 ] Monte Carlo ( HMC ) . One important thing to note about these algorithms is that they use likelihood derivatives to improve acceptance rates , but since they include a Metropolis – Hastings step the derivative calculations could be approximate . 2 . 4 . 5 . Geometric concepts in Markov chain Monte Carlo While both MALA and HMC remove some of the inefficiencies of random walks through use of local gradients , they are not par - ticularly efficient for the curved ‘boomerang’ - shaped posteriors that we see for the shedding models and data defined above . To address this issue , recent work has made progress through use of concepts from differential geometry [ 36 ] . In general , we have n real - valued parameters , where the support for the posterior distribution is a set P # R n . A general vector of parameter values is u ¼ ð u 1 , . . . , u n Þ [ P , and informally speaking a metric is defined as a smooth symmetric map s : P (cid:4) P ! ½ 0 , 1 Þ such that s ð u , u 0 Þ is the ‘distance’ between u and u . In practice , we will only need to define this over small local distances , which requires a metric matrix G ð u Þ ¼ ð G ab Þ ; explicitly , the infinitesimal distance between u and u þ d u is d s ð u , d u Þ ¼ X a , b G ab d u a d u b ! 1 = 2 : ð 2 : 28 Þ Here G can be any smooth matrix function and conceptually speaking this means that even the most complex posterior can be efficiently sampled with a choice of metric that brings all high - density regions of parameter space sufficiently ‘close’ to each other . Throughout this work , we will visualize the impact of the metric in the plane for two parameters of a general model using ellipses , which are defined as follows . Let G ð u 1 , . . . , u n Þ be the metric matrix and consider the first two parameters ð u 1 , u 2 Þ without loss of generality . Now let ð G ð u 1 , u 2 , ^ u 3 , . . . , ^ u n ÞÞ ab ¼ ð G ab Þ , a , b [ f 1 , 2 g , ð 2 : 29 Þ where ^ u i is a point estimate ( we choose the posterior median ) for the parameter u i . Consider the ellipse defined by the following equation for polar coordinates distance r ( from ð u 1 , u 2 Þ in the plane ) and angle a : r ð a Þ ¼ ( G 11 cos 2 ð a Þ þ G 12 cos ð a Þ sin ð a Þ þ G 21 sin ð a Þ cos ð a Þ þ G 22 sin 2 ð a Þ ) (cid:3) 1 = 2 : ð 2 : 30 Þ Plotting several such ellipses in the plane allows us to visualize the impact of the metric in the following sense : points on each ellipse are all the same ‘distance’ from the centre as each other under the assumption of a locally constant metric . While it is not simple to optimize the metric for a particular model , a generally well - motivated choice is the Fisher – Rao metric as suggested by Girolami & Calderhead [ 36 ] G ab ð u Þ ¼ E ½ @ a L @ b L (cid:2) , ð 2 : 31 Þ where the expectation is taken over data . Benefits of this metric include that it ensures the matrix G will be positive definite , and hence that the inverse matrix G 2 1 will exist and be positive definite . Calculations of the Fisher – Rao metric for the models under consideration are given in the electronic supplementary material , showing that it is also available in a closed form for our models . We note that other metrics are sometimes preferable , as discussed by , for example , Betancourt [ 37 ] ; however in our case the Fisher – Rao metric proved to be adequate . We used two different geometric algorithms , chosen based on features of the posterior . ( i ) SMMALA . The simplified manifold Metropolis - adjusted Langevin algorithm ( SMMALA ) was introduced in [ 36 ] and shown to be competitive in terms of computational effort in sev - eral applied contexts by Calderhead and co - workers [ 38 , 39 ] . In this approach , the proposal distribution is q ð u (cid:5) j u n Þ ¼ N u (cid:5) ; u n þ e 2 (cid:5) (cid:6) G (cid:3) 1 @ L , e G (cid:3) 1 (cid:5) (cid:6) , ð 2 : 32 Þ with standard MALA recovered if we set G ¼ I . Note that the inverse of the metric matrix is used to ensure that the expected distance ( as defined in ( 2 . 28 ) ) of a move is directionally invariant . We used SMMALA to sample from the norovirus and Ebola pos - teriors , which each had one mode but were strongly correlated with variable local correlation structure . ( ii ) WHLMC . The idea behind wormhole Lagrangian Monte Carlo ( WHLMC ) is that for a multi - modal posterior , a metric can be defined that dramatically reduces the distance between modes , and a modified form of the dynamics ( 2 . 27 ) can exploit this proximity . Full details of the algorithm are highly technical and are given in the papers that first introduced it [ 40 , 41 ] , as well as in our electronic supplementary material . 3 . Results 3 . 1 . Selection of Markov chain Monte Carlo algorithm Taking the simple likelihood function ( 2 . 14 ) together with prior distribution uniform ( [ 0 , 5 ] (cid:4) [ 0 , 3 ] ) we were able to r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 7 run the full set of MCMC algorithms discussed above to assess their efficiency . Figure 4 shows the results of running these algorithms . In terms of the derivative - free algorithms , the low - dimensional nature of the problem means that the independence sampler does relatively well . Both of the random walk and Gibbs samplers are not able to move efficiently through the region of high posterior density due to its narrow , curved structure . By contrast , SMMALA is able to adjust to variations in local posterior structure and as such provides a series of samples from the posterior that are much more independent of each other than other approaches . This is explained by figure 4 e , f that visualize the impact of the geometry in this algorithm . Figures 2 , 3 and 5 also show that the Fisher – Rao metric and associated geometry generally correctly resolves the dif - ficulties associated with our highly correlated posterior distributions for influenza , norovirus and Ebola , allowing accurate quantification of uncertainty in epidemiological rates . The question then becomes under what circumstances the additional computational effort of implementation of these algorithms is warranted , which has no simple answer here as in other areas of computational statistics ; however , we note the following points . First , standard measures of performance such as mini - mum effective sample size per CPU second [ 36 ] often overstate the effectiveness of inaccurate algorithms for our models . Figure 4 b shows that over iterations 2 – 3000 , independence sampler scaling parameter , t scaling parameter , t r ec ov e r y r a t e , g 0 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 r ec ov e r y r a t e , g 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 1 2 3 4 5 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 1 2 3 4 5 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 1 2 3 4 5 r ec ov e r y r a t e , g 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 0 5000 10000 5000 10000 5 0 1 2 random walk Gibbs 0 5000 10000 0 5 10 0 5000 10000 - 2 0 2 SMMALA 0 5000 10000 0 5 0 5000 10000 0 1 2 likelihood and metrics ( SMMALA distance to blue square ) 1 / 5 t 0 5000 10000 5 g t g t g t g 5000 10000 0 1 2 ( e ) ( b ) ( a ) ( c ) ( d ) ( f ) Figure 4 . Results for the SIR model with recovery rate g and scaling parameter t ( the constant of proportionality for the observed level of shedding at a given expected infectiousness ) . ( a – d ) MCMC trajectories for 1000 likelihood evaluations starting from the blue square are shown as red lines , with trace plots for a further 9000 steps shown in insets for different algorithms . ( e ) Visualizes the impact of the metric through the use of ellipses as detailed in § 2 . 4 . 5 . ( f ) Visualizes the impact of the metric through shading with shading intensity dependent on the distance to the starting point of the MCMC run . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 8 random walk sampling appears to be well - behaved and would yield a high ESS despite only being in a small sub - area of the region of parameter space from which we would like to sample . Secondly , if the posterior density is concentrated in a nonlinear region , derivative - free methods such as Gibbs , inde - pendence sampling and random walk will have a general tendency to get ‘stuck’ in sub - areas . This will not be proble - matic if there are sufficient computational resources available to perform significant thinning—i . e . removal of MCMC samples to reduce correlations between those that remain . Thirdly , computational resources for these algorithms will almost certainly become overstretched in any of the fol - lowing three limits : ( i ) As the dimensionality of parameter space becomes larger , for example , in our Ebola model . ( ii ) In the presence of multi - modality as in our influenza model . ( iii ) For extreme cases of unidentifiability , for example , the s ! 0 limit of our SIR model . Finally , the geometric methods for MCMC that we pre - sent and employ here are designed to be particularly well suited to complex nonlinear relationships between parameters where the derivatives of the log - likelihood and log - prior are available in an analytically closed form , which is the case for our models . Despite this we note that there are many other sophisticated approaches to computationally intensive Bayesian inference [ 29 ] that could be of use due to their generality . 3 . 2 . Influenza parameters and antiviral treatment Figure 2 shows the results for our influenza model given rate - 0 . 1 exponential priors on each parameter ( chosen not to influence the posterior significantly but to ensure that the small number of data points does not become problematic ) . This shows that the credible ranges of individual parameters are close to typical values in the literature—Baguelin et al . [ 8 ] , for example , consider scenarios with v [ ½ 0 : 5 , 10 (cid:2) and g [ ½ 0 : 5 , 2 : 5 (cid:2) . More importantly , however , the bimodal and highly corre - lated nature of the posterior distribution means that for some models of antiviral action it is not possible to make firm pre - dictions based on parameter values from challenge studies . time after onset ( days ) v i r a l l o a d ( l og tit r e ) 0 5 10 15 20 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 low viraemia data high viraemia data low viraemia model high viraemia model case fatality ratio p r ob a b ilit y d e n s it y 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 3 . 5 4 . 0 from shedding from outbreaks 0 5 10 ×10 4 0 1 2 0 5 0 0 . 5 1 . 0 0 5 0 5 10 15 0 5 0 5 10 15 0 5 0 2 4 6 8 0 5 0 20 40 0 5 0 20 40 60 0 . 2 0 . 4 0 . 6 0 . 8 2 4 6 0 0 . 5 1 0 5000 10000 0 0 . 5 1 0 5 10 15 0 0 . 5 1 0 5 10 15 0 0 . 5 1 0 2 4 6 8 0 0 . 5 1 0 20 40 0 0 . 5 1 0 20 40 60 2 6 10 14 2 4 6 2 6 10 14 0 . 2 0 . 4 0 . 6 0 . 8 0 10 20 0 1000 2000 3000 0 10 0 5 10 15 0 10 0 2 4 6 8 0 10 0 20 40 0 10 0 20 40 60 2 6 10 14 2 4 6 2 6 10 14 0 . 2 0 . 4 0 . 6 0 . 8 2 6 10 14 2 6 10 14 0 10 20 0 5000 10000 15000 0 10 0 2 4 6 8 0 10 0 20 40 0 10 0 20 40 60 2 4 6 2 4 6 2 4 6 0 . 2 0 . 4 0 . 6 0 . 8 2 4 6 2 6 10 14 2 4 6 2 6 10 14 0 5 10 0 5000 10000 15000 0 5 0 20 40 0 5 0 20 40 60 10 20 30 2 4 6 10 20 30 0 . 2 0 . 4 0 . 6 0 . 8 10 20 30 2 6 10 14 10 20 30 2 6 10 14 10 20 30 2 4 6 0 20 40 0 2000 4000 6000 0 20 40 0 20 40 60 20 40 60 2 4 6 20 40 60 0 . 2 0 . 4 0 . 6 0 . 8 20 40 60 2 6 10 14 20 40 60 2 6 10 14 20 40 60 2 4 6 20 40 60 10 20 30 0 50 100 0 5000 10000 ( c ) ( a ) ( b ) Figure 5 . Ebola results . ( a ) Point estimate and posterior predictive interval for shedding over time against data for different viraemia levels . ( b ) Case fatality ratio from shedding data against that obtained for outbreaks [ 42 ] . ( c ) Posterior as for influenza and norovirus , with the a th row / column corresponding to parameter u a . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 9 Figure 6 a , c , e shows the results of a quarantine - like intervention that is always effective after a delay , where the relationship between delay in antiviral administration and epidemic final size at constant R 0 is predictable to within a few percentage points , although there is much greater uncertainty in the peak prevalence . Figure 6 b , d , f shows an antiviral - like interven - tion that is only effective if administered during the latent period , meaning the absolute uncertainty in final size can be almost 50 % and the relative uncertainty in peak prevalence can amount to a factor of four or more . 3 . 3 . Norovirus parameters and seasonality Figure 3 shows the results for our norovirus model ; given the large amount of data we use improper priors and see that the credible ranges of individual norovirus parameters are also close to typical values in the literature ; e . g . Simmons et al . [ 13 ] take v ¼ 1 and g ¼ 0 . 5 . Figure 7 shows that the impact of this uncertainty ( for other parameter values as given above ) is mainly seen in the height ( with peak prevalence differing by a factor of 3 or more ) and timing within the year of seasonal epidemics . For the chaotic / irregular scenario ( figure 7 b ) however , the overall epidemic dynamics are subject to significant uncertainty . For - tunately , conditioned on knowing that epidemics are regular and annual and with a particular peak , the broad impact of a vaccine policy can be predicted as shown in figure 7 e . 3 . 4 . Ebola parameters and case fatality ratio Figure 5 shows the results obtained for our Ebola model . The point estimates and 95 % CIs of mean infections period come out at 5 . 3 [ 3 . 3 , 7 . 4 ] days for low - viraemia cases and 6 . 8 [ 5 . 1 , 10 . 1 ] days for high - viraemia cases , which are reasonable values [ 20 ] . Figure 5 a shows that the model produces shed - ding output that is consistent with the data , and figure 5 b delay ( days ) e p i d e m i c f i n a l s i ze ( p e r ce n t a g e o f popu l a ti on ) 5 0 2 4 6 8 10 delay ( days ) 0 2 4 6 8 10 10 15 20 25 30 35 40 45 50 5 10 15 20 25 30 35 40 45 50 i n f ec ti ou s ca s e s ( p e r ce n t a g e o f popu l a ti on ) 0 . 5 50 100 150 200 50 100 150 time since start of epidemic ( days ) 0 200 50 100 200 150 0 250 50 100 200 150 0 250 1 . 0 1 . 5 2 . 0 2 . 5 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 3 . 5 4 . 0 r ec ov e r e d ca s e s ( p e r ce n t a g e o f popu l a ti on ) 5 10 15 20 25 30 35 40 45 time since start of epidemic ( days ) time since start of epidemic ( days ) time since start of epidemic ( days ) 5 10 15 20 25 30 35 40 45 50 ( a ) ( b ) ( c ) ( d ) ( e ) ( f ) Figure 6 . Interventions administered after a constant delay against influenza given parameter uncertainty . ( a , c , e ) Assuming that the intervention always stops transmission . ( b , d , f ) Assuming that the intervention only stops transmission if the individual has not yet become infectious . ( a , b ) Final sizes for a range of inter - vention delays . Plots of infection ( c , d ) and recovery ( e , f ) time series are shown for delay d ¼ 6 ( c , e ) and d ¼ 4 . 5 ( d , f ) . Intensity of shading is proportional to probability 0 . 1 to render features visible in regions with large uncertainty . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 10 compares the posterior for the case fatality ratio obtained from shedding data to the one obtained from known out - comes of previous outbreaks [ 42 ] , again suggesting that the model outcome is reasonable but that uncertainties are very large . 4 . Discussion In summary , we have shown that it is possible to use modern Bayesian MCMC methods , based on derivatives of the log - likelihood and information geometry , to make a full uncertainty quantification of epidemiological parameters fitted to human viral shedding data . We have performed our analysis for two of the most prevalent pathogens : influ - enza and norovirus , as well as for Ebola , a highly virulent zoonotic disease . Shedding data allow disease ‘natural history’ parameters to be fitted ; these usually need to be combined with popu - lation - level measurements such as the basic reproductive ratio R 0 to specify policy - relevant models fully . Our results show that the epidemiological consequences of uncertainty 0 . 5 1 . 0 1 . 5 2 . 0 0 1 2 3 4 5 6 7 8 ×10 6 ×10 6 ×10 6 ×10 6 ×10 6 p r e v a l e n ce time ( years ) time ( years ) time ( years ) time ( years ) 2 4 6 8 10 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 3 . 5 4 . 0 0 . 5 1 . 0 1 . 5 2 . 0 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 p r e v a l e n ce 1 2 3 4 5 6 0 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 3 . 0 3 . 5 4 . 0 time post - vaccine ( years ) p r e v a l e n ce 0 – 5 0 5 10 15 20 25 30 1 2 3 4 5 6 7 8 ( e ) ( b ) ( a ) ( c ) ( d ) Figure 7 . Implications of uncertainty in norovirus shedding for long - term temporal behaviour . Deterministic ODE trajectories are shown for 50 different posterior samples with two randomly chosen ones highlighted in red and blue . ( a ) R 0 ¼ 1 . 8 , T L ¼ 6 months shows regular annual oscillations . ( b ) R 0 ¼ 1 . 8 , T L ¼ 60 months shows irregular / chaotic behaviour . ( c ) R 0 ¼ 4 , T L ¼ 6 months shows annual oscillation but not well - defined epidemics . ( d ) R 0 ¼ 4 , T L ¼ 60 months shows bi - annual oscillation but with variable peak heights . ( e ) Time series for parameters as in plot ( a ) given vaccination at birth with 90 % efficacy . r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 11 in natural history parameters can often be highly significant since these are important for interventions such as reducing transmission through quarantine or medication , as well as prediction of long - term disease behaviour and clinical out - comes . Natural history parameters also strongly affect other aspects of infectious disease epidemiology such as outbreak reconstruction and we would expect similarly strong effects in these contexts . To make progress , we have had to base our analysis on simplifying assumptions that we would hope can be relaxed in future work as the field develops . One example is that the simple likelihood functions ( 2 . 18 ) and ( 2 . 17 ) assume indepen - dence that could be extended to include more general functional relationships , which would be particularly impor - tant if the methodology were extended to diseases such as human immunodeficiency virus where there are very differ - ent time scales involved in passing between compartments [ 43 ] . In such an example , one might wish to consider more general models , for example , ones in which the progression between the latent , infectious and removed classes is gov - erned by more general distributions than those we have considered here . Provided the Laplace transformations of the probability density functions for these distributions are available , then expressions for L and its derivatives with respect to the parameters can be obtained via the convolution theorem , although this can result in a computationally inten - sive likelihood function . Alternatively , it might be possible to approximate the derivatives since inaccuracies in any such approximation will lead to algorithmic inefficiency rather than bias . An additional assumption we have made is that the parameters we are not fitting ( for example , the basic repro - ductive ratio R 0 ) are fixed . This is particularly important to relax if multiple data sources are to be used in a principled way in infectious disease modelling for public health [ 2 ] . In particular , the measurements at the population level required to estimate R 0 are likely to carry their own uncertainty , which can be combined with our uncertainty quantification for dis - ease natural history parameters as the next step towards systematic evidence synthesis for infectious diseases . Competing interests . We declare we have no competing interests . Funding . Work funded by the UK Engineering and Physical Sciences Research Council ( refs EP / J016934 / 2 and EP / L001950 / 1 ) . References 1 . Heesterbeek H et al . 2015 Modeling infectious disease dynamics in the complex landscape of global health . Science 347 , aaa4339 . ( doi : 10 . 1126 / science . aaa4339 ) 2 . Angelis DD , Presanis AM , Birrell PJ , Tomba GS , House T . 2015 Four key challenges in infectious disease modelling using data from multiple sources . Epidemics 10 , 83 – 87 . ( doi : 10 . 1016 / j . epidem . 2014 . 09 . 004 ) 3 . Keeling MJ , Rohani P . 2007 Modeling infectious diseases in humans and animals . Princeton , NJ : Princeton University Press . 4 . Diekmann O , Heesterbeek H , Britton T . 2013 Mathematical tools for understanding infectious diseases dynamics . Princeton , NJ : Princeton University Press . 5 . Pellis L , Spencer SEF , House T . 2015 Real - time growth rate for general stochastic SIR epidemics on unclustered networks . Math . Biosci . 265 , 65 – 81 . ( doi : 10 . 1016 / j . mbs . 2015 . 04 . 006 ) 6 . Fraser C , Riley S , Anderson RM , Ferguson NM . 2004 Factors that make an infectious disease outbreak controllable . Proc . Natl Acad . Sci . USA 101 , 6146 – 6151 . ( doi : 10 . 1073 / pnas . 0307506101 ) 7 . Lessler J , Reich NG , Brookmeyer R , Perl TM , Nelson KE , Cummings DA . 2009 Incubation periods of acute respiratory viral infections : a systematic review . Lancet Infect . Dis . 9 , 291 – 300 . ( doi : 10 . 1016 / S1473 - 3099 ( 09 ) 70069 - 6 ) 8 . Baguelin M , Hoek AJV , Jit M , Flasche S , White PJ , Edmunds WJ . 2010 Vaccination against pandemic influenza A / H1N1v in England : a real - time economic evaluation . Vaccine 28 , 2370 – 2384 . ( doi : 10 . 1016 / j . vaccine . 2010 . 01 . 002 ) 9 . Gani R , Hughes H , Fleming D , Griffin T , Medlock J , Leach S . 2005 Antiviral therapy and hospitalization estimates during possible influenza pandemic . Emerg . Infect . Dis . 11 , 1355 – 1362 . ( doi : 10 . 3201 / eid1109 . 041344 ) 10 . Muthuri SG et al . 2014 Effectiveness of neuraminidase inhibitors in reducing mortality in patients admitted to hospital with influenza A ( H1N1pdm09 ) virus infection : a meta - analysis of individual participant data . Lancet Respir . Med . 2 , 395 – 404 . ( doi : 10 . 1016 / S2213 - 2600 ( 14 ) 70041 - 4 ) 11 . Hollingsworth TD , Klinkenberg D , Heesterbeek H , Anderson RM . 2011 Mitigation strategies for pandemic influenza A : balancing conflicting policy objectives . PLoS Comput . Biol . 7 , e1001076 . ( doi : 10 . 1371 / journal . pcbi . 1001076 ) 12 . Cauchemez S , Ferguson NM , Wachtel C , Tegnell A , Saour G , Duncan B , Nicoll A . 2009 Closure of schools during an influenza pandemic . Lancet Infect . Dis . 9 , 473 – 481 . ( doi : 10 . 1016 / S1473 - 3099 ( 09 ) 70176 - 8 ) 13 . Simmons K , Gambhir M , Leon J , Lopman B . 2013 Duration of immunity to norovirus gastroenteritis . Emerg . Infect . Dis . 19 , 1260 – 1267 . ( doi : 10 . 3201 / eid1908 . 130472 ) 14 . Earn DJD , Rohani P , Bolker BM , Grenfell BT . 2000 A simple model for complex dynamical transitions in epidemics . Science 287 , 667 – 670 . ( doi : 10 . 1126 / science . 287 . 5453 . 667 ) 15 . Hens N , Ayele G , Goeyvaerts N , Aerts M , Mossong J , Edmunds J , Beutels P . 2009 Estimating the impact of school closure on social mixing behaviour and the transmission of close contact infections in eight European countries . BMC Infect . Dis . 9 , 187 . ( doi : 10 . 1186 / 1471 - 2334 - 9 - 187 ) 16 . Eames KTD , Tilston NL , Edmunds WJ . 2011 The impact of school holidays on the social mixing patterns of school children . Epidemics 3 , 103 – 108 . ( doi : 10 . 1016 / j . epidem . 2011 . 03 . 003 ) 17 . Bacae¨r N , Ouifki R . 2007 Growth rate and basic reproduction number for population models with a simple periodic factor . Math . Biosci . 210 , 647 – 658 . ( doi : 10 . 1016 / j . mbs . 2007 . 07 . 005 ) 18 . Vinje´ J . 2010 A norovirus vaccine on the horizon ? J . Infect . Dis . 202 , 1623 – 1625 . ( doi : 10 . 1086 / 657088 ) 19 . Camacho A et al . 2015 Temporal changes in Ebola transmission in Sierra Leone and implications for control requirements : a real - time modelling study . PLoS Curr . Outbreaks 7 . ( doi : 10 . 1371 / currents . outbreaks . 406ae55e83ec0b5193e30856b9235ed2 ) 20 . WHO Ebola Response Team . 2016 Ebola virus disease among male and female persons in West Africa . New Engl . J . Med . 374 , 96 – 98 . ( doi : 10 . 1056 / NEJMc1510305 ) 21 . Ksiazek TG et al . 1999 Clinical virology of Ebola hemorrhagic fever ( EHF ) : virus , virus antigen , and IgG and IgM antibody findings among EHF patients in Kikwit , Democratic Republic of the Congo , 1995 . J . Infect . Dis . 179 ( Suppl . 1 ) , S177 – S187 . ( doi : 10 . 1086 / 514321 ) 22 . Pitzer VE , Leung GM , Lipsitch M . 2007 Estimating variability in the transmission of severe acute respiratory syndrome to household contacts in Hong Kong , China . Am . J . Epidemiol . 166 , 355 – 363 . ( doi : 10 . 1093 / aje / kwm082 ) 23 . Charleston B et al . 2011 Relationship between clinical signs and transmission of an infectious disease and the implications for control . Science 332 , 726 – 729 . ( doi : 10 . 1126 / science . 1199884 ) 24 . Carrat F , Vergu E , Ferguson NM , Lemaitre M , Cauchemez S , Leach S , Valleron AJ . 2008 Time lines of infection and disease in human influenza : a review r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 12 of volunteer challenge studies . Am . J . Epidemiol . 167 , 775 – 785 . ( doi : 10 . 1093 / aje / kwm375 ) 25 . AtmarRL , OpekunAR , GilgerMA , EstesMK , CrawfordSE , Neill FH , Graham DY . 2008 Norwalk virus shedding after experimental human infection . Emerg . Infect . Dis . 14 , 15531557 . ( doi : 10 . 3201 / eid1410 . 080117 ) 26 . Acton FS . 1970 Numerical methods that work . New York , NY : Harper & Row . 27 . Pereyra V , Scherer G . 2010 Exponential data fitting and its applications . Sharjah , United Arab Emirates : Bentham eBooks . 28 . Gilks WR , Richardson S , Spiegelhalter DJ . 1995 Markov chain Monte Carlo in practice . London , UK : Chapman and Hall . 29 . Brooks S , Gelman A , Jones GL , Meng X - L ( eds ) . 2011 Handbook of Markov chain Monte Carlo . Boca Raton , FL : CRC Press . 30 . Metropolis N , Rosenbluth AW , Rosenbluth MN , Teller AH , Teller E . 1953 Equation of state calculations by fast computing machines . J . Chem . Phys . 21 , 1087 – 1092 . ( doi : 10 . 1063 / 1 . 1699114 ) 31 . Hastings WK . 1970 Monte Carlo sampling methods using Markov chains and their applications . Biometrika 57 , 97 – 109 . ( doi : 10 . 1093 / biomet / 57 . 1 . 97 ) 32 . Roberts GO , Rosenthal JS . 2009 Examples of adaptive MCMC . J . Comput . Graphical Stat . 18 , 349 – 367 . ( doi : 10 . 1198 / jcgs . 2009 . 06134 ) 33 . Roberts GO , Tweedie RL . 1996 Exponential convergence of Langevin distributions and their discrete approximations . Bernoulli 2 , 341 – 363 . ( doi : 10 . 2307 / 3318418 ) 34 . Duane S , Kennedy A , Pendleton BJ , Roweth D . 1987 Hybrid Monte Carlo . Phys . Lett . B 195 , 216 – 222 . ( doi : 10 . 1016 / 0370 - 2693 ( 87 ) 91197 - X ) 35 . Neal RM . 2011 MCMC using Hamiltonian dynamics . In Handbook of Markov chain Monte Carlo ( eds S Brooks , A Gelman , GL Jones , X - L Meng ) , pp . 113 – 162 . Boca Raton , FL : CRC Press . 36 . Girolami M , Calderhead B . 2011 Riemann manifold Langevin and Hamiltonian Monte Carlo methods . J . R . Stat . Soc . B 73 , 123 – 214 . ( doi : 10 . 1111 / j . 1467 - 9868 . 2010 . 00765 . x ) 37 . Betancourt M . 2013 A general metric for Riemannian manifold Hamiltonian Monte Carlo . In Geometric science of information ( eds F Nielsen , F Barbaresco ) . Lecture Notes in Computer Science , vol . 8085 , pp . 327 – 334 . Berlin , Germany : Springer . ( doi : 10 . 1007 / 978 - 3 - 642 - 40020 - 9 _ 35 ) 38 . Calderhead B , Girolami M . 2011 Statistical analysis of nonlinear dynamical systems using differential geometric sampling methods . Interface Focus 1 , 821 – 835 . ( doi : 10 . 1098 / rsfs . 2011 . 0051 ) 39 . Kramer A , Calderhead B , Radde N . 2014 Hamiltonian Monte Carlo methods for efficient parameter estimation in steady state dynamical systems . BMC Bioinform . 15 , 253 . ( doi : 10 . 1186 / 1471 - 2105 - 15 - 253 ) 40 . Lan S , Stathopoulos V , Shahbaba B , Girolami M . 2014 Markov chain Monte Carlo from Lagrangian dynamics . J . Comput . Graph . Stat . 24 , 357 – 378 . ( doi : 10 . 1080 / 10618600 . 2014 . 902764 ) 41 . Lan S , Streets J , Shahbaba B . 2014 Wormhole Hamiltonian Monte Carlo . In Proc . 28th AAAI Conf . on Artificial Intelligence , Quebec City , Canada , 27 – 31 July 2014 , pp . 1953 – 1959 . 42 . House T . 2014 Epidemiological dynamics of Ebola outbreaks . eLife 3 , e03908 . ( doi : 10 . 7554 / eLife . 03908 ) 43 . Fraser C , Hollingsworth TD , Chapman R , de Wolf F , Hanage WP . 2007 Variation in HIV - 1 set - point viral load : epidemiological analysis and an evolutionary hypothesis . Proc . Natl Acad . Sci . USA 104 , 17 441 – 17 446 . ( doi : 10 . 1073 / pnas . 0708559104 ) r s i f . r o y a l s o c i e t y pub l i s h i ng . o r g J . R . S o c . I n t e r f a c e 13 : 20160279 13
Intelligent Light Control using Sensor Networks Vipul Singhvi Civil Engineering Dept . Carnegie Mellon University Andreas Krause Computer Science Dept . Carnegie Mellon University Carlos Guestrin Center for Automated Learning & Discovery Carnegie Mellon University James H . Garrett Jr . Civil Engineering Dept . Carnegie Mellon University H . Scott Matthews Civil Engineering Dept . Carnegie Mellon University ABSTRACT Increasing user comfort and reducing operation costs have always been two primary objectives of building operations and control strategies . Current building control strategies are unable to incorporate occupant level comfort and meet the operation goals simultaneously . In this paper , we present a novel utility - based building control strategy that optimizes the tradeoﬀ between meeting user comfort and reduction in operation cost by reducing energy usage . We present an implementation of the proposed approach as an intelligent lighting control strategy that signiﬁcantly reduces energy cost . Our approach is based on a principled , decision the - oretic formulation of the control task . We demonstrate the use of mobile wireless sensor networks to optimize the trade - oﬀ between fulﬁlling diﬀerent occupants’ light preferences and minimizing energy consumption . We further extend our approach to optimally exploit external light sources for additional energy savings , a process called daylight harvest - ing . Also we demonstrate that an active sensing approach can maximize the mobile sensor network’s lifetime by sens - ing only during most informative situations . We provide eﬃcient algorithms for solving the underlying complex op - timization problems , and extensively evaluate our proposed approach in a proof - of - concept testbed using MICA2 motes and dimmable lamps . Our results indicate a signiﬁcant im - provement in user utility and reduced energy expenditure . Categories and Subject Descriptors : C . 3 [ Special - purpose and application - based systems ] : Real - time and embedded systems ; G . 3 [ Probability and Statistics ] : Experimental design , Markov processes ; I . 2 . 11 [ Artiﬁcial Intelligence ] : Distributed Artiﬁcial Intelligence - Intelli - gent Agents ; J . 2 [ Physical Science and Engineering ] : Engineering ; J . 5 [ Arts and Humanities ] : Architecture General Terms : Algorithms , Management , Measurement , Performance , Design , Experimentation , Veriﬁcation . Keywords : Sensor Networks , Light Control , Intelligent Buildings , Active Sensing . Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for proﬁt or commercial advantage and that copies bear this notice and the full citation on the ﬁrst page . To copy otherwise , to republish , to post on servers or to redistribute to lists , requires prior speciﬁc permission and / or a fee . SenSys’05 , November 2 – 4 , 2005 , San Diego , California , USA . Copyright 2005 ACM 1 - 59593 - 054 - X / 05 / 0011 . . . $ 5 . 00 . 1 . INTRODUCTION Increasing user comfort and reducing energy costs have always been two primary objectives of intelligent buildings [ 32 , 15 ] . Typically the trade - oﬀ between meeting user pref - erences for indoor environmental condition and reduction in energy usage leads to a diﬃcult optimization problem . This optimization task becomes more complex as occupants have diﬀerent preferences over the the state of the indoor environ - ment and these preferences change with time . For example , people prefer diﬀerent light levels , even when performing the same task . In addition , the state and usage of the indoor en - vironment changes over time , e . g . , due to to changing levels of sunlight and tasks being performed by users . 1 . 1 Current energy centric strategies The present generation of intelligent buildings aims to uti - lize computer technology to autonomously govern the build - ing environment and try to optimize user comfort , energy consumption , safety and monitoring - functions [ 35 ] . Signiﬁ - cant progress has been made in integrating advanced com - puter science concepts in developing building control strate - gies [ 7 , 22 ] . The current control strategies can actively adapt to the changing outdoor or indoor environment of the build - ing , which amounts to signiﬁcant energy cost savings . How - ever , these control strategies are often unable to adapt to the requirements at the occupant level due to limited knowledge about occupants’ preferences and the state of their imme - diate environment . This leads to uncomfortable work envi - ronments , sick building syndrome and various other work re - lated diseases [ 38 ] . In most commercial buildings , the cost of salaries and beneﬁts exceeds energy , maintenance , and annu - alized construction costs or rent , by approximately a factor of 100 [ 37 , 31 ] . Estimates for the United States show po - tential annual savings and productivity gains from improved indoor environments are about $ 10 to $ 30 billion from re - duced sick building syndrome symptoms , and $ 20 to $ 160 billion from direct improvements in occupant performance that are unrelated to health [ 14 ] . These facts highlight sig - niﬁcant problems in selecting building control strategies that focus only on energy concerns , while not addressing occu - pant preferences . 1 . 2 Current occupant centric strategies There are various standards available that recommend certain levels for various indoor parameters [ 3 ] , including lighting , heating , etc . However , they fail to capture the per - sonal preferences that an individual might have and thus provide a gross approximation of occupant needs . Address - ing the desire of increasing occupant productivity , many new buildings are now equipped with Personal Environment Modules ( PEMs ) [ 4 ] . The goal of providing PEMs is to en - able occupants to control their own environment . This often can lead to conﬂicts as occupants have diﬀerent preferences for various environmental parameters such as light levels . Studies have shown that people tend not to use the personal control modules if they perceive conﬂict with the other oc - cupants sharing their workspace [ 28 ] . This kind of behavior is common in commercial buildings with open space plans . Also , providing occupants with the entire control leaves few options for the building operator whose goal is to eﬃciently manage energy usage . As a result the overall beneﬁts in building operation are decreased . 1 . 3 Our approach : An optimal trade - off There is thus a trade - oﬀ in beneﬁts , choosing between an energy eﬃcient and a user - centered control strategy . Typi - cally these two strategies are seen as two ends of the avail - able control strategy spectrum . These opposing interests indicate that there is a need for a bilateral or user medi - ated central control strategy , which ﬁts in the middle of the control strategy spectrum . Such a control strategy would in - tegrate occupants’ preferences , the state of their immediate indoor and outdoor environment and the operation goals , in terms of reduction in energy usage . The challenges to develop such a balanced control strategy are threefold : First , to identify the preferences of individual occupants in indoor environments continuously , as prefer - ences change over time and with the location in the build - ing . The second challenge is to gather information about the immediate indoor and outdoor environment of the oc - cupants . The third challenge is to optimize the trade - oﬀ between meeting occupants preferences and reducing energy usage . To address these challenges , we present a building con - trol strategy based on a principled , decision theoretic for - mulation of the complex optimization task . Our control strategy integrates individual occupants’ preferences and the real state of indoor and outdoor environment through a net - work of wireless sensors . The control strategies quantify the trade - oﬀ between meeting occupant preferences and the cor - responding energy utilization . We present an implementa - tion of the control strategy as an intelligent lighting system . Our intelligent lighting system adapts to occupant prefer - ences , trading - oﬀ energy consumption with user satisfaction . Additionally , we optimally exploit external light sources in a process called daylight harvesting , to signiﬁcantly reduce energy usage . We address the issue of sustaining long - term deployment of wireless sensors by developing active sensing algorithms that exploit the correlation in the natural light intensity and signiﬁcantly increase the lifetime of the sen - sors . 1 . 4 Contributions In this paper , we provide the following contributions to the complex problem described above . • We provide a principled , decision theoretic basis for intelligent light management . • We present an eﬃcient coordinated illumination al - gorithm for optimizing the trade - oﬀ between meeting user preferences and reducing energy consumption . • Additionally , we extend our method to optimally ex - ploit external light sources . This daylight harvesting strategy signiﬁcantly reduces energy usage . • We propose an active sensing strategy which exploits spatial and temporal correlation in natural light inten - sity to schedule sensing . Our results indicate a drastic decrease in the amount of sensing necessary per day . This leads to a signiﬁcant increase in battery lifetime of the deployed sensors . • Furthermore , we extend our methods to adapt to the dynamics of moving occupants of the building . This extension uses probabilistic models for movement which naturally ﬁt into our decision theoretic framework . • All our proposed novel methods are extensively eval - uated in an actual deployed testbed . In addition to the empirical evaluation provided in this paper , we created videos demonstrating the performance of our system . These videos are accessible at the website : www . cs . cmu . edu / ∼ guestrin / Publications / SenSys05 . 2 . COORDINATED ILLUMINATION Lighting is a major factor aﬀecting both occupants’ com - fort and energy costs in a building . With a total area of 12 billion square feet , U . S . oﬃce buildings use over 86 bil - lion kWh for lighting each year . At the 2003 U . S . average energy cost of $ 0 . 08 per kWh , the potential savings from implementing energy eﬃcient lighting in 50 % of oﬃce build - ing is more than $ 2 . 1 billion each year [ 10 ] . However , at the same time , energy eﬃcient lighting is typically associ - ated with reduced lighting which can aﬀect the productivity of the occupants . Reduced productivity and costs incurred due to loss of work can outweigh energy savings . Many commercial buildings have installed intelligent light controls that enable occupants to adjust levels according to their preferences . However , research has shown that occu - pants avoid using such controls if they perceive conﬂict with other occupants [ 28 ] . This is the case in many commercial oﬃces with open ﬂoor plans . Achieving occupants’ light preferences and reducing energy usage requires solving a multi - criterion optimization problem for which the complex - ity grows exponentially with the number of light ﬁxtures . Fortunately , we can exploit architectural design principle to solve the optimization problems eﬃciently and optimally . The key concept we will utilize is zoning : the process of dividing the ﬂoor plan in smaller zones which have separate light controls . However , in open ﬂoor plans it is diﬃcult to separate the eﬀect of a light source in one zone from the adjacent zones . This leads to a situation where a single light source aﬀects multiple zones , making it diﬃcult to ﬁnd a mutually acceptable setting across adjacent zones . In this section , we present a coordinated illumination ap - proach , which exploits the zoning concept , in lighting system design , to solve the described multi - criterion trade - oﬀ prob - lem optimally and eﬃciently . We ﬁrst formalize the control strategy in a decision theoretic way . We then propose an eﬃcient algorithm for solving the arising optimization prob - lem , and evaluate the proposed method using our testbed . 2 . 1 Problem deﬁnition Typically , building occupants prefer environmental condi - tions in which they are more productive than the conditions in which they feel uncomfortable . We capture this pref - erences ordering by representing them as utility functions , 0 100 200 300 400 500 0 0 . 2 0 . 4 0 . 6 0 . 8 1 Light intensity ( Lux ) N o r m a li z ed u s e r u t ili t y ( a ) Utility function ( b ) Zoning scheme Figure 1 : Utility function , zoning / locality concept . which can be diﬀerent for each occupant . Higher utility function value means higher satisfaction for the occupant . In our formulation , each building occupant i has a utility function Φ i ( x i , a ) , representing their preference at a given location x i for a given light setting a , where a = ( a 1 , . . . , a m ) is a vector specifying settings for each lamp . For example , a particular setting a will lead to a particular light inten - sity at position x i , Φ i will indicate how happy the i th user is with this light intensity . Specifying this utility function , thus , requires us to learn a mapping from lamp settings a to Lux levels at each location x i . We learn such mappings from data using standard techniques , as described in Section 2 . 3 . More generally , the utility function may depend on other considerations that aﬀect user comfort , such as glare , even - ness of light , and so on . A building has multiple occupants with varying prefer - ences and hence with varying utility functions Φ 1 , . . . , Φ n . When considering only user satisfaction , our objective is to ﬁnd the joint setting a of the lamps that maximizes the sum of the values of the utility functions of the occupants that are being aﬀected by those lamp settings : argmax a n X i = 1 Φ i ( a , x i ) . In some applications , the preferences of some users may be weighed higher than others . This simple formulation , however , does not consider en - ergy costs . To address this issue , we deﬁne the building operator utility function Ψ , which decreases monotonically with the amount of energy expended . We must thus trade - oﬀ operator utility Ψ with user utilities P ni = 1 Φ i . A common technique for solving such multi - criterion optimization prob - lems is scalarization [ 8 ] : A new objective value is computed as a linear combination of the individual objective functions . In this setting , the scalarized total utility is deﬁned as U ( a , x ) = n X i = 1 Φ i ( a , x i ) + γ Ψ ( a ) , where γ is the scalarization , or trade - oﬀ , parameter regu - lating the penalty for high energy expenditure , and x = ( x 1 , . . . , x n ) is the vector of occupant locations . For a ﬁxed vector of locations x , the optimal deterministic control strat - egy is to maximize a ∗ = argmax a U ( a , x ) . ( 1 ) We initially address the static case where x is assumed to be known and constant . This assumption is relaxed in Section 5 . We furthermore assume that the lamps can be actuated within a discrete set of d distinct settings . Hence , the maximum utility in ( 1 ) is only over a ﬁnite set of d m val - ues . Note that this quantity is exponential in the number m of lamps , and enumeration of all possible settings is infeasi - ble – in our experimental setup , we deployed m = 10 lamps , with d = 10 settings each , which is already beyond scope of enumeration . Even if the total utility function is concave , we are dealing with a discrete optimization problem , and any continuous solution would only be an approximation . 2 . 2 An efﬁcient algorithm A simple heuristic for optimizing light settings – corre - sponding to greedy interactions of occupants with building light systems – would be to , for some ﬁxed order , iterate over the building occupants and have each of them adjust the light settings to maximize their own comfort . Unfortu - nately , since the preferences of the occupants are not con - sidered simultaneously , this greedy approach is suboptimal . Fortunately , we are not required to rely on such heuris - tics : we can use locality , or zoning , in our problem struc - ture to solve the discrete optimization problem eﬃciently and exactly . The key observation is , due to the use of the zoning concept in lighting design , a lamp only inﬂuences occupants in the small area of space around it . For exam - ple , in Fig . 1 ( b ) L 6 only aﬀects the occupant represented by his utility function Φ 4 , whereas L 3 has a larger inﬂuence and aﬀects occupants 1 , 2 and 3 represented by their util - ity function Φ 1 , Φ 2 and Φ 3 respectively . Hence , we utilize the fact that the occupants’ utility functions Φ i only depend on a smaller subset of lamps , which drastically reduces the complexity of the problem . Additionally , the operator’s utility Ψ is also local , repre - sented as a sum of costs of actuating the individual lamps , i . e . , Ψ ( a ) = m X j = 1 Ψ j ( a j ) , Using locality , we rewrite ( 1 ) as a ∗ ( x ) = argmax a n X i = 1 Φ i , x ( a i 1 , . . . , a i k ) + γ m X j = 1 Ψ j ( a j ) . ( 2 ) where i 1 , . . . , i k refer to the lamps that inﬂuence the util - ity of occupant i . To make this notation more explicit , we write Φ i , x i ( a i 1 , . . . , a i k ) instead of Φ i ( a , x i ) to indicate the dependencies of Φ i on the light level x i at location i . We thus observe that ( 2 ) requires the maximization of a sum of local factors , each of which depends only on a small number of variables , i . e . , on the setting of only a small sub - set of the lamps . We exploit this locality by using the co - ordination methodology developed in [ 6 , 19 ] to obtain the Input : Local factors F i , . . . , F k , elimination ordering { i 1 , . . . , i m } Output : Optimal action selection a beginfor j = 1 to m do select all factors depending on A i j , let D j ∪ dom A i j be the union of their domains and let G j be their sum ; foreach d ∈ D j do compute E j ( d ) = max a ij G j ( a i j , d ) ; compute ˆ E j ( d ) = argmax a ij G j ( a i j , d ) ; end replace all factors depending on A i j by E j . endfor j = m downto 1 do Let a i j : = ˆ E j ( a i j + 1 , . . . , a i m ) . end end Algorithm 1 : Optimal action selection . optimal setting for the lights . The coordination methodol - ogy maximizes the sum of the utility function of the occu - pants by minimally violating the occupant preferences rep - resented by individual utility functions . Consider the follow - ing example where We want to maximize F ( y 1 , y 2 , y 3 , y 4 ) = F 1 ( y 1 , y 2 ) + F 2 ( y 1 , y 3 ) + F 3 ( y 3 , y 4 ) + F 4 ( y 2 , y 4 ) . F 1 and F 2 do not depend on the value of y 4 , hence we can “push the maximization with respect to y 4 through the sum” and write max y F ( y ) = max y 1 , y 2 , y 3 ( F 1 ( y 1 , y 2 ) + F 2 ( y 1 , y 3 ) + max y 4 F 3 ( y 3 , y 4 ) + F 4 ( y 2 , y 4 ) (cid:19) . For any value of y 2 , y 3 , the maximization over y 4 can be car - ried out independently of the value of y 1 . Letting E ( y 2 , y 3 ) : = max y 4 F 3 ( y 3 , y 4 ) + F 4 ( y 2 , y 4 ) , we ﬁnd max y F ( y ) = max y 1 , y 2 , y 3 F 1 ( y 1 , y 2 ) + F 2 ( y 1 , y 3 ) + E ( y 2 , y 3 ) , from which y 4 has been “eliminated” . This process is re - peated , eliminating the variables y i one at a time . The values of y 1 , y 2 , y 3 , y 4 maximizing F can be recovered by computing and plugging in the partial solutions in reverse order . Note that for this example , only a maximization over three variables had to be carried out by enumeration , not over four . In the general case , the maximal domain size of the local factors ( as F 1 , F 2 ) and intermediate factors ( as E in the above example ) , called the treewidth , depends on the order in which variables are eliminated . Picking the optimal elimination ordering is NP - complete [ 2 ] . Fortunately , there is a large literature [ 5 , 23 , 24 ] on heuristics for ﬁnding good elimination orderings , of which we expect many to apply to the locality exhibited by a typical building . Fig . 1 ( b ) indicates the structure for our testbed . Here , the treewidth is three . Hence the exact optimization can be car - ried out in order 10 3 steps instead of 10 10 required by naive enumeration . The algorithm is presented as Algorithm 1 . 2 . 3 Evaluation of our algorithm We created a testbed to emulate the real situation at a smaller scale to test our light control strategy . Our testbed consists of twelve MICA2 motes [ 36 ] and ten 60 Watt table 0 100 200 300 400 500 0 0 . 2 0 . 4 0 . 6 0 . 8 1 Light intensity ( Lux ) N o r m a li z ed u s e r u t ili t y 1 3 2 4 5 ( a ) Utility functions 500 600 700 800 900 0 200 400 600 800 1000 ADC Values Lu x ( b ) ADC - Lux conversion Figure 2 : Testbed characteristics . lamps , arranged on a 146 inches by 30 inches table . The lamps are actuated by the X10 system [ 39 ] , which wirelessly communicates with a single desktop PC , and uses power lines for controlling the lamps . Each lamp can be actuated to produce ten diﬀerent light intensities . The lamps are arranged in a triangular pattern which corresponds to the zoning concept as introduced in Section 2 . Each of the seven triangular zones is aﬀected by three lamps , and each lamp aﬀects up to three regions . The motes are distributed over the diﬀerent zones , and communicate with the base station over the wireless network . An important aspect of the evaluation is the reliable pre - diction of the light levels in each zone , for each combination of lamp settings . We used TinyDB [ 1 ] to query the sen - sor values for various lamp settings . To calibrate sensors ( convert the raw ADC to Lux ) , an external light meter [ 27 ] was used to measure ground truth Lux levels at varios lo - cations . Piecewise linear regression on a log - scale was then used to calibrate the sensors . Fig . 2 ( b ) shows how the ADC responses varied over the diﬀerent motes . Once the sensors are calibrated , we need to determine how light settings aﬀect light intensities in each zone . Note that each zone is aﬀected by multiple lamps , thus , a naive approach would require us to search through all possible combinations of settings for all lamps for each location . For - tunately , since light intensities in Lux are additive , not all possible combinations of lamp settings have to be consid - ered . We , thus , learn how each lamp aﬀects a region , and the combined eﬀect is simply the sum of the intensity generated by each lamp . In order to determine power consumption , we measured the amount of power required by the lamp for each setting using a power meter . Power consumption scales approximately linearly with the ten discrete lamp settings . Since we want to optimize user comfort , we needed to se - lect a functional form for the user utility functions . We chose simple Gaussian kernels with varying centers and bandwidths for the diﬀerent occupants , each represented by a mote . Fig . 2 ( a ) presents the variety of utility functions we chose . The bell shape of the Gaussian kernel corresponds to the assumption that each user has a particular light intensity which is most comfortable ; exceeding or falling short of the appropriate value will decrease the comfort . The choice in diﬀerent bandwidths corresponds to the idea that some oc - cupants can work well under a larger variety of conditions than others . We understand that the problem of eliciting ap - propriate utility functions is a diﬃcult problem of its own . However , we believe that our particular choices of utility functions represents a variety of diﬀerent preferences , which we expect to at least qualitatively correspond to real occu - pants’ needs . Our optimization method does not make any assumption about the form of these utility functions . 0 0 . 5 1 −5 0 5 10 Trade−off parameter gamma T o t a l u t ili t y Coordinated illumination Greedyheuristic ( a ) Setup 1 0 0 . 5 1 −10 −5 0 5 10 Trade−off parameter gamma T o t a l u t ili t y Coordinated illumination Greedyheuristic ( b ) Setup 2 0 0 . 5 1 1 . 5 0 5 10 15 Trade−off parameter U s e r u t ili t y and ene r g y c o s t Predicted utility Measured utility Energy cost ( c ) Setup 1 0 0 . 5 1 1 . 5 0 5 10 15 Trade−off parameter U s e r u t ili t y an d ene r g y c o s t Energy cost Measured utility Predicted utility ( d ) Setup 2 Figure 3 : Comparison of greedy heuristic with coordinated illumination . Since the decision theoretic objective function proposed in Section 2 . 1 depends on the trade - oﬀ parameter γ , we per - formed an initial experiment to determine an appropriate value for our setup . Selecting an appropriate trade - oﬀ para - meter is in general a diﬃcult problem , and depends on the units in which energy and user comfort are measured . It is general practice to look for “knees” in the trade - oﬀ curves , values for which a small increase in either quantity leads to a drastic decrease of the other . Using this guideline , Fig . 3 ( c ) shows that γ can be increased to a value of about 0 . 3 with - out any decrease of user comfort , decreasing energy cost by approximately 25 % . A value of γ = 0 . 4 leads to a small reduction in comfort ( about 7 % ) , but achieves a signiﬁcant reduction ( about 33 % ) in energy cost . These graphs also indicate that the predicted utilities based on our regression model closely corresponds to the measured values . We compared our optimal coordination strategy with the simple greedy heuristic mentioned in Section 2 . 1 , in terms of total utility achieved for varying parameters of γ . Fig . 3 ( a ) illustrates a setting in which occupants with conﬂicting util - ity functions were collocated in the same zones , while Fig . 3 ( b ) shows the result for a setting in which sensors with conﬂict - ing utility functions are placed in adjacent zones . In both settings , the optimal , coordinated algorithm achieves signif - icantly higher utility than the simple greedy heuristic . 2 . 4 Description of Video 1 We documented the experiment for optimizing the trade - oﬀ parameter γ in Video 1 . As seen in the video , the occu - pants of each zone have diﬀerent desire light intensities . In this video , γ gradually increases from 0 to 1 . 4 . The video shows how the lamp settings adjust in order to maximize the total utility , dimming more and more as energy consumption is increasingly penalized . 3 . ADAPTIVE , CLOSED - LOOP CONTROL Electric lighting consumes 30 % to 50 % of the energy used in a typical commercial building [ 26 ] . Utilizing daylight of - fers a natural possibility for reducing the electric energy us - age . In addition to energy savings , some evidence indicates that exposure to daylight reduces stress and stimulates oc - cupants in the building [ 21 ] . An interesting study [ 20 ] shows that introduction of daylighting in retail buildings ( shopping malls , grocery stores ) stimulates buying behavior of the cus - tomers , increasing the sales . The concept of utilizing sunlight for illumination is called daylight harvesting . Daylight harvesting is a diﬃcult strat - egy to adopt in a building as daylight is highly variable and aﬀects diﬀerent locations of a building in diﬀerent ways at diﬀerent times . A post - occupancy evaluation of daylit build - ings found that over 90 % of those with oﬃces near windows had the right amount of sunlight as opposed to 61 % of people with interior oﬃces [ 26 ] . For any daylight harvesting strat - egy , it is essential to have a pervasive network of sensors to measure the varying eﬀect of daylight on diﬀerent parts of the building . While construction costs of commercial build - ings are typically around $ 150 / ft 2 and total utility costs are about $ 1 / ft 2 per year , the salaries and overhead for oﬃce ( a ) Complete testbed 5 10 15 20 0 200 400 600 800 1000 Hour of day S un I n t en s i t y ( W h / m 2 ) ( b ) Real sun intensities 5 10 15 20 0 100 200 300 400 Hour of day M ea s u r ed Lu x ( c ) Simulated sun intensities Figure 4 : Closed loop experimental setup . workers are estimated at $ 150 / ft 2 per year . Thus , it is im - portant that a daylight harvesting strategy either enhances , or at the very least , does not reduce worker productivity . 3 . 1 Closed - loop coordinated illumination The approach described in Section 2 . 2 is open - loop , since we assume that the light intensities at each position are uniquely determined by the lamp settings , and no sensing is needed . For daylight harvesting , however , sun light will aﬀect the light levels at each location , and , thus , the lamp settings must adapt to changing weather conditions and time of the day in a closed - loop fashion . In such settings , sens - ing is required at each time step to determine the eﬀects of external light sources on the environment . To incorporate daylight in our approach , we assume a mapping Θ : T × X → R + , such that Θ ( t , x ) represents the sunlight intensity at time t and point in space x . The func - tion Θ incorporates sensor readings measuring light levels . In general , we may not be able to measure sunlight levels di - rectly , but the combination of the sun light with the lamps . Fortunately , since light levels are additive , we obtain sun - light levels by simply subtracting the intensity caused by the lamps , which can be determined as described in Section 2 . 2 , from the total light . We modify the local utility functions Φ i to take day - light into account in our optimization process , and write Φ i , x i ( a , y ) , where y = Θ ( t , x i ) . The optimization problem then becomes to maximize a ∗ ( t , x ) = argmax a U ( a , t , x ) , ( 3 ) where U ( a , t , x ) = n X i = 1 Φ i , x i ( a , Θ ( t , x i ) ) + γ m X j = 1 Ψ j ( a j ) . The algorithm presented in Section 2 . 2 applies to this dy - namic setting exactly as to the static setting – the only dif - ference is that the local utility functions Φ i depend on the sensed sun intensities . 3 . 2 Evaluation in our testbed We extended the testbed described in Section 2 . 3 by ﬁve lamps , which we used to simulate daylight . The setup is displayed in Fig . 4 ( a ) . The sun lamps are also controlled by X10 and can be set to ten diﬀerent intensities . To simulate realistic relative variations in sun intensity , we used sun tra - jectories for Pittsburgh , PA from the National Solar Radi - ation Data Base provided by the Renewable Resource Data Center [ 33 ] . We modulated the trajectories using piecewise linear functions to achieve a spatial gradient similar to the eﬀect where the sun rises in the East and sets in the West . Fig . 4 ( b ) shows 30 trajectories from the database for June 1990 , and Fig . 4 ( c ) shows the corresponding measurements from the testbed for the most central sensor . To evaluate the accuracy of our closed - loop adaptive con - troller as sun intensities change , we ran experiments over several simulated days . The sun intensity was estimated by subtracting the light intensity produced by the lamps from the measured total light intensity . After estimating the amount of sunlight at each time step , the lamps were actuated accordingly , and the total utility was computed from a light measurement following the actuation . Fig . 5 ( a ) shows the average measured and predicted user utility as well as the power consumption , for a very small value of the trade - oﬀ parameter , γ = 0 . 01 . It can be seen that the measured utility corresponds closely to the pre - dicted utility . Furthermore , there are signiﬁcant power sav - ings during the hours where sun is shining . In total , about 15 percent of energy could be saved on average compared to the amount of energy required if sunlight is not taken into account . Fig . 5 ( b ) shows the results of the same ex - periment for the setting γ = 0 . 4 which was determined to be appropriate in Section 2 . In this more energy - conscious setting , about 55 percent of the energy cost could be saved using daylight harvesting . This experiment showed the same absolute savings in energy during sunshine , but on a much lower base level : in total , about 70 percent energy could be saved in direct comparison to the setting of γ = 0 . 01 . The slightly reduced user utility during daytime is due to the particular selection of utility functions : Two sen - sors were assigned a very narrow preference ( c . f . curve 2 in Fig . 2 ( a ) ) for a light intensity exceeded by sunlight ( even with all lamps switched oﬀ ) . This corresponds to the as - sumption that sunlight can sometimes slightly blind build - ing occupants and make them less productive . An easy ex - tension of our model could include the actuation of blinds , dimming sunlight and avoiding this reduction in user utility . Overall , this experiment shows that , consistently over sev - eral values of the trade - oﬀ parameter , daylight harvesting achieves a signiﬁcant reduction in energy usage . 3 . 3 Description of Video 2 We demonstrate our closed - loop control strategy in Video 2 . In this video , four complete day - night cycles were recorded , and played back in increased pace . It can be seen how the ta - ble lamps adjust to varying sun intensities . A special notice can be given to the rightmost lamp , which is often switched 6 10 15 20 0 5 10 15 20 Hour of day U s e r U t ili t y and E ne r g y C o s t Energy Cost Measured User Utility Predicted User Utility ( a ) ( γ = 0 . 01 ) 10 15 20 60 5 10 15 20 Hour of day U s e r U t ili t y and E ne r g y C o s t Energy Cost Measured User Utility Predicted User Utility ( b ) ( γ = 0 . 4 ) Figure 5 : Adaptive , Closed - Loop control . on even when the sun is shining , since the rightmost region requires particularly high light intensity due to our choice of utility functions . 4 . ACTIVE SENSING To achieve the beneﬁts of the adaptive control strategy described in Section 3 , we continuously require knowledge of the daylight intensity in all areas of the building where occupants are located . In our mobile sensor network vi - sion , all building occupants are equipped with sensors , and hence this information is easily accessible . Unfortunately , continuous sensing and communication costs quickly deplete batteries and hence diminish the lifetime of the sensor net - work . To overcome this problem , we propose an active sens - ing strategy which schedules the sensors to sense at times that maximize the expected utility . Our approach builds on a recent sensor network tasking approach that uses proba - bilistic models to select a subset of sensors to observe [ 13 ] . 4 . 1 Basic foundation for sensor scheduling The key observation is that the distribution of daylight is highly correlated , both spatially across the building , and over time . This implies that sensors can sense coopera - tively , requiring drastically fewer observations each . To sim - plify the discussion , we assume a discretization of space X = { ξ 1 , . . . , ξ r } and time T = { τ 1 , . . . , τ l } . We model the spatial and temporal variation in sun intensity Θ de - ﬁned in Section 3 as a stochastic process . This means that we consider the sunlight at each time τ i and point x i as a random variable Θ ( τ i , ξ i ) , and specify a joint ( prior ) distri - bution over light intensity P [ Θ ( τ 1 , ξ 1 ) = θ 1 , 1 , . . . , Θ ( τ l , ξ r ) = θ l , r ] . ( 4 ) This joint distribution models stochastic temporal and spa - tial relationships among the random variables . These depen - dencies are very strong – during a dark day , most sensors are expected to measure lower values than during brighter days , mostly independently of the sensors’ positions . Also , at noon it will generally be brighter than in the late after - noon or even at night . These correlations allow us to observe only a subset of the sensors at each time step . After observing a subset of sensors , we obtain a probabil - ity distribution over light levels at unsensed locations . Since sunlight levels are now uncertain , instead of working with local utility functions Φ i , x as deterministic quantities ( as in - troduced in Section 3 ) , these utilities now become random variables . In such cases , we address users’ expected utility : E [ Φ i , x ( a , Θ ( x i , t ) ) ] = X θ P ( Θ ( t , x i ) = θ ) Φ i , x ( a , θ ) , ( 5 ) and the optimization problem for light settings becomes the maximization of expected utility a ∗ ( t , x ) = argmax a EU ( a , t , x ) , ( 6 ) where EU ( a , t , x ) = n X i = 1 E [ Φ i , x ( a , Θ ( x i , t ) ) ] + γ m X j = 1 Ψ j ( a j ) . Note that this linear decomposition of expected utilities al - lows us to use the coordination mechanism introduced in Section 2 to ﬁnd optimal light settings , assuming the ex - pectations can be computed eﬃciently . The computation of expected utilities requires probabilistic inference in the sto - chastic process Θ , i . e . , the computation of P ( Θ ( t , x i ) = θ ) , the probability that the sunlight Θ ( t , x i ) at position x i at time t has light level θ . These probabilities can often be computed eﬃciently . Even if no eﬃcient exact inference is possible , there are eﬃcient approximate inference algorithms available [ 9 ] . The prior distribution respresented in Eq . ( 4 ) does not take observed sensor values into account . If we observe a particular light intensity Θ ( ξ , τ ) = ˆ θ at some time τ and position ξ , we can use Bayes rule to compute the posterior distribution : P h Θ ( τ 1 , ξ 1 ) = θ 1 , 1 , . . . , Θ ( τ l , ξ r ) = θ l , r | Θ ( ξ , τ ) = ˆ θ i , representing the distribution over possible sunlight levels at each location at each time point , given the measurements . More generally , after observing a value o for some sensors O , we compute the posterior distribution P ( Θ ( t , x i ) = θ | O = o ) . Using this posterior distribution we can obtain the conditional expected utility : EU ( a , t , x | O = o ) = P ni = 1 P θ P ( Θ ( t , x i ) = θ | O = o ) Φ i , x ( a , θ ) + γ P m j = 1 Ψ j ( a j ) . The posterior distribution reﬂects our updated belief about the sun intensity distribution after the observations have been made by the sensors . This implies that updating our belief also changes the optimal lamp settings to choose in ( 6 ) . Intuitively , if we are certain about the amount of nat - ural light at a particular location , we can allocate the artiﬁ - cial light more economically . More generally , we would like to schedule sensing times that lead to more eﬀective deci - sions . This concept is formalized by the maximum expected utility framework : We want to ﬁnd the set of observations O ∗ that yields best decisions ( light settings ) in expectation after making these observations . Here , we want to maximize O ∗ = argmax O J ( O ) , ( 7 ) where J ( O ) = X o P ( O = o ) X t ∈T max a EU ( a , t , x | O ( 1 : t ) = o ( 1 : t ) ) ! , O is a set of observations , and O ( 1 : t ) = o ( 1 : t ) is the subset of observations up to time t . Note that we are dealing with a dynamic system , thus , when computing the expected util - ity at time t , we only consider measurements made up to this time . The quantity J is the expected value of the ex - pected utility , where the ﬁrst expectation is computed over all possible outcomes of the measurements O , and the sec - ond expectation is taken over the sunlight intensity proba - bility distribution . For example , if in Fig . 1 ( b ) , the sensor Φ 2 makes an observation , we will be more certain about the light intensity at the location of Φ 1 at the same time step , than if we had observed sensor Φ 4 three time steps back . The more certain we are about the light intensity , the more accurately we can coordinate the lamp settings , and the more comfort the occupants will have . We are more certain about the sunlight level when more observations are made . In contrast , more observations will use up the sen - sors batteries faster . A natural approach is to constrain the number of observations made by sensors , for example , be providing a certain budget B of energy each sensor can spend for sensing during each day . Since in our proposed system , the light sensors are mobile and collocated with the building occupants , and the sensing and communication cost is assumed to be uniform over the day , we deﬁne our active sensing goal as that of specifying a schedule of B sensing times for each sensor . 4 . 2 Algorithms for sensor tasking In the following , we adopt a Markov assumption for our stochastic sunlight intensity process , which states , that the state of the process at time t is conditionally independent of all states at times t 0 for t 0 < t − 1 , given the state at time t − 1 . This is a very natural assumption for sensor networks [ 13 ] . Unfortunately , even in Markovian settings , the optimiza - tion problem ( 7 ) is intractable [ 25 ] , even for the case of two sensors . In [ 25 ] , it is however shown that for one single sensor , the problem of ﬁnding the optimal B observations can be solved eﬃciently . We ﬁrst review this approach . For a single sensor , the light intensity process forms a Markov chain over time . Their algorithm uses a dynamic program - ming approach , leveraging the fact , that the objective func - tion in ( 7 ) decomposes along time , i . e . , the total utility is the sum of all sub - chains separated by the times of observa - tion . Fig . 6 ( a ) illustrates this idea . In this graph , the sensor is scheduled to only observe at times t 1 and t 3 , indicated as S ( 1 ) 1 and S ( 1 ) 3 . The sunlight intensity distribution at times t 4 and t 5 only depend on the observation at time t 3 , and not on the observation at time t 1 . Using this dynamic programming approach , we can com - pute the expected utilities for all possible sub - chains – and hence for the total Markov chain – eﬃciently . If no observa - tion is made , the following formula computes the maximum expected utility for the sub - chain from t a to t b as J ( i ) a : b ( 0 ) = b − 1 X j = a + 1 EU ( a , t j , x | Θ ( t a , x i ) ) . If k observations can be made , the maximum expected util - ity achievable for the sub - chain starting at time t a and end - ing at time t b can be recursively computed by J ( i ) a : b ( k ) = max j : a < j < b { EU ( a , t j , x | Θ ( t j , x i ) ) + J ( i ) a : j ( 0 ) + J ( i ) j : b ( k − 1 ) } . Finally , the maximum expected utility schedule from time 1 to t max can be obtained by max O J ( i ) ( O ) = J ( i ) 0 : t max + 1 . We refer the reader to [ 25 ] for details and proofs . Input : Budget B Output : Optimal selection O of observation times beginfor 0 ≤ a < b ≤ t max + 1 do rew : = 0 ; for j = a + 1 to b − 1 do rew : = rew + EU ( a , t j , x | Θ ( t a , x i ) ) ; end J ( i ) a : b ( 0 ) : = rew ; endfor k = 1 to B do for 0 ≤ a < b ≤ n + 1 do for j = a + 1 to b − 1 do sel ( j ) : = EU ( a , t j , x | Θ ( t j , x i ) ) + J ( i ) a : j ( 0 ) + J ( i ) j : b ( k − 1 ) ; end J ( i ) a : b ( k ) = max a < j < b sel ( j ) ; d J ( i ) a : b ( k ) = argmax a < j < b sel ( j ) ; end end a : = 0 ; b : = t max + 1 ; k : = B ; O : = ∅ ; for k = B downto 1 do a : = d J ( i ) a : b ( k ) ; O : = O ∪ { t a } ; end end Algorithm 2 : Optimal observation selection for a single sensor . t max denotes the maximum number of time steps considered for scheduling . In the case of multiple sensors , this decomposition does not hold anymore , since inﬂuence can ﬂow across chains . Fig . 6 ( b ) visualizes this problem – there , the sun intensity distribution for sensor ( 2 ) depends on all three observations S ( 1 ) 1 and S ( 1 ) 4 from sensor ( 1 ) and S ( 2 ) 2 from sensor ( 2 ) . Ex - act computation of EU is in general not possible , because computing the expectation requires the summation over a number of terms exponential in the number of observations . S ( 1 ) 1 S ( 1 ) 2 S ( 1 ) 3 S ( 1 ) 4 S ( 1 ) 5 ( a ) Observation selection ( single chain ) S ( 2 ) 1 S ( 2 ) 2 S ( 2 ) 3 S ( 2 ) 4 S ( 2 ) 5 S ( 1 ) 1 S ( 1 ) 2 S ( 1 ) 3 S ( 1 ) 4 S ( 1 ) 5 ( b ) Observation selection ( multiple ) Figure 6 : Scheduling sensors in dynamic processes . We address this complexity issue using an ( approximate ) extension of the decomposition approach used for single chains . More speciﬁcally , for sensor selection purposes , we only al - low a sensor to take into account the most recent observa - tions . Intuitively , this appears to be a reasonable approx - imation , especially if the potential scheduling times in T are reasonably far apart . Formally , we replace the set of observations up to time t , O ( 1 : t ) by a subset O 0 ( 1 : t ) , and ap - proximate J ( O ) by J ( O 0 ) . In Fig . 6 ( b ) for example , the total expected utility at time t 4 would be computed using only observations from time t 3 for sensor one , and time t 2 for sensor two , ignoring inﬂuence originating from observa - tion S ( 1 ) 1 and ﬂowing through the chains as indicated by the dashed arrow . The following proposition proves that this approximation , while not exact , leads to the maximization of a lower bound : Proposition 1 . J ( O ) ≥ J ( O 0 ) for all O 0 ⊆ O . Proof . This bound follows from the fact that maximiza - tion over a is convex , and an application of Jensen’s inequal - ity . Using an induction argument , we simply need to show that J ( O ) ≥ J ( ∅ ) . J ( O ) = X o P ( O = o ) X t ∈T max a EU ( a , t , x | O ( 1 : t ) = o ( 1 : t ) ) ! ≥ X t ∈T max a X o P ( O = o ) EU ( a , t , x | O ( 1 : t ) = o ( 1 : t ) ) ! = X t ∈T max a EU ( a , t , x ) = J ( ∅ ) Proposition 1 proves that conditioning only on the most recent observations can only decrease our objective function , hence maximizing this simpliﬁed objective implies maximiz - ing a lower bound on the true objective . We propose the following heuristic for maximizing the lower bound on the expected utility . The basic algorithm will be a coordinate ascent approach , scheduling observa - tions for each sensor individually . The maximization for the individual sensors uses the same dynamic programming trick introduced above . Since all sensors maximize the same global objective , the local optimization is guaranteed to monotonically increase the global objective , and hence must converge ( to a local optima ) after a ﬁnite number of steps . The procedure is formalized in Algorithm 3 . Input : Budget B Output : Selection O ( i ) of observation times for each sensor beginwhile not converged do Select 1 ≤ i ≤ n at random ; Use Algorithm 2 to select observations O i for sensor i , but conditioning on current sensor scheduling O for remaining sensors ( i . e . computing EU ( a , t j , x | O ( 1 : t ) ) instead of EU ( a , t j , x | Θ ( t , x i ) ) ; Compute diﬀerence in total expected utility ; end end Algorithm 3 : Multi - Sensor scheduling . Several remarks are required in order to implement Algo - rithm 3 . First of all , in a naive implementation , the com - putation EU ( a , t j , x | O ( 1 : t ) ) requires time exponential in the number of chains . This can be avoided using a sam - pling approximation , using Hoeﬀding’s inequality to derive polynomial bounds on sample complexity . Details are omit - ted here due to lack of space . In practice , a small number of samples appears to provide reasonable performance . Sec - ondly , inference itself becomes intractable with an increasing number of sensors . Approximate inference algorithms such as the algorithm proposed by Boyen and Koller [ 9 ] provide a viable way around this problem . Although we cannot in general provide performance guar - antees for the procedure , we are building on an algorithm that provides an optimal schedule for each sensor in isola - tion , which should beneﬁt from observations provided by the remaining sensors . Algorithm 3 will always converge , and always compute a lower bound on the expected total utility . Considering the intractability of the general prob - lem ( NP PP - completeness [ 25 ] ) , these properties are reassur - ing . In our experiments , the coordinated sensor scheduling performed very well , as discussed in Section 4 . 3 . It is also possible to generalize this algorithm to compute conditional plans , for which the selection of observations depends on the observations already made . For details please refer to [ 25 ] . 4 . 3 Experimental evaluation in our testbed To evaluate our active sensing strategy , we ﬁrst learned a probabilistic model for predicting sun intensities . We used 75 trajectories from the day - night cycles using our sunlight lamps as presented in Fig . 4 ( c ) as training data , and 3 sep - arate trajectories as testing data . From this training data , we learned a discrete , non - stationary dynamical Bayesian network for three sensors , with nodes for one measurement every hour per sensor , starting at 6 am till 22 am . The dis - 10 12 14 16 18 −2 0 2 4 6 8 Hour of day T o t a l u t ili t y 10 Observ . / sensor 1 Observ . / sensor No observ . ( a ) Total utility 10 12 14 16 18 0 5 10 15 Hour of day E ne r g y c o s t 10 Observ . / sensor 1 Observ . / sensor No observ . ( b ) Energy cost 0 1 2 3 10 6 8 10 12 14 Number of observations U s e r u t ili t y and ene r g y c o s t Energy cost Measured user utility ( c ) Sensing scheduling evaluation Figure 7 : Active sensing results . cretization was done using eight 50 Lux bins and the transi - tion probabilities were computed using a Gaussian approx - imation to avoid overﬁtting . We used data from the two sensors at both far ends ( East and West ) of our testbed and the central sensor ( South ) to capture changes in the sun in - tensities . We then used our sensor scheduling Algorithm 3 to select informative times for querying each sensor . Us - ing this probabilistic model , we executed day - night cycles from the test set , and continuously measured light intensi - ties from the sun lamps and the table lamps . However , we only provided the sensor measurements taken at the times selected by Algorithm 3 to the prediction routine , and actu - ated the lamps to maximize the expected utility as deﬁned in Section 4 . 1 . We used the trade - oﬀ parameter γ = 0 . 4 as identiﬁed in Section 2 . Fig . 7 ( a ) presents the mean total utility achieved using no observations , one observation or ten observations per sensor each day . It can be seen that even a single observation in - creases the total utility close to the level achieved by contin - uous sensing . Fig . 7 ( b ) shows the mean energy consumption required for the same experiment . Here , the single sensor observation strategy comes even closer to the power sav - ings achieved for continuous sensing . Fig . 7 ( c ) shows the mean user utility and energy savings achieved , for a number of observations varying from no observations to continuous sensing . These results imply that using the predictive model and our active sensing strategy , even a very small number of observations achieves results approximately as good as the results achieved by continuous sensing . Since the sensor net - work battery lifetime is in general inversely proportional to the amount of power expended for sensing and communica - tion , we conclude that our active sensing strategy promises to lead to drastic increases in sensor network lifetime , de - ployment permanence and reduced maintenance cost . 5 . PREDICTIVE LIGHT CONTROL Thus far we have assumed that occupants are static . We now generalize our approach to dynamic settings , where ac - cupants may move throughout the building . In such set - tings , the adaptive light control has to behave proactively in order to be acceptable for the user , e . g . , a hallway has to be lit even before people enter it . To simplify the discussion , we will again assume a dis - cretization of the space X . This assumption is also moti - vated by the idea that buildings usually have only a ﬁnite number of places of interest , such as oﬃce cubicles , cafeteria tables , hallway segments etc . We assume full observability , i . e . , that our tracking system is able to exactly locate the discrete position of every building occupant . In our scenario , where the occupants are equipped with sensor badges , it is possible to achieve relatively accurate localization using , for example , RFID tags [ 30 ] . For our application , we consider tracking as a black - box problem for which many existing techniques can be utilized . We assume that the occupants’ movements can be for - malized using a probabilistic model and that people move independently of each other . The adjacency of the loca - tions implies a graph structure G with nodes X and edges E ⊂ X × X . This means that two locations are connected by an edge if they are physically next to each other . In Fig . 1 ( b ) , the locations Φ i and Φ i + 1 for 1 ≤ i < 4 would hence be connected by an edge each . Using this graph formalization , each building occupant performs a random walk on this graph , with certain transi - tion probabilities . These random walks are naturally mod - eled by a Markov chain . Instead of using the locations X themselves as states in the Markov chain , we perform our random walk on the edges E of G . For a location x , the graph will always contain the “loop” ( x , x ) , which corre - sponds to the action of remaining at a particular location . This random walk on the edges is equivalent to a second order Markov process on the locations X , and allows us to capture the intuitive modeling requirement that a person is more likely to move if they moved immediately before . Since we assume full observability , at each time step t we have a distribution P ( x ( t + 1 ) i = · | x ( t ) i , x ( t − 1 ) i ) which we can use for predicting occupant i ’s position at time t + 1 . We can easily integrate this model into our maximum expected utility framework , by computing the expected utility as EU ( a , t , x ( t ) , x ( t − 1 ) ) = γ m X j = 1 Ψ j ( a j ) + n X i = 1 X x P ( x ( t + 1 ) i = x i ) E [ Φ i , x i ( a , Θ ( x i , t ) ) ] . Note that this computation is tractable ; the complexity only increases by a factor proportional to the number of outgoing edges at position x ( t ) i . We can also extend this simple model to handle occupants entering or exiting the building . A more general approach would be to model the positions of the building occupants as a partially observable stochas - tic process . This formalization allows , for example , uncer - tainty about the tracking process , but is often intractable 0 5 10 15 20 Time Z one s ( M o v e m en t ) ( a ) Random walk 0 0 . 2 0 . 4 0 . 6 0 . 8 1 Measured utility Energy cost Total utility No prediction Using prediction ( b ) Eﬀect of prediction 0 0 . 1 0 . 2 0 . 3 0 . 4 0 0 . 2 0 . 4 0 . 6 0 . 8 1 Trade−off parameter User utility Normalizedenergy cost ( c ) Trade - oﬀ curve Figure 8 : Results using predictive model . ( c . f . [ 34 ] ) . Since we do not need extremely precise local - ization of the occupants in the building automation setting , the full observability assumption is often realistic . 5 . 1 Evaluation in our testbed To evaluate our predictive light control strategy , we sim - ulated movements of a single occupant following a random walk . The random walk was based on a second order Markov process : If the simulated occupant moved in the last tran - sition , we assumed that the probability of continuing the movement in the same direction was 0 . 4 ; with probability 0 . 5 it would stop moving and with probability 0 . 1 it would move in the opposite direction . If the occupant did not move in the last step , the probability of remaining static was set to 0 . 6 , and with probability 0 . 2 it would start to move in either direction . The discrete locations the occupant would move among were the centers of the sequence of triangular regions deﬁned in our testbed as indicated in Fig . 1 ( b ) . We provided the transition probabilities to the coordinated illumination algorithm , and then measured the utility at the actual next position using the MICA2 motes . Our experiments con - sisted of a ﬁxed 20 step random trajectory generated from our movement model . We ﬁrst compared the predictive model with the simple non - predictive version . Fig . 8 ( b ) shows a drastic increase in mean user and total utility , along with an increase in energy consumption used for lighting up areas adjacent to the occupants current position . In spite of the increase in energy consumption , the total utility increased by over 25 % . We also performed another experiment to explore the trade - oﬀ curve between user utility and energy consumption for varying values of γ . In interpreting these results , it has to be noted that the trade - oﬀ parameter γ is not normal - ized by the number of occupants , hence the values presented here cannot be directly compared to the values in Section 2 . Fig . 8 ( c ) shows a similar dynamics as observed in Fig . 3 ( c ) in Section 2 – Increased user comfort incurs increased en - ergy cost . It is again interesting to look for “knees” in the trade - oﬀ curve , the most prominent of which appears for γ = 0 . 025 . For this setting , there is almost no reduction in user utility but a large decrease in cost . This experiment also indicates that the utility trade - oﬀ can be very diﬀerent for a dynamic setting compared to a static situation . During the experiments , it was also possible to observe in - teresting qualitative behavior of the light management strat - egy . For very low values of the trade - oﬀ parameter ( γ ≈ 0 . 025 ) , the system chose to favor occupants utility by strongly illuminating all possible adjacent regions which the occupant might enter . For medium values ( γ ≈ 0 . 1 ) , the system chose to save energy by not illuminating regions which the occu - pant just left , since the modeled probability of an immediate return was only 0 . 1 . For large values of γ > 0 . 3 , the light management strategy simply chose to completely switch oﬀ all lights , in order to maximize the expected total utility . 5 . 2 Description of Video 3 We documented the movement experiment using our pre - dictive model in Video 3 . In this video , the lights adjust , following the trajectory of the simulated building occupant . The actual trajectory is presented for reference in Fig . 8 ( a ) . 6 . CONCLUSIONS Simultaneously optimizing user comfort and reducing en - ergy usage in building automation is of enormous economic importance . Implementing an eﬀective control strategy poses a complex optimization problem . In this paper , we pre - sented a decision theoretic formalization of this optimiza - tion problem , and provided eﬃcient algorithms for optimally trading oﬀ these two main conﬂicting goals . Our algorithms presented in Section 2 utilize building structure for eﬃcient and eﬀective coordinated illumination . The intelligent lighting implementation presented in our paper requires the nodes to send the data to the central controller . The proposed approach though tested on a small scale with a central controller can be further extended for a large scale implementation using the distributed architec - ture presented in [ 29 , 18 ] . The authors present a distributed architecture for solving inference problem similar to the ones formulated in this paper . The distributed architecture is able to handle the inference and control problems that is robust to unreliable communication and node failures . In this architecture , the nodes of the sensor network assem - ble themselves into a junction tree and exchange messages between neighbors to solve the inference problem eﬃciently and exactly . Our proposed system provides a novel use of wireless sen - sors to capture the real state of the indoor and outdoor environment and use that information to intelligently con - trol lights to meet user preferences . The closed - loop control strategy developed in Section 3 adapts to the presence of natural light sources and provides a signiﬁcant reduction in electric light usage by harvesting daylight . A major challenge in deploying wireless sensors in a build - ing is caused by high maintenance cost due to quickly drain - ing battery life . Our active sensing algorithms presented in Section 4 signiﬁcantly reduce the sensing required to pro - vide suﬃcient information to the control strategy , and hence drastically increases the life of the wireless sensor network . This novel approach towards reducing the maintenance ef - fort makes mobile , wireless sensor networks a more attrac - tive solution even for large scale , long - term deployments . As presented in the paper , utility theory provides a ratio - nal basis of decision making in building control . However , it also highlights various challenges which need to be addressed in further studies . The preferences of occupants as modeled by their utility functions change over time and also with the task the occupants perform . It is impractical to expect users to continuously and reliably provide their preferences to the system . Utility elicitation in complex environments is gen - erally considered a diﬃcult problem , and in the competitive setting of user preferences it also involves game theoretic as - pects [ 17 ] . There are many elicitation techniques available which often disagree even when applied to the same person [ 16 ] . There are however promising results for using deci - sion theoretic techniques for reliable utility elicitation [ 11 , 12 ] . We expect these techniques to be a natural ﬁt to our proposed mobile sensor network solution . In our vision , the sensor network is not only used for providing information to the building control strategy , but also to learn about the preferences of individual occupants based on their interac - tion with the environment . We envision a system , in which any interactions of the occupants with the building controls automatically aﬀect their respective utility functions . The mobile sensor information can then be used to learn not only a ﬁxed set of utility functions , but also a predictive model of how the utility functions change over time . Building automation is an intriguing application of sensor networks . We furthermore believe that the methods pro - posed in this paper , as well as our proof - of - concept study , will signiﬁcantly advance the applicability of sensor networks to such complex real world control problems . Acknowledgements . This work was supported by NSF Grant No . CNS - 0509383 and a gift from Intel Corporation . 7 . REFERENCES [ 1 ] A Declarative Database of Sensor Networks . Tiny DB . http : / / telegraph . cs . berkeley . edu / tinydb / . [ 2 ] S . Arnborg , D . G . Corneil , and A . Proskurowski . Complexity of ﬁnding embedding in a k - tree . SIAM J . Alg . Disc . Meth . , 8 ( 2 ) : 277 – 284 , 1987 . [ 3 ] ASHRAE , Atlanta . ASHRAE Standards , 90 - 1980a edition . [ 4 ] F . Bauman , A . Baughman , G . Carter , and E . Arens . A ﬁeld study of pem ( personal environmental module ) performance in bank of americas san francisco oﬃce buildings . Technical report , University of California , Berkeley , 1997 . [ 5 ] A . Becker and D . Geiger . A suﬃciently fast algorithm for ﬁnding close to optimal junction trees . In UAI , 1996 . [ 6 ] U . Bertele and F . Brioschi . Nonserial Dynamic Programming . Academic Press , New York , 1972 . [ 7 ] M . Boman , P . Davidsson , and H . Younes . Artiﬁcial decision making under uncertainty in intelligent buildings . In UAI , 1999 . [ 8 ] S . Boyd and L . Vandenberghe . Convex Optimization . Cambridge University Press , 2004 . [ 9 ] X . Boyen and D . Koller . Tractable inference for complex stochastic processes . In UAI , 1998 . [ 10 ] CBEC Survey . Energy Information Administration . http : / / www . eia . doe . gov / emeu / cbecs / , 2003 . [ 11 ] U . Chajewska and D . Koller . Utilities as random variables : Density estimation and structure discovery . In UAI , 2000 . [ 12 ] U . Chajewska and D . Koller . Learning an agent’s utility function by observing behavior . In UAI , 2001 . [ 13 ] A . Deshpande , C . Guestrin , S . Madden , J . Hellerstein , and W . Hong . Model - driven data acquisition in sensor networks . In VLDB , 2004 . [ 14 ] W . Fisk . Health and productivity gains from better indoor environments and their relationships with building energy eﬃciency . Technical Report 25 : 537 - 66 , LBNL , 2000 . [ 15 ] B . M . Flax . Intelligent buildings . IEEE Communication Magazine , April 1991 . [ 16 ] D . Fromberg and R . Kane . Methodology for measuring health - state preferences - ii : Scaling methods . In Journal of Clinical Epidemiology , 1989 . [ 17 ] D . Fudenberg and J . Tirole . Game Theory . The MIT Press , 1991 . [ 18 ] C . Guestrin . Planning Under Uncertainty in Complex Structured Environments . PhD thesis , Stanford University , 2003 . [ 19 ] C . Guestrin , D . Koller , and R . Parr . Multiagent planning with factored mdps . In NIPS , 2001 . [ 20 ] L . Heschong , R . L . Wright , and S . Okura . Daylighting impact on retail sales performance . Journal of Illuminating Engineering Society , 2002 . [ 21 ] F . Hollich . The Inﬂuence of Occular Light Perception of Metabolism on Man and Animal . New - York : Springer Verlag , 1979 . [ 22 ] A . Huberman and S . Clearwater . A multi - agent for controlling building environment . In Proceedings of 1st International Conference on Multi - agent Systems , 1995 . [ 23 ] F . Jensen and F . Jensen . Optimal junction trees . In UAI , 1994 . [ 24 ] U . Kjærulﬀ . Reduction of computational complexity in bayesian networks through removal of weak dependencies . In UAI , 1994 . [ 25 ] A . Krause and C . Guestrin . Optimal nonmyopic value of information in graphical models - eﬃcient algorithms and theoretical limits . In Proc . of IJCAI , 2005 . [ 26 ] J . McHugh , P . J . Burns , and D . C . Hittle . The energy impact of daylighting . ASHRAE Hournal , 1998 . [ 27 ] Minolta Light Meter . Minolta USA . [ 28 ] T . Moore , D . J . Carter , and A . I . Slater . Conﬂict and control : The use of locally addressable lighting in open space oﬃce plan . In Proc . Of the Chartered Institute of Buidling Service Engineers , 2000 . [ 29 ] M . Paskin , C . Guestrin , and J . McFadden . A robust architecture for distributed inference in sensor networks . In Proceedings of 4th IPSN , April , 2005 . [ 30 ] M . Philipose , K . P . Fishkin , and D . Hahnel . Mapping and localization with rﬁd technology . Technical report , Intel Research , 2003 . [ 31 ] R . Evans et al . The long term costs of owning and using buildings . The Royal Academy of Engineering , 1998 . [ 32 ] M . R . Finley Jr . , A . Karakura , and R . Nbogni . Survey of intelligent building concepts . IEEE Communication Magazine , April 1991 . [ 33 ] Renewable Resource Data Center . National solar radiation data base . http : / / rredc . nrel . gov / solar / old data / nsrdb / . [ 34 ] J . Rintanen . Complexity of planning with partial observability . In ICAPS , 2004 . [ 35 ] S . Sharples , V . Callaghan , and G . Clarke . A multi - agent architecture for intelligent building sensing and control . International Sensor Review Journal , 1999 . [ 36 ] Wireless Sensor Platform . MICA 2 . http : / / www . xbow . com / . [ 37 ] J . Woods . Cost avoidance and productivity in owning and operating buildings . OM , 4 ( 4 ) : 753 – 70 , 1989 . [ 38 ] D . Wyon . Indoor environmental eﬀects on productivity . In Proc . of Indoor Air , 1992 . [ 39 ] X10 Building Automation Protocol . X10 .
J . Math . Biol . DOI 10 . 1007 / s00285 - 015 - 0872 - 5 Mathematical Biology Estimating the within - household infection rate in emerging SIR epidemics among a community of households Frank Ball 1 · Laurence Shaw 1 Received : 30 September 2014 / Revised : 6 March 2015 © Springer - Verlag Berlin Heidelberg 2015 Abstract This paper is concerned with estimation of the within - household infection rate λ L for a susceptible → infective → recovered epidemic among a population of households , from observation of the early , exponentially growing phase of an epi - demic . Speciﬁcally , it is assumed that an estimate of the exponential growth rate is available from general data on an emerging epidemic and more - detailed , household - level data are available in a sample of households . Estimates of λ L obtained using the ﬁnal size distribution of single - household epidemics are usually biased owing to the emerging nature of the epidemic . A new method , which accounts correctly for the emerging nature of the epidemic , is developed by exploiting the asymptotic theory of supercritical branching processes and proved to yield a strongly consistent estimator of λ L as the population and sampled households both tend to inﬁnity in an appropri - ate fashion . The theory is illustrated by simulations which demonstrate that the new method is feasible for ﬁnite populations and numerical studies are used to explore how changes to the parameters governing the spread of an epidemic affect the bias of estimates based on single - household ﬁnal size distributions . Keywords Household epidemic model · SIR epidemic · Emerging epidemic · Parameter estimation · Branching process Mathematics Subject Classiﬁcation 92D30 · 62M05 · 60J85 B Frank Ball frank . ball @ nottingham . ac . uk Laurence Shaw pmxlmsha @ exmail . nottingham . ac . uk 1 School of Mathematical Sciences , University of Nottingham , University Park , Nottingham NG7 2RD , UK 123 F . Ball , L . Shaw 1 Introduction Mathematical models are being used increasingly to inform public health policy con - cerning control of emerging infections , see , e . g . Ferguson et al . ( 2005 ) and Fraser et al . ( 2009 ) for applications to avian inﬂuenza A ( H5N1 ) and swine inﬂuenza A ( H1N1 ) , respectively . A key role for such models is to evaluate the effectiveness of possible strategies for containment of an emerging infection . In order to accomplish this , esti - mates are required of parameters used to deﬁne the model in question . This paper considers such estimation from data collected in the early phase of an emerging epi - demic , using the model of Ball et al . ( 1997 ) for the spread of an SIR ( susceptible → infective → recovered ) epidemic among a population partitioned into households . The model of Ball et al . ( 1997 ) assumes that an infectious individual makes two types of contacts , local contacts , i . e . with individuals chosen uniformly at random from the individual’s household , and global contacts , i . e . with individuals chosen uniformly at random from the entire population . Although an oversimpliﬁcation , this structure , which includes a departure from homogeneous mixing that is clearly present in human populations , yields a model that ( i ) is amenable to considerable mathematical analysis and ( ii ) leads to important insights into disease dynamics and control , such as the impact of household structure on the performance of vaccination strategies ( Becker and Dietz 1995 ; Becker and Starczak 1997 ; Ball and Lyne 2002 ) . A household com - ponent is present in many complex simulation models ( see , e . g . Ferguson et al . 2005 ) . Moreover , data at a household level are often collected during emerging infections ; see Cauchemez et al . ( 2009 ) and House et al . ( 2012 ) for analyses of such data for inﬂuenza A ( H1N1 ) transmission in the United States and England , respectively . For many stochastic models of epidemics with few initial infectives , if the disease does not die out quickly then , during the early stages of an epidemic , the number of infectives grows exponentially until saturation effects take over . Early exponen - tial growth is also seen in many real - life epidemics and there has been a growing interest in quick inference methods during this stage of an epidemic . Assuming a homogeneously mixing population , Wallinga and Lipsitch ( 2007 ) provided a sim - ple estimate of the basic reproduction number R 0 ( see , e . g . Heesterbeek and Dietz 1996 ) from an observed exponential growth rate r and knowledge of the generation interval for the disease . Fraser ( 2007 ) extended this methodology to a community of households , using a closed - form approximate method for determining the expo - nential growth rate of the households epidemic model . Fraser gives two illustrative applications of his methodology , to pandemic inﬂuenza and measles , using histori - cal data to obtain estimates of within - household transmission parameters . As Fraser notes , these transmission parameters could be quite different for future pandemics , so methods are required for estimating such parameters from data on an emerging infection . The following scenario is considered in this paper . It is assumed that the house - hold size distribution for the population is known ( this is usually available from census data ) , an estimate of the exponential growth rate r is available from gen - eral data on an emerging epidemic and more - detailed , household - level data are available in a sample of households . The primary goal is to estimate the local ( within - household ) infection rate λ L from this information , whilst the epidemic is still in 123 Estimating the within - household infection rate in . . . its emerging phase . For most of the paper it is assumed , primarily for ease of pre - sentation , that there is no latent period and that the infectious period distribution is known , though both of these assumptions may be relaxed . For inference based on ﬁnal outcome data ( e . g . Knock and O’Neill 2014 ; Ball and Lyne 2015 ) , esti - mates of infection rates are ( i ) invariant to very general assumptions concerning a latent period and ( ii ) confounded with the scale of the infectious period distribu - tion . Neither is true for inference in an emerging epidemic . The partial nature of the assumed available data renders full maximum likelihood estimation difﬁcult , if indeed feasible ; the amount of unobserved data is such that computationally inten - sive methods for incomplete data , such as the EM algorithm and data augmentation MCMC , may well be problematic . Thus an alternative estimation procedure is devel - oped and shown to give an estimator of λ L which converges to the unknown true value as the population and sampled households both tend to inﬁnity in an appropriate fashion . It is well known that the early stages of an SIR epidemic among a community of households may be approximated by a branching process in which individuals correspond to single - household epidemics . Thus if , for example , the available data consist of the total number of cases in completed sub - epidemics within households , it is tempting to estimate λ L by ﬁtting the usual ﬁnal size distribution for a single - household epidemic ( see , e . g . Ball 1986 ) to such data . However , as illustrated in Sect . 3 . 2 , this leads to λ L being underestimated because in an emerging epidemic the completed single - household epidemics are likely to be the smaller ones . An improved estimate may be obtained by including single - household epidemics that are still ongoing at the time when estimation is performed , using right - censoring for their size ( i . e . that their size is at least their current size ) , but , as also demonstrated in Sect . 3 . 2 , the resulting estimate is still biased . ( An estimator of a parameter is unbiased if its expectation , i . e . the average of inﬁnitely many independent repetitions of the same experiment , equals the true value of that parameter , otherwise the estimator is biased . ) In order to obtain an estimator that is unbiased when the population and sample households both tend to inﬁnity , one needs to account correctly for the emerging nature of the epidemic which produced these data . ( Similar issues arise in estimating the generation time of an infectious disease early in an epidemic Scalia Tomba et al . 2010 . ) The main purpose of this paper is to show that this can be achieved by using the theory of Nerman ( 1981 ) concerning the asymptotic behaviour of counts of characteristics associated with supercritical general ( i . e . Crump - Mode - Jagers ) branching processes applied to the above - mentioned branching process which approximates the early stages of an epidemic in a community of households . The paper is structured as follows . The households epidemic model of Ball et al . ( 1997 ) is described in Sect . 2 and the early stages of epidemics in a large population is considered in Sect . 3 . The threshold behaviour of the model is outlined in Sect . 3 . 1 . Estimation of λ L by ﬁtting the usual ﬁnal size distribution to single - household epi - demics , both without and with censoring , is considered and shown to be inadequate in Sect . 3 . 2 . The new method , which incorporates correctly the emerging nature of the epidemic is described in Sect . 4 . The theory for the method is developed in Sect . 4 . 1 for the situtations when , at the time the inference is performed , ( i ) complete knowledge of the numbers of infective and recovered individuals in each household is avail - 123 F . Ball , L . Shaw able , and ( ii ) ( sometimes the more realistic scenario ) only the numbers of recovered individuals in each household are available . Some extensions of the theory and imple - mentation issues are considered in Sect . 4 . 2 . The theory as developed does not make any assumptions concerning the infectious period distribution , other than it possesses a moment - generating function , but it does need to be speciﬁed . However , the method is easy to implement only if single - household epidemic dynamics are Markovian , i . e . if the infectious period follows an exponential distribution , though phase - type distribu - tions can also be accommodated . Extensions to incorporate a latent period and allow for the rate of the exponential distribution used to model the infectious period to be unknown are discussed brieﬂy , as is allowing λ L to depend on household size . Simi - lar theory is developed in Sect . 5 for a households Reed - Frost type model , in which the latent period is constant and the infectious period is reduced to a single point in time , using multitype Galton - Watson branching process . Simulations depicting how the estimation methodologies developed in Sects . 4 and 5 perform in practice are shown in Sect . 6 , while other plots in this section illustrate how changes to the para - meters governing the spread of an epidemic affect the bias of the estimates based on single - household ﬁnal size distributions . Proofs that the estimators derived in Sect . 4 are strongly consistent under suitable conditions are given in Sect . 7 . Finally , some concluding comments are given in Sect . 8 . 2 Model The model used is based on that of Ball et al . ( 1997 ) for describing the spread of an SIR epidemic in a population that is partitioned into households . For a population in which n max is the size of the largest household , let m n be the number of households of size n , for n = 1 , 2 , . . . , n max , so that m = (cid:2) n max n = 1 m n and N = (cid:2) n max n = 1 nm n are , respectively , the total numbers of households and individuals in the population . Also , for n = 1 , 2 , . . . , n max , let α n = m n / m be the proportion of households of size n and ˜ α n = nm n / N be the proportion of individuals who reside in households of size n . The epidemic is initiated by a small number of individuals becoming infected at time t = 0 . Once infected , an individual remains in that state for the duration of its infectious period , which for each individual is independently and identically distrib - uted according to a random variable T I , having an arbitrary but speciﬁed distribution . Once its infectious period is over , an individual is recovered and it plays no further part in the epidemic . During its infectious period , a given infective makes global contacts with any other given individual in the population at points of a homogeneous Pois - son process having rate λ G / N and it makes additional local contacts with any other given individual in the same household at points of a homogeneous Poisson process having rate λ L . All the Poisson processes describing infectious contacts ( whether or not either or both of the individuals involved are the same ) and the random variables describing the infectious periods are mutually independent . Whenever an infective makes contact with a susceptible individual , the susceptible becomes infected and is immediately able to transmit infection . Thus there is no latent period , though this can be relaxed ; see Sect . 4 . 2 . The process continues until there is no infective remaining in the population , at which point the epidemic is deemed to have ceased . 123 Estimating the within - household infection rate in . . . 3 Early stages of an epidemic 3 . 1 Threshold parameter When the number of households m is large , the probability of a global infectious con - tact in the early stages of an epidemic being with a susceptible in a previously infected household is small . Thus , the initial behaviour of an epidemic in a community of house - holds can be approximated by a branching process of infected households , in which each global contact is assumed to be with an individual in a fully susceptible household . Let R ∗ be the mean number of global contacts that emanate from a typical household in this branching process . Then R ∗ is a threshold parameter for the households epidemic model , in that in the limit as m → ∞ , the epidemic takes off with non - zero probability if and only if R ∗ > 1 ; see Ball et al . ( 1997 ) , where calculation of R ∗ is described . The remainder of this paper focuses exclusively on epidemics having R ∗ > 1 and is concerned with epidemics that do take off . It is assumed that E [ T I ] = 1 , as this can be done without loss of generality by rescaling the time axis . 3 . 2 Basic approach to estimating λ L Suppose one wishes to estimate λ L for an epidemic that is observed whilst it is still in its initialstagesandisthereforestillmimickingtheinfectedhouseholdsbranchingprocess outlined above . For n = 1 , 2 , . . . and x = 0 , 1 , . . . , n − 1 , let p ( n ) basic ( x | λ L ) be the probability that a single - household epidemic ( without global infection ) in a household of size n , started by one initial infective , ﬁnishes with x susceptibles remaining . By using Eq . ( 2 . 5 ) of Ball ( 1986 ) , p ( n ) basic ( x | λ L ) ( x = 0 , 1 , . . . , n − 1 ) can be determined using the following triangular system of linear equations : j (cid:3) i = 1 (cid:4) n − i j − i (cid:5) p ( n ) basic ( n − i | λ L ) φ ( n − j ) i = (cid:4) n − 1 j − 1 (cid:5) , j = 1 , 2 , . . . , n , where φ ( θ ) = E [ exp ( − θ T I ) ] ( θ ≥ 0 ) is the moment - generating function of T I . Let a ( n ) x , y be the number of households of size n containing x susceptibles and y infectives at the time when the epidemic is observed . By considering only those households in which the single - household epidemic has ceased ( i . e . where x < n and y = 0 ) , one can attempt to estimate λ L by maximising the pseudolikelihood function L basic ( λ L | a ) = n max (cid:6) n = 2 n − 1 (cid:6) x = 0 p ( n ) basic ( x | λ L ) a ( n ) x , 0 . ( 3 . 1 ) Note that households of size 1 provide no information about λ L and that ( 3 . 1 ) is not a true likelihood function as it assumes independence between households . This method of estimation , which we call basic MPLE , is simple but does not use all of the information available since households in which infectives are still present are ignored . A similar approach using more of the information available is to use 123 F . Ball , L . Shaw maximum pseudolikelihood estimation but with censoring on households in which there are still infectives remaining . For n = 2 , 3 , . . . , n max and x = 0 , 1 , . . . , n − 1 , let q ( n ) basic ( x | λ L ) = (cid:2) xi = 0 p ( n ) basic ( i | λ L ) be the probability that a household of size n has at most x survivors from a single household epidemic and let b ( n ) x = (cid:2) n − x y = 1 a ( n ) x , y be the number of observed households of size n containing at least one infective and exactly x susceptibles . Such households will have at most x survivors once the single - household epidemic is completed . We can now use what is referred to as the censored MPLE approach for estimating λ L , with left - censoring for the number of survivors ( i . e . right - censoring for the total size ) , by maximising L censor ( λ L | a , b ) = n max (cid:6) n = 2 n − 1 (cid:6) x = 0 p ( n ) basic ( x | λ L ) a ( n ) x , 0 q ( n ) basic ( x | λ L ) b ( n ) x . Figure 1 shows how well the basic and censored MPLE methods perform in practice . For these histograms , epidemics were simulated in a population containing 1 , 000 , 000 households , with estimates of λ L taking place after the 1000th recovery has occurred . Any epidemic not reaching 1000 recoveries was considered not to have taken off and was ignored . Estimates of λ L were made for the ﬁrst 1000 epidemics to reach the 1000 recovery milestone . A large population was used to ensure that the simulated epidemics were still approximately mimicking a branching process at the time of estimation . The household distribution α that was used was [ 0 . 29 , 0 . 34 , 0 . 16 , 0 . 14 , 0 . 05 , 0 . 02 ] , i . e . n max = 6 and α 1 = 0 . 29 , α 2 = 0 . 34 , . . . , α 6 = 0 . 02 , as suggested by Fraser ( 2007 ) , and is based on UK census data from 2001 ( http : / / www . statistics . gov . uk / census / ) . The infectious period was chosen to be exponentially distributed , the infectious parameters were λ G = 1 and λ L = 1 , and all epidemics were initiated by a single individual , chosen uniformly at random from the population , becoming infected . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 1 . 4 0 50 100 150 200 250 300 Estimate of λ L F r equen cy Basic MPLE Censored MPLE Fig . 1 Estimatesof λ L , withatruevalueof1 , from1000epidemicsimulationsusingthebasicandcensored MPLE methods 123 Estimating the within - household infection rate in . . . It is clear from Figure 1 that the basic MPLE method severely underestimates λ L . Households in which the epidemic spreads locally are more likely to still be infective at the observation time than households infected at the same time but in which the initial infective does not infect any other individual locally . Consequently , households that contain less severe local epidemics are more likely to be included in the basic MPLE estimate , causing the observed underestimate of λ L . The censored MPLE approach appears to offer an improvement but repeated simulations with different parameters showed that this method generally overestimates λ L , as is observed in Fig . 1 . In order to obtain a more accurate estimate of λ L one must understand the infected households branching process in more detail . The basic idea is the following . If the approximating branching process does not go extinct , then it grows exponentially at a rate r , which depends on the parameters of the households epidemic model , and as time t → ∞ the fraction of completed single household epidemics ( in the branching process ) , in households of size n , that leave x members susceptible , converges to a limit ˜ p ( n ) x , 0 ( r | λ L ) ( x = 0 , 1 , . . . , n − 1 ) . Thus we assume that each observed household in the data has ﬁnal size that comes from that distribution and estimate λ L by maximising the pseudolikelihood obtained by replacing p ( n ) basic ( x | λ L ) by ˜ p ( n ) x , 0 ( ˆ r | λ L ) in ( 3 . 1 ) , where ˆ r is an estimate of the growth rate r ; see ( 4 . 5 ) in the next section , where calculation of ˜ p ( n ) x , 0 ( r | λ L ) is explained . 4 A new method 4 . 1 A more accurate estimator Consider the approximating branching process introduced in Sect . 3 . 1 , in which individuals correspond to infected households and an individual has one offspring whenever a global contact emanates from the corresponding single - household epi - demic . For n = 1 , 2 , . . . , n max , let E ( n ) H denote a typical size - n single - household epidemic , started by one member of the household being infected at time t = 0 . For t ≥ 0 , let X ( n ) H ( t ) and Y ( n ) H ( t ) be respectively the numbers of susceptibles and infec - tives in E ( n ) H at time t . Let T ( n ) = { ( x , y ) : x = 0 , 1 , . . . , n − 1 ; y = 0 , 1 , . . . , n − x } and , for ( x , y ) ∈ T ( n ) , let p ( n ) x , y ( t | λ L ) = P ( X ( n ) H ( t ) = x , Y ( n ) H ( t ) = y ) ( t ≥ 0 ) and ˜ p ( n ) x , y ( r | λ L ) = (cid:7) ∞ 0 e − rt p ( n ) x , y ( t | λ L ) d t ( r ≥ 0 ) . Further , let ξ ( n ) H be the point process describing times that global contacts emanate from E ( n ) H , so , for t ≥ 0 , ξ ( n ) H ( [ 0 , t ] ) is the number of global contacts that emanate from E ( n ) H during [ 0 , t ] . For t ≥ 0 let μ ( n ) ( t ) = E [ ξ ( n ) H ( [ 0 , t ] ) ] and note that μ ( n ) ( d t ) = λ G (cid:3) ( x , y ) ∈ T ( n ) yp ( n ) x , y ( t | λ L ) d t . ( 4 . 1 ) Let ξ H be a mixture of ξ ( 1 ) H , ξ ( 2 ) H , . . . , ξ ( n max ) H with mixing probabilities ˜ α 1 , ˜ α 2 , . . . , ˜ α n max . Then ξ H is a point process which describes the ages at which a typical individual 123 F . Ball , L . Shaw reproduces in the approximating branching process . Note that this branching process is a general ( i . e . Crump - Mode - Jagers ) branching process ; e . g . ( Haccou et al . 2005 , Section 3 . 3 ) . For t ≥ 0 , let μ ( t ) = E [ ξ H ( [ 0 , t ] ) ] = n max (cid:3) n = 1 ˜ α n μ ( n ) ( t ) . ( 4 . 2 ) The branching process has a Malthusian parameter r ∈ ( 0 , ∞ ) , given by the unique solution of the equation (cid:8) ∞ 0 e − rt μ ( d t ) = 1 . Note that , from ( 4 . 1 ) and ( 4 . 2 ) , r satisﬁes λ G n max (cid:3) n = 1 ˜ α n (cid:3) ( x , y ) ∈ T ( n ) y ˜ p ( n ) x , y ( r | λ L ) = 1 . ( 4 . 3 ) It is convenient to assume that individuals live forever in the branching process , though of course an individual ceases to reproduce as soon as there is no infective in the corresponding single - household epidemic . For n = 1 , 2 , . . . , n max and ( x , y ) ∈ T ( n ) , an individual in the branching process is said to be in state ( n , x , y ) if it corresponds to a single size - n household epidemic and there are x susceptibles and y infectives in that epidemic . Let T = { ( n , x , y ) : n = 1 , 2 , . . . , n max and ( x , y ) ∈ T ( n ) } . For t ≥ 0 and ( n , x , y ) ∈ T , let Y n , x , y ( t ) be the number of individuals in state ( n , x , y ) at time t in the branching process . Suppose that the Malthusian parameter r is strictly positive . Then it is easily veriﬁed that the conditions of Theorem 5 . 4 of Nerman ( 1981 ) are satisﬁed and it follows from that theorem that there exists a random variable W ≥ 0 , where W = 0 if and only if the branching process goes extinct , such that for all ( n , x , y ) ∈ T , e − rt Y n , x , y ( t ) a . s . −→ ˜ α n ˜ p ( n ) x , y ( r | λ L ) W as t → ∞ , ( 4 . 4 ) where a . s . −→ denotes almost sure convergence ( i . e . convergence with probability 1 ) . Note that (cid:2) ( x , y ) ∈ T ( n ) p ( n ) x , y ( t | λ L ) = 1 , so (cid:2) ( x , y ) ∈ T ( n ) ˜ p ( n ) x , y ( r | λ L ) = 1 / r ( n = 1 , 2 , . . . , n max ) . Thus , if the branching process does not go extinct , as t → ∞ the proportion of individuals that are in state ( n , x , y ) converges almost surely to ˜ α n r ˜ p ( n ) x , y ( r | λ L ) . Return to the households epidemic model . Recall that for ( n , x , y ) ∈ T , the number of households of size n that contain x susceptibles and y infectives when the epidemic is observed is denoted by a ( n ) x , y . Suppose that an estimate , ˆ r say , of the growth rate r is available . Then , provided the epidemic has taken off and it has been running for a sufﬁciently short period of time so that the branching process provides a good approximation but a sufﬁciently long time so that the above asymptotic composition of the branching process is applicable , λ L can be estimated by maximising the normalised pseudolikelihood function 123 Estimating the within - household infection rate in . . . L f ull ( λ L | a , ˆ r ) = n max (cid:6) n = 2 (cid:6) ( x , y ) ∈ T ( n ) ˜ p ( n ) x , y ( ˆ r | λ L ) a ( n ) x , y . ( 4 . 5 ) In Sect . 7 we prove that , under suitable conditions , the estimator ˆ λ L = argmax L f ull ( λ L | a , ˆ r ) is strongly consistent as the number of households m → ∞ , i . e . that ˆ λ L converges almost surely to the true value λ L as m → ∞ . Suppose that estimation is based only on completed single - household epidemics , as in the basic MPLE method . Then λ L may be estimated by maximising L f inal ( λ L | a , ˆ r ) = n max (cid:6) n = 2 n − 1 (cid:6) x = 0 ˜ p ( n ) x , 0 ( ˆ r | λ L ) a ( n ) x , 0 . Observe that subject to mild conditions , p ( n ) basic ( x | λ L ) = lim t →∞ p ( n ) x , 0 ( t | λ L ) = lim r → 0 + r ˜ p ( n ) x , 0 ( r | λ L ) . It follows that , under appropriate conditions , the basic MPLE method becomes asymp - totically unbiased as the growth rate tends down to zero . A key assumption of the estimator based on L f ull is that the exact state of a household is observable but this is unlikely to be realised in practice . Suppose that only recoveries are observed . For n = 2 , 3 , . . . , n max and j = 1 , 2 , . . . , n , let c ( n ) j be the observed number of households of size n with j recoveries , let A ( n ) j = { ( x , y ) ∈ T ( n ) : x + y = n − j } and let ˜ q ( n ) j ( r | λ L ) = (cid:3) ( x , y ) ∈ A ( n ) j ˜ p ( n ) x , y ( r | λ L ) / (cid:4) 1 r − ˜ q ( n ) 0 ( r | λ L ) (cid:5) , where ˜ q ( n ) 0 ( r | λ L ) = (cid:2) ny = 1 ˜ p ( n ) n − y , y ( r | λ L ) . Then λ L may be estimated by maximising L rec ( λ L | c , ˆ r ) = n max (cid:6) n = 2 n (cid:6) j = 1 ˜ q ( n ) j ( ˆ r | λ L ) c ( n ) j . ( 4 . 6 ) 4 . 2 Practicalities and extensions Estimates of λ L based upon L f ull and L rec are both dependent on knowing ˜ p ( n ) x , y ( r | λ L ) for ( n , x , y ) ∈ T , whichisnotpracticalinmanycircumstances . Itis , however , possible if we restrict ourselves to the Markovian case , in which the infectious period T I is exponentially distributed , by following a similar argument to that used in Section 4 of Pellis et al . ( 2011 ) to calculate real - time growth rates . Under these circumstances , the single - household epidemic E ( n ) H = { ( X ( n ) H ( t ) , Y ( n ) H ( t ) ) : t ≥ 0 } is a continuous - time Markov chain ( CTMC ) . Figure 2 shows the transition rates of E ( 3 ) H as a CTMC and also assigns labels to each state ( x , y ) ∈ T ( 3 ) . The exact assignment of these state 123 F . Ball , L . Shaw Fig . 2 Graphical representation of a single - household epidemic for households of size 3 as a CTMC , where ( x , y ) denotes the household state and state labels ( shown as superﬁxes ) for the CTMC are assigned as described . The values on the arrows represent transition rates between states in the single - household epidemic labels is unimportant , however it is convenient for the initial state ( n − 1 , 1 ) to be assigned as state 1 for a size - n household . Note that the state space T ( n ) of E ( n ) H has size s ( n ) = | T ( n ) | = n ( n + 3 ) / 2 . Let Q ( n ) ( λ L ) = [ q ( n ) ij ( λ L ) ] be the s ( n ) × s ( n ) transition - rate matrix of E ( n ) H , using the assigned labelling . Thus , if i (cid:7) = j then q ( n ) ij ( λ L ) is the transition rate of E ( n ) H from the state having label i to the state having label j , and q ( n ) ii ( λ L ) = − (cid:2) j (cid:7) = i q ( n ) ij ( λ L ) . Note that if a label i corresponds to a household state ( x , 0 ) , then q ( n ) ij ( λ L ) = 0 for all j . If k is the label assigned to state ( x , y ) ∈ T ( n ) then p ( n ) x , y ( t | λ L ) = ( e tQ ( n ) ( λ L ) ) 1 k , where e tQ ( n ) ( λ L ) = (cid:2) ∞ l = 0 ( t Q ( n ) ( λ L ) ) l / l ! denotes the usual matrix exponential . Hence , ˜ p ( n ) x , y ( r | λ L ) = ∞ (cid:8) 0 e − rt (cid:9) e tQ ( n ) ( λ L ) (cid:10) 1 k d t = (cid:9) [ r I s ( n ) − Q ( n ) ( λ L ) ] − 1 (cid:10) 1 k , where I s ( n ) is the s ( n ) × s ( n ) identity matrix . The estimating procedure described in Sect . 4 . 1 assumes that the distribution of the infectious period is known . The theory may be extended easily to the setting where a parametric form is assumed for the infectious period distribution , with unknown parameters that needtobeestimatedfrom thedata . For example , if theinfectious period is assumed to follow an exponential distribution with rate γ , then the preceding theory goes through with p ( n ) x , y ( t | λ L ) replaced in an obvious fashion by p ( n ) x , y ( t | λ L , γ ) and ( λ L , γ ) being estimated by maximising the appropriate normalised pseudolikelihood function . Note that for ﬁnal outcome data it is impossible to estimate both λ L and γ , since the ﬁnal outcome distribution is invariant to rescaling of time . However , that is not the case in an emerging epidemic setting , as the exponential growth rate is clearly time - scale dependent . The assumption of exponentially distributed infectious periods can be relaxed by using the phase method ( e . g . Asmussen 1987 , pp . 71 – 78 ) . For example , a J - stage Erlang distribution for the infectious period can be accommodated by split - ting the infectious period into J stages having independent exponentially distributed durations . The Markov property is maintained by expanding the state space of a 123 Estimating the within - household infection rate in . . . single - household epidemic to include the number of infectives in each of the J stages . This can lead to an appreciable increase in the size of T ( n ) . One can also extend the model to an SEIR ( susceptible → exposed → infectious → recovered ) model by introducing a latent period . In the simplest case , both infectious and latent periods follow exponential distributions , in which case the state space of a single - household epidemic is extended to include the number of exposed ( i . e . latent ) individuals , but again the phase method can be used to accommodate more general distributions . The methodology can be extended to allow the local contact rate to depend on household size . For n = 1 , 2 , . . . , n max , let λ ( n ) L denote the local contact rate in a household of size n . Then , provided there are enough households of each size in the sample , ( λ ( 2 ) L , λ ( 3 ) L , . . . λ ( n max ) L ) can be estimated jointly , e . g . by replacing λ L by λ ( n ) L in ( 4 . 5 ) . Alternatively , one can assume a speciﬁc form for λ ( n ) L , Cauchemez et al . ( 2004 ) use λ ( n ) L = λ L / n for inﬂuenza , and estimate its unknown parameter ( here λ L ) in the obvious fashion . 5 Application to the Reed - Frost model 5 . 1 The Reed - Frost model Under the Reed - Frost model , the latent period is assumed to have a constant duration , which without loss of generality can be taken to be one unit of time , and the infectious period is reduced to a single point in time . Consider an epidemic initiated by a small number of individuals being infected at time t = 0 among a population having the same structure as that outlined in Sect . 2 . For t = 0 , 1 , . . . , individuals infected at time t become infectious at time t + 1 . Different infectives behave independently of each other . Consider an individual that is infected at time t . At time t + 1 it makes global infectious contact with any given susceptible in the population with probability p G = 1 − exp ( − μ G / N ) and , additionally and independently , local infectious contact with any given susceptible in its household with probability p L . Moreover , contacts between this infectious individual and distinct susceptible individuals are mutually independent . Any susceptible individual that is contacted by at least one infective at time t is infected and becomes infectious at time t + 1 . The process continues until there is no infective left in the population . Again , we consider the case of an emerging epidemic , so it is assumed that , when the epidemic is observed , the proliferation of infected households still mimics a discrete - time branching process . Note that in the limit as the population size N → ∞ , the mean number of global contacts made by a typical infective is μ G . Note also that upon infection a household of size n is in state ( n , n − 1 , 1 ) and that in subsequent generations that household contains at least one recovered individual . We assume that it is possible to observe the geometric growth rate ρ ( p L , μ G ) of the approximating branching process . The parameter μ G increases with ρ ( p L , μ G ) for ﬁxed p L , so for any estimate of p L , an estimate for μ G is pre - determined since it is assumed that ρ ( p L , μ G ) can be observed directly . 123 F . Ball , L . Shaw 5 . 2 Estimating p L The local contact probability p L can be estimated by approximating the early stages of a Reed - Frost epidemic with a discrete - time multitype branching process S . Deﬁne the type space of S as T RF = { ( n , n − 1 , 1 ) : 1 ≤ n ≤ n max } ∪ (cid:11) n max n = 1 { ( n , x , y ) : x ≥ 0 , y ≥ 1 , x + y < n } and label the elements of T RF as 1 , 2 , . . . , k where k = | T RF | = n max + (cid:2) n max n = 2 n ( n − 1 ) 2 = n max ( n 2 max + 5 ) / 6 . The type space includes all possible household states where infection is still present . Let M be the mean matrix of S on T RF , so the element m ij is the expected number of type - j individuals that a typical type - i individual gives birth to upon death . Under the Reed - Frost model , a household in state ( n , x , y ) gives birth to an expected number of ˜ α n (cid:10) μ G households in state ( n (cid:10) , n (cid:10) − 1 , 1 ) , for n (cid:10) = 1 , 2 , . . . , n max , as a result of global infectious contacts , and to an expected number of (cid:12) xz (cid:13) ( 1 − ( 1 − p L ) y ) z ( 1 − p L ) y ( x − z ) households in state ( n , x − z , z ) , for z = 0 , 1 , . . . , x , from local contacts . Let Y t = ( Y t 1 , Y t 2 , . . . , Y tk ) denote the number of individuals of each type from T RF alive after t generations of S and let ρ ( p L , μ G ) be the maximal eigenvalue of M . Assume that ρ ( p L , μ G ) > 1 , so the branching process is supercritical . Kesten and Stigum ( 1966 ) show that if u ( p L , μ G ) is the left - eigenvector associated with ρ ( p L , μ G ) , normalised so that its components sum to one , then ρ ( p L , μ G ) − t Y t a . s . −→ W u ( p L , μ G ) as t → ∞ , ( 5 . 1 ) where W is a non - negative random variable such that W = 0 if and only if S becomes extinct . The eigenvector u ( p L , μ G ) therefore gives the proportions of individuals of each type in S as t → ∞ , conditional upon S not going extinct . It follows from ( 5 . 1 ) that ρ ( p L , μ G ) − t t (cid:3) t (cid:10) = 1 Y t (cid:10) a . s . −→ ρ ( p L , μ G ) ρ ( p L , μ G ) − 1 W u ( p L , μ G ) as t → ∞ . ( 5 . 2 ) Let Z t = ( Z t 1 , Z t 2 , . . . , Z tk ) , where Z ti denotes the number of single - household epidemics that terminate before t generations of the epidemic , for which the last active household state was i ∈ T RF . A household in state ( n , x , y ) at time t (cid:10) has probability ( 1 − p L ) xy of containing no infectives at time t (cid:10) + 1 . Hence , if ( n , x , y ) is the household state associated with a type - i individual in S , it follows from ( 5 . 2 ) and the strong law of large numbers that , for i = 1 , 2 , . . . , k , ρ ( p L , μ G ) − t Z ti a . s . −→ W ( 1 − p L ) xy ρ ( p L , μ G ) − 1 u i ( p L , μ G ) as t → ∞ . Let u ( n , x , y ) = u i where i is the label of a type - ( n , x , y ) individual in S . By noting that any single - household epidemic ﬁnishing the generation after it was in state ( n , x , y ) ﬁnishes with x susceptibles remaining , deﬁne the function p RFf ull ( n , x , y | p L , μ G ) as follows : 123 Estimating the within - household infection rate in . . . p RFf ull ( n , x , y | p L , μ G ) = (cid:14) Ku ( n , x , y ) if y ≥ 1 , K (cid:2) n − x − 1 y = 1 ( 1 − p L ) xy u ( n , x , 1 ) ( p L , μ G ) ρ ( p L , μ G ) − 1 if y = 0 , where K is chosen such that n max (cid:3) n = 1 ⎡ ⎣ ⎛ ⎝ n − 1 (cid:3) x = 0 n − x − 1 (cid:3) y = 0 p RFf ull ( n , x , y | p L , μ G ) ⎞ ⎠ + p RFf ull ( n , n − 1 , 1 | p L , μ G ) ⎤ ⎦ = 1 . One can then estimate p L by performing maximum pseudolikelihood estimation in exactly the same manner as described using L f ull in Sect . 4 . 1 . Note that this esti - mation procedure can be adapted to the case where susceptibles and infectives are indistinguishable , using the same method as described for L rec in Sect . 4 . 1 . 6 Numerical illustrations 6 . 1 Methods of estimation We illustrate applications of the preceding theory using simulation studies with parameter choices loosely based on Fraser’s ( 2007 ) analysis of varicella data . Simu - lations are performed on a population of m = 10 , 000 households with distribution α = [ 0 . 13 , 0 . 30 , 0 . 23 , 0 . 18 , 0 . 09 , 0 . 07 ] . This distribution is based on the 1961 UK census data ( http : / / www . statistics . gov . uk / census / ) and contains a higher pro - portion of larger households than the 2001 distribution used previously , implying that local infectious contacts should have a greater effect on the simulated epi - demics . The population size is chosen so that it is small enough to represent a realistic population cluster ( e . g . a town ) but large enough so that there are sufﬁ - cient data to estimate λ L whilst the epidemic is still in its emerging phase . For the sake of simplicity , an exponentially distributed infectious period with rate 1 is used . Fraser suggests having a within - household susceptible - infectious escape prob - ability of 0 . 39 , as reported by Hope - Simpson ( 1952 ) , and that infected individuals be expected to infect 1 . 21 susceptibles outside of their household . This implies parameter values of λ G = 1 . 21 , λ L = 1 . 565 [ since φ ( 1 . 565 ) = 0 . 39 , where φ ( θ ) = E [ exp ( − θ T I ) ] = ( 1 + θ ) − 1 ] and r = 1 . 762 [ recall ( 4 . 3 ) ] in the continuous - time case and μ G = 1 . 21 , p L = 0 . 61 ( = 1 − 0 . 39 ) and ρ ( p L , μ G ) = 2 . 248 under the Reed - Frost model . Unless stated otherwise , growth rates are estimated by ﬁtting a straight line to the logarithm of the number of recoveries , as a function of time , using the polyﬁt function in MATLAB . The ﬁrst 20 recoveries are ignored when estimating r , to enable the exponential growing phase of the epidemic to settle in . Note that , while this is the most common method to estimate r , other methods are also considered in the literature ; see , e . g . Ma et al . ( 2014 ) . For illustrative purposes , estimates of λ L are given in terms of the secondary attack rate ( SAR ) , as deﬁned by Longini and Koopman ( 1982 ) . The SAR is the probability that an infective infects locally a given household member , expressed as a percentage , and is given by 100 ( 1 − φ ( λ L ) ) ( Note that with the continuous - time and discrete - time 123 F . Ball , L . Shaw 0 2 4 6 8 10 12 0 10 20 30 40 50 60 70 80 90 100 Time , t E s t i m a t e o f SA R ( % ) Recovery−pseudolikelihoodFull−pseudolikelihoodCensored MPLE Basic MPLE True SAR Final−size Fig . 3 Estimates of the SAR ( true value 61 % ) through time for a single SIR households epidemic . The four estimation methods outlined earlier in the paper are shown along with estimates of the SAR using the ﬁnal - size method models , matching the SAR and λ G results in different growth rates ) . The SAR is used since the variance of estimates of λ L , under any of the methods outlined in this paper , increases greatly as the true value of λ L increases , whereas the variance of the SAR estimates is closer to being constant whatever its true value . Note that for a given distribution of T I , SAR strictly increases with λ L . It is shown in Sects . 3 and 4 that an emerging households epidemic can be approx - imated by a Crump - Mode - Jagers branching process ( CMJBP ) , however there is no indication as to when an epidemic can still be considered to be in its emerging phase . Figure 3 shows estimates of the SAR throughout the lifetime of a single simulated SIR epidemic using the parameters outlined above . Estimates of λ L ( and hence of the SAR using the above formula ) were made at regular intervals throughout the epidemic using basic MPLE , censored MPLE , full - and recovery - pseudolikelihood estimation methods [ using ( 4 . 5 ) and ( 4 . 6 ) , respectively ] and the pseudolikelihood method of Ball and Lyne ( 2015 ) ( c . f . Section 5 . 1 of Ball et al . 1997 ) , which uses the distribution of susceptible individuals in households of all sizes at the end of an epidemic and is referred to as the ﬁnal - size method of estimation . Note that for the basic MPLE method , it takes some time before the SAR is estimated to be non - zero . This can be explained by the reliance of this method on household epidemics being completed since the basic MPLE method will only pick up any trace of local infectivity when a completed single - household epidemic with more than one recovered individual is observed . As would be expected , the ﬁnal - size method appears to tend to the true SAR value as t → ∞ . The initially large estimates from the ﬁnal size data can be explained by noting that few households are infected at this time but that recoveries are clustered within households . The former point suggests a very low value of λ G ( considering that the estimator assumes that the epidemic is complete ) , so the estimate of the SAR is large to account for the clustering of recovered individuals . Note that the recovery - pseudolikelihood method estimates the SAR to be 100 % as the epidemic approaches 123 Estimating the within - household infection rate in . . . completion . In the epidemic outlined above , with growth rate r = 1 . 762 but with an SAR of 100 % , appreciably fewer than half of all infected households of size 3 and above are expected to contain only recovered individuals during the emerging phase . Once the true epidemic ( with an SAR of 61 % ) is completed , appreciably more than 80 % of households of size 3 and above in the entire population are expected to contain only recovered individuals . This suggests that there is a threshold , after the epidemic has stopped approximating a CMJBP , when the number of recovered individuals in infected households exceeds the expectations of even the maximum possible SAR in the recovery - pseudolikelihood estimation method , hence this method will continue to give an MPLE for the SAR as 100 % for the remainder of the epidemic . Figure 3 shows that once an epidemic has had sufﬁcient time to establish itself , there is a window when both the full and recovery CMJBP methods appear to give a good estimate of the SAR . Moreover , the length of this window is roughly the same for both CMJBP methods , although the recovery method gives a less reliable estimate owing to it using less information . This is conﬁrmed in Fig . 4 which shows kernel density estimates of the distribution of the estimator of SAR for both CMJBP methods from 1000 simulations of the epidemic outlined above . The plots marked ‘ γ known’ use the methodology described in Sect . 4 . 1 and those marked ‘ γ unknown’ assume that γ is also estimated , as described in Sect . 4 . 2 . Estimates of the SAR were made from each simulation after 500 recoveries were observed for reasons outlined below . Irrespective of whether or not γ is also estimated , both the full and recovery methods yield estimates of the SAR that are centred broadly around the true value of 61 % but the recovery method yields estimates having a far greater variance . The variance of the estimates is greater when γ is assumed unknown than when it is assumed known but the difference is appreciably smaller than that between the full and recovery methods . 40 45 50 55 60 65 70 75 80 85 0 0 . 02 0 . 04 0 . 06 0 . 08 0 . 1 0 . 12 0 . 14 0 . 16 0 . 18 0 . 2 Estimate of SAR ( % ) 40 50 60 70 80 0 . 5 1 1 . 5 Estimate of SAR ( % ) E s t i m a t e o f γ Full−pseudolikelihood ( γ known ) Full−pseudolikelihood ( γ unknown ) Recovery−pseudolikelihood ( γ known ) Recovery−pseudolikelihood ( γ unknown ) Fig . 4 Kernel density estimates of the distribution of the estimator the SAR ( true value 61 % ) based on 1000 simulations of the outlined epidemic using the full and recovery CMJBP estimation methods , both with and without the recovery rate γ ( true value 1 . 00 ) being also estimated . Inset scatter plot of estimates of ( SAR , γ ) for the full - pseudolikelihood ( γ unknown ) method 123 F . Ball , L . Shaw 0 100 200 300 400 500 600 0 10 20 30 40 50 60 70 80 90 100 Number of recoveries E M SE o r SA R e s t i m a t e s m = 500 m = 1000 m = 3000 m = 10000 Fig . 5 EMSE of estimates of the SAR using the full - pseudolikelihood method . See text for details The inset of Fig . 4 shows a scatter plot of the estimates of ( SAR , γ ) using the full - pseudolikelihood method , which indicates that the estimates of the SAR and γ are positively correlated . Repeated simulations using different population sizes yielded very similar results to those seen in Fig . 3 , in that there appears to be a window once the epidemic has established itself when a households SIR epidemic can still be considered to be in its emerging phase and the full - pseudolikelihood estimate is relatively accurate . The start of this window corresponds to when the the asymptotic behaviour of the approximating CMJBP kicks in , the timing of which is independent of the total population size N , provided N is sufﬁciently large . Further simulations suggested that this window ends when approximately N 2 / 3 recoveries have occurred , after which the CMJBP approximation of the households epidemic breaks down . The time taken for N 2 / 3 recoveries to take place depends on the severity of the epidemic and the population size . Note that Barbour and Utev ( 2004 ) prove that a homogeneously mixing Reed - Frost model can be closely approximated by a branching process up until order N 2 / 3 individuals have been infected . The above points are illustrated in Fig . 5 , which shows estimates of the mean squared error ( EMSE ) of estimates of the SAR , using the full - pseudolikelihood method and assuming that γ ( = 1 ) is known , throughout the emerging stages of 1000 simulated epidemics among populations with differing numbers of households but with the same population structure α , growth - rate r and SAR as given above . If SAR 1 , SAR 2 , . . . , SAR 1000 denote the estimates of the SAR ( true value 61 % ) obtained from 1000 simulated epidemics then EMSE = 1 1000 (cid:2) 1000 i = 1 ( SAR i − 61 ) 2 . It is assumed that the value r is known , in order that the ﬁgure illustrates only when the distribution of household states in an emerging epidemic conforms to its equivalent branching process . It can be seen that it takes approximately 50 recoveries to occur ( regardless of population size ) for the EMSE to settle to a reasonable value due to the high variance of SAR estimates when too few households have been infected and the epidemic is yet to establish itself in the population . The length of this window 123 Estimating the within - household infection rate in . . . then clearly increases with population size as a consequence of a higher percentage of fully susceptible households still being available at this stage of the epidemic . For the population considered in most of the numerical illustrations , i . e . consisting of 10 , 000 households , it appears appropriate to estimate the SAR after approximately 500 recoveries have occurred . We now consider estimation of p L in the Reed - Frost model . A single - household epidemic in a household of size n can last for at most n generations . Thus , under the assumption that all global contacts are with individuals in previously unin - fected households , if the households epidemic is observed in the k th generation , one can estimate p L by using an adaptation of the basic MPLE method from the continuous time case as follows . If one wishes to make the estimate in the k th generation then the single - household epidemics in all households with at least one recovery in the ( k − n max + 1 ) th generation are certain to have been completed . One can then estimate p L by using only the latter households and considering the ﬁnal - size distributions of single - household epidemics under the Reed - Frost model to perform the basic MPLE method of estimation in the same manner as before . This circumvents the problem of uncompleted epidemics in households but at the expense of ignoring the information about p L contained in those single - household epidemics . Figure 6 gives kernel density estimates of p L ( true value 0 . 61 ) for 1000 simulations of Reed - Frost epidemics with parameters as outlined at the beginning of this section . Estimates were made in the ﬁrst generation at which 1000 recoveries were observed using the full - and recovery - pseudolikelihood methods ( i . e . both with and without the ability to distinguish between susceptibles and infectives ) and by using the adapted basic MPLE method outlined above . Note that all three methods appear to give esti - mates that are centred roughly around the true value of p L , however , the adapted basic MPLE method estimates have a far larger variance than the other estimates , suggest - ing that the methods of estimation outlined in Sect . 4 . 1 are preferable , regardless of whether or not infectives are distinguishable . Estimates were made after 1000 recover - 0 . 35 0 . 4 0 . 45 0 . 5 0 . 55 0 . 6 0 . 65 0 . 7 0 . 75 0 . 8 0 . 85 0 5 10 15 20 25 30 35 40 Estimate of p L Full−pseudolikelihoodRecovery−pseudolikelihoodAdapted basic Fig . 6 Kernel density estimates of the distribution of the estimator of p L ( true value 0 . 61 ) based on 1000 simulations of Reed - Frost type epidemics ; see text for details 123 F . Ball , L . Shaw ies had been observed rather than the 500 recoveries used in the continuous - time case , owing to the time it takes for 500 recoveries to occur potentially being n max − 1 = 5 generations . 6 . 2 Relationship between parameters of the model and bias of the basic and censored MPLE methods We examine the extent of the bias of the basic and censored MPLE methods , and how the bias is affected by various parameters of an epidemic , by considering “per - fect” household data , a , from an emerging epidemic , as determined by its CMJBP or multitype branching process approximation . Households data are considered to be perfect for an emerging epidemic in continuous - time with paramerters λ L and r , if the proportion of households in state ( n , x , y ) is exactly ˜ α n r ˜ p ( n ) x , y ( r | λ L ) for all ( n , x , y ) ∈ T ( Note that with perfect data , ˆ λ L = argmax ˜ l ( ∞ ) f ull , see Eq . ( 7 . 6 ) in Sect . 7 ) . Similarly , perfect data for an emerging Reed - Frost epidemic with parameters p L and μ G is achieved when the proportion of households in state ( n , x , y ) is exactly p RFf ull ( n , x , y | p L , μ G ) for all ( n , x , y ) ∈ T RF . Note that in both cases , the distribu - tion of household states representing perfect data is also dependent on the population structure α = ( α 1 , α 2 , . . . , α n max ) . Note also that assuming perfect data is equivalent to assuming an inﬁnite population , in which all households are observed , and that in this setting , estimates of the SAR have no illustrative advantage over those of λ L , since all estimates have zero variance . 6 . 2 . 1 Effect of local contact rate Figure 7 illustrates the effect of the local contact rate on the bias of the basic and censored MPLE methods by considering estimates of p L for emerging Reed - Frost epidemics with geometric growth rate ρ = 2 . 248 and population distribution α = 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8 0 . 9 1 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 0 . 6 0 . 7 0 . 8 0 . 9 1 p L E s t i m a t e o f p L a ss u m i ng i n f i n i t e da t a Censored MPLE Actual value Basic MPLE Fig . 7 Estimates of different values p L assuming perfect data in emerging Reed - Frost type epidemics , ρ = 2 . 248 , using the basic and censored MPLE methods 123 Estimating the within - household infection rate in . . . 2 4 6 8 10 12 14 16 18 20 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 1 . 4 1 . 6 1 . 8 2 Household size E s t i m a t e o f λ L a ss u m i ng i n f i n i t e da t a Censored MPLE Actual value Basic MPLE 2 4 6 8 10 12 14 16 18 20 0 1 2 3 4 5 6 7 8 9 Household size E s t i m a t e o f λ L a ss u m i ng i n f i n i t e da t a Censored MPLE Actual value Basic MPLE Fig . 8 Estimates of λ L assuming perfect data for emerging epidemics , with r = 1 . 762 , among populations with equal household sizes using the basic and censored MPLE methods . The upper plot takes λ L = 1 . 565 for all household sizes . The lower plot adopts the model λ ( n ) L = λ L / n , where n is household size and λ L = 6 . 75 [ 0 . 13 , 0 . 30 , 0 . 23 , 0 . 18 , 0 . 09 , 0 . 07 ] , asgiveninSect . 6 . 1butwithdifferentlocalcontact probabilities . Note that given perfect data , both estimates converge to the true value of p L as p L tends to 0 or 1 . This can be easily explained by noting that all completed single - household epidemics in households of size n will have exactly 1 recovery if p L = 0 and exactly n recoveries if p L = 1 , implying that the issue of less severe single - household epidemics being more likely to be included in the estimation data becomes irrelevant since all single - household epidemics are of the same severity . The basic and censored MPLE methods appear to be at their most biased in the region 0 . 3 < p L < 0 . 6 when the proportion of recoveries from single - household epidemics 123 F . Ball , L . Shaw in households of sizes 3 and 4 ( which make up a signiﬁcant portion of the population ) are distributed in a relatively uniform manner . 6 . 2 . 2 Effect of household size Figure 8 gives two plots showing estimates of λ L in continuous - time epidemics with real - time growth rate r = 1 . 762 assuming perfect data for populations of equal sized households from 2 to 20 . The upper plot considers the case where λ L = 1 . 565 , independent of household size . In this plot the basic MPLE estimate considerably underestimates λ L regardless of household size but the bias appears to get marginally worse as household size increases . This can be attributed to the most severe single - household epidemics taking longer in larger households and hence fewer of the more severe epidemics are completed by the time of estimation in larger households . The censored MPLE fares better however and appears to converge towards the true value of λ L as household size increases . Since λ L is a person - to - person contact rate , larger households are far more likely to have severe epidemics than smaller households with the same λ L , since the number of local contacts in a household increases quadratically with n . Therefore , as household size increases , the proportion of recoveries from single - household epidemics with the same local contact rate becomes less uniform , leading to less bias in the censored MPLE estimate ( as observed in Fig . 7 ) . The lower plot of Fig . 8 uses the same real - time growth rate and population distrib - utions but assumes that the local infection rate depends on household size , speciﬁcally that λ ( n ) L = λ L / n with λ L = 6 . 75 ( see Sect . 4 . 2 ) . This value was chosen as it gives a value of λ G = 1 . 21 when r = 1 . 762 from the population distribution α as used previ - ously in this section . Here it can be seen that the basic and censored MPLE approaches both become more biased as household size increases . In the basic case this is for the same reasons as before , whereas in the censored case , the additional local contacts that 0 0 . 5 1 1 . 5 2 2 . 5 3 3 . 5 4 4 . 5 5 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 1 . 4 1 . 6 1 . 8 2 Real−time growth rate , r E s t i m a t e o f λ L a ss u m i ng i n f i n i t e da t a Censored MPLE Actual value Basic MPLE Fig . 9 Estimates of λ L assuming perfect data in emerging epidemics with different real - time growth rates r using the basic and censored MPLE methods 123 Estimating the within - household infection rate in . . . come from an increased household size are compensated by the reduction of the local contact rate , leading to the relatively uniform distribution of recoveries in a single household - epidemic which causes bias . 6 . 2 . 3 Effect of growth rate Figure 9 shows estimates of λ L in emerging epidemics with λ L and α as deﬁned in Sect . 6 . 1 . It is clear from the plot that both the basic and censored MPLE estimates converge to the true value of λ L as r → 0 , as is proved in Sect . 4 . 1 . 7 Strong consistency of estimators In this section we consider the asymptotic behaviour of the estimators of λ L described in Sect . 4 as the number of households in the population tends to inﬁnity . Speciﬁ - cally we show that , under suitable conditions , the estimators are strongly consistent , conditional upon the epidemic taking off . Consider a sequence of epidemics E ( m ) ( m = 1 , 2 , . . . ) , indexed by the number of households in the population . For m = 1 , 2 , . . . and n = 1 , 2 , . . . , n max , let α ( m ) n be the proportion of households in E ( m ) that have size n . The epidemic E ( m ) is as deﬁned in Sect . 2 and has one initial infective , who is chosen uniformly at random from the population . The infection parameters ( λ L , λ G ) and the infectious period distribution are all assumed to be independent of m , as is the maximum household size n max . It is assumed that α ( m ) n → α n as n → ∞ ( n = 1 , 2 , . . . , n max ) . Let E ( ∞ ) denote the general branching process , introduced in Sect . 3 and analysed further in Sect . 4 , which approximates the epidemic E ( m ) for suitably large m . Recall that for ( n , x , y ) ∈ T , the number of individuals in E ( ∞ ) having state ( n , x , y ) at time t is denoted by Y n , x , y ( t ) . For m = 1 , 2 , . . . , ( n , x , y ) ∈ T and t ≥ 0 , let Y ( m ) n , x , y ( t ) denote the number of size - n households in E ( m ) that have x susceptibles and y infectives at time t . Let T L = { ( n , x , y ) ∈ T : y ≥ 1 } . For t ≥ 0 , let Y ( t ) = (cid:2) ( n , x , y ) ∈ T L Y n , x , y ( t ) denote the number of “live” individuals in E ( ∞ ) at time t . Recall that r denotes the Malthusian parameter of E ( ∞ ) . Theorem 7 . 1 Suppose that r > 0 . Then there is a probability space ( Ω , F , P ) on which are deﬁned a sequence of epidemics E ( m ) ( m ≥ 1 ) and the approximat - ing branching process E ( ∞ ) satisfying the following property . Let A = { ω ∈ R : lim t →∞ Y ( t , ω ) = 0 } denote the set on which the branching process E ( ∞ ) goes extinct . Then for P - almost all ω ∈ A c and any c ∈ ( 0 , 12 r − 1 ) , sup 0 ≤ t ≤ c log m max ( n , x , y ) ∈ T | Y ( m ) n , x , y ( t , ω ) − Y n , x , y ( t , ω ) | = 0 ( 7 . 1 ) for all sufﬁciently large m . Proof For m = 1 , 2 , . . . , let N ( m ) = m (cid:2) n max n = 1 n α ( m ) n denote the total number of individuals in the population among which E ( m ) is spreading . Let ( Ω , F , P ) be a prob - ability space on which are deﬁned the following independent sets of random quantities : 123 F . Ball , L . Shaw ( i ) a realisation of the branching process E ( ∞ ) ; ( ii ) χ ( m ) k ( m = 1 , 2 , . . . ; k = 1 , 2 , . . . ) , where for each m , χ ( m ) 1 , χ ( m ) 1 , . . . are independent and uniformly distributed on { 1 , 2 , . . . , N ( m ) } . For m = 1 , 2 , . . . , a realisation of the early stages of the epidemic E ( m ) can be deﬁned on ( Ω , F , P ) as follows . Label the individuals in the m th population 1 , 2 , . . . , N ( m ) . The initial infective in E ( m ) has a label given by χ ( m ) 1 and corresponds to the ancestor in the branching process E ( ∞ ) . Births of individuals in E ( ∞ ) correspond to global contacts being made in E ( m ) . For k = 1 , 2 , . . . , the individual contacted in E ( m ) corresponding to the k th birth in E ( ∞ ) has a label given by χ ( m ) k + 1 . If the household in which χ ( m ) k + 1 resides has not been infected previously , then χ ( m ) k + 1 becomes infected in E ( m ) and initiates a new single - household epidemic in E ( m ) whose course and subsequent global contacts is given by the life - history of the ( k + 1 ) th individual in E ( ∞ ) . If the household in which χ ( m ) k + 1 resides has been infected previously then the construction of E ( m ) needs modifying but such detail is not required for the present proof . For m = 1 , 2 , . . . , let M ( m ) be the smallest k ≥ 2 such that χ ( m ) k belongs to the same household as χ ( m ) l for some l = 1 , 2 , . . . , k − 1 , and let ˆ M ( m ) be a random variable , taking values in 2 , 3 , . . . , having survivor function P ( ˆ M ( m ) > k ) = k − 1 (cid:6) i = 1 (cid:4) 1 − in max N ( m ) (cid:5) ( k = 2 , 3 , . . . ) . Note that M ( m ) is stochastically greater than ˆ M ( m ) , since the maximum house - hold size is n max , and ( c . f . Aldous ( 1985 ) , p . 96 ) m − 1 / 2 ˆ M ( m ) D −→ ˆ M as m → ∞ , where D −→ denotes convergence in distribution and ˆ M has density f ( x ) = n max x μ − 1 H exp ( − n max μ − 1 H x 2 / 2 ) ( x > 0 ) , with μ H = (cid:2) n max n = 1 n α n being the mean household size ( Note that m − 1 N ( m ) → μ H as m → ∞ ) . By the Skorokhod representation theorem , the random variables ˆ M , M ( m ) and ˆ M ( m ) ( m = 1 , 2 , . . . ) may be deﬁned on a common probability space so that P ( M ( m ) ≥ ˆ M ( m ) , m = 1 , 2 , . . . ) = 1 and m − 1 / 2 ˆ M ( m ) a . s . −→ ˆ M as m → ∞ . Fur - ther , that probability space may be augmented to carry random variables χ ( m ) k ( m = 1 , 2 , . . . ; k = 1 , 2 , . . . ) distributed as above and consistent with M ( m ) ( m = 1 , 2 , . . . ) . Thus we may assume that the random variables ˆ M ( m ) ( m = 1 , 2 , . . . ) and ˆ M are also deﬁned on ( Ω , F , P ) and that there exists B ∈ F , with P ( B ) = 1 , such that , for all ω ∈ B , M ( m ) ( ω ) ≥ ˆ M ( m ) ( ω ) and m − 1 / 2 ˆ M ( m ) ( ω ) → ˆ M ( ω ) as m → ∞ . ( 7 . 2 ) For t ≥ 0 , let T ( t ) be the number of births in E ( ∞ ) during [ 0 , t ] , includ - ing the ancestor . Then T ( t ) = (cid:2) ( n , x , y ) ∈ T Y n , x , y ( t ) and it follows from ( 4 . 4 ) that e − rt T ( t ) a . s . −→ r − 1 W as t → ∞ . Recall that W = 0 if and only if the branching process goes extinct . Thus there exists C ∈ F , with C ⊆ A c and P ( C ) = P ( A c ) , 123 Estimating the within - household infection rate in . . . such that for all ω ∈ C , e − rt T ( t , ω ) → r − 1 W ( ω ) as t → ∞ . ( 7 . 3 ) Let ω ∈ B ∩ C and c ∈ ( 0 , 12 r − 1 ) . Then it follows from ( 7 . 3 ) that T ( c log m , ω ) < 2 m rc r − 1 W ( ω ) for all sufﬁciently large m . Also , ( 7 . 2 ) implies that M ( m ) ( ω ) > 12 m 1 / 2 ˆ M ( ω ) for all sufﬁciently large m . Hence , since rc < 1 / 2 , for all sufﬁciently large m , every birth in E ( ∞ ) ( ω ) during ( 0 , c log m ] corresponds to a global contact with an uninfected household in E ( m ) ( ω ) and ( 7 . 1 ) follows since P ( B ∩ C ) = P ( A c ) . (cid:13)(cid:14) We turn now to estimation of λ L . Suppose that the epidemic E ( m ) is observed at time t ( m ) , where the sequence ( t ( m ) ) satisﬁes ( i ) t ( m ) → ∞ as m → ∞ , ( ii ) t ( m ) ≤ c log m for all sufﬁciently large m , for some c ≤ ( 2 r ) − 1 . Suppose also that an estimator ˆ r ( m ) of the growth rate r is available such that ˆ r ( m ) a . s . −→ A c r as m → ∞ , where a . s . −→ A c means convergence for P - almost all ω ∈ A c . It is easily veriﬁed that one such estimator is ˆ r ( m ) = log [ T ( m ) ( t ( m ) ) / T ( m ) ( t ( m ) / 2 ) ] / ( t ( m ) / 2 ) , where T ( m ) ( t ) is the total number of households that have been infected in E ( m ) by time t . Let ˆ λ ( m ) L , f ull denote the estimator obtained by maximising the function L f ull ( λ L | a , ˆ r ( m ) ) deﬁned at ( 4 . 5 ) . For ease of exposition , we assume that all infected households are observed , so , in our present notation , a ( m ) x , y = Y ( m ) n , x , y ( t ( m ) ) for ( n , x , y ) ∈ T . The following theorems are easily extended to the situation when only some infected households are observed ; of course , the number of observed households must tend to inﬁnity as m → ∞ and the sampling mechanism must be independent of disease progression within households . In these theorems , it is convenient to denote the true value of λ L by ¯ λ L . Theorem 7 . 2 Under the conditions of Theorem 7 . 1 , ˆ λ ( m ) L , f ull a . s . −→ A c ¯ λ L as m → ∞ . Proof First note that from ( 4 . 5 ) , ˆ λ ( m ) L , f ull = argmax ˜ l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) , ( 7 . 4 ) where ˜ l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) = W − 1 e − rt ( m ) n max (cid:3) n = 2 (cid:3) ( x , y ) ∈ T ( n ) Y ( m ) n , x , y (cid:9) t ( m ) (cid:10) log ˜ p ( n ) x , y (cid:9) ˆ r ( m ) | λ L (cid:10) . Observe that , under the conditions satisﬁed by ( t ( m ) ) , Theorem 7 . 1 and ( 4 . 4 ) imply that , for all ( n , x , y ) ∈ T , W − 1 e − rt ( m ) Y ( m ) n , x , y (cid:9) t ( m ) (cid:10) a . s . −→ A c ˜ α n ˜ p ( n ) x , y (cid:12) r | ¯ λ L (cid:13) as m → ∞ . ( 7 . 5 ) 123 F . Ball , L . Shaw Hence , since ˆ r ( m ) a . s . −→ A c r as m → ∞ , we have that for any λ L ∈ ( 0 , ∞ ) , ˜ l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) a . s . −→ A c ˜ l ( ∞ ) f ull ( λ L | r ) as m → ∞ , where ˜ l ( ∞ ) f ull ( λ L | r ) = n max (cid:3) n = 2 ˜ α n (cid:3) ( x , y ) ∈ T ( n ) ˜ p ( n ) x , y ( r | ¯ λ L ) log ˜ p ( n ) x , y ( r | λ L ) . ( 7 . 6 ) Standard arguments , ( e . g . Silvey ( 1975 ) , p . 75 ) show that , for n = 2 , 3 , . . . , n max , the function g n ( λ L ) = (cid:2) ( x , y ) ∈ T ( n ) ˜ p ( n ) x , y ( r | ¯ λ L ) log ˜ p ( n ) x , y ( r | λ L ) has a unique global maximum at ¯ λ L . Hence , as a function of λ L ∈ ( 0 , ∞ ) , ˜ l ( ∞ ) f ull ( λ L | r ) has a unique global maximum at ¯ λ L . Fix 0 < a < ¯ λ L < b < ∞ . Then max a ≤ λ L ≤ b | ˜ l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) − ˜ l ( ∞ ) f ull ( λ L | r ) | ≤ n max (cid:3) n = 2 (cid:3) ( x , y ) ∈ T ( n ) max a ≤ λ L ≤ b g ( m ) n , x , y ( λ L ) , ( 7 . 7 ) where g ( m ) n , x , y ( λ L ) = (cid:23)(cid:23)(cid:23) W − 1 e − rt ( m ) Y ( m ) n , x , y ( t ( m ) ) log ˜ p ( n ) x , y ( ˆ r ( m ) | λ L ) − ˜ α n ˜ p ( n ) x , y ( r | ¯ λ L ) log ˜ p ( n ) x , y ( r | λ L ) (cid:23)(cid:23)(cid:23) . Now g ( m ) n , x , y ( λ L ) ≤ ˆ g ( m ) n , x , y ( λ L ) + ˇ g ( m ) n , x , y ( λ L ) , ( 7 . 8 ) where ˆ g ( m ) n , x , y ( λ L ) = W − 1 e − rt ( m ) Y ( m ) n , x , y (cid:9) t ( m ) (cid:10) (cid:23)(cid:23)(cid:23) log ˜ p ( n ) x , y (cid:9) ˆ r ( m ) | λ L (cid:10) − log ˜ p ( n ) x , y ( r | λ L ) (cid:23)(cid:23)(cid:23) and ˇ g ( m ) n , x , y ( λ L ) = (cid:23)(cid:23)(cid:23) { W − 1 e − rt ( m ) Y ( m ) n , x , y ( t ( m ) ) − ˜ α n ˜ p ( n ) x , y ( r | ¯ λ L ) } log ˜ p ( n ) x , y ( r | λ L ) (cid:23)(cid:23)(cid:23) . Using ( 7 . 5 ) , for all ( n , x , y ) ∈ T , max a ≤ λ L ≤ b ˇ g ( m ) n , x , y ( λ L ) a . s . −→ A c 0 as m → ∞ . ( 7 . 9 ) Further , for any λ L > 0 and r , r (cid:10) > 0 , (cid:23)(cid:23)(cid:23) ˜ p ( n ) x , y ( r | λ L ) − ˜ p ( n ) x , y ( r (cid:10) | λ L ) (cid:23)(cid:23)(cid:23) ≤ (cid:8) ∞ 0 | e − rt − e − r (cid:10) t | d t = | r − r (cid:10) | / ( rr (cid:10) ) , ( 7 . 10 ) 123 Estimating the within - household infection rate in . . . so , since log x is uniformly continuous on any bounded subinterval of ( 0 , ∞ ) and ˆ r ( m ) a . s . −→ A c r as m → ∞ , it follows using ( 7 . 5 ) that , for all ( n , x , y ) ∈ T , max a ≤ λ L ≤ b ˆ g ( m ) n , x , y ( λ L ) a . s . −→ A c 0 as m → ∞ . ( 7 . 11 ) Combining ( 7 . 4 ) – ( 7 . 9 ) yields max a ≤ λ L ≤ b (cid:23)(cid:23) (cid:23) ˜ l ( m ) f ull ( λ L | Y ( m ) , ˆ r ( m ) ) − ˜ l ( ∞ ) f ull ( λ L | r ) (cid:23)(cid:23) (cid:23) a . s . −→ A c 0 as m → ∞ , ( 7 . 12 ) whence , since ˜ l ( ∞ ) f ull ( λ L | r ) has a unique global maximum at ¯ λ L , argmax a ≤ λ L ≤ b ˜ l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) a . s . −→ A c ¯ λ L as m → ∞ . ( 7 . 13 ) To complete the proof we explore the behaviour of l ( m ) f ull ( λ L | Y ( m ) , ˆ r ( m ) ) as λ L ↓ 0 and λ L ↑ ∞ . Let X denote the time of the ﬁrst point in ( 0 , ∞ ) of a homogeneous Poisson process having rate ( n − 1 ) λ L . Then p ( n ) n − 2 , 2 ( t | λ L ) ≤ P ( X ≤ t ) = 1 − e − ( n − 1 ) λ L t , so ˜ p ( n ) n − 2 , 2 ( r | λ L ) ≤ (cid:8) ∞ 0 (cid:9) 1 − e − ( n − 1 ) λ L t (cid:10) e − rt d t ≤ ( n − 1 ) λ L / r 2 . ( 7 . 14 ) For all n , we have that ˜ p ( n ) x , y ( ˆ r ( m ) | λ L ) ≤ 1 / ˆ r ( m ) for all ( x , y ) ∈ T ( n ) , so log ˜ p ( n ) x , y (cid:9) ˆ r ( m ) | λ L (cid:10) + log ˆ r ( m ) ≤ 0 . ( 7 . 15 ) Let l ( m ) ∗ (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) = W − 1 e − rt ( m ) n max (cid:3) n = 2 (cid:3) ( x , y ) ∈ T ( n ) Y ( m ) n , x , y (cid:9) t ( m ) (cid:10) (cid:9) log ˜ p ( n ) x , y ( ˆ r ( m ) | λ L ) + log ˆ r ( m ) (cid:10) = l ( m ) f ull (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) + W − 1 e − rt ( m ) n max (cid:3) n = 2 (cid:3) ( x , y ) ∈ T ( n ) Y ( m ) n , x , y ( t ( m ) ) log ˆ r ( m ) , and , recalling ( 7 . 4 ) , note that ˆ λ ( m ) L , f ull = argmax l ( m ) ∗ ( λ L | Y ( m ) , ˆ r ( m ) ) . Fix λ 0 > 0 . Then ( 7 . 14 ) and ( 7 . 15 ) imply that , for all λ L ∈ ( 0 , λ 0 ] , l ( m ) ∗ (cid:9) λ L | Y ( m ) , ˆ r ( m ) (cid:10) ≤ W − 1 e − rt ( m ) Y ( m ) n , n − 2 , 2 (cid:9) t ( m ) (cid:10) (cid:9) log ( n − 1 ) + log λ 0 − log ˆ r ( m ) (cid:10) a . s . −→ A c ˜ α n ˜ p ( n ) n − 2 , 2 (cid:12) r | ¯ λ L (cid:13) (cid:24) log ( n − 1 ) + log λ 0 − log r (cid:25) ( 7 . 16 ) 123 F . Ball , L . Shaw as m → ∞ . Also , using ( 7 . 5 ) and ( 7 . 12 ) , l ( m ) ∗ (cid:9) ¯ λ L | Y ( m ) , ˆ r ( m ) (cid:10) a . s . −→ A c l ( ∞ ) f ull ( ¯ λ L | r ) + r − 1 log r n max (cid:3) n = 2 ˜ α n as m → ∞ . ( 7 . 17 ) Choose n and λ 0 > 0 such that α n > 0 and the right hand side of ( 7 . 16 ) is strictly less than the right hand side of ( 7 . 17 ) . Then , since ˆ λ ( m ) L , f ull = argmax l ( m ) ∗ ( λ L | Y ( m ) , ˆ r ( m ) ) , it follows that for P - almost all ω ∈ A c , there exists m 0 ( ω ) such that ˆ λ ( m ) L , f ull ( ω ) (cid:7)∈ ( 0 , λ 0 ) for all m ≥ m 0 ( ω ) . ( 7 . 18 ) Let T I denote the infectious period of the initial infective in a household of size n . Then p ( n ) n − 1 , 1 ( t | λ L ) = E [ e − ( n − 1 ) λ L t 1 { T I > t } ] ≤ e − ( n − 1 ) λ L t , whence ˜ p ( n ) n − 1 , 1 ( r | λ L ) ≤ 1 / ( ( n − 1 ) λ L + r ) . Arguing as before shows that there exists λ 1 > 0 such that , for P - almost all ω ∈ A c , there exists m 1 ( ω ) such that ˆ λ ( m ) L , f ull ( ω ) (cid:7)∈ ( λ 1 , ∞ ) for all m ≥ m 1 ( ω ) . ( 7 . 19 ) The theorem then follows from ( 7 . 13 ) , ( 7 . 18 ) and ( 7 . 19 ) . (cid:13)(cid:14) We now consider estimation of λ L based only on recoveries . For m = 1 , 2 , . . . , n = 1 , 2 , . . . , n max and t ≥ 0 , let Z ( m ) n , j ( t ) = (cid:3) ( x , y ) ∈ A ( n ) j Y ( m ) n , x , y ( t ) ( j = 1 , 2 , . . . , n ) be the total number of size - n households in which j recoveries have been observed by time t in the epidemic E ( m ) . Let ˆ λ ( m ) L , rec denote the estimator of λ L obtained by maximising the function L rec ( λ L | c , ˆ r ( m ) ) described at ( 4 . 6 ) ( In our present notation c ( n ) j = Z ( m ) n , j ( t ( m ) ) ) . Theorem 7 . 3 Under the conditions of Theorem 7 . 1 , ˆ λ ( m ) L , rec a . s . −→ A c ¯ λ L as m → ∞ . Proof First note from ( 4 . 6 ) that ˆ λ ( m ) L , rec = argmax ˜ l ( m ) rec ( λ L | Z ( m ) , ˆ r ( m ) ) , where ˜ l ( m ) rec ( λ L | Z ( m ) , ˆ r ( m ) ) = W − 1 e − rt ( m ) n max (cid:3) n = 2 n (cid:3) j = 1 Z ( m ) n , j ( t ( m ) ) log ˜ q ( n ) j ( ˆ r ( m ) | λ L ) . Using ( 7 . 5 ) , for n = 2 , 3 , . . . , n max and j = 1 , 2 , . . . , n , W − 1 e − rt ( m ) Z ( m ) n , j ( t ( m ) ) a . s . −→ A c ˜ α n (cid:9) r − 1 − ˜ q ( n ) 0 ( r | ¯ λ L ) (cid:10) ˜ q ( n ) j ( r | ¯ λ L ) as m → ∞ , ( 7 . 20 ) 123 Estimating the within - household infection rate in . . . so , for any λ L ∈ ( 0 , ∞ ) , ˜ l ( m ) rec ( λ L | Z ( m ) , ˆ r ( m ) ) a . s . −→ A c ˜ l ( ∞ ) rec ( λ L | r ) as m → ∞ , where ˜ l ( ∞ ) rec ( λ L | r ) = n max (cid:3) n = 2 ˜ α n (cid:9) r − 1 − ˜ q ( n ) 0 ( r | ¯ λ L ) (cid:10) n (cid:3) j = 1 ˜ q ( n ) j ( r | ¯ λ L ) log ˜ q ( n ) j ( r | λ L ) . ( 7 . 21 ) Now (cid:23)(cid:23)(cid:23) ˜ l ( m ) rec (cid:9) λ L | Z ( m ) , ˆ r ( m ) (cid:10) − ˜ l ( ∞ ) rec ( λ L | r ) (cid:23)(cid:23)(cid:23) ≤ n max (cid:3) n = 2 n (cid:3) j = 1 (cid:9) ˆ h ( m ) n , j ( λ L ) + ˇ h ( m ) n , j ( λ L ) (cid:10) , ( 7 . 22 ) where ˆ h ( m ) n , j ( λ L ) = W − 1 e − rt ( m ) Z ( m ) n , j ( t ( m ) ) | log ˜ q ( n ) j ( ˆ r ( m ) | λ L ) − log ˜ q ( n ) j ( r | λ L ) | and ˇ h ( m ) n , j ( λ L ) = | { W − 1 e − rt ( m ) Z ( m ) n , j ( t ( m ) ) −˜ α n ( r − 1 −˜ q ( n ) 0 ( r | ¯ λ L ) ) ˜ q ( n ) j ( r | ¯ λ L ) } log ˜ q ( n ) j ( r | λ L ) | . For n = 2 , 3 , . . . , n max and j = 1 , 2 , . . . , n , ˜ q ( n ) j ( r | λ L ) = ˜ a ( n ) j ( r | λ L ) / ˜ a ( n ) 0 ( r | λ L ) , where ˜ a ( n ) j ( r | λ L ) = (cid:2) ( x , y ) ∈ A ( n ) j ˜ p ( n ) x , y ( r | λ L ) ( j = 1 , 2 , . . . , n ) and ˜ a ( n ) 0 ( r | λ L ) = r − 1 − (cid:2) ny = 1 ˜ p ( n ) n − y , y ( r | λ L ) . Note that | A ( n ) j | = n + 1 − j ( j = 1 , 2 , . . . , n ) . It follows from ( 7 . 10 ) that , for n = 2 , 3 , . . . , n max and j = 1 , . . . , n , | ˜ a ( n ) j ( r | λ L ) − ˜ a ( n ) j ( r (cid:10) | λ L ) | ≤ ( n + 1 − j ) | r − r (cid:10) | / ( rr (cid:10) ) , ( 7 . 23 ) for all λ L > 0 . Consider a household of size n . In the limit as λ L → ∞ , as soon as one individual in the household is infected , the whole household becomes infected , so the number of removals in that household t time units after it was infected follows a binomial distribution with success probability P ( T I ≤ t ) . It follows that , for j = 0 , 1 , . . . , n and r > 0 , lim λ L →∞ ˜ a ( n ) j ( r | λ L ) ∈ ( 0 , r − 1 ] . Fix a ∈ ( 0 , ¯ λ L ) . It then follows from ( 7 . 20 ) and the continuity of ˜ a ( n ) j ( r | λ L ) that for n = 2 , 3 , . . . , n max and j = 1 , 2 , . . . , n , max a ≤ λ L < ∞ ˇ h ( m ) n , j ( λ L ) a . s . −→ A c 0 as m → ∞ , ( 7 . 24 ) Further , ( 7 . 23 ) and the uniform continuity of log x imply that , for n = 2 , 3 , . . . , n max and j = 1 , 2 , . . . , n , max a ≤ λ L < ∞ ˆ h ( m ) n , j ( λ L ) a . s . −→ A c 0 as m → ∞ , ( 7 . 25 ) since ˆ r ( m ) a . s . −→ A c r as m → ∞ . Similar to before , ( 7 . 21 ) implies that ˜ l ( ∞ ) rec ( λ L | r ) has a unique global maximum at λ L = ¯ λ L . It follows using ( 7 . 22 ) , ( 7 . 24 ) and ( 7 . 25 ) , that , for any a ∈ ( 0 , ¯ λ L ) , argmax a ≤ λ L < ∞ ˜ l ( m ) rec (cid:9) λ L | Z ( m ) , ˆ r ( m ) (cid:10) a . s . −→ A c ¯ λ L as m → ∞ . ( 7 . 26 ) 123 F . Ball , L . Shaw To complete the proof of the theorem , we obtain a uniform upper bound for ˜ l ( m ) rec ( λ L | Z ( m ) , ˆ r ( m ) ) for small λ L . Two recoveries can occur in a household only if the initial infective has made at least one local infection , so , as at ( 7 . 14 ) , ˆ a ( n ) 2 ( r | λ L ) ≤ λ L ( n − 1 ) / r 2 . Also , thereisatleastonerecoveryinahouseholdiftheinitialinfectivehasrecovered , so ˆ a ( n ) 0 ( r | λ L ) ≥ (cid:8) ∞ 0 P ( T I ≤ t ) e − rt d t = φ ( r ) / r . Hence , for n = 2 , 3 , . . . , n max and λ 0 > 0 , ˜ q ( n ) 2 ( r | λ L ) ≤ λ 0 ( n − 1 ) / ( r φ ( r ) ) for all λ L ∈ ( 0 , λ 0 ] . Note that log ˜ q ( n ) j ( r | λ L ) < 0 for all n and j . We can now argue as in the derivation of ( 7 . 18 ) to show that λ 0 can be chosen so that , for P - almost all ω ∈ A c , there exists m 2 ( ω ) such that ˆ λ ( m ) L , rec ( ω ) (cid:7)∈ ( 0 , λ 0 ) for all m ≥ m 0 ( ω ) , which , together with ( 7 . 26 ) , completes the proof . (cid:13)(cid:14) We omit the proofs but similar results to Theorems 7 . 1 – 7 . 3 hold for SEIR and Reed - Frost based models . Theorems 7 . 2 and 7 . 3 may also be extended to the case when the infectious period distribution has a parametric form with unknown para - meters that need to be estimated . For example , if the infectious period follows an exponential distribution with unknown rate γ , it is straightforward to show that , for any compact subset K of ( 0 , ∞ ) 2 , if ( λ L , γ ) is estimated by maximising the relevant pseudolikelihood over K then the resulting estimator is strongly consistent . Extend - ing this to K = ( 0 , ∞ ) 2 is more complicated than in the one - dimensional setting of Theorems 7 . 2 and 7 . 3 and not considered here . 8 Concluding comments In this paper we demonstrate that for an emerging SIR epidemic among a population partitioned into households , basing inference on the usual single - household ﬁnal size distribution normally leads to a biased estimate of the within - household infection rate λ L and use branching process theory to develop a new estimator which accounts cor - rectly for the emerging nature of an epidemic . Although the model used is undoubtedly simpler than a real - life epidemic , the presence of households is a key departure from homogeneous mixing for human epidemics , and it seems likely that similar issues will arise in more complex settings when using data collected at a household level for inference during the exponentially growing phase of an outbreak . In particular , such data need to be modelled very carefully to ensure that the effects of a growing epidemic are incorporated correctly . 123 Estimating the within - household infection rate in . . . The new method is predicated upon the availability of an estimate of the exponential growth rate r . How best to estimate r for an emerging epidemic is an open challenge ( Ball et al . 2014 ) since , as illustrated by Fig . 3 , the exponentially growing phase occu - pies only a narrow time window and consequently care is required in choosing start and end time points for ﬁtting it . Of course , the method assumes also that , at the time when estimation is performed , the epidemic is still in its exponentially growing phase and it should be checked that this is a reasonable assumption . The new method has been shown to be computationally feasible under the assump - tion of no latent period and exponentially distributed infectious period . Extending its implementation to models with more realistic disease dynamics is an important area for research . One approach is via the phase method , see Sect . 4 . 2 , though the matrices involved soon become large . Thus it would be worthwhile developing numerically amenable approximations to the key Laplace transforms ˜ p ( n ) x , y ( r | λ L ) ( ( n , x , y ) ∈ T ) . Fraser ( 2007 ) has developed a closed - form approximate method for calculating the growth rate r for quite general households models , which works well if both the maximum household size and the variance of the generation interval of the disease are not too large ; it may be possible to apply related methods to approximate the aforementioned Laplace transforms . It would be useful to attach standard errors to estimates obtained using the new method . One way of doing this is using a parametric bootstrap , along similar lines to Fig . 4 . Another approach is to determine the asymptotic distributions of the estimators , which would require central limit ( or related ) analogues of the almost sure results in Nerman ( 1981 ) . The method can be extended to multitype SIR epidemics among a community of households , using the model of Ball and Lyne ( 2001 ) together with multitype gen - eralisations of Nerman ( 1981 ) . This would accommodate age - stratiﬁed populations ( e . g . children and adults ) , with age - speciﬁc susceptibilities , and also asymptomatic infections with different transmission parameters for symptomatic and asymptomatic cases . Note that the setting where all infectious episodes are governed by the same transmission parameters but infections are unobserved independently with a common ( unknown ) probability may be handled within the single - type framework , since the distribution of the number of observed cases in a households is obtained easily by con - ditioning on the total number of cases in that household and using binomial sampling . The method can in principle also be extended to situations where information on the temporal progression of disease within households is available . In the Reed - Frost set - ting of Sect . 5 , estimation can be generalised to the case when chains of infection within householdsareobserved ( ratherthantotalnumberofcases ) byextendingthetypespace of the approximating discrete - time multitype branching process to include such infor - mation . In the continuous - time setting of Sect . 4 , suppose that inter - recovery times are observed . Consider the single - household epidemic E ( n ) H described in Sect . 4 . 1 , suppose that k recoveries occur in ( 0 , t ] , where k = 1 , 2 , . . . , n . Let t 1 denote the time of the ﬁrst recovery and let s 1 , s 2 , . . . , s k denote the k successive inter - recovery times , where s k is the time elapsing between the k th recovery and t . Let f ( n ) k ( t 1 , s 1 , s 2 , . . . , s k − 1 | λ L ) denote the joint - density of s 1 , s 2 , . . . , s k − 1 , including the information that no recov - ery occurs between the k th recovery and time t . Then using Theorem 5 . 4 of Nerman 123 F . Ball , L . Shaw ( 1981 ) shows that the contribution of such a household epidemic to the pseudolike - lihood for λ L is ˜ f ( n ) k ( ˆ r | λ L ) = (cid:7) ∞ t A e −ˆ rt f ( n ) k ( t − t A , s 1 , s 2 , . . . , s k − 1 | λ L ) d t , where t A = s 1 + s 2 + · · · + s k , thus providing , at least in principle , a way of estimating λ L . Acknowledgments Laurence Shaw was supported by an EPSRC Doctoral Training grant . We thank the reviewers and Associate Editor for their constructive comments . References Aldous DJ ( 1985 ) Exchangeability and related topics . Springer Lect Notes Math 1117 : 1 – 198 Asmussen S ( 1987 ) Applied probability and queues . Wiley , New York Athreya KB , Ney PE ( 1972 ) Branching processes . Springer , Berlin Ball FG ( 1986 ) A uniﬁed approch to the distribution of total size and total area under the trajectory of infectives in epidemic models . Adv Appl Prob 18 : 289 – 310 Ball FG ( 1996 ) Threshold behaviour in stochastic epidemics among households . Athens conference on applied probability and time series analysis , vol . I . Lecture notes in statist . Springer , Berlin 114 : 253 – 266 Ball FG , Britton T , House T , Isham V , Mollison D , Pellis L , Scalia Tomba G ( 2014 ) Seven challenges for metapopulation models of epidemics , including households models . Epidemics . doi : 10 . 1016 / j . epidem . 2014 . 08 . 001 Ball FG , Donnelly PJ ( 1995 ) Strong approximations for epidemic models . Stoch Process Appl 55 : 1 – 21 Ball FG , Lyne OD ( 2001 ) Stochastic multitype SIR epidemics among a population partitioned into house - holds . Adv Appl Prob 33 : 99 – 123 Ball FG , Lyne OD ( 2002 ) Optimal vaccination policies for stochastic epidemics among a population of households . Math Biosci 177 , 178 : 333 – 354 Ball FG , Lyne OD ( 2015 ) Statistical inference for epidemics among a population of households ( in prepa - ration ) Ball FG , Mollison D , Scalia - Tomba G ( 1997 ) Epidemics with two levels of mixing . Ann Appl Prob 7 : 46 – 89 BarbourAD , UtevS ( 2004 ) ApproximatingtheReed - Frostepidemicprocess . StochProcess Appl113 : 173 – 197 Becker NG , Dietz K ( 1995 ) The effect of the household distribution on transmission and control of highly infectious diseases . Math Biosci 127 : 207 – 219 Becker NG , Starczak D ( 1997 ) Optimal vaccination strategies for a community of households . Math Biosci 139 : 117 – 132 Cauchemez S , Carrat F , Viboud C , Valleron AJ , Boëlle PY ( 2004 ) A Bayesian MCMC approach to study transmission of inﬂuenza : application to household longitudinal data . Statist Med 23 : 3469 – 3487 Cauchemez S , Donnelly CA , Reed C , Ghani AC , Fraser C , Kent CK , Finelli L , Ferguson NM ( 2009 ) Household transmission of 2009 pandemic inﬂuenza A ( H1N1 ) virus in the United States . N Engl J Med 361 : 2619 – 2627 Ferguson NM , Cummings DAT , Cauchemez S , Fraser C , Riley S , Meeyai A , Iamsirithaworn S , Burke DS ( 2005 ) Strategies for containing an emerging inﬂuenza pandemic in Southeast Asia . Nature 437 : 209 – 214 FraserC ( 2007 ) Estimatingindividualandhouseholdreproductionnumbersinanemergingepidemic . PLoS ONE 2 ( 8 ) : e758 Fraser C , Donnelly CA , Cauchemez S , Hanage WP , Van Kerkhove MD , Hollingsworth TD , Grifﬁn J , Baggaley RF , Jenkins HE , Lyons EJ , Jombart T , Hinsley WR , Grassly NC , Balloux F , Ghani AC , Ferguson NM , Rambaut A , Pybus OG , Lopez - Gatell H , Alpuche - Aranda CM , Chapela IB , Zavala EP , Guevara DME , Checchi F , Garcia E , Hugonnet S , Roth C ( 2009 ) Pandemic potential of a strain of inﬂuenza A ( H1N1 ) : early ﬁndings . Science 324 : 1557 – 1561 HaccouP , JagersP , VatutinVA ( 2005 ) Branchingprocesses : variation , growth , andextinctionofpopulations . Cambridge University Press , Cambridge Heesterbeek JAP , Dietz K ( 1996 ) The concept of R 0 in epidemic theory . Statist Neerland 50 : 89 – 110 Hope Simpson RE ( 1952 ) Infectiousness of communicable diseases in the household ( measles , chickenpox and mumps ) . Lancet 260 : 549 – 554 123 Estimating the within - household infection rate in . . . House T , Inglis N , Ross JV , Wilson F , Suleman S , Edeghere O , Smith G , Olowokure B , Keeling MJ ( 2012 ) Estimation of outbreak severity and transmissibility : inﬂuenza A ( H1N1 ) pdm09 in households . BMC Med 10 : 117 Kesten H , Stigum BP ( 1966 ) A limit theorem for multidimensional Galton - Watson processes . Ann Math Stat 37 : 1211 – 1223 Knock ES , O’Neill PD ( 2014 ) Bayesian model choice for epidemic models with two levels of mixing . Biostatistics 15 : 46 – 59 LonginiIM , KoopmanJS ( 1982 ) Householdandcommunitytransmissionparametersfromﬁnaldistributions of infections in households . Biometrics 38 : 115 – 126 Ma J , Dushoff J , Bolker BM , Earn DJD ( 2014 ) Estimating initial epidemic growth rates . Bull Math Biol 76 : 245 – 260 NermanO ( 1981 ) Ontheconvergenceofsupercriticalgerneral ( C - M - J ) branchingprocesses . ZWahrschein - lichkeitstheorie 57 : 365 – 395 Pellis L , Ferguson NM , Fraser C ( 2011 ) Epidemic growth rate and household reproduction number in communities of households , schools and workplaces . J Math Biol 63 : 691 – 734 Silvey SD ( 1975 ) Statistical inference . Chapman and Hall , London ScaliaTombaG , SvenssonÅ , AsikainenT , GieseckeJ ( 2010 ) Somemodelbasedconsiderationsonobserving generation times for communicable diseases . Math Biosci 223 : 24 – 31 Wallinga J , Lipsitch M ( 2007 ) How generation intervals shape the relationship between growth rates and reproductive numbers . Proc R Soc Lond B 274 : 599 – 604 Whittle P ( 1955 ) The outcome of a stochastic epidemic—a note on Bailey’s paper . Biometrika 42 : 116 – 122 123
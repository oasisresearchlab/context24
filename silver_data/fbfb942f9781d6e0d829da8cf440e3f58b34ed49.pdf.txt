CitySpectrum : A Non - negative Tensor Factorization Approach Zipei Fan , Xuan Song , Ryosuke Shibasaki Center for Spatial Information Science , The University of Tokyo , Japan fanzipei @ iis . u - tokyo . ac . jp ABSTRACT People ﬂow at a citywide level is in a mixed state with sev - eral basic patterns ( e . g . commuting , working , commercial ) , and it is therefore difﬁcult to extract useful information from such a mixture of patterns directly . In this paper , we pro - posed a novel tensor factorization approach to modeling city dynamics in a basic life pattern space ( CitySpectral Space ) . To obtain the CitySpectrum , we utilized Non - negative Ten - sor Factorization ( NTF ) to decompose a people ﬂow tensor into basic life pattern tensors , described by three bases i . e . the intensity variation among different regions , the time - of - day and the sample days . We apply our approach to a big mobile phone GPS log dataset ( containing 1 . 6 million users ) to model the ﬂuctuation in people ﬂow before and after the Great East Japan Earthquake from a CitySpectral perspective . In addition , our framework is extensible to a variety of auxil - iary spatial - temporal data . We parametrize a people ﬂow with a spatial distribution of the Points of Interest ( POIs ) to quanti - tatively analyze the relationship between human mobility and POI distribution . Based on the parametric people ﬂow , we propose a spectral approach for a site - selection recommenda - tion and people ﬂow simulation in another similar area using POI distribution . Author Keywords Human Mobility ; Non - negative Tensor Factorization ACM Classiﬁcation Keywords H . 4 Information Systems Applications : Miscellaneous ; K . 4 . 1 Computers and Society : Public Policy Issues INTRODUCTION Understanding and modeling a people ﬂow on a citywide level play critical roles in urban planning , emergency man - agement , and post - disaster recovery . As is well known , the Great East Japan Earthquake caused severe damage to the north - eastern part of Japan . With insight into people ﬂow , the government plans to improve the efﬁciency of its humanitar - ian relief after disasters and during post - disaster reconstruc - tion . Moreover , a better understanding of people ﬂow will Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for proﬁt or commercial advantage and that copies bear this notice and the full citation on the ﬁrst page . Copyrights for components of this work owned by others than the author ( s ) must be honored . Abstracting with credit is permitted . To copy otherwise , or republish , topostonserversortoredistributetolists , requirespriorspeciﬁcpermission and / or a fee . Request permissions from Permissions @ acm . org . Ubicomp ’14 , September 13 - 17 2014 , Seattle , WA , USA Copyright is held by the owner / author ( s ) . Publication rights licensed to ACM . ACM 978 - 1 - 4503 - 2968 - 2 / 14 / 09 $ 15 . 00 . http : / / dx . doi . org / 10 . 1145 / 2632048 . 2636073 Figure 1 . An intuitive example of CitySpectrum . The color matrix repre - sents the population density at the corresponding time and region . Our research objective is to decompose a people ﬂow with a mixed state into its basic components , which indeed transfers the spatio - temporal space of a people ﬂow into a spectral space . also bring about ﬁnancial proﬁts . Since the Great East Japan earthquake in 2011 , the Japanese government has proposed a variety of policies for urban renaissance . To revitalize the economy , Priority Development Areas [ 23 ] have been des - ignated to stimulate regional momentum , and many factors need to be taken into consideration for site - selection . Factors such as local demand and purchasing power are difﬁcult to measure by traditional approaches . However , they underlie in city dynamics such that we can infer the latent factors by analyzing the people ﬂow . Meanwhile , the Fukushima Daiichi nuclear accident caused by the Great East Japan Earthquake turned out to be an un - precedented composite disaster that signiﬁcantly impacted lives of those in Fukushima prefecture . The impact of this is twofold : First , materially , the collapse of buildings caused homelessness , the deformation of railroad tracks wreaked havoc on railway transportation , and people evacuated the ex - clusion zone owing to the radioactive leak caused nuclear ac - cident , and second , psychologically , people have been unwill - ing to go outside because they are faced with uncertain after - shocks , whereas having a home or shelter would provide them with a sense of security . This has led to a ﬂuctuation in their patterns ( e . g . commuting pattern has dropped , and whereas their stay - at - home pattern has increased ) as well as a shift in their geographical life patterns ( moving to a new area without a nuclear power plant ) . Confronting such catastrophic disas - 1 ters , modeling and understanding a people ﬂow before and after a disaster is of great signiﬁcance , in both short ( emer - gency management ) and long ( post - disaster recovery and re - habilitation ) terms . However , research on modeling and understanding a peo - ple ﬂow at the citywide level is very hard to conduct , ow - ing to the difﬁculties in collecting representative longitudinal data in locations where infrastructure and social order have collapsed and where study populations are moving across vast geographical areas . More recently , GPS log data from mobile phones [ 19 ] , location - based online social networking data [ 3 , 10 ] , and Integrated Circuit ( IC ) card data [ 20 ] have emerged and are increasing explosively . This increase in hu - man mobile sensing data becomes the “big data” , and offers a new way to circumvent methodological problems of earlier research for people ﬂow modeling because such data offer a high temporal and spatial resolution , are instantaneously available , have no interviewer bias , and provide longitudi - nal data for very large populations . Therefore , in this paper , we collected “Big Human Mobile Sensing Data” ( 1 . 6 million mobile phone users with GPS capacity ) over a three - year pe - riod to understand and model a people ﬂow at the citywide level . A city is a complex system , and it is therefore difﬁcult to pro - vide a straightforward interpretation of a people ﬂow at the citywide level . Cities function quite distinguishably at differ - ent regions , at different times and on different days . Imag - ine a commercial area at 7 p . m . on a weekend . The people in this region would probably be drinking with friends , shop - ping , coming or leaving using public transportation . Compar - atively , at 7 a . m . on a weekday , the same region may mainly act as a commuting hub . Thus , we assume that a people ﬂow is a mixture of various underlying latent components such as commuting and working patterns . Under this assumption , our objective is to infer the underlying components from an inte - grated people ﬂow and to correlate the components with other spatio - temporal data in a general uniﬁed framework . Consider the manner in which astronomers analyze an newly discovered star : they pass the light of the star through a spec - trograph to obtain its light spectrum . The components of light with different frequencies are separated . Thereafter , the de - ﬁciency of certain frequencies in the spectrum may indicate the existence of certain elements in the star . Similarly , in this paper , we regard a city as an newly discovered star , and the people ﬂow as the observable light of the star . An intuitive example is given in Figure 1 , the upper part of which is a people ﬂow in a mixed state . Some regions are more likely to be a workplace ( high density during working hours ) , other regions are more likely to be a transit station ( high density in the morning and evening rush hours ) , and still some regions may be a combination of the two . Our research objective is to decompose a mixed people ﬂow into a few basic people ﬂows , each of which characterizes one human life pattern in the city , for example , a working pattern or commuting pat - tern , as shown in the lower part of Figure 1 . To ﬁnd the proper “spectrograph” , we adapted the Non - negative Tensor Factorization ( NTF ) algorithm [ 2 ] , which be - longs to the family of matrix / tensor factorization algorithms . The philosophy of such algorithms is to approximate the ma - trix / tensor through a linear combination of a few basic tensors ( rank 1 ) under certain constraints according to the application scenarios . There are two commonly used constraints to fac - torization . The ﬁrst is the orthogonality ( e . g . singular value decomposition ) , which applies a constraint in that the bases that are factorized out should be orthogonal to each other . The second is non - negativity ( e . g . NTF ) , which assumes that ev - ery entry in the bases have to be non - negative . In our scenar - ios , there are two reasons why we prefer non - negativity : • the density of a people ﬂow cannot be negative , and • the difference between each pattern is not so signiﬁcant as to be orthogonal . Our method is a step toward a future smart government that harnesses human mobility data sufﬁciently for fast responses to disasters and effective urban planning . The main contribu - tion of this paper can be summarized as follows : • We provide a novel perspective to the modeling of large - scale human mobility in a CitySpectral space . • We applied our method to a big GPS log dataset , and present several real - world applications . DATA AND PREPROCESSING To model real - world human mobility , we collected a GPS log dataset anonymously from about 1 . 6 million real mobile - phone users in Japan over a three - year period ( from August 1 , 2010 to July 31 , 2013 ) . This dataset contains about 30 billion GPS records , or more than 1 . 5 terabytes . The data collection was conducted by a mobile operator and private company un - der an agreement with mobile phone users . By default , the positioning function on the users’ mobile phones is activated every 5 min , and their positioning data are uploaded onto the server . However , the data acquisition is affected by several factors such as a loss of signal or battery power . In addition , to save power , when a mobile phone is evenly placed , the po - sitioning function is automatically turned off . Original Data Consider a set of city - wide GPS log data D = { l 1 , l 2 , · · · , l M } , where l i is the i − th record of the GPS log with in the city . Each record is a tuple in the form of l i = (cid:104) uid , time , latitude , logitude (cid:105) , where uid is the unique id for each mobile user . People Flow Tensor Before we begin analyzing the people ﬂow at the citywide level , we need to ﬁnd the proper data structure to represent people ﬂow . When analyzing the interrelationship between two discrete attributes ( for example , spatial and temporal ) , the use of matrix is commonly the ﬁrst choice . However , in peo - ple ﬂow modeling scenarios , a periodic appearance ( in this paper , we consider this periodicity as daily ) turns out to be an important preliminary for deﬁning a pattern . Hence , in order to model daily recurring patterns , we need to fork the tempo - ral dimension into “sample days” and “time - of - day” . There - fore , we introduced a three - way tensor Y ∈ R N r × N t × N d to 2 Figure 2 . The time bias of our GPS log dataset . ( statistics for August 1 , 2011 , all across Japan ) formulate a people ﬂow , where N r , N t , N d are the numbers of regions , time - slices and sample days respectively . To construct a people ﬂow tensor from a raw GPS record dataset , in the ﬁrst step , we need to discretize the time and coordinates . We selected 30 min as the time interval there - fore divided one day into 48 time - slices . In addition , we meshed the city into ∆ d lat and ∆ d lon . Based on the deﬁ - nition of latitude and longitude , the east - west distance on the earth is variant according to latitude . To guarantee a square of each tile , we experimentally select a grid size of approxi - mately 450m × 450m for ∆ d lat = 0 . 004 and ∆ d lon = 0 . 005 on a map of Tokyo , and 900m × 900m for ∆ d lat = 0 . 008 , ∆ d lon = 0 . 010 on a map of Fukushima . However , human coordinates are not recorded uniformly in terms of time , because the localization function is not acti - vated when no movement of the user’s mobile phone is de - tected . As shown in Figure 2 , the number of GPS points from 8 : 00 to 8 : 29 is about 11 times larger than that from 4 : 00 to 4 : 29 . This bias leads to a very serious mis - estimation of the actual population density . In this paper , we construct a people ﬂow tensor using the proportion of GPS points in each region over the entire city : y r 0 , t 0 , d 0 = Count ( r 0 , t 0 , d 0 ) N r (cid:80) r = 1 Count ( r , t 0 , d 0 ) ( 1 ) where r 0 , t 0 , and d 0 are the index of the region , the time - slice and the sample day respectively ; N r is the total number of regions , and Count ( r , t , d ) calculates the number of GPS points at time t on d - th days within region r . CITYSPECTRAL SPACE In this section , we give a formal description of the terminol - ogy used in people ﬂow factorization and detail the NTF al - gorithm for people ﬂow factorization . For simplicity , by de - fault the tensors mentioned in the remainder of this paper are three - way ( region , time , and day ) tensors . Deﬁnition 1 ( basic tensor ) : A basic tensor can be expressed as the outer product of three unit vectors . It is notable that a basic tensor has a rank of 1 . Figure 3 . The people ﬂow tensor factorization . A people ﬂow at the citywide level can be expressed approximately as a linear combination of basic tensors representing the latent life patterns in the city Deﬁnition 2 ( CitySpectral Space ) : Let Y denote the people ﬂow tensor deﬁned in the previous section . A CitySpec - tral space is a space spanned by K bases of basic ten - sors (cid:110) Y ( 1 ) , Y ( 2 ) , · · · Y ( K ) (cid:111) . Therefore , the city - wide people ﬂow tensor could be approximately expressed as a linear com - bination of basic tensors in the CitySpectral space ( as shown in Figure 3 ) , with the coefﬁcients of ω 1 , ω 2 , . . . , ω K that best approximate Y through Y ≈ K (cid:88) k = 1 ω k Y ( k ) . Deﬁnition 3 ( region - basis , time - basis and day - basis ) : For each basic tensor Y ( k ) , we denote u ( k ) , v ( k ) , and w ( k ) as the unit vectors whose outer product is Y ( k ) : Y ( k ) = u ( k ) ◦ v ( k ) ◦ w ( k ) Therefore , the region - basis , time - basis and day - basis are de - ﬁned as the collinear vectors with u ( k ) , v ( k ) and u ( k ) re - spectively . Without losing generality , the bases are set to be 3 √ ω k u ( k ) , 3 √ ω k v ( k ) and 3 √ ω k w ( k ) by default . Deﬁnition 4 ( basic life pattern ) : We deﬁne ω k Y ( k ) as the k th - basic life pattern . Equivalently , a ba - sic life pattern can also be described as the triple of ( region − basis , time − basis , day − basis ) as well . CitySpectral Approach to People Flow Modeling Intuition of CitySpectral Approach A people ﬂow at citywide level is in a mixed state composed of a variety of life patterns . Most regions are not mono - functional . As the result of such mixture , in a spatio - temporal space , it is impossible to tell one pattern from another if we analyze the population density at each time within each re - gion in isolation . However , the term “Pattern” as deﬁned in a dictionary , is a regular and repeated way in which some - thing occurs or is conducted . Therefore , a holistic viewpoint gives a possible solution to generate a natural separation of such patterns by ﬁnding the regular presence of a small num - ber of prototypes , namely , the bases of the basic life patterns . As shown in Figure 4 , each basic pattern we factorized out 3 Figure 4 . Illustration of basic life pattern and its bases . The basic life pattern can be perceived as the repeated presence of region - basis and time - basis . in Figure 1 ( for simplicity of visualization , we omitted the “day” dimension and formulated a one - day people ﬂow into a matrix form ) can be described by the outer product of the basis vectors . From the property of the outer product , each row vector in a people ﬂow matrix is collinear with the time - basis and each column vector is collinear with Region - basis ; that is , each basic pattern is the repeated spatial presence of the time - basis , as well as the repeated temporal presence of the region - basis . Following this intuition , the essence of the CitySpectral approach is to approximate a city - wide people ﬂow tensor with a linear combination of only a small number of basic tensors characterizing the basic life patterns underly - ing the people ﬂow . Formulation Considering each entry in the people ﬂow tensor characteriz - ing the regional population density , which cannot be negative , we may assume that all bases describing the basic life pat - terns we factorized out should be non - negative as well . Thus we formulated the latent basic life patterns inference prob - lem through Non - negative Tensor Factorization , the essence of which is to minimize the error reconstructed by K triples of bases : L ( U , V , W ) = (cid:13)(cid:13)(cid:13)(cid:13)(cid:13) Y − K (cid:88) k = 1 u ( k ) ◦ v ( k ) ◦ w ( k ) (cid:13)(cid:13)(cid:13)(cid:13)(cid:13) 2 F + Φ ( U , V , W ) ( 2 ) with non - negativity constraints of U ≥ 0 , V ≥ 0 , W ≥ 0 ( 3 ) Here the region - basis u ( k ) , time - basis v ( k ) and day - basis w ( k ) are the k - th column vector of U , V and W respectively , and ◦ is the operator of the outer product . In addition , K is the number of basic life patterns that we want to infer , and (cid:107)∗(cid:107) 2 F is the Frobenius norm of the tensor based on the Euclidean distance . The function Φ is a generalized regularization term which can be used for extension of this framework . NTF is an extensible framework in that a wide range of aux - iliary spatio - temporal data such as the spatial distribution of POIs can be easily incorporated into a uniﬁed framework [ 4 , 21 ] , when conducting a variety of new applications such as comparative and parametric people ﬂow . In the “Real - world Figure 5 . Label assignment of the basic patterns in Tokyo . We labeled each pattern by comprehensively considering the spatio - temporal char - acteristics described by the three bases . Applications” section , we discuss the applications based on the two extensions of the NTF framework . Pattern Labeling Each rank - one tensor we discovered can be represented using three vectors , namely , the time - basis , the location - basis and the day - basis . These triple bases describe the spatio - temporal characteristics of the components of a people ﬂow implied by a rank - one tensor . For simplicity and clarity of further anal - ysis , we manually named the labels summarizing what kind of pattern the bases describe . For example , in Figure 5 , we show the bases of the rank - one tensor we factorized out . In the top - right of the ﬁgure , the regions with the highest values are the major stations in Tokyo , and we can see that the re - gions with a high value are approximately aligned along the mainlines ( railway ) in Tokyo . As for the time - basis , we can see two peaks at about 8 : 30 and 19 : 00 which could be inter - preted as the morning and evening rush hours . Weekly pe - riodical behavior can be easily observed from the day - basis diagram with the exception of the “golden week” in Japan . In the “golden week” , Tuesday to Friday are national holidays . As a result , the people ﬂow behaves similarly as that found on the weekend . Therefore , we labeled the rank - one tensor in Figure 5 as a “commuting pattern” . REAL - WORLD APPLICATIONS Disaster Behaviour Analysis A good modeling of a people ﬂow during a disaster can greatly improve the efﬁciency and effectiveness of the emer - gency response from the government . However , a people ﬂow may appear to be more chaotic during a disaster , and as a re - sult it may be hard for the government to evaluate the im - pact of the disaster on the daily life of the residents . The CitySpectral approach provides a novel perspective in mod - eling a people ﬂow during a disaster in that disaster impact of the disaster on each basic life pattern can be quantitatively characterized . We acquired the people ﬂow tensors to model the people ﬂow in Fukushima for four continuous months be - fore and after The Great East Japan Earthquake . The sample 4 Figure 6 . Diagram of day - basis in Fukushima before and after the Great East Japan Earthquake from Feb . 1 to May 31 , 2011 ( the earthquake took place on March 11 ) . Figure 7 . The time - basis and region - basis of “home 1” ( the ﬁrst row ) , “home 2” ( the second row ) , “home 3” ( the third row ) and “home 4” ( the fourth row ) patterns in the Fukushima People Tensor before and after the Great East Japan Earthquake . days ranged from Feb . 1 to May 31 , 2011 . We annotated each basic life pattern by considering the day - basis , time - basis and region - basis comprehensively . Experimentally , we obtained nine basic life patterns , and annotated these patterns as “home ( 1 , 2 , 3 , 4 ) ” , “commercial ( 1 , 2 ) ” , “working” , “enter - taining” and “commuting” patterns . Figure 6 shows the days - basis before and after the Great East Japan Earthquake , char - acterizing the ﬂuctuation of the pattern intensity . In this part , we focus on the home patterns . As the results show , the home pattern is affected by the earthquake so signiﬁcantly that it cannot simply be described as a single basic life patterns . The factorization algorithm separates a home pattern into four sub - patterns . The most obvious peak in Figure 6 is the dramatic increase of “home 1” pattern in the three days following the earth - quake . In the ﬁrst row of Figure 7 , the time - basis ( the ﬁrst column ) describes the “home 1” life pattern as “staying at home ( or somewhere nearby within the region ) for the whole day” , since there is little variation of the pattern intensity dur - ing one day . From the third row , “home 3” is characterized as “spending most time at home while sometimes going out - side during the daytime” . As shown in region - basis , “home 1” represents a more concentrated pattern of spatial distribu - tion than “home 3” , because “home 1” describes the pattern that people at a very low level of mobility while “home 3” describes the pattern that people mobility is partially recov - ered . In addition , “home 1” and “home 3” have in common that both have very low intensity in the coastal regions , where are severely damaged by Tsunami . From the day - basis perspective , Figure 6 , we can see that the peak of “home 1” follows with the earthquake , this is because after the earthquake the transportation system broke down and people were unable to go anywhere far from their home or shelter . In addition , people felt insecure , preferring to stay at home or their temporary shelter . About three days later , “home 1” decreases sharply while “home 3” rises . This re - ﬂects people regained some mobility and started to go out to buy daily necessities or receive relief supplies . Note that “home 3” does not describe the life pattern of peo - ple who needed to regularly go to work place during daytime . This home pattern is given in “home 2” and “home 4” , in which nigtttime density is obviously higher than that of the daytime , which is the life pattern of a typical salaryman . Al - though they are quite similar to each other in the time - basis , from a day - basis perspective , “home 2” and “home 4” be - have in an opposite fashion . After the earthquake , “home 2” gradually increases whereas “home 4” decreases sharply . Therefore , the “home 4” represents a home pattern that was severely affected by the earthquake , while “home 2” was 5 Figure 8 . The time - basis and region - basis of “commercial 1” ( the ﬁrst row ) and “commercial 2” ( the second row ) , patterns in the Fukushima People Tensor before and after the Great East Japan Earthquake . The center shows the region - basis of “commercial 2” around Mount Bandai , which is a famous tourist site in Fukushima . slightly affected and represnets a “new home” ( namely a sec - ond house or a relative’s home ) of those whose were more signiﬁcantly affected by the earthquake . With the help of regions - basis , we can see that “home 2” excludes the regions within 20 km of the Fukushima Daiichi Nuclear Power Sta - tion , where a catastrophic accident resulted from the release of radioactive materials . This 20 - km region is the exclusion zone that the government announced [ 9 ] as being heavily pol - luted by radioactive materials , and from where all residents had to evacuate . “Home 4” which includes this exclusion zone , dropped dramatically after the earthquake occurred . Similarly , as shown in Figure 8 , there are two commercial patterns in the factorization results : one representing the com - mercial regions most affected by the earthquake ( the ﬁrst row ) and another representing regions not substantially affected by the earthquake ( the second row ) . Speciﬁcally , tourism , which is an important part of commerce , is very vulnerable to disasters , because the majority of contributors to tourisms , namely tourists , are not local residents , usually their destina - tion is far from their home , instead of preferring somewhere near . Tourists therefore have multiple destination choices and the negative news of a disaster may easily discourage them from going to the disaster area . The center of Figure 8 shows the region - basis of “commercial 2” ( a heavily affected area ) in the Mount Bandai area . Mount Bandai is the most fa - mous sightseeing area in Fukushima , however , because of the earthquake , and particular based on the negative report of radioactive materials beging released in Fukushima , people have been unwilling to choose Fukushima as their travel des - tination . This could be evidenced from the news that the ﬁrst tourist group from China to visit Fukushima after the earth - quake did so in May of 2012 [ 22 ] , more than one year after the disaster . Note that the region with highest value is at the peak of Mount Bandai , which is the hub where people can access a cable - car . Post Disaster Human Mobility Shift A long - term geographical shift of human mobility was ob - served after disaster , because the impact of the disaster was Figure 9 . Map of “home” pattern variation . A region in red color in - dicates an increase in home pattern , green indicates little changes , and blue indicates a decrease . On the right side , we list the top four cities where evacuees ﬂed within Fukushima as of Nov . 21 , 2011 . For each city , the exact number of evacuees surveyed is also given . These statis - tics were compiled by International Medical Corps . , with a sample size of 33943 evacuees . of different degrees at different locations . A proper estima - tion of this shift is critical to the redevelopment planning . In this subsection , we model the geographical shift of peo - ple’s life patterns in February of 2011 ( before the Great East Japan Earthquake ) and February of 2012 ( after the Great East Japan Earthquake ) . There are two possible solutions from our previous algorithm . 1 ) Concatenate the people ﬂow tensors in 2011 and 2012 into a single tensor by way of “sample days” . Then similar to our ﬁrst example of factorizing the people ﬂow of Fukushima before and after the earthquake , for each pattern we are interested , we will obtain two ( or even more ) basic life patterns , with one describing the pattern in 2011 and the other pattern in 2012 . 2 ) Factorize the two people ﬂow tensors separately , and compare the patterns with the same annotation . This solution has no mathematical restric - tion on the similarity of the time - basis , region - basis between the patterns in 2011 and 2012 , so it is so ﬂexible that for each pattern , all the three bases can be different . However , for a comparison , we need to control the variables . In this appli - cation , we compared the basic life patterns before and after the earthquake by controlling the time - basis variable and co - factorizing [ 4 ] the two tensors using the shared time - basis . We acquired two people ﬂow tensors for 2011 and 2012 , shar - ing the time - basis with the people ﬂow tensor for 2011 . To measure the geographical shifts in the patterns , we deﬁned ∆ u ( k ) = u ( k ) 2012 − u ( k ) 2011 as the variation of spatial distribution of the k - th basic life pattern . We classify regions ∆ u ( k ) into three categories : 1 ) ”increase” ( red regions in Figure 9 ) re - gions where the “home” pattern increased by over 10 % , 2 ) “remain unchanged” ( green ) regions where the life pattern decreased or increased within 10 % , and 3 ) “decrease” ( blue ) regions where the life pattern decreased by more than 10 % . Figure 9 visualizes the spatial variation in the “Home” pat - tern . In the middle area of the coastal region , we can see 6 Index POI Category POI Counts 1 Bank , Insurance 10466 2 House Agency 26901 3 Transportation ( Land ) 682 4 Transportation ( Sea ) 1293 5 Transportation ( Air ) 483 6 Warehouse 7083 7 Communication 22738 8 Electricity , Gas 1252 9 Technician Related 25000 10 Sports Facilitate 3468 11 Sports Shop 1661 12 Entertainment , Restaurant 90218 13 Sightseeing 10318 14 Hospital 40643 15 Supermarket , Shopping Mall 9007 16 Convenient Shop 109474 17 Car related 10896 18 Education 20504 19 Bureau 6494 20 Others 12419 Table 1 . POI Categories and counts in Tokyo 2011 . a large area of “blue” regions including exclusion zone and neighbourhood area caused by the accident at the Fukushima Daiichi Nuclear Power Station . As surveyed by the Interna - tional Medical Corps , the top - four destinations of the evac - uees within Fukushima are given in the right side of Figure 9 , as shown in our results , these regions are labeled with a dom - inating percentage of “increase” regions as compared with “decrease” regions . Parametric People Flow in Urban Planning A parametric people ﬂow is used to quantitatively model the interrelationship between people’s lives and the key factors ( e . g . the distribution of POIs from statistical data ) effecting their mobility . A quantitative characterization of how POIs affect human mobility plays an important role in urban plan - ning . In particular , by comparing the existing POIs ( deﬁned as the POI distribution data directly from the POI dataset ) and estimated POIs ( deﬁned as the POI distribution estimated by the quantitative functional relationship between the POIs and a people ﬂow ) , we can evaluate whether the existing POI within this region is able to satisfy the demand , and therefore recommend suitable locations for planning a new POI . To describe the spatial distribution of POIs , we deﬁned the auxiliary POI - region matrix Z . The ﬁrst dimension of this matrix is the indexes of the regions we analyzed , and the sec - ond dimension is the categories of POIs . Therefore , each en - try in the matrix is calculated by : z ij = n ij N r (cid:80) k = 1 n kj ( 4 ) where n ij is the number of the j - th category of POIs within region i . Figure 10 . The bases of “commercial” pattern in Tokyo . The top - left is the time - basis , the top right is the day - basis , the bottom - left is region - basis and the bottom - right is the POI - basis . Figure 11 . The bases of “entertaining” pattern in Tokyo . The top left is time - basis , the top right is day - basis , the bottom left is region - basis and the bottom right is POI - basis . To solve this problem using a co - factorization algorithm , we constructed a people ﬂow tensor of Tokyo for 60 continuous days from May 1 to June 29 , 2011 , and calculated the POI - region matrix from the Telepoint Pack DB for February 2011 provided by ZenRin Company [ 7 ] . The coordinates of each POI are given as the location of the ofﬁce of the owner of the facilitates . We manually deleted some of the unrelated categories in the dataset and indexed and listed the categories we used in our experiments in Table 1 . Figure 10 , the bases of the “commercial” pattern that we fac - torized out for Tokyo . We can see that the peak time for commerce is about 15 : 30 , and that people prefer weekends for commercial activity . The ideal place for such activities is around Shinjuku and Ikebukuro Stations , which are two famous areas for shopping . Speciﬁcally , we can obtain the category of POI with the strongest correlation with “commer - cial” pattern . In the top - rankings , the categories are “super - market , shopping mall” and “sports shop” . We may note that by common sense , “entertaining and restaurant” should be 7 Figure 12 . The recommendation of opening a new entertainment place or restaurant in Tokyo . A redder color indicates stronger recommenda - tion whereas a bluer color indicates weaker recommendation closely related to “commercial” pattern as well , however it has a very low value in our factorization results . This could be explained as the“entertaining and restaurant” related life pattern being underlain in “entertaining” pattern . As shown in Figure 11 , although the “entertaining” pattern has a very strong spatial distribution similarity with the “commercial” pattern , the time - basis and day - basis are quite different . We can see that people prefer “entertaining” on Friday and Sat - urday , and at night rather than during the day . This is be - cause some restaurants especially drinking places are closed on Sundays [ 1 ] and because people have to go back to work on Mondays , they may prefer to go back home earlier and have a good rest on Sundays . We successfully separated these two patterns and determined the POI categories most related to these patterns . POI Recommender System A tensor - factorization based recommender system has been successfully applied to a wide range of application scenarios [ 27 , 13 ] . In our application , the recommendation of the site - selection of certain type of POIs could be made by observing the positivity or negativity of spectral residue E Z deﬁned as : E Z = Z − K (cid:88) k = 1 u ( k ) ◦ p ( k ) ( 5 ) From the deﬁnition of spectral residue , we can imply the entry e i , j of category j in region i as follows : (cid:26) existing POI < estimated POI , if e i , j > 0 existing POI > estimated POI , if e i , j < 0 ( 6 ) The recommendation of “entertainment , restaurant” is shown in Figure 12 . The regions in the red oval ( in Nakano Ward ) are where we ﬁnd that the existing POI for entertainment is insufﬁcient compared with what the people ﬂow indicates . Nakano Ward has a high density population especially for ages 25 to 45 ( as shown in the bottom - left corner of Fig - ure 12 , the data is from national census statistics , 2012 [ 18 ] ) who are most potential group of consumers of entertainment Figure 13 . The simulated people ﬂow ( left ) compared with the ground true ( right ) . places and restaurants , while there are fewer existing local en - tertainment places . Besides , Nakano is adjacent to Shinjuku Ward , which is the most famous entertainment hub in Tokyo . All those stated above make Nakano Ward an ideal place for opening a new entertainment place or restaurant . In compar - ison , the regions in the blue oval are traditional commercial and entertainment places in Tokyo and have been develop - ing for decades and therefore the existing entertaining places has already relatively satiated and stable . Although this area has a very high intensity of entertainment activity ( from Fig - ure 11 ) , by taking existing POI distribution into account , this area is not recommended from our algorithm . Note that some regions in this area that has high recommendation value , espe - cially at Tokyo Station and Akihabara Station . The reason for this outlier is the huge building at the station which takes up a large proportion of this region , and there are few entertain - ment places within the building . However , the “entertaining” people ﬂow is intense here because people who come for en - tertainment purposes have to take the train to come and leave this area . People Flow Simulation Human mobility is one of the most important considerations of infrastructure planning . Simulating a possible people ﬂow under every spatial infrastructure layout will provide a novel and intuitive way to evaluate a city design . In our applica - tion , a people ﬂow in an unknown area is simulated using the given spatial distribution of the POIs . The people ﬂow sim - ulation is generated from the time - basis v ( k ) and day - basis w ( k ) in CitySpectral space ( k = 1 , · · · , K ) we discovered in the known area used as the training set , along with the region - basis u ( k ) new deﬁned as : u ( k ) new : = arg min u ( k ) (cid:13) (cid:13) (cid:13)(cid:13)(cid:13) Z new − K (cid:88) k = 1 u ( k ) ◦ p ( k ) (cid:13) (cid:13) (cid:13)(cid:13)(cid:13) 2 ( 7 ) which minimizes the reconstruction error of the new POI - region matrix Z new using the POI - basis p ( k ) that we discov - ered . Therefore , the people ﬂow tensor in the new region Y new can be simulated by : Y new = K (cid:88) k = 1 u ( k ) new ◦ v ( k ) ◦ w ( k ) ( 8 ) Figure 13 shows a visualization of the simulated people ﬂow at 18 : 30 on May 17 ( Tuesday ) as compared with the ground truth ( people ﬂow tensor calculated directly from GPS log data ) . The upper - left corner and upper - right corners are both regions with schools and businesses , and share a similar POI distribution . However , upper - left corner is simulated close to 8 Figure 14 . Correlation with respect to the regions ( the redder color in the top - left indicates a higher correlation ) , time ( top - right ) and sample days ( bottom ) . ( Fukushima , Feb . 1 through May . 31 , 2011 the ground truth , while the people ﬂow in upper - right corner is over - estimated . This could not be simply explained by the POI distribution , and the topology of the road network or the latent attributes of the schools and businesses ( such as the working hours ) may be the reason of such difference . EVALUATION Metric To quantitatively evaluate our experimental results , we recon - struct the people ﬂow tensor based on the sum of outer prod - ucts of the bases , and calculated the element - wise correlation η ( K ) with the origin tensor and reconstructed tensor : η ( K ) = Cor (cid:16) Y , ˆ Y (cid:17) ( 9 ) where ˆ Y is the reconstructed tensor deﬁned as ˆ Y = K (cid:80) k = 1 u ( k ) ◦ v ( k ) ◦ w ( k ) and Cor ( ∗ ) is the function of calcu - lating two matrices / tensors correlation . However , this metric loses the information of where the error comes from . To have a better understanding of error source , we deﬁned the correlation with respect to Region , Time , and Day . η ( K ) Region ( r ) = Cor (cid:16) Y r , : , : , ˆ Y r , : , : (cid:17) η ( K ) Time ( t ) = Cor (cid:16) Y : , t , : , ˆ Y : , t , : (cid:17) η ( K ) Day ( d ) = Cor (cid:16) Y : , : , d , ˆ Y : , : , d (cid:17) ( 10 ) where , Y r , : , : , Y : , t , : , Y : , : , d are deﬁned as the matrix the r - th / t - th / d - th slice of the tensor from corresponding way . Regions In the following subsections , we show the reconstruction cor - relation with respect to the region , time and sample day . We can see from the top - left image in Figure 14 , urban areas have a much higher reconstruction correlation than rural ar - eas , which could be explained as a city - wide people ﬂow hav - ing a very imbalanced spatial distribution . In urban areas , Ward / City Number of Regions Correlation Shinjuku 123 0 . 7759 Chuuou 63 0 . 5601 Minato 130 0 . 5134 Bunkyo 76 0 . 6487 Meguro 104 0 . 7082 Oota 273 0 . 5883 Shibuya 100 0 . 8215 Nakano 106 0 . 5956 Toshima 92 0 . 8442 Musashino 75 0 . 8944 Table 2 . Quantitative evaluation on People Flow Simulation . the people ﬂow is over 1000 times denser than country ar - eas , where there are only a few GPS points in our sample days . As a result , people ﬂow in rural areas is highly unin - terpretable . In addition , in our factorization framework , those regions having a smaller people ﬂow will naturally have less weight in the optimization phase . Time The top - right image of Figure 14 shows the reconstruction correlation with respect to time . We can see that the errors of reconstruction mainly come from the night - time data . As mentioned in the “Data and Preprocessing” subsection , the GPS uploading function is not activated if there is no mo - bile phone movement . As a result , there are probably only two or three GPS points during the night - time while with one point for every few minutes during the daytime . Although this smaller weight problem was rectiﬁed by normalizing , sparser data points still led to higher randomness during the night - time . Sample Days The bottom image of Figure 14 shows the reconstruction cor - relation with respect to the sample days . During the ﬁrst week after the earthquake , the correlation declined . This declina - tion can be explained as human activity being quite different from other days during this period , and thus the emergence of human activities such as the evacuation could seem to be somewhat random without much prior knowledge , and can therefore only be roughly described by the K basic life pat - terns . In the future , in accordance to the limitation , a spec - tral residue based abnormal people ﬂow approach may be a promising extension to our algorithm . In addition , more prior knowledge is extended into this framework to improve a de - scription of the people ﬂow during a disaster . Evaluation of People Flow Simulation We separated the dataset utilized in “POI Recommender Sys - tem” subsection into training and testing set . From the train - ing set , we discovered the basic life patterns correlated with the POI distribution , and used the POI distribution in the test - ing set to simulate the people ﬂow , and quantitatively evalu - ated by calculating the correlation η ( K ) deﬁned in Equation 9 between the simulated people ﬂow tensor and the ground truth tensor ( the people ﬂow tensor generated from GPS log dataset ) . 9 Quantitative evaluation details are given in Table 2 . In our evaluation , the total number of discrete regions in Tokyo is 6516 . Each time , we take one ward or city in Tokyo out as the testing data while remaining regions as the training data . The numbers of discrete regions of the testing set are listed in the second column . Note that in this application , we simulated the people ﬂow based only on the POIs , and each region was simulated independently ( no topological relationship of the regions was taken into account ) . From Table 2 , we can see our simulation reached 0 . 7 correlation on average , ranging from 0 . 5134 to 0 . 8944 . These results can be further improved using a more sophisticated people ﬂow simulation model fus - ing more sources of information such as road network , which will be included in our future work . RELATED WORK Urban computing using human mobility data : The emergence of a variety of available human mobility datasets [ 5 , 26 ] has stimulated a wide - range of research interests on urban com - puting in recent years . Urban computing has provided a novel perspective on the traditional social issues such as zone reg - ulation [ 25 ] , air pollution [ 28 ] , disaster evacuation [ 19 ] etc . Y . Zheng provided [ 29 ] a comprehensive review on the recent researches , methodologies and challenges of urban comput - ing using human mobility data . Matrix / Tensor Factorization : Matrix / tensor factorization has been researched for decades in the ﬁelds of computer vision [ 17 ] , signal processing [ 16 ] , urban computing [ 27 ] etc . Lee et al . [ 14 ] described the application of Non - negative Ma - trix Factorization on a face image analysis , and a variety of successful researches [ 4 , 24 , 21 , 15 , 11 ] in a wide - range of ﬁelds have also been published . The positivity constraint in NMF / NTF makes the factorization results more interpretable , and characterize the data space more essentially in many ap - plication scenarios . A . Cichocki [ 2 ] reviewed the techniques and applications of NMF / NTF , and herein , we refer to the formulation of NTF in this book . For co - factorization with auxiliary spatio - temporal data , The authors in [ 4 ] proposed a Simultaneous NMF for extracting gene expression proﬁles and [ 21 ] presented a Non - negative Multiple Tensor Factoriza - tion algorithm in analysing the users’ check - in and reviews on geo - locations . We referred to these two works for co - factorization algorithm . The matrix factorization method has also been introduced into the analysis of spatio - temporal human mobility . N . Eagle et al . [ 8 ] modeled the daily human activities from Call Detail Record ( CDR ) data and factorized into EigenBehaviors using principal component analysis . F . Calabrese et al . [ 6 ] mod - eled the digital signature of on - campus WiFi , and clustering different functional regions in the campus . J . Reades et al . [ 12 ] used the telecoms usage data to ﬁnd the life patterns in Rome . [ 21 ] introduced NTF into the analysis of human mo - bility , however , the check - in data they used is biased on the activities of “entertaining” , and they model check - in tensor accumulated with respect to the day of week , so that their ap - plication will be limited ( e . g . it is not suitable for modeling the crowd behaviour during disaster time ) . Compared with previous work , our novelty can be summa - rized in the following aspects : 1 ) We modeled the people ﬂow as a tensor , and thus the life pattern we found out is analyzed from a citywide perspective , rather than analyzing each re - gion independently and annotate the patterns as the ranking of the eigenvalue with the region . 2 ) We adapted Non - negative Tensor Factorization rather than Principal Component Analy - sis as our factorization algorithm , and the positivity constraint on the factorization process is more advisable for a people ﬂow analysis as compared to the orthogonality constraint . 3 ) Finally , in this paper , we proposed an extensible framework and derived four real - world applications from this framework . CONCLUSION This paper proposed a spectral analysis framework for de - composing a people ﬂow at a citywide level into basic life patterns . A variety of real - world applications can be derived by fusing spatial or temporal data into this framework . For example , in this paper , we factorized the spatial distribution of POIs simultaneously using a people ﬂow tensor to model the relationship of POIs and human mobility . A site - selection recommendation and people ﬂow simulation are two applica - tions of this co - factorization . In addition , to model geograph - ical shift of the “home” pattern , we co - factorized two people ﬂow tensors of different years in a uniﬁed framework . We note several limitations of our work . First , the GPS Log dataset was constructed by mobile phones and did not cover the portion of population who did not own mobile devices or did not register GPS service . As a result , the dataset was slightly biased towards younger people who are more likely to use GPS service than older people . However , this bias can be reduced by correcting by regional statistics data , which will be included in our future work . Another limitation would be the difﬁculty of evaluation . In this paper , we quantitatively evaluated the predictability of POIs in the CitySpectral space and partially evidenced our interpretation of our results by the news or other reliable information sources . ACKNOWLEDGEMENT This work was partially supported by Grant - in - Aid for Young Scientists ( 26730113 ) of Japans Ministry of Education , Cul - ture , Sports , Science , and Technology ( MEXT ) , Grant of Mi - crosoft Research , Grant of Japans Ministry of Land , Infras - tructure , Transport and Tourism ( MLIT ) , and DIAS / GRENE project of MEXT . We specially thank ZENRIN DataCom CO . , LTD for their supporting . REFERENCES 1 . Cocktail Bars . http : / / www . bento . com / tccocktail . html . 2 . A . Cichocki , R . Zdunek , A . H . P . S . A . Nonnegative Matrix and Tensor Factorizations : Applications to Exploratory Multi - way Data Analysis and Blind Source . John Wiley & Sons , Ltd , 2009 . 3 . Allamanis , M . , Scellato , S . , and Mascolo , C . Evolution of a location - based online social network : analysis and models . In Internet Measurement Conference ( 2012 ) , 145 – 158 . 10 4 . Badea , L . Extracting gene expression proﬁles common to colon and pancreatic adenocarcinoma using simultaneous nonnegative matrix factorization . In Paciﬁc Symposium on Biocomputing , R . B . Altman , A . K . Dunker , L . Hunter , T . Murray , and T . E . Klein , Eds . , World Scientiﬁc ( 2008 ) , 267 – 278 . 5 . Blondel , V . D . , Esch , M . , Chan , C . , Cl´erot , F . , Deville , P . , Huens , E . , Morlot , F . , Smoreda , Z . , and Ziemlicki , C . Data for development : the d4d challenge on mobile phone data . CoRR abs / 1210 . 0137 ( 2012 ) . 6 . Calabrese , F . , Reades , J . , and Ratti , C . Eigenplaces : segmenting space through digital signatures . IEEE Pervasive Computing 9 , 1 ( January - March 2010 ) , 78 – 84 . 7 . Center for Spatial Science . Telepoint Pack DB February 2011 . http : / / www . city . tokyo - nakano . lg . jp / dept / 101500 / d014800 . html . 8 . Eagle , N . , and Pentland , A . Eigenbehaviors : Identifying structure in routine . Tech . rep . , IN PROC . OF UBICOMP06 , 2006 . 9 . Fukushima prefecture government . History of Evacuation Directive . http : / / wwwcms . pref . fukushima . jp / download / 1 / 01240331 . pdf . 10 . Han , J . , Xie , X . , and Woo , W . Context - based microblog browsing for mobile users . JAISE 5 , 1 ( 2013 ) , 89 – 104 . 11 . Hazan , T . , Polak , S . , and Shashua , A . Sparse image coding using a 3d non - negative tensor factorization . In ICCV , IEEE Computer Society ( 2005 ) , 50 – 57 . 12 . Jonathan Reades , Francesco Calabrese , C . R . Eigenplaces : analysing cities using the space - time structure of the mobile phone network . Environment and Planning B : Planning and Design 2009 36 ( 2009 ) , 824 – 836 . 13 . Karatzoglou , A . , Amatriain , X . , Baltrunas , L . , and Oliver , N . Multiverse recommendation : N - dimensional tensor factorization for context - aware collaborative ﬁltering . In Proceedings of the Fourth ACM Conference on Recommender Systems , RecSys ’10 , ACM ( New York , NY , USA , 2010 ) , 79 – 86 . 14 . Lee , D . D . , and Seung , H . S . Learning the parts of objects by nonnegative matrix factorization . Nature 401 ( 1999 ) , 788 – 791 . 15 . Liu , B . , Fu , Y . , Yao , Z . , and Xiong , H . Learning geographical preferences for point - of - interest recommendation . In Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining , KDD ’13 , ACM ( New York , NY , USA , 2013 ) , 1043 – 1051 . 16 . Mairal , J . , Bach , F . , Ponce , J . , and Sapiro , G . Online learning for matrix factorization and sparse coding . Journal of Machine Learning Research 11 ( 2010 ) , 19 – 60 . 17 . N . Bellhumer , J . H . , and Kriegman . , D . Eigenfaces vs . ﬁsherfaces : Recognition using class speciﬁc linear projection . The IEEE Transactions on Pattern Analysis and Machine Intelligence 17 , 7 ( 1997 ) , 711 – 720 . 18 . Nakano Ward government . Nakano Ward Statistics Report in 2012 . https : / / joras . csis . u - tokyo . ac . jp / dataset / show / id / 14000201100 . 19 . Song , X . , Zhang , Q . , Sekimoto , Y . , Horanont , T . , Ueyama , S . , and Shibasaki , R . Modeling and probabilistic reasoning of population evacuation during large - scale disaster . In Proceedings of the 19th ACM SIGKDD international conference on Knowledge discovery and data mining , ACM ( 2013 ) , 1231 – 1239 . 20 . Sun , L . , Lee , D . - H . , Erath , A . , and Huang , X . Using smart card data to extract passenger’s spatio - temporal density and train’s trajectory of mrt system . In Proceedings of the ACM SIGKDD International Workshop on Urban Computing , UrbComp ’12 , ACM ( New York , NY , USA , 2012 ) , 142 – 148 . 21 . Takeuchi , K . , Tomioka , R . , Ishiguro , K . , Kimura , A . , and Sawada , H . Non - negative multiple tensor factorization . In ICDM ( 2013 ) , 1199 – 1204 . 22 . The Japan Times . Chinese upbeat on Fukushima tour . http : / / www . japantimes . co . jp / news / 2012 / 05 / 25 / national / chinese - upbeat - on - fukushima - tour / # . UycJOpiXvUN . 23 . United Nations Centre for Regional Development . Case Study on Reconstruction towards Sustainable Communities in Tohoku Area . http : / / www . npohourai . com / . 24 . Xu , W . , Liu , X . , and Gong , Y . Document clustering based on non - negative matrix factorization . In Proceedings of the 26th Annual International ACM SIGIR Conference on Research and Development in Informaion Retrieval , SIGIR ’03 , ACM ( New York , NY , USA , 2003 ) , 267 – 273 . 25 . Yuan , J . , Zheng , Y . , and Xie , X . Discovering regions of different functions in a city using human mobility and pois . In KDD ( 2012 ) , 186 – 194 . 26 . Yuan , J . , Zheng , Y . , Xie , X . , and Sun , G . Driving with knowledge from the physical world . In Proceedings of the 17th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining , KDD ’11 , ACM ( New York , NY , USA , 2011 ) , 316 – 324 . 27 . Zhang , F . , Wilkie , D . , Zheng , Y . , and Xie , X . Sensing the pulse of urban refueling behavior . In UbiComp ( 2013 ) , 13 – 22 . 28 . Zheng , Y . , Liu , F . , and Hsieh , H . - P . U - air : when urban air quality inference meets big data . In KDD ( 2013 ) , 1436 – 1444 . 29 . Zheng , Y . , and Zhou , X . , Eds . Computing with Spatial Trajectories . Springer , 2011 . 11
Degree switching and partitioning for enumerating graphs to arbitrary orders of accuracy David E . Burstein ∗ a and Jonathan E . Rubin † a a Department of Mathematics , University of Pittsburgh ‡ November 12 , 2018 Abstract We provide a novel method for constructing asymptotics ( to arbitrary accuracy ) for the number of directed graphs that realize a ﬁxed bidegree sequence d = ( a , b ) ∈ Z N × 2 with maximum degree d max = O ( S 12 − τ ) for an arbitrarily small positive number τ , where S is the number edges speciﬁed by d . Our approach is based on two key steps , graph partitioning and degree preserving switches . The former idea allows us to relate enumeration results for given sequences to those for sequences that are especially easy to handle , while the latter facilitates expansions based on numbers of shared neighbors of pairs of nodes . While we focus primarily on directed graphs allowing loops , our results can be extended to other cases , including bipartite graphs , as well as directed and undirected graphs without loops . In addition , we can relax the constraint that d max = O ( S 12 − τ ) and replace it with a max b max = O ( S 1 − τ ) , where a max and b max are the maximum values for a and b respectively . The previous best results , from Greenhill et al . 2006 [ 18 ] , only allow for d max = o ( S 13 ) or alternatively a max b max = o ( S 23 ) . Since in many real world networks , d max scales larger than o ( S 13 ) , we expect that this work will be helpful for various applications . Keywords . Degree sequence , Directed graph , Sparse graph , Zero - one table , Contingency table , Sequential Importance Sampling AMS Subject Classiﬁcations : 05C30 , 05A16 , 62Q05 , 05C07 , 05C20 1 Introduction Given a degree sequence , a fundamental question to ask is whether it is graphic ; that is , does there exist a graph for which the degrees of the nodes are exactly the elements of the sequence ? A more reﬁned view goes beyond simply considering graphicality as a yes - or - no property and recognizes that there may be very diﬀerent numbers of graphs that realize diﬀerent graphic degree sequences . Our main goal in this work is to develop formulas that approximate the numbers of graphs that realize degree sequences with certain properties , which are valid asymptotically as the number of nodes in the degree sequence and in the corresponding graphs goes to inﬁnity . The problem of counting graphs that realize a given degree sequence can be recast as a problem of counting 0 − 1 binary matrices . Speciﬁcally , counting the number of rectangular 0 − 1 binary matrices with ﬁxed row and column sums is equivalent to counting the number of bipartite graphs with a ﬁxed bidegree sequence . Alternatively , counting the number of square 0 − 1 binary matrices with ﬁxed row and column sums is equivalent to counting the number of directed graphs with loops that realize a given bidegree sequence . Since any rectangular 0 − 1 binary matrix can be arbitrarily extended to a square 0 − 1 binary matrix by adding either rows or columns of 0 (cid:48) s , we focus here on square binary matrices . In terms of applications , the aforementioned counting problem is an important step for uniformly gener - ating 0 − 1 matrices ( contingency tables ) with ﬁxed row and column sums . Uniform generation of 0 − 1 binary ∗ Electronic address : dburstein @ pitt . edu † Electronic address : jonrubin @ pitt . edu ; Corresponding author . ‡ The Dietrich School of Arts and Sciences . 301 Thackeray Hall . Pittsburgh , PA 15260 1 a r X i v : 1511 . 03738v2 [ m a t h . C O ] 2 1 O c t 2016 matrices has many applications , from detecting statistically signiﬁcant subgraphs ( motifs ) in a network in data mining [ 14 , 17 , 19 ] to determining the impact of the degree sequence on emergent dynamics in a network of nodes with temporally varying states [ 16 , 30 , 31 ] . While the methods proposed for ( almost ) uniformly generating graphs from a given degree sequence are quite diverse , many ( if not most ) of the methods can be classiﬁed into two categories , Markov Chain Monte Carlo ( MCMC ) methods and Sequential Importance Sampling ( SIS ) . The traditional MCMC method involves swapping edges many times to generate an approximately uni - formly random sample . The main drawback of this method is that there is an unknown mixing time . Naturally , by knowing precise asymptotics for the number of graphs with a prescribed degree sequence , we can deduce asymptotic probabilities for the likelihood two nodes share an edge . Consequently , we could use these asymptotic probabilities as a criteria to empirically help us determine the mixing time . There are quite a few interesting technical issues for implementing this method and we refer the reader to the literature for details [ 5 , 17 , 20 , 25 , 27 , 28 , 29 ] . We also mention that there are MCMC methods that have probable bounds for almost uniformly sampling graphs with a prescribed degree sequence , but they are also computationally expensive [ 7 ] . Alternatively , SIS methods sample the number of graphs with a prescribed degree sequence in a biased way . A large sample of graphs is taken from a biased distribution and a Law of Large Numbers argument is used to construct a new ( approximately ) uniform distribution based on the output of the biased sampling procedure [ 10 , 13 , 15 ] . The biggest drawback of SIS is that we often do not know how large a sample of graphs we need from our biased distribution to reliably construct the approximately uniform distribution . Indeed , past work has shown that certain constraints on degree sequences may be required to ensure the computational eﬃciency of SIS methods [ 3 , 9 ] ; without such constraints , an exponentially large sample size may be required to attain meaningful estimates for approximating the uniform distribution [ 8 ] . Statistical arguments show that to increase the speed of convergence , we want an initial biased distribution that is quite close to the uniform distribution [ 1 , 9 ] . Incorporating asymptotically accurate graph enumeration formulas in constructing a biased distribution could conceivably improve the performance of such methods . The derivation of asymptotic formulas for the number of 0 − 1 binary matrices with ﬁxed row and column sums has a rich history spanning at least as far back as 1958 with Read [ ? ] . Progress in this area has been made by restricting to matrices that are sparse [ 4 ] , in the sense that row and column sums grow at most as a fractional power of the norm of the matrix or by restricting to matrices that are dense but have limited variation among the row and column sums [ 2 , 12 ] . We focus on the sparse case . In this setting , McKay [ 21 ] developed a formula to count such matrices that is valid in an asymptotic sense in the limit as the number of edges S becomes arbitrarily large , assuming that the maximum row sum or column sum grows as o ( S 14 ) . More recently , Greenhill et al . [ 18 ] generalized McKay’s formula , obtaining a result that holds if the maximum row sum or column sum is o ( S 13 ) . Our motivation for considering this counting problem comes from the construction of directed graphs representing neuronal networks in the analysis of the spread of neural activity in certain brain regions . Given that such networks can consist of many thousands of neurons , commonly with connectivities of up to 10 % , we aim to count matrices with row and column sums , corresponding to in - and out - degrees , that exceed O ( S 13 ) . In fact , since we are asymptotically guaranteed graphicality provided that the maximum degree ( row sum or column sum ) is O ( S 12 − τ ) , as demonstrated in [ 11 ] , we expect that we should be able to generalize the above asymptotic formulas to allow for a maximum degree of O ( S 12 − τ ) . To attain this generality , we initially estimate the ratio (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) , where (cid:107) G d i (cid:107) is the number of directed graphs with loops that realize the bidegree sequence d i , i = 1 , 2 , under the constraint that the maximum degree for both of these bidegree sequences is O ( S 12 − τ ) for any τ ∈ ( 0 , 12 ] . We can estimate this ratio accurately when the taxicab norm of the diﬀerence of the bidegree sequences , (cid:107) d 1 − d 2 (cid:107) 1 , equals 2 , and this relation is assumed in the statements of the theorems that we prove . We can apply the theorems in this work to estimate (cid:107) G d k + 1 (cid:107) / (cid:107) G d 0 (cid:107) , where (cid:107) d k + 1 − d 0 (cid:107) 1 > 2 , by considering a product Π ki = 0 (cid:107) G d i + 1 (cid:107) / (cid:107) G d i (cid:107) = (cid:107) G d k + 1 (cid:107) / (cid:107) G d 0 (cid:107) , where for all i , (cid:107) d i − d i + 1 (cid:107) 1 = 2 . ( For a rigorous proof that we can construct a sequence of d i ’s in this fashion , we refer the reader to a result by Muirhead that can be found in [ 6 ] . ) Our main results can be summarized as follows : • In Theorem 1 , we derive an expansion for (cid:107) G d (cid:107) that holds in general for all degree sequences . • In Corollary 3 , we exploit sparsity constraints to prove that the terms in the expansion of (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) 2 based on Theorem 1 decrease geometrically . • Starting with Corollary 4 , we establish an asymptotic approximation for (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) up to errors of size O ( S − 2 τ ) for small τ > 0 , where S is the number of edges in the graph . • Under modest assumptions regarding the asymptotic approximation for (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) with O ( S − 2 wτ ) error terms for some positive integer w , in Theorem 3 we provide a general method that yields an approximation for (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) up to errors of size O ( S − 2 τ − 2 wτ ) . • Next , in Theorem 4 , we demonstrate that if we know that our approximation for (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) is correct up to O ( S − γ ) errors , where 12 ≤ γ , then we can derive a sharper approximation of (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) where our new error term is now O ( S − γ − 2 τ ) without making the “modest assumptions” previously made in Theorem 3 . ( As the proofs of Theorems 3 and 4 are very similar , we place the proof of Theorem 4 in Appendix C . ) • In Theorem 5 , we demonstrate how we can recover an ( arbitrarily ) accurate asymptotic approximation of (cid:107) G d 1 (cid:107) with knowledge of an ( arbitrarily ) accurate approximation of the ratio (cid:107) G d 1 (cid:107) / (cid:107) G d 2 (cid:107) . • Several subsequent theorems in Section 5 extend our O ( S − 2 τ ) approximations up to several successively higher order error terms . • Theorem 12 , which builds on Theorems 10 , 11 , then veriﬁes that the “modest assumptions” of Theorem 3 indeed hold if we allow errors up to O ( S − 1 / 2 ) . Hence , we can use Theorem 3 as many times as needed to reduce errors to O ( S − 1 / 2 ) and then use Theorem 4 to reduce errors to arbitrary order . • In Appendix A , we explain how to generalize our results to the case where the product of the maximet estimae um in - degree and maximum out - degree is of O ( S 1 − τ ) . • In Appendix B , we illustrate how to extend our results to undirected and directed graphs , including the case where loops are prohibited , as well as graphs where we prohibit edges between certain nodes . We now detail our proof strategy . First , in Section 2 , we use graph partitioning , inspired by [ 24 ] , to construct novel expansions for the number of graphs that realize a bidegree sequence . That is , for a particular realization of a bidegree sequence , we can partition our adjacency matrix into two submatrices , one submatrix containing just the i th and j th rows ( or columns ) , and another submatrix containing the remaining N − 2 rows . In turn , we obtain two “smaller” bidegree sequences for both of our submatrices . Once we demonstrate how to count the number of graphs that realize the smaller bidegree sequence corresponding to the two - row submatrix , we obtain the following expression for (cid:107) G d (cid:107) in terms of the number of graphs where two arbitrarily chosen nodes i and j ( with degrees a i , a j ) have k common neighbors : (cid:107) G d (cid:107) = a j (cid:88) k = 0 { (cid:18) a i + a j − 2 k a j − k (cid:19) (cid:88) r ∈ X k (cid:107) G r (cid:107) } ( 1 ) where r is a ( residual ) bidegree sequence of the N − 2 remaining rows and X k is a set of ( residual ) bidegree sequences corresponding to graphs where the i th and j th nodes have exactly k common neighbors . Next , in Section 3 , we introduce the idea of degree preserving switches , as discussed in [ 22 , 23 , 25 , 27 ] , in which we make a single edge replacement to eliminate a common neighbor of two nodes without changing any nodes’ degrees . Counting graphs with common images or pre - images under degree preserving switches allows us to prove that for sparse graphs , the dominant term in the expansion only involves instances where there are no common neighbors between the two nodes i and j . That is , in the notation of ( 1 ) , (cid:107) G d (cid:107) ≈ (cid:18) a i + a j a j (cid:19) (cid:88) r ∈ X 0 (cid:107) G r (cid:107) . Moreover , it turns out that the set X 0 in the prior expression does not change if we consider d ∗ where d ∗ = d except that node i in d ∗ has degree a i − 1 instead of a i for d = ( a , b ) with a = ( a 1 , . . . , a N ) T . Consequently , we ﬁnd that (cid:107) G d ∗ (cid:107) (cid:107) G d (cid:107) ≈ (cid:18) a i + a j − 1 a i − 1 (cid:19) / (cid:18) a i + a j − 1 a j − 1 (cid:19) = a i a j . 3 A subtlety of the proof is that we ﬁrst establish the above statement where node i or j has bounded ( in ) - degree . We then show that the above relationship still holds even for degree sequences that lack a node of bounded degree by using the fact that such degree sequences are very close in taxicab norm to a degree sequence that contains a node of bounded degree . We then proceed in Section 4 by proving ( under modest assumptions ) a recursion that allows for more reﬁned approximations of (cid:107) G d (cid:107) . In particular we demonstrate that the higher order error terms from our approximation of (cid:107) G d ∗ (cid:107) (cid:107) G d (cid:107) in Section 3 , consist of the number of graphs that realize some set of auxiliary degree sequences . Iteratively approximating the number of graphs that realize these auxiliary degree sequences yields the recursion . We then show how asymptotics for (cid:107) G d (cid:107) follow from those obtained for the ratio (cid:107) G d (cid:107) / (cid:107) G d ∗ (cid:107) , where d ∗ is a degree sequence designed such that both this ratio and (cid:107) G d ∗ (cid:107) itself can be estimated . More precisely , we achieve this result by working with a sequence of intermediary degree sequences , starting from a sequence for which it is easy to compute the number of graphs that realize it and , from there , progressing successively closer to d . Subsequently in Section 5 , we put the technique proposed by Section 4 into practice , computationally verifying that the ’modest assumptions’ do indeed hold for certain speciﬁc orders of error and deriving various asymptotic approximations for the ratio (cid:107) G d (cid:107) / (cid:107) G d ∗ (cid:107) . Finally , in Section 6 , we prove that the assumptions hold up to O ( S − 1 / 2 ) errors , which together with the previous results shows that our method yields arbitrarily accurate asymptotic approxiations for the ratio (cid:107) G d (cid:107) / (cid:107) G d ∗ (cid:107) . Establishing these results relies on deriving approximations for sums of the form (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) that come up in our expansions . Successively improved approximations are obtained by relating such expressions with the inequality of arguments enforced to similar expressions where certain arguments are either allowed to be equal or are forced to be equal . When such terms appear in our ratios , these relations can be used to represent numerators in the right way to achieve cancellation with corresponding denominators , such that terms that remaining after cancellaton are of higher order . 2 Using Partitioning to Count Graphs In this paper , we will consider bidegree sequences , each denoted by d = ( a , b ) ∈ Z N × 2 , where for concreteness we specify that a lists the in - degrees of the nodes in the sequence and b the out - degrees . We are interested in graphs that realize such sequences , where we allow either 0 or 1 connection between each pair of nodes as well as single self - loops within each graph . Throughout the paper , we use S to denote the number of edges in the graphs that realize d . Since we do not need to distinguish between degree sequences and bidegree sequences in this work , we will henceforth simply refer to these as degree sequences . In one special case , it is particularly easy to count the number of graphs that realize a speciﬁed degree sequence . Lemma 1 . Suppose that a = { a 1 , . . . , a k , 0 , . . . , 0 } , b = { k , . . , k , 1 , . . , 1 , 0 , . . , 0 } , and k (cid:88) i = 1 a i = N (cid:88) i = 1 b i = : S . Let q denote the number of times k appears in b and let p = min { a 1 , . . . , a k } . If p < q , then there does not exist a graph that realizes this bidegree sequence . If p ≥ q then there are ( S − qk ) ! Π i ( a i − q ) ! graphs that realize the bidegree sequence . Similarly , if a = { k , . . , k , 1 , . . , 1 , 0 , . . , 0 } and b = { b 1 , . . . , b k , 0 , . . . , 0 } , with corresponding deﬁnitions of p and q , then there are ( S − qk ) ! Π i ( b i − q ) ! graphs that realize the bidegree sequence . 4 Proof . We present the proof for the ﬁrst case , since the second is completely analogous . We ﬁrst note that the q nodes in b with out - degrees equal to k must connect to all of the nodes with nonzero degree in a . Of the S − qk remaining outward edges , start with the node that corresponds to a 1 . There are S − qk choices for outward edges that can supply the a 1 − q unconnected inward edges to this node , such that there are (cid:0) S − qk a 1 − q (cid:1) possible ways to link this node into the graph . Once these a 1 − q edges have been connected , there are (cid:0) S − qk − a 1 + q a 2 − q (cid:1) ways to link the node that corresponds to a 2 into the graph . Notice that (cid:18) S − qk − a 1 + q a 2 − q (cid:19)(cid:18) S − qk a 1 − q (cid:19) = ( S − qk ) ! ( a 1 − q ) ! ( a 2 − q ) ! ( S − qk − a 1 − a 2 + 2 q ) ! . Multiplying inductively , the ( S − qk − a 1 − a 2 + 2 q ) ! term disappears and we obtain the desired result . Remark 1 . Lemma 1 generalizes immediately to arbitrary permutations of the given a and b . With the above lemma in hand , we can construct an inductive characterization for the number of graphs that realize a speciﬁed degree sequence . First , though , we must deﬁne some notation . Deﬁnition 1 . Let (cid:107) G d (cid:107) denote the number of graphs that realize a degree sequence d . Furthermore , for a set X of degree sequences , let (cid:107) G X (cid:107) be the number of graphs that realize any degree sequence in X . Now , consider an arbitrary adjacency matrix A ∈ { 0 , 1 } M × N . We can write A as A =   A 1 A 2 · · · A N δ M − 1 , 1 δ M − 1 , 2 · · · δ M − 1 , N δ M , 1 δ M , 2 · · · δ M , N   where for each i , A i ∈ { 0 , 1 } ( M − 2 ) × 1 . Of course , letting 0 denote a column vector of M − 2 zeros , we have A =   A 1 A 2 · · · A N 0 0 · · · 0 0 0 · · · 0   +   0 0 · · · 0 δ M − 1 , 1 δ M − 1 , 2 · · · δ M − 1 , N δ M , 1 δ M , 2 · · · δ M , N   . Call the ﬁrst and second matrices in this equation A l and A r , respectively . Now , if A realizes a given degree sequence , ( a , b ) , then there is a vector { s 1 , . . . , s N } such that the degree sequence of ( the graph corre - sponding to ) A r is ( { 0 , . . . , 0 , a M − 1 , a M } , { s 1 , . . . . , s N } ) and the degree sequence of A l is ( { a 1 , . . . , a M − 2 , 0 , 0 } , { b 1 − s 1 , . . . . , b N − s N } ) , with the constraint that none of the s i ( i . e . , the column sums of A r ) can exceed 2 and the s i must sum to a M − 1 + a M . If we know the number of s i that equal 2 , we can invoke Lemma 1 to count the number of realizations of the degree sequence of ( { 0 , . . . , 0 , a M − 1 , a M } , { s 1 , . . . . , s N } ) . This idea , extended to a partition of the i th and j th rows rather than speciﬁcally the ( M − 1 ) st and M th rows , motivates a useful theorem . To state the theorem , we deﬁne the set of degree sequences X k ( i , j ; d ) = { ( a − a i e i − a j e j , b − s ) : # ( s n = 2 ) = k , # ( s n ≥ 3 ) = 0 , and (cid:80) Nn = 1 s n = a i + a j } . ( 2 ) Note that in equation ( 2 ) , we explicitly represent the positions ( i , j ) from which edges will be partitioned out as well as the base degree sequence d = ( a , b ) . X k ( i , j ; d ) is a set of degree sequences , even with d ﬁxed , because diﬀerent choices of s can be made that ﬁt the deﬁnition in ( 2 ) . The notation X k ( i , j ; d ) is cumbersome and the arguments of X k will be dropped when possible , but this notation will be needed to make results precise later in the paper . Theorem 1 . Fix a degree sequence d = ( a , b ) . Pick an arbitrary pair of nodes , say with indices i , j and corresponding in - degrees a i , a j , where a j ≤ a i , and deﬁne X k = X k ( i , j ; d ) as in ( 2 ) . Then (cid:107) G d (cid:107) = a j (cid:88) k = 0 (cid:18) a i + a j − 2 k a j − k (cid:19) (cid:107) G X k (cid:107) . 5 Proof . Any adjacency matrix that realizes d can be partitioned into two adjacency matrices as we have discussed . Picking any two nodes , with in - degrees denoted by a i , a j , we note that any realization of our degree sequence d must also be a realization of some degree sequence ( a − a i e i − a j e j , b − s ) ∈ X k for some k ≤ N , combined with a realization of the degree sequence ( a i e i + a j e j , s ) . In order for ( a i e i + a j e j , s ) to be graphic , we require that # ( s i = 2 ) ≤ a j ( see Lemma 1 ) , hence only graphs that realize degree sequences in X k for k ≤ a j can correspond to our adjacency matrix partition . If ( a − a i e i − a j e j , b − s ) ∈ X k for k ≤ a j , then Lemma 1 implies that the number of graphs that realize ( a i e i + a j e j , s ) is precisely (cid:0) a i + a j − 2 k a j − k (cid:1) . By multiplying this quantity by the number of graphs that can be generated by the residual degree sequence ( a − a i e i − a j e j , b − s ) , namely (cid:107) G X k (cid:107) , and summing over all X k for k ≤ a j , we obtain the desired result . Remark 2 . Based on Deﬁnition 1 , (cid:107) G X k (cid:107) represents the expression (cid:80) r ∈ X k (cid:107) G r (cid:107) , such that Theorem 1 agrees with equation ( 1 ) . At this point , we introduce some additional notation . The rationale is that we will want to compare numbers of graphs realizing two diﬀerent degree sequences that are identical except that the in - degrees of two particular nodes in the sequences diﬀer by 1 . A succint way to think of this relation is to start with a degree sequence d = ( a , b ) for which (cid:80) k a k = (cid:80) k b k + 1 . Now , for any entry a k ≥ 1 in a , let a − k = a − e k , d − i = ( a − i , b ) , and d − j = ( a − j , b ) . Note that the sums of the in - degrees for the sequences d − i and d − j are identical and are equal to the sum of their out - degrees , and d − i , d − j are related as desired . Given Theorem 1 , we can attain a nontrivial approximation for the ratio of the number of graphs that realize the degree sequence d − i compared to the number of graphs that realize the degree sequence d − j . To do so , we will need to work with X k ( i , j ; d − i ) and X k ( i , j ; d − j ) . But note that since d − i , d − j are both deﬁned from the same base sequence d and have the same in - degree sum , these two X k are identical ; hence , we will simply refer to this set as X k in the proof below , and we will similarly drop the arguments of X k in most subsequent parts of the paper . Corollary 1 . If a i ≥ a j > 0 , then (cid:107) G d − i (cid:107) ≥ a i a j (cid:107) G d − j (cid:107) . Proof . First deﬁne the variable δ such that if a j + 1 ≤ a i , then δ = 1 and otherwise , δ = 0 . The statement of the Corollary holds trivially if d − j is not graphic . If d − j is graphic , then so is d − i and we can apply Theorem 1 and note that (cid:107) G d − i (cid:107) = a j − 1 + δ (cid:88) k = 0 (cid:18) ( a i − 1 ) + a j − 2 k a j − 1 + δ − k (cid:19) (cid:107) G X k (cid:107) ≥ a j − 1 (cid:88) k = 0 (cid:18) a i + a j − 2 k − 1 a j − k (cid:19) (cid:107) G X k (cid:107) . Similarly , (cid:107) G d − j (cid:107) = (cid:80) a j − 1 k = 0 (cid:0) a i + a j − 2 k − 1 a j − k − 1 (cid:1) (cid:107) G X k (cid:107) . If we show that for all relevant natural numbers k , (cid:18) a i + a j − 2 k − 1 a j − k (cid:19) ≥ a i a j (cid:18) a i + a j − 2 k − 1 a j − k − 1 (cid:19) , then the result will follow . Note that (cid:18) a i + a j − 2 k − 1 a j − k (cid:19) / (cid:18) a i + a j − 2 k − 1 a j − k − 1 (cid:19) = a i − k a j − k ≥ a i a j , since a i ≥ a j , and the proof is complete . We next seek a compact expression for (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) that will enable us to analyze this ratio with minimal diﬃculty without having to explicitly worry about the number of terms in the formulas for (cid:107) G d − i (cid:107) or (cid:107) G d − j (cid:107) found in the summation in Theorem 1 . Before we do that we introduce two additional notational conventions : Π r − 1 k = r ω k = 1 and Π 0 k = 0 ω k = ω 0 . ( 3 ) 6 Corollary 2 . (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j (cid:32) (cid:80) a j k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k (cid:80) a j − 1 k = 0 Π kl = 1 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k (cid:33) ( 4 ) where η k = (cid:107) G X k (cid:107) [ Π 2 k − 1 l = 0 ( a i + a j − l − 1 ) ] (cid:107) G X 0 (cid:107) ( 5 ) when k ≤ (cid:98) a i + a j − 1 2 (cid:99) , and η a j ≡ η a i = 1 when k = a j if a j = a i . Proof . Without loss of generality , assume a j < a i − 1 . That is , if a j ∈ { a i , a i − 1 } , then we can adjust the calculations with δ = 1 as in the proof of Corollary 1 and they will go through ; furthermore , if a j = a i , then the k = a j = a i term in the numerator of the right hand side of ( 4 ) is 0 , so we can set η a i = a j = 1 ( or any ﬁnite number ) and the result will still hold . By invoking Theorem 1 , using X k = X k ( i , j ; d − i ) = X k ( i , j ; d − j ) , and dividing the numerator and denominator by (cid:107) G X 0 (cid:107) , we obtain (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = (cid:16)(cid:80) a j k = 0 (cid:0) a i + a j − 2 k − 1 a j − k (cid:1) (cid:107) G X k (cid:107) / (cid:107) G X 0 (cid:107) (cid:17) / (cid:16)(cid:80) a j − 1 k = 0 (cid:0) a i + a j − 2 k − 1 a j − k − 1 (cid:1) (cid:107) G X k (cid:107) / (cid:107) G X 0 (cid:107) (cid:17) . ( 6 ) Now we multiply both the numerator and denominator by a i ! a j ! ( a i + a j − 1 ) ! , which yields (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = (cid:18)(cid:80) a j k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 0 ( a i − l ) (cid:107) G Xk (cid:107) Π 2 k − 1 l = 0 ( a i + a j − l − 1 ) (cid:107) G X 0 (cid:107) (cid:19) / (cid:18)(cid:80) a j − 1 k = 0 Π kl = 0 ( a j − l ) Π k − 1 l = 0 ( a i − l ) (cid:107) G Xk (cid:107) Π 2 k − 1 l = 0 ( a i + a j − l − 1 ) (cid:107) G X 0 (cid:107) (cid:19) . ( 7 ) Substituting in η k as deﬁned in equation ( 5 ) , we obtain (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = (cid:80) ajk = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 0 ( a i − l ) η k (cid:80) aj − 1 k = 0 Π kl = 0 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k = a i a j (cid:18) (cid:80) ajk = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k (cid:80) aj − 1 k = 0 Π kl = 1 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k (cid:19) , ( 8 ) which agrees with equation ( 4 ) . Remark 3 . Obviously the right hand side of ( 4 ) does not change if we add zero terms to the sums in the numerator and denominator . The summation in the numerator of this expression can be rewritten using a j (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k = a j + 1 (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k , which follows because a j + 1 (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k − a j (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k = Π a j l = 0 ( a j − l ) Π a j + 1 l = 1 ( a i − l ) η a j + 1 = 0 . Inductively , it follows that a j (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k = ∞ (cid:88) k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k . 7 Analogously , a j − 1 (cid:88) k = 0 Π kl = 1 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k = ∞ (cid:88) k = 0 Π kl = 1 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k . Therefore , we can extend the statement of Corollary 2 to read (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j (cid:32)(cid:80) ∞ k = 0 Π k − 1 l = 0 ( a j − l ) Π kl = 1 ( a i − l ) η k (cid:80) ∞ k = 0 Π kl = 1 ( a j − l ) Π k − 1 l = 0 ( a i − l ) η k (cid:33) ( 9 ) where η k is deﬁned in the statement of Corollary 2 for k ≤ (cid:98) a i + a j − 1 2 (cid:99) and η k = 1 ( or any ﬁnite number ) for all other k . Expression ( 9 ) will be useful for providing ﬂexibility in subsequent calculations . The results we have proved so far apply to any graphic degree sequence . Under additional assumptions , at the cost of generality , we can go farther and obtain a power series representation for the ratio (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) . Speciﬁcally , if our graph is in some sense “sparse” , equation ( 9 ) suggests that (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = a i / a j + O ( (cid:15) ) for (cid:15) “small” . We will elaborate on this idea in the following section . 3 Degree Preserving Switches to Count Graphs We will use the idea of degree preserving switches to estimate the likelihood that two nodes have a common neighbor . This estimation will help us to derive a power series expansion of ( 9 ) that is valid if we let the number of nodes , or correspondingly the number of elements in each degree sequence , be suﬃciently large . To obtain this result , it is important to set notation to specify how degrees behave as sequence length grows . Deﬁnition 2 . Consider a sequence of degree sequences , { d N } N ∈ N , where each d N ∈ Z N × 2 . We say that d max ( { d N } N ∈ N ) = O ( S p ) , where p ∈ R and S = S ( d N ) is the sum of the edges for the degree sequence d N , if and only if there exists a ﬁxed constant C ∈ R such that lim N →∞ max ( d N ) S p ≤ C , where the maximum is taken over all components of d N and lim denotes the limit supremum . For notational simplicity , we will omit explicit reference to the sequence of degree sequences when we write d max = O ( S p ) . The use of the O ( S ) notation is meant to indicate that we are not referring to the maximum degree of a ﬁxed degree sequence . Analogously , we can say that for a sequence of degree sequences , the total number of nodes is O ( S p ) for some p ∈ R . In addition , we say that the i th node has bounded ( in ) - degree in the limit of a sequence of degree sequences , if lim N →∞ ( a N ) i ≤ C , where C ∈ R and ( a N ) i denotes the i th element of the vector a N . At this juncture , we are ready to prove a result about the asymptotic likelihood of obtaining a graph , based on a uniform sampling of graphs realizing a degree sequence , in which two ﬁxed nodes form edges with a common target node . Figure 1 : An example of the type of degree preserving switch described in the proof of Theorem 2 . The top image is the input graph ( i . e . , the graph before the switch is applied ) and the bottom is the output graph ( generated by the switch ) . Note that in the output graph , all nodes have the same in and out degrees as in the input graph but the two blue nodes no longer have a common neighbor . 8 Theorem 2 . Consider a sequence of degree sequences such that d max = O ( S 12 − τ ) for some τ > 0 . Pick an arbitrary node x and another node y such that y has a bounded number of edges in the limit of the sequence of degree sequences . In the limit of the sequence of degree sequences , the ratio of the number of realizations of graphs where there does not exist a node that receives an outward edge from ( or supplies an inward to ) both x and y relative to the number of graphs where exactly one node receives an outward edge from ( or supplies an inward edge to ) both x and y is O ( S 2 τ ) . Proof . We will focus on the case of outward edges from x and y , as the inward case is analogous . Consider a realization of a ﬁxed degree sequence where a node ( red in Figure 1 ) receives outward edges from nodes x and y ( both blue ) . We can then deﬁne a degree preserving switch by choosing a remaining edge whose end points are not a red or blue node and redirecting it to the red node . Then to preserve the degree , we replace the edge that connects the right blue node ( x ) to the red node with an edge from x to the node that is now missing an edge . Unfortunately , this operation is not 1 : 1 , since diﬀerent input graphs can yield the same output graph , so we need to account for such repeats in order to accurately count the likelihood of a node receiving edges from both x and y . Let us refer to the nodes receiving edges from a ﬁxed node as the out - neighbors of that node and to the nodes supplying edges to a ﬁxed node as the in - neighbors of that node . In the output graph of the degree preserving switch operator in Figure 1 , denote the out - neighbors of node x by S = { s 1 , . . . , s l } and the out - neighbors of node y by T = { t 1 , . . . , t m } , where l , m are the out - degrees of nodes x , y , respectively . Since the desired result only pertains to input graphs where x and y share exactly one common out - neighbor , we have S ∩ T = ∅ . Importantly , for each input graph that maps to this output graph , x must have l − 1 out - neighbors that are still its out - neighbors in the output graph , while the out - neighbors of y in the input and output graphs are the same . Without loss of generality , suppose that in the input graph , t 1 is the node that has edges from both x and y . In the output graph denote the in - neighbors of t 1 as U = { u 1 , . . . . , u n } where n denotes the in - degree of t 1 . In an input graph that is mapped by the degree preserving switch to the desired output graph , t 1 must have edges with n − 1 of the nodes in U . Naturally , there are (cid:0) n − 1 1 (cid:1) ways for this to happen . Since l − 1 of the out - neighbors of x in the input graph must also be out - neighbors of x in the output graph , we conclude that there are fewer than nl = O ( S 1 − 2 τ ) ways to generate the same output if t 1 is the node that has edges with both x and y in the input graph . We now repeat the same argument for each out - neighbor of y in the output graph . Since y has bounded degree , it follows that under the degree preserving operation , there are at most O ( S 1 − 2 τ ) ways to generate the same output . Now that we know that our degree preserving operation is a O ( S 1 − 2 τ ) : 1 function , to ﬁnish oﬀ the proof , we need to identify how many degree preserving switches are possible from a single graph . The edges that are eligible to be switched connect nodes such that the source is not an in - neighbor of the common out - neighbor of x and y and the target does not already receive an edge from x ( see Figure 1 ) . Since x has degree at most O ( S 12 − τ ) , that means the total number of edges corresponding to the neighbors of x is at most O ( S 1 − 2 τ ) . Analogously , the common out - neighbor of x and y has degree at most O ( S 12 − τ ) and the number of edges corresponding to its in - neighbors is O ( S 1 − 2 τ ) . Consequently , we have O ( S ) − O ( S 1 − 2 τ ) = O ( S ) edges that we can choose from for the degree preserving switch operator to switch . Hence , for every graph where x and y have a common out - neighbor , the number of unique graphs where they do not have a common out - neighbor is at least the ratio of O ( S ) to the number of input graphs that can map to each output graph , namely O ( S ) / O ( S 1 − 2 τ ) = O ( S 2 τ ) , which is our desired result . Corollary 3 . Fix a sequence of degree sequences such that d max = O ( S 12 − τ ) . Let k ∈ N . For any two nodes x and y , where y has bounded degree in the limit of the sequence of degree sequences , the ratio of the number of graphs where k nodes receive edges from both x and y compared to the number of graphs where k + 1 nodes receive edges from both x and y is O ( S 2 τ ) . Proof . Perform the same switch technique as in Theorem 2 on a particular node that has an edge with both x and y , and the result follows analogously . Next , we apply Corollary 3 to begin to expand the terms in equation ( 4 ) . 9 Corollary 4 . If d max = O ( S 12 − τ ) , then (cid:107) G d − i (cid:107) = a i a j (cid:107) G d − j (cid:107) [ 1 + O ( S − 2 τ ) ] . Proof . First suppose that either node i or node j has bounded degree . By Corollary 3 , we know that for all k ≥ 1 , (cid:0) a i + a j − 2 k − 1 a j − k (cid:1) (cid:107) G X k (cid:107) (cid:0) a i + a j − 1 a j (cid:1) (cid:107) G X 0 (cid:107) = O ( S − 2 kτ ) and (cid:0) a i + a j − 2 k − 1 a j − k − 1 (cid:1) (cid:107) G X k (cid:107) (cid:0) a i + a j − 1 a j − 1 (cid:1) (cid:107) G X 0 (cid:107) = O ( S − 2 kτ ) , as these terms represent the number of graphs with k common neighbors of the two nodes i and j divided by the number of graphs where nodes i and j have no common neighbors . So we conclude from equation ( 6 ) in the proof of Corollary 2 that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = ( ai + aj − 1 aj ) ( ai + aj − 1 aj − 1 ) + (cid:80) ajk = 1 ( ai + aj − 2 k − 1 aj − k ) ( ai + aj − 1 aj − 1 ) (cid:107) GXk (cid:107) (cid:107) GX 0 (cid:107) 1 + (cid:80) aj − 1 k = 1 ( ai + aj − 2 k − 1 aj − k − 1 ) ( ai + aj − 1 aj − 1 ) (cid:107) GXk (cid:107) (cid:107) GX 0 (cid:107) = ( ai + aj − 1 aj ) ( ai + aj − 1 aj − 1 ) + (cid:80) ajk = 1 ( ai + aj − 2 k − 1 aj − k ) ( ai + aj − 1 aj − 1 ) (cid:107) GXk (cid:107) (cid:107) GX 0 (cid:107) 1 + O ( S − 2 τ ) = ( ai + aj − 1 aj ) ( ai + aj − 1 aj − 1 )   1 + (cid:80) ajk = 1 ( ai + aj − 2 k − 1 aj − k ) ( ai + aj − 1 aj ) (cid:107) GXk (cid:107) (cid:107) GX 0 (cid:107) 1 + O ( S − 2 τ )   = a i a j [ 1 + O ( S − 2 τ ) 1 + O ( S − 2 τ ) ] = a i a j [ 1 + O ( S − 2 τ ) ] . To extend this relationship to the general case where nodes i and j both have degree O ( S 12 − τ ) , we consider the degree sequences d ( i ) = ( { a , 1 } − e i , { b , 0 } ) , d ( j ) = ( { a , 1 } − e j , { b , 0 } ) ∈ Z ( N + 1 ) × 2 , for which (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = (cid:107) G d ( i ) − ( N + 1 ) (cid:107) (cid:107) G d ( i ) − j (cid:107) (cid:107) G d ( j ) − i (cid:107) (cid:107) G d ( j ) − ( N + 1 ) (cid:107) , ( 10 ) where node N + 1 has bounded degree and d ( j ) − i = d ( i ) − j . Consequently , (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j [ 1 + O ( S − 2 τ ) ] . We conclude this section noting that the proof technique can be extended to more general cases . We can relax the constraint that d max = O ( S 12 − τ ) and still attain that two nodes in general should not share common neighbors . For more details we refer the reader to Appendix A . On a similar note , the notion that a node of bounded degree and an arbitrary node should not share common neighbors extends to cases beyond directed graphs with loops , including directed and undirected graphs without loops . We discuss in Appendix B how to extend these arguments to these cases , noting that similar ideas also apply to graphs with other edges prohibited besides loops . Section 4 explains how to iteratively attain more reﬁned approximations from the relatively crude approximation given by Corollary 4 . These results also generalize in ways that are discussed in the appendices . 4 Asymptotic Enumeration for Arbitrary Orders of Accuracy Since we have established some fundamental results in the prior section , we can now derive our general asymptotic enumeration . We start by establishing an alternative expression for (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) . For this statement , deﬁne X 0 i as the set of all residual degree sequences ( a − a i e i − e j , b − s ) with s constructed by removing one ( outgoing ) edge from each of a i nodes ; deﬁne X 1 i as the set of all residual degree sequences constructed by removing two outgoing edges from one node and one edge from a i − 2 nodes ; and deﬁne X 0 j , X 1 j analogously from ( a − e i − a j e j , b − s ) . 10 Corollary 5 . (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j (cid:32) 1 + (cid:107) G X 1 i (cid:107) / ( a i (cid:107) G X 0 i (cid:107) ) 1 + (cid:107) G X 1 j (cid:107) / ( a j (cid:107) G X 0 j (cid:107) ) (cid:33) ( 11 ) Proof . The proof is in the spirit of Corollary 4 . Let d ( i ) = ( { a , 1 } − e i , { b , 0 } ) , d ( j ) = ( { a , 1 } − e j , { b , 0 } ) ∈ Z ( N + 1 ) × 2 . We previously established equation ( 10 ) . But applying Theorem 1 yields (cid:107) G d ( i ) − ( N + 1 ) (cid:107) (cid:107) G d ( i ) − j (cid:107) = (cid:107) G X 0 j (cid:107) a j (cid:107) G X 0 j (cid:107) + (cid:107) G X 1 j (cid:107) = 1 a j (cid:32) 1 1 + (cid:107) G X 1 j (cid:107) / ( a j (cid:107) G X 0 j (cid:107) ) (cid:33) . Similarly , (cid:107) G d ( j ) − i (cid:107) (cid:107) G d ( j ) − ( N + 1 ) (cid:107) = a i (cid:107) G X 0 i (cid:107) + (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = a i ( 1 + (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) ) . Corollary 5 will be useful to us when combined with the observation that for an arbitrary degree sequence m , (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = (cid:80) x ∈ X 1 i (cid:107) G x (cid:107) (cid:80) x ∈ X 0 i (cid:107) G x (cid:107) = (cid:80) x ∈ X 1 i (cid:107) G x (cid:107) / (cid:107) G m (cid:107) (cid:80) x ∈ X 0 i (cid:107) G x (cid:107) / (cid:107) G m (cid:107) . ( 12 ) That is , equation ( 11 ) represents a recursion that expresses the ratio of the number of graphs of two diﬀerent degree sequences as a function of the ratios of the numbers of graphs of various other degree sequences . We now state the ﬁrst of three theorems that will enable us to reach the desired asymptotic enumeration results of arbitrary order . Theorem 3 . Let d = ( a , b ) with (cid:80) a n = (cid:80) b n ± 1 and d max = O ( S 12 − τ ) . Consider an approximation that satisﬁes the equation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = f ( e i , e j , d , σ ) ( 1 + O ( S − 2 wτ ) ) where w ≥ 1 , 2 wτ ≤ γ ( we deﬁne γ below ) , and the last argument σ either equals a , which denotes that (cid:80) a n = (cid:80) b n + 1 and the two degree sequences in the ratio diﬀer in their in - degree sequences ( i . e . , the in - degree sequence is being used to deﬁne d − i ) , or σ equals b , which has the analogous connotation with respect to out - degree sequences , with (cid:80) a n = (cid:80) b n − 1 . Assume that f ( e i , e j , d , σ ) = h ( e i , d , σ ) / h ( e j , d , σ ) for some function h . Furthermore , suppose that for m = O ( S 12 − τ ) , h ( e i , d 1 , σ 1 ) = h ( e i , d 0 , σ 0 ) ( 1 + O ( S − γ ) ) ( 13 ) where (cid:107) d 1 − d 0 (cid:107) 1 ≤ m , (cid:107) d 1 − d 0 (cid:107) ∞ ≤ 1 , σ i is either a i or b i ( i . e . , the in - or out - degree sequence of d i ) , and the following equalities of dot products hold : σ 1 · e i = σ 0 · e i , σ 1 · e j = σ 0 · e j . If σ = a , then there exists a sharper approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = g ( e i , e j , d , a ) ( 1 + O ( S − 2 ( w + 1 ) τ ) ) where g ( e i , e j , d , a ) = a i a j exp ( log ( 1 + ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u k , d k , i , j , b k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , e u k , d k , i , j , b ) ) − log ( 1 + ( a j − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x aj − 1 = x aj Π a j k = 1 f ( e x k , e u k , d k , j , i , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x aj − 1 (cid:54) = x aj Π a j k = 1 f ( e x k , e u k , d k , j , i , b ) ) ) for any arbitrary choice of indices { u k } , where d k , i , j = ( a − a i e i − e j , b − (cid:80) a i − k + 1 j = 1 e u j − (cid:80) k − 1 j = 1 e x j ) . A similar sharpened approximation , with g depending on b , holds if σ = b . 11 We will postpone the motivation for the assumptions that f ( e i , e j , d , σ ) = h ( e i , d , σ ) / h ( e j , d , σ ) for some function h and that perturbing the third argument of f ( the degree sequence ) only results in relatively small changes in h until Section 6 . In Section 5 , when we use the above theorem to explicitly compute asymptotics of the ratio (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) , we will be able to verify these assumptions directly . Even at this stage , we already know that the approximation (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = a i a j ( 1 + O ( S − 2 τ ) ) does not depend on the degrees of the nodes in the degree sequence other than nodes i and j . Similarly , this approximation can be expressed in terms of a decomposition like that assumed in Theorem 3 , given by (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = [ h ( e i , d , a ) / h ( e j , d , a ) ] ( 1 + O ( S − 2 τ ) ) , where h ( e i , d , a ) = a i . We now proceed with the proof . Proof . Consider d such that (cid:80) a n = (cid:80) b n + 1 . We know from equation ( 11 ) that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp ( log ( 1 + (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) ) − log ( 1 + (cid:107) G X 1 j (cid:107) a j (cid:107) G X 0 j (cid:107) ) ) . Let (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) = f ( e i , e j , d , a ) ( 1 + O ( S − 2 wτ ) ) for some w ≥ 1 . Our goal is to show that substituting the decomposition for f into equation ( 25 ) yields a sharper approximation g , as speciﬁed in the theorem statement ( the proof with σ = b is analogous ) . To prove this claim rigorously , we show that using f to approximate (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) can allow us to derive an improved approximation of (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) , in a sense that will be made precise later . Since (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) is equivalent to (cid:107) G X 1 j (cid:107) a j (cid:107) G X 0 j (cid:107) , we can carry over our results to the latter expression to complete the derivation . For any u ∈ X 0 i , equation ( 12 ) yields (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) = (cid:80) x ∈ X 1 i (cid:107) G x (cid:107) / (cid:107) G u (cid:107) a i (cid:80) x ∈ X 0 i (cid:107) G x (cid:107) / (cid:107) G u (cid:107) . ( 14 ) Now , for any x ∈ X 0 i ∪ X 1 i , the bidegree sequences u and x include the same number of edges and identical in - degree sequences . By deﬁnition we can write x = ( a − a i e i − e j , b − (cid:80) a i j = 1 e x j ) and u = ( a − a i e i − e j , b − (cid:80) a i j = 1 e u j ) . Let d 1 = u , d a i + 1 = x , and deﬁne intermediate degree sequences d k = ( a − a i e i − e j , b − (cid:80) a i − k + 1 j = 1 e u j − (cid:80) k − 1 j = 1 e x j ) for each k = 2 , . . . , a i . Note that the sum of the in - degrees equals the sum of the out - degrees in each d k , since by assumption , (cid:80) a n = (cid:80) b n + 1 . Letting φ ( e i , e j , d , σ ) : = (cid:107) G d − i (cid:107) / (cid:107) G d − j (cid:107) ( 15 ) for any choice of d , these deﬁnitions imply that for our particular d under consideration , (cid:107) G x (cid:107) (cid:107) G u (cid:107) = Π a i k = 1 (cid:107) G d k + 1 (cid:107) (cid:107) G d k (cid:107) = Π a i k = 1 φ ( e x k , e u ai − k + 1 , ( a − a i e i − e j , b − k − 1 (cid:88) j = 1 e x j − a i − k (cid:88) j = 1 e u j , b ) , ( 16 ) where now the sum of the in - degrees in the third argument of φ in ( 15 ) is one less than the sum of the out - degrees . Recall that the ﬁnal argument b of φ in ( 15 ) implies that in the numerator and denominator of the right hand side of ( 15 ) , a degree is being subtracted oﬀ of the out - degree sequence of the bidegree sequence given in the third argument of φ , which means that the in - and out - degree sequences in d − i , d − j end up with the same sums . The particular components of the out - degree sequence from which a degree is being subtracted are speciﬁed in the ﬁrst and second arguments of φ for the numerator and denominator , respectively . Now , deﬁne ∆ i to be the diﬀerence between (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) evaluated using the exact ratio φ and the same quantity evaluated using the approximation f . Recall that each x ∈ X 0 i was deﬁned by removing the a i incoming edges to node i along with one outgoing edge from each of a i distinct nodes . The number of resulting bidegree sequences is the same as the number of bidegree sequences in which the a i outgoing edges 12 are directed to node i instead of being removed . There is an analogous equivalence for each x ∈ X 1 i . Hence , we can write ∆ i as ∆ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 φ ( e x k , e u ai − k + 1 , ( a − a i e i − e j , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 φ ( e x k , e u ai − k + 1 , ( a − a i e i − e j , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) − ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u ai − k + 1 , ( a − a i e i − e j , ( b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , e u ai − k + 1 , ( a − a i e i − e j , ( b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) . ( 17 ) Since the choice for u a i − k + 1 is arbitrary and assumption ( 13 ) in the theorem statement holds , we can simplify the notation by using f k ( x k ) in place of the full expression for f . ( We will defer a technical point regarding this simpliﬁcation to the end of the proof . ) In contrast , φ does depend on the degree sequence and on . x 1 , . . . , x k − 1 . But for simplicity , we abuse notation and write φ k ( x k ) . This reduces to a more tractable ( but slightly misleading ) notation : ∆ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 φ k ( x k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 φ k ( x k ) − ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f k ( x k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f k ( x k ) . Denote D 0 as the set of sets of a i distinct indices in { 1 , . . . , N } and D 1 as the set of sets of a i indices in { 1 , . . . , N } such that the ﬁrst a i − 2 are distinct and the ﬁnal two are equal . Writing ∆ i as a single fraction , we obtain ∆ i = ( a i − 1 ) [ (cid:80) D 1 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) − (cid:80) D 1 Π a i k = 1 f k ( x k ) (cid:80) D 0 Π a i k = 1 φ k ( x k ) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) = ( a i − 1 ) [ (cid:80) D 1 , D 0 ( Π x k ∈ D 1 φ k ( x k ) Π x k ∈ D 0 f k ( x k ) − Π x k ∈ D 1 f k ( x k ) Π x k ∈ D 0 φ k ( x k ) ) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) . We now write φ k = f k ( 1 + ξ k ) where ξ k depends only on x 1 , . . . , x k ( but we omit the dependence ) and ξ k = O ( S − 2 wτ ) from the deﬁnition of f . Furthermore , denote δ k = 0 if k = a i or k = a i − 1 and δ k = 1 otherwise . These steps yield ∆ i = ( a i − 1 ) [ (cid:80) D 1 , D 0 ( Π x k ∈ D 1 f k ( x k ) ( 1 + ξ k δ k ) Π x k ∈ D 0 f k ( x k ) − Π x k ∈ D 1 f k ( x k ) Π x k ∈ D 0 f k ( x k ) ( 1 + ξ k δ k ) ) + (cid:15) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) ( 18 ) where (cid:15) is the compensatory term for zeroing out certain terms by inserting the δ k into equation ( 18 ) , which we can express as (cid:15) = (cid:15) 1 + (cid:15) 2 − (cid:15) 3 − (cid:15) 4 for (cid:15) 1 = (cid:88) D 1 ξ a i f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 Π x k ∈ D 0 f k ( x k ) , ( 19 ) (cid:15) 2 = (cid:88) D 1 ξ a i − 1 f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 Π x k ∈ D 0 f k ( x k ) , ( 20 ) (cid:15) 3 = (cid:88) D 1 Π x k ∈ D 1 f k ( x k ) (cid:88) D 0 ξ a i − 1 f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) , ( 21 ) (cid:15) 4 = (cid:88) D 1 Π x k ∈ D 1 f k ( x k ) (cid:88) D 0 ξ a i f a i ( x a i ) Π k (cid:54) = a i f k ( x k ) ( 1 + ξ k ) . ( 22 ) Now , for k = a i or k = a i − 1 , f k ( x k ) ( 1 + ξ k δ k ) = f k ( x k ) by deﬁnition . Factoring f k ( x k ) out for those choices of x k in both D 0 and D 1 , applying a version of the mean value theorem and using the fact that ξ k only depends on x 1 , . . . , x k enables us to integrate out the last two variables of D 0 and D 1 . Since the ﬁrst 13 a i − 2 indices are distinct in each element of both D 0 and D 1 , if we deﬁne D ∗ as the set of sets of a i − 2 distinct indices , then the expression for ∆ i can now be written as ∆ i = ( a i − 1 ) [ λ { (cid:80) D ∗ , D ∗ ( Π x k ∈ D ∗ f k ( x k ) ( 1 + ξ k ) Π x k ∈ D ∗ f k ( x k ) − Π x k ∈ D ∗ f k ( x k ) Π x k ∈ D ∗ f k ( x k ) ( 1 + ξ k ) ) } + (cid:15) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) = ( a i − 1 ) [ (cid:15) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) where λ is the constant from the application of the mean value theorem . To bound ∆ i , we use the crude approximation that for k = a i − 1 , a i , both f k ( x k , b ) = b xk b uk ( 1 + O ( S − 2 τ ) ) and φ k ( x k ) = b xk b uk ( 1 + O ( S − 2 τ ) ) , and we multiply the numerator and denominator of ∆ i by ( Π a i k = a i − 1 b u k ) 2 . From equation ( 19 ) , we have that ( a i − 1 ) ( Π a i k = a i − 1 b u k ) 2 (cid:15) 1 ≤ ( a i − 1 ) (cid:88) D 1 ( Π a i k = a i − 1 b u k ) ξ a i f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 ( Π a i k = a i − 1 b u k ) Π x k ∈ D 0 f k ( x k ) . Note that ξ a i = O ( S − 2 wτ ) and a i ≤ d max . Moreover , using the relationship that (cid:80) Nm = 1 b u k φ k ( x m , b ) = S ( 1 + O ( S − 2 τ ) ) to integrate out the last two variables x a i − 1 and x a i from D 0 , we can obtain the bound (cid:88) D 0 ( Π a i k = a i − 1 b u k ) Π a i x k ∈ D 0 f k ( x k ) ≤ (cid:88) D 0 ∗ ( S + O ( S 1 − 2 τ ) ) 2 Π x k ∈ D 0 ∗ f k ( x k ) . Hence , ( a i − 1 ) ( Π a i k = a i − 1 b u k ) 2 (cid:15) 1 ≤ d max O ( S − 2 wτ ) (cid:88) D 1 ( Π a i k = a i − 1 b u k ) f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 ∗ ( S + O ( S 1 − 2 τ ) ) 2 Π x k ∈ D 0 ∗ f k ( x k ) . Similarly , we conclude that ( a i − 1 ) ( Π a i k = a i − 1 b u k ) 2 (cid:15) 1 ≤ O ( S − 2 wτ ) d 2 max [ S + O ( S 1 − 2 τ ) ] 3 (cid:88) D 1 ∗ Π x k ∈ D 1 ∗ f k ( x k ) (cid:88) D 0 ∗ Π x k ∈ D 0 ∗ f k ( x k ) by replacing the summation over D 1 with a summation over D 1 ∗ , again integrating out the last two variables x a i − 1 and x a i from D 1 using b u k φ k ( x m , b ) = b x m ( 1 + O ( S − 2 τ ) ) . Repeating this argument for all (cid:15) i i = 2 , 3 , 4 , we obtain that ( a i − 1 ) ( Π a i k = a i − 1 b u k ) 2 (cid:15) ≤ 4 d 2 max ( S + O ( S 1 − 2 τ ) ) 3 O ( S − 2 wτ ) (cid:88) D 1 ∗ Π x k ∈ D 1 ∗ f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 ∗ Π x k ∈ D 0 ∗ f k ( x k ) . Similarly , ( Π k = a i − 1 , a i b u k ) 2 (cid:88) D 0 Π a i k = 1 φ k ( x k ) (cid:88) D 0 Π a i k = 1 f k ( x k ) ≥ ( S − O ( S 1 − 2 τ ) ) 4 (cid:88) D 1 ∗ Π x k ∈ D 1 ∗ f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 ∗ Π x k ∈ D 0 ∗ f k ( x k ) . Simplifying , using the fact that d max = O ( S 12 − τ ) , we obtain ∆ i = ( a i − 1 ) ( Π a i k = a i − 1 b u k ) 2 (cid:15) ( Π k = a i − 1 , a i b u k ) 2 (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) = O ( S − 2 ( w + 1 ) τ ) . Therefore , we conclude that g as deﬁned in the theorem statement can be approximated as g ( e i , e j , d , a ) = (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) ( 1 + O ( S − 2 ( w + 1 ) τ ) ) , even though our approximation for f is f ( e i , e j , d , x ) = (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) ( 1 + O ( S − 2 wτ ) ) . 14 We have nearly completed the proof . We argued above that the choice of u k should not have any impact in evaluating expressions such as ( a i − 1 ) (cid:88) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u k , ( a − a i e i , b − k − 1 (cid:88) j = 1 e x j − a i − k (cid:88) j = 1 e u j ) , b ) = (cid:88) x ∈ X 1 i (cid:107) G x (cid:107) (cid:107) G u (cid:107) By our assumptions on f , the dependence on the degree sequence is ignored ( i . e . , represents a higher order term ) unless one of the u a i − m + 1 equals one of the x k ’s . ( That is , when we evaluate Π k f ( e x k , e u ai − k + 1 , ( a − a i e i , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) the out - degree of node x k may be b x k − 1 and not b x k . ) If this is the case , then consider the product f ( e x k , e u ai − k + 1 , b − k − 1 (cid:88) j = 1 e x j − a i − k (cid:88) j = 1 e u j ) f ( e x m , e u ai − m + 1 , b − m − 1 (cid:88) j = 1 e x j − a i − m (cid:88) j = 1 e u j ) ( 23 ) where we omitted the dependence on the in - degree sequence and the last argument b . Now when evaluating f ( e x k , e u ai − k + 1 , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , the degree of the x k is b x k − 1 if and only if a i − m + 1 ≤ a i − k , so in both terms of the product the out - degree of node x k is b x k − 1 . We will now invoke assumption ( 13 ) . We will condense notation a bit : in the function h , if d = ( a , b ) and σ selects the in - degree ( out - degree ) sequence , then we write h ( e i , a ) ( h ( e i , b ) ) . We can thus write ( 23 ) as (cid:32) h ( x k , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) h ( u a i − k + 1 , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) (cid:33) (cid:32) h ( x m , b − (cid:80) m − 1 j = 1 e x j − (cid:80) a i − m j = 1 e u j ) h ( u a i − m + 1 , b − (cid:80) m − 1 j = 1 e x j − (cid:80) a i − m j = 1 e u j ) (cid:33) . But since x k = u a i − m + 1 , h ( x k , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) h ( u a i − m + 1 , b − (cid:80) m − 1 j = 1 e x j − (cid:80) a i − m j = 1 e u j ) = ( 1 + O ( S − 2 wτ ) ) = h ( x k , z 1 ) h ( u a i − m + 1 , z 2 ) ( 1 + O ( S − 2 wτ ) ) for any arbitrary vectors z 1 , z 2 that satisfy assumption ( 13 ) , as x k = u a i − m + 1 . In particular , we can choose z 1 , z 2 such that the out - degree of node x k is b x k and not b x k − 1 , hence the dependence on the degree sequence can be ignored as initially claimed . Even with the many assumptions in the statement of Theorem 3 , we still do not have our asymptotic enumeration result for counting the number of graphs realizing a given bidegree sequence . The issue is that we would need to evaluate products of approximations Π a i i = 1 f ( x i ) ( 1 + O ( S − 2 wτ ) ) where a i = O ( S 12 − τ ) , which diverges as S → ∞ . To avoid this problem , we note that Theorem 3 does give us a way to shrink the error term in the product , decreasing the power of S by 1 in each step . Thus , by repeatedly applying Theorem 3 , we can obtain a product of the form Π a i i = 1 f ( x i ) ( 1 + O ( S − 12 ) ) , which does not yield divergence in the limit . To harness this strategy , we use a result that is analogous to Theorem 3 but starts with an approximation of O ( S − 12 − wτ ) . For this additional result , stated in Theorem 4 , we no longer need the full assumptions made in Theorem 3 , since starting from an improved approximation means that certain terms must stay bounded . Theorem 4 . Consider an approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = f ( e i , e j , d , σ ) ( 1 + O ( S − 12 − wτ ) ) for some w > 0 . Furthermore suppose that for m = O ( S 12 − τ ) , f ( e i , e j , d 0 , σ ) = f ( e i , e j , d 1 , σ ) + z ( e i , e j , d 0 − d 1 , d 0 , σ ) where (cid:107) d 1 − d 0 (cid:107) 1 ≤ m and z ( e i , e j , d 0 − d 1 , d 0 , σ ) ≤ O ( S − 12 − τ ) f ( e i , e j , d 0 , σ ) . If σ = a , then we can construct a sharper approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = g ( e i , e j , d , a ) ( 1 + O ( S − 12 − ( w + 2 ) τ ) ) 15 where g ( e i , e j , d , a ) = a i a j exp ( log ( 1 + ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xai − 1 = xai Π aik = 1 f ( e xk , e uk , ( a − a i e i , ( b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xai − 1 (cid:54) = xai Π aik = 1 f ( e xk , e uk , ( a − a i e i , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) ) − log ( 1 + ( a j − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xaj − 1 = xaj Π ajk = 1 f ( e xk , e uk , ( a − a j e j , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xaj − 1 (cid:54) = xaj Π ajk = 1 f ( e xk , e uk , ( a − a j e j , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) ) ) for an arbitrary choice of u k . A similar result holds , with g depending on b , if σ = b . The proof is very similar to the prior theorem so we leave the details to Appendix C . So in order to construct asymptotics for the ratio of the number of graphs of two slightly diﬀerent degree sequences , starting with our approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j ( 1 + O ( S − 2 τ ) ) , we apply Theorem 3 , obtaining stronger approximations until we reach an approximation with a multiplicative error of ( 1 + O ( S − 12 ) ) from the solution . We can then apply Theorem 4 to construct approximations that are arbitrarily accurate . As mentioned before , this argument requires that the additional assumptions of Theorem 3 are true , which we will prove in Section 6 . We now provide a general method for constructing asymptotics for (cid:107) G d (cid:107) from asymptotics for (cid:107) G d (cid:107) / (cid:107) G d ∗ (cid:107) . We start our derivation , as we did in Section 2 , by considering a special case where it is particularly easy to count the number of graphs that realize a speciﬁed degree sequence . Corollary 6 . Consider the degree sequence ( a , b ) ∈ Z N × 2 where 1 appears exactly S times in b and 0 appears exactly N − S times in b . Then (cid:107) G ( a , b ) (cid:107) = S ! Π Ni = 1 a i ! Proof . The result follows immediately from Lemma 1 where q = 0 and k = N . Theorem 5 . Deﬁne a function ρ : N → N such that b = (cid:80) Sk = 1 e ρ ( k ) . Suppose that for each i ∈ { 1 , . . . , S } , the following approximation holds : (cid:107) G ( a , (cid:80) S − i k = 1 e k + (cid:80) ik = 1 e ρ ( k ) ) (cid:107) (cid:107) G ( a , (cid:80) S − i + 1 k = 1 e k + (cid:80) i − 1 k = 1 e ρ ( k ) ) (cid:107) ( 1 + O ( S − 1 − (cid:15) ) ) = f ( i ) ( 24 ) for some (cid:15) > 0 . Then (cid:107) G d (cid:107) = ( 1 + O ( S − (cid:15) ) ) S ! Π Ni = 1 a i ! Π Si = 1 f ( i ) . Proof . For simplicity , we ﬁrst suppose that S ≤ N . Write 1 S = (cid:80) Sk = 1 e k where e k is the kth standard unit vector . From Corollary 6 , (cid:107) G ( a , 1 S ) (cid:107) = S ! Π Ni = 1 a i ! . ( 25 ) Consequently , (cid:107) G d (cid:107) = (cid:107) G ( a , 1 S ) (cid:107) Π Si = 1 (cid:107) G ( a , (cid:80) S − i k = 1 e k + (cid:80) ik = 1 e ρ ( k ) ) (cid:107) (cid:107) G ( a , (cid:80) S − i + 1 k = 1 e k + (cid:80) i − 1 k = 1 e ρ ( k ) ) (cid:107) . ( 26 ) But by assumption ( 24 ) and equation ( 25 ) , we have that (cid:107) G ( a , 1 S ) (cid:107) Π Si = 1 (cid:107) G ( a , (cid:80) S − i k = 1 e k + (cid:80) i k = 1 e ρ ( k ) ) (cid:107) (cid:107) G ( a , (cid:80) S − i + 1 k = 1 e k + (cid:80) i − 1 k = 1 e ρ ( k ) ) (cid:107) = S ! Π Ni = 1 a i ! Π Si = 1 f ( i ) ( 1 + O ( S − 1 − (cid:15) ) ) = ( 1 + O ( S − (cid:15) ) ) S ! Π Ni = 1 a i ! Π Si = 1 f ( i ) . ( 27 ) Finally , in the event that S > N , we extend d ∈ Z N × 2 to a bidegree sequence d ∗ ∈ Z S × 2 by appending zeros to d . The proof then proceeds analogously . In the following section we will apply Theorems 3 , 4 and 5 to construct asymptotics for the number of graphs of a given degree sequence . The cases worked out in the following section will not only provide extra intution about the veracity of the assumptions of Theorem 3 , but will also lay the groundwork for the rigorous proof that the assumptions are indeed true . 16 5 Higher Order Approximations We start with a technical lemma that will help us evaluate summations of the form (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) where the notation (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r tells us that for each i ∈ { 1 , 2 , . . , r } , we take x i ∈ { 1 , 2 , . . . , N } and we are summing over all (cid:0) Nr (cid:1) choices of r distinct elements in { 1 , 2 , . . . , N } . Lemma 2 . Suppose that f : N → [ 0 , ∞ ) , (cid:80) Ni = 1 f ( i ) = S , max f ( · ) = O ( S 12 − τ ) , and that x 1 , . . . , x r is a sequence of natural numbers with r = O ( S 12 − τ ) . Let k be a ﬁxed ( i . e . , O ( 1 ) ) natural number and deﬁne ξ = N (cid:88) x 1 , . . , x k , x k + 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . Then N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = ξ ( 1 + O ( S − 2 τ ) ) . Proof . We proceed by induction on k . Start with k = 1 . So N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = N (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 1 ) N (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x 2 ) . ( 28 ) But the bounds on r and max f ( · ) imply that ( r − 1 ) N (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) ≤ O ( S 1 − 2 τ ) N (cid:88) x 2 (cid:54) = . . . (cid:54) = x r Π ri = 2 f ( x i ) , ( 29 ) while N (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) ≥ O ( S ) N (cid:88) x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . ( 30 ) Using ( 29 ) and ( 30 ) to express the right hand side of ( 28 ) in terms of ξ yields the desired result for k = 1 . Now assume that the lemma is true when k = m and consider the case k = m + 1 . We have N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = N (cid:88) x 1 , . . , x m , x m + 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 2 τ ) = N (cid:88) x 1 , . . , x m , x m + 1 , x m + 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 2 τ ) − ( r − m − 1 ) N (cid:88) x 1 , . . . , x m , x m + 1 = x m + 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . By applying the estimates ( 29 ) , ( 30 ) , it follows as before that ( r − m − 1 ) N (cid:88) x 1 , . . . , x m , x m + 1 = x m + 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = O ( S − 2 τ ) , and the proof is complete . 17 Corollary 7 . With the notation of Lemma 2 , let k > m > 1 be ﬁxed natural numbers , let f , g : N → [ 0 , ∞ ) with g ( · ) ≤ f ( · ) , (cid:80) Ni = 1 f ( i ) = S , and max f ( · ) = O ( S 12 − τ ) , and let r = O ( S 12 − τ ) . Deﬁne ζ = N (cid:88) x 1 = . . . = x m , x m + 1 , . . . , x k , x k + 1 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) . Then N (cid:88) x 1 = . . . = x m (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) = ζ ( 1 + O ( S − 2 τ ) ) . Proof . The proof is identical to that of Lemma 2 . For use in later proofs , it is worth noting that while the error terms in Lemma 2 ( and analogously in Corollary 7 ) are expressed as O ( S − 2 τ ) N (cid:88) x 1 , . . , x k , x k + 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) , they can also be stated in terms of O ( S − 2 τ ) (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) since asymptotically ( as the above results imply ) , N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) ≈ N (cid:88) x 1 , . . , x k , x k + 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . With Lemma 2 and Corollary 7 at our disposal , we can now derive the ﬁrst order approximation of our power series with relative ease , but ﬁrst we introduce some additional notation . Deﬁnition 3 . Given a bidegree sequence d = ( a , b ) ∈ Z N × 2 , we denote α k : = (cid:80) Ni = 1 a ki and β k : = (cid:80) Ni = 1 b ki . Theorem 6 . If max i max ( a i , b i ) = O ( S 12 − τ ) for τ > 0 , then (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j e ( a i − a j ) (cid:15) + O ( S − 4 τ ) where , (cid:15) = ( β 2 − β 1 ) / β 21 and ( a i − a j ) (cid:15) = O ( S − 2 τ ) . Proof . We start with the approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = f ( e i , e j , d , a ) ( 1 + O ( S − 2 τ ) ) for f ( e i , e j , d , a ) = a i / a j . We can apply Theorem 3 , since our approximation depends only on the degrees of the nodes i and j and we can decompose our approximation , f ( e i , e j , d , a ) = h ( e i , d , a ) / h ( e j , d , a ) , where h ( e i , d , a ) = a i ; below , we shall also use f ( e i , e j , d , b ) = h ( e i , d , b ) / h ( e j , d , b ) , where h ( e i , d , b ) = b i For the remainder of the proof , we omit the dependence on d in our notation . From the conclusion of Theorem 3 , we need to evaluate δ i : = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u k , b k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , e u k , b k ) and the analogously deﬁned δ j , where b k = b − a i − k + 1 (cid:88) j = 1 e u j − k − 1 (cid:88) j = 1 e x j 18 denotes the out - degree of the sequence d k , i , j , as in the statement of Theorem 3 . Now , multiplying our numerator and denominator by Π a i k = 1 b u k removes the dependence of f on e u k , as f ( e x k , e u k , b k ) = b x k / b u k except for when x a i − 1 = x a i and k = a i , in which case f ( e x ai , e u ai , b a i ) = ( b x ai − 1 ) / b u ai , since we have already subtracted an outgoing edge from the node b x ai − 1 , reducing its out - degree by 1 . By Corollary 7 , with g = f ( e x ai , e u ai , b a i ) and a relabeling of indices such that the case where x a i − 1 = x a i becomes the case where x 1 = x 2 , we have δ i = ( a i − 1 ) (cid:80) x 1 = x 2 , x 3 (cid:54) = . . . (cid:54) = x ai Π a i k = 1 f ( e x k , b k ) (cid:80) x 1 , x 2 , x 3 (cid:54) = . . . (cid:54) = x ai Π a i k = 1 f ( e x k , b k ) ( 1 + O ( S − 4 τ ) ) . Factoring out (cid:80) x 3 (cid:54) = . . . (cid:54) = x ai Π a i k = 1 f ( e x k , b ) yields the following simpliﬁcation : δ i = ( a i − 1 ) (cid:80) x 1 = x 2 Π f ( e x k , b k ) (cid:80) x 1 , x 2 Π f ( e x k , b k ) ( 1 + O ( S − 4 τ ) ) = ( a i − 1 ) ( β 2 − β 1 ) β 21 ( 1 + O ( S − 4 τ ) ) . where the last equality above follows from the fact that in the numerator where x 1 = x 2 , f ( e x 1 , b 1 ) ∗ f ( e x 2 , b 2 ) = f ( e x 1 , b 1 ) ∗ f ( e x 1 , b 2 ) = b x 1 ( b x 1 − 1 ) = b 2 x 1 − b x 1 . Summing over all choices for x 1 yields the expression β 2 − β 1 . We conclude that log ( 1 + δ i ) = log ( 1 + ( a i − 1 ) [ β 2 − β 1 ] β 21 ) + O ( S − 4 τ ) and analogously log ( 1 + δ j ) = log ( 1 + ( a j − 1 ) [ β 2 − β 1 ] β 21 ) + O ( S − 4 τ ) . Hence from Theorem 3 we know that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp [ log ( 1 + ( a i − 1 ) [ β 2 − β 1 ] β 21 ) − log ( 1 + ( a j − 1 ) [ β 2 − β 1 ] β 21 ) + O ( S − 4 τ ) ] where writing the logarithms as a Taylor series yields (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp [ ( a i − a j ) ( β 2 − β 1 ) β 21 + O ( S − 4 τ ) ] . Finally , note that ( a i − a j ) β 2 − β 1 β 21 ≤ d max β 2 β 21 ≤ d 2 max β 1 β 21 = d 2 max β 1 = O ( S − 2 τ ) We can also prove the following statement with relative ease . Theorem 7 . Using the notation from Deﬁnition 3 ( with α 1 = S ) , if max i max ( a i , b i ) = O ( S 14 − (cid:15) ) for (cid:15) > 0 , then (cid:107) G d (cid:107) = [ 1 + O ( S − 4 (cid:15) ) ] S ! Π Ni = 1 a i ! b i ! exp ( − ( α 2 − α 1 ) ( β 2 − β 1 ) 2 S 2 ) . Proof . We know from Theorem 6 that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j e ( a i − a j ) (cid:15) + O ( S − 4 τ ) where (cid:15) = ( β 2 − β 1 ) / β 21 , ( a i − a j ) (cid:15) = O ( S − 2 τ ) when d max = O ( S 12 − τ ) for τ ∈ ( 0 , 1 / 2 ) . If , in fact , d max = max i max ( a i , b i ) = O ( S 14 − (cid:15) ) , then we have that τ = 14 + (cid:15) and consequently O ( S − 4 τ ) = O ( S − 1 − 4 (cid:15) ) . By Theorem 5 and the deﬁnition of ρ given in the theorem statement , we know that (cid:107) G d (cid:107) = S ! Π Ni = 1 a i ! Π Si = 1 f ( i ) ( 1 + O ( S − 4 (cid:15) ) ) where by equation ( 24 ) we can approximate f ( i ) = (cid:107) G ( a , (cid:80) S − i k = 1 e k + (cid:80) ik = 1 e ρ ( k ) ) (cid:107) (cid:107) G ( a , (cid:80) S − i + 1 k = 1 e k + (cid:80) i − 1 k = 1 e ρ ( k ) ) (cid:107) ( 1 + O ( S − 1 − 4 (cid:15) ) ) . Now , we will proceed with a sequence of unit out - degree switches that transform an out - degree sequence consisting entirely of 1’s to the out - degree sequence of d , namely b . Without loss of generality , suppose that 19 the ﬁrst node in b has out - degree b 1 , such that there are b 1 − 1 switches required , and that ρ ( 1 ) = · · · = ρ ( b 1 − 1 ) = 1 , which means that all of the switches will be applied to the ﬁrst node , taking it from out - degree 1 to out - degree b 1 . Then it follows from Theorem 6 that f ( 1 ) = 12 exp ( ( α 2 − α 1 ) ( 1 − 2 ) / S 2 ) , since the ﬁrst switch changes the out - degree of the ﬁrst node from 1 to 2 . Similarly , it follows that f ( 2 ) = 13 exp ( ( α 2 − α 1 ) ( 1 − 3 ) / S 2 ) and , more generally for k ≤ b 1 − 1 , f ( k ) = 1 k + 1 exp ( ( α 2 − α 1 ) ( 1 − [ k + 1 ] ) / S 2 ) = 1 k + 1 exp ( ( α 2 − α 1 ) ( − k ) / S 2 ) . Hence Π b i − 1 k = 1 f ( k ) = Π b i − 1 k = 1 1 k + 1 exp ( ( α 2 − α 1 ) ( − k ) / S 2 ) = exp ( ( α 2 − α 1 ) (cid:80) b 1 − 1 k = 1 ( − k ) / S 2 ) b 1 ! = exp ( − ( α 2 − α 1 ) ( b 21 − b 1 ) 2 S 2 ) b 1 ! . Repeating this argument for all of the nodes in the degree sequence yields the result , (cid:107) G d (cid:107) = ( 1 + O ( S − 4 (cid:15) ) ) S ! Π Ni = 1 a i ! Π Si = 1 f ( i ) = ( 1 + O ( S − 4 (cid:15) ) ) S ! Π Ni = 1 a i ! b i ! exp ( − ( α 2 − α 1 ) ( β 2 − β 1 ) 2 S 2 ) . We now explain the intuition behind some generalizations of Lemma 2 that we need to achieve higher order approximations . Note that in Theorem 6 , using Lemma 2 , we performed an approximation of the form (cid:80) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) (cid:80) x 1 (cid:54) = x 2 (cid:54) = . . . (cid:54) = x r Π r n = 1 f ( x n ) ≈ (cid:80) x 1 = x 2 Π 2 n = 1 f ( x n ) (cid:80) x 1 , x 2 Π 2 n = 1 f ( x n ) (cid:34)(cid:80) x 3 (cid:54) = . . . (cid:54) = x r Π rn = 3 f ( x n ) (cid:80) x 3 (cid:54) = . . . (cid:54) = x r Π r n = 3 f ( x n ) (cid:35) = (cid:80) x 1 = x 2 Π 2 n = 1 f ( x n ) (cid:80) x 1 , x 2 Π 2 n = 1 f ( x n ) and we showed that such an approximation yielded an O ( S − 4 τ ) error . More generally , we want to construct approximations of N (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) and N (cid:88) x 1 (cid:54) = x 2 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) For example , to attain a generalization of Lemma 2 , we allow for the possibility ( in the numerator ) that x 1 = x 2 = x 3 , but now we need to separate out three terms as opposed to two to achieve our desired cancellation ; that is , we have (cid:80) x 1 = x 2 = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) (cid:80) x 1 (cid:54) = x 2 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) ≈ (cid:80) x 1 = x 2 = x 3 Π 3 n = 1 f ( x n ) (cid:80) x 1 , x 2 , x 3 Π 3 n = 1 f ( x n ) (cid:34)(cid:80) x 4 (cid:54) = . . . (cid:54) = x r Π rn = 3 f ( x n ) (cid:80) x 4 (cid:54) = . . . (cid:54) = x r Π rn = 3 f ( x n ) (cid:35) . However , once we are computing O ( S − 4 τ ) terms , we also need to consider the case where x 1 = x 2 and x 3 = x 4 , as such terms also turn out to contribute at O ( S − 4 τ ) . To make this idea more rigorous , consider approximating (cid:80) x 1 = x 2 (cid:54) = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) = (cid:80) x 1 = x 2 , x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( r − 2 ) (cid:80) x 1 = x 2 = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) . To obtain a suﬃciently high order estimate for the left hand side , we partition the right hand side into still more terms , motivated by the intuition that terms with more equal signs under a summation should be of higher order ; thus , we consider (cid:88) x 1 = x 2 (cid:54) = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) = (cid:88) x 1 = x 2 , x 3 , x 4 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( r − 3 ) (cid:88) x 1 = x 2 , x 3 = x 4 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − 20 ( r − 2 ) (cid:88) x 1 = x 2 = x 3 , x 4 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) + . . . where we have neglected to write out the ﬁnal terms of still higher order . Now , since we want to keep the case where x 1 = x 2 and x 3 = x 4 , we have to integrate out the x 4 , which yields (cid:88) x 1 = x 2 (cid:54) = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) = (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( r − 3 ) (cid:88) x 1 = x 2 , x 3 = x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( r − 2 ) (cid:88) x 1 = x 2 = x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( r − 4 ) (cid:88) x 1 = x 2 , x 3 , x 4 = x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) + . . . But we can simply relabel indices to observe that (cid:88) x 1 = x 2 , x 3 , x 4 = x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) = (cid:88) x 1 = x 2 , x 3 = x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) + . . . , and we conclude that (cid:80) x 1 = x 2 (cid:54) = x 3 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) = (cid:80) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) − ( 2 r − 7 ) (cid:80) x 1 = x 2 , x 3 = x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π r n = 1 f ( x n ) − ( r − 2 ) (cid:80) x 1 = x 2 = x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π r n = 1 f ( x n ) + . . . So in fact , it suﬃces to factor out four indices . Indeed , the general intuition is that if we are including k equalities in our expansion , then we will need to factor out 2 k indices , to consider the worst case scenario where x 1 = x 2 , x 3 = x 4 , . . . , x 2 k − 1 = x 2 k . But we can then relabel indices to express terms with , say , x 1 = x 2 , x 3 , x 4 = x 5 , . . . , x 2 k = x 2 k + 1 using terms of the form x 1 = x 2 , x 3 = x 4 , . . . , x 2 k − 1 = x 2 k . With these ideas in mind , we now proceed to derive the higher order approximation . We subdivide this task into a few steps , starting with an approximation lemma on sums of the form (cid:80) x 1 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) and sums of the form (cid:80) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π rn = 1 f ( x n ) . Lemma 3 . Let f , g : N → [ 0 , ∞ ) with f ( · ) ≥ g ( · ) , (cid:80) Ni = 1 f ( i ) = S , max f ( · ) = O ( S 12 − τ ) , and r = O ( S 12 − τ ) , r ≥ 4 and deﬁne F = Π 4 i = 1 f ( x i ) , G = g ( x 1 ) Π 4 i = 2 f ( x i ) , ˜ ξ = N (cid:88) x 1 , . . . , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( 4 r − 10 ) N (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) and ˜ ζ = (cid:80) Nx 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) − ( r − 2 ) (cid:80) Nx 1 = x 2 = x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) − ( 2 r − 7 ) (cid:80) Nx 1 = x 2 , x 3 = x 4 , x 5 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) . Then ξ 0 : = N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = ˜ ξ ( 1 + O ( S − 4 τ ) ) ( 31 ) and ζ 0 : = (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) = ˜ ζ ( 1 + O ( S − 4 τ ) ) . ( 32 ) Furthermore , ζ 0 ξ 0 = (cid:80) x 1 = x 2 , x 3 , x 4 G − ( r − 2 ) (cid:80) x 1 = x 2 = x 3 , x 4 G − ( 2 r − 7 ) (cid:80) x 1 = x 2 , x 3 = x 4 G (cid:80) x 1 , . . , x 4 F − ( 4 r − 10 ) (cid:80) x 1 = x 2 , x 3 , x 4 F + O ( S − 12 − 5 τ ) . ( 33 ) 21 Proof . To derive the ﬁrst equality , start by expressing ξ 0 as ξ 0 = N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = N (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 1 ) N (cid:88) x 1 = x 2 (cid:54) = x 3 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . Applying Lemma 2 to the ﬁnal term yields ξ 0 = N (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 1 ) N (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) where the error term comes from O ( S − 2 τ ) ( r − 1 ) N (cid:88) x 1 = x 2 , x 3 , x 4 x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = O ( S − 4 τ ) N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . ( 34 ) We next repeat the same argument and relabel to obtain ξ 0 = (cid:80) Nx 1 , x 2 , x 3 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 1 ) (cid:80) Nx 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 2 ) (cid:80) Nx 1 , x 2 = x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π r i = 1 f ( x i ) + O ( S − 4 τ ) (cid:80) N x 1 (cid:54) = . . . (cid:54) = x r Π r i = 1 f ( x i ) = (cid:80) Nx 1 , x 2 , x 3 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( 2 r − 3 ) (cid:80) Nx 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . ( 35 ) Continuing in this fashion , ξ 0 = N (cid:88) x 1 , x 2 , x 3 , x 4 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( 3 r − 6 ) N (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . The next , ﬁnal step is a bit trickier so we include a little more detail . First , we extract the x 4 out of the ﬁrst summation of the above equation and apply ( 34 ) , which yields ξ 0 = (cid:80) Nx 1 , x 2 , x 3 x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( 3 r − 6 ) (cid:80) Nx 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( r − 4 ) (cid:80) Nx 1 , x 2 , x 3 , x 4 = x 5 , x 6 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . But by another application of ( 34 ) , N (cid:88) x 1 , x 2 , x 3 , x 4 = x 5 , x 6 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) = N (cid:88) x 2 , x 3 , x 4 = x 5 , x 1 (cid:54) = x 6 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) , where by relabeling , the ﬁrst term on the right hand side is the same as N (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) . So we conclude that 22 ξ 0 = N (cid:88) x 1 , x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) − ( 4 r − 10 ) N (cid:88) x 1 = x 2 , x 3 , x 4 , x 5 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) + O ( S − 4 τ ) N (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) , where the sum in the ﬁnal term is itself ξ 0 , such that the ﬁrst part of the Lemma is established . The second part of the Lemma follows analogously , while expression ( 33 ) follows from cancellation of terms . Theorem 8 . Let d max = O ( S 12 − τ ) . Then (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp ( [ a i − a j ] (cid:15) 1 − [ a 2 i − a 2 j ] (cid:15) 2 + O ( S max ( − 6 τ , − 12 − 3 τ ) ) ) where (cid:15) 1 = β 2 + 2 β 3 α 2 / α 21 ( β 1 + β 2 α 2 / α 21 ) 2 and (cid:15) 2 = ( β 2 − β 1 ) 2 2 β 14 + β 3 β 1 − 2 β 22 β 41 . Proof . From Theorem 6 we know that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp ( ( a i − a j ) β 2 − β 1 β 21 = a i exp ( a i β 2 β 21 ) a j exp ( a j β 2 β 21 ) ( 1 + O ( S − 4 τ ) ) . ( 36 ) Note that the middle expression in ( 36 ) satisﬁes the assumption from Theorem 3 that our approximation can be expressed as h ( i , d ) / h ( j , d ) for some function h , and hence we can use Theorem 3 to derive the next step on our expansion . Similarly if we consider a diﬀerent degree sequence such that (cid:107) d 0 − d 1 (cid:107) ∞ = 1 , (cid:107) d 0 (cid:107) 1 = (cid:107) d 1 (cid:107) 1 and (cid:107) d 0 − d 1 (cid:107) 1 = O ( S 12 − τ ) , then we introduce a multiplicative error of ( 1 + O ( S − 6 τ ) ) as a i a j exp ( ( a i − a j ) β 2 − β 1 β 21 only depends on the second moment of the out - degree sequence β 2 . We introduce the notation β 2 ( d ) to explicitly denote the dependence of β 2 on the degree sequence . Consequently , the diﬀerence between | β 2 ( d 1 ) − β 2 ( d 0 ) | = O ( S 1 − 2 τ ) , hence a i a j exp ( ( a i − a j ) β 2 ( d 1 ) β 21 ) a i a j exp ( ( a i − a j ) β 2 ( d 0 ) β 21 ) = exp ( ( a i − a j ) β 2 ( d 1 ) − β 2 ( d 0 ) β 21 ) = exp ( O ( S 12 − τ O ( S 1 − 2 τ ) / O ( S 2 ) ) = exp ( O ( S − 12 − 3 τ ) ) . We now proceed as we did in Theorem 6 . We need to evaluate δ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u k , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , e u k , b ) . We multiply our numerator and denominator by Π a i k = 1 b u k exp ( b u k α 2 α 21 ) , where α 1 , α 2 are the moments of the degree sequence d , we drop the dependence of f on e u k , and we deﬁne f ( e x k , b ) = b x k exp ( b x k α 2 α 21 ) to obtain ( from ( 36 ) δ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , b ) . We can now invoke Lemma 3 to simplify the above summation . Further algebraic simpliﬁcation yields the desired result . 23 To indicate how the estimates that we derive can , in theory , be continued indeﬁnitely , we conclude this section by providing a higher order approximation for a ratio of the numbers of graphs that realize two diﬀerent degree sequences that has an O ( S − 8 τ ) correction . As before , we need a more reﬁned version of Lemma 3 to derive this approximation . We omit the proof , since the same proof technique that derived Lemma 3 yields the proof of Lemma 4 . On the author’s webpage , we provide code that computes ( and proves ) the reﬁned variants of Lemma 3 up to arbitrary order . Lemma 4 . Suppose that g : N → [ 0 , ∞ ) , f : N → [ 1 , ∞ ) with f ( · ) ≥ g ( · ) , that (cid:80) Ni = 1 f ( i ) = S , max f ( · ) = O ( S 12 − τ ) , and that r = O ( S 12 − τ ) , r ≥ 6 . Deﬁne χ = (cid:80) Nx 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) and κ = (cid:80) Nx 1 = x 2 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π ri = 2 f ( x i ) Furthermore , for notational convenience let F = Π 6 i = 1 f ( x i ) and G = g ( x 1 ) Π 6 i = 2 f ( x i ) . Then κ χ = κ 1 χ 1 + O ( S − 12 − 7 τ ) where χ 1 = (cid:88) x 1 , . . , x 6 F − ( 6 r − 21 ) (cid:88) x 1 = x 2 x 3 . . , x 6 F + ( 9 r 2 − 58 r + 69 ) (cid:88) x 1 = x 2 , x 3 = x 4 x 5 , x 6 F + ( 6 r 2 − 48 r + 112 ) (cid:88) x 1 = x 2 = x 3 x 4 . . , x 6 F and κ 1 = (cid:88) x 1 = x 2 , x 3 . . , x 6 G − ( r − 2 ) (cid:88) x 1 = x 2 = x 3 x 4 . . , x 6 G − ( 4 r − 18 ) (cid:88) x 1 = x 2 , x 3 = x 4 x 5 , x 6 G + ( r 2 − 5 r + 6 ) (cid:88) x 1 = x 2 = x 3 = x 4 x 5 , x 6 G + ( 3 r 2 − 21 r + 30 ) (cid:88) x 1 = x 2 = x 3 x 4 = x 5 , x 6 G + ( 4 r 2 − 40 r + 104 ) (cid:88) x 1 = x 2 x 3 = x 4 = x 5 , x 6 G + ( 2 r 2 − 15 r + 21 ) (cid:88) x 1 = x 2 x 3 = x 4 , x 5 = x 6 G . We conclude this section with a statement of the corresponding more reﬁned approximation . Theorem 9 . Let d max = O ( S 12 − τ ) and recall that β k = (cid:80) Nk = 1 b ki . We have (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = a i a j exp ( [ a i − a j ] (cid:15) 1 − [ a 2 i − a 2 j ] (cid:15) 2 + [ a 3 i − a 3 j ] (cid:15) 3 + O ( S max ( − 1 − 2 τ , − 8 τ ) ) ) where we deﬁne (cid:15) 1 = E b [ f ( x ) f ( x − 1 ) ] E b [ f ( x ) ] 2 + E b [ f ( x ) f ( x − 1 ) ] 2 − 5 E b [ f ( x ) 2 ] E b [ f ( x ) f ( x − 1 ) ] + 3 E b [ f ( x ) 2 f ( x − 1 ) ] E b [ f ( x ) ] E b [ f ( x ) ] 4 , (cid:15) 2 = − 2 E b [ f ( x ) 2 ] E b [ f ( x ) f ( x − 1 ) ] + 12 E b [ f ( x ) f ( x − 1 ) ] 2 + E b [ f ( x ) 2 f ( x − 1 ) ] E b [ f ( x ) ] E b [ f ( x ) ] 4 , and (cid:15) 3 = − 1073 β 32 − 112 β 1 β 2 β 3 + β 2 β 4 β 61 for E b [ f ( x ) ] : = (cid:80) x ∈ b f ( x ) f ( x ) = x + x 2 η 1 + x 3 η 21 2 − x 3 η 2 , η 1 : = α 2 + 2 α 3 β 2 / α 21 ( α 1 + α 2 β 2 / α 21 ) 2 , and η 2 : = ( α 2 − α 1 ) 2 2 α 14 + α 3 α 1 − 2 α 22 α 41 . 6 On the Assumptions of Theorem 3 To prove that the assumptions made in Theorem 3 ( and in Theorem 4 ) hold , it is helpful to have results to simplify the analysis of ratios of sums of the form (cid:80) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) that are more general than the results we proved in Section 5 . First , it is helpful to introduce some notation . Deﬁnition 4 . Deﬁne the set of natural numbers I = { 1 , . . . , r } . For any collection A = of disjoint subsets of I , we say that a sequence x ∈ N r satisﬁes A = if for every { i 1 , . . . , i m } ∈ A = , we have x i 1 = x i 2 = . . . = x i m . Given that x satisﬁes A = and that A (cid:54) = is a subset of I , we say that x satisﬁes A (cid:54) = if for all i , j ∈ A (cid:54) = such that i , j are not both contained in any A ∈ A = , we have x i (cid:54) = x j . We denote the set of all x that satisfy both A = and A (cid:54) = by the notation A = ⊗ A (cid:54) = . 24 Before proceeding with the theorem statements that enable us to construct approximations for ratios of sums of the form (cid:80) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) , we wish to motivate some of the notation that we use . To ap - proximate (cid:80) x 1 (cid:54) = . . . (cid:54) = x r Π ri = 1 f ( x i ) , we wish to remove some ( ﬁxed ) number of x (cid:48) i s from the list of required inequalities . For example , we can express (cid:80) x 1 (cid:54) = x 2 f ( x 1 ) f ( x 2 ) = (cid:80) x 1 , x 2 f ( x 1 ) f ( x 2 ) − (cid:80) x 1 = x 2 f ( x 1 ) f ( x 2 ) , where in the ﬁrst term on the right hand side , we no longer have to worry about the ‘does not equal’ rela - tionship of x 1 and x 2 found on the left hand side . To help us identify the dominating terms , we introduce sets of the form A ( i , c ) = ⊗ A ( i , c ) (cid:54) = , where the i denotes the number of equal signs found under the summa - tion and c denotes a particular instance where i of these variables are equal . For example , suppose we want to simplify (cid:80) x 1 (cid:54) = x 2 (cid:54) = x 3 f ( x 1 ) f ( x 2 ) f ( x 3 ) = (cid:80) x 1 , x 2 (cid:54) = x 3 f ( x 1 ) f ( x 2 ) f ( x 3 ) − (cid:80) x 1 = x 2 (cid:54) = x 3 f ( x 1 ) f ( x 2 ) f ( x 3 ) − (cid:80) x 1 = x 3 (cid:54) = x 2 f ( x 1 ) f ( x 2 ) f ( x 3 ) . On the right hand side there are two summations involving one equality under the summation . Hence we can deﬁne A ( 1 , 0 ) = ⊗ A ( 1 , 0 ) (cid:54) = = { { 1 , 2 } } ⊗ { 1 , 2 , 3 } , A ( 1 , 1 ) = ⊗ A ( 1 , 1 ) (cid:54) = = { { 1 , 3 } } ⊗ { 1 , 2 , 3 } representing those two summations . Note that in each of these examples i = 1 , but since there are two possible choices , c can be either 0 or 1 . Now we present two results regarding the sums of interest . Since the proofs of the two theorems are essentially identical , we only prove one of them . Theorem 10 . Suppose that (cid:80) x m f ( x m ) = S and that max f ( x m ) = O ( S 12 − τ ) and r = O ( S 12 − τ ) . Consider (cid:80) x 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) . Fix a natural number k such that 2 k ≤ r ( where 2 k is the number of variables that we remove from the list of inequalities so that they can equal other variables ) . Then for all j ≤ k we can write (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = j (cid:88) i = 0 h ( i , k ) (cid:88) c = 0 p ( i , c ) (cid:88) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = Π rm = 1 f ( x m ) ( 37 ) where for each i , h ( i , k ) + 1 represents a number of arrangements of variables with i variables equal to each other , and h ( 0 , k ) = 0 ; for all i , c , p ( i , c ) is a polynomial in r ; and for all i < j and for all c , A ( i , c ) = consists of a collection of subsets of { 1 , . . . , 2 k } with (cid:80) A ∈ A ( i , c ) = ( | A | − 1 ) = i and A ( i , c ) (cid:54) = = { 2 k + 1 , . . . , r } . In addition , • for all c , (cid:80) A ∈ A ( j , c ) = ( | A | − 1 ) = j , • A ( j , c ) (cid:54) = = { s , s + 1 , . . . , r } for some s ≤ 3 k , and • if A ∈ A ( j , c ) = has a nontrivial intersection with A ( j , c ) (cid:54) = then A = { s , s + 1 , . . . , s + t } for some t such that s + t < r ; moreover , there can only be one such A ∈ A ( j , c ) = that has a nontrivial intersection with A ( j , c ) (cid:54) = . Finally , p ( i , c ) (cid:80) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = Π rm = 1 f ( x m ) (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = O ( S − 2 iτ ) . Theorem 11 . Suppose that (cid:80) x m f ( x m ) = S and that max f ( x m ) = O ( S 12 − τ ) and r = O ( S 12 − τ ) . Consider (cid:80) x 1 = x 2 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π rm = 2 f ( x m ) . For simplicity , we assume that the elements in A = are disjoint . Fix a number k ( where 2 k is the number of variables removed from the list of inequalities ) . Then for all j ≤ k we can write (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π rm = 2 f ( x m ) = j (cid:88) i = 0 h ( i , k ) (cid:88) c = 0 p ( i , c ) (cid:88) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = g ( x 1 ) Π rm = 2 f ( x m ) where for each i , h ( i , k ) + 1 represents a number of arrangements of variables with i variables equal to each other , and h ( 0 , k ) = 0 ; for all i , c , p ( i , c ) is a polynomial in r ; and for all i < j and for all c , A ( i , c ) = consists of a collection of subsets of { 1 , . . . , 2 k } , A ( i , c ) (cid:54) = = { 2 k + 1 , . . . , r } with (cid:80) A ∈ A ( i , c ) = ( | A | − 1 ) = i + 1 . In addition , • for all c , (cid:80) A ∈ A ( j , c ) = ( | A | − 1 ) = j + 1 , • A ( j , c ) (cid:54) = = { s , s + 1 , . . . , r } for some s ≤ 3 k , and • if A ∈ A ( j , c ) = has a nontrivial intersection with A ( j , c ) (cid:54) = then A = { s , s + 1 , . . . , s + t } for some t such that s + t < r ; moreover , there can only be one such A ∈ A ( j , c ) = that has a nontrivial intersection with A ( j , c ) (cid:54) = . 25 Finally , for all i ≤ j , p ( i , c ) (cid:80) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = g ( x 1 ) Π rm = 2 f ( x m ) (cid:80) x 1 = x 2 , x 3 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r g ( x 1 ) Π rm = 2 f ( x m ) = O ( S − 2 iτ ) . Proof of Theorem 10 . We proceed by induction . For the base case of j = 1 , we start by showing that the stated conditions hold in the case of i = j ( such that the bulleted list in the theorem statement applies ) and then we come back to ( i , c ) = ( 0 , 0 ) . We have seen previously that (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) − ( r − 1 ) (cid:88) x 1 = x 2 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) . We denote the set of x over which the ﬁnal summation occurs as A ( 1 , 0 ) = ⊗ A ( 1 , 0 ) (cid:54) = where A ( 1 , 0 ) = = { { 1 , 2 } } , the variables that equal each other , and A ( 1 , 0 ) (cid:54) = = { 1 , 2 , . . . , r } , the variables that are required not to equal some ( at least one ) other variable . The coeﬃcient p ( 1 , 0 ) = − ( r − 1 ) is also a polynomial in r and (cid:80) A ∈ A ( 1 , 0 ) = ( | A | − 1 ) = 1 ( where we use the superscript ( 1 , 0 ) to denote that (cid:80) A ∈ A ( 1 , 0 ) = ( | A | − 1 ) = 1 and the 0 keeps track of this particular instance where (cid:80) A ∈ A = ( | A | − 1 ) = 1 ) . We next repeat this argument for (cid:88) x 1 , x 2 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = (cid:88) x 1 , x 2 , x 3 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) − ( r − 2 ) (cid:88) x 1 , x 2 = x 3 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) and in context to the second summation on the right hand side , deﬁne p ( 1 , 1 ) = − ( r − 2 ) , A ( 1 , 1 ) = = { { 2 , 3 } } , the variables that equal one another , and A ( 1 , 1 ) (cid:54) = = { 2 , 3 , 4 , . . , r } , the variables that are required not to equal some other variable ( where we use the superscript ( 1 , 1 ) to denote that (cid:80) A ∈ A ( 1 , 1 ) = ( | A | − 1 ) = 1 and the 1 keeps track of this new instance where (cid:80) A ∈ A = ( | A | − 1 ) = 1 ) . We stop once we reach (cid:88) x 1 , x 2 , . . , x 2 k (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = (cid:88) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) − ( r − 2 k ) (cid:88) x 1 , . . . , x 2 k = x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) . ( 38 ) Finally , based on the the ﬁrst sum on the right hand side of equation ( 38 ) , we deﬁne p ( 0 , 0 ) = 1 , A ( 0 , 0 ) = = ∅ , as there are no variables that are required to equal one another , A ( 0 , 0 ) (cid:54) = = { 2 k + 1 , . . . , r } , the variables that are required not to equal some other variable , as (cid:80) A ∈ A ( 0 , 0 ) = ( | A | − 1 ) = 0 , and note that only variables with an index of 2 k + 1 or greater are constrained so that they cannot equal one another . Note that in the theorem statement , the number of instances where we have sets of the form A ( 1 , x ) = ⊗ A ( 1 , x ) (cid:54) = is 2 k , but since we start with c = 0 , the maximumum value of c will be 2 k − 1 ( and hence deﬁne h ( 1 , k ) = 2 k − 1 . ) From the above inductive construction , we know that for all c ∈ { 0 , 1 , . . , 2 k − 1 } , | p ( 1 , c ) | ≤ r . ( 39 ) . In addition , since the range of f consists of the non - negative real numbers , we know that for all c , (cid:88) A ( 1 , c ) = ⊗ A ( 1 , c ) (cid:54) = Π f ( x m ) ≤ (cid:88) A ( 1 , 2 k − 1 ) = ⊗ A ( 1 , 2 k − 1 ) (cid:54) = Π f ( x m ) ( 40 ) as the number of variables that are required not to equal some other variable in A ( 1 , 2 k − 1 ) (cid:54) = is smaller than the analogous list for any other instance of A ( 1 , c ) (cid:54) = . Hence by inequalities ( 39 ) and ( 40 ) , we ﬁnd that | (cid:80) 2 k − 1 c = 0 p ( 1 , c ) (cid:80) A ( 1 , c ) = ⊗ A ( 1 , c ) (cid:54) = Π f ( x m ) | (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) ≤ 2 kr (cid:80) A ( 1 , 2 k − 1 ) = ⊗ A ( 1 , 2 k − 1 ) (cid:54) = Π f ( x m ) (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) = 2 kr (cid:80) x 1 , . . . , x 2 k − 1 , x 2 k = x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) = 2 krS 2 k − 1 (cid:80) x 2 k = x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) S 2 k (cid:80) x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) ≤ 26 2 krf ( x max ) (cid:80) x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) S (cid:80) x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π f ( x m ) = 2 krf ( x max ) S = 2 k O ( S 1 − 2 τ ) S = O ( S − 2 τ ) where all products without indices labeled are taken over the set of m values in the index set of the summation that precedes them . Thus , we have attained our desired results for j = 1 . To proceed with induction , we now assume that the inductive statement holds for j = n − 1 and prove that it is true for j = n , provided n ≤ k . The inductive hypothesis when j = n − 1 yields (cid:88) x 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = n − 1 (cid:88) i = 0 h ( i , k ) (cid:88) c = 0 p ( i , c ) (cid:88) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = Π rm = 1 f ( x m ) . To prove that the inductive statement holds for j = n we manipulate the sets of the form A ( n − 1 , c ) = ⊗ A ( n − 1 , c ) (cid:54) = in our inductive hypothesis ( where j = n − 1 ) . From our inductive hypothesis we know that (cid:80) A ∈ A ( n − 1 , c ) = ( | A | − 1 ) = n − 1 ; for some s ≤ 3 k , A ( n − 1 , c ) (cid:54) = = { s , s + 1 , . . . , r } ; and there exists at most one set in A ( n − 1 , c ) = , of the form { s , s + 1 , . . . , s + t } , that has a nontrivial intersection with A ( n − 1 , c ) (cid:54) = . We proceed as in the base case . Case 1 : Suppose that indeed for some s , t , { s , s + 1 , . . . , s + t } ∈ A ( n − 1 , c ) = and A ( n − 1 , c ) (cid:54) = = { s , s + 1 , . . . , r } . By assumption we can write A ( n − 1 , c ) = = A 1 ∪ { s , s + 1 , . . . , s + t } where we deﬁne A 1 to be A ( n − 1 , c ) = − { s , s + 1 , . . . , s + t } . Since x s = x s + 1 = . . . = x s + t , we have the following equality : p ( n − 1 , c ) (cid:88) A ( n − 1 , c ) = ⊗ A ( n − 1 , c ) (cid:54) = Π f ( x m ) = p ( n − 1 , c ) (cid:88) A ( n − 1 , c ) = ⊗ { s + t + 1 , . . . , r } Π f ( x m ) − p ( n − 1 , c ) ( r − s − t ) (cid:88) A 1 ∪ { s , . . . , s + t + 1 } ⊗ { s , . . . , r } Π f ( x m ) . ( 41 ) The last term on the right hand side of ( 41 ) is a sum over an index set with n equalities . Analogous to the proof of the base case , we express this index set as A ( n , c ∗ ) = ⊗ A ( n , c ∗ ) (cid:54) = for some label c ∗ . Of course , the product of the two polynomial coeﬃcients of this term is a polynomial as well , which we can take as p ( n , c ∗ ) . To see how this works , we proceed for each c depending on whether s + t ≤ 2 k or s + t > 2 k . Case 1a : s + t ≤ 2 k Analogous to the proof in the base case , the expression ( 41 ) can be decomposed as (cid:88) A ( n − 1 , c ) = ⊗ { s + t + 1 , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { s + t + 2 , . . . , r } Π f ( x m ) − ( r − s − t − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { s + t + 1 , s + t + 2 } ⊗ { s + t + 1 , . . . , r } Π f ( x m ) . We use the last term to construct A ( n , c ∗ ) = ⊗ A ( n , c ∗ ) (cid:54) = for some c ∗ . ( Note that (cid:80) A ∈ A ( n , c ∗ ) = ( | A | − 1 ) = n ) . We continue this process until we reach (cid:88) A ( n − 1 , c ) = ⊗ { 2 k , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 1 , . . . , r } Π f ( x m ) − ( r − 2 k ) (cid:88) A ( n − 1 , c ) = ∪ { 2 k , 2 k + 1 } ⊗ { 2 k , . . . , r } Π f ( x m ) . ( 42 ) We note that with j = n , the i = n − 1 terms in ( 37 ) may be diﬀerent from the i = n − 1 terms with j = n − 1 . Indeed , based on ( 42 ) , we now redeﬁne ( for j = n ) A ( n − 1 , c ) = ⊗ A ( n − 1 , c ) (cid:54) = = A ( n − 1 , c ) = ⊗ { 2 k + 1 , . . . , r } . Case 1b : s + t > 2 k Now since by the assumption of the inductive hypothesis , (cid:80) A ∈ A ( n − 1 , c ) = ( | A | − 1 ) = n − 1 ≤ k − 1 = ⇒ (cid:80) A ∈ A ( n − 1 , c ) = | A | ≤ 2 k − 2 , there are at least s + t − 2 k + 2 values in { 1 , . . . , s + t } that are not in A for all A ∈ A ( n − 1 , c ) = . We then create a relabeling where all values greater than s + t are left alone ( they map to themselves ) and that the values that are not in A for all A ∈ A ( n − 1 , c ) = include { 2 k + 1 , . . . , s + t } . ( Hence the largest element in all of the sets in A ( n − 1 , c ) = is bounded by 2 k . ) Expression ( 41 ) can be decomposed as 27 (cid:88) A ( n − 1 , c ) = ⊗ { s + t + 1 , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { s + t , . . . , r } Π f ( x m ) + ( r − s − t ) (cid:88) A ( n − 1 , c ) = ∪ { s + t , s + t + 1 } ⊗ { s + t , . . . , r } Π f ( x m ) As in Case 1a , we use the last term to construct A ( n , c ∗ ) = ⊗ A ( n , c ∗ ) (cid:54) = for some c ∗ . We repeat this equality until we attain (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 2 , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 1 , . . . , r } Π f ( x m ) + ( r − 2 k − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { 2 k , 2 k + 1 } ⊗ { 2 k , . . . , r } Π f ( x m ) Case 2 : Suppose that A ( n − 1 , c ) (cid:54) = = { s , s + 1 , . . . , r } and for all t , { s , s + 1 , . . . , s + t } / ∈ A ( n − 1 , c ) = . We again consider two subcases . Case 2a : s ≤ 2 k . To achieve the desired form , we rewrite (cid:88) A ( n − 1 , c ) = ⊗ { s , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { s + 1 , . . . , r } Π f ( x m ) − ( r − s − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { s , s + 1 } ⊗ { s , . . . , r } Π f ( x m ) . We use the last term to construct A ( n , c ∗ ) = ⊗ A ( n , c ∗ ) (cid:54) = for some c ∗ , proceeding inductively until we reach (cid:88) A ( n − 1 , c ) = ⊗ { 2 k , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 1 , . . . , r } Π f ( x m ) − ( r − 2 k − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { 2 k , 2 k + 1 } ⊗ { 2 k , . . . , r } Π f ( x m ) . Case 2b : s > 2 k . If A ( n − 1 , c ) = contains sets with elements that are greater than 2 k , we can again perform a relabeling scheme as in Case 1b such that all of the elements in A ( n − 1 , c ) = are guaranteed to be bounded above by 2 k : (cid:88) A ( n − 1 , c ) = ⊗ { s , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { s − 1 , . . . , r } Π f ( x m ) + ( r − s − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { s − 1 , s } ⊗ { s − 1 , . . . , r } Π f ( x m ) . We use the last term to construct A ( n , c ∗ ) = ⊗ A ( n , c ∗ ) (cid:54) = for some c ∗ and we repeat this equality until we attain (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 2 , . . . , r } Π f ( x m ) = (cid:88) A ( n − 1 , c ) = ⊗ { 2 k + 1 , . . . , r } Π f ( x m ) + ( r − 2 k − 1 ) (cid:88) A ( n − 1 , c ) = ∪ { 2 k , 2 k + 1 } ⊗ { 2 k , . . . , r } Π f ( x m ) . To complete the proof , we need to verify the following properties from our theorem statement : • A ( i , c ) = is a collection of disjoint subsets of { 1 , . . . , 2 k } . This fact follows from the conclusion of each of the cases in the above inductive argument . • (cid:80) A ∈ A ( i , c ) = ( | A | − 1 ) = i . For each A ( i , c ∗ ) = constructed from an A ( i − 1 , c ) = , it is easy to show that (cid:80) A ∈ A ( i − 1 , c ) = ( | A | − 1 ) = i − 1 , and then the inductive step adds two more terms to the sum to yield (cid:80) A ∈ A ( i , c ∗ ) = ( | A | − 1 ) = i . • For i < j , A ( i , c ) (cid:54) = = { 2 k + 1 , . . . , r } . This fact is easily veriﬁed ( and follows trivially ) from the construction through the inductive hypothesis . • A ( j , c ) (cid:54) = = { s , s + 1 , . . . , r } for some s ≤ 3 k . This fact is also easily veriﬁed ( and follows trivially ) from the proof by induction above . 28 • If A ∈ A ( j , c ) = has a nontrivial intersection with A ( j , c ) (cid:54) = then A = { s , s + 1 , . . . , s + t } ; in addition , there can only be one such A ∈ A ( j , c ) = that has a nontrivial intersection with A ( j , c ) (cid:54) = . This fact is also easily veriﬁed ( and follows trivially ) from the proof by induction above . • p ( i , c ) (cid:80) A ( i , c ) = ⊗ A ( i , c ) (cid:54) = Π rm = 1 f ( x m ) (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = O ( S − 2 iτ ) . ( 43 ) The proof for this result is tricky but also follows from the inductive argument . In the inductive hypothesis , assume for all sets A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = and corresponding polynomials p ( i − 1 , c ) that equation ( 43 ) holds . Consider what happens when we construct sets of the form A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = and the corresponding polynomials p ( i , c ∗ ) from A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = . We know from the above inductive proof that p ( i , c ∗ ) ≤ rp ( i − 1 , c ) . Furthermore , there is an additional equal sign under the summation with the index set A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = . Suppose that x m is a variable that does not appear in A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = but does appear in A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = . We bound the contribution of f ( x m ) in A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = by d max = O ( S 12 − τ ) . That is , p ( i , c ∗ ) (cid:80) A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = Π f ( x k ) p ( i − 1 , c ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π f ( x k ) ≤ d max r (cid:80) A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = Π k (cid:54) = m f ( x k ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π f ( x k ) . ( 44 ) Now that f ( x m ) has been ‘taken out’ , we can construct a crude lower bound on the contribution of f ( x m ) in A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = , given the hypothesis that (cid:80) x m f ( x m ) = O ( S ) . So we have from the inequality ( 44 ) that p ( i , c ∗ ) (cid:80) A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = Π f ( x k ) p ( i − 1 , c ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π f ( x k ) ≤ O ( S 1 − 2 τ ) (cid:80) A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = Π k (cid:54) = m f ( x k ) O ( S ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π k (cid:54) = m f ( x k ) . ( 45 ) But now that x m has been eﬀectively removed , the summations over A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = and A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = are identical and we conclude from the right hand side of ( 45 ) that p ( i , c ∗ ) (cid:80) A ( i , c ∗ ) = ⊗ A ( i , c ∗ ) (cid:54) = Π k (cid:54) = m f ( x k ) p ( i − 1 , c ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π k (cid:54) = m f ( x k ) ≤ O ( S − 2 τ ) ( 46 ) Invoking the inductive hypothesis that p ( i − 1 , c ) (cid:80) A ( i − 1 , c ) = ⊗ A ( i − 1 , c ) (cid:54) = Π rm = 1 f ( x m ) (cid:80) x 1 , . . . , x 2 k , x 2 k + 1 (cid:54) = . . . (cid:54) = x r Π rm = 1 f ( x m ) = O ( S − 2 ( i − 1 ) τ ) , ( 47 ) and combining this with inequalities ( 45 ) , ( 46 ) completes the proof . We now prove the desired result that validates the assumptions in Theorems 3 and 4 that enable us to extend our enumeration estimate to arbitrary order . But before doing so , we would like to remind the reader that throughout this work we have been expressing our approximation f of φ such that f = φ ∗ ( 1 + O ( S − 2 kτ ) ) . This statement implies that f − φ = φO ( S − 2 kτ ) But since we know by Corollary 3 that φ ( x i , x j , d , a ) = a i a j ( 1 + O ( S − 2 τ ) ) , it follows that f − φ = a i a j O ( S − 2 kτ ) . In the theorem that follows we often interchange f = φ ( 1 + O ( S − 2 kτ ) . f − φ = φO ( S − 2 kτ ) and f − φ = a i a j O ( S − 2 kτ ) . 29 Theorem 12 . Given an approximation f of φ ( the true value for the ratio of the number of graphs that realize two slightly diﬀerent degree sequences ) such that | f ( x i , x j , d ) − φ ( x i , x j , d ) | = a i a j O ( S − 2 kτ ) for some k < 14 τ + 1 , f ( x i , x j , d , a ) = h ( x i , d , a ) h ( x j , d , a ) ( 48 ) where h ( x i , d , a ) = a i ( 1 + r (cid:88) v = 1 γ v a k v i Π sq = 1 β m ( v , q ) q α n ( v , q ) q α z 1 ) ( 49 ) for some constants γ v , where r , s , z are ﬁnite and each term in the summations in the numerator and denom - inator in ( 48 ) is O ( S − 2 τ ) . Furthermore if (cid:107) d 1 − d 2 (cid:107) ∞ ≤ 1 and (cid:107) d 1 − d 2 (cid:107) 1 = O ( S 12 − τ ) , assuming the degrees of node x i are identical in d 1 and d 2 , then | h ( x i , d 1 ) − h ( x i , d 2 ) | = a i ( O ( S − 12 − 3 τ ) ) . Proof . We prove the result by induction . The base case holds trivially when k = 1 as by Corollary 4 , f ( x i , x j , d ) = a i / a j and it also follows trivially that diﬀerences in the degree sequence aside from the degrees of nodes x i or x j do not aﬀect f ( x i , x j , d ) . Similarly , equation ( 48 ) holds with r = 1 and γ 1 = 0 in the expression ( 49 ) for both the numerator and denominator of ( 48 ) . So we proceed to the inductive step . Given our inductive hypothesis where we have an approximation f where the dependence on the de - gree sequence in f is suﬃciently weak O ( S − 12 − τ ) and can be dropped as | f ( x i , x j , d ) − φ ( x i , x j , d ) | = a i a j ( O ( S − 2 ( k − 1 ) τ ) ) since 2 ( k − 1 ) τ < 12 + 2 τ , we want to show that the sharper approximation produced by Theorem 3 also has the same property . By applying Theorem 3 , we get a stronger approximation ( which we also denote by f ) which is of the form a i a j exp ( log ( 1 + (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) ) ) exp ( − log ( 1 + (cid:107) G X 1 j (cid:107) (cid:107) G X 0 j (cid:107) ) ) . From equations ( 14 ) - ( 16 ) in Theorem 3 , we have (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π f ( x i , m i , d , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai Π f ( x i , m i , d , b ) where the choice of m i is arbitrary . By the inductive hypothesis ( 48 ) , we can drop the dependence on m i by multiplying the numerator and denominator by Π a i i = 1 b m i ( 1 + (cid:80) rv = 1 γ v b kvmi Π sq = 1 β m ( v , q ) q α n ( v , q ) q α z 1 ) ; that is , we have (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π f ( x i , d , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai Π f ( x i , d , b ) where f ( x i , d , b ) = b i ( 1 + r (cid:88) v = 1 γ v b k v i Π sq = 1 β m ( v , q ) q α n ( v , q ) q α z 1 ) . ( 50 ) For simplicity , we will now drop the explicit dependence on d and b from f . Note that by applying Theorems 10 and 11 to the denominator and numerator respectively we have that (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = ( a i − 1 ) (cid:80) kj = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = ⊗ A ( j , c , 1 ) (cid:54) = Π f ( x i ) (cid:80) kj = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = ⊗ A ( j , c , 0 ) (cid:54) = Π f ( x i ) where the p ’s are polynomials in a i , summations denoted with A ( j , c , x ) = are over a ﬁnite number 2 k of vari - ables . But by Theorems 10 and 11 , we can drop the terms in the numerator and denominator involving p ( k , c , x ) (cid:80) A ( k , c , x ) = ⊗ A ( k , c , x ) (cid:54) = Π f ( x i ) as they only contribute a maximum of O ( S − 2 kτ ) , hence 30 ( a i − 1 ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = ⊗ A ( j , c , 1 ) (cid:54) = Π f ( x i ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = ⊗ A ( j , c , 0 ) (cid:54) = Π f ( x i ) ( 1 + O ( S − 2 kτ ) ) . ( As an abuse of notation , when we write (cid:80) A = , we are summing over all x ∈ N 2 k , but when we consider A = without the sigma , we are specifying which dummy variables must equal one another . ) In addition , by Theorems 10 and 11 , for all j ≤ k − 1 , ∪ A ∈ A ( j , c , x ) = A ∩ A ( j , c , x ) (cid:54) = = ∅ and A ( j , c , x ) (cid:54) = = { 2 k + 1 , . . . , a i } . Hence we can factor out a (cid:80) x 2 k + 1 (cid:54) = . . . (cid:54) = x ai Π a i i = 2 k + 1 f ( x i ) from both the numerator and denominator . This yields (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = ( a i − 1 ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = Π f ( x i ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = Π f ( x i ) + O ( S − 2 kτ ) ) . Recall that f ( x i , d , b ) = b i ( 1 + (cid:80) rv = 1 γ v b kvi Π sq = 1 β m ( v , q ) q α n ( v , q ) q α z 1 ) where each of the ﬁnitely many terms in the summation is O ( S − 2 τ ) . Furthermore , note that only A ( 0 , 0 , 0 ) = = ∅ , so let us multiply the numerator and denominator by 1 α 2 k : (cid:107) G X 1 i (cid:107) (cid:107) G X 0 i (cid:107) = ( a i − 1 ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = Π f ( x i ) α 2 k 1 (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = Π f ( x i ) α 2 k 1 + O ( S − 2 kτ ) . ( 51 ) Note that every term in the numerator ( a i − 1 ) p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = Π f ( x i ) α 2 k 1 = O ( S − 2 τ ) and except for j = 0 and c = 0 , p ( j , c , 0 ) ( a i ) (cid:80) A j , c , 0 ) = Π f ( x i ) α 2 k 1 = O ( S − 2 τ ) . And ﬁnally , since A ( 0 , 0 , 0 ) = = ∅ and f ( x i , d , b ) = b i ( 1 + (cid:80) rv = 1 γ v b kvi Π sq = 1 β m ( v , q ) q α n ( v , q ) q α z 1 ) where each term in the summation is O ( S − 2 τ ) and (cid:80) f ( x i ) = S + O ( S 1 − 2 τ ) , we note that (cid:80) A ( 0 , 0 , 0 ) = Π f ( x i ) α 2 k 1 = 1 + O ( S − 2 τ ) as α 1 = S . We now show that the dependence in equation ( 51 ) on the degree sequence is ‘small’ . As noted before , ( a i − 1 ) δ x , 1 p ( j , c , x ) ( a i ) (cid:80) A ( j , c , x ) = Π f ( x i ) α 2 k 1 = δ x , 0 + O ( S − 2 τ ) where δ x , y = 1 if x = y and 0 otherwise and the O ( S − 2 τ ) term is some ﬁnite sum of terms of the form γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 each of which are O ( S − 2 τ ) . The constraint that γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 = O ( S − 2 τ ) holds for all degree sequences such that d max = O ( S 12 − τ ) . Now we consider the perturbation analysis , such that (cid:107) d 1 − d 0 (cid:107) 1 = O ( S 12 − τ ) and (cid:107) d 1 − d 0 (cid:107) ∞ ≤ 1 , then | β j ( d 1 ) − β j ( d 0 ) | = O ( d jmax ) = O ( S j 2 − jτ ) . But also note that max ( α j , β j ) = O ( S 1 + j − 12 − ( j − 1 ) τ ) as β j = (cid:80) i b ji ≤ d j − 1 max (cid:80) i b i = O ( S 1 + j − 12 − ( j − 1 ) τ ) . Now if we measure the impact of considering diﬀerent de - gree sequences d 0 , d 1 on γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 , this results in a O ( S − 12 − τ ) times smaller than γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 . But since γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 = O ( S − 2 τ ) , the contribution in equation ( 51 ) from considering diﬀerent degree sequences is O ( S − 12 − τ − 2 τ ) . Now to verify that our new higher order approximation f ( x i , x j , d , a ) = a i a j   1 + (cid:80) rv = 1 γvakvi Π sq = 1 βm ( v , q ) q αn ( v , q ) q αz 1 1 + (cid:80) r v = 1 γvakv j Π s q = 1 βm ( v , q ) q αn ( v , q ) q αz 1   , we merely perform a Taylor expansion in the denominator of ( a i − 1 ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = Π f ( x i ) α 2 k 1 (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = Π f ( x i ) α 2 k 1 + O ( S − 2 kτ ) as the denominator can be rewritten in the form 1 + O ( S − 2 τ ) where the O ( S − 2 τ ) term is some ﬁnite sum of terms of the form γa ji Π mk = 1 α g ( k ) k β h ( k ) k α 2 k 1 each of which are O ( S − 2 τ ) and each term in the numerator is O ( S − 2 τ ) . 31 Hence we get that 1 + ( a i − 1 ) (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 1 ) ( a i ) (cid:80) A ( j , c , 1 ) = Π f ( x i ) α 2 k 1 (cid:80) k − 1 j = 0 (cid:80) h ( j , k ) c = 0 p ( j , c , 0 ) ( a i ) (cid:80) A ( j , c , 0 ) = Π f ( x i ) α 2 k 1 + O ( S − 2 kτ ) = ( 1 + r ∗ (cid:88) v = 1 γ v a k v i Π sq = 1 β m ( v , q ) q α 2 k 1 ) for some ﬁnite r ∗ . Repeating the same argument for evaluating the exp ( − log ( 1 + (cid:107) G X 1 j (cid:107) (cid:107) G X 0 j (cid:107) ) ) term yields the desired result , that f ( x i , x j , d , a ) = a i a j   1 + (cid:80) rv = 1 γvakvi Π sq = 1 βm ( v , q ) q αn ( v , q ) q αz 1 1 + (cid:80) rv = 1 γvakvj Π sq = 1 βm ( v , q ) q αn ( v , q ) q αz 1   . 7 Discussion In this work , we have established new results that allow for enumeration , up to arbitrary accuracy , of the graphs that satsify a ﬁxed bidegree sequence . These results are proven to hold asymptotically , as the number of nodes in the graphs goes to inﬁnity , under the assumption that as the limit is taken , the degrees of all nodes remain below the square root of the number of edges , S , in the graph . The extension to the square root represents an advance over previous results of a similar spirit , which only allow for degrees that are smaller powers of the number of edges present [ 18 , 21 , 22 ] . Clearly , the increase from S 1 / 3 to S 1 / 2 can become quite substantial in large graphs and will enhance the relevance of the results correspondingly . Interestingly , we have recently established a convenient condition such that there is certain to be a graph that realizes each bidegree sequence that satisﬁes it ( i . e . , a graphicality condition ) , which is also based on a square root bound on the maximum degree [ 11 ] . Indeed , as a sequence approaches the edge of graphicality , there will typically be fewer graphs that realize it [ 6 ] , and hence the types of arguments in the present paper , which are based on the presence of large collections of graphs , cannot be applied . While other approaches do not require such sparsity conditions , they circumvent related obstacles by assuming suﬃcient homogeneity among nodes’ degrees [ 2 , 12 ] , whereas our results require no such restriction . Although our ﬁndings are rigorously valid in an asymptotic sense , they are likely to be quite relevant in the generation of the large graphs that arise in many application areas [ 26 , 31 ] . In practice , once a graphic bidegree sequence is speciﬁed , various algorithms can be used to instantiate one or more graphs that realize this sequence . If the properties of a graph are to be studied , it is desirable not just to build such a graph or a collection of such graphs but to do so in an unbiased way . Computational graph - generation algorithms often start from a potentially biased sample of graphs and then repeatedly invoke some procedure , such as switching which nodes are connected by certain edges , to try to erase any initial bias . Enumeration results such as ours can be used to provide estimates for the number of iterations or the size of samples that will be needed for these approaches to succeed . In fact , many of our results concern enumeration of the ratio of the numbers of graphs compatible with two diﬀerent bidegree sequences . These types of results may be particularly useful for computational applications , since they allow for the calculation of the fraction of graphs that will contain a particular edge set or other features , which can then be compared to the corresponding fraction obtained computationally . Our results generally pertain to sequences that are close to each other in some sense but , as we have done in some of our proofs , ratios for more disparate sequences can be obtained by taking a series of small steps to gradually transform one of the sequences to the other . Our ﬁndings can be extended to graphs with speciﬁc properties , such as graphs that exclude certain collections or types of edges , as brieﬂy discussed in Appendix B . On the other hand , our approach makes signiﬁcant use of the fact that in large , sparse graphs , nodes rarely share common neighbors or collections of neighbors . If we try to extend our ideas to smaller networks , then we may run into trouble as the numbers of potential targets for edges is reduced and shared neighbors become more important . For suﬃciently small degree sequences , the numbers of corresponding graphs could be counted by direct brute force methods [ 24 ] . As sequences become large enough , however , such approaches would become more expensive . A future computational direction would be to explore how large a degree sequence must be in order for asymptotic results such as ours to provide accurate enumeration estimates . If there is a gap between sequence sizes where direct computational counting of graphs is practical and sizes where the application of asymptotic 32 results is useful , then alternative methods would need to be used for graph enumeration for sequences that fall into this gap . 8 Acknowledgements This work was partially supported by National Science Foundation Award DMS - 1312508 . Any opinion , ﬁndings , and conclusions or recommendations expressed in this material are those of the authors ( s ) and do not necessarily reﬂect the views of the NSF . 9 Appendix A In this section , we brieﬂy mention a generalization of the sparsity assumptions that will also yield a power series expansion for the number of graphs realizing a degree sequence , using the techniques of this paper . Speciﬁcally , up to this point , we have assumed that d max = O ( S 12 − τ ) . Denote a ( k ) ( b ( k ) ) as the k th entry in an in - degree ( out - degree ) sequence derived by sorting a and b into non - increasing order . The key observation is that if max ( a ( 1 ) (cid:88) k = 1 b ( k ) , b ( 1 ) (cid:88) k = 1 a ( k ) ) = O ( S 1 − τ ) , ( A . 1 ) then the appropriate extensions of Corollary 4 and Lemma 2 still hold and we can derive the corresponding power expansions . Naturally , for example , condition ( A . 1 ) holds if a ( 1 ) b ( 1 ) = O ( S 1 − τ ) or if more simply d max = O ( S 12 − τ ) . Recall the proof of Theorem 2 , where we count the number of common neighbors that receive an outward ( inward ) edge from both an arbitrary node x and a node of bounded degree y . In the worst case scenario , ( A . 1 ) gives the number of outgoing edges from all of the neighbors of x . Since there are S edges in the graph , it is intuitive that it would be diﬃcult for x and y , which has bounded degree , to share a common neighbor . This idea forms the foundation for the appropriate extensions of Theorem 2 and Corollaries 3 and 4 . Similarly , with care , we can extend Lemma 2 as follows : Lemma 5 . Suppose that f , g : I : = { 1 , 2 , . . . , N } → [ 1 , ∞ ) and for simplicity let g ( · ) ≤ f ( · ) . Let { x 1 , . . . , x r } be distinct inputs from I that yield the largest r outputs for f ( · ) and assume that (cid:80) ri = 1 f ( x i ) = O ( S 1 − τ ) , (cid:80) Ni = 1 f ( i ) = O ( S ) . Furthermore , let k be an O ( 1 ) natural number and let c 1 , . . . , c r be a sequence of natural numbers . Then N (cid:88) c 1 (cid:54) = . . . (cid:54) = c r g ( c 1 ) Π ri = 2 f ( c i ) = N (cid:88) c 1 , . . , c k , c k + 1 (cid:54) = . . . (cid:54) = c r g ( c 1 ) Π ri = 2 f ( c i ) ( 1 + O ( S − τ ) ) . We omit the details of the proofs of these results . 10 Appendix B In this section , we discuss how to generalize results from previous sections to directed graphs without loops and to undirected graphs ( with and without loops ) ; similar ideas apply to graphs with other sets of prohibited edges besides loops . 10 . 1 Directed Graphs without Loops As one may expect , when considering directed graphs without loops , the results regarding asymptotic enu - meration for directed graphs with loops carry over as the likelihood that a ﬁxed node has an edge to itself is small . More speciﬁcally , 33 Lemma 6 . Consider a degree sequence d = ( a , b ) ∈ Z N × 2 where a = { a 1 , a 2 , 0 , . . . , 0 } , b = { δ , δ , 2 , . . . , 2 , 1 , . . , 1 , 0 , . . , 0 } and N (cid:88) i = 1 a i = k (cid:88) i = 1 b i = : S , with δ either 0 or 1 and with 2 appearing q times in b . If a 1 , a 2 ≥ q + δ , then there are (cid:0) a 1 + a 2 − 2 δ − 2 q a 1 − δ − q (cid:1) directed graphs without loops that realize the above degree sequence . The above Lemma allows for the appropriate generalization of Theorem 1 , where we construct sets of residual degree sequences X k , δ 1 , δ 2 for k the number of common neighbors being considered . Here , δ 1 = 1 if node 1 connects to node 2 and is otherwise 0 ; similarly , δ 2 = 1 if node 2 connects to node 1 and is otherwise 0 . Since it should be unlikely asymptotically that either δ 1 or δ 2 is positive , it follows that (cid:107) G X 0 , 0 , 0 (cid:107) becomes the dominating term and the analysis proceeds as in other cases . ( We can make this rigorous by using switching arguments as we did in Section 3 . ) This will provide us with arbitrarily accurate asymptotics for the ratio of the number of directed graphs ( without loops ) with degree sequences that are distance 2 apart . Suppose we knew exactly the number of graphs of one degree sequence that summed to S . Then we could multiply this quantity by a product of ( fractional ) terms , where each fractional term is a ratio of the number of directed graphs without loops , distance 2 apart . Since from above we have asymptotics for the ratio of the number of graphs distance two apart , we only need one case where we can count the number of graphs of a given degree sequence exactly to derive the general formula . For simplicity , we can consider a degree sequence where all realizations can never have loops . For instance , we can arbitrarily extend our degree sequence to an analogous degree sequence in Z 2 N × 2 and we can consider the degree sequence ( { a 1 , . . . . , a N , 0 , . . . . , 0 } , { 0 , . . . , 0 , b N + 1 , . . . , b 2 N ) } ∈ Z 2 N × 2 . If b N + 1 , . . . , b 2 N consists of only zeros and ones , then Corollary 6 applies and all realizations are directed graphs without loops . 10 . 2 Undirected Graphs Practically speaking , the primary diﬀerence between manipulating degree sequences for undirected graphs and degree sequences for directed graphs is that for directed graphs , the in - degree sequence can be manip - ulated without impacting the out - degree sequence . In contrast , with undirected graphs , the corresponding adjacency matrix is symmetric . As such , while the same thematic ideas also follow through to undirected graphs , care should be taken . More speciﬁcally , instead of partitioning two rows ( or two columns ) separately , as we were able to do in the directed case , we must partition the two rows and the two columns together . In the remainder of this section , we will present results in terms of undirected graphs without loops , noting that the techniques carry over to the case where loops are allowed . For the undirected case , we must consider two distinct cases . In the ﬁrst case , the two partitioned nodes do not share an edge together . Consequently , if the two nodes have a 1 + a 2 edges , then these edges must also show up in the degrees of a 1 + a 2 other nodes in the graph . Lemma 7 . Consider a degree sequence a ∈ Z N for an undirected graph without loops , given by a = { a 1 , a 2 , 2 , . . . , 2 , 1 , . . . , 1 , 0 , . . . , 0 } where the ﬁrst two entires of a are followed by q 2 2 (cid:48) s and q 1 1 (cid:48) s such that q 1 + 2 q 2 = a 1 + a 2 . Then there are (cid:0) a 1 + a 2 − 2 q 2 a 1 − q 2 (cid:1) undirected graphs without loops that realize the above degree sequence where nodes 1 and 2 are not neighbors . Alternatively , if nodes 1 and 2 are neighbors then they make a 1 + a 2 − 2 edges with other nodes in the graph . We need to consider this case as well and the result is analogous to Lemma 7 . ( If we were considering undirected graphs with loops , we would also need to consider the case where there are self - loops too . ) Then as before , we construct sets X k , δ , where k denotes the number of common neighbors of nodes 1 and 2 and δ denotes whether nodes 1 and 2 are linked to each other . Again , (cid:107) G X 0 , 0 (cid:107) dominates and the analogous results hold . To switch from ratios to counts for a particular degree sequence , the following result , which is analogous to Corollary 6 , is fundamental . 34 Lemma 8 . For a degree sequence a ∈ Z N for an undirected graph without loops given by a = { 1 , . . . , 1 , 0 , . . . , 0 } with (cid:80) a i = S , (cid:107) G a (cid:107) = S ! 2 S 2 ( S 2 ! ) . Proof . The proof is constructive . Note that S must be even as otherwise there are no graphs . For the ﬁrst edge , there are (cid:0) S 2 (cid:1) possible choices of pairs of nodes to connect . After we decide the initial pair to wire up , then there are (cid:0) S − 2 2 (cid:1) possible choices to form the second edge . This reasoning implies that there are Π S 2 − 1 k = 0 (cid:0) S − 2 k 2 (cid:1) = S ! 2 S / 2 choices for wirings . In this procedure , however , suppose that all of the choices are the same except for the ﬁrst two steps . In the ﬁrst step in one example , node 1 wires with node 2 and node 3 wires with node 4 . Alternatively in the other example , node 3 wires up with node 4 in the ﬁrst step , but node 1 wires up with node 2 in the second step . The output is the same graph , but we counted both of these instances as two distinct events ( graphs ) . We readily note that there are S 2 ! possible ways of wiring up the same graph with this procedure , as there are S 2 edge pairs in the graph . The technique for counting the number of undirected graphs with loops for the degree sequence a = { 1 , . . . , 1 , 0 , . . . , 0 } is similar and left as an exercise to the reader . At this juncture , we note that the idea of prohibiting loops is a special case of prohibiting edges between ( two ) nodes . Though it is outside the scope of this work , we strongly expect that the ideas can be extended to attain asymptotics for the ratio of the number of graphs of two distinct degree sequences distance 2 apart where we prohibit edges between certain nodes . As long as generating a prohibited edge is unlikely for any node in the graph , the ideas of our work should carry over ; that is , the dominating term in the ratio will consist of realizations of graphs where the two partitioned nodes do not share a common neighbor and no prohibited edges appear . 11 Appendix C : Proof of Theorem 4 In this section , we provide a proof of Theorem 4 . From Theorem 3 , we have an approximation f such that (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = f ( e i , e j , d , σ ) ( 1 + O ( S − 12 − wτ ) ) where σ = a or b , where we have assumed ( and justiﬁed ) up until this point that the dependence on the degree sequence d in f is weak . Eventually , we will reach a point where such an assumption is no longer reasonable . In this case we decompose our approximation f into one part that eﬀectively ignores the dependence of d and a part of f that takes into account d . That is , we can write f ( e i , e j , d 1 , σ ) = f ( e i , e j , d 0 , σ ) ( 1 + O ( S − 12 − τ ) ) , ( C . 1 ) where we have proven that for suitably chosen d 0 the correction will yield a term of size at most O ( S − 12 − τ ) . For simplicity , we will consider σ = a . Denote the O ( S − 12 − τ ) term in equation ( C . 1 ) by z ∗ , such that equation ( C . 1 ) becomes f ( e i , e j , d 1 , a ) = f ( e i , e j , d 0 , a ) + z ∗ f ( e i , e j , d 0 , a ) . ( C . 2 ) In the Theorem below , we restate Theorem 4 ; note that we implicitly deﬁne z = z ∗ f ( e i , e j , d 0 , a ) . Appendix Theorem 1 ( Theorem 4 ) . Consider an approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = f ( e i , e j , d , σ ) ( 1 + O ( S − 12 − wτ ) ) for some w > 0 . Furthermore suppose that for m = O ( S 12 − τ ) , f ( e i , e j , d 0 , σ ) = f ( e i , e j , d 1 , σ ) + z ( e i , e j , d 0 − d 1 , d 0 , σ ) where (cid:107) d 1 − d 0 (cid:107) 1 ≤ m and z ( e i , e j , d 0 − d 1 , d 0 , σ ) ≤ O ( S − 12 − τ ) f ( e i , e j , d 0 , σ ) . If σ = a , then we can construct a sharper approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = g ( e i , e j , d , a ) ( 1 + O ( S − 12 − ( w + 2 ) τ ) ) 35 where g ( e i , e j , d , a ) = a i a j exp ( log ( 1 + ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xai − 1 = xai Π aik = 1 f ( e xk , e uk , ( a − a i e i , ( b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xai − 1 (cid:54) = xai Π aik = 1 f ( e xk , e uk , ( a − a i e i , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) ) − log ( 1 + ( a j − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xaj − 1 = xaj Π ajk = 1 f ( e xk , e uk , ( a − a j e j , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = xaj − 1 (cid:54) = xaj Π ajk = 1 f ( e xk , e uk , ( a − a j e j , b − (cid:80) k − 1 j = 1 e xj + (cid:80) ai − k j = 1 e uj ) , b ) ) ) for an arbitrary choice of u k . A similar result holds , with g depending on b , if σ = b . Proof . Recall the notation from Theorem 3 . As before , we deﬁne ∆ i to be the diﬀerence between (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) evaluated using the exact ratio φ and the same quantity evaluated using the approximation f . In essence , we will show that using our crude approximation f will yield an approximation of (cid:107) G X 1 i (cid:107) a i (cid:107) G X 0 i (cid:107) by a factor of ( 1 + O ( S − 12 − ( w + 2 ) τ ) ) , after which application of Corollary 5 yields the result . Again we consider equation ( 17 ) , that is ∆ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 φ ( e x k , e u ai − k + 1 , ( a − a i e i − e j , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 φ ( e x k , e u ai − k + 1 , ( a − a i e i − e j , b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) − ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f ( e x k , e u ai − k + 1 , ( a − a i e i − e j , ( b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f ( e x k , e u ai − k + 1 , ( a − a i e i − e j , ( b − (cid:80) k − 1 j = 1 e x j − (cid:80) a i − k j = 1 e u j ) , b ) . ( C . 3 ) As in the proof of Theorem 3 , we abuse notation by using f k ( x k ) , φ k ( x k ) in place of the full expressions for f and φ , even though f k and φ k ( x k ) do also depend on x 1 , . . . , x k − 1 . This reduces to a more tractable ( but slightly misleading ) notation : ∆ i = ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 φ k ( x k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 φ k ( x k ) − ( a i − 1 ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 = x ai Π a i k = 1 f k ( x k ) (cid:80) x 1 (cid:54) = . . . (cid:54) = x ai − 1 (cid:54) = x ai Π a i k = 1 f k ( x k ) . Let D 0 denote the set of sets of a i indices in { 1 , . . . , N } such that the variables associated with these indices are distinct and let D 1 denote the set of sets of a i indices in { 1 , . . . , N } such that the variables associated with the ﬁrst a i − 2 are distinct and those with the ﬁnal two are equal . Writing ∆ i as a single fraction , we obtain ∆ i = ( a i − 1 ) [ (cid:80) D 1 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) − (cid:80) D 1 Π a i k = 1 f k ( x k ) (cid:80) D 0 Π a i k = 1 φ k ( x k ) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) = ( a i − 1 ) [ (cid:80) D 1 , D 0 ( Π x k ∈ D 1 φ k ( x k ) Π x k ∈ D 0 f k ( x k ) − Π x k ∈ D 1 f k ( x k ) Π x k ∈ D 0 φ k ( x k ) ) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) . We now apply Theorem 12 repeatedly to write φ k = f k ( 1 + ξ k ) where ξ k depends only on x 1 , . . . , x k ( but we omit the dependence ) and , by Theorem 12 and the deﬁnition of f , ξ k = O ( S − 12 − wτ ) for some positive w . Furthermore , let δ k = 0 if k = a i or k = a i − 1 and δ k = 1 otherwise . These steps yield ∆ i = ( a i − 1 ) [ (cid:80) D 1 , D 0 ( Π x k ∈ D 1 f k ( x k ) ( 1 + ξ k δ k ) Π x k ∈ D 0 f k ( x k ) − Π x k ∈ D 1 f k ( x k ) Π x k ∈ D 0 f k ( x k ) ( 1 + ξ k δ k ) ) + (cid:15) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) ( C . 4 ) where (cid:15) is the compensatory term for zeroing out certain terms by inserting the δ k into equation ( C . 4 ) , which we can express as (cid:15) = (cid:15) 1 + (cid:15) 2 − (cid:15) 3 − (cid:15) 4 for 36 (cid:15) 1 = (cid:88) D 1 ξ a i f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 Π x k ∈ D 0 f k ( x k ) , ( C . 5 ) (cid:15) 2 = (cid:88) D 1 ξ a i − 1 f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 f k ( x k ) ( 1 + ξ k ) (cid:88) D 0 Π x k ∈ D 0 f k ( x k ) , ( C . 6 ) (cid:15) 3 = (cid:88) D 1 Π x k ∈ D 1 f k ( x k ) (cid:88) D 0 ξ a i − 1 f a i ( x a i ) f a i − 1 ( x a i − 1 ) Π k (cid:54) = a i − 1 , a i f k ( x k ) ( 1 + ξ k ) , ( C . 7 ) (cid:15) 4 = (cid:88) D 1 Π x k ∈ D 1 f k ( x k ) (cid:88) D 0 ξ a i f a i ( x a i ) Π k (cid:54) = a i f k ( x k ) ( 1 + ξ k ) . ( C . 8 ) The procedure for identifying that (cid:15) is indeed a ‘higher order term’ is exactly identical to the proof in Theorem 3 and hence we ignore the contribution from (cid:15) . It follows instantly from equation ( C . 4 ) that once we distribute Π f k ( 1 + ξ k δ k ) and cancel identical terms , the contribution in the numerator only consists of terms where there is at least one ξ k in the product . Hence we can deﬁne a vector η where each entry η k either equals 1 or 0 but η (cid:54) = 0 and η a i − 1 = η a i = 0 , which yields ∆ i ≤ (cid:88) η (cid:54) = 0 ( a i − 1 ) [ (cid:80) D 1 , D 0 ( Π x k ∈ D 1 f k ( x k ) ( 1 + ξ k δ k − η k ) Π x k ∈ D 0 f k ( x k ) − Π x k ∈ D 1 f k ( x k ) Π x k ∈ D 0 f k ( x k ) ( 1 + ξ k δ k − η k ) ) ] (cid:80) D 0 Π a i k = 1 φ k ( x k ) (cid:80) D 0 Π a i k = 1 f k ( x k ) . ( C . 9 ) Now , for k = a i or k = a i − 1 , f k ( x k ) ( 1 + ξ k δ k ) = f k ( x k ) by deﬁnition . For these choices of k in D 0 and D 1 , we employ the relationship that f k = i k + z k where i k is independent of x 1 , . . . , x k − 1 and z k = O ( S − 12 − τ ) f k depends on these values . The z k represent the new component here relative to Theorem 3 , and we need to show that these terms are small enough that they do not make an important contribution . We denote the ﬁrst a i − 2 variables in D 0 and D 1 as F 0 and F 1 respectively . We now have the following ( omitting the dependence on x ) : ∆ i ≤ (cid:88) η (cid:54) = 0 ( a i − 1 ) (cid:80) D 1 [ i a i − 1 + z a i − 1 ] 2 Π x k ∈ F 1 f k ( 1 + ξ k − η k ) (cid:80) D 0 [ i a i − 1 + z a i − 1 ] [ i a i + z a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k − ( C . 10 ) ( a i − 1 ) (cid:80) D 1 [ i a i − 1 + z a i − 1 ] 2 Π x k ∈ F 1 f k (cid:80) D 0 [ i a i − 1 + z a i − 1 ] [ i a i + z a i ] Π x k ∈ F 0 f k ( 1 + ξ k − η k ) (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k . With some algebra , we can re - express equation ( C . 10 ) as ∆ i ≤ (cid:88) η (cid:54) = 0 ( a i − 1 ) (cid:80) D 1 [ i a i − 1 ] 2 Π x k ∈ F 1 f k ( 1 + ξ k − η k ) (cid:80) D 0 [ i a i − 1 ] [ i a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k − ( C . 11 ) ( a i − 1 ) (cid:80) D 1 [ i a i − 1 ] 2 Π x k ∈ F 1 f k (cid:80) D 0 [ i a i − 1 ] [ i a i ] Π x k ∈ F 0 f k ( 1 + ξ k − η k ) (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k + Ω where Ω is the compensatory term for omitting the z k terms ( which we deﬁne later ) . Now since i k is independent of x 1 , . . . , x k − 1 , we can employ the Mean Value Theorem to integrate out the last 2 variables , deﬁne D ∗ as the set of sets of a i − 2 distinct indices , and express equation ( C . 11 ) as ∆ i ≤ (cid:88) η (cid:54) = 0 ( a i − 1 ) (cid:80) D ∗ , D ∗ λ 1 Π x k ∈ D ∗ f k ( 1 + ξ k − η k ) λ 2 Π x k ∈ D ∗ f k − λ 1 Π x k ∈ D ∗ f k λ 2 Π x k ∈ D ∗ f k ( 1 + ξ k − η k ) (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k + Ω = ( C . 12 ) 37 (cid:88) η (cid:54) = 0 ( a i − 1 ) λ 1 λ 2 (cid:80) D ∗ , D ∗ [ Π x k ∈ D ∗ f k ( 1 + ξ k − η k ) Π x k ∈ D ∗ f k − Π x k ∈ D ∗ f k Π x k ∈ D ∗ f k ( 1 + ξ k − η k ) ] (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k + Ω = (cid:88) η (cid:54) = 0 Ω . Now we conclude the proof . From equation ( C . 10 ) we can write Ω = Ω + − Ω − where Ω + includes the positive compensatory terms from the ( ﬁrst part of ) equation ( C . 10 ) and Ω − includes the negative compensatory terms from the ( second part of ) equation ( C . 10 ) . The following table illustrates all of the subcases that constitute the Ω (cid:48) + , i s in equation ( C . 10 ) . The columns indicate the term in the ﬁrst summation found in equation ( C . 10 ) ( Ω + ) and the rows indicate the term in the second summation . If the i , j th entry is a (cid:88) , then this is a relevant subcase , while the case marked with X is not . i 2 a i − 1 2 i a i − 1 z a i − 1 z 2 a i − 1 i a i − 1 i a i X (cid:88) (cid:88) i a i − 1 z a i (cid:88) (cid:88) (cid:88) i a i z a i − 1 (cid:88) (cid:88) (cid:88) z a i z a i − 1 (cid:88) (cid:88) (cid:88) Note that only the ﬁrst entry in the table is X ; we already demonstrated through equation ( C . 11 ) that the contribution from the the case where both summations contribute i (cid:48) s without any z (cid:48) s is 0 . Hence , we have 11 subcases and we can express Ω + = (cid:80) 11 i = 1 Ω + , i and Ω − = (cid:80) 11 i = 1 Ω − , i . As we have demonstrated in this work , the z ’s represent terms that are much smaller than the i (cid:48) s . Conse - quently , interesting subcases will involve the fewest number of appearances fo z ’s as possible . Furthermore , by symmetry the terms corresponding to rows involving the i a i − 1 z a i or i a i z a i − 1 terms are identical due to symmetry . We therefore only need to examine two subcases , ( a ) the subcase where the ﬁrst summation is 2 i a i − 1 z a i − 1 and the second summation is i a i − 1 i a i , which we deﬁne to be Ω + , 1 , Ω − , 1 and ( b ) the subcase where the ﬁrst summation is i 2 a i − 1 and the second summation is i a i − 1 z a i which we deﬁne to be Ω + , 3 , Ω − , 3 . ( We leave the subcase ( b ) as an exercise to the reader . ) So consider , Ω + , 1 = (cid:88) η (cid:54) = 0 ( a i − 1 ) (cid:80) D 1 [ 2 i a i − 1 z a i − 1 ] Π x k ∈ F 1 f k ( 1 + ξ k − η k ) (cid:80) D 0 [ i a i − 1 ] [ i a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k . ( C . 13 ) We will brieﬂy consider the case where there is precisely one η k = 1 . By symmetry we will consider η 1 = 1 and multiply this quantity by a i − 2 ( as there are a i − 2 possible choices to let η k = 1 ; recall that η a i − 1 = η a i = 0 ) , obtaining Ω ∗ + , 1 : = ( a i − 2 ) ( a i − 1 ) (cid:80) D 1 [ 2 i a i − 1 z a i − 1 ] f 1 ξ 1 Π x k , k (cid:54) = 1 ∈ F 1 f k ( 1 + ξ k ) (cid:80) D 0 [ i a i − 1 ] [ i a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k . ( C . 14 ) But by assumption z a i − 1 ≤ O ( S − 12 − τ ) f a i − 1 and trivially i a i − 1 ≤ Cf a i − 1 , for some constant C , so we have that Ω ∗ + , 1 ≤ ( a i − 2 ) ( a i − 1 ) (cid:80) D 1 [ O ( S − 1 2 − τ ) f 2 a i − 1 ] f 1 ξ 1 Π x k , k (cid:54) = 1 ∈ F 1 f k ( 1 + ξ k ) (cid:80) D 0 [ f a i − 1 ] [ f a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k . ( C . 15 ) Now applying the fact that a i ≤ d max = O ( S 12 − τ ) and ξ 1 = O ( S − 12 − wτ ) , Ω ∗ + , 1 ≤ O ( S − ( 3 + w ) τ ) (cid:80) D 1 [ 2 f 2 a i − 1 ] f 1 Π x k , k (cid:54) = 1 ∈ F 1 f k ( 1 + ξ k ) (cid:80) D 0 [ f a i − 1 ] [ f a i ] Π x k ∈ F 0 f k (cid:80) D 0 Π a i k = 1 φ k (cid:80) D 0 Π a i k = 1 f k . ( C . 16 ) Then employing the technique we used in the proof of Theorem 3 by applying Corollary 4 to reduce the domains D 0 , D 1 to D ∗ we get that 38 Ω ∗ + , 1 ≤ O ( S − ( 3 + w ) τ ) O ( S 72 − τ ) (cid:80) D ∗ Π x k ∈ D ∗ f k ( 1 + ξ k ) (cid:80) D ∗ Π x k ∈ D ∗ f k O ( S 4 ) (cid:80) D ∗ Π a i − 2 k = 1 φ k (cid:80) D ∗ Π a i − 2 k = 1 f k = O ( S − 12 − 4 τ − wτ ) , ( C . 17 ) and hence this constribution is a higher order term . Finally , we only considered the case where there is precisely one η k = 1 . But cases where there are more positive η (cid:48) k s yield even smaller terms ! For example , when we had precisely one η k = 1 , there were at most a i choices for selecting k , but for each η k = 1 , we end up multiplying the term f k by ξ k ( as opposed to ( 1 + ξ k ) ) , and hence if there are m η (cid:48) k s that equal 1 , then this results in a contribution bounded by Ω + , 1 ≤ (cid:80) a i m = 1 ( a i ) m − 1 ξ m − 1 Ω ∗ + , 1 = (cid:80) a i m = 1 O ( S − w ( m − 1 ) τ − ( m − 1 ) τ ) Ω ∗ + , 1 = O ( S − 12 − 4 τ − wτ ) . Since these contributions are now much smaller than O ( S − 12 − 2 τ − wτ ) , we conclude that ∆ i = O ( S − 12 − 2 τ − wτ ) and from the beginning part of the proof of Theorem 3 conclude that our new approximation (cid:107) G d − i (cid:107) (cid:107) G d − j (cid:107) = g ( e i , e j , d , a ) ( 1 + O ( S − 12 − ( w + 2 ) τ ) ) . References [ 1 ] Asmussen , S . and Glynn , P . W . ( 2007 ) . Stochastic simulation : Algorithms and analysis ( Vol . 57 ) . Springer Science and Business Media . [ 2 ] Barvinok , A . ( 2012 ) . Matrices with prescribed row and column sums . Linear Algebra and its Applica - tions , 436 ( 4 ) , 820 - 844 . [ 3 ] Bayati , M . , Kim , J . H . , and Saberi , A . ( 2010 ) . A sequential algorithm for generating random graphs . Algorithmica 58 ( 4 ) , 860 - 910 . [ 4 ] Bender , E . A . , and Canﬁeld , E . R . ( 1978 ) . The asymptotic number of labeled graphs with given degree sequences . Journal of Combinatorial Theory , Series A , 24 ( 3 ) , 296 - 307 . [ 5 ] Berger , A . and Muller - Hannemann , M . ( 2010 ) . Uniform sampling of digraphs with a ﬁxed degree se - quence . In Graph theoretic concepts in computer science , ( pp . 220 - 231 ) . Springer Berlin Heidelberg . [ 6 ] Berger , A . ( 2014 ) . The connection between the number of realizations for degree lists and majorization . arXiv preprint arXiv : 1212 . 5443 . [ 7 ] Bezakova , I . , Bhatnagar , N . , and Vigoda , E . ( 2007 ) . Sampling binary contingency tables with a greedy start . Random Structures and Algorithms 30 ( 1 - 2 ) , 168 - 205 . [ 8 ] Bezakova , I . , Sinclair , A . , Stefankovic , D . , and Vigoda , E . ( 2012 ) . Negative examples for sequential importance sampling of binary contingency tables . Algorithmica 64 ( 4 ) , 606 - 620 . [ 9 ] Blanchet , J . H . ( 2009 ) . Eﬃcient importance sampling for binary contingency tables . The Annals of Applied Probability 19 ( 3 ) , 949 - 982 . [ 10 ] Blitzstein , J . , and Diaconis , P . ( 2011 ) . A sequential importance sampling algorithm for generating random graphs with prescribed degrees . Internet Mathematics 6 ( 4 ) , 489 - 522 . [ 11 ] Burstein , D . and Rubin , J . ( 2015 ) . Suﬃcient conditions for graphicality of bidegree sequences . arXiv preprint arXiv : 1511 . 02411 . [ 12 ] Canﬁeld , E . R . , Greenhill , C . , and McKay , B . D . ( 2008 ) . Asymptotic enumeration of dense 0 - 1 matrices with speciﬁed line sums Journal of Combinatorial Theory Series A , 115 ( 1 ) , 32 - 66 . [ 13 ] Chen , Y . , Diaconis , P . , Holmes , S . P . , and Liu , J . S . ( 2005 ) . Sequential Monte Carlo methods for statistical analysis of tables . Journal of the American Statistical Association 100 ( 469 ) , 109 - 120 . 39 [ 14 ] Chindelevitch , L . , Loh , P . R . , Enayetallah , A . , Berger , B . , and Ziemek , D . ( 2012 ) . Assessing statistical signiﬁcance in causal graphs . BMC Bioinformatics , 13 ( 1 ) , 35 . [ 15 ] Del Genio , C . I . , Kim , H . , Toroczkai , Z . , and Bassler , K . E . ( 2010 ) . Eﬃcient and exact sampling of simple graphs with given arbitrary degree sequence . PLoS One , 5 ( 4 ) , e10012 . [ 16 ] Durrett , R . ( 2010 ) . Some features of the spread of epidemics and information on a random graph . Proc . Nat . Acad . Sci . USA , 107 ( 10 ) , 4491 – 4498 . [ 17 ] Gionis , A . , Mannila , H . , Mielikainen , T . , and Tsaparas , P . ( 2007 ) . Assessing data mining results via swap randomization . ACM Transactions on Knowledge Discovery from Data ( TKDD ) , 1 ( 3 ) , 14 . [ 18 ] Greenhill , C . , McKay , B . D . , and Wang , X . ( 2006 ) . Asymptotic enumeration of sparse 0 - 1 matrices with irregular row and column sums . Journal of Combinatorial Theory , Series A 113 ( 2 ) , 291 - 324 . [ 19 ] Itzkovitz , S . , Milo , R . , Kashtan , N . , Ziv , G . , and Alon , U . ( 2003 ) . Subgraphs in random networks . Physical Review E , 68 ( 2 ) , 026127 . [ 20 ] Itzkovitz , S . , Milo , R . , Kashtan , N . , Newman , M . E . J . , and Alon , U . ( 2004 ) . Reply to comment on subgraphs in random networks . Physical Review E , 70 ( 5 ) , 058102 . [ 21 ] McKay , B . D . ( 1984 ) . Asymptotics for 0 - 1 matrices with prescribed line sums . Enumeration and Design , Academic Press , Canada , 225 - 238 . [ 22 ] McKay , B . D . , and Wormald , N . C . ( 1991 ) . Asymptotic enumeration by degree sequence of graphs with degrees o ( n 12 ) . Combinatorica , 11 ( 4 ) , 369 - 382 . [ 23 ] McKay , B . D . ( 2010 , August ) . Subgraphs of random graphs with speciﬁed degrees . Proceedings of the International Congress of Mathematicians . ( Vol . 4 , pp . 2489 - 2501 ) . [ 24 ] Miller , J . W . , and Harrison , M . T . ( 2013 ) . Exact sampling and counting for ﬁxed - margin matrices . Annals of Statistics , 41 ( 3 ) 1569 - 1592 . [ 25 ] Milo , R . , Kashtan , N . , Itzkovitz , S . , Newman , M . E . J . , and Alon , U . ( 2003 ) . On the uniform generation of random graphs with prescribed degree sequences . arXiv preprint cond - mat / 0312028 . [ 26 ] Pomerance , A . , Ott , E . , Girvan , M . , and Losert , W . ( 2009 ) . The eﬀect of network topology on the stability of discrete state models of genetic control . Proceedings of the National Academy of Sciences , 106 ( 20 ) , 8209 - 8214 . [ 27 ] Rao , A . R . , Jana , R . , and Bandyopadhyay , S . ( 1996 ) . A Markov chain Monte Carlo method for gener - ating random ( 0 , 1 ) - matrices with given marginals . Sankhya : The Indian Journal of Statistics , Series A , 225 - 242 . [ 28 ] Ray , J . , Pinar , A . , and Seshadhri , C . ( 2012 ) . Are We There Yet ? When to Stop a Markov chain while Generating Random Graphs . In : Bonato A , Janssen J , editors . Algorithms and Models for the Web Graph , Lecture Notes in Computer Science , 7323 , 153 - 164 . Springer , Berlin / Heidelberg . [ 28 ] Read58 Read , R . C . ( 1958 ) Some enumeration problems in graph theory . ( Doctoral dissertation , Uni - versity of London ) . [ 29 ] Verhelst , N . D . ( 2008 ) . An eﬃcient MCMC algorithm to sample binary matrices with ﬁxed marginals . Psychometrika 73 ( 4 ) , 705 - 728 . [ 30 ] Vespignani , A . ( 2012 ) . Modelling dynamical processes in complex socio - technical systems . Nat Phys . 8 ( 1 ) , 32 - 39 . [ 31 ] Zhao , L . , Bryce Beverlin , I . I . , Netoﬀ , T . , and Nykamp , D . Q . ( 2011 ) . Synchronization from second order network connectivity statistics . Frontiers in Computational Neuroscience , 5 , doi : 10 . 3389 / fn - com . 2011 . 00028 . 40
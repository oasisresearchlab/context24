Dynamic multiple - target tracing to probe spatiotemporal cartography of cell membranes Arnauld Serge´ 1 – 3 , Nicolas Bertaux 4 – 6 , Herve´ Rigneault 4 , 5 & Didier Marguet 1 – 3 Although the highly dynamic and mosaic organization of the plasma membrane is well - recognized , depicting a resolved , global view of this organization remains challenging . We present an analytical single - particle tracking ( SPT ) method and tool , multiple - target tracing ( MTT ) , that takes advantage of the high spatial resolution provided by single - ﬂuorophore sensitivity . MTT can be used to generate dynamic maps at high densities of tracked particles , thereby providing global representation of molecular dynamics in cell membranes . Deﬂation by subtracting detected peaks allows detection of lower - intensity peaks . We exhaustively detected particles using MTT , with performance reaching theoretical limits , and then reconnected trajectories integrating the statistical information from past trajectories . We demonstrate the potential of this method by applying it to the epidermal growth factor receptor ( EGFR ) labeled with quantum dots ( Qdots ) , in the plasma membrane of live cells . We anticipate the use of MTT to explore molecular dynamics and interactions at the cell membrane . Knowledge of the dynamic organization of plasma membrane components is crucial for a better understanding of cellular func - tions . One fundamental question remains as to how the spatio - temporal organization of the membrane regulates signaling upon physiological stimulation . The development of experimental approaches used to study these structure - function relationships has remained challenging 1 – 4 , with presently available techniques requiring a compromise between temporal and spatial resolution . Among classical approaches , ﬂuorescence recovery after photo - bleaching is based on ensemble - averaging measurements within a small area of the cell membrane 2 . Fluorescence correlation spectro - scopy ( FCS ) provides a good alternative as it can be used to quantify translational diffusion with high temporal resolution and statistical accuracy 4 . Recently , we increased the strength of FCS by obtaining spatial information from measurements performed at variable observation volumes 5 . This approach can be used to detect the dynamic partitioning into nanodomains or the presence of a meshwork in live cells 6 . FCS observation , however , is still limited to a small area of the plasma membrane . Single - molecule techniques such as SPT provide high spatial resolution , with molecular motion not masked by ensemble aver - aging 3 , 7 . When connecting moving tags , however , fast particles become difﬁcult to connect at high densities : nearest neighbors are usually favored when ambiguities arise resulting , for instance , from particles appearing , disappearing or crossing paths . This drawback can be reduced both experimentally , using a high - quality , dedicated apparatus ( optics , electron - multiplying charge - coupled device ( CCD ) camera , biomaterials and others ) , and analytically , by optimizing the algorithms . The introduction of ﬂuorescent Qdots with high photostability , brightness and biolabeling versatility 8 has considerably increased the sensitivity of detection and greatly facilitated biological investigations of cellular processes 9 , 10 . The ability to trace a large number of targets would expand the potential of single - molecule approaches ; the resulting larger number of observations would concurrently improve statistical relevance . Although it would be challenging , an approach that allows tracking particles at high densities and with fast acquisition speed is required to achieve an appropriate spatiotemporal resolution . Unfortu - nately , overcrowded datasets increase the occurrence of false detection or connection , and reducing illumination time directly degrades the signal - to - noise ratio ( SNR ) . Here we present a method for high - density labeling , MTT . Classically , SPT analyses are performed in two independent stages : peak detection and estimation , and trace reconnection 11 , 12 . In MTT , appropriate statistical tools provide optimal peak character - ization . Introducing a deﬂation loop by subtracting detected peaks allows detection of additional peaks that were previously masked because of their lower intensity . Another improvement comes from the intrinsic link between detection and connection : analyses are alternately performed using information obtained at both stages . Therefore , accurate localization and exhaustive detection , com - bined with integrated historical information of trajectories , provide efﬁcient multiple - target reconnection . Robustness is achieved by including minimum hypotheses on the underlying diffusion phenomena and by having to adjust a minimal set of parameters . Reconnection , in turn , allows validation of detected particles . To illustrate the tracking results , we detected for each trajectory RECEIVED 26 NOVEMBER 2007 ; ACCEPTED 6 JUNE 2008 ; PUBLISHED ONLINE 6 JULY 2008 ; DOI : 10 . 1038 / NMETH . 1233 1 Centre d’Immunologie de Marseille - Luminy , Universite´ de la Me´diterrane´e , 2 Institut National de la Sante´ et de la Recherche Me´dicale , Unite´ Mixte de Recherche 631 , 3 Centre National de la Recherche Scientiﬁque , UMR 6102 , Parc scientiﬁque de Luminy , Case 906 , F - 13288 Marseille cedex 09 , France . 4 Institut Fresnel , Universite´ Paul Ce´zanne , 5 Centre National de la Recherche Scientiﬁque , UMR 6133 , Domaine Universitaire de Saint Je´roˆme , F - 13397 Marseille cedex 20 , France . 6 E´cole Centrale Marseille , Technopoˆle de Chaˆteau - Gombert , 38 , rue Fre´de´ric Joliot Curie , F - 13451 Marseille cedex 20 , France . Correspondence should be addressed to D . M . ( marguet @ ciml . univ - mrs . fr ) . NATURE METHODS | VOL . 5 NO . 8 | AUGUST 2008 | 687 ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s possible conﬁnement within diffusive events , a key parameter of membrane dynamics . Combining analytical tools allowed us to track particles at higher densities and collect snapshots and movies of cell membrane organization over a short period of time ( B 10 s ) . This new conceptual approach introduces a general method of studying molecular dynamics for various constraints of speed or scale . We tested MTT by analyzing the membrane dynamics of EGFR 13 naturally expressed in COS - 7 cells . Our work demonstrates the potential usefulness of MTT in analyzing membrane dynamics under physiological conditions . RESULTSSchematic principle of the MTT algorithm SPT is based on the ability to accurately identify the center of a peak . By imaging isolated ﬂuorescent molecules , spatial resolution close to the molecular scale can be achieved , and it is possible to construct trajectories of these ﬂuorescent molecules ( which we call reconnection ) as long as they remain visible . But it is challenging to do this at high particle density and low SNR . In this work we overcame these challenges and simultaneously tracked a large number of molecules . In MTT , the detection , estimation of posi - tions and reconnection are done sequentially ( Fig . 1 ) . First , MTT provides efﬁcient detection of particles , and second , it takes into account past information for the reconnec - tion . A mathematical description is avail - able in the Supplementary Note online . Individual ﬂuorophores behave as point - source emitters and generate blurred images described by the point - spread function ( PSF ) of the microscope . Classically , the image of each ﬂuorophore can be described by the ﬂuorescence level X i , j at pixel ( i , j ) , which results from the sum of a ﬂuorescence peak , offset and noise 11 , 12 : X i ; j ¼ I (cid:1) G i ; j ð i 0 ; j 0 ; r 0 Þ + m + N i ; j ð s 2 Þ ; ð 1 Þ where I is the intensity of the particle , G is a bidimensional Gaussian modeling the PSF centered in ( i 0 , j 0 ) with a radius r 0 ( Supplementary Note ) , m corresponds to the mean background intensity and N models the background noise of s . d . , s ( Supple - mentary Table 1 online ) . For any given image , I is unknown and represents a random variable with a probability distribution including the phenomena of photon noise , bleaching and blinking . Bleaching is negligible for ﬂuorescent markers such as Qdots because their lifespan is longer than the acquisition time 8 . Blinking is more critical as it is present Estimation Detection D e f l a t i on Reconnection T Inputs Outputs Estimation Detection P l , i 0 , j 0 , r 0 , m , (cid:1) PFA peak D max D local w t w t + 1 w t w s Past statistics S t r i ngen t t e s t f o r o r phan pea ks 1 b a 2 Estimation Detection D e f l a t i on Reconnection Remarks Steps Frame Initialization , no reconnection First reconnection , with default statistics Reconnection with updated statistics Reconnection with default statistics Loop o v e r f r a m e s Steps Generalized likelihood ratio test Maximum likelihood Gauss - Newton fit Estimation Detection D e f l a t i on Reconnection Estimation Detection D e f l a t i on Reconnection D e f l a t i on Figure 1 | Schematic overview of MTT . ( a ) Detailed description of the steps iteratively performed for each frame , with the main input and output parameters . Note that D max is the major input parameter directly depending on the given biological system . For a broad range of initial conditions , all other inputs ( that is , PFA peak , which directly determines PD peak , w s , w t and parameters of statistical laws ) only have to be set once . After reconnection , orphan peaks are tested using a more stringent PFA orphan before initiating new trajectories . ( b ) Frame - by - frame process of a full stack , illustrating the speciﬁcities concerning frames 1 and 2 ( initiation of reconnection ) and 1 to w t ( building of past statistics ) . From frame 1 to w t , statistics ( mean and variance of peak parameters ) are assigned to default typical values , until they can be evaluated , over w t past frames . a b c First deflated image Raw image Detected peaks Second deflated image Last deflated image Deflated gaussians I n t e n s i t y ( a . u . ) Deflated data Second fit Deflated peak Initial data First fit I n t en s i t y ( a . u . ) Position ( a . u . ) Position ( a . u . ) m NoiseModel I n t en s i t y ( a . u . ) Position ( a . u . ) m I / π 1 / 2 r 0 (cid:1) (cid:1) r 0 Position ( a . u . ) I n t en s i t y ( a . u . ) i 0 , j 0 Figure 2 | Exhaustive particle detection principle . ( a ) A GLRT compares H 0 / H 1 hypotheses . In H 0 , the window contains only Gaussian noise with s . d . s and mean offset m ; in H 1 , the window also contains a Gaussian peak centered in ( i 0 , j 0 ) , with a radius r 0 and an intensity I ( leading to an amplitude I / p 1 / 2 r 0 ) . ( b ) Window containing two peaks of different intensities ( I 1 / I 2 ¼ 3 ) . A ﬁrst ﬁt detects the most intense peak ( top ) . Deﬂation allows the minor peak , initially buried , to be detected next ( bottom ) . All graphs depict simulated ﬂuorescence intensity against spatial position as a line - scan through an image . ( c ) Deﬂation scheme applied to an image from Qdots - EGFR on COS - 7 cells . From the raw image ( top left , 3D representation of the ﬂuorescence signal ) , all identiﬁed peaks ( top center , binary map of detections ; top right , Gaussian ﬁts ) are subtracted , providing a ﬁrst deﬂated image ( second row , left image ) . This is repeated as long as peaks are detected . 688 | VOL . 5 NO . 8 | AUGUST 2008 | NATURE METHODS ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s at all time scales from nanoseconds to seconds 14 . There are three possible scenarios : ( i ) the particle may be constantly ‘on’ during one ( or several ) image ( s ) ; ( ii ) it may have blinked ( one or several times ) on time scales smaller than the acquisition time , leading to an intermediate ﬂuorescence intensity ; or ( iii ) the particle may have disappeared , having been turned off ( fully blinked ) during one ( or several ) image ( s ) ( Supplementary Fig . 1 online ) . For a completely ‘on’ particle , the experimental distribution and variability corre - spond to a Gaussian distribution centered on an average intensity / I on S . When particles are partially turned off , we add a second term ( uniform law ) describing the equal probability for all blinking values . The third case ( particle turned off ) has no relevant contri - bution to the likelihood of reconnection as no signal is detected . According to equation 1 , the background of an image is a mix of thermal noise , photon noise and autoﬂuorescence from the sample . It is modeled as independent background m in addition to a Gaussian noise N of unknown power s 2 . The parameters m and s 2 are assumed to be locally constant ( Supplementary Fig . 1 ) . MTT iteratively reconstructs trajectories up to time t ( Fig . 1 ) . Past statistics are used to accurately reconnect trajectories at the next time point , t + 1 . For each trajectory , in addition to the last position , MTT characterizes the parameters of the following prob - ability laws , ( i ) the local diffusion coefﬁcient D local ( Supplementary Table 1 ) , ( ii ) the mean and s . d . of the intensity and ( iii ) the photophysical state relative to blinking ( Supplementary Fig . 1 ) . Exhaustive particle detection and estimation by deﬂation At high particle densities , exhaustive detection is critical as missing or false particles will directly compromise all the later steps in the analysis . Therefore , MTT has to minimize errors . Detection and estimation are completed by a deﬂation loop . Particle detection is classically performed using a bi - dimensional Gaussian approximating the microscope PSF 15 . For each image , ﬁrst , an optimal detection test is applied to screen for the presence of Gaussian peaks . The usual statistical test is a generalized like - lihood ratio test ( GLRT ; Supplementary Note ) . The image inten - sity is analyzed in a sliding window in which the respective probabilities of particle presence ( H 1 ) or absence ( H 0 ) are com - pared , taking into account the image noise : targets are no longer identiﬁed by the ﬂuorescence intensity but by the H 1 / H 0 ratio ( Fig . 2a ) . This ratio is high when peaks are signiﬁcantly separated from noise as evaluated by the algorithm . Awindow size w s of 7 (cid:1) 7 pixels ensures a correct estimation of the background while limiting possible long - range background variations . The accuracy of the decision is set by ﬁxing a constant false - alarm rate . To ensure a probability of false alarm ( PFA peak ) of less than 1 for an image of 512 (cid:1) 512 pixels , we set the GLRTwith a constant PFA peak of 10 (cid:2) 6 . This strategy provides a high conﬁdence level for all detected particles , insuring that they do not arise from the noise . Notably , the PFA peak is independent of the intensity and background , and consequently of the experimental image acquisitions . Finally , w s and PFA peak are the only two parameters required for detection . This step only provides a binary detection . Identiﬁed peaks then need to be properly estimated for each relevant parameter such as intensity , subpixel position , width and offset . They are evaluated by a multi - parametric Gaussian ﬁt on the signal intensity . Filtering tests remove putative aberrant points ( that is , negative intensity or positions out of the sliding window ) . Particles with low intensity can potentially be misdetected owing to neighboring particles of stronger intensity within the window , mainly leading to background overestimation ( Fig . 2b ) . We there - fore carried out a deﬂation process . Starting from P frame particles already detected in the current frame , we subtracted their respective estimated Gaussian peaks from the raw image X in as follows : X out ¼ X in (cid:2) X P frame p ¼ 1 I p (cid:1) G ð i p ; j p ; r p Þ : ð 2 Þ We reiterated the detection and estimation processes on the resulting image ( Fig . 2c ) until we detected only noise , illustrating the efﬁciency of detection . Optimized reconnection using past information We selected an approach that avoids both the limitation of a local strategy and the lengthy computation time of a fully global strategy . For each trajectory , MTT searches either for an association with a particle detected in the subsequent frame or for possible blinking . To limit the factorial growth of the reconnection combinatorics , we T a P 1 T b P 2 T k T a T a T b T k T k P 3 P 1 P 2 P 3 ? T a T a t + 1 t + 1 P 1 P 1 t t Blink of T a T k T b T b T k P 2 P 2 T a T a t + 1 t + 1 P 3 P 3 P 1 P 1 P 2 P 2 t t Blink of T a T k T b T b T k Blink at t + 1 No blink Blink before and at t + 1 Blink before t + 1 a c b T domain > P domain T domain = P domain T domain > P domain T domain < P domain T domain = P domain P 1 P 2 Off New t x y ? ? Figure 3 | Multiple - target reconnection . ( a , b ) MTT searches for the best combinations between T domain known trajectories and P domain peaks detected from the next image , according to descriptors ( I , D and others ) and projected statistics ( d I , d D and others ) . In a , T domain ¼ P domain ( left ) . The particles that belong to the maximum reconnection domain of T k , are expected within a circle of radius R ¼ 3 r max for statistical conﬁdence . This maximum distance between two frames , r max , corresponds to a particle diffusing at D max without any constraint . If T k was previously turned off ( right ) , the domain is increased according to R 2 ¼ ( 3 r max ) 2 t off , with t off being the number of elapsed frames since the particle turned off . In b , T domain 4 P domain owing to particles blinking at t + 1 ( or T domain o P domain , for particles appearing ; data not shown ) , with the possibility of past blinking ( right ) . ( c ) Combinatorics of the maximum - likelihood reconnection test . NATURE METHODS | VOL . 5 NO . 8 | AUGUST 2008 | 689 ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s restricted the set to trajectories and particles with sufﬁcient reconnection probabilities . Conﬂicts between trajectories are then optimally resolved using statistical information from each trajectory . For each trajectory T k , a reconnection domain was deﬁned by the area potentially explored by a particle after one time lag . To delineate the domain , we assume a Brownian motion with a maximum diffusion coefﬁcient D max . This provides a limit for reconnection without making assumptions about the real diffusion mode of the particles . Thus , the domain is a disk , deﬁned by a probability law , which is a bidimensional Gaussian with a s . d . r max . A cutoff set at 3 r max ensures 99 % conﬁdence of ﬁnding particles ( Supplementary Fig . 2 and Supplementary Video 1 online ) . In the most favorable case , the reconnection is unambiguous with only one peak within an isolated reconnection domain . However , when trajectories are crossing , conﬂicting overlap may occur between reconnection domains sharing at least one particle . Thus , MTT evaluates the probability of each possible combination attributing T domain trajectories to P domain particles , including possible blinking . In the simplest case where T domain ¼ P domain ( Fig . 3a ) , T k will not blink ( or will turn on again ) at time t + 1 . If T domain 4 P domain ( Fig . 3b ) , one or more candidate trajectories blink at time t + 1 . On the contrary , T domain o P domain signiﬁes that new trajectories appear . In all cases , we consider that blinking , acting on all time scales , will occur with the same probability for all particles . MTT then validates the most probable reconnection among all possible combinations ( Fig . 3c ) . Starting from a set of particles and trajectories , MTT searches for the best combination based on a comparison of probabilities between each ( T i , P j ) association . The probability of each association is the product of the statistics computed for their respective positions , intensities and blinking . Here the descriptors of trajectories are not built only from the last frame . Instead , the use of several frames allows an evaluation of their probability laws . To handle possible variations over time , all descriptors are estimated within a sliding temporal window ( t – w t , t ) and readjusted at each iteration . A length w t ﬁxed at 5 frames ensures a balance between the precision of parameter estimation ( that is , D local ) and sensitivity to its temporal variation ( that is , transient conﬁnement ) . MTT assigns default typical statis - tical values to initiate reconnection ( from frame 1 to w t ) until past information is available . This does not strongly affect the accuracy of the results as trajectories are long enough ( 230 frames on average ) compared to w t ( 5 frames ) . As reconnection requires information about peak positions , it directly beneﬁts from the detection efﬁ - ciency . Reciprocally , reconnection strengthens detection efﬁciency by validating potential new trajectories . Indeed , peaks are ﬁrst detected with a PFA peak of 10 (cid:2) 6 , which avoids missing particles . Then , for un - reconnected , orphan peaks , another run of detection is performed with a more stringent PFA orphan of 10 (cid:2) 7 to provide conﬁdence in putative new trajectories as done for the initial frame . The informative descriptors used for the reconnection test are deﬁned as follows : ( i ) a local diffusion characterized with minimal assumption on the mode of diffusion and without excluding possible abrupt variations . The subsequent law adds two probabil - ities accounting for local and maximum ( unconstrained ) diffu - sions , respectively ; ( ii ) an intensity law taking into account blinking ( Supplementary Fig . 1 ) ; and ( iii ) a disappearance probability for trajectories ended owing to long - lasting blinking or particle leaving the image ﬁeld , deﬁned by an exponential decay t off , with a threshold set at 3 t off to stop reconnection . Considering each physical phenomenon as independent , the global likelihood is the product of the probabilities associated with each phenomenon ( Supplementary Note ) . Evaluation of MTT sensitivity and reliability We validated the MTT input parameters using simulated data to benchmark the performance of MTT at each step ( detection , estimation , reconnection ) . As ﬂuorescence signals are spread over a large range of intensities , a decibel scale was more appropriate . The a b c Figure 4 | Performances of the deﬂation algorithm for detection , estimation and reconnection . ( a ) Percentage of detected peaks ( with correct estimation ) , relative to initial peak density , according to SNR ( left ) and peak density theoretical or measured , using deﬂation or not ( SNR ¼ 30 dB ; right ) . Images correspond to Monte Carlo simulations with varying SNR or peak density ( percent peak per pixel , in 100 (cid:1) 100 pixel images , at PFA peak ¼ 10 (cid:2) 6 ) . ( b ) Maximum - likelihood localization accuracy for increasing SNR , as compared to a three - point estimator and the theoretical limit given by Fisher coefﬁcients and associated Cramer - Rao bound ( CRB ) to determine estimation efﬁciency . Location accuracy in the shaded area was no longer optimal with respect to the CRB . ( c ) Reconnection efﬁciency of MTT performed with or without deﬂation ( left ) or applied to free , conﬁned by domains or anomalous diffusion ( right ) for increasing peak density ( SNR ¼ 30 dB ) . The error by trace is evaluated by comparing the input ( simulated ) and output ( reconnected ) trajectories . This was ultimately checked by direct visual inspection . 690 | VOL . 5 NO . 8 | AUGUST 2008 | NATURE METHODS ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s fraction of detected peaks was close to 100 % ( probability of peak detection , PD peak E 1 ) for SNR higher than B 20 dB ( Fig . 4a ) . This threshold was consistent with the typical experimental values of 20 – 35 dB ( Supplementary Fig . 1 ) . Detection was also weakly sensitive to the peak density ( Fig . 4a ) . The deﬂation increased the detection efﬁciency , substantially approaching the theoretical diffraction limit ( Supplementary Note ) even for densities as high as 10 % ( 10 peaks per 10 (cid:1) 10 pixels ) . The error on location ( B 0 . 04 pixel ¼ 6 nm ) was optimal for all detected particles ( down to B 20 dB ) , reaching the theoretical detection limit ( Fig . 4b and Supplementary Note ) . For comparison , a three - point estimator 16 appeared inadequate , because its location accuracy was already degraded at 30 dB . Signal integration by the CCD pixels , not included in the model , had almost no effect on location precision ( data not shown ) 17 . We estimated the tracing accuracy for increasing peak density . Deﬂation substantially improved the accuracy , which was robust with regard to the underlying diffusion model ( Fig . 4c ) . Notably , by reducing the number of critical issues and better handling the remaining ones , MTT is less likely to create artifactual reconnections to nearest neighbors . Use of past statistics is also helpful to adequately resolve crossing particle trajectories ( Supplementary Fig . 2 ) . Detection of conﬁnement Membrane dynamics are expected to involve an interchange of Brownian diffusion and conﬁnement in subdomains 1 , 4 . We there - fore detected conﬁned events on each trajectory according to the equations presented in references 18 – 22 . We computed conﬁne - ment level L conf as : L conf ¼ D max (cid:1) w conf = var ð r Þ ; ð 3 Þ where D max is the unconstrained diffusion coefﬁcient ( 0 . 2 m m 2 / s for EGFR ) and var ( r ) is the variance of the displacements within a b x y Log ( L conf ) x y a 18 s 2 s 14 s 10 s 6 s 22 s 26 s 30 s 34 s c 1 2 x position ( µm ) y po s i t i on ( µ m ) Free Confined 1 0 . 5 0 0 0 . 5 1 1 . 5 2 2 . 5 t = 0 L c on f Time ( s ) D l o c a l ( µ m ² / s ) 10 0 10 2 10 4 0 2 4 6 8 10 10 – 4 10 – 2 10 0 Log ( L c on f ) 0 Figure 5 | Detection and mapping of conﬁnement at the cell membrane . ( a ) Typical EGFR trajectory alternating between free and conﬁned events , with corresponding conﬁnement level L conf ( middle ; threshold depicted by the orange dotted line ) and local diffusion D local ( bottom ) . ( b ) Cell map with trajectories ( n ¼ 1 , 200 ) encoded in two colors as in a ( left ) and a close - up of the boxed area ( right ) . A 3D view of the spatial variations of L conf of the trajectories is shown below . Each step , free or conﬁned , was replaced by its mean ( x , y , log ( L conf ) ) value , interpolated with Matlab . Color - scale highlights the conﬁnement strength . ( c ) Time - series showing the evolution of the dynamic map , pseudocolored as in b ( Supplementary Videos 2 and 3 ) . Although some conﬁned areas remain stable ( arrow ) , others ﬂuctuate over time ( arrowhead ) . Scale bars , 10 m m . NATURE METHODS | VOL . 5 NO . 8 | AUGUST 2008 | 691 ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s sliding temporal window of length w conf ( Supplementary Table 1 ) . A length w conf of 4 frames is both short enough to detect transient conﬁnement and long enough to ensure a reliable detection . Conﬁnement can be statistically assessed when L conf remains over the threshold L min for a sufﬁcient time t min ( Fig . 5a ) . Using simulated data , we aimed to identify threshold values that minimize false detections ( low PFA conf ) without decreasing the identiﬁcation of true conﬁnement ( high PD conf ) . A robust method to objectively set the conﬁnement thresholds is to perform a receiver operating characteristics analysis ( Supplementary Fig . 3 online ) : the values maximizing the global score PD conf (cid:1) ( 1 – PFA conf ) were 5 for L min and 3 frames for t min . Hence , PD conf can be kept high ( 0 . 78 ) and PFA conf reasonably low ( 0 . 025 ) . Notably , as these values came from stable parts of the curves , they have little impact on the overall detection efﬁciency . We evaluated conﬁnement detection against various models : transient slowdown , permeable domains , anomalous diffusion or free diffusion ( Supplementary Fig . 4 online ) . Our conﬁnement detector searched for local disparities instead of global , large - scale variations as for anomalous diffusion . Consistent with this hypoth - esis , MTT detected slowdowns and domains better than anomalous behavior , which rendered results comparable to free diffusion . Cartography of EGFR dynamics in live cells We tested the principle of cartography by generating a snapshot of the membrane dynamics for the EGFR at the surface of live COS - 7 cells . We projected up to 1 , 200 trajectories with B 230 frames on average recorded over a short period of time ( 10 s , 300 frames / stack ) onto the differential interference contrast image of the cell ( Fig . 5b ; pixel size 160 nm ) . In a static three - dimensional ( 3D ) representation , the peak height equals the strength of conﬁnement , whereas valleys relate to few or no conﬁnement ( Fig . 5b ) . For a more dynamic view , we investigated the conﬁnement frame by frame over longer periods of time ( Fig . 5c , and Supplementary Videos 2 and 3 online ) . This temporal analysis simultaneously revealed stable and evanescent conﬁned areas . We also noticed rare linear motion ( o 2 % ) , as expected for endocytic vesicles 23 . We observed transitions between various regimes of diffusion , characterized by a wide range in duration ( 0 . 1 – 10 s ) , size ( 0 . 01 – 1 m m ) and strength ( 1 – 100 ) ( Fig . 6a and Supplementary Fig . 3 ) . These values corroborate the transient conﬁnement zones observed using a similar conﬁnement detection method 18 for a glycosyl - phosphatidylinositol – anchored protein Thy1 and a glycosphingo - lipid , GM1 . Compared to free - diffusion events , conﬁned periods are characterized by smaller submicrometer sizes ( 70 ± 1 nm , n ¼ 5 cells ) , although with similar subsecond duration ( 250 ± 15 ms ) . The fraction of conﬁned time accesses the fraction a conf of conﬁned receptors ( 0 . 40 ± 0 . 05 ) . Similarly , the fraction of conﬁned area was 0 . 08 ± 0 . 02 . We next quantiﬁed the conﬁnement diversity using statistic descriptors of conﬁnement levels calculated from the values displayed in the movies . A dot plot of variance - to - mean ratio ( VMR ) versus mean revealed a broad distribution of both descrip - tors ( Fig . 6b ) . Regimes continuously ranged from free diffusion ( low mean ) to high conﬁnements ( high mean ) , both of which were stable over time ( low VMR ) . However , most events displayed intermediate conﬁnement with high VMR , suggesting dynamic structures . We located these different regimes by mapping the descriptors in color - encoded maps ( Fig . 6c ) . The dynamics of conﬁnement structures can also be assessed by determining their stability over time . A straightforward evaluation is to quantify the revisit frequency of conﬁned areas . Counting the number of conﬁned events associated to each pixel revealed highly revisited areas ( Fig . 6c ) . Considering variance , frequently revisited areas mostly correlated with intermediate conﬁnement . We probed a 1 , 500 4 , 000 2 , 000 0 200 100 4 Time lag ( s ) 2 0 400 0 . 04 0 . 02 0 200 0 0 750 F r equen cy F r equen cy V M R F r equen cy M S D ( µ m 2 ) F r equen cy M S D ( µ m 2 ) 010 – 1 10 – 1 10 0 10 0 Free events duration ( s ) Confinement events duration ( s ) Confinement zones radius ( µ m ) Time lag ( s ) Free zones radius ( µ m ) < τ free > = 280 ms < τ conf > = 250 ms < R free > = 150 nm < R conf > = 70 nm < D conf > = 0 . 007 µ m 2 / s < D free > = 0 . 21 µ m 2 / s 10 1 10 1 0 . 3 0 . 2 0 . 1 0 . 4 0 . 8 Mean log ( L conf ) Mean log ( L conf ) VMR 0 0 . 5 1 . 5 0 0 . 1 0 . 2 0 . 3 510 20 30 40 50 60 1 2 Number of revisits 1 . 2 1 . 6 2 . 0 0 0 10 – 2 10 – 2 10 – 1 10 – 1 10 0 10 0 0 1 2 3 0 1 2 3 a b c Figure 6 | Conﬁnement quantiﬁcation . ( a ) Histograms of durations ( left ) , sizes ( middle ) and mean square displacement ( right ) of free diffusive and conﬁned events ( geometric mean values , n ¼ 3 cells ) . ( b ) VMR versus mean conﬁned levels , as calculated for each pixel over all frames . Arrow , arrowhead and double arrow indicate free , intermediate - dynamic and stable conﬁned events , respectively ( Fig . 5c ) . ( c ) Maps of mean ( left ) and VMR ( middle ) of conﬁned level and number of revisits within conﬁned zones ( right ) for a stack of 1 , 000 frames . Revisit numbers below 5 were discarded as insigniﬁcant ( Supplementary Note ) . Lower maps are maps of the the area framed in the ﬁrst image ( Supplementary Videos 2 and 3 ) . Arrows and arrowheads correspond to typical behaviors , as in b . Scale bars , 10 m m . 692 | VOL . 5 NO . 8 | AUGUST 2008 | NATURE METHODS ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s representative population of EGFR ( B 1 % ) . Thus , a rate of 50 visits within a 36 - s recording ( 1 . 4 visits / s ) would correspond for the whole population to more than 100 visits / s . This conﬁrms sub - second dwell time ranges ( o 10 ms ) for the most dynamic events . This representation of conﬁnement relies on spatiotemporal characteristics , resulting from the density of targets and the overall exposure time ( camera readout ) . Both parameters must balance experimental limitations and biological relevance . We therefore made measurements at increased acquisition speed ( Supplementary Fig . 5 online ) . MTT remained efﬁcient down to 5 ms / frame , with an acceptable SNR ( B 25 dB ) , allowing valuable investigations . DISCUSSION Single EGFR tracking has previously been performed to study signal transduction 10 , 24 and membrane dynamics 25 . The EGFR cartography built using MTT provides a global view of molecular dynamics . Notably , the statistics built from individual observations are in excellent agreement with SPT 25 . This demonstrates that , on top of providing a snapshot of the spatiotemporal dynamics of large cell membrane areas , each trajectory is accurately reconnected by MTT . Conﬁnement owing to submembrane cytoskeletal fences 6 , 26 , lipid domains 6 , 27 and direct 19 or long - range 28 protein interactions is a major factor of membrane organization 1 , 4 . Our measurements reveal a partial conﬁnement into sub - micrometer domains , consistent with transient conﬁnement zones 18 , reminis - cent of a preferential partition in lipid - dependent domains 29 , 30 . Notably , the conﬁnement proﬁle presents a broad distribution of strength ( Supplementary Fig . 3 ) . This may reﬂect an underlying diversity and complexity of conﬁning processes . Nevertheless , this apparent diversity may also arise from a large spread of afﬁnities , leading to a large distribution of escape times 21 . Owing to our higher spatiotemporal resolution , the observations for EGFR on conﬁnement sizes , dwell times and mean square displacement reﬁne previous SPT observations 25 . We found transient conﬁne - ment ( B 250 ms ) into small domains ( o 100 nm ) ( Fig . 6 ) , which are consistent with local measurements obtained by FCS ( F . Conchonaud & D . M . , unpublished data ) . For conﬁned events , the mean square displacement consistently displays a negative deviation 1 . The decrease in diffusion directly relates to the local viscosity . The biochemical nature of the underlying heterogeneities could derive from coexisting lipid - dependent and actin - mediated domains . EGFR transient conﬁnement was as efﬁciently modeled by alternating fast and slow diffusion as by permeable domains , in agreement with either dynamic partition or corralling . Possible anomalous diffusion could be investigated by a generalized approach to detect putative obstacles at various length scales . This would further minimize our initial assumptions for the conﬁnement detection as described for the detection , evaluation and reconnection steps . This project is ultimately aimed at elucidating how the dynamic organization of the plasma membrane inﬂuences cellular responses . This requires improving performance related to the two major SPT limitations 7 : the acquisition speed ( relates to SNR ) , and single - ﬂuorophore discrimination ( particle density ) ( Fig . 4 ) . Fast SPT acquisition is critical for inherently fast movements like lipid diffusion 27 , rapid transient conﬁnement 26 and 3D motion such as virus trafﬁcking 31 . MTT has proven to be sensitive at fairly low SNR , allowing working with reduced light intensity ( limited photodamage ) , less bright dyes , or increased acquisition speed ( Supplementary Fig . 5 ) . Evaluating tracking performances is linked to the biological question . For instance , a minimal length of errorless trajectories is required to discriminate anomalous diffusion from conﬁnement . The ultimate limitation will occur at the transition between individual labeling and uniform staining corresponding to a density of B 10 % , when ﬂuorescent peaks start to strongly overlap ( Supplementary Note ) . This theoretical limit can be tackled considering new photoactivation - based techniques ( photoactivation localization microscopy ( PALM ) , ﬂuorescence PALM ( FPALM ) and stochastic optical reconstruction microscopy ( STORM ) ) 32 offering a promising alternative for exhaustive and resolved imaging . With sptPALM 33 , substantial improvement in the rate of imaging ( 20 frames / s ) allowed tracking of photo - activated molecules appearing during the course of hundreds of seconds . A diffusion map of membrane proteins has similarly been established based on the longest trajectories ( 4 15 frames ) , which represent 3 % of all molecules 33 . Using a more conventional setup , MTT provides a robust and complementary analytical tool for reﬁned diffusion analysis . Additional developments , including multicolor imaging , will expand MTT to a new spectral dimension . Simultaneous in situ measurements of different signal transduction partners will enable investigation into spatiotemporal distributions and kinetic interactions . This new and sensitive approach will provide a detailed view of membrane dynamics , linking local characteristics and heterogeneities with physiological implications . METHODS Software . We analyzed the data by custom algorithms written with Octave ( GNU ) and Matlab ( MathWorks ) . A detailed description of the MTT algorithm is available in the Supplementary Note . The source code of the MTT software is available online ( http : / / www . ciml . univ - mrs . fr / lab / he - marguet . htm ) ; academic and nonproﬁt use is free of charge . Additional methods . Methods for Monte Carlo simulations , cell culture , Qdot staining , and equipment and settings are available in Supplementary Methods online . Note : Supplementary information is available on the Nature Methods website . ACKNOWLEDGMENTS We thank H . T . He , L . Leserman , P . Re´fre´gier , F . Conchonaud , S . Mailfert and M . Fallet for helpful discussions and suggestions , and E . Witty ( AngloScribe ) for language editing . This project was supported by grants from Institut National de la Sante´ et de la Recherche Me´dicale , Centre National de la Recherche Scientiﬁque , Agence Nationale de la Recherche and European regional development fund . AUTHOR CONTRIBUTIONS H . R . and D . M . designed the research ; A . S . and N . B . performed the research , developed new analytical tools and analyzed data ; A . S . and D . M . wrote the paper . Published online at http : / / www . nature . com / naturemethods / Reprints and permissions information is available online at http : / / npg . nature . com / reprintsandpermissions / 1 . Saxton , M . J . & Jacobson , K . Single - particle tracking : applications to membrane dynamics . Annu . Rev . Biophys . Biomol . Struct . 26 , 373 – 399 ( 1997 ) . 2 . Lippincott - Schwartz , J . , Altan - Bonnet , N . & Patterson , G . H . Photobleaching and photoactivation : following protein dynamics in living cells . Nat . Cell Biol . 5 ( Suppl . ) , S7 – S14 ( 2003 ) . 3 . Lommerse , P . H . , Spaink , H . P . & Schmidt , T . In vivo plasma membrane organization : results of biophysical approaches . Biochim . Biophys . Acta 1664 , 119 – 131 ( 2004 ) . NATURE METHODS | VOL . 5 NO . 8 | AUGUST 2008 | 693 ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s 4 . Marguet , D . , Lenne , P . F . , Rigneault , H . & He , H . T . Dynamics in the plasma membrane : how to combine ﬂuidity and order . EMBO J . 25 , 3446 – 3457 ( 2006 ) . 5 . Wawrezinieck , L . , Rigneault , H . , Marguet , D . & Lenne , P . F . Fluorescence correlation spectroscopy diffusion laws to probe the submicron cell membrane organization . Biophys . J . 89 , 4029 – 4042 ( 2005 ) . 6 . Lenne , P . F . et al . Dynamic molecular conﬁnement in the plasma membrane by microdomains and the cytoskeleton meshwork . EMBO J . 25 , 3245 – 3256 ( 2006 ) . 7 . Meijering , E . , Smal , I . & Danuser , G . Trackinginmolecularbioimaging . IEEESignal Process . Mag . 23 , 46 – 53 ( 2006 ) . 8 . Michalet , X . et al . Quantum dots for live cells , in vivo imaging , and diagnostics . Science 307 , 538 – 544 ( 2005 ) . 9 . Dahan , M . et al . Diffusion dynamics of glycine receptors revealed by single - quantum dot tracking . Science 302 , 442 – 445 ( 2003 ) . 10 . Lidke , D . S . et al . Quantum dot ligands provide new insights into erbB / HER receptor - mediated signal transduction . Nat . Biotechnol . 22 , 198 – 203 ( 2004 ) . 11 . Schmidt , T . , Schutz , G . J . , Baumgartner , W . , Gruber , H . J . & Schindler , H . Imaging of single molecule diffusion . Proc . Natl . Acad . Sci . USA 93 , 2926 – 2929 ( 1996 ) . 12 . Kalaidzidis , Y . Intracellularobjectstracking . Eur . J . Cell Biol . 86 , 569 – 578 ( 2007 ) . 13 . Schlessinger , J . Ligand - induced , receptor - mediated dimerization and activation of EGF receptor . Cell 110 , 669 – 672 ( 2002 ) . 14 . Tang , J . & Marcus , R . A . Mechanisms of ﬂuorescence blinking in semiconductor nanocrystal quantum dots . J . Chem . Phys . 123 , 054704 ( 2005 ) . 15 . Cheezum , M . K . , Walker , W . F . & Guilford , W . H . Quantitative comparison of algorithms for tracking single ﬂuorescent particles . Biophys . J . 81 , 2378 – 2388 ( 2001 ) . 16 . Bonneau , S . , Dahan , M . & Cohen , L . D . Single quantum dot tracking based on perceptual grouping using minimal paths ina spatiotemporal volume . IEEE Trans . Image Process . 14 , 1384 – 1395 ( 2005 ) . 17 . Ober , R . J . , Ram , S . & Ward , E . S . Localization accuracy in single - molecule microscopy . Biophys . J . 86 , 1185 – 1200 ( 2004 ) . 18 . Dietrich , C . , Yang , B . , Fujiwara , T . , Kusumi , A . & Jacobson , K . Relationshipoflipid rafts to transient conﬁnement zones detected by single particle tracking . Biophys . J . 82 , 274 – 284 ( 2002 ) . 19 . Meier , J . , Vannier , C . , Serge , A . , Triller , A . & Choquet , D . Fast and reversible trapping of surface glycine receptors by gephyrin . Nat . Neurosci . 4 , 253 – 260 ( 2001 ) . 20 . Meilhac , N . , LeGuyader , L . , Salome , L . & Destainville , N . Detectionofconﬁnement and jumps in single - molecule membrane trajectories . Phys . Rev . E 73 , 011915 ( 2006 ) . 21 . Saxton , M . J . Single - particle tracking : effects of corrals . Biophys . J . 69 , 389 – 398 ( 1995 ) . 22 . Simson , R . , Sheets , E . D . & Jacobson , K . Detection of temporary lateral conﬁnement of membrane proteins using single - particle tracking analysis . Biophys . J . 69 , 989 – 993 ( 1995 ) . 23 . Wiley , H . S . Trafﬁcking of the ErbB receptors and its inﬂuence on signaling . Exp . Cell Res . 284 , 78 – 88 ( 2003 ) . 24 . Teramura , Y . etal . Single - moleculeanalysisofepidermalgrowthfactorbindingon the surface of living cells . EMBO J . 25 , 4215 – 4222 ( 2006 ) . 25 . Orr , G . et al . Cholesterol dictates the freedom of EGF receptors and HER2 in the plane of the membrane . Biophys . J . 89 , 1362 – 1373 ( 2005 ) . 26 . Kusumi , A . et al . Paradigm shift of the plasma membrane concept from the two - dimensionalcontinuumﬂuidtothepartitionedﬂuid : high - speedsingle - molecule trackingofmembranemolecules . Annu . Rev . Biophys . Biomol . Struct . 34 , 351 – 378 ( 2005 ) . 27 . Schutz , G . J . , Kada , G . , Pastushenko , V . P . & Schindler , H . Properties of lipid microdomains in a muscle cell membrane visualized by single molecule microscopy . EMBO J . 19 , 892 – 901 ( 2000 ) . 28 . Daumas , F . et al . Conﬁned diffusion without fences of a g - protein - coupled receptor as revealed by single particle tracking . Biophys . J . 84 , 356 – 366 ( 2003 ) . 29 . Puri , C . et al . Relationships between EGFR signaling - competent and endo - cytosis - competent membrane microdomains . Mol . Biol . Cell 16 , 2704 – 2718 ( 2005 ) . 30 . Yamabhai , M . & Anderson , R . G . Second cysteine - rich region of epidermal growth factor receptor contains targeting information for caveolae / rafts . J . Biol . Chem . 277 , 24843 – 24846 ( 2002 ) . 31 . Seisenberger , G . et al . Real - time single - molecule imaging of the infection pathway of an adeno - associated virus . Science 294 , 1929 – 1932 ( 2001 ) . 32 . Moerner , W . E . Single - molecule mountains yield nanoscale cell images . Nat . Methods 3 , 781 – 782 ( 2006 ) . 33 . Manley , S . et al . High - density mapping of single - molecule trajectories with photoactivated localization microscopy . Nat . Methods 5 , 155 – 157 ( 2008 ) . 694 | VOL . 5 NO . 8 | AUGUST 2008 | NATURE METHODS ARTICLES © 200 8 N a t u r e P ub li s h i ng G r oup h tt p : / / www . n a t u r e . c o m / n a t u r e m e t hod s
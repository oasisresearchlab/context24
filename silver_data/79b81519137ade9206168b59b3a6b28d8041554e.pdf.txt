© 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol 2054 | VOL . 10 NO . 12 | 2015 | nature protocols IntroDuctIon Development of the protocol Proteins in living cells are highly dynamic , and they usually do not remain in a single place for very long . Understanding their dynamics provides crucial information for deciphering the mechanistic basis of how proteins facilitate cell function . Conventional ensemble experiments measure large numbers of molecules simultaneously and average their movements , result - ing in the potential loss of information . With the development of new imaging techniques , single - molecule imaging methods have evolved into powerful tools to detect and characterize the complex behavior of different molecules inside living cells . This has enabled the examination of molecular structure , dynamics and function , which reveals information that would have been lost in ensemble averages . To study the molecular mechanisms responsible for protein dynamics , single - particle tracking ( SPT ) has been widely used to capture the full spatiotemporal complex - ity of the behavior of single particles , including single protein molecules , multisubunit proteins and protein complexes . SPT enables researchers to determine the number of subunits in mem - brane proteins by counting the discrete photobleaching steps of single fluorescent particles . One approach for SPT uses TIRFM to visualize molecules tagged with fluorescent markers . This method limits background noise to favor signals coming from the plasma membrane and the cortical cytoplasm . Despite its advantages , SPT faces several challenges , including the detection and localization of particles in a sequence of images , and tracking a large number of particles for statistical analysis . SPT in plant cells in particular faces the challenge of discerning the specific signal from the background autofluorescence , as plant cells exhibit higher background than mammalian cells . In addi - tion , heterogeneous and high expression levels of fluorescently tagged proteins in each individual experiment can lead to the occasional overlap of fluorescent signals . In regard to the analysis of subunit stoichiometry , each fluorescent protein has a certain probability of maturation , and therefore the distribution of the number of photobleaching steps should be fitted with a bino - mial distribution . In practice , investigators often encounter obstacles that render the application of computational image processing for single - molecule studies far from routine . To circumvent these obstacles in our own work , we used previously published computational tools for high - speed SPT and subunit counting in living plant cells . We applied a multiple particle - tracking algorithm , described by Jaqaman et al . 1 , to provide an accurate solution to the tracking challenges . Moreover , we used the fluoroBancroft algorithm 2 for subunit counting , which provides reliable results for signals that are poorly characterized or sensitive to the scattering that occurs in plant tissues . Through implementing these methods , we were able to investigate membrane protein dynamics and subunit stoi - chiometry in living plant cells 3 – 7 . This protocol describes steps for the preparation of plant tissue for TIRF microscopy , imaging and data analysis using the described algorithms . Overall , this approach allows for tracking and counting the subunits in single particles , allowing us to address challenging and fundamental questions regarding the nature of the molecular and cellular mechanisms . Applications of the method We have obtained convincing results using this protocol to analyze dynamics , diffusion and oligomerzation of plasma membrane channels , transporters and membrane - bound proteins , and also to track and analyze vesicles internalized during endocytosis 3 – 7 . We found that PIP2 ; 1 ( an aquaporin involved in water transport across the plasma membrane ) molecules are heterogeneously distrib - uted on plasma membrane microdomains and that clathrin - and Single - molecule fluorescence imaging to quantify membrane protein dynamics and oligomerization in living plant cells Xiaohua Wang 1 , 4 , Xiaojuan Li 2 , 4 , Xin Deng 1 , Doan - Trung Luu 3 , Christophe Maurel 3 & Jinxing Lin 2 1 Key Laboratory of Plant Resources , Institute of Botany , Chinese Academy of Sciences , Beijing , China . 2 Key Laboratory for Genetics and Breeding of Forest Trees and Ornamental Plants , Ministry of Education , College of Biological Sciences and Technology , Beijing Forestry University , Beijing , China . 3 Biochimie et Physiologie Moléculaire des Plantes , Institut de Biologie Intégrative des Plantes , Unité Mixte de Recherche ( UMR ) 5004 Centre National de la Recherche Scientifique ( CNRS ) UMR 0386 Institut National de la Recherche Agronomique / Montpellier SupAgro / Université Montpellier 2 , Montpellier , France . 4 These authors contributed equally to this work . Correspondence should be addressed to J . L . ( linjinxing @ bjfu . edu . cn ) . Published online 19 November 2015 ; doi : 10 . 1038 / nprot . 2015 . 132 Measuring the mobility and interactions of proteins is key to understanding cellular signaling mechanisms ; however , quantitative analysis of protein dynamics in living plant cells remains a major challenge . Here we describe an automated , single - molecule protocol based on total internal reflection fluorescence microscopy ( tIrFM ) imaging that allows protein tracking and subunit counting in living plant cells . this protocol uses tIrFM to image transgenic plant tissues expressing fluorescently tagged proteins that are localized to the plasma membrane . next , a tracking algorithm quantifies dynamic changes in fluorescent protein motion types , temporary particle displacement and protein photobleaching steps . this protocol allows researchers to study the kinetic characteristics of heterogeneously distributed proteins . the approach has potential applications for studies of protein dynamics and subunit stoichiometry for a wide variety of plasma membrane and intracellular proteins in living plant cells and other biological specimens visualized by tIrFM or other fluorescence imaging techniques . the whole protocol can be completed in 5 – 6 h . © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol nature protocols | VOL . 10 NO . 12 | 2015 | 2055 microdomain - associated endocytosis cooperatively mediate the subcellular trafficking of PIP2 ; 1 ( ref . 4 ) . Furthermore , our study on the behavior of AMT1 ; 3 ( an ammonium transporter involved in ammonium uptake from soil ) molecules revealed that the clustering and endocytosis of AMT1 ; 3 is an effective mechanism to avoid accumulation of toxic levels of ammonium by elimi - nating active AMT1 ; 3 from the plasma membrane 6 . Recently , we demonstrated trafficking of microdomain - associated respiratory burst oxidase - D ( RbohD ) spots at the membrane , which indicated a high level of heterogeneity , and that these dynamics relate to RbohD activity 7 . In addition , we have successfully determined the stoichiometry of the AtPIP2 ; 1 aquaporin ( tetrameric ) 4 and the AtAMT1 ; 3 ammonium transporter ( trimeric ) 6 . Root cells were used for these analyses , but this tracking and analysis protocol has also worked well for samples from leaves 7 , hypocotyl 4 , root hairs 6 and pollen tubes . Comparison with other methods Different methods designed to monitor single - particle dynamics have provided valuable information on cell physiology and bio - logical processes by revealing the core cellular events and dynam - ics of molecular species . Up to now , several alternative software tools have been available for particle tracking ; these tools gener - ally involve two steps : ( i ) the algorithm uses specific criteria to detect the particle from the background , which provides the coor - dinates of the particle in every frame of the image sequence , and ( ii ) the algorithm uses another set of criteria to track the detected particles from frame to frame . These two steps are commonly performed once , but they can also be applied iteratively . Different algorithms have been developed for both of these steps 8 , 9 , which leads to the question of how to distinguish and evaluate these algorithms under different experimental condi - tions . For example , approaches to link detected particles ( the sec - ond step described above ) range from simple nearest - neighbor models to multiframe assignment including multiple hypothesis tracking ( MHT ) 1 and dynamic programming 10 , with or without motion propagation ( Kalman filtering ) 11 . Although no single method has performed best across all the scenarios , knowing the limitations of each method provides vital information for plan - ning experimental approaches . The performance of the tracking algorithm defines the fundamental performance limit of SPT methods . Therefore , any shortcomings are of particular concern since the advent of low signal - to - noise ratio ( SNR ) methods , which observe fluorescent molecules with an intensified charge - coupled device ( CCD ) camera . Accurate tracking of dynamic targets generally requires the use of multiple Kalman filter models . In brief , multiobject tracking algorithms use the Kalman filter for each particle to project the continuation of its track into the next frame , given its history of motion . The assignment of the projected particle positions to the positions of detected particles in that frame then uses mini - mization of the joint cost of all assignments . The widely used method of MHT provides the best current solution to the mul - tiobject tracking problem 12 . However , the main difficulty with methods based on MHT algorithms is the combinatorial expan - sion of hypotheses for particles that are close to each other—for example , in particles that are present at high density . The largest nonconflicting ensemble of paths is then chosen as the solution , where nonconflicting means that two paths never share the image of the same particle in any frame . Clearly , in SPT applications , MHT is computationally prohibitive , owing to the cost induced by the high number of particles that need to be tracked in single - molecule experiments . Therefore , heuristic algorithms have been proposed to offer a powerful and flexible paradigm by circum - venting limitations in conventional MHT solutions . Limitations in image acquisition and fluctuations of fluo - rescence in living cells may prevent some particles from being captured and resolved at some time points . The particles may enter or exit the field of view ( for example , by moving out - of - focus ) or , for particles at relatively high densities , merge ( i . e . , two particles approach each other within distances below the resolution limit , so that they merge into a single spot ) and split ( two unresolved particles in one frame diverge to resolvable dis - tances in the next frame ) 8 . Recent studies have reported progress on the ranked assign - ment approach to MHT 9 , 11 , but the interpretation of trajectories still relies on simulations , until robust algorithms are produced . Jaqaman et al . 1 introduced an efficient assignment algorithm that implemented a highly optimized version of the MHT method 1 , based on the Jonker - Volgenant 13 algorithm for the linear assign - ment problem . Another approach for single - molecule analysis in plant cells uses a Bayesian segmentation - based feature - detection algo - rithm 14 , 15 to analyze single - molecule image sequences . However , the Bayesian multitarget tracking method relies on the hypothesis that a target can generate at most one measurement per scan . When tracking a large number of deformable sources , the hypoth - esis for the Bayesian multitarget tracking method is often not met , which causes this method to fail . In addition , manual tracking can be performed using imaging software such as ImageJ to analyze the dynamics of plant proteins through manual segmentation and quantification 16 , 17 . Therefore , we have used the multiple - particle tracking algo - rithm by Jaqaman et al . 1 for our single - molecule analysis in living plant cells . This approach can simultaneously track high - density particles and characterize heterogeneous particle motion , particle interactions ( merging and splitting ) or temporary disappearance ( e . g . , blinking ) , and therefore it provides a feasible method to reveal subunit stoichiometry . Experimental design Choice of fluorescent marker for single - particle analysis . GFP and its derivatives , such as CFP and YFP , tend to form dimers 18 . Therefore , if possible , it is preferable to use monomeric substi - tution ( A206K ) GFP ( mGFP ) to prevent artificial oligomeriza - tion , via intermolecular disulfide bonds , between GFP molecules . Other monomeric versions of fluorescent proteins ( e . g . , mEosFP , Dendra , mRFP , mKate and mCherry ) can also be chosen for single - particle analysis in living cells . Preparation and processing of images . Before image acquisi - tion , laser power should be adjusted to the minimum density to sufficiently visualize single molecules in order to minimize photobleaching and to avoid cellular damage . Moreover , the EM gain of the CCD camera should be adjusted to yield an optimal signal - to - background ratio . To achieve relatively fast time resolu - tion , and to avoid significant blur resulting from the motion of the particles , a reduced area of the image field and shorter exposure © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol 2056 | VOL . 10 NO . 12 | 2015 | nature protocols time are preferably used . The raw image data should be stored in a TIFF format and subsequently analyzed using this software described in this protocol . This protocol assumes that the images prepared for analysis were properly acquired and processed , and that they are therefore suitable for quantification . In particular , it is necessary to set up a baseline fluorescence control using free GFP or monomeric GFP ( mGFP ) in which the fluorescent parti - cles exist as monomers . Background reduction . The localization inaccuracies caused by noise in the images may make even normal particle diffu - sion appear anomalous . It is therefore of crucial importance to enhance the SNR by median filtering or advanced thresholding . The typical noise sources allows for two types of noise : Gaussian noise , as it arises in the readout process of the CCD camera , and Poisson noise , which can be used to model dark current in the CCD chip , scattered photons and autofluorescence 8 , 19 , 20 . A direct Gaussian fit to the intensity distribution is the superior algorithm for accuracy and precision , and it is the most robust at low SNRs . Median filtering combines two separate events to reduce discrete random noise and continuous background . This method detects and removes random noise from the measured data caused by electronic noise , dark current of detectors , scattered photons and other factors . Important tracking parameter considerations . There are two important tracking parameters for controlling the results in plant SPT experiments . One key parameter is the search radius used to link the individual detections , thus identifying compound tracks . Another parameter that is critical to optimizing trajec - tory construction is the gap - closing time for closing gaps in the trajectory resulting from temporary particle disappearance . These two parameters are crucial in SPT , especially in plant SPT experi - ments , because of the low SNR often encountered in plant cell specimens and the cell - wall meshwork constraints on motion of plasma membrane proteins 15 . The search radius as defined in the tracking algorithm described by Jaqaman et al . 1 is determined for every particle on - the - fly from the previously constructed tracks along with the local particle density . Therefore , instead of depending on a user - specified search radius for linking particles between frames , the user can define lower and upper limits for the search radius to avoid drifts in the parameter estimation . The defined upper and lower limits for the search radius depend on the fastest and slowest speeds of the particle under investigation and the local particle density . In our previous experiments , the limits we have defined can cap - ture most particles in different plant cells and tissues ; therefore , the parameters we used in this protocol are applicable to our published SPT experiments 3 – 7 . We also believe that this protocol can work well in other organisms with their own definition of search radius . However , if a few false initial frame - to - frame links occur either too slowly or too fast , the user can define a smaller or larger value for the search radius . In addition , when a parti - cle is located in a very high - density area , the user can define a lower search radius to cover the predicted range of motion . These parameters can be adjusted by defining the lower and upper limits for the search radius in file ‘scriptDetectGeneral . m’ by chang - ing the values of ‘parameters . minSearchRadius’ and ‘parameters . maxSearchRadius’ . In addition to the search radius , the parameters for gap time closing define the number of frames in which a detectable signal is absent because of technical limitations of microscopy . In practice , we found that the time window of eight frames for gap closing duration is sufficient to capture most gaps , consider - ing that longer gaps were less frequent than shorter gaps in our experiments with plant cells . If the software does not show the expected tracking results , it is possible to adjust the detection and tracking parameters in the interface of the software package , and then these two parameters for gap time and search radius limits . During step counting for determining the subunit stoichi - ometry , the fluoroBancroft algorithm can produce fast and effi - cient results in plant cells . Therefore , the analysis was performed with this algorithm using the default settings . Bleaching step detection . By attaching fluorophores to proteins of interest , the number of associated subunits in a complex can be determined by counting the photobleaching steps of the fluores - cent protein – tagged protein . Detection of the number of bleaching steps proceeds in two stages . The step detection algorithm separates the bleaching steps from noise , which may come from background fluorescence , detector noise of the camera or fluorophore blinking events . Subsequently , the step detection algorithm identifies seg - ments of constant intensity by iteratively averaging short segments and selecting step decreases in fluorescence only if the decreases occurred over one or , at most , two frames . The algorithm then divides step amplitudes by the average fluorescence values between the starting fluorescence level and the final fluorescence level . Controls . Design the controls for bleaching step detection to include the minimum and maximum time required to completely bleach GFP ( or other fluorescent protein tags ) when running the bleaching step detection . This is particularly crucial when apply - ing bleaching step analysis to new cell lines or fluorophores on which bleaching steps have not been tested . The bleaching time can be determined by collecting fluorescence as a function of time , consistent with the bleaching of single fluorophore molecules . For example , under continuous TIRF excitation , the fluorescence of single GFP molecules was captured continuously until > 90 % pho - tobleaching within a TIRF field ~ 100 nm from the coverslip . Binomial distribution fitting for bleaching steps . If all fluores - cent protein – tagged proteins were actively fluorescent , the bleach - ing step number would equal the number of subunits per protein assembly : if n fluorescently labeled protein subunits associate together , then the photobleaching steps should be n , matching the number of subunits per protein assembly . Ideally , every dimer should bleach in two steps , every trimer in three steps and so on . However , some bleaching steps might not be observed because the fluorescent protein has only a certain probability of being fluorescent , or having already been bleached 21 , 22 ; therefore , the steps should be binomially distributed . For this fairly common complication , the interpretation of such artifactual data needs to be formally addressed . To correct for the nonfluorescent protein molecules , the distribution of the number of steps is fitted with a binomial distribution , assuming one to x subunits and a probability , P , that the fluorescent protein tag is fluorescent . In the binomial sampling model , a small sample of n items is removed without replacement from a larger population , © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol nature protocols | VOL . 10 NO . 12 | 2015 | 2057 some of which are defective . Given that P is the probability that the individual item is not defective , the probability that it is defective is q , which equals 1 − P . The expected distribution of observing x bleaching steps for N single - molecule observations , if a total of n steps are possible , will be given by the following equation : A N N ( ) * ( | , ) ! ! ( ) ! ( ) , , , , , X x n p n x n x p p x n x n x = = − − = − p 1 0 1 2 … where A ( x ) is the predicted number of single molecules with step count x , N is the number of single molecules observed , n is the presumed stoichiometry and P is the probability of the fluorescent protein being active ( 0 < P < 1 ) . However , it should be noted that the histogram shows fewer observed bleaching steps than the presumed number of bleach - ing steps . To determine the correct stoichiometry , the mean step count μ , is np , for each assumed n can be calculated as follows : m = = ∑ 1 1 N x n A x x ′ ( ) where A ′ ( x ) is the observed number of molecules with step count x . For an assumed stoichiometry n , the probability P is then calculated as µ / n . Level of expertise needed to implement the protocol This protocol can be divided into three main parts : sample preparation , single - molecule imaging and data analysis . Sample preparation involves plasmid construction , plant cultivation , plant transformation and screening , which require graduate - level knowledge and training in molecular and cellular biology . Single - molecule imaging involves sample preparation and image acquisition using TIRFM , which require undergraduate - level microscopy skills . The data analysis using this software package requires graduate - level knowledge of single - molecule fluorescence imaging , signal processing and computer programming . Limitations This protocol uses a two - frame approach , in combination with a gap - closing scheme , which combines results from multiple frames to build more consistent tracks . Therefore , it uses a greedy algorithm compared with multiple - frame assignment and other efficient algorithms used to solve very large - scale linear assign - ment problems 11 , 23 . The disadvantage of greedy algorithms is that they fail to find the global optimum when particles are at a very high density . When this occurs , the initial track segment using a greedy approach can lead to irreparable particle assignment errors . Nevertheless , this limitation can be overcome by using dynamic programming to find the global assignment optimum . The subsequent track segment assignment is accomplished by temporal optimization , combined with the definition of upper and lower limits for search radius , thereby circumventing the shortcomings of this algorithm . Although this step for the defi - nition of search radius is not fully automated , the subsequent analysis of particle tracks provided here is automated . MaterIals REAGENTS Arabidopsis thaliana seeds expressing fluorescently labeled proteins of interest ( AtPIP2 ; 1 - GFP , AtAMT1 ; 3 - GFP and mGFP was used in our previous studies ) Murashige and Skoog ( MS ) salts ( PhytoTechnology Laboratories , cat . no . M519 ) Agar ( Sigma type M ; Sigma - Aldrich , cat . no . A4800 ; plant tissue culture ) Sucrose ( Sigma - Aldrich , cat . no . S0389 ) Kanamycin sulfate ( or bacterial antibiotic - matching vector marker ; Sigma - Aldrich , cat . no . K4000 ) Carbenicillin , disodium salt ( Sigma - Aldrich , cat . no . 0378 ) Ethanol ( Sigma - Aldrich , cat . no . 459836 ) ! cautIon Ethanol is flammable . Sodium hypochlorite ( Sigma - Aldrich , cat . no . 239305 ) ! cautIon Bleach solution is poisonous . Wear personal protection , such as gloves and goggles . Tween 20 ( Sigma - Aldrich , cat . no . P2287 ) Formaldehyde solution , 8 % ( wt / vol ) , electron microscopy ( EM ) grade , methanol free , 10 × 10 ml ( Electron Microscopy Sciences , cat . no . 157 - 8 - 100 ) ! cautIon Paraformaldehyde fumes are toxic . Wear gloves and use a fume hood while working with it . PBS ( 10× ; Sigma - Aldrich , cat . no . P4417 - 100TAB ) EQUIPMENT  crItIcal This protocol does not require specific equipment . Any TIRF microscope that is capable of visualizing fluorescent markers and any com - puter that can run the required software packages will work for this protocol . TIRF microscope ( Olympus or equivalent ) Petri dish , 90 mm ( Falcon , 353001 ) Immersion oil ( Olympus , type - F ) Coverslips ( sizes : 24 mm × 24 mm ; thickness : 0 . 13 mm ; Menzel - Gläser , cat . no . BB024024A1 ) Coverslips ( sizes : 24 mm × 50 mm ; thickness : 0 . 13 mm ; Menzel - Gläser , cat . no . BB024050A1 ) MATLAB software ( MathWorks ) • • ••• ••• •• • •••• • • Origin 8 . 0 ( OriginLab ) Computer capable of running MATLAB and the software packages  crItIcal Although the analyses can be performed on standard 32 - bit hardware , the memory requirements may exceed 4 GB , depending on image frames and the number of particles in the image data , and thus they may require a 64 - bit computer with 8 GB or more memory . Software source code : U - track ( http : / / lccb . hms . harvard . edu / software . html ) and fluoroBancroft ( http : / / physics - server . uoregon . edu / ~ raghu / particle _ tracking . html ) were used in our analysis . MATLAB files have been combined here , and they are provided as Supplementary Software 1 for convenience REAGENT SETUP MS medium and selection plates Autoclave 1 / 2× MS medium ( 2 . 15 g of Murashige and Skoog salts , 10 g of sucrose and 8 g of agar per liter ; pH 5 . 7 ) and cool it to ~ 50 °C before pouring it into Petri dishes ( 1 / 2× MS solid medium ) . To prepare selection plates , add the appropriate antibiotic or herbicide ( filter - sterilized ) into the 1 / 2× MS medium at the following final concentrations : kanamycin , 50 mg / liter ; and carbenicillin , 100 mg / liter . Store the plates at 4 °C for up to 2 months . Antibiotics Prepare stock solutions at the following concentrations : kanamy - cin , 50 mg / ml ; and carbenicillin , 100 mg / ml . Sterilize all stock solutions with a 0 . 22 - µ m pore - size filter and store them at −20 °C for up to 4 months . PBS , 1× Prepare 1× PBS from 10× PBS stock by diluting 1 : 10 with water ; store it at room temperature ( 25 °C ) for up to 1 year . Sterilization solution Sterilization solution is 70 % ( vol / vol ) ethanol , 1 : 1 sodium hypochlorite solution : dH 2 O and 0 . 01 % ( vol / vol ) Tween 20 .  crItIcal Always freshly prepare this solution . Formaldehyde solution , 4 % ( wt / vol ) Dilute 8 % ( wt / vol ) paraformaldehyde in 1× PBS ( pH 6 . 8 ) at a ratio of 1 : 1 . Freshly prepare the solution on the day of use . ! cautIon This solution is toxic and corrosive . It is dangerous if it is inhaled , absorbed through the skin or swallowed . •• • © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol 2058 | VOL . 10 NO . 12 | 2015 | nature protocols proceDuresample and microscope preparation ● tIMInG 10 – 20 min 1 | Sterilize Arabidopsis seeds from the homozygous transgenic line with a standard bleach and / or alcohol procedure . 2 | Sow Arabidopsis seeds on 1 / 2× MS solid medium and grow them for 4 d under long - day conditions ( 16 h light / 8 h dark , 20 °C ) . Alternatively , antibiotics can be used to select for homozygous transgenic lines ; we used kanamycin ( 50 mg / ml ) and carbenicillin ( 100 mg / ml ) to select for AtPIP2 ; 1 - GFP , AtAMT1 ; 3 - GFP and mGFP lines . 3 | ( Optional ) For subunit - counting experiments , fix the seedlings by using forceps to transfer whole seedlings from the growth plate to 500 µ l of EM - grade 4 % formaldehyde in PBS . Fix the seedlings for 2 h at room temperature with gentle orbital shaking . 4 | Turn on the lasers and laser shutters on the TIRF microscope . Turn on the computer that is connected to the electron - multiplying CCD ( EM - CCD ) , which has the image acquisition software . a c d b Figure 1 | The detection and tracking interface . ( a ) The main interface for single - particle tracking analysis . ( b ) Dialog window for detection settings . ( c ) Dialog window for tracking settings . ( d ) Dialog window for motion analysis settings . © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol nature protocols | VOL . 10 NO . 12 | 2015 | 2059 5 | In the control panel of the capture software , set the temperature of the EM - CCD to 80 °C , and adjust the camera gain to yield an optimal signal - to - background ratio .  crItIcal step Very high EM gain may decrease the dynamic range of the system . As the optimum gain settings on the CCD will vary between devices , comparison of images for single particles with varying gain settings will help determine the optimal gain setting . 6 | Transfer the 4 - d - old seedling to a 24 × 50 mm coverslip , and cover it with a 24 × 24 mm coverslip , supplementing with 1 / 2× MS liquid culture medium . tIrFM imaging ● tIMInG 30 min – 1 h 7 | Open the shutter for the 473 - nm laser to observe GFP signals , or open the shutter for the 561 - nm laser to observe mCherry signals . 8 | Drop immersion oil with a refractive index ( n = 1 . 518 ) that matches that of the coverslip on a 100× numerical aperture ( NA ) 1 . 65 objective lens . 9 | Place the samples on the stage of the TIRF microscope and adjust the lens position . Next , find a target area containing the fluorescent - tagged protein of interest , and optimize the focus , intensity and incidence angle of the TIRF microscope excitation lasers . In our system , the argon - ion 473 - nm laser power density just above the 100× objective lens is ~ 10 . 5 W / cm 2 . The 561 - nm laser intensity is ~ 5 . 8 W / cm 2 , and the incidence angle is set between 67 and 71° .  crItIcal step Optimization should be performed as quickly as possible to minimize photobleaching of fluorescent proteins . 10 | Record live images under TIRFM by using the capture software at a high frequency ( 10 – 50 Hz , 20 – 100 ms ) . We recommend starting with 200 frames in TIFF format with a pixel dynamic range of 16 bit to obtain the maximum possible illumination information for subsequent data analysis and quantification .  crItIcal step For single - molecule signals , the standard that we use to judge the quality of the raw image data depends on the SNR value . SNR values < 2 were considered low and SNR values > 10 were considered high . Either TIRFM or super - resolution micros - copy can achieve the required SNR for imaging processing and particle tracking when using this protocol . ? trouBlesHootInG 11 | Repeat Steps 7 – 10 for different samples . Stop imaging and then close the laser shutter . Data analysis 12 | Run the MATLAB software . 13 | Download the MATLAB script files provided in the sup - plemental section of this protocol ( supplementary software 1 ) . Unzip the corresponding zip file and save all contained files , folders and their contents on your computer . Add folders to the MATLAB path ( using ‘File / Set Path / Add Folder’ from the MATLAB menu ) . Two empty folders named ‘sptoutput’ and ‘countoutput’ are used to save the output results for SPT and subunit counting , respectively . ? trouBlesHootInG 14 | This step can be performed using option A for single - molecule identification and tracking or option B for stepwise bleaching - step analysis . a b c f e d Figure 2 | Automated tracking of GFP - PIP2 ; 1 and GFP - AMT1 ; 3 particles on the plasma membrane . ( a ) TIRFM image of GFP - PIP2 ; 1 on the plasma membrane of Arabidopsis epidermal cells . ( b ) Single GFP - PIP2 ; 1 particles detected by the SPT software package . ( c ) The trajectories of individual GFP - PIP2 ; 1 particles . ( d ) TIRFM image of GFP - AMT1 ; 3 on the plasma membrane of Arabidopsis epidermal cells . ( e ) Single GFP - AMT1 ; 3 particles detected by the SPT software package . ( f ) The trajectories of individual GFP - AMT1 ; 3 particles . Red , linear diffusion trajectories ; cyan , random diffusion trajectories . Scale bars , 5 µ m . © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol 2060 | VOL . 10 NO . 12 | 2015 | nature protocols ( a ) single - molecule identification and tracking ● tIMInG 30 min – 1 h ( i ) Run the MATLAB scripts by executing the following command on the command line . > > run ( ' mainGUI . m ' ) or mainGUI ( ii ) Prepare the image sequences for analysis in TIFF format . In the ‘Movie selection’ window , click ‘New’ . Select the folder containing raw image files for analysis , after clicking ‘Add channel’ . Multiple folders can be added . Next , click ‘Select Path’ and choose a folder to save the software output files . Click ‘Save’ to convert raw data to the MATLAB data format . ( iii ) Click ‘Continue’ and go to the ‘Control panel’ window .  crItIcal step All raw images to be analyzed should be in the same folder .  pause poInt The raw images can be stored in the MATLAB data format ( . mat ) and analyzed at a later time by clicking the ‘Open’ button and loading the previously saved MAT files . ( iv ) Set the detection and tracking parameters for SPT ( Fig . 1 ) . The following table describes the selection of parameters in the relevant windows . Window parameters Step 1 : Detection Select ‘Detection’ by marking the check box and click ‘Setting’ to choose the detection method ‘Anisotropic Gaussian Detection’ . Click the ‘Setting’ button to adjust the parameters Step 2 : Tracking Select ‘Tracking’ by marking the check box , and click ‘Setting’ to set the parameters for tracking . Gap closure parameters can be adjusted here by changing values for ‘Maximum gap to close’ Step 3 : Track analysis Select ‘Track analysis’ by marking the check box and click ‘Setting’ to set the parameters for ‘Motion Analysis’ ? trouBlesHootInG ( v ) Click the ‘Run’ button to start the processing . The software will process the movies and generate a new folder called ‘TrackingPackage’ and three subfolders called ‘anisoGaussians’ , ‘MotionAnalysis’ and ‘tracks’ . A pop - up window will also confirm the success of the tracking analysis . Box 1 | The software output files spt package output files in folder ‘tracks’ Every entry in tracksFinal contains three fields : • tracksFeatIndxcG : Connectivity matrix of particles between frames , after gap closing . • trackscoordampcG : The positions and amplitudes of the tracked particles , after gap closing . Number of rows = number of tracks , number of columns = 8 × number of frames of track spans . The matrix stores the particle’s x - coordinate , y - coordinate , z - coordinate ( 0 if 2D ) , amplitude , x - coordinate s . d . , y - coordinate s . d . , z - coordinate s . d . ( 0 if 2D ) and amplitude s . d . • seqofevents ( merging and splitting events ) : Matrix storing the sequence of events in a compound track ( i . e . , track start , track end , track splitting and track merging ) . Number of rows = number of events in a compound track . Number of columns = 4 . In every row , the columns mean the following : The first column indicates the frame index where the event happens . The second column indicates whether the event is the start or the end of a track . 1 = start , 2 = end . The third column indicates the index of the track that starts or ends . ( The index is ‘local’ , within the compound track . It corresponds to the track’s row number in tracksfeatIndxCG and tracksCoordAmpCG . ) The fourth column indicates whether a start is a true initiation or a split , and whether an end is a true termination or a merge . In particu - lar , if the fourth column is NaN , then a start is an initiation and an end is a termination . If the fourth column is a number , then the start is a split and the end is a merge , where the track of interest splits from or merges with the track indicated by the number in the fourth column . The output . csv file in folder ‘sptoutput’ contains eight columns , which store the same tracking results mentioned above for the individual single particles . subunit counting package output files The most important result array in the MAT file is the objs _ link matrix . • Each column corresponds to one particle in one frame . • Rows indicate : x position , y position , brightness intensity , particleid , frame , trackid ( determined by the linking function ) , sigma ( px Gaussian width , or the square root of the second moment ) and meand2 ( px2 , mean distance - squared between gradient lines and center ) . ( Note : ‘NaNs’ indicate frames in which a track does not exist , either because those frames are before the track starts or after it ends , or because of temporary particle disappearance . ) © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol nature protocols | VOL . 10 NO . 12 | 2015 | 2061 ( vi ) Export the MATLAB output data as a comma - separated value ( CSV ) file for further analysis by executing the following command on the command line : > > SPToutput ( vii ) Choose the MATLAB output data file called ‘Channel _ 1 _ tracking _ result . mat’ under the folder ‘tracks’ from the pop - up window ( Box 1 ) . The software will create a series of Excel . csv files containing the detection results for all tracked single particles ( Box 1 ) in the MATLAB current folder called ‘sptout’ as your raw files . ( viii ) Import the . csv file into data analysis and plotting software for future analysis . 60 50 40 30 20 10 0 320 300 280 260 240 220 320 340 300 280 260 240 220 200 0 2 4 6 8 10 0 5 10 15 15 20 Time ( s ) Time ( s ) 0 5 10 15 20 Time ( s ) Time ( s ) 0 5 10 15 20 Time ( s ) 0 0 5 10 20 Time ( s ) 0 5 10 15 20 0 1 2 3 4 Number of steps 1 2 3 4 5 Number of steps N u m be r o f ob s e r v a t i on s 0 10 20 30 40 50 60 70 N u m be r o f ob s e r v a t i on s 0 10 20 30 40 50 60 70 80 300 400 500 600 700 300 200 100 400 500 600 700 300 200 100 400 500 600 700 300 200 100 400 500 600 700 200 150 100 50 250 300 350 400 800 300 400 500 600 700 800 900 1 , 000 1 , 100 5 10 15 20 Time ( s ) Time ( s ) 0 5 10 15 20 0 5 10 15 20 Time ( s ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) I n t en s i t y ( a . u . ) a b c d e f g h i j k Figure 3 | Photobleaching traces of mGFP , GFP - AMT1 ; 3 and GFP - PIP2 ; 1 single particles on the plasma membrane . For each spot , the fluorescence intensity time trace was determined . The time traces showed discrete photobleaching steps ( blue lines ) , and the number of steps was counted to determine the minimal number of subunits per oligomer . a . u . , arbitrary units . ( a ) Left , a typical initial fluorescence image of single particles containing multiple copies of fluorescently labeled proteins before photobleaching . Right , a schematic diagram to illustrate the photobleaching trace of average fluorescence intensity versus time for the fluorescent particles circled in the image on the left . ( b ) Time courses of mGFP emission after background correction showing one - step bleaching . ( c – e ) Time courses of GFP - AMT3 ; 1 emission after background correction showing one - step ( c ) , two - step ( d ) and three - step ( e ) bleaching . ( f – i ) Time courses of GFP - PIP2 ; 1 emission after background correction showing one - step ( f ) , two - step ( g ) , three - step ( h ) and four - step ( i ) bleaching . ( j , k ) Distributions of observed bleaching step numbers ( gray bars ) from Arabidopsis expressing GFP - AMT3 ; 1 and GFP - PIP2 ; 1 . Distribution profiles are fitted using a binomial distribution with p ( probability that GFP is fluorescent ) of 63 % and 68 % , respectively ( white bars ) . © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol 2062 | VOL . 10 NO . 12 | 2015 | nature protocols ( B ) stepwise bleaching - step analysis ● tIMInG 1 – 2 h ( i ) Launch the subunit counting interface by executing the following command on the command line : > > run ( ' countingGUI . m ' ) ( ii ) Load and visualize the image sequences in TIFF or JPEG format . ( iii ) Choose a ‘Threshold Option’ in the Neighborhood Parameters’ panel and modify the values of parameters—e . g . , the object size ( ‘bpfiltsize’ for spatial filtering and ‘nsize’ for the single - particle - neighborhood size ) and the threshold values . ( iv ) Click ‘Track this frame’ to apply the present parameters and fitting method to the displayed image . ( v ) Click ‘Track all frames’ to apply the present parameters and fitting method to all the 2D images . ( vi ) Link objects across frames into tracks after setting the max step and memory parameters . ( vii ) Save the output using ‘Save Output’ ( or Save TXT to save the position information in a simplified form , as a tab - delimited text file ) . ( viii ) Export the MATLAB output data as a CSV file for further analysis by executing the following command on the command line : > > countoutput ( ix ) Choose the MATLAB output data file called ‘TrackGUIoutput . mat’ from the pop - up window . The software will create a . csv file containing the fluorescence intensity of each single particle ( Box 1 ) in the MATLAB current folder called ‘countoutput’ as your raw files . ( x ) Import the output file into a data analysis and plotting software for future analysis . ? trouBlesHootInG Troubleshooting advice can be found in table 1 . ● tIMInG Steps 1 – 6 , sample and microscope preparation : 10 – 20 min Steps 7 – 11 , TIRFM imaging : 30 min – 1 h Steps 12 – 14A , single - molecule identification and tracking : 30 min – 1 h Steps 12 – 14B , stepwise bleaching step analysis : 1 – 2 h taBle 1 | Troubleshooting table . step problem possible reason solution 10 High background fluorescence Coverslips are not clean , the prepared samples were not grown in optimal conditions , or the samples are damaged Use new coverslips or prepare a new sample for live - image recording 13 The image files cannot be loaded This script uses the subfunctions located in the ‘mex’ folder . The folder and the subfolders for this script were not added to the MATLAB path All folders need to be added to the path in MATLAB ( using ‘File / Set Path / Add Folder’ from the MATLAB menu ) ; otherwise , the analysis will be terminated 14A ( iv ) Memory limitations If large image data sets are analyzed , the memory of standard 32 - bit hardware ( maximum 4 GB memory ) may be insufficient for Gaussian mixture - model fitting detection methods 64 - bit operating systems are recommended for working with large image data . The anisotropic Gaussian detection method uses compiled MEX files , which are only run on 64 - bit operating systems False initial frame - to - frame linking The single particles in the sample are moving either too slow or too fast The particles are located in a very high density area Define a smaller or larger value for search radius when the particles move either too slow or too fast . If particles are located in a high - density area , the users can define a lower search radius to cover the predicted range of motion . ( See ‘Important tracking parameter considerations’ in the INTRODUCTION ) © 201 5 N a t u r e A m e r i ca , I n c . A ll r i gh t s r ese r ve d . protocol nature protocols | VOL . 10 NO . 12 | 2015 | 2063 antIcIpateD results This protocol for single - molecule imaging analysis provides a detailed description of the dynamics and organization of specific proteins at the nanoscale level . It can give insights into the movement and oligomerization of proteins in living cells , which are especially important for understanding the mechanisms of dynamic cellular events . Typical results are shown in Figure 2 , in which two plasma membrane proteins , AtPIP2 ; 1 - GFP ( supplementary Video 1 ) and AtAMT1 ; 3 - GFP ( supplementary Video 2 ) , are imaged and analyzed using this method in living Arabidopsis root cells . Fluorescent subunit counting data were collected by measuring free mGFP ( supplementary Video 3 ) and examining fixed Arabidopsis cells expressing GFP - PIP2 ; 1 ( supplementary Video 4 ) and GFP - AMT1 ; 3 ( supplementary Video 5 ) , respectively . The fluorescence signal of each trace was plotted as a function of time using programs such as Origin ( OriginLab ) , and bleaching steps were counted ( Fig . 3 ) . As all identical fluorescent proteins in fixed samples have an equal probability of fluorescing , the resulting step number histogram follows a binomial distribution dependent on this maturation probability . Fitting of the data to a binomial distribution produced a P value of 0 . 68 for GFP - PIP2 ; 1 and a P value of 0 . 63 for GFP - AMT1 ; 3 , showing the probability of a subunit being detected . Note : Any Supplementary Information and Source Data files are available in the online version of the paper . acknoWleDGMents We thank K . Jaqaman and R . Parthasarathy for providing the original algorithm source code . This work is supported by the Program of Introducing Talents of Discipline to Universities ( 111 project , B13007 ) , the Major Science Foundation of the Ministry of Education of China ( no . 313008 ) , the National Basic Research Program of China ( 973 Program 2011CB809103 ) and the National Nature Science Foundation of China Project ( grant nos . 31270412 and 31270224 ) . autHor contrIButIons X . W . and X . L . combined the MATLAB scripts and wrote the paper . X . D . and D . - T . L . performed the computational analysis . C . M . edited and revised the paper . J . L . designed the experiment and revised the paper . coMpetInG FInancIal Interests The authors declare no competing financial interests . Reprints and permissions information is available online at http : / / www . nature . com / reprints / index . html . 1 . Jaqaman , K . et al . Robust single - particle tracking in live - cell time - lapse sequences . Nat . Methods 5 , 695 – 702 ( 2008 ) . 2 . Parthasarathy , R . Rapid , accurate particle tracking by calculation of radial symmetry centers . Nat . Methods 9 , 724 – 726 ( 2012 ) . 3 . Fan , L . et al . Dynamic analysis of Arabidopsis AP2 sigma subunit reveals a key role in clathrin - mediated endocytosis and plant development . Development 140 , 3826 – 3837 ( 2013 ) . 4 . Li , X . et al . Single - molecule analysis of PIP2 ; 1 dynamics and partitioning reveals multiple modes of Arabidopsis plasma membrane aquaporin regulation . Plant Cell 23 , 3780 – 3897 ( 2011 ) . 5 . Li , R . et al . A membrane microdomain - associated protein , Arabidopsis Flot1 , is involved in a clathrin - independent endocytic pathway and is required for seedling development . Plant Cell 24 , 2105 – 2122 ( 2012 ) . 6 . Wang , Q . et al . Single - particle analysis reveals shutoff control of the Arabidopsis ammonium transporter AMT1 ; 3 by clustering and internalization . Proc . Natl . Acad . Sci . USA 110 , 13204 – 13209 ( 2013 ) . 7 . Hao , H . et al . Clathrin and membrane microdomains cooperatively regulate RbohD dynamics and activity in Arabidopsis . Plant Cell 26 , 1729 – 1745 ( 2014 ) . 8 . Meijering , E . , Smal , I . & Danuser , G . Tracking in molecular bioimaging . Signal Process . Mag . IEEE 23 , 46 – 53 ( 2006 ) . 9 . Serge , A . , Bertaux , N . , Rigneault , H . & Marguet , D . Dynamic multiple - target tracing to probe spatiotemporal cartography of cell membranes . Nat . Methods 5 , 687 – 694 ( 2008 ) . 10 . Kalaidzidis , Y . Intracellular objects tracking . Eur . J . Cell Biol . 86 , 569 – 578 ( 2007 ) . 11 . Chenouard , N . et al . Objective comparison of particle tracking methods . Nat . Methods 11 , 281 – 289 ( 2014 ) . 12 . Chenouard , N . , Bloch , I . & Olivo - Marin , J . C . Multiple hypothesis tracking in microscopy images . IEEE International Symposium on Biomedical Imaging : From Nano to Macro , ISBI’09 , 1346 – 1349 ( 2009 ) . 13 . Jonker , R . & Volgenant , A . A shortest augmenting path algorithm for dense and sparse linear assignment problems . Computing 38 , 325 – 340 ( 1987 ) . 14 . Vizcay - Barrena , G . , Webb , S . E . , Martin - Fernandez , M . L . & Wilson , Z . A . Subcellular and single - molecule imaging of plant fluorescent proteins using total internal reflection fluorescence microscopy ( TIRFM ) . J . Exp . Bot . 62 , 5419 – 5428 ( 2011 ) . 15 . Martiniere , A . et al . Cell wall constrains lateral diffusion of plant plasma - membrane proteins . Proc . Natl . Acad . Sci . USA 109 , 12805 – 12810 ( 2012 ) . 16 . Konopka , C . A . & Bednarek , S . Y . Variable - angle epifluorescence microscopy : a new way to look at protein dynamics in the plant cell cortex . Plant J . 53 , 186 – 196 ( 2008 ) . 17 . Konopka , C . A . , Backues , S . K . & Bednarek , S . Y . Dynamics of Arabidopsis dynamin - related protein 1C and a clathrin light chain at the plasma membrane . Plant Cell 20 , 1363 – 1380 ( 2008 ) . 18 . Zacharias , D . A . , Violin , J . D . , Newton , A . C . & Tsien , R . Y . Partitioning of lipid - modified monomeric GFPs into membrane microdomains of live cells . Science 296 , 913 – 916 ( 2002 ) . 19 . Uttenweiler , D . , Weber , C . , Jahne , B . , Fink , R . H . & Scharr , H . Spatiotemporal anisotropic diffusion filtering to improve signal - to - noise ratios and object restoration in fluorescence microscopic image sequences . J . Biomed . Opt . 8 , 40 – 47 ( 2003 ) . 20 . Gohring , J . , Fulcher , N . , Schilcher , K . , Barta , A . & Jacak , J . Suitable transfection methods for single particle tracing in plant suspension cells . Plant Methods 10 , 15 ( 2014 ) . 21 . Ulbrich , M . H . & Isacoff , E . Y . Subunit counting in membrane - bound proteins . Nat . Methods 4 , 319 – 321 ( 2007 ) . 22 . McGuire , H . , Aurousseau , M . R . , Bowie , D . & Blunck , R . Automating single subunit counting of membrane proteins in mammalian cells . J . Biol . Chem . 287 , 35912 – 35921 ( 2012 ) . 23 . Ge , Y . , Matov , A . & Danuser , G . Reliable tracking of large - scale dense antiparallel particle motion for fluorescence live cell imaging . In IEEE Computer Society Conference on Computer Vision and Pattern Recognition - Workshops , 2005 . CVPR Workshops . 138 ( 2005 ) .
Estimating the epidemic reproduction number from temporally aggregated incidence data : a statistical 1 modelling approach and software tool 2 3 Rebecca K Nash 1 MSc , Anne Cori 1 PhD * , Pierre Nouvellet 1 , 2 PhD * 4 * Contributed equally 5 1 MRC Centre for Global Infectious Disease Analysis , Jameel Institute , School of Public Health , Imperial College 6 London 7 2 School of Life Sciences , University of Sussex 8 9 10 Background 11 The time - varying reproduction number ( R t ) is an important measure of epidemic transmissibility ; it can directly 12 inform policy decisions and the optimisation of control measures . EpiEstim is a widely used software tool that 13 uses case incidence and the serial interval ( SI , time between symptoms in a case and their infector ) to estimate 14 R t in real - time . The incidence and the SI distribution must be provided at the same temporal resolution , which 15 limits the applicability of EpiEstim and other similar methods , e . g . for pathogens with a mean SI shorter than 16 the frequency of incidence reporting . 17 Methods 18 We use an expectation - maximisation algorithm to reconstruct daily incidence from temporally aggregated 19 data , from which R t can then be estimated using EpiEstim . We assess the validity of our method using an 20 extensive simulation study and apply it to COVID - 19 and influenza data . The method is implemented in the 21 opensource R package EpiEstim . 22 Findings 23 For all datasets , the influence of intra - weekly variability in reported data was mitigated by using aggregated 24 weekly data . R t estimated on weekly sliding windows using incidence reconstructed from weekly data was 25 strongly correlated with estimates from the original daily data . The simulation study revealed that R t was well 26 estimated in all scenarios and regardless of the temporal aggregation of the data . In the presence of weekend 27 effects , R t estimates from reconstructed data were more successful at recovering the true value of R t than 28 those obtained from reported daily data . 29 Interpretation 30 R t can be successfully recovered from aggregated data , and estimation accuracy can even be improved by 31 smoothing out administrative noise in the reported data . 32 Funding 33 MRC doctoral training partnership , MRC centre for global infectious disease analysis , the NIHR HPRU in 34 Modelling and Health Economics , and the Academy of Medical Sciences Springboard , funded by the AMS , 35 Wellcome Trust , BEIS , the British Heart Foundation and Diabetes UK . 36 37 Introduction 38 39 As infectious disease outbreaks become more common , it is increasingly important to rapidly characterise the 40 threat of emerging and re - emerging pathogens . 1 Transmissibility , i . e . a pathogen’s ability to spread through a 41 population , can be quantified using the time - varying reproduction number , R t , defined as the average number 42 of infections that are caused by a primary case at time t of an outbreak . R t signals whether an outbreak is 43 growing ( R t > 1 ) or declining ( R t < 1 ) , and whether current interventions are sufficient to control the spread of 44 the disease . 45 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint NOTE : This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice . 46 One of the most popular tools for real - time R t estimation , the R package EpiEstim , relies on observing the 47 incidence data and supplying an estimated serial interval ( SI ) distribution – the time between symptom onset 48 in a case and their infector . EpiEstim requires that the SI distribution and incidence data are supplied using 49 the same time units . This can be problematic when daily incidence data is not reported , which is common for 50 many diseases , such as influenza , Zika virus disease , and most notifiable diseases in countries such as the UK 51 and the US . 2 – 5 Additionally , several studies intentionally aggregate data to reduce the impact of daily reporting 52 variability ; administrative noise , such as “weekend effects” , are characterised by a drop in reported cases over 53 weekends , due to reduced care seeking and longer delays in reporting , followed by a peak on Mondays . 6 , 7 A 54 commonly used workaround is to aggregate the SI distribution to match the frequency of incidence 55 reporting , 8 , 9 however this is not possible if the SI is shorter than the aggregation of data . For example , 56 influenza - like illness is typically reported on a weekly basis , but influenza has an estimated mean SI of 2 - 4 57 days . 10 , 11 Similarly , reporting of COVID - 19 , which has an estimated SI of 3 - 7 days , has typically moved from 58 daily to weekly . 12 , 13 Therefore , enabling estimation of R t from temporally aggregated data is critical to ensure 59 methods such as EpiEstim are widely applicable . 14 60 61 In this study , we combine an expectation - maximisation ( EM ) algorithm with the renewal equation approach 62 implemented in EpiEstim to reconstruct daily incidence from aggregated data and estimate R t . We assess the 63 performance of the method using influenza and COVID - 19 data , in addition to an extensive simulation study . 64 65 Methods 66 67 EpiEstim 68 69 EpiEstim uses the renewal equation ( eq . 1 ) , a form of branching process model . 15 In this formulation , the 70 incidence of new symptomatic cases at time t ( I t ) is approximated by a Poisson process , where I t - s is the past 71 incidence , and 𝑔 s is the probability mass function of the serial interval . 72 73 𝐼 ! ~ 𝑃𝑜𝑖𝑠 ) 𝑅 ! + 𝐼 ! " # 𝑔 # ! # $ % , ( 1 ) 74 With EpiEstim , R t can be assumed to remain constant within user defined time windows , which smooth out 75 estimates . 76 77 Extending EpiEstim for coarsely aggregated data 78 79 We extended EpiEstim to estimate R t from aggregated incidence data ( I w ) , where each aggregation window 80 ( w ) is > 1 day , whilst still conditioning on an assumed serial interval distribution ( 𝑔 s ) . We use an EM algorithm 81 to iteratively reconstruct daily incidence ( I t ) from I w , and in turn estimate R t . We present the method with 82 weekly data in mind , but the method and software can be applied to any temporal aggregation ( Figure 1 & 83 appendix pp22 - 24 ) . The algorithm involves three steps : initialisation , expectation , and maximisation . 84 85 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 86 Figure 1 . Schematic of the EM algorithm approach used to reconstruct daily incidence ( I t ) from weekly 87 aggregated incidence data ( I w ) . The algorithm is initialised with a naive disaggregation of the weekly incidence 88 ( assuming constant daily incidence throughout the aggregation window ) . The resulting daily incidence is then 89 used to estimate the reproduction number for each aggregation window , in this case for each week , R w . R w is 90 converted into a growth rate ( see eq . 2 ) , which is in turn used to reconstruct daily incidence data , whilst 91 ensuring that if I t were to be reaggregated it would still sum to the original weekly totals . The process cycles 92 between the expectation and maximisation steps until convergence . 93 94 Initialisation 95 The algorithm is initialised with naively disaggregated incidence data . For weekly data , the total incidence for 96 each week is split evenly over 7 days ( allowing for non - integers ) . 97 98 Expectation 99 The current reconstructed I t is used to estimate the expected reproduction number for each aggregation 100 window , R w , obtained as the posterior mean from EpiEstim . 16 101 102 Maximisation 103 Conditional on R w , we reconstruct the most likely I t . First , R w is translated into a daily growth rate for that week 104 ( r w ) , using Wallinga and Lipsitch’s method : 17 105 106 𝑅 & = 1 ∑ 𝑒 " ’ ! # 𝑔 ( 𝑠 ) ( ) # $ * ( 2 ) 107 I t for that week is then computed assuming exponential growth , with a multiplying constant k w ensuring that 108 when reaggregated , the reconstructed I t matches the original I w : 109 110 𝐼 ! = 𝑘 & exp ( 𝑟 & 𝑎 ! ) ( 3 ) 𝑘 & = 𝐼 & 9 exp ( 𝑟 & 𝑛 ) + , $ % ( 4 ) 111 where t is time ( in days ) and a t is an index representing the day of the aggregation window , e . g . taking values 112 1 to 7 . 113 114 The process is repeated iteratively until convergence , at which point I t can be used to estimate the full 115 posterior distribution of R t using EpiEstim . For this final step , R t can be estimated on any time window . 116 Expectation of R w | I t Maximisation of I t | R w , I w Initialisation of I t | I w 1 . 0 1 . 1 1 . 2 1 . 3 0 20 40 60 80 100 Day W ee k l y R t e s t i m a t e s 0 100 200 300 0 20 40 60 80 100 Day R e c on s t r u c t ed i n c i den c e 0 100 200 300 0 20 40 60 80 100 Day N a i v e i n c i den c e . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 117 Case studies 118 119 We chose datasets where incidence data was available daily , and then artificially aggregated them to weekly 120 counts . R t was estimated from daily incidence that was reconstructed from weekly aggregated data using our 121 new approach , and compared to R t estimates obtained from the reported daily incidence using the original 122 EpiEstim R package . All R t estimates were made using both daily and weekly sliding time windows , and we 123 refer to those estimates as daily R t estimates and weekly R t estimates respectively . 124 125 We considered three characteristics : 1 ) mean R t estimates , 2 ) uncertainty in the R t estimates , and 3 ) the 126 classification of R t as increasing , uncertain or declining ( appendix pp8 - 9 ) . To compare the performance of this 127 approach to the original method , we assessed the correlations between each of the three characteristics when 128 using the reported and reconstructed incidence . 129 130 The priors for R w and R t were set to a mean and standard deviation of 5 . 131 132 Influenza 133 We obtained a five - week subset of a dataset ( 11 th December 2009 – 14 th January 2010 ) on US active 134 component military personnel ( employed by the military as their full - time occupation ) that made an 135 outpatient visit to a permanent military treatment facility describing a respiratory - related illness . This daily 136 incidence by date of presentation at a clinic was originally obtained by Riley et al . from the Armed Forces 137 Health Surveillance Center and were digitally extracted for use here . 18 We used a mean SI of 3 . 6 days and SD 138 of 1 . 6 days . 10 139 140 COVID - 19 141 Incidence of UK COVID - 19 cases and deaths were taken from the UK government website . 19 For COVID - 19 142 cases , we obtained ninety - seven weeks of data ( 21 st February 2020 to 30 th December 2021 ) for incidence by 143 date of specimen , which is the date that a sample was taken from an individual which later tested positive . 144 For COVID - 19 deaths , we used ninety - six weeks of data ( 2 nd March 2020 to 2 nd January 2022 ) for incidence by 145 date of death within twenty - eight days of a positive test . We assumed a mean SI of 6 . 1 days and SD of 4 . 2 146 days . 12 147 148 Simulation study 149 150 We considered scenarios where R t either remained constant or varied over time , with a stepwise or gradual 151 change . For each scenario , one hundred seventy - day epidemic trajectories were simulated using a Poisson 152 branching process as implemented in the R package projections . 20 Daily datasets were aggregated weekly and 153 used to estimate R t using the proposed method ; these values were compared to R t estimates obtained from 154 simulated daily data using the original EpiEstim R package . We explored the impact of weekend effects on R t 155 estimates , the ability to supply alternative temporal aggregations of data e . g . , three - day , ten - day , or two - 156 weekly aggregations , and finally , the number of iterations required to reach convergence when reconstructing 157 daily incidence data . The full simulation study description and details can be found in the appendix . 158 159 Role of funding source 160 161 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint The funders of the study had no role in the study design , data collection , data analysis , data interpretation , 162 or writing of the report . 163 164 Results 165 166 Hereafter , we refer to reported and reconstructed incidence data , these are the reported daily incidence 167 and the daily incidence that has been reconstructed from weekly aggregated data , respectively . 168 169 Influenza 170 171 The reconstructed incidence of influenza was much smoother than the reported incidence , which showed 172 clear weekend effects and lower reported cases on two public holidays , both occurring on Fridays ( Figure 2A 173 & appendix p8 ) . Considering weekly sliding R t first , there was a high correlation in both the mean R t estimates 174 derived from each dataset ( R 2 = 0 . 91 , Figure 2C & appendix p2 ) and their associated uncertainty ( R 2 = 0 . 93 & 175 Figure 2C ) . The overall agreement in the classification of R t reached 81 . 8 % ( see methods & appendix p9 ) . 176 177 In contrast , mean daily R t estimates differed markedly depending on whether the reported or reconstructed 178 data were used , with an R 2 of 0 . 13 and much higher mean R t and uncertainty in estimates obtained from 179 reported data ( Figure 2E - F ) . Higher mean R t estimates coincided with large peaks in the reported daily 180 incidence ( typically on Mondays ) , as daily R t estimates were not smoothed and therefore more affected by 181 intra - weekly variability ( appendix p2 ) . The overall agreement in the classification of daily R t estimates was 182 much lower , with only 44 . 4 % agreement ( appendix p9 ) . 183 184 In this case study , the greatest differences in R t estimates tended to correspond to time periods when the 185 reported and reconstructed incidence data were most dissimilar ( Figure 2B & appendix p3 ) . There was no 186 apparent pattern in the estimates with regard to the outbreak phase , i . e . early , mid or late - phase , but this is 187 likely due to this dataset being a snapshot of incidence taken from within an established epidemic ( Figure 2 ) . 188 189 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 190 191 Figure 2 . R t estimates from daily incidence that was either reported or reconstructed from weekly aggregated 192 influenza data . A ) The reported ( grey ) and reconstructed ( green ) daily incidence of influenza by date of 193 presentation at a military clinic . B ) Squared error of the daily ( orange ) and weekly sliding ( pink ) R t estimates 194 that were made from reconstructed daily data compared to those obtained from the reported daily data . R t 195 estimation starts on the first day of the second aggregation window ( day 8 – 18 th December 2009 ) and is 196 plotted on the last day of the time window used for estimation ( i . e . , starting on day 9 ( 19 th December ) for daily 197 estimates and day 14 ( 24 th December ) for weekly estimates ) . Note : the x - axis is shared with the incidence plot 198 above . C & E ) Correlation between the weekly sliding ( C ) and daily ( E ) mean R t estimates using reconstructed 199 data ( y - axis ) and reported daily data ( x - axis ) . Vertical and horizontal lines depict the 95 % credible intervals and 200 dotted lines show the threshold of R t = 1 . D & F ) Correlation between the uncertainty in the weekly sliding ( D ) 201 and daily ( F ) R t estimates , defined as the width of the 95 % credible intervals , using the reconstructed ( y - axis ) 202 and reported ( x - axis ) daily data . The colour of the points in panels C - F correspond to the epidemic phase , i . e . 203 the early ( 19 th – 30 th December for daily estimates , or 24 th – 30 th December for weekly sliding estimates ) , 204 middle ( 31 st December – 6 th January ) or late ( 7 th – 14 th January ) phase of the data , shown by the strip in panel 205 A . Solid lines show the linear model fit with 95 % confidence intervals ( grey shading ) . Dashed lines represent 206 the x = y line . 207 208 209 COVID - 19 cases 210 211 The reconstructed incidence of COVID - 19 smoothed out intra - weekly variability , caused by factors such as 212 weekend effects ( Figure 3A & appendix pp7 - 8 ) . Weekly sliding R t estimates obtained from reconstructed and 213 reported incidence were similar , both in their means ( R 2 = 0 . 98 ) and their level of uncertainty ( R 2 = 0 . 99 , Figure 214 3C - D & appendix p4 ) . Mean daily R t estimates were less well correlated ( R 2 = 0 . 67 ) , although the difference is 215 0 1000 2000 3000 20 Dec 09 30 Dec 09 09 Jan 10 D a il y i n c i den c e b y p r e s en t a t i on a t c li n i c Reported Reconstructed A R 2 = 0 . 91 0 . 75 1 . 00 1 . 25 1 . 50 0 . 75 1 . 00 1 . 25 1 . 50 Mean weekly R ( reported data ) M ean w ee k l y R ( r e c on s t r u c t ed da t a ) early mid late C R 2 = 0 . 13 1 2 3 1 2 3 Mean daily R ( reported data ) M ean da il y R ( r e c on s t r u c t ed da t a ) E 0 . 00 0 . 03 0 . 06 0 . 09 20 Dec 09 30 Dec 09 09 Jan 10 Date S qua r ed e rr o r o f R e s t i m a t e s u s i ng r e po r t ed and r e c on s t r u c t ed da t a Daily R Weekly sliding R B R 2 = 0 . 93 0 . 03 0 . 04 0 . 05 0 . 03 0 . 04 0 . 05 Width of 95 % CrI for R ( reported data ) W i d t h o f 95 % C r I f o r R ( r e c on s t r u c t ed da t a ) D R 2 = 0 . 14 0 . 05 0 . 10 0 . 15 0 . 05 0 . 10 0 . 15 Width of 95 % CrI for R ( reported data ) W i d t h o f 95 % C r I f o r R ( r e c on s t r u c t ed da t a ) F . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint less marked than in the influenza case study ( Figure 3E ) , and the uncertainty in the estimates was similar 216 across both approaches ( R 2 = 0 . 97 , Figure 3F ) . Most of the discrepant R t estimates and higher levels of 217 uncertainty coincide with the early phase of the outbreak when incidence was lower ( Figure 3E - F ) . Outside of 218 periods of low incidence , the largest differences in R t estimates tended to correspond to time periods with 219 greater disparities between the reported and reconstructed incidence data ( Figure 3B & appendix p5 ) . The 220 overall agreement in the classification of R t estimates was higher than for influenza , with 74 . 4 % and 94 . 9 % 221 agreement for daily and weekly sliding R t estimates respectively ( appendix p9 ) . 222 223 224 225 226 Figure 3 . R t estimates from daily incidence that was either reported or reconstructed from weekly aggregated 227 COVID - 19 case data . A ) The reported ( grey ) and reconstructed ( green ) daily incidence of COVID - 19 by date of 228 specimen . B ) Squared error of the daily ( orange ) and weekly sliding ( pink ) R t estimates made from 229 reconstructed data compared to those obtained from the reported daily data . R t estimation starts on the first 230 day of the second aggregation window ( day 8 – 28 th February 2020 ) and is plotted on the last day of the time 231 window used for estimation ( i . e . , starting on day 9 ( 29 th February ) for daily estimates and day 14 ( 5 th March ) 232 for weekly estimates ) . Note : the x - axis is shared with the incidence plot above and the y - axis has been limited 233 to 0 . 5 for clarity . C & E ) Correlation between the weekly sliding ( C ) and daily ( E ) mean R t estimates using 234 reconstructed ( y - axis ) and reported ( x - axis ) daily data , excluding the first 30 days due to low incidence . Vertical 235 and horizontal lines depict the 95 % credible intervals and dotted lines show the threshold of R t = 1 . D & F ) 236 Correlation between the uncertainty in the weekly sliding ( D ) and daily ( F ) R t estimates , defined as the width 237 of the 95 % credible intervals , using the reconstructed ( y - axis ) and reported ( x - axis ) daily data . The colour of 238 the points in panels C - F correspond to the epidemic phase , i . e . the early ( 21 st March – 12 th October 2020 ) , 239 middle ( 13 th October 2020 – 22 nd May 2021 ) or late ( 23 rd May – 30 th December 2021 ) phase of the data , shown 240 by the strip in panel A . Solid lines show the linear model fit with 95 % confidence intervals ( grey shading ) . 241 Dashed lines represent the x = y line . 242 0 50000 100000 150000 200000 07 Sep 20 26 Mar 21 12 Oct 21 D a il y i n c i den c e b y da t e o f s pe c i m en Reported Reconstructed A R 2 = 0 . 98 1 . 0 1 . 5 2 . 0 1 . 0 1 . 5 2 . 0 Mean weekly R ( reported data ) M ean w ee k l y R ( r e c on s t r u c t ed da t a ) early mid late C R 2 = 0 . 67 1 2 3 1 2 3 Mean daily R ( reported data ) M ean da il y R ( r e c on s t r u c t ed da t a ) E 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 07 Sep 20 26 Mar 21 12 Oct 21 Date S qua r ed e rr o r o f R e s t i m a t e s u s i ng r epo r t ed and r e c on s t r u c t ed da t a Daily R Weekly sliding R B R 2 = 0 . 999 0 . 00 0 . 04 0 . 08 0 . 12 0 . 00 0 . 04 0 . 08 0 . 12 Width of 95 % CrI for weekly R ( reported data ) W i d t h o f 95 % C r I f o r w ee k l y R ( r e c on s t r u c t ed da t a ) D R 2 = 0 . 97 0 . 00 0 . 05 0 . 10 0 . 15 0 . 00 0 . 05 0 . 10 0 . 15 Width of 95 % CrI for daily R ( reported data ) W i d t h o f 95 % C r I f o r da il y R ( r e c on s t r u c t ed da t a ) F . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 243 COVID - 19 deaths 244 245 The reported incidence of COVID - 19 deaths was much less influenced by day - to - day variation . The 246 reconstructed daily incidence was more similar to the observed daily data than in the previous case studies 247 ( Figure 4A ) . Both weekly and daily R t estimates obtained from weekly data were highly consistent with those 248 obtained from daily observations ( R 2 = 0 . 98 and R 2 = 0 . 80 respectively , Figure 4C & 4E ) . The overall agreement 249 in R t classifications for daily estimates was the highest of all case studies at 85 . 8 % , and 93 . 3 % for weekly R t 250 estimates ( appendix p9 ) . Discrepancies between the two mostly coincide with periods of particularly low 251 incidence of deaths ( Figure 4B & appendix p7 ) . The overall lower incidence of COVID - 19 deaths compared to 252 COVID - 19 cases means there is greater uncertainty in R t estimates in this case study ( Figure 4D , 4F & appendix 253 p6 ) . However , there was minimal difference in the uncertainty of estimates obtained from daily and weekly 254 data ( Figure 4D & 4F ) . 255 256 257 258 Figure 4 . R t estimates from daily incidence that was either reported or reconstructed from weekly aggregated 259 COVID - 19 death data . A ) The reported ( grey ) and reconstructed ( green ) daily incidence of COVID - 19 by date 260 of death within 28 days of a positive test . B ) Squared error of the daily ( orange ) and weekly sliding ( pink ) R t 261 estimates that were made from reconstructed data compared to those obtained from the reported daily data . 262 R t estimation starts on the first day of the second aggregation window ( day 8 – 9 th March 2020 ) and is plotted 263 on the last day of the time window used for estimation ( i . e . , starting on day 9 ( 10 th March ) for daily estimates 264 and day 14 ( 15 th March ) for weekly estimates ) . Note : the x - axis is shared with the incidence plot above and 265 the y - axis has been limited to 0 . 5 for clarity . C & E ) Correlation between the weekly sliding ( C ) and daily ( E ) 266 mean R t estimates using reconstructed ( y - axis ) and reported daily data ( x - axis ) , excluding the first 30 days due 267 to low incidence . Vertical and horizontal lines depict the 95 % credible intervals and dotted lines show the 268 0 500 1000 17 Sep 20 05 Apr 21 22 Oct 21 D a il y i n c i den c e b y da t e o f dea t h Reported Reconstructed A R 2 = 0 . 98 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 Mean weekly R ( reported data ) M ean w ee k l y R ( r e c on s t r u c t ed da t a ) early mid late C R 2 = 0 . 8 1 2 3 1 2 3 Mean daily R ( reported data ) M ean da il y R ( r e c on s t r u c t ed da t a ) E 0 . 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 17 Sep 20 05 Apr 21 22 Oct 21 Date S qua r ed e rr o r o f R e s t i m a t e s u s i ng r epo r t ed and r e c on s t r u c t ed da t a Daily R Weekly sliding R B R 2 = 0 . 996 0 . 0 0 . 2 0 . 4 0 . 6 0 . 0 0 . 2 0 . 4 0 . 6 Width of 95 % CrI for R ( reported data ) W i d t h o f 95 % C r I f o r R ( r e c on s t r u c t ed da t a ) D R 2 = 0 . 97 0 . 0 0 . 5 1 . 0 0 . 0 0 . 5 1 . 0 Width of 95 % CrI for daily R ( reported data ) W i d t h o f 95 % C r I f o r da il y R ( r e c on s t r u c t ed da t a ) F . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint threshold of R t = 1 . D & F ) Correlation between the uncertainty in the weekly sliding ( D ) and daily ( F ) R t 269 estimates , defined as the width of the 95 % credible intervals , using the reconstructed ( y - axis ) and reported 270 daily ( x - axis ) data . The colour of the points in panels C - F correspond to the epidemic phase , i . e . the early ( 31 st 271 March - 20 th October 2020 ) , middle ( 21 st October 2020 – 28 th May 2021 ) or late ( 29 th May 2021 – 2 nd January 272 2022 ) phase of the data , shown by the strip in panel A . Solid lines show the linear model fit with 95 % 273 confidence intervals ( grey shading ) . Dashed lines represent the x = y line . 274 275 In all case - studies , incidence reconstructions converged within 10 iterations of the EM algorithm . The overall 276 process of R t estimation from weekly aggregated data took three seconds or less to run on MacOS ( 2 GHz 277 Quad - Core Intel Core i5 ) 16GB RAM ( appendix p10 ) ; the influenza scenario , with over 57 , 000 cases , took two 278 seconds to run , whilst the COVID - 19 cases and deaths scenarios , with an overall incidence over 149 , 000 and 279 13 million cases respectively , took three seconds to run . 280 281 Simulation study 282 283 The method performed well across all scenarios , successfully estimating R t from the aggregated simulated 284 data ( appendix pp10 - 20 ) . Convergence of the EM algorithm was quick , with negligible differences in the 285 reconstructed incidence beyond 5 iterations ( appendix p22 ) . 286 287 When introducing weekend effects into simulated data , R t estimates from reconstructed incidence were more 288 successful at recovering the true value of R t than when using reported incidence ( appendix p21 ) . The method 289 can also be successfully applied to other temporal aggregations of data , e . g . three - , ten - or fourteen - day 290 windows ( appendix pp22 - 24 ) . 291 292 Discussion 293 294 Estimates of the time - varying reproduction number ( R t ) have frequently been used to inform and guide 295 policymaking during outbreaks , and a commonly used approach to estimate R t is EpiEstim , which relies on 296 daily incidence data . However , maintaining daily incidence databases requires substantial time and 297 investment in resources , which is not always feasible , particularly for less acute or routinely reported diseases . 298 Therefore , in practice , many diseases are not reported on a daily basis , including influenza and other notifiable 299 diseases in the UK and US . 2 – 5 As the COVID - 19 pandemic persists , daily reporting is also becoming less 300 common . 21 Coarsely aggregated data can be challenging to deal with in the context of R t estimation methods , 301 restricting their applications in certain contexts . In this study , we develop a statistical framework and tool that 302 allows R t estimation from aggregated incidence without introducing bias . Using influenza and COVID - 19 data , 303 alongside a simulation study , we demonstrate how a simple expectation - maximisation algorithm approach 304 can rapidly reconstruct daily incidence data and accurately estimate R t . 305 306 In all case studies , direct comparisons between weekly sliding R t estimates show that very similar estimates 307 can be made from the reported daily incidence and the reconstructed daily incidence from weekly aggregated 308 data . However , daily R t estimates are more influenced by noise , such as intra - weekly variability , leading to 309 greater disparities in estimates between datasets . There are clear weekend effects exhibited in the influenza 310 and COVID - 19 case data ( appendix p8 ) , leading to peaks and troughs in the reported incidence and the 311 resulting daily R t estimates ( Figures 2 & 3 , appendix pp2 & 4 ) . Using reconstructed incidence considerably 312 smoothed the daily R t estimates , removing the impact of weekend - effects . The overall agreement in the 313 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint classification of R t as increasing , uncertain , or declining between estimates made from each dataset rose 314 substantially when some of the variability in the reported data was smoothed by estimating R t using weekly 315 sliding windows ( appendix pp8 - 9 ) . 316 317 Despite both being affected by weekly periodicity in reporting , concordance of R t estimates obtained from 318 COVID - 19 case data is considerably better than for influenza , perhaps due to the greater quantity of data , with 319 a very strong positive correlation between daily and weekly R t estimates ( Figure 3 ) . This is reflected in the high 320 overall agreement in the classification of R t estimates obtained from the reported and reconstructed datasets . 321 It is important to note that outlying and much larger R t estimates obtained from both datasets coincide with 322 the early phase of the epidemic , when incidence was lower and the prior for R t ( µ = 5 , s = 5 ) had more weight 323 on estimates . 324 325 During the early stages of epidemics , despite there being far fewer deaths than cases , death data can 326 sometimes be considered more reliable . 22 , 23 For example , case reporting is affected by surveillance system 327 quality and the robustness of testing practices , which can vary considerably over the course of an epidemic , 328 especially early on . COVID - 19 incidence by date of death is much less influenced by administrative noise in the 329 data ( appendix p8 ) , and the reconstructed incidence is most similar to the reported daily incidence of any case 330 study . Therefore , the greatest differences in R t estimates from death data coincide with periods of low 331 incidence ( appendix p7 ) when uncertainty increases . Weekly sliding R t estimates are equally as correlated as 332 those from COVID - 19 case data , but daily R t estimates are the most strongly correlated of any dataset ( Figure 333 4 ) . Additionally , there is very high overall agreement in the classification of daily and weekly R t ( appendix p9 ) . 334 This provides further support that differences between daily R t estimates for influenza and COVID - 19 cases is 335 likely due to the reconstructed incidence smoothing out weekly periodicity in reporting . 336 337 To investigate further , weekend effects were artificially introduced to data in the simulation study ( appendix 338 p21 ) . We have shown that , when using reported incidence , R t estimates are all strongly influenced by weekend 339 effects ( regardless of the smoothing time - window ) . Reconstructing daily incidence from weekly data 340 completely removes the effect of noise from resulting R t values , greatly improving the accuracy of estimates . 341 This demonstrates that it may be beneficial to artificially aggregate daily data , as has been done in previous 342 studies . 6 , 7 However , we did assume quite an extreme level of administrative noise , so in instances where the 343 pattern is less prominent , it may have less of an impact on estimates . Disentangling important temporal trends 344 in R t from noise in the data can be difficult , and if aggregated data is used it will be at the cost of reduced 345 temporal resolution in R t estimates . 346 347 This can be seen when the method is applied to data aggregated over longer timescales , such as ten - to 348 fourteen - days ( appendix pp22 - 24 ) . This approach requires two layers of smoothing : 1 ) the incidence is 349 smoothed over each aggregation window during the reconstruction process and 2 ) R t estimates are smoothed 350 by the sliding window chosen by the user . If a change in R t occurs at the end of an aggregation window ( i . e . on 351 the last day ) , such as a sudden decrease in R t due to a strict lockdown , that change is detected with a lag , 352 corresponding to the length of the sliding window used for R t estimation ( appendix p23 ) . However , if the event 353 occurs mid - aggregation window , then in addition to the usual lag caused by the sliding window , estimates will 354 be affected by the smoothing of the incidence within the aggregation window during reconstruction ( appendix 355 p24 ) . The change in R t will seem more gradual over the period that data are aggregated over and will appear 356 to start earlier than in reality ( corresponding to the first day of the aggregation window ) . It is important for 357 users to keep this in mind , particularly when using longer aggregations of data . 358 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 359 Another consideration is that the reconstructed incidence can have discontinuities in the borders between 360 aggregation windows ( appendix pp11 - 12 ) . This occurs because in reconstructing daily incidence we impose 361 that , if it were to be re - aggregated , it would match the original data . Methods that simply fit smoothing splines 362 to weekly data , inferring daily case counts from the daily difference in cumulative counts , are not affected by 363 this . 24 , 25 To circumvent this problem , we recommend that sliding windows used to estimate R t are at least 364 equal to or longer than the length of aggregation windows to reduce the impact of discontinuities on estimates 365 ( appendix pp22 - 24 ) . 366 367 Alternative approaches include modelling frameworks implemented in the Epidemia and EpiNow2 R 368 packages . 6 , 22 , 26 Daily infections are modelled as a latent process , back - calculated from observed data on cases 369 or deaths , depending on an appropriate infection to observation distribution . In addition , Epidemia integrates 370 further information , such as the infection ascertainment rate ( for cases ) or the infection fatality rate ( for 371 deaths ) . 22 This facilitates a ‘nowcasting’ approach , allowing users to estimate R t directly from the unobserved 372 infections , but they typically require more data ( e . g . incidence of deaths and cases ) , more assumptions ( e . g . 373 delay distributions and ascertainment rates ) , and are much more computationally intensive , which can be a 374 barrier to the adoption of such methods by users . 14 375 376 Here , R t estimates are based on a single daily incidence reconstruction , meaning R t can be estimated very 377 rapidly from aggregated data , which is particularly desirable during real - time outbreak analysis . 14 A potential 378 downside is that uncertainty in R t estimates could be underestimated . However , the simulation study showed 379 that the 95 % credible interval of estimates encompassed the correct value of R t the majority of the time , and 380 we found no substantial indication that this approach detrimentally affected our characterisation of the 381 uncertainty . 382 383 Given that this method is directly derived from EpiEstim , it relies on similar assumptions and caveats . 15 , 27 As 384 time of infection is more difficult to observe than symptom onset , the SI is typically used as an approximation 385 of the generation time in the renewal equation , which may introduce bias . 28 The SI , the level of undetected 386 cases , and the reporting rate are assumed to remain constant , which is often not the case in practice . Factors 387 such as changes in population immunity , and the introduction of interventions , can alter the SI throughout an 388 epidemic . 29 Whilst changing case definitions , new testing practices , and increased healthcare - seeking 389 behaviour , can all affect case ascertainment . 15 Parameters chosen by users can also influence estimation 390 accuracy , for instance , the time window length for temporal smoothing and the prior for R t . 27 391 392 To make the method simple to implement for current and future users of EpiEstim , this extension has been 393 fully integrated with the ‘estimate _ R ( ) ’ function in the original R package on github . 30 Just one additional 394 parameter is required – the number of days data are aggregated over ( with some other optional parameters ) . 395 More details regarding the applications of this method can be found in the package vignette and associated 396 examples . 30 397 398 Conclusion 399 400 We extended the widely used R t estimation approach proposed by Cori et al . , 15 and implemented in the R 401 package EpiEstim , to incorporate a new feature which allows R t to be easily estimated from any temporal 402 aggregation of incidence data . We have demonstrated that the method performs well using both simulated 403 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint and real - world data , recovering or even improving upon the estimates that would have been made from 404 reported daily data . This extension is easy to use and computationally efficient , which will enable 405 epidemiologists and other public health professionals to apply EpiEstim to a wider range of diseases and 406 epidemic contexts . 407 408 409 1 . Baker RE , Mahmud AS , Miller IF , Rajeev M , Rasambainarivo F , Rice BL , et al . Infectious disease in an era 410 of global change . Nat Rev Microbiol . 2022 Apr ; 20 ( 4 ) : 193 – 205 . 411 2 . National flu and COVID - 19 surveillance reports : 2021 to 2022 season [ Internet ] . GOV . UK . [ cited 2022 Jun 412 27 ] . Available from : https : / / www . gov . uk / government / statistics / national - flu - and - covid - 19 - surveillance - 413 reports - 2021 - to - 2022 - season 414 3 . Pacheco O , Beltrán M , Nelson CA , Valencia D , Tolosa N , Farr SL , et al . Zika Virus Disease in Colombia — 415 Preliminary Report . New England Journal of Medicine . 2020 Aug 6 ; 383 ( 6 ) : e44 . 416 4 . Notifiable diseases : weekly reports for 2022 [ Internet ] . GOV . UK . [ cited 2022 Jun 27 ] . Available from : 417 https : / / www . gov . uk / government / publications / notifiable - diseases - weekly - reports - for - 2022 418 5 . Notifiable Infectious Disease Tables | CDC [ Internet ] . 2021 [ cited 2022 Jul 2 ] . Available from : 419 https : / / www . cdc . gov / nndss / data - statistics / infectious - tables / index . html 420 6 . Mishra S , Scott J , Zhu H , Ferguson NM , Bhatt S , Flaxman S , et al . A COVID - 19 Model for Local Authorities 421 of the United Kingdom [ Internet ] . medRxiv ; 2020 [ cited 2022 Jul 1 ] . p . 2020 . 11 . 24 . 20236661 . Available 422 from : https : / / www . medrxiv . org / content / 10 . 1101 / 2020 . 11 . 24 . 20236661v1 423 7 . Role of Data Aggregation in Biosurveillance Detection Strategies with Applications from ESSENCE 424 [ Internet ] . [ cited 2022 Jul 2 ] . Available from : 425 https : / / www . cdc . gov / mmwr / preview / mmwrhtml / su5301a16 . htm 426 8 . Ferguson NM , Cucunubá ZM , Dorigatti I , Nedjati - Gilani GL , Donnelly CA , Basáñez MG , et al . Countering 427 the zika epidemic in latin america . Science . 2016 ; 353 ( 6297 ) : 353 – 4 . 428 9 . Charniga K , Cucunubá ZM , Mercado M , Prieto F , Ospina M , Nouvellet P , et al . Spatial and temporal 429 invasion dynamics of the 2014 – 2017 Zika and chikungunya epidemics in Colombia . PLOS Computational 430 Biology . 2021 Jul 2 ; 17 ( 7 ) : e1009174 . 431 10 . Cowling BJ , Fang VJ , Riley S , Peiris JSM , Leung GM . Estimation of the serial interval of influenza . 432 Epidemiology . 2009 May ; 20 ( 3 ) : 344 – 7 . 433 11 . White LF , Wallinga J , Finelli L , Reed C , Riley S , Lipsitch M , et al . Estimation of the reproductive number 434 and the serial interval in early phase of the 2009 influenza A / H1N1 pandemic in the USA . Influenza and 435 Other Respiratory Viruses . 2009 ; 3 ( 6 ) : 267 – 76 . 436 12 . Bi Q , Wu Y , Mei S , Ye C , Zou X , Zhang Z , et al . Epidemiology and transmission of COVID - 19 in 391 cases 437 and 1286 of their close contacts in Shenzhen , China : a retrospective cohort study . The Lancet Infectious 438 Diseases . 2020 Aug 1 ; 20 ( 8 ) : 911 – 9 . 439 13 . Rai B , Shukla A , Dwivedi LK . Estimates of serial interval for COVID - 19 : A systematic review and meta - 440 analysis . Clin Epidemiol Glob Health . 2021 ; 9 : 157 – 61 . 441 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 14 . Nash RK , Nouvellet P , Cori A . Real - time estimation of the epidemic reproduction number : Scoping 442 review of the applications and challenges . PLOS Digital Health . 2022 Jun 27 ; 1 ( 6 ) : e0000052 . 443 15 . Cori A , Ferguson NM , Fraser C , Cauchemez S . A New Framework and Software to Estimate Time - Varying 444 Reproduction Numbers During Epidemics . Am J Epidemiol . 2013 Nov 1 ; 178 ( 9 ) : 1505 – 12 . 445 16 . Cori [ aut A , cre , Cauchemez S , Ferguson NM , Fraser C , Dahlqwist E , et al . EpiEstim : Estimate Time 446 Varying Reproduction Numbers from Epidemic Curves [ Internet ] . 2021 [ cited 2022 Jun 9 ] . Available 447 from : https : / / CRAN . R - project . org / package = EpiEstim 448 17 . Wallinga J , Lipsitch M . How generation intervals shape the relationship between growth rates and 449 reproductive numbers . Proceedings of the Royal Society B : Biological Sciences . 2007 Feb 450 22 ; 274 ( 1609 ) : 599 – 604 . 451 18 . Riley P , Cost AA , Riley S . Intra - Weekly Variations of Influenza - Like Illness in Military Populations . Military 452 Medicine . 2016 Apr 1 ; 181 ( 4 ) : 364 – 8 . 453 19 . Cases in the UK | Coronavirus in the UK [ Internet ] . [ cited 2022 Jan 9 ] . Available from : 454 https : / / coronavirus . data . gov . uk / details / cases 455 20 . Jombart T , Nouvellet P , Bhatia S , Kamvar ZN , Taylor T , Ghozzi S . projections : Project Future Case 456 Incidence [ Internet ] . 2021 [ cited 2022 Jun 9 ] . Available from : https : / / CRAN . R - 457 project . org / package = projections 458 21 . CSSEGISandData . COVID - 19 Data Repository by the Center for Systems Science and Engineering ( CSSE ) at 459 Johns Hopkins University [ Internet ] . 2022 [ cited 2022 Jul 5 ] . Available from : 460 https : / / github . com / CSSEGISandData / COVID - 19 461 22 . Flaxman S , Mishra S , Gandy A , Unwin HJT , Mellan TA , Coupland H , et al . Estimating the effects of non - 462 pharmaceutical interventions on COVID - 19 in Europe . Nature . 2020 ; 584 ( 7820 ) : 257 – 61 . 463 23 . Nouvellet P , Bhatia S , Cori A , Ainslie KEC , Baguelin M , Bhatt S , et al . Reduction in mobility and COVID - 19 464 transmission . Nat Commun . 2021 Feb 17 ; 12 ( 1 ) : 1090 . 465 24 . Yamauchi T , Takeuchi S , Yamano Y , Kuroda Y , Nakadate T . Estimation of the effective reproduction 466 number of influenza based on weekly reports in Miyazaki Prefecture . Scientific reports . 2019 ; 9 ( 1 ) : 1 – 9 . 467 25 . Nishiura H , Chowell G . Early transmission dynamics of Ebola virus disease ( EVD ) , West Africa , March to 468 August 2014 . Eurosurveillance . 2014 Sep 11 ; 19 ( 36 ) : 20894 . 469 26 . Abbott S , Hellewell J , Thompson RN , Sherratt K , Gibbs HP , Bosse NI , et al . Estimating the time - varying 470 reproduction number of SARS - CoV - 2 using national and subnational case counts . Wellcome Open Res . 471 2020 Jun 1 ; 5 : 112 . 472 27 . Gostic KM , McGough L , Baskerville EB , Abbott S , Joshi K , Tedijanto C , et al . Practical considerations for 473 measuring the effective reproductive number , Rt . PLOS Computational Biology . 2020 Dec 474 10 ; 16 ( 12 ) : e1008409 . 475 28 . Britton T , Scalia Tomba G . Estimation in emerging epidemics : biases and remedies . Journal of The Royal 476 Society Interface . 2019 Jan 31 ; 16 ( 150 ) : 20180670 . 477 29 . Ali ST , Wang L , Lau EHY , Xu XK , Du Z , Wu Y , et al . Serial interval of SARS - CoV - 2 was shortened over time 478 by nonpharmaceutical interventions . Science . 2020 Aug 28 ; 369 ( 6507 ) : 1106 – 9 . 479 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint 30 . mrc - ide / EpiEstim : A tool to estimate time varying instantaneous reproduction number during epidemics 480 [ Internet ] . [ cited 2022 Aug 9 ] . Available from : https : / / github . com / mrc - ide / EpiEstim 481 482 . CC - BY 4 . 0 International license It is made available under a perpetuity . is the author / funder , who has granted medRxiv a license to display the preprint in ( which was not certified by peer review ) preprint The copyright holder for this this version posted December 13 , 2022 . ; https : / / doi . org / 10 . 1101 / 2022 . 12 . 08 . 22283241 doi : medRxiv preprint
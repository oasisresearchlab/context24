Top ( 2012 ) 20 : 52 – 74 DOI 10 . 1007 / s11750 - 011 - 0212 - x ORIGINAL PAPER Enhancing discretized formulations : the knapsack reformulation and the star reformulation Luís Gouveia · Pedro Moura Received : 30 November 2010 / Accepted : 27 June 2011 / Published online : 9 August 2011 © Sociedad de Estadística e Investigación Operativa 2011 Abstract Discretized formulations have proved to be useful for modeling combina - torial optimizations . The main focus of this work is on how to strengthen the linear programming relaxation of a given discretized formulation . More precisely , we will study and strengthen subproblems that arise in these formulations . In one case we will focus on the so - called knapsack reformulation which is based on viewing these models as the intersection of two polyhedra , one of them being a specialized knap - sack problem . We will show that strong inequalities used in previous works are a special case of inequalities implied by the knapsack formulation . In the second case we will analyze a star - like subproblem and will provide an extended formulation for this problem as well as a set of inequalities on the original space , implied by the in - equalities of the extended formulation . We will use a generalization of the Degree Constrained Spanning Tree problem as a setting for this study . In the present work , besides contextualizing these enhancements in terms of discretized models presented in previous works , we also compare and combine together them , for the ﬁrst time . Keywords Spanning Tree · Degree constraints · Knapsack · Valid inequalities Mathematics Subject Classiﬁcation ( 2000 ) 68M10 · 90B10 · 90C27 · 90C10 1 Introduction Discretized formulations have proved to be useful for modeling combinatorial opti - mizations ( see , for instance , ( Gouveia 1995 ; Gouveia and Saldanha da Gama 2006 ; L . Gouveia ( (cid:2) ) · P . Moura CIO - DEIO , Faculty of Sciences , University of Lisbon , Lisbon , Portugal e - mail : legouveia @ fc . ul . pt P . Moura e - mail : pmmoura @ fc . ul . pt Enhancing discretized formulations 53 Correia et al . 2008 , 2010 ; Uchoa et al . 2008 ) . In several of these cases , the effec - tiveness of these models has been explained ( and empirically conﬁrmed ) for two rea - sons . One is the inclusion , explicitly or implicitly , in the models of one ( or several ) so - called “magic” equalities . These equalities permit us to generate valid and strong inequalities based on the Chvátal rounding procedure ( Wolsey 1998 ) and which sub - stantially improve the linear programming bound of the original model . The second reason is that the extra index in the variables characterizing these formulations per - mits us to model variations of combinatorial problems which are not easy to model , with non - discretized models . Although the main topic of this study is not on model - ing , the reader is referred to the following references where the power of discretiza - tion is exploited : a link between network ﬂow models and time - dependent models for the Asymmetric Traveling Salesman Problem is , as far as we know , ﬁrst given in Gou - veia and Voß ( 1995 ) ; a topical polyhedral result on a subproblem arising in problems with modular costs is given in Correia et al . ( 2010 ) ; discretization is used effectively to model node - oriented clique - based problems in Martins ( 2010 ) ; discretized models appear as an outcome of a linearization process in the study of location models with uncertain demands in Albareda - Sambola et al . ( 2011 ) ; and ﬁnally , a different polyhe - dral result where a new tight formulation for the Uncapacitated Lot Sizing Problem is obtained by discretization and coefﬁcient reduction is given in Constantino and Gouveia ( 2007 ) . In this work we provide general strategies for strengthening the linear program - ming relaxation of a given discretized formulation . We will use the concept of mod - ularity , that is , we will study and strengthen subproblems that arise in these formu - lations . In one case we will focus on the so - called knapsack reformulation which is based on showing how to view these problems as the intersection of two poly - hedra , one of them being a specialized knapsack problem deﬁned by the previously mentioned “magic” equality . We will show that the rounding inequalities mentioned before are a special case of inequalities implied by the knapsack formulation . In the second case we will identify and study a star - like subproblem . We will provide an extended and tight formulation for this problem as well as a set of inequalities on the original space , implied by the inequalities of the extended formulation . We will use a generalization of the Degree Constrained Spanning Tree problem ( denoted by GDMST in the following ) as a setting for this study . In fact , in earlier studies of this problem the rounded inequalities that have worked so well for other problems proved to be ineffective . The need for explaining these results as well as the need to search for alternative stronger models has motivated most of what is described next . The idea of analyzing the star - like subproblem has already been described in Gou - veia and Moura ( 2008 ) and Gouveia et al . ( 2011 ) and the knapsack reformulation has been ﬁrst suggested in Gouveia and Moura ( 2010 ) ( see also Duhamel et al . 2011 ) . In the present work , we compare these two approaches , show how to contextualize them in terms of other models and try to give suggestions on when to use one of the approaches or the other . As far as we know this is the ﬁrst study that contextualizes one approach in terms of the other . In Sect . 2 we review the GDMST used for this study and in Sect . 3 we present several integer linear programming formulations for this problem : in Sect . 3 . 1 we
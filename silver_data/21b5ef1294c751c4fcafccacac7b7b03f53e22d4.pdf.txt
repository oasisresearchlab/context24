a r X i v : c ond - m a t / 0110574v3 [ c ond - m a t . s t a t - m ec h ] 26 N ov 2001 Deﬁning statistical ensembles of random graphs ∗ Andr´e Krzywicki Laboratoire de Physique Th´eorique , Bˆatiment 210 Universit´e Paris - Sud , 91405 Orsay , France † Abstract The problem of deﬁning a statistical ensemble of random graphs with an arbitrary connectivity distribution is discussed . Introducing such an ensemble is a step towards uderstanding the geometry of wide classes of graphs independently of any speciﬁc model . This research was triggered by the recent interest in the so - called scale - free networks . LPT Orsay 01 / 102 October 2001 1 Introduction This is a workshop talk and therefore I do not hesitate to report about partial results of a research still in progress . I shall also submit you a couple of queries , with the hope of attracting your interest and triggering a discussion . I have beneﬁted from collaboration with Z . Burda , the late J . D . Correia and J . Jurkiewicz ( cf ref . [ 1 ] and papers quoted therein ) . ∗ Talk at the workshop ”Discrete random geometries and quantum gravity” , Utrecht , October 2001 † Unit´e Mixte du CNRS UMR 8627 . 1 Let me recall that a graph is just a collection of vertices ( nodes ) and links ( edges ) connecting vertices . It is a mathematical idealization representing various networks one encounters in nature , in social life , in engineering , etc . For example , the web can be represented by a graph : the vertices are the URLs and the links are the hyperlinks . Likewise , the network of sexual relations in a population can be represented by a graph . The study of its geometry has some interest for epidemiology . In these examples , as in many other ones , the pattern of connections between vertices is fairly random . The concept of a random graph emerges quite naturally . For deﬁniteness , I shall consider graphs with undirected links only . When one is talking about random graphs , one has of course in mind a statistical ensemble of graphs . How to deﬁne such an ensemble ? The simplest answer is given in the framework of the classical model developed by Erd¨os , R´enyi and their followers [ 2 ] : in a set of N vertices one connects at random L out of N ( N − 1 ) / 2 possible pairs of vertices . All possible graphs constructed that way form the ensemble in question . The probability p to connect a pair of vertices is the control parameter of the model . The geometry of graphs changes in a very interesting and by now fully understood manner when p changes . However , in this ensemble the distribution of connectivity ( vertex degree ) is always Poissonian . It turns out that connectivity distributions very diﬀerent from Poissonian are observed in a variety of observed networks . In particular , in a number of interesting networks this distribution has a tail falling like a power of the vertex degree . These networks have been baptized scale - free by Barab´asi and Albert [ 3 ] . The properties of scale - free networks are commonly discussed in the framework of simple growth models ( where the connectivity distribution becomes stationary and scale - free at large time ) . These models are invaluable for illustrating basic dynamical mechanisms , like the preferential attachment rule . However , they are not fully realistic . For a variety of reasons one would like to understand the generic geometries of wide classes of graphs . This can be presumably better achieved by deﬁning consistently the correspond - ing statistical ensembles , instead of producing more and more complicated growing network models . The aim of this talk is to discuss problems one encounters trying to deﬁne a statistical ensemble of random graphs with an a priori given connectivity distribution . The deﬁnition can be more or less formal . It can be implicit , reducing to the formulation of an algorithm enabling one to sample graphs , for example with the help of a computer . 2 2 The Molloy - Reed construction Let p n denote here the connectivity distribution . In ref . [ 4 ] Molloy and Reed propose a speciﬁc method of constructing graphs with a given p n . They proceed in two steps : ( a ) First , N auxiliary graphs are created . The number of links of an auxiliary graph is randomly generated from the probability distribution p n . By construction all these links meet at a common vertex and have the other end free . The number of free - end links in the full set of auxiliary graphs must be even , otherwise one restarts the construction . ( b ) Second , in the full set of N auxiliary graphs the successive pairs of free link ends are picked at random and connected , until no free link end remains . In this manner , one creates a single graph with vertex degrees n 1 , n 2 , . . . n N . Notice , that the number of links of that graph L = 1 / 2 P j n j is not kept ﬁxed . In the ensemble of graphs it does ﬂuctuate around the average value 1 / 2 N h n i , where h . . . i = P n . . . p n . This is perhaps a weak point of the construction , since L / N is a sensitive parameter in graph theory . On the other hand , it is very pleasant that the connectivity distribution matches p n for individual graphs . Notice also that these graphs are , in general , not connected . Further - more , they are , in general , ”degenerate” : there may be multiple connections between vertices and certain links may connect a vertex to itself 1 . For a given set n 1 , n 2 , . . . n N a non - degenerate graph may simply not exist . Moreover , en - forcing non - degeneracy , when it is possible , introduces a bias . Although in each graph the connectivity distribution matches p n up to ﬂuctuations , signif - icant deviations from p n can appear , when the distribution is calculated for a large ensemble of graphs , if certain ﬂuctuations are systematically favoured . This remark is particularly pertinent to the case of scale - free graphs , where the connectivity distribution has a long tail , subject to important ﬂuctua - tions . 1 I met the opinion that in this construction the degenerate graphs become unimportant in the limit N → ∞ . This is false . It is easy to count graphs . When N → ∞ and x = L / N is kept ﬁxed , the non - degenerate graphs are a ﬁnite fraction , viz . exp [ − 2 x ( 1 + x ) ] , of all possible graphs . 3 3 Miniﬁeld theory : random graphs and Feyn - man diagrams The miniﬁeld theory is deﬁned by the following formal integral Z ∼ Z dφ exp 1 κ [ − φ 2 / 2 λ + X n p n φ n ] ( 1 ) where the integration variable φ is a real number , κ , λ , p 1 > 0 and p n ≥ 0 for n > 1 . Although , strictly speaking , the integral does not exist , the perturbative expansion of Z in powers of the ”couplings” p n is well deﬁned . As in ﬁeld theory , the individual terms of the expansion can be represented by Feynman diagrams . The ”propagator” equals λ , κ plays the role of the Planck constant and p 1 that of an ”external current” ( a pedagogical presentation for people not very familiar with ﬁeld theory methods can be found in [ 1 ] ) . The idea is to identify the Feynman diagrams of this toy model with the graphs of a statistical ensemble . Indeed , the Feynman diagrams of the miniﬁeld theory are the graphs familiar to people working on networks , except that there is a speciﬁc weight - the ”Feynman amplitude” - attached to each graph . In the ”semiclassical limit” κ → 0 only tree graphs survive and the model is exactly solvable . According to the Feynman rules , the weight of a non - degenerate graph with N vertices and L links is weight = κ L − N λ L N ! N Y j = 1 [ p n j n j ! ] ( 2 ) In the presence of degeneracies one has to multiply the rhs by the standard symmetry factors . Actually , the construction of Feynman diagrams does not diﬀer from the construction of graphs following the Molloy - Reed recipe . Here , the auxiliary graphs are those deﬁned by the ”interactions” p n φ n . However , the weight factor κ L − N λ L / N ! does not appear there ; the ﬂuctuations of L result from ﬂuctuations of the generated vertex degrees . In contrast , we introduce here a speciﬁc fugacity of links λ and a parameter , κ , controlling the number of loops in connected components . The following Metropolis algorithm generates graphs with ﬁxed N and L : one picks a random link ~ ij and a random vertex k 6 = i , j and one rewires ~ ij → ~ ik with probability P rewire = ( n k + 1 ) R ( n k + 1 ) / n j R ( n j ) ( 3 ) 4 when the rhs above is less than unity , and with probability equal to one otherwise . Here R ( n ) = p n / p n − 1 . When n j = 1 , the attempt is rejected , so that vertices with zero connectivity are never created . The rhs of ( 3 ) follows from ( 2 ) and the detailed balance condition . It turns out , that this last condition insures that the symmetry factors in the weights of degenerate graphs come out correctly too . The presence of the factor ( n k + 1 ) / n j on the rhs of ( 3 ) means that the rewired vertices are sampled independently of their degree . Furthermore , the rewiring depends on the vertex degrees only and is insensitive to the rest of the underlying graph structure . Hence , as far as the distribution of vertex degrees is concerned , the model is isomorphic to the well known balls - in - boxes model [ 5 ] , deﬁned by the partition function z ∼ X n j p ( n 1 ) . . . p ( n N ) δ ( M − N X j = 1 n j ) ( 4 ) and describing M balls distributed with probability p n among N boxes ( in our case M = 2 L ) . The constraint represented by the Kronecker delta on the rhs of ( 4 ) is satisﬁed ”for free” when N → ∞ by virtue of Khintchin’s law of large numbers , provided h n i < ∞ and M / N = h n i . When the last condition is met the occupation number distribution of a single box is just p n . Consequently , in the statistical ensemble including degenerate graphs the connectivity distribution is p n provided the number of links is set to L = 1 / 2 N h n i ( notice , that it is the average number of links in the Molloy - Reed construction ) . It is easy to calculate the number of such graphs for ﬁxed L / N . It increases with N like exp [ const N log N ] , the ensemble is overex - tensive 2 . Hence , it is not guaranteed that the connectivity distribution is p n for individual graphs , it is so when one averages over the ensemble . This should not be a serious ﬂaw in applications . The algorithm works also very well for trees . It suﬃces to start with a tree graph , for example with a polyline , and impose the constraint that n i = 1 . Then , all successively generated graphs are also trees . As already mentioned , the model is analytically solvable when one limits one’s attention to tree graphs . One can show exactly that in this case the connectivity distribution is ∼ np n 3 . Hence , in order to get an a priori given connectivity distribution P n one should set the couplings of the tree model to p n ∼ P n / n . 2 The ensemble of non - degenerate graphs is overextensive too ( cf the footnote on p . 3 ) ; it becomes extensive in the limit κ → 0 , ie for tree graphs . 3 The following heuristic argument can help to understand that : trees can always be 5 A fairly comprehensive discussion of the ensemble of random tree graphs is presented in [ 1 ] , with emphasis on the hot problem of scale - free graphs . I shall not enter into this discussion here , apart from the few words to follow . The partition function ( 1 ) can be calculated in the saddle point ( ”semi - classical” ) approximation . The saddle point condition , identical to a familiar equation in polymer physics , is a starting point for further calculations . In particular , one can ﬁnd the fractal dimension d H of the tree graphs . This was ﬁrst done in [ 6 ] for the so - called generic case , with the result d H = 2 . For scale - free graphs the connectivity distribution falls like n − β and one ﬁnds [ 7 , 1 ] in the empirically interesting situation 2 < β ≤ 3 : d H = ( β − 1 ) / ( β − 2 ) ( 5 ) while d H = 2 again for β > 3 . An inﬁnite d H is found in the rather special case , where a singular vertex with ﬁxed degree of order O ( N ) is present in ( almost ) all trees of the ensemble 4 . It is very easy to supplement the algoritm with a constraint insuring that all produced graphs are non - degenerate . However , this introduces a bias . We do not know yet how to choose the input data , ie the couplings p n , in order to get at the output a desired connectivity distribution . The problem is solved for degenerate graphs and for trees , as stated above , but for non - degenerate graphs it remains open : Query : What are the miniﬁeld theory couplings p n leading to a given connectivity distribution in the ensemble of non - degenerate graphs ? The ensemble of graphs deﬁned by ( 1 ) is fairly general , but not the most general one : the weight of a graph is a product of factors corresponding to individual vertices . One can introduce correlations between neighbor vertices replacing ( 1 ) by Z ∼ Z d q φ exp 1 κ [ − ~ φA ~ φ + q X n = 1 φ nn ] ( 6 ) where ~ φ = ( φ 1 , φ 2 , . . . , φ q ) and A is some q × q symmetric matrix with positive elements . The cut - oﬀ q can be eventually sent to inﬁnity ( but in order to embedded in a plane . They are obtained by gluing successive vertices ( auxiliary graphs ) . But each vertex with n links attached to it could have been rotated in the plane up to n times before beeing glued to the tree it belongs to and this rotation would not aﬀect the result . Consequently , the weight of a vertex is ∼ np n instead of p n , because of this speciﬁc symmetry . 4 The Cayley tree , a graph with a minimal entropy in our ensemble , also has d H = ∞ . 6 study the tree content of the model the limit κ → 0 should be taken ﬁrst ) . This model has not been studied yet : Query : What are the properties of the ensemble deﬁned by ( 6 ) , for rea - sonable choices of the correlation inducing matrix A ? Even a study of the ”semiclassical” limit alone would be of interest . 4 Growing networks Recently , much activity has been devoted to the formulation of growing net - work algorithms producing the so - called scale - free graphs ( see , for example , refs . [ 3 , 8 , 9 ] ) . In these models and at large ”time” the average connectivity becomes stationary , except for the tail where ﬁnite size ( time ! ) corrections are felt . A repeated use of such a growing network algorithm deﬁnes a statistical ensemble and , with this strategy , it is not diﬃcult to produce non - degenerate graphs only . The connectivity distribution cannot be chosen at will , it has a shape speciﬁc to the model at hand . But one can usually adjust the pa - rameters of the algorithm to control the large vertex degree behavior . The major problem with this approach is that it is diﬃcult to decide whether the results one obtains are generic or just reﬂect the speciﬁc dynamics of a rather simple model . Let me illustrate this point with an example in the next section . 5 Graph diameters Consider tree graphs with connectivity distribution P n = 4 n ( n + 1 ) ( n + 2 ) ( 7 ) They can be generated by the Barabasi - Albert growing network recipe [ 3 , 8 ] , or by the algorithm presented in Sec . 3 , provided the couplings are set to p n = P n / n . For a given graph let n ( r ) denote the number of vertices separated by geodesic distance r from a randomly chosen ”reference” vertex . Averaging over the ensemble of graphs one is interested in and over the possi - ble choices of the ”reference” vertex , one gets a speciﬁc ”two - point function” h n ( r ) i , which can be used to deﬁne the average diameter of a graph . All this is easily done on a computer . The result , illustrated in Figs 1 and 2 , 7 0 50 0 0 . 05 0 . 1 0 . 15 normalized < n ( r ) > vs r r BCK Figure 1 : The normalized two - point function h n ( r ) i in the statistical ensemble deﬁned in [ 1 ] calculated for the number of nodes N = 100 , 400 , 1600 , 6400 . The connectivity distribution is given by eq ( 7 ) . 0 10 20 0 0 . 1 0 . 2 normalized < n ( r ) > versus r r BA Figure 2 : The normalized two - point function h n ( r ) i in the ensemble of graphs generated by the growing network algorithm proposed by Barabasi - Albert in [ 3 ] , calculated for the number of nodes N = 100 , 400 , 1600 , 6400 . The connectivity distribution is given by eq ( 7 ) . 8 100 1000 10000 0 10 20 30 40 < r > N BA BCK Figure 3 : The average size of a graph h r i versus N in the two models . It seen that in the Barabasi - Albert model the growth of h r i is logarithmic . is that h n ( r ) i is very diﬀerent in the two models . In the Barabasi - Albert model the graph diameter grows like log N , while in the model of Sec . 3 it grows like a power of N ( see Fig . 3 ) . Manifestly , the Barabasi - Albert model explores only a fraction of available phase - space . This is simply explained : the vertices of highest degree are the oldest ones and tend in this model to be close to each other . Consequently , the distance between other vertices is also much smaller than in a truly random tree . Another deviation from randomness in growing networks was observed earlier by Callaway et al [ 10 ] . Incidentally , it appears that h r i ∼ log N in the ensemble of degenerate graphs with the same P n generated by the algorithm of Sec . 3 ( see Fig . 4 ) . Intuitively it is obvious that the growth of the diameter becomes slower when loops can be formed often enough since they produce ”shortcuts” . Actually , the ”small world” behavior h r i ∼ log N is found in a large variety of networks . I do not know any rigorous derivation of this result in a suﬃciently general context . In the network community one often refers to ref . [ 11 ] . Unfortunately , although ref . [ 11 ] is otherwise an interesting paper , their derivation of this logarithmic growth is mathematically incorrect . They have in mind the Molloy - Reed construction , but they actually consider tree 9 100 1000 10000 4 5 6 7 N < r > Figure 4 : The average size h r i of the giant component versus N = average # nodes in the component for general ( degenerate ) graphs with loops . N is not very large and ﬁnite size correction to h r i is important . The connectivity distribution is ( 7 ) for the full graph and falls also roughly like ∼ n − 3 for the giant component . graphs with uncorrelated vertex degrees , and for such trees the diameter usually grows as a power of N . To see the mistake , notice that for a given ”reference” vertex one has 1 + n ( 1 ) + n ( 2 ) + . . . + n ( r max ) = N ( 8 ) Newman et al replace all the quantities in ( 8 ) by their bulk average values . However , this is , in general , illegal . With each ”reference” point is associated a speciﬁc sequence n ( 1 ) , n ( 2 ) , . . . . The conditional probability that n ( r ) = k diﬀers from the bulk probability that a vertex has k r th - near - neighbors . It depends on the sequence leading to n ( r ) . One has to attach probability measures to possible sequences in graphs and also to graphs . The problem is not trivial but it was solved by Ambjørn et al [ 6 ] precisely for the class of connected tree graphs considered in ref . [ 11 ] . The result is that generically the Haussdorf dimension is ﬁnite and therefore the graph diameter grows like a power of N , as already mentioned . Hence , I end this talk with another query : Query : What are the general conditions insuring that the ”small world” behavior h r i ∼ log N does actually hold as an exact result for N → ∞ ? 10 A nice theorem awaits for being formulated and proved ! I wish to thank Serguei Dorogovtsev for pointing out to me that an ar - gument used in the original version of this text is spurious . References [ 1 ] Z . Burda , J . D . Correia , A . Krzywicki , Phys . Rev . E64 , 046118 ( 2001 ) . [ 2 ] B . Bollob´as , Random graphs ( Academic Press , London , 1985 ) . [ 3 ] A . - L . Barab´asi , R . Albert , Science 286 , 509 ( 1999 ) . [ 4 ] M . Molloy , B . Reed , Random Struct . Algorithms 6 , 161 ( 1995 ) ; Combi - natorics , Probab . Comput . 7 , 295 ( 1998 ) . [ 5 ] P . Bialas , Z . Burda , D . Johnston , Nucl . Phys . B542 , 413 ( 1999 ) . [ 6 ] J . Ambjørn , B . Durhuus , T . Jonsson , Phys Lett B244 , 403 ( 1990 ) [ 7 ] J . Jurkiewicz , A . Krzywicki , Phys . Lett . B392 , 291 ( 1997 ) . Caution : the conclusion of subsection 3 . 2 is erroneous . [ 8 ] P . L . Krapivsky , S . Redner , Phys . Rev . E63 , 066123 ( 2001 ) ; S . N . Doro - govtsev , J . F . F . Mendes , A . N . Samukhin , Phys . Rev . Lett . 85 , 4633 ( 2000 ) . [ 9 ] S . N . Dorogovtsev , J . F . F . Mendes , Europhys . Lett . 52 , 33 ( 2000 ) ; R . Albert , A . - L . Barabasi , Phys . Rev . Lett . 85 , 5234 ( 2000 ) ; S . N . Doro - govtsev , J . F . F . Mendes , Phys . Rev . E63 , 056125 ( 2001 ) ; K . Klemm , V . M . Eguiluz , cond - mat / 0107606 [ 10 ] D . S . Callaway , J . E . Hopcroft , J . M . Kleinberg , M . E . J . Newman , S . H . Strogatz , Phys . Rev . E 64 , 041902 ( 2001 ) . [ 11 ] M . E . J . Newman , S . H . Strogatz , D . J . Watts , Phys . Rev . E64 , 026118 ( 2001 ) . 11
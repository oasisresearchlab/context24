2340 Exact Stochastic Simulation of Coupled Chemical Reactions Daniel T . Gillesple Danlel T . Gillespie Research Department , Na Val Weapons Center , China Lake , California 93555 ( Received May 72 , 1977 ) Publication costs assisted by the Naval Weapons Center There are two formalisms for mathematically describing the time behavior of a spatially homogeneous chemical system : The deterministic approach regards the time evolution as a continuous , wholly predictable process which is governed by a set of coupled , ordinary differential equations ( the “reaction - rate equations” ) ; the stochastic approach regards the time evolution as a kind of random - walk process which is governed by a single dif - ferential - difference equation ( the “master equation” ) . Fairly simple kinetic theory arguments show that the stochastic formulation of chemical kinetics has a firmer physical basis than the deterministic formulation , but unfortunately the stochastic master equation is often mathematically intractable . There is , however , a way to make exact numerical calculations within the framework of the stochastic formulation without having to deal with the master equation directly . It is a relatively simple digital computer algorithm which uses a rigorously derived Monte Carlo procedure to numerically simulate the time evolution of the given chemical system . Like the master equation , this “stochastic simulation algorithm” correctly accounts for the inherent fluctuations and correlations that are necessarily ignored in the deterministic formulation . In addition , unlike most procedures for numerically solving the deterministic reaction - rate equations , this algorithm never approximates infinitesimal time increments dt by finite time steps At . The feasibility and utility of the simulation algorithm are demonstrated by applying it to several well - known model chemical systems , including the Lotka model , the Brusselator , and the Oregonator . I . Introduction In this paper we shall be concerned with the following general problem : If a fixed volume V contains a spatially uniform mixture of N chemical species which can inter - react through M specified chemical reaction channels , then given the numbers of molecules of each species present at some initial time , what will these molecular population levels be at any later time ? The traditional way of treating this problem begins by translating it into the mathematical language of ordinary differential equations . More specifically , if we assume that the number of molecules of the ith species in V at time t can be represented by a continuous , single - valued function X , ( t ) ( i = 1 , . . . , N , and if we further assume that each of the M chemical reactions can be regarded as a continuous rate process , then we can easily construct a set of coupled , first - order , ordinary differential equations of the form d X , / d t = fl ( X1 , . . . J N ) u Z / d t = . . . . fZ ( X1 , - * J N ) ( 1 ) a N / d t = fN ( x1 , . * . J N ) The specific forms of the functions fi on the right ( which are usually nonlinear in the Xi’s ) are determined by the structures and rate constants of the M chemical reaction channels . These equations are called the “reaction - rate equations” ; solving them for the functions Xl ( t ) , . . . , Xdt ) , subject to the prescribed initial conditions , is tantamount to solving the time - evolution problem posed earlier . Analytical solutions to the reaction - rate equations can be found only for rather simple systems , so it is usually necessary to solve these equations numerically on a computer . As is evident from many of the papers in this symposium series , the art of reliably solving reaction - rate equations on a computer has been developed to an im - pressive and sophisticated level . * Address correspondence to the author at Code 3821 , Naval Weapons Center , China Lake , Calif . 93555 . Although the great importance and usefulness of the differential reaction - rate equations approach to chemical kinetics cannot be denied , we should not lose sight of the fact that the physical basis for this approach leaves something to be desired . This approach evidently assumes that the time evolution of a chemically reacting system is both continuous and deterministic . However , the time evolution of a chemically reacting system is not a con - tinuous process , because molecular population levels obviously can change only by discrete integer amounts . Moreover , the time evolution is not a deterministic process either . For , even if we put aside quantum considerations and regard the molecular motions to be governed by the equations of classical mechanics , it is impossible even in principle to predict the exact molecular population levels at some future time unless we take account of the precise positions and velocities of all the molecules in the system . In other words , although the temporal behavior of a chemically reacting system of classical molecules is a deterministic process in the full position - momentum phase space of the system , it is not a deterministic process in the N - dimensional subspace of the species population num - bers , as ( 1 ) implies . In many cases of course the time evolution of a chemically reacting system can , to a very acceptable degree of accuracy , be treated as a continuous , deterministic process . However this should not always be taken for granted , especially now that the attention of chemical kineticists is increasingly being drawn to the study of ecological systems , microscopic biological systems , and nonlinear systems driven to conditions of chemical in - stability . In some cases like these , the inability of the reaction - rate equations to describe the fluctuations in the molecular population levels can be a serious shortcoming . Moreover , contrary to widespread belief , it is not even guaranteed that the reaction - rate equations will provide a sufficiently accurate account of the auerage molecular population levels ; for , except for very simple linear systems , the average molecular population levels will not exactly satisfy any closed system of equations such as ( 1 ) . The Journal of Physical Chemistry , Voi . 8 1 , No . 25 , 1977 2341 ' 0 ' Input valuer for e " [ " = I , . . . , hi ) . . Set ti0 and n = O . . Initialize URN . . input initial for xi [ < = I . . . . . NI . Stochastic Simulation of Coupled Chemical Reactions r - , MOLECULE 1 I . Calculate Eiy = hyoy ( " = I , . . . , M ) . M " = I . Calculate ao = 1 n . t . 2 . Generate PI and PS from URN . ' Take ~ = ( l / aolin ( l / ~ ~ ) . . Take u IO that Ir - 1 ! J " = I " i 1 1 O , , < Fzao $ 1 a " . < t 3 ' Put t . t + T . . Adjust Xi values according to R . . Put * = * * 1 . u 2 Figure 1 . The " collision volume " 6 Vod , which molecule 1 will sweep out relative to molecule 2 in the next small time interval 6t . Many chemical kineticists would probably argue that these considerations are rather academic , because despite whatever shortcomings the differential reaction - rate equations may have , they seem to provide the only practical means for numerically analyzing the time be - havior of nontrivial chemical systems . However , in a recent paper by this writer , ' a new computational method was developed from premises which take explicit account of the fact that the time evolution of a spatially homogeneous chemical system is a discrete , stochastic process instead of a continuous , deterministic process . This new com - putational method , which we shall refer to as the " stochastic simulation algorithm " , now offers an alternative to the differential reaction - rate equations - an alternative that is free of the difficulties mentioned above . In sections I1 and I11 of this paper , we shall describe the stochastic simulation algorithm and give a brief synopsis of the arguments used in ref 1 to derive it . Then , in section IV , we shall exhibit for the first time some actual numerical results that have been obtained in applying the algorithm to some well - known model chemical systems . Our purpose in section IV will be not so much to shed new light on the models treated as to illustrate in a convincing way the feasibility and utility of our new computational method . 11 . Physical Basis of the Stochastic Formulation of Chemical Kinetics In general , a chemical reaction occurs whenever two or more molecules of appropriate kinds collide in an ap - propriate way . The " stochastic formulation " of chemical kinetics is simply a consequence of taking seriously the fact that collisions in a system of molecules in thermal equi - librium occur in an essentially random manner . In this section we want to sketch briefly how this intuitive notion can be expressed in a more precise , quantitative way ; a more detailed treatment may be found in ref 1 . IIA . Molecular Collisions . Consider a system composed of a mixture of two gas - phase molecular species , SI and Sz , in thermal ( but not necessarily chemical ) equilibrium inside some volume V . For simplicity , let us assume that the SI and S2 molecules are hard spheres of radii rl and rz , respectively . Then a 1 - 2 collision will occur whenever the center - to - center distance between an SI molecule and an Sz molecule decreases to r12 = rl + r2 . Let us try to calculate the rate at which such collisions are occurring in V . Following traditional textbook derivations of the molecular collision rate , we begin by picking an arbitrary 1 - 2 molecular pair , and denoting by ulZ the speed of molecule 1 relative to molecule 2 . We then observe that , in the next small time interval 6t , molecule 1 will sweep out relative to molecule 2 a " collision volume " SV , " = m122 . u12 6t ( see Figure l ) , in the sense that if the center of molecule 2 happens to lie inside 6Vwtt at time t , then the two molecules will collide in the time interval ( t , t + St ) . The usual procedure now would be to estimate the number of S2 molecules whose centers lie inside SV , , , , Flgure 2 . Schematic of the stochastic simulation algorithm . Flgurc 3 . The one - standard deviation envelope ( dashed ) and two - siandara deviation envelope ( solid ) as CalcJlated from the master equalon . superimposed on me resm of one slocnastic s . mmtion run ( dots ) . of tne simple isomerization reaction ( 221 with c = 0 5 and X , = 1000 . The simulation run s ploned a1 1 rpd ( reactions per dot ) . divide that number by 6r , and then take the limit 6t - - 0 LO obtain the rate at which the S , molecule is colliding with S ? molecules . However , this procedure suffers from an emharassing difficulty : As 6V , , , - 0 , the number of S . ? molecules whose centers lie inside 6V , , will be either I or 0 . with the latter possibility becoming more and more likely as the limiting process proceeds . Strictly speaking . then , it is physically meaningless to talk about . ' the number at ' molecules whose centers lie inside bv , , , , , in the required limit of vanishingly small 61 . Instead of following the usual prartice of overriding this difficulty with nonrigorous " averaging " arguments , let us redirect our inquiry in the following way Since the system is in thermal equilihrium , the molecules will at all times he distributed randomly and uniform / ) throughout the containing volume V . Therefore , the prubabilily that the center of an arbitrary S2 molecule will he found inside 6V , , , at time r will he given by the simple ratio ~ 6 \ ' ~ , , , 1 ' ; moreover , this is true wen in rhe limit of uanishingly small 6V , , . If we now average this ratio over the velocity distributions of the St and S2 molecules . we may conclude 2342 Daniel T . Gillespie time Figure 4 . Same as Figure 3 , except Xo = 5000 and the run is plotted at 5 rpd . time Flgure 5 . Same as Figure 3 , except Xo = 10000 and the run is plotted at 10 rpd . that 6 V , , / V = T’ nr122G 6 t = average probability that a particular 1 - 2 molecular pair will collide in the next vanishingly small time interval 6 t ( 2a ) For Maxwellian velocity distributions the average relative speed will be equal to ( 8 k T / ~ m ~ ~ ) ~ / ~ , where k is Boltzmann’s constant , T the absolute temperature , and m12 the reduced mass m1m2 / ( m1 + mz ) . In any case , if we are given that at time t there are in VX1 of the SI mol - ecules and X2 of the S2 molecules , making a total of XlXz distinct 1 - 2 molecular pairs , then it follows from ( 2a ) that2 XlX2V - ’ n r 1 2 2 G dt = probability that a 1 - 22 collision will occur some - where inside V in the next infinitesimal time interval ( t , t + dt ) ( 2b ) We see then that , although we cannot rigorously cal - culate the number of 1 - 2 collisions occurring in V in any infinitesimal time interval , we can rigorously calculate the probability of a 1 - 2 collision occurring in V in any in - finitesimal time interval . This means that we really ought to characterize a system of thermally equilibrized mole - cules by a “collision probability per unit time” - namely , the coefficient of dt in ( 2b ) - instead of by a “collision rate” . This is why these collisions constitute a stochastic Markov process instead of a deterministic rate process . IIB . The Stochastic Reaction Constant c , . If one applies the foregoing arguments specifically to reactive collisions ( i . e . , collisions which result in chemical alterations The Journal of Physical Chemistry , Vol . 81 , No . 25 , 1977 4 d g lcm C I I 04 , . . . , , , , , , , . , , . , . , , . . , . I 0 I 2 a 4 5 time Figure 6 . A 10 rpd plot of two stochastic simulation runs for reactions 29 , with clX = 5 and c2 = 0 . 005 , corresponding to the deterministic steady state Y = 1000 ; one run starts at Y = 10 , and the other run starts at Y = 3000 . of the colliding molecules ) , one finds in a similar way that chemical reactions are more properly characterized by a “reaction probability per unit time” instead of a “reaction rate” . Thus , suppose the S1 and S2 molecules in V can undergo the reaction R , : S , t S , - + 25 , ( 3a ) Then in direct analogy with ( 2a ) , we may assert the ex - istence of a constant cl , which depends only on the physical properties of the two molecules and the temperature of the system , such that c1 dt = average probability that a particular 1 - 2 molecular pair will react according to R1 in the next infinitesimal time interval d t ( 3b ) This implies that , if at time t there are in VX1 of the S1 molecules and X2 of the S2 molecules , making a total of XlX2 distinct 1 - 2 pairs , then2 X , X2cl dt = probability that an R1 reaction will occur somewhere inside V in the next infinitesimal time interval ( t , t + dt ) ( 3c ) More generally , suppose the volume V contains a spatially homogeneous ( or thermally equilibrized ) mixture of X , molecules of chemical species S , ( i = 1 , . , . , N , and suppose further that these N species can interreact through M specified chemical reaction channels R , ( p = 1 , . . . , MI . Then we may assert the existence of M constants c , ( p = 1 , . . . , AI ) , which depend only on the physical properties of the molecules and the temperature of the system , such that c , dt = average probability that a particular combination of R , reactant molecules will react accordingly in the next infinitesimal time interval d t ( 4 ) By “average” here we mean simply that , if we multiply c , dt by the total number of distinct combinations of R , reactant molecules in V at time t , we will obtain the probability that an R , reaction will occur somewhere inside V in the next infinitesimal time interval ( t , t + dt ) . Equation 4 may be regarded both as the definition of the stochastic reaction constant c , , and also as the fun - damental hypothesis of the stochastic formulation of chemical kinetics . As is shown by more detailed arguments in ref 1 , we may expect this hypothesis to be valid for any molecular system that is kept “well - mixed” , either by Stochastic Simulation of Coupled Chemical Reactions 2343 * s a x c 0 i s a x d 5 Ico ) C 3Mo am I - o 0 1 2 3 5 time Figure 7 . A 40 rpd plot of two stochastic simulation runs for reactions 29 , wtth clX = 5 and c2 = 0 . 00125 , corresponding to the deterministic steady state Y = 4000 ; one run starts at Y = 40 , and the other run starts at Y = 12000 . direct stirring , or else by simply requiring that nonreactive molecular collisions occur much more frequently than reactive molecular collisions . In section I11 we shall take up the problem of how to use ( 4 ) to actually calculate the time evolution of such a system . IIC . Connection with the Deterministic Reaction - Rate Constant k , . Intuition suggests that the stochastic reaction constant c , should be closely related to the more familiar reaction - rate constant k , , which forms the basis for the deterministic approach to chemical kinetics . For the particular reaction R1 in ( 3a ) , it turns out that’ hl = VCl ( X1X2 ) / ( X1 ) ( X2 ) ( 5a ) where the angular brackets denote an average over an ensemble of identical systems , However , in the deter - ministic formulation of chemical kinetics , no distinction is made between the average of a product and the product of the averages . Therefore , to the extent that the det - erministic formulation is adequate , we have ( X l X , ) = ( Xl ) ( Xz ) , and ( 5a ) simplifies to k , ; Vcl ( 5b ) The presence of the factor V is merely a consequence of the fact that the reaction - rate constant is normally used in differential equations that contain molecular concen - trations ( numbers of molecules per unit volume ) rather than total numbers of molecules . If reaction R1 had three reactant molecules instead of two , we would have v2 in - stead of V ; if R1 had only one reactant molecule ( a simple isomerization ) , the factor V would be absent . Aside from possible factors of V , there is one other practical difference between c , and k , that can arise . To see this , consider the reverse of the reaction R1 in ( 3a ) : R , : 2S , + S , + S , ( 6a ) Following ( 41 , we would characterize this reaction by a constant cz , such that cz dt is the average probability that a particular pair of S1 molecules will react according to Rz in the next dt . However , the number of distinct pairs of SI molecules in Vis not X I X l but X 1 ( X 1 - 1 ) / 2 ! . Hence , the probability that an R2 reaction will occur somewhere inside V in the next time interval dt is l / zX1 ( X1 - l ) cz dt . This leads to the result that k2 = V C ~ ( ’ / Z X ~ ( X ~ - l ) ) / ( X i ) ( X i ) V ~ 2 / 2 ( 6b ) in contrast to eq 5 . In general , if R , has two identical reactant molecules then c , will be larger than k , by a factor of 2 ! = 2 ; if R , has three identical reactant molecules , this factor will be 3 ! = 6 . We see then that , from a practical numerical point of view , c , and k , will differ at most by only two simple constant factors . From a theoretical point of view , however , the difference between c , and k , is much more complicated , and relates ultimately to the conceptual differences that exist between the stochastic and deter - ministic approaches to chemical kinetics . 111 . Calculating the Stochastic Time Evolution of a Chemically Reacting System The temporal behavior of a spatially homogeneous mixture of N molecular species interreacting through M chemical reaction channels is governed solely by the fundamental hypothesis ( 4 ) . However , it is not at all obvious just how we should go about using ( 4 ) to calculate this temporal behavior . In this section we shall outline two different ways of approaching this problem - the tradi - tional “master equation” approach , and the new “stochastic simulation” approach . Although their stra - tegies are quite different , it is important to keep in mind that these two approaches are nevertheless equivalent in the sense that both are rigorous consequences of the fundamental hypothesis ( 4 ) . IIIA . The Master Equation Approach . The traditional method of calculating the stochastic time evolution of a chemically reacting system is to set up and solve a so - called “master equation” for the system . A good review of the master equation approach to chemical kinetics has been given by McQ ~ arrie . ~ Here we would merely like to summarize briefly the main features of the master equation formalism in order to provide a conceptual setting for our subsequent presentation of the stochastic simulation approach . It should be emphasized , though , that the master equation itself plays no role whatsoever in either the derivation or the implementation of the stochastic simulation algorithm . The key element of the master equation formalism is the “grand probability function” P ( Xl , Xz , . . . , XN ; t ) = probability that there will be in V at time t X1 molecules of species S1 , and X 2 molecules of species S2 , . , , , and X , molecules of species SN ( 7 ) A knowledge of this function would evidently provide a fairly complete characterization of the “stochastic state” of the system at time t . Thus , for example , the kth moment of P with respect to X i 00 M ) Xi‘” ( t ) = E ’ z : X , V ( X , , . . . , x , ; t ) Xi = o X N = o ( i = 1 , . . . , N ; k = O , l , 2 , . . . ) gives the “average ( number ) k of S , molecules in V at time t” . By “average” here we mean an average taken over many repeated “runs” from time 0 to time t of the sto - chastic process defined by ( 4 ) , each run having the same initial numbers of molecule ^ . ^ The number X , of S , molecules found at time t will vary from run to run , but the average of the kth power of these numbers will ap - proach Xi @ ) ( t ) in the limit of infinitely many runs . Es - pecially useful are the k = 1 and k = 2 moments ; this is because X , ( l ) ( t ) and ( 8 ) ( 9 ) measure , respectively , the average number of Si molecules The Journal of Physical Chemlstty , Vol . 8 1 , No . 25 , 1977 2344 Daniel T . Gillespie in Vat time t , and the magnitude of the root - mean - square fluctuations that occur about this average . In other words , we may “reasonably expect” to find between molecules of S , in V in time t . The functions Xi ( t ) ap - pearing in the deterministic reaction - rate equations ( 1 ) usually approximate the first moments Xi‘l ) ( t ) fairly closely , but only rarely is there exact equality . The master equation is simply the time - evolution equation for the function P ( X1 , . . . , XN ; t ) . It may be de - rived from ( 4 ) by using the addition and multiplication laws of probability theory to write P ( X1 , . . . , XN ; t + dt ) as the sum of the probabilities of the 1 + M different ways in which the system can arrive at the state ( Xl , . . . , XN ) at time t + dt : 5 [ Xi‘” ( t ) - Ai ( t ) ] and [ Xi“ ) ( t ) + Aj ( t ) ] ( 10 ) P ( X1 , . . . JN ; t + d t ) = P ( X1 , . . . , XN ; t ) [ 1 - Here we have defined the quantities a , by d t E c , dt X { number of distinct R , molecular combinations in the state ( Xl , . . - , - % ) I in the state ( X l , , . , , XN ) at time t = probability that an R , reaction will occur in V in ( t , t + dt ) , given that the system is ( 12 ) Thus , the first term in ( 10 ) is the probability that the system will be in the state ( XI , . . . , XN ) at time t , and then remains in that state ( Le . , undergoes no reactions ) in ( t , t + dt ) . The quantity B , dt gives the probability that the system is one R , reaction removed from the state ( XI , . . . , XN ) at time t , and then undergoes an R , reaction in ( t , t + dt ) . Thus , B , will be the product of P evaluated at the appropriate once - removed state at t , times c , , times the number of R , molecular reactant combinations available in that once - removed state . Without going into any further details , it is sufficient here to simply observe that ( 11 ) leads directly to the “master equation” a M - P ( X1 , . . . , XN ; t ) = 2 [ B , - a , P ( XI , . . , XN ; t ) ] ( 13 ) at , = 1 In any particular case , the master equation is fairly easy to write ; however , solving it is quite another matter . The number of problems for which the master equation ( 13 ) can be solved analytically is even fewer than the number of problems for which the deterministic reaction - rate equations ( 1 ) can be solved analytically . In addition , unlike the reaction - rate equations , the master equation does not readily lend itself to numerical solution on a digital computer , owing to the number and nature of its inde - pendent variablese6 Attempts to use the master equation to construct tractable time - evolution equations for the moments , and in particular X , ( ’ ) ( t ) and Ai ( t ) , are also usually unsuccessful ; for it turns out that , unless all the reactions R , are simple monomolecular reactions , the equations for the time derivative of any moment will always involve higher order moments , thus rendering the set of moment equations infinitely open ended . In short , although the master equation is both exact and elegant , it is usually not very useful for making practical numerical calculations . IIIB . The Reaction Probability Density Function . Let us now put aside the master equation formalism , and consider instead how we might go about simulating the stochastic time evolution of a chemically reacting system . If we are given that the system is in the state ( XI , . . . , XN ) at time t , then essentially all we need in order to “move the system forward in time” are the answers to two questions : when will the next reaction occur , and what kind of reaction will it be ? Because of the stochastic nature of the reactions , though , we may expect that these two questions will be answerable only in some “probabilistic” sense . Prompted by these considerations , we introduce the function P ( T , y ) defined by1 P ( r , p ) dr probability that , given the state ( Xl , . . . , XN ) at time t , the next re - action in V will occur in the infin - itesimal time interval ( t + r , t t r + dr ) , and will be an R , reaction ( 14 ) We call P ( 7 , p ) the “reaction probability density function” , because in mathematical terminology it is a joint proba - bility density function on the space of the continuous variable T ( 0 I T < m ) and the discrete variable y ( p = 1 , 2 , . . . , M ) . Notice that the variables r and y are quantities whose respective values would give us answers to the two questions mentioned above . Our first step toward finding a legitimate method for assigning numerical values to r and p is to derive , from the fundamental hypothesis ( 4 ) , an analytical expression for P ( T , y ) . To this end , we begin by defining for each reaction R , a function h , according to h , number of distinct R , molecular reactant combinations available in the state ( Xl , XZ , . . J N ) ( P = 1 , . . . , w ( 15 ) Thus , if R , has the form SI + S2 4 anything , then we will have h , = X l X 2 ; if R , has the form 2S1 4 anything , then we will have h , = 1 / 2X1 ( X1 - 1 ) . In general , h , will be some combinatorial function of the variables XI , Xz , . . . , XN . With h , so defined , then ( 4 ) implies that [ cf . ( la ) ] a , dt 3 h , c , dt = probability that an R , re - action will occur in V in ( t , t + dt ) , given that the system is in the state ( Xl , . . . , XN ) at time t ( p = 1 , . . . , M ) ( 16 ) We now calculate the probability in ( 14 ) as the product of : Po ( r ) , the probability that , given the state ( Xl , . . . , XN ) at time t , no reaction will occur in the time interval ( t , t + 7 ) ; times a , dr , the subsequent probability that an R , reaction will occur in the time interval ( t + T , t + r + d ~ ) : ~ ( 174 To find an expression for P0 ( 7 ) , we first note that I1 - XUau dr’ ] is the probability that no reaction will occur in time dr’ from the state ( XI , . . . , XN ) . Therefore P ( r , p ) dr = Po ( r ) . a , dr M V = l Po ( r‘ - I - dr’ ) = Po ( ~ ‘ ) . [ l - Z av dr’ ] ( 17b ) from which it is readily deduced that M v = 1 P0 ( 7 ) = exp [ - Z avr ] Inserting ( 17c ) into ( 17a ) , we conclude that the reaction probability density function defined in ( 14 ) is given by7 a , exp ( - aor ) 0 otherwise P ( T , P ) = where a , h , c , ( p = 1 , . . . , M ) if 0 < r < - and p = 1 , . . . , M ( 18 ) ( 19a ) 1 and a . Z a , 2 h , c , M M V = l v = 1 The Journal of Physical Chemistry , Vo / . 8 I , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions The expression for P ( 7 , p ) in ( 18 ) is , like the master equation ( 13 ) , a rigorous mathematical consequence of the fundamental hypothesis ( 4 ) . Notice that P ( 7 , p ) depends on all the reaction constants ( not just on c , ) , and on the current numbers of molecules of all reactant species ( not just on the R , reactants ) . IIIC . The Stochastic Simulation Algorithm . At the beginning of section IIIB , we observed that essentially what is needed to simulate the time evolution of a chemically reacting system is some way of specifying when the next reaction will occur and what kind of reaction it will be . We can now frame this requirement in more precise , math - ematical terms : What is needed is a method for drawing or “generating” a pair ( 7 , p ) from the set of random pairs whose probability density function is P ( 7 , p ) in ( 18 ) . It turns out that there is a simple , rigorous way of doing this on a digital computer , provided we have access to a reliable “unit - interval uniform random number generator” . A unit - interval uniform random number generator is a computer subprogram which , when called , calculates and returns a random ( or more properly , a “pseudorandom” ) number r from the uniform distribution in the unit in - terval ; that is , the a priori probability that any generated number r will fall inside any given subinterval [ a , b ] of the unit interval [ 0 , 11 is equal to b - a . Nowadays , virtually every large digitial computer facility has one of these subprograms in its library file that is fast , easy to use , and sufficiently reliableas When called , the typical generator subprogram calculates the required pseudorandom number r by performing a few relatively simple operations on the previous pseudorandom number that was calculated . Thus , n successive calls will produce a “chain” of n pseudorandom numbers . The first number of the chain is determined by initializing the generator with a user - chosen starter number ; different starter numbers will result in different but statistically equivalent chains . Now , if our goal were to generate a random pair ( 7 , p ) according to the probability density function 1 if O < T < 1 and 0 < p < 1 1 0 otherwise P ’ h Y ) = then we could simply generate two random numbers r1 and r2 using a unit - interval uniform random number generator and take r = rl Y = r2 However , our objective here is to generate a random pair ( 7 , p ) according to the probability density function in ( 18 ) , not the probability density function in ( 20a ) . As it happens , there exists a mathematically rigorous procedure for taking two random numbers r1 and r2 from the unit - interval uniform distribution , and constructing from them a random pair ( 7 , p ) from a set described by any specified pair probability density fun ~ tion . ~ For the pair probability density function in ( 20a ) , this construction procedure turns out to be precisely ( 20b ) ; for the pair probability density function P ( 7 , p ) in ( 18 ) , the construction procedure turns out to be as follows : With r1 and r2 two random numbers from the unit - interval uniform distribution , take 7 = ( l / a o ) 1n ( 1 / r1 ) and take p to be that integer for which @ Ob ) 2345 P - 1 EL v = 1 v = l 2 a , < rzao < a , A rigorous proof of the fact that the pair ( 7 , p ) constructed according eq 21 may be regarded as having been drawn from the set of random pairs whose probability density function is P ( 7 , p ) in ( 18 ) may be found in section VA of ref 1 . Suffice it here to say that ( 21a ) generates a random number 7 according to the probability density function P1 ( 7 ) = a . exp ( - ao7 ) , while ( 21b ) generates a random integer p according to the probability density function P2 ( p ) = a / ao , and the stated result follows , roughly speaking , iecause P1 ( 7 ) ’P2 ( p ) = P ( 7 , p ) . The generating procedure ( 21 ) is easy to code in Fortran . In particular , ( 21b ) may be implemented simply by cu - mulatively adding the successive values al , a2 , . . . in a do - loop until their sum is observed to equal or exceed r2a0 , whereupon p is set equal to the index of the last a , term added . Our algorithm for simulating the stochastic time evo - lution of a chemically reacting system should now be rather obvious ( see Figure 2 ) : Step 0 ( Initialization ) . Input the desired values for the M reaction constants cl , . . . , cM and the N initial molecular population numbers XI , . . . , XN . Set the time variable t and the reaction counter n both to zero . Initialize the unit - interval uniform random number generator ( URN ) . Step 1 . Calculate and store the M quantities al = hlcl , , . , , UM = h f i M for the current molecular population numbers , where h , is that function of X1 , . . . , XN defined in ( 15 ) . Also calculate and store as a . the sum of the M a , values . Step 2 . Generate two random numbers r1 and r2 using the unit - interval uniform random number generator , and calculate 7 and 1 . 1 according to ( 21a ) and ( 2lb ) . Step 3 . Using the T and p values obtained in step 2 , increase t by 7 , and adjust the molecular population levels to reflect the occurrence of one R , reaction ; e . g . , if R , is the reaction in ( 3a ) , then increase X 1 by 1 and decrease X 2 by 1 . Then increase the reaction counter n by 1 and return to step 1 . In returning to step 1 from step 3 , notice that it is necessary to recalculate only those quantities a , corre - sponding to reactions R , whose reactant population levels were just altered in step 3 ; also , a . may be recalculated simply by adding to a . the difference between each newly changed a , value and its corresponding old value . Of course , somewhere in the 1 - 2 - 3 loop one will want to provide for writing out or plotting the ( Xl , . . . , XN , t ) values at‘regular intervals of either t or n . Also , one will want to make provisions for halting the calculations when either t or n reaches some predetermined value , or if a . should ever reach zero . If it is desired to estimate any of the moments X , ( k ) ( t ) of the grand probability function ( see eq 8 - 10 ) , then it will be necessary to make several simulation runs from time 0 to the chosen time t , all identical with each other except for the initialization of the random number generator in step 0 . Any moment Xjk ) ( t ) 3 ( Xlk ) t may then be esti - mated directly as the average of the hth power of the numbers found for X , at time t in these runs . In a similar way , one can estimate various cross - correlation functions such as ( X , X ) t - ( Xi ) , ( X , ) , , etc . The number of runs necessary to oktain adequate statistics in these estimates will vary with the situation . IIID . Remarks . After the simulation algorithm de - scribed above had been developed , several earlier simu - lation procedures were brought to the attention of the author . Two of these deserve to be mentioned here . First is the method used by Nakanishi’O in 1972 to simulate the oscillating Lotka reactions . Like the com - putational method described above , Nakanishi’s method is expressly designed to numerically simulate the stochastic The Journal of Physical Chemlstty , Vol . 81 , No . 25 , 1977 2346 Daniel T . Gillespie the master equation approach provides through the various moments of the grand probability function P . ( 6 ) When ensemble averages ( e . g . , means , variances , correlations ) cannot be readily calculated from the master equation , the stochastic simulation approach offers a universally straightforward ( though possibly time - con - suming ) way of numerically estimating them . On the minus side , the stochastic simulation algorithm has the following limitations : ( 1 ) A stochastic simulation computer program often requires lots of computer time to execute . From a cost standpoint , this fact is somewhat offset by the fact that such programs typically occupy only a small amount of computer memory . Nevertheless , the stochastic simulation algorithm places a high premium on the speed of the computer’s central arithmetical unit . ( 2 ) This computer time limitation essentially limits the total number of molecular reactions that can be simulated ; indeed , the execution time for a given set of reactions will be roughly proportional to that number . This in turn implies limits on the total numbers of molecules involved and / or the total system time that can be simulated . In other words , the stochastic simulation algorithm is re - stricted to distinctly finite chemical systems . However , in view of the fact that chemical reactions are usually rather “local” affairs , even for systems which as a whole contain enormous numbers of molecules , it is conceivable that this limitation might in some cases be more of an advantage than a disadvantage . ( 3 ) The stochastic simulation algorithm requires a “reliable” unit - interval uniform random number generator ; however , a specific criterion for “reliability” is hard to come by . Many of the generators available today are quite good , and are probably quite adequate for our stochastic sim - ulation algorithm , but the possibility of trouble from this source should never be ignored . ( 4 ) The stochastic simulation approach requires making several runs to estimate ensemble averages . Depending on the dynamical quantity whose ensemble average is desired , and also the statistical accuracy required of its estimate , the number of runs needed for averaging may run afoul of computer time / cost limitations . IV . Illustrative Applications of the Algorithm We shall now present some numerical results that have been obtained in applying the stochastic simulation al - gorithm to several spatially homogeneous model chemical systems . Although our results may provide a few new insights into some of the systems treated ; it should be kept in mind that the systems themselves are not the primary focus of our discussion here ; rather , our principle objective is to demonstrate that the stochastic simulation algorithm is a feasible and potentially useful method for numerically calculating the temporal behavior of coupled chemical reactions . We shall begin by considering some fairly simple systems , and then proceed to three successively more complicated systems , namely , the Lotka reactions , the Brusselator , and the Oregonator . IVA . Some Simple Systems . Perhaps the simplest nontrivial “set of coupled chemical reactions” that one can write is the irreversible isomerization ( or radioactive decay ) reaction x - + 2 ( 22 ) This is a pedagogically attractive first problem to tackle because it can be solved analytically , without approxi - mations , in both the deterministic and the stochastic formulations . In the deterministic formulation we have C process described by the spatially homogeneous master equation . However , Nakanishi’s computational algorithm is neither as exact nor as efficient as ours . Essentially , it divides the time scale up into small bins At and then decides on the basis of a random number which , if any , of the M reaction types should be made to occur in each At . This approximate procedure becomes exact in the limit At - 0 , but unfortunately the efficiency of the procedure becomes nil in that same limit . Much closer to our algorithm from an operational standpoint is the computational scheme proposed by Bunker et al . ” in 1974 . In terms of our notation , Bunker et al . use the same p - selection process as ( 21b ) , but they replace the 7 - selection process in ( 21a ) by simply 7 = l / ao . Since l / ao is precisely the mean of the 7 values generated according to ( 21a ) , this substitution is a very reasonable approximation . Bunker et al . correctly characterize their computational procedure as a “hybrid method , interme - diate between differential equation solution and Monte Carlo” . However , they derive their method in a rather heuristic way within the context of the deterministic formalism instead of the stochastic formalism , and it is not at all clear from their development in precisely what re - spects their method should be regarded as approximate . From the standpoint of our exact computkional procedure , though , the method of Bunker et al . appears to be somewhat better than its inventors may have supposed . The stochastic simulation algorithm described in this paper has both its advantages and its limitations . Al - though these can be more readily appreciated in the context of the specific applications presented in the next section , we shall now summarize briefly the principle strengths and weaknesses of this computational approach . On the plus side , the method has the following ad - vantages : ( 1 ) The stochastic simulation algorithm is exact , in the sense that it takes full account of the fluctuations and correlations implied by the fundamental hypothesis ( 4 ) . This is a consequence of the fact that , like the spatially homogeneous master equation , the stochastic simulation algorithm has been derived from ( 4 ) in a mathematically rigorous way . ( 2 ) Unlike standard numerical methods for numerically solving systems of differential equations , the stochastic simulation algorithm never approximates infinitesimal time increments dt by finite time steps At . 12 This will be especially advantageous when dealing with systems in which the molecular population levels can change suddenly and sharply with time . ( 3 ) As is evident from Figure 2 , the stochastic simulation algorithm is very easy to code in Fortran for any specified set of chemical reactions , no matter how complicated or highly coupled these reactions may be . ( 4 ) A stochastic simulation computer program will normally require very little in the way of computer memory space . For N molecular species and M reaction channels , the principle variables to be stored are the N X , values , the M c , values , and the M + 1 a , values - a total of only N + 2M + 1 in all . Notice in particular that , although the amount of computer memory required does depend on the number of species N , it does not depend on the numbers of molecules of these various species . ( 5 ) In terms of the “statistical ensemble of systems” envisioned in the master equation approach , the stochastic simulation algorithm essentially provides us with infor - mation on the time behavior of individual ensemble members , such as one would observe in an ideal laboratory experiment . This complements quite nicely the infor - mation on the time behavior of ensemble averages which The Journal of Physlcal Chefflktry , Vol . 81 , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions 2347 the reaction - rate equation [ cf . ( l ) ] dXldt = - cx ( 2 3 4 X ( t ) = Xoe - ct ( 23b ) whose solution , given that X = X o at t = 0 , is In the stochastic formulation , we may easily derive the master equation [ cf . ( 13 ) ] a - P ( X ; t ) = c [ ex , x , ( X + l ) P ( X + 1 ; t ) - at mx ; t ) l ( 24a ) where the “Kronecker epsilon” q ; is by definition zero if i = j and unity if i # j . This equation can be solved for the initial condition P ( X ; 0 ) = 6 x , xo by dealing with it successively for X = X o , X = X o - 1 , X = X o - 2 , etc . In this way we find the solution ( 24b ) KO ! e - cxt [ I - - ct x , - x P ( X ; t ) = e l X ! ( X o - X ) ! ( X = 0 , 1 , . . . , Xi ) ) This is in the standard form of a binomial or Bernoulli probability function , and it is not difficult to calculate its mean and rms deviation directly from the definitions ( 8 ) and ( 9 ) . They turn out to be and The fact that the stochastic mean X ( l ) ( t ) in ( 24c ) is exactly equal to the deterministic function X ( t ) in ( 23b ) will rarely be true for more complicated chemical systems . To apply our stochastic simulation algorithm to reaction 22 , we put M = N = 1 , c1 = c , X 1 = X , and hl = X in Figure 2 ( and we also note that the r2 calculations in step 2 can be omitted ) . In Figure 3 we show , for how the results found in a typical stochastic simulation run of reaction 22 compare with the predictions of the master equation . The two dashed curves in Figure 3 are X ( l ) ( t ) f A ( t ) ( the one - standard deviation envelope ) , and the two solid curves are X ( l ) ( t ) f 2A ( t ) ( the two - standard deviation envelope ) . The dots , of course , represent the trajectory of the stochastic simulation run . A dot has been plotted at the ( t , X ) value found immediately after the occurrence of each molecular reaction . No attempt has been made to smooth these dots with a continuous con - necting curve , so they essentially represent the “raw output” of the simulation run . The horizontal spacing between the dots gives a direct measure of the time separation between successive reactions , and as we should expect , the average time separation between successive isomerizations ( decays ) increases as the number of X molecules decreases . Because there were 1000 X molecules at t = 0 , a total of 1000 reactions are simulated here , requiring exactly 1000 passes through the 1 - 2 - 3 loop of Figure 2 . In this particular simulation run , all but 6 of the X molecules had isomerized ( decayed ) by t = 10 ; the last X molecule did not disappear until t = 15 . 6 . The unit of time will depend upon the units assigned to the reaction constant c , and is irrelevant to our purposes here . The procedure used to obtain this plot was as follows : First , the computational steps outlined in Figure 2 were Fortran coded into a simulation program for reaction 22 ; provisions were made in this program so that the current ( t , X ) value would be written out on a mass - storage file X ( ’ ) ( t ) = Xoe - ct ( 24c ) A ( t ) = [ Xoe - ct ( l - e - ct ) ] 1’2 ( 24d ) c = 0 . 5 , X o = 1000 ( Figure 3 ) ( 25 ) 0 , , . , 0 I 2 3 4 5 8 7 8 9 10 time time - L I _ i LE4 - 1 0 . . , . , . . . , , , . . . . . , , . , . . . . . 0 I ~ z m o s x , u m m J o I number of Yl molecules Figure 8 . Results of a 1 X IO6 reaction stochastic simulation run of the Lotka reactions ( 38 ) , with c , X = IO , cp = 0 . 01 , and c3 = IO , corresponding to the deterministic steady - state Y1 = Y2 = 1000 . ( a ) Combined 100 rpd plots of Y , ( left - shifted curve ) and Y2 ( right - shifted curve ) vs . tfor 0 I t < IO . ( b ) A 100 rpd plot of Y1 vs . tfor 0 I t C 30 . ( c ) A 100 rpd plot of Y2 vs . Y , for 0 5 . t < 30 . after every reaction , and also on paper after every five reactions . This simulation program was then executed on a Univac 1110 computer , and the resulting paper output was examined for the purpose of determining how the data should be plotted . Then , a plotting program was written to read off the data from the mass - storage file and con - struct the plot . The plotting program consisted primarily of Fortran calls to appropriate subroutines from the standard DISSPLA ( Display Integrated Software System and Plotting Language ) library . Execution of the plotting program on the Univac 1110 computer caused the plot to be constructed on a device called an FR - 80 , which es - sentially is a cathode ray tube whose screen image is automatically recorded on photographic film ; the resulting The Journal of Physical Chemlstty , Vol . 8 1 , No . 25 , 1977 2348 Daniel T . Gillespie mxa 8 P J _ j I - 0 l o 1 5 j I b s + B a 10 time M30 i b I l l , number of Y1 molecules Figure 9 , Same as Figure 8 for a secondsimulation run , which differed from the first only in the choice of the " starter number " for the unit - interval uniform random number generator . film negative , together with an enlarged , X 11 in . Xerox positive print , constitute the output of the plotting program run . This two - step procedure ( a simulation program followed by a plotting program ) was used in obtaining all the plots shown in this paper . However , the numbers of reactions allowed to occur between the sampling outputs , both on the plotting file and on paper , can be varied as the situ - ation warrants . In Figure 4 we show another simulation run of reaction 22 , this one with c = 0 . 5 , X o = 5000 ( Figure 4 ) ( 26 ) As before , the dashed curves show the one - standard de - viation envelope as calculated from the master equation ( 24 ) , while the solid curves form the two - standard deviation envelope . However , in this run we chose to write out the The Journal of Physlcal Chemistry , Vol . 81 , No . 25 , 1977 current state ( t , X ) on the plotting file after every 5 re - actions , and on paper after every 25 reactions . Henceforth , we shall specify the number of reactions that occur between each dot that appears on a simulation output graph by the notation rpd = reactions per dot Thus , Figure 3 is a 1 rpd plot , while Figure 4 is a 5 rpd plot . In Figure 5 we show a 10 rpd plot of a simulation run of reaction 22 for ( 27 ) c = 0 . 5 , X o = 10000 ( Figure 5 ) ( 28 ) Figures 3 - 5 illustrate two important , but certainly not unexpected , points : First , as the initial number of X molecules is increased , the temporal behavior of the system assumes more and more the appearance of the continuous , deterministic process described by the reaction - rate equation ( 23 ) . Second , regardless of the initial number of X molecules , the temporal behavior as calculated by the stochastic simulation algorithm is entirely consistent with the predictions of the master equation ( 24 ) . Of course , we are not attempting to prove here that the stochastic simulation algorithm provides a correct description of the time evolution of a chemically reacting system , for this has already been established in an a priori manner in sections I1 and 111 ; rather , our purpose here is simply to demon - strate that this computational method is capable of being implemented . Figures 3 - 5 offer rather convincing proof of the feasibility of the stochastic simulation algorithm for the simple reaction 22 . In this connection , we might note that the total cost of simulating and plotting the run shown in Figure 5 was about $ 5 , the cost being split roughly equally between the simulating and plotting programs . We turn next to a somewhat more complicated set of reactions : - x + Y L 2Y ( 294 2Y % z ( 29b ) Here , the bar over X signifies that the molecular popu - lation level of this species is assumed to remain constant , either because the system is open to a large reservoir of X , or else because X is initially present in such great abundance that its depletion by reaction 29a will be negligible over any reasonable period of time . The set of reactions ( 29 ) is of some interest because Malek - Mansour and Nicolis13 recently claimed that it provides a refutation of the basic stochastic hypothesis ( 4 ) : They proved that the master equation for reactions 29 is such that aP ( F t ) / at = 0 if and only if Y = 0 ; yet , the reaction - rate equation for ( 29 ) dY / dt = c ~ X Y - 2 ( cZ / 2 ) Y2 ( 30 ) Y , = 0 ( 3W evidently possesses two steady - state solutions and Y , = C l X I C , and it can be shown that the first of these is mathemat - ically unstable while the second is mathematically stable . This lead Malek - Mansour and Nicolis to conclude that the stochastic formalism upon which the master equation is based " seems to have destroyed the stable solution [ 31b ] of the macroscopic equation 1301 and preserved , instead , the physically unacceptable trivial ( and unstable ) solution [ 31a ] : Even if the system starts initially with a great number of [ Y ] molecules , it will be driven eventually to extinction " . 13 Since the master equation and the stochastic simulation Stochastic Simulation of Coupled Chemical Reactions 2349 , I ’ , 0 e r 0 ” 0 10 15 20 25 30 lime Figure 10 . Combined 100 rpd plots of X ( dark curve ) , Y , ( upper oscillating curve ) , and Y2 ( lower oscillating curve ) vs . t for a stochastic simulation run of the closedLotka reactions , with c , = 0 . 0001 , c2 = 0 . 01 , and cg = 10 . algorithm are logically equivalent to each other , we can test this conclusion simply by making a few simulation runs of reactions 29 . For this , we need only apply the procedure outlined in Figure 2 with M = 2 , N = 1 , X1 = Y , hl = XU , and h2 = Y ( Y - 1 ) / 2 . In Figure 6 we show a 10 rpd plot of two such runs with for the initial conditions Y = 10 and Y = 3000 . Contrary to what we might have expected from the result of Ma - lek - Mansour and Nicolis , we see that both of these initial conditions lead to a situation in which the Y molecule population level fluctuates in a random but apparently stable manner over values in the vicinity of clX / cz = 1000 , in reasonable agreement with the reaction - rate equation prediction ( 31b ) . In Figure 7 we show a 40 rpd plot of two more simulation runs of ( 29 ) , these with c l X = 5 , cz = 0 . 00125 ( Figure 7 ) ( 33 ) for the two initial conditions Y = 40 and Y = 12000 . Again , both initial conditions lead to stable random fluctuations over values in the vicinity of clX / cz = 4000 . The only essential difference between the plots in Figures 6 and 7 is that the relative fluctuations in Figure 7 are about half as large as those in Figure 6 : this is due to the fact that the molecular population levels in Figure 7 are four times larger than those in Figure 6 . The fact that the master equation for reactions 29 predicts a stable stationary state at Y = 0 can be easily understood directly from ( 29 ) : clearly , if it should ever happen that the Y molecule population level ever drops to exactly zero , then that condition will persist indefinitely . However , it is very misleading to say that , if we start out with Y > 0 , the system will be “driven” to Y = 0 ; for , as Figures 6 and 7 show quite convincingly , in such cases the Y molecule population level exhibits a definite affinity for values near clX / c2 . Of course , it is always possible that a chance , momentary , pairwise confluence of all the Y molecules could result in their complete annihilation via reaction 29b ; and because this is possible , it will eventually happen if we just wait long enough ( t - a ) . However , this contingency is not especially significant from a macro - scopic point of view ; indeed , an examination of the tra - jectories in Figures 6 and 7 for t > 2 shows that , even for these relatively small numbers of molecules , one would have to wait an incredibly long time before observing a random fluctuation large enough to carry the system from the vicinity of Y = clX / cz down to Y = 0 . More to the point here , though , is the fact that this contingency does not imply that the “transition probabilities [ used in the c I X = 5 , c2 = 0 . 005 ( Figure 6 ) ( 32 ) stochastic approach ] are not correctly written” , as was concluded by Malek - Mansour and Nic01is . l ~ Shortly after the simulation runs in Figures 6 and 7 had been performed , the author received a preprint of an article by Gortz and Walls , 14 in which essentially these same conclusions were arrived at using an ingenious analytical technique based on the master equation . The reader is invited to consult their paper for further insights into this matter . Suffice it here to say that the objections to the stochastic formulation of chemical kinetics which Ma - lek - Mansour and Nicolis13 have raised on the basis of their analysis of reactions 29 are now seen to be groundless . The fact that our numerical simulation algorithm was helpful in clarifying this essentially theoretical matter obviously speaks well for the potential usefulness of the algorithm . In addition to providing information on if and how a steady state is approached , the stochastic simulation algorithm can also be used to estimate various statistical properties of the steady state . For example , returning to the situation illustrated in Figure 6 [ reaction 29 with c1 and c2 as given in ( 32 ) ] , it is important to know just how well the population mean in the steady state is approx - imated by the reaction - rate equation estimate clX / cz = 1ooO ; and it is also important to know how large the natural random fluctuations will be about that steady - state mean . Essentially what we are askin for here are the asymptotic solution to the master equation for reactions 29 . To obtain estimates of these values , we proceeded as follows : Starting with 1000 Y molecules at t = 0 , we made a stochastic simulation run to t = 0 . 3 , at which time we recorded the number of Y molecules present ; to simulate this length of system time required roughly 2000 reactions , and this was judged sufficient to make the system “forget” the initial number of Y molecules . Repeating this process 4000 times , each time using different random numbers from URN ( see Figure 2 ) , we then estimated the mean and variance of the Y values found at t = 0 . 3 by a straightforward averaging procedure . The results of these calculations were Y S ( l ) = 999 . 9 k 1 . 2 and A : = 1450 f 75 ( 34 ) where the f uncertainties represent 95 % confidence limits . The deterministic estimate of 1000 for the steady - state mean YS ( l ) is obviously well within our un - certainty limits . As for the steady - state variance A : , a subsequent analytical calculation furnished by Walls , 15 using the computational procedure of Gortz and Walls , 14 gave the result A : = ( 3 / 2 ) YSc1 ) for reaction 22 ; in the present case this would imply A : = 1500 , which is obvi - ously quite consistent with our result in ( 34 ) . The fact that the steady - state mean and variance are not equal to each other for reactions 29 is related to the fact that these reactions do not operate under conditions of chemical equilibrium ( the reactions are irreversible , and they are also “driven” by the effective influx of X mol - ecules ) . Another simple set of reactions which does not operate under conditions of chemical equilibrium is the set values of the first moment v1 7 ( t ) and variance A2 ( t ) of the - C X A Y ( 35a ) 2Yc1 . z ( 35b ) It has been shown by Nicolis , 16 Mazo , 17 and Gortz and Walls , 14 using three different analytical techniques based on the master equation , that reactions 35 will have A ; = ( 3 / 4 ) Y8 ( l ) . The significance of this result has been com - mented on by several authors . 18J9 Taking c i x = 106 , cz = 1 ( 36 ) The Journal of Physical Chemlshy , Vol . 8 1 , No . 25 , 1977 2350 Daniel T . Gillespie - 1 0 5 10 L5 20 I 30 time Flgure 11 . Same as Figure 10 , but for another simulation run in which only the random number starter was changed . which yields a deterministic estimate for Yil ) of ( clX / cz ) 1 / 2 = 1000 , we applied our stochastic simulation procedure to these reactions in essentially the same way that we did in obtaining the estimates in ( 34 ) . The results were YS ( lf = 1000 . 7 k 0 . 9 and As2 2 : 762 k 35 ( 37 ) where again the f uncertainties represent 95 % confidence limits . Our result for A : is obviously consistent with the theoretically predicted value of 750 . The computer programs used to obtain the statistical estimates in ( 34 ) and ( 37 ) are easy to write , especially since they require no periodic write - outs for subsequent plotting . However , in performing this type of calculation , care must be taken to make each run long enough to wipe out effects due to the choice of the initial state . Moreover , as is typical of Monte Carlo estimates of averages , if one wishes to reduce the uncertainties by l / f , one must make f times as many runs . These two features can conspire to make such calculations rather time consuming on a computer , and hence rather expensive ; for example , it cost about $ 160 to obtain the figures quoted in ( 37 ) . The chief advantage of the method is that it is universally applicable , and does not require complicated or specialized analytical tech - niques . The method is therefore best reserved for cases in which an analytical calculation either cannot be made at all , or else is of questionable validity because of various approximations employed . IVB . The Lotka Reactions . In 1920 , Lotka observed that the set of coupled , autocatalytic reactionsz0 - x t Y , L 2Y , ( 38a ) Y , t Y , 2 + 2Y2 ( 38b ) Y2 % z ( 3 8 ~ ) possessed some remarkable dynamical properties . 21 Several years later , Volterra independently investigated the use of the corresponding reaction - rate equations d Y , / d t = ClXY1 - ~ 2 Y1 Y , ( 394 dYz / dt = CZ Y1 Y2 - ~ 3 Y2 ( 39b ) to mathematically model a simple predator - prey eco - system . 22 Although the predator - prey interpretation of the Lotka reactions is a bit crude and cannot be pushed too far , it is helpful for visualizing and understanding the dynamics of these reactions . Thus , reaction 38b describes how a certain predator species Y2 reproduces by feeding on a certain prey species Y1 ; reaction 38a describes how Y1 reproduces by feeding on a certain foodstuff X , which is assumed here to be only insignificantly depleted thereby ; and the isomerization 38c describes the eventual demise 0 5 IO 15 M 25 30 bme smo / I P low 2Mo m 4wo 5ow Bwo number of Y1 molecules Figure 12 . Results of a 1 . 5 X lo6 reaction stochastic simulation run of the Lotka reactions includingreaction 38d , with c1 = 0 . 0002 , cp = 0 . 01 , cB = c4 = 10 , and X = lo5 ( constant ) , corresponding to the deterministic steady - state Y1 = Y2 = 1000 . ( a ) A 200 rpd plot of Y , vs . tfor 0 I t 5 30 . ( b ) A 200 rpd plot of Y2 vs . Y1 for 0 I t I 30 . of Y2 through natural causes . A steady state system would be characterized by the condition dYl / dt = dYZ / dt = 0 and it is easy to show from ( 39 ) that this condition is satisfied when Yi = Yi , E ~ 3 1 ~ 2 and Y2 = YZ , C l X / C z ( 40 ) That is , if we start out at t = 0 with Yl = YIB and Y2 = Y2 , , then the deterministic reaction - rate equations predict that this situation will persist indefinitely . However , as we shall now see , the physically more realistic stochastic approach tells quite a different story . A stochastic simulation computer program for the Lotka reactions was written according to the scheme in Figure 2 ( putting M = 3 , N = 2 , XI = Y1 , X2 = Yz , hl = XU , , hz = YIYz , and h3 = Y2 ) : Figures 8a , 8b , and 8c show three plots of one simulation run of this program with clX = 10 , c2 = 0 . 01 , c3 = 10 ( Figures 8 , 9 ) for the initial condition Yl = Y18 = 1000 and Yz = Yz , = 1000 . Figure 8a shows the Yl and Yz population levels plotted against time , at 100 rpd , over the interval 0 5 t 5 10 ; the leading ( left - shifted ) curve is the Yl ( prey ) population , and the lagging ( right - shifted ) curve is the Y2 ( predator ) population . Instead of remaining constant at the 1000 level , as the reaction - rate equations ( 39 ) predict , the Yl and Y2 populations are seen to develop a pro - nounced oscillatory behavior . These oscillations are ev - ( 41 ) The Journal of Physical Chemistty , Vol . 81 , No . 25 , 1977 Stochastic Simulatlon of Coupled Chemical Reactions 235 1 time Figure 13 . Combined 50 rpd plots of X ( dark curve ) , Y , ( upper oscillating curve ) , and Y2 ( lower oscillating curve ) vs . time , showing what would have happened in the run of Figure 12 if Xhad not been held constant . idently characterized by a fairly stable frequency and phase difference , but a markedly unstable amplitude . Figure 8b is a 100 rpd plot of Yl only over the interval 0 5 t I 30 , illustrating more completely the stability of the frequency and the instability of the amplitude . And Figure 8c is a 100 rpd plot over this same time interval showing the counterclockwise “orbits” traced out in the YIYz plane . The simulation run from which the plots in Figures 8a - c were constructed contained a total of 1 X lo6 reactions . The cost of compiling and executing the simulation program for this run on the Univac 1110 computer was about $ 40 , and the subsequent plotting programs averaged about $ 9 per graph . Figures 9a , 9b , and 9c are 100 rpd plots of a second Lotka simulation run ; this run was identical with the first except that a different chain of random numbers was used ( i . e . , the “starter number” for the unit - interval uniform random number generator was changed ) . A comparison of Figures 8a and 9a shows that , although the frequencies and the phase - differences are essentially the same in both runs , the amplitude variations are quite different : fur - thermore , at any particular instant ( e . g . , t = 10 ) the Yl and Y2 values in Figure 9a are usually quite different from the Yl and Yz values in Figure 8a . Although it might seem from these two figures that the vagaries in the amplitude are less pronounced in the second run than in the first run , a comparison of Figures 8b and 9b shows that this is true only temporarily : between t = 12 and t = 22 in the second run , the population oscillations become quite extreme , ranging over two full orders of magnitude . The Yl - Y2 phase relationship in these large amplitude oscillations is illustrated in the 100 rpd plot in Figure 6c ; the quasi - concentric orbits in this figure were traced in the coun - terclockwise direction , just as in Figure 8c . In retrospect , it is not hard to see why the Lotka model exhibits an out - of - phase oscillatory behavior : A rise in the prey population provides food for the reproduction of the predators , and hence is followed shortly by a rise in the predator population ; but this leads to an increased con - sumption of preys and an eventual decline in the prey population ; the resultant food shortage for the predators leads to a decline in their population , which in turn permits the prey population to increase again ; and so on . In fact , if we were to solve the reaction - rate equations ( 39 ) for an arbitrary initial state ( Ylo , YzO ) , the solution , when plotted in the Y1Y2 plane , would be a counterclockwise closed orbit about ( YlS , Y , ) , passing through the initial point ( Ylo , Y20 ) , and shaped very much like the loops in Figures 8c and 9c . Further analysis of eq 39 would reveal that this solution orbit is , in mathematical terms , “neutrally stable” ; Le . , if perturbed slightly to a point ( Yll , YZl ) off of that orbit , the system will begin orbiting on the solution orbit which passes through ( Yll , Yzl ) . Thus , one way of viewing the behavior of the Lotka model is to say that the microscopic random fluctuations inherent in the reactions cause the system to execute a “drunkards walk” over the continuum of concentric , neutrally stable solution orbits , staggering sometimes outward and sometimes inward . In the case of Figure 9c , we see that the system has wandered out to solution orbits that approach to within less than 40 units of the Yl and Y2 axes . Clearly , it is only a matter of time before a random fluctuation carries the system’s phase point into one of these two axes . When that happens , the orbiting will cease : For if the system point , in its coun - terclockwise orbiting , should ever graze the Y2 axis , then the prey species Yl will become extinct , and reaction 38c will drive the system point straight down the Y2 axis into the origih . Similarly , if the system point should ever graze the Yl axis , then the predator species Yz will become extinct , and reaction 38a will drive the system point straight out the Yl axis to infinity . In short , no matter what the state of the system is initially , it will eventually wind up in either the state ( Yl = 0 , Y2 = 0 ) or the state The Lotka reactions thus provide a striking example of a model chemical system whose temporal behavior cannot be realistically calculated without taking specific account of the random fluctuations that occur at the microscopic level of the interactions . Although it is true that a con - siderable amount of information about the behavior of the Lotka model can be extracted from the deterministic formulation of chemical kinetics [ i . e . , the reaction - rate equations ( 39 ) ] , the stochastic formulation clearly provides a much more natural framework for this . In particular , the stochastic simulation algorithm leads routinely and automatically to a correct numerical description of the time evolution of the Lotka model without the need for any circumspect considerations of analytical stability . The numerical parameters used in Figures 8 and 9 are the same as used earlier by NakanishilO in his stochastic simulation calculations on the Lotka model . Nakanishi did not exhibit Yl - Yz phase plots as in Figures 8c and 9c , but he did subject his data to a detailed time - series analysis to determine the frequency components of the oscillations . As mentioned in section IIID , our stochastic simulation method represents a improvement over Nakanishi’s me - thod in terms of both rigor and ease of application . Also , our results bring out somewhat more clearly than did Nakanishi’s results the relative ease with which the Lotka system can progress from the stationary state ( Yls , Y2 , ) to the absorbing states ( 0 , O ) or ( m , 0 ) . Figure 10 is a 50 rpd plot of the Lotka reactions showing what happens when we “close” the system and let the X population be depleted by reaction 38a in the normal way . The modification required in the simulation program to effect this depletion is trivial : in the section of the program which increments the Yl population by 1 after an R1 reaction has occurred , we simply add an instruction to decrement the X population by 1 . In the run plotted in Figure 10 we used essentially the same parameters as in the previous Lotka runs , but we have allowed X to de - crease from an initial value of lo5 : c1 = 0 . 0001 , e2 = 0 . 01 , e3 = 10 ( 42 ) The heavy appearance of the X population trajectory is due to a “photographic burn” in the plotting hardware caused by the severe overlapping of successively plotted dots . The curve that oscillates about the 1000 level until ( Y1 = a , Yz = 0 ) . ( Figures 10 , 11 ) The Journal of Physlcal Chemistry , Vol . 81 , No . 25 , 1977 2352 Daniel T . Gillespie that the random number starter was changed . Again we see the extreme variability in the Lotka system : the vanishing of the Y2’s occurs at t N 28 in Figure 11 , as compared with t N 19 in Figure 10 ; also , the final number of Yl’s in Figure 11 turns out to be 7232 , as compared with 16449 in Figure 10 . The behavior illustrated in Figures 10 and 11 suggests that a number of modifications could be made in the Lotka reactions ( 38 ) to make them a more realistic model of naturally occurring predator - prey systems . As a simple illustration , suppose we add a fourth reaction to ( 38a - c ) Y , - - t z ( 38d ) which allows the preys to die of natural causes in the same way as the predators . Taking c4 c1 = 0 . 0002 , c2 = 0 . 01 , c3 = c4 = 10 and starting with X = lo5 and Yl = Yz = lo3 , two sto - chastic simulation runs were made . In one of these runs X was held constant , and in the other X was allowed to be depleted by reaction 38a . The results of the constant X run are plotted at 200 rpd in Figures 12a and 12b . These two plots are obviously very similar to the plots in Figures 8 and 9 ( except that this modified run contains about half again as many reactions ) . Indeed , the reaction - rate equations for reactions 38a - d predict that , if X is held constant at lo5 and el , . , . , c4 have the values in ( 43 ) , then we will have dYl / dt = dY2 / dt = 0 for Yl = Yz = 1000 , just as we had in the runs in Figures 8 and 9 . In Figure 13 we show a 50 rpd plot of the other simulation run , in which X is allowed to be depleted . As in Figures 10 and 11 , the heavy curve is the X trajectory , the upper oscillating curve is the Yl trajectory , and the lower oscillating curve is the Yz trajectory . As expected , Yl as well as Y , becomes extinct in this case . However , it is intriguing to note that Y2 becomes extinct considerably before Yl does , even though the natural life expectancy of a Yl is the same here as the natural life expectancy of a Yz ( i . e . , 1 / c4 = l / c3 ) . It is also interesting to note that over 40 % of the initial amount of X remains after both Yl and Yz have become extinct . It is obviously possible to modify the Lotka reactions in many other ways to obtain models of various other predator - prey systems . Suffice it here to say that , so long as these modifications can be expressed as additional chemical reactions and / or additional chemical species , they can be easily incorporated into our stochastic simulation computer program in a completely exact manner . IVC . The Brusselator . The neutrally stable character of the oscillations in the Lotka model , as illustrated by the phase trajectory plots in Figures 8c and 9c , leads us to wonder if there exists a model set of coupled chemical reactions with “positively stable” oscillations . More precisely , is there a model chemically reacting system with two intermediate species Yl and Yz which has the property that , no matter what its initial state , the system will eventually wind up orbiting around a well - defined , closed , stable path in the YIYz plane ? This question has been answered in the affirmative by workers in who have devised the following example of such a “limit cycle” chemical oscillator : 20 ( 43 ) ( Figures 12 , 13 ) - XI 2 Y , ( 44a ) 04 . , , , . , , , I 0 8 4 I I 10 18 I4 time - - - - i 0 l m o 2 m o 2 m o l o m ~ m m m number or Y1 molecules Figure 14 . Results of a 2 X 10’ reaction stochastic simulation run of the Brusselator reactions ( 44 ) , with c , Xl = 5000 , c , X , = 50 , c3 = 0 . 00005 , and c4 5 , corresponding to the deterministic steady state Y , = 1000 and Y , = 2000 . ( a ) A 100 rpd plot of Y , vs . t for 0 I t < 14 . ( b ) A 100 rpd plot of Y2 vs . t for 0 < t < 14 . ( c ) A 50 rpd plot of Y , vs . Y1 for 0 I t < 18 . 1 . zooming off the graph at about t = 19 is the Yl population curve . The curve that oscillates about a steadily decreasing value until it reaches zero at about t = 19 is the Yz population curve . The waviness of the X population curve is a direct consequence of the Yl oscillations , since the drain on X will be large when Yl is large and small when Yl is small . It is interesting to note that the depletion in the prey foodstuff X is more detrimental to the predators than to the preys . After the Y2’s become extinct at t N 19 , the remaining 15000 or so X’s are simply converted into Yl’s via reaction 38a . ( Notice that the Yl’s do not use X for sustinence but only for reproduction . ) Figure 11 shows another run identical with that in Figure 10 except - x , t Y , E ! + Y , + z , The Journal of Physical Chemistry , Vol . 8 1 , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions lam - am , 2353 number of Y1 molecules Figure 15 . A 50 rpd plot of Y2 vs . Y , for four stochastic simulation runs of the Brusselator ( 44 ) , each run having the same reaction pa - rameters as in Figure 14 but different initial values of Y1 and Y2 . time Flgure 16 . Showing what would have happened in the run of Figure 14 if the system had been closed to species XI . The exponentially decaying curve in ( a ) and ( b ) is a 250 rpd plot of XI ; the oscillating Y1 curve in ( a ) and Y2 curve in ( b ) are both plotted at 100 rpd . This set of reactions has been dubbed the “Brusselator” by T y ~ o n , ~ ~ and has been the object of extensive study by a number of worker ^ . ^ ^ , ^ ^ The deterministic reaction - rate equations for the Brusselator are evidently dY , / dt = ~ 1x1 - c ~ X Z Y ~ + ( c3 / 2 ) y12 yZ - Cqy1 ( 45a ) ( 45b ) dYz / dt = ~ 2 x 2 Y1 - ( ~ 3 / 2 ) Y1’Yz and it is easy to show from these that dY , f dt = dY2 / dt = 0 when Yl = YIB and Yz = Y2 , , where Yis cixi / c4 ( 46a ) I . , . . . . , . . , . , . . , 0 0 5 10 is M 25 Ea 35 time Figure 17 . Showing what would have happened in the run of Figure 14 if the system had been closed to species Xp . The heavy , smooth curve is X2 , plotted at 250 rpd ; the decaying jagged curve is Y2 , and the horizontal jagged curve is Y1 , both plotted at 100 rpd . Following the prescription of Figure 2 , a stochastic simulation computer program was written for the Brusselator ( putting M = 4 , N = 2 , X1 = Y1 , XZ = Yz , hl = X1 , h2 = X2Yl , h3 = Y2Y1 ( Yl - 1 ) / 2 , and h4 = YJ . With C1Xl = 5000 , ~ 2x2 = 50 , ~ 3 = 0 . 00005 , c4 = 5 ( Figures 14 - 17 ) ( 47 ) a simulation run was made with Yl and Yz initially set to the values YIB = 1000 and Yz , = 2000 . Figures 14a and 14b are 100 rpd plots of Yl vs . t and Yz vs . t , respectively , over the time interval 0 I t I 14 . Clearly , Yl and Yz do not remain at the stationary values Yls and Y2 , , but commence almost immediately to oscillate vigorously in an apparently regular and stable way . The sharp rises in Yl in Figure 14a coincide with the sharp falls in Yz in Figure 14b so closely that they appear to be single vertical lines when the two figures are superposed . It is worth noting that these sudden , drastic changes in the molecular population levels pose no special problems to our stochastic simulation procedure . Figure 14c is a 50 rpd plot of Yl vs . Yz over the slightly longer time interval 0 < t < 18 ; the cycle direction here is clockwise . The data in Figures 14a - c are from a 2 X lo6 reaction simulation run , which took the Univac 1110 computer about 7 min to perform , at a cost of about $ 60 . Although Figure 14c shows that the phase orbits in the Brusselator are indeed much more stable than the phase orbits in the Lotka model [ cf . Figures 8c and Sc ] , Figure 14c also shows a rather peculiar property of the Brusselator oscillations which , so far as the author is aware , has never been noticed before . This is the apparent inability of the system to consistently retrace its previous path on the diagonal leg of the limit cycle . The variability in these diagonal traces is directly related to the erratic variations in the heights of the peaks in Figures 14a and 14b . Al - though obviously caused by random fluctuations at the microscopic level , the effect itself is clearly more than microscopic : the relative variations in the peak heights in Figures 14a and 14b are on the order of 12 % , which is a good order of magnitude larger than one would expect on the basis of the usual “square root” argument . The time intervals between successive oscillations , as determined by the distances between the successive vertical rise lines in Figure 14a , show similar variations . Relatively crude ruler measurements on the graphs themselves indicate that the peak height achieved on any vertical rise in the Yl plot in The Journal of Physical Chemistry , Vo / . 8 1 , No . 25 , 1977 2354 Daniel T . Gillespie time 11030 Iprm m 1030 0 number of Yl molecules Figure 18 . Results of a stochastic simulation run of the Brusselator with c , X , = 5000 , Y , * = 1000 , YD , = 2000 , and Q = 0 . 1 , all plotted at 100 rpd : ( a ) Y , vs . t ; ( b ) Y2 vs . t ; ( c ) Y2 vs . Y , . Figure 14a is roughly proportional to the time elapsed since the previous rise . These observations would seem to warrant further investigations , although we shall not at - tempt any here . The Brusselator phase trajectory in Figure 14c seems to have a different “character” along each of the three legs of the limit cycle . The peculiar character of the trajectory along the diagonal leg has already been commented on . Along the vertical leg the trajectory is fairly sharp and well - defined , subject to rather ordinary looking fluctua - tions . However , the trajectory along the horizontal leg has a thicker , labored look , with fluctuations that appear to be more “diagonal” than “up and down” . Indeed , it almost seems that the YlY2 plane is scored with a series of closely spaced , parallel diagonal grooves : Starting at the right end of the horizontal trajectory , the system phase point seems to struggle along against these grooves until it reaches the I I number o ! Y1 molecules Figure 19 , Same as Figure 18 , except a = 0 . 2 ( corresponding to the same reaction parameters as for the runs in Figure 14 ) . neighborhood of the point ( YIs7 Y % ) . From there it seems to have a relatively smooth trip up the vertical leg , until it finally “drops” into one of the horizontal grooves . Precisely which groove the system phase point drops into is a matter of chance , but once lodged in one of these grooves it seems content to remain there for its quick trip down the final , diagonal leg of the orbit . Figure 15 shows a 50 rpd plot of four short simulation runs , each having the same parameters ( 47 ) as in the previous run , but each starting out at different points in the Y , Y , plane . As expected , no matter where we start out in this plane the system phase point eventually winds up on the clockwise limit cycle that we found in the previous run . However , the system seems to have very definite ideas as to just how it wants to approach the limit cycle : far from just spiraling in or out to the limit cycle as one might have naively expected , the system point seems again to be The Journal of Physical Chemlstty , Vol . 81 , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions . . . . taxa - a lam - e . s , - - z Em - 2355 a lxm - b I 0 I 2 3 4 5 8 7 B 8 10 time 0 ZWO 4WO Bwo 8Mi3 IWM Ixm l4WO number of Y1 molecules Flgure 20 . Same as Figure 19 , except cy = 0 . 5 . constrained by the imaginary diagonal grooves in the Y1Y2 plane mentioned above . As we observed in our calculations on the Lotka model , it is very easy to modify our stochastic simulation program so as to “open” or “close” the system to any particular reactant species . As indicated in ( 441 , the Brusselator is normally considered to be open to both X1 and Xz ; indeed , it is precisely this influx of X1 and Xz that drives the o ~ cillator . ~ ~ In Figures 16a and 16b we show what happens when , given the parameter values in ( 47 ) , we close the system to X1 , and allow X1 to be depleted by reaction 44a from an initial value of lo5 . In these two figures , the X1 trajectory is plotted at 250 rpd while the Yl and Y2 tra - jectories are each plotted at 100 rpd . The X1 trajectory simply falls exponentially according to the simple isom - erization mechanism ( cf . Figures 3 - 5 ) ; the darkened areas along the X1 trajectory are “photographic burns” resulting from the increased tempo of the reactions that accom - 0 . , 0 I 2 3 4 5 e 7 B 8 IO time - 1 I 0 0 ImO number of Y1 molecules 4wo Figure 21 . Same as Figure 20 , except a = 1 . 0 . In ( a ) , the upper trajectory is Y , and the lower trajectory is Y , . panies the sudden changes in Y1 and Y2 . As the X1 population decreases , the Yl and Yz oscillations evidently become less frequent but more violent ; in this connection , notice in Figure 16a that the Yl excursion time & e . , the length of the base of a Yl spike ) stays constant . After the last huge oscillation near t = 20 , in which the Yl and Y2 population levels change by a factor of about 400 , Yl never rises again and Yz never falls again . The time interval 0 5 t I 35 shown in Figures 16a - b contain approximately 1 . 45 X lo6 reactions . The action terminates about 0 . 04 X lo6 reactions later , at t = 213 . 4 , with X1 = 0 , Yl = 0 , and Y2 = 35344 . In Figure 17 we show what happens when the system is open to X1 but closed to X2 ; i . e . , X1 is again held constant , but X 2 is allowed to be depleted by reaction 44b . In Figure 17 the X 2 trajectory is plotted at 250 rpd , while the Yl and Y2 trajectories are each plotted at 100 rpd . In this case the system’s behavior is not nearly so exotic : Starting out at lo5 , X 2 quickly drops to zero - so rapidly in fact that an oscillating pattern for Yl and Y2 does not have time to fully develop . Y2 , starting at 2000 , decreases to zero , while Yl eventually settles back to its initial value 1000 ; this final steady state is easily understood from eq 46 . A stability analysis of the deterministic reaction - rate equations ( 45 ) by Lefever and NicolisZ3 and also by TysonZ4 predicts that the Brusselator should oscillate when the inequality ( 48 ) is satisfied , and presumably should remain at the sta - tionary values Yls and YIB in ( 46 ) otherwise . 25 To test this prediction , we first introduce a new parameter cr defined The Journal of Physlcal Chemlstry , Vol . 81 , No . 25 , 1977 2356 Daniel T . Glliespie a 1 by a ! = 2c4 / c2x2 ( 49 ) From now on , instead of specifying the Brusselator re - actions by the four parameters clX1 , cZXz , c3 , and c4 as in ( 47 ) , we shall use the four parameters , c1X1 , Y 1 , Y2 , , and 01 ; this is permissible because , using ( 46 ) and ( 49 ) c , x , = C l X l ( 50a ) c4 = ClXl / YlS ( 50d ) Inserting ( 50 ) into the oscillation criterion ( 48 ) , we find that this criterion assumes the somewhat simpler form a ! < 2 0 - Yl , / Y , S ) ( 51 ) The significance of the new parametrization of the Brusselator reactions is that clXl controls the time scale of the reactions , Yls and Yz , control the molecular pop - ulation scales , and a controls the stability of the reactions . For Yls = 1000 and Ya , = 2000 , as in the runs plotted in Figures 14 and 15 , the condition ( 51 ) for oscillatory instability in the Brusselator is simply Since ( 49 ) implies that a = 0 . 2 for the parameter values in ( 47 ) , then the oscillations observed in Figures 14 and 15 tend to confirm this criterion . To check this out more thoroughly , a series of six simulation runs was made with Y18 = 1000 and Yz , = 2000 , and with 01 8ssuming a suc - cession of values from 1 / 10 to 10 . The results of these runs are plotted in Figures 18 - 23 : a ! < 1 ( Yz , = 2Y , , ) ( 52 ) C i X 1 = 5000 , Y1 , = 1000 , Y2 , = 2000 , a ! = 0 . 1 ( Figure 18 ) ( 53 ) a ! = 0 . 2 ( Figure 19 ) ( 54 ) a : = 0 . 5 ( Figure 20 ) ( 5 5 ) a ! = 1 . 0 ( Figure 21 ) ( 56 ) a ! = 2 . 0 ( Figure 22 ) ( 57 ) a ! = 10 . 0 ( Figure 23 ) ( 58 ) ClXi zz 5000 , Y1 , = 1000 , Y2 , = 2000 , ~ 1x1 = 5000 , Y1 , = 1000 , Y , , = 2000 , ClXl = 5000 , Y1 , = 1000 , Yzs = 2000 , c , X1 = 5000 , Y , , = 1000 , Y Z s = 2000 , ~ 1x1 = 5000 , Y , , = 1000 , Y2 , = 2000 , All these runs start with Yl = 1000 and Y2 = 2000 at t = 0 . The plots all have 100 rpd and use the same scale on the t axis ; however , notice that Figures 18 - 20 use a dif - ferent scale on the Yl and Y2 axes than Figures 21 - 23 . The 01 = 0 . 1 plots in Figure 18 show the results of about 2 X lo6 reactions . The oscillations here are evidently quite violent . Notice in particular the incredible abruptness of the rises in Yl in Figure 18a and the concomitant falls in Yz in Figure 18b ; e . g . , near t = 10 the rise and fall lines are virtually parallel to the vertical right borders of the plots . Again we point out that this kind of rapid temporal population excursion poses no special problems for our stochastic simulation program . As we proceed from Figure 18 to 19 to 20 , we observe that the amplitude of the os - cillations decreases and their frequency increases , corre - sponding to the fact that a is moving closer to the critical value at which we expect the oscillations to cease and stability to set in . Figure 21 shows the behavior exactly at the critical point a = 1 ; the system evidently still os - cillates , but the oscillations are ragged and uneven . Figure 22 shows the behavior for a = 2 , which is supposedly in the stable , nonoscillating regime ; however , we see in Figure 22a that the Yl and Y2 population levels , though holding The Journal of Physical Chemistry , Vol . 81 , No . 25 , 1977 - - - - i I N ' 0 . . . . , . , . , , . , , , . , . , , . . , , . , , , , , . . , . . , , . , , . . , . , U 1wo PWO 3wo 4C . x JMO number of Y1 molecules Figure 22 . Same as Figure 21 , except a = 2 . 0 . . ! - - om number ZMO of Y1 molecules 3oM Flgure 23 . Same as Figure 22 , except a = 10 . 0 . Stochastic Simulation of Coupled Chemical Reactions IOZX a 2357 time time C 1or ) I . d am sm , Im , 0 0 K m P m J r m l D m I number of Y1 molecules b , _ _ . l _ . . _ _ . . _ . . 0 I m , m m J r m & & & number of Y2 molecules 0 Flgure 24 . Results of a 0 . 71 X 10 ' reaction stochastic simulation run of the Oregonator reactions ( 59 ) , with Yl , = 500 , Y2 = 1000 , Y3 , = 2000 , vi , = 2000 , and uZ = 50000 [ see ( Si ) ] . ( a ) Combined 100 rpd plots of Y1 ( low - peaking curve ) , Y , ( middle - peaking curve ) , and Y , ( high - peaking curve ) vs . t for 0 I t 5 6 . ( b ) Same as ( a ) , but for I C t < 3 . ( c ) A 250 rpd plot in Y1 Y2 Y3 space for 0 I t 5 6 . ( d ) Projection of the trajectory in ( c ) onto the Y , Y , plane . ( e ) Projection of the trajectory in ( c ) onto the Y , Y3 plane . ( f ) Projection of the trajectory in ( c ) onto the Y , Y3 plane . fairly close to Y18 and Y2 , , respectively , still exhibit no - ticeable , anticorrelated excursions similar to those at the critical point ( cf . Figure 21a ) . When we increase a to 10 , in Figure 23 , stability seems finally to be at hand . IVD . The Oregonator . The Brusselator has been criticized as being physically unrealistic on the grounds that reaction 44c , requiring as it does a simultaneous collision among two Yl molecules and a Y2 molecule , seems rather improbable from a kinetic theory point of view . However , Tyson and Light24 have shown that no set of chemical reactions with only two intermediate species ( Y1 and Y2 ) can exhibit limit cycle oscillations unless it contains at least one reaction of order 13 . Field and Noyes26 have devised a model chemical oscillator which circumvents this difficulty by introducing a third inter - mediate species ( Y3 ) ; their model , which they have named the Oregonator , is20 ( 59a ) x , + Y , - Y , ( 59b ) ( 59c ) ( 59d ) 2Y , - z , ( 59e ) and evidently involves no reaction more complicated than C1 - Y , + Y , 2 2 , x , + Y , 2 + ZY , + Y , x , + Y , 5 + Y , - c4 - 6 Figure 25 . A 250 rpd plot in Y1 Y2 Y3 space for fourstochastic simulation runs of the Oregonator ( 59 ) , each run having the same reaction pa - rameters as in Flgure 24 but different initial values of Y , , Yp , and Y3 . bim ~ lecular . ~ ~ Field and Noyes originally devised the Oregonator as a highly idealized model of the Belousov - Zhabotinskii reactions , which involve the cerium ion catalyzed oscillatory bromate oxidation of malonic acid . 28 A much more complete and realistic model of the Be - lousov - Zhabotinskii reactions was developed by Field , Koros , and Noyes , B and that model has been convincingly tested out by Edelson , Field , and Noyes30 through nu - merical integration of the corresponding reaction - rate equations . Our objective here is much less ambitious : we shall simply consider the Oregonator ( 59 ) as a chemical system in its own right , and show that its dynamical behavior for a given set of reaction parameters can be The Journal of Physical Chemlstty , Vol . 8 1 , No . 25 , 1977 2358 Daniel T . Gillespie values for the five auxiliary parameters Y18 , Y % , Y % , pl , , and p2 , . This is a convenient way to proceed because , by working with the parameters YIB , Y % , and Y3 . , we can more directly control the scales of the molecular population levels of the various species . 31 Similar considerations motivated our reparametrization of the Brusselator re - action constants in ( 50 ) . Following the procedure outlined in Figure 2 , a sto - chastic simulation computer program was written for the Oregonator ( putting M = 5 , N = 3 , X 1 = Yl , X 2 = Y2 , X 3 and h5 = X3Y3 ) . Taking = Y3 , hl = XiY , , hz = Y1Y2 , h3 = XZY , , h4 = Yl ( Y1 - 1 ) / 2 Y1 , = 500 , Yzs = 1000 , YBS = 2000 , pis = 2000 , p Z s = 50000 ( Figures 24 - 27 ) ( 62 ) the corresponding reaction parameters were calculated from ( 611 , and a stochastic simulation run was made with Y1 , Yz , and Y3 initially set to the nominal steady - state values 500 , 1000 , and 2000 , respectively . The results of this simulation run , which contained approximately 0 . 71 X lo6 reactions , are shown in Figures 24a - f . Figure 24a is a 100 rpd plot of all three intermediate species vs . time . Just as we found in the Brusselator [ cf . Figures 14a and 14b1 , the population levels quickly move away from the initial steady - state values and begin to oscillate vigorously in an apparently regular and stable manner . The low - peaking curve in Figure 24a is the Yl trajectory , the middle - peaking curve is the Y2 trajectory , and the high - peaking curve is the Y3 trajectory . To show the details of the cycling more clearly , the time interval 1 < t < 3 is shown on a horizontally expanded scale in Figure 24b ( which is also a 100 rpd plot ) . The cycling behavior shown here is quite consistent with the interpretation of Field and Noyes : 26 When the Yz molecular population level is high and the Yl and Y3 molecular population levels are low , reactions 59a and 59b dominate and act to slowly decrease the Yz population level ; when the Y2 population is finally reduced below a certain critical level ( evidently in the neighborhood of 1000 according to Figure 24b ) , reaction 59c becomes momentarily dominant and produces a rapid increase in the Yr . and Y3 population levels ; this increase in Yl and Y3 in turn stimulates reaction 59d , which pulls Yl down again , and reaction 59e , which pulls Y3 down and pushes Y2 back up . The cycle trajectories in Yl Y2Y3 space are plotted at 250 rpd in Figure 24c . As we found in the Brusselator [ cf . Figure 14 ~ 1 , we note that on some portions of the limit cycle the system phase point cannot consistently retrace its previous path . This seems to occur most prominently at the higher population levels , and is evidenced also in Figure 24a by the irregular variations in the peak heights of the Yl , Y2 , and Y3 curves . Although obviously due to random microscopic fluctuations , the overall effect is too large to be labeled microscopic . One possible explanation for this behavior might be that the cycling serves to transmit the relatiue fluctuations at the lower molecular population levels directly to the higher molecular popu - lation levels , where they are then much larger than would normally be expected . Figures 24d - f are 250 rpd plots of the projections of the phase trajectory onto the three phase planes ; Figure 24d emphasizes the peculiarly warped shape of the limit cycle orbit in YlY2Y3 space . Figure 25 is a 250 rpd plot of four short simulation runs which have the same parameters as in ( 62 ) but different starting points in YlY2Y3 space ; evidently , no matter where the starting point is taken , the system eventually winds up orbiting the same limit cycle path that was found in Figure 24c . Figure 26 is a 100 rpd plot showing what happens when , E - l m 2 - 4 0 h m C NMOO L z m j W gzm , ImO 0 0 I 3 4 5 B time Figure 26 . Showing what would have happened in the run of Figure 24 if the system had been closed to species X , . All trajectories are plotted at 100 rpd . The decaying curve is XI , and the low - peaking , middle - peaking , and highpeaking curves are Y , , Y , , and Y , respectively . . . . . . gxxI time Flgure 27 . Showing what would have happened in the run of Figure 24 if the system had been closed to species Xp . All trajectories are plotted at 100 rpd . The heavy decaying curve is X , , and the low - peaking , middle - peaking , and high - peaking curves are Y1 , Ypr and Y , , re - spectively . numerically calculated with our stochastic simulation procedure . To help guide us in assigning numerical values to the five reaction parameters clX1 , c2 , ~ 3x2 , c4 , and c5X3 , we begin by writing the deterministic reaction - rate equations for the Oregonator : d Y l / d t = C l X l Y2 - c2 Y1 Y2 + c3x2 Y1 - 2 ( c4 / 2 ) Y12 ( 604 dYz / dt = - C l X i Y2 - ~ 2 Y1 Y2 + ~ 5x3 Y3 ( Gob ) dY3 / dt = ~ 3x2 Y1 - ~ 5x3 Y3 ( 60c ) If Yl , Y % , and Y3 , are the values of Yl , Y2 , and Y3 for which dYl / dt = dY2 / dt = dY3 / dt = 0 and if pl , and p2 , are the deterministic reaction rates of the first two reactions ( 59a ) and ( 59b ) when these steady - state values obtain , Le . P 1s EE C l X l y 2 s and P2s = e2 Y1SY2 , then it is not difficult to show from ( 60 ) that C l X l = P l S / Y 2 S ( 6 1 4 c2 = P 2s I Y l s y z s ( 61b ) c3x2 ( P 1s + P ~ S ) / ~ I S ( 61c ) c4 = 2P1S / Y1S2 ( 61d ) c5x3 = ( P I S + P 2 S ) / Y 3 S ( 61e ) Therefore , one way to specify values for the five reaction parameters clXl , c2 , ~ 3x2 , c4 , and cgX3 is to first specify The Journal of Physical Chemistry , Vol . 81 , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions 2359 for the parameters in ( 62 ) , the system is closed to species X1 , and the X1 population level is allowed to be depleted by reaction 59a from an initial value of lo4 . The upper curve is the X1 trajectory , and the low - peaking , middle - peaking , and high - peaking curves are as before the Yl , Y2 , and Y3 trajectories , respectively . The waves in the X1 trajectory are caused by the Y2 variations through reaction 59a . As X1 decreases , the Yl and Y3 oscillations occur farther apart in time , but the shape of their peaks evidently remains unaffected . The oscillation near t = 3 . 4 is the system’s last gasp ; the action terminates at t = 11 . 5 with X1 = Yl = Y3 = 0 and Y2 = 4470 . Figure 27 is a 100 rpd plot showing what happens when we close the system to X 2 instead of X1 , and allow the X 2 population level to be depleted by reaction 59c from an initial value of lo5 . The waves in the X z trajectory are caused by the Yl variations through reaction 59c . In this case we see that the oscil - lations just slowly die out altogether . By time t = 6 , about 0 . 25 X lo6 reactions have occurred ; the action finally stops about 0 . 06 X lo6 reactions later , at t = 218 , with Yl = Y2 = Y3 = 0 and X 2 = 65 . Figures 28 - 30 show the effect of changing the Orego - nator reaction parameters in such a way that the limit cycle oscillations are made to disappear . These figures show three separate simulation runs , all with Y18 = 500 , Yz , = 1000 , Y3 , = 2000 as in the previous runs , but with the other two parameters pl . and pz , set as follows : pls = 2000 , pZS = 20000 ( Figure 28 ) ( 63 ) p ls = 4000 , pZS = 20000 ( Figure 29 ) ( 64 ) plS = 5000 , pzs = 5000 ( Figure 30 ) ( 65 ) Comparing these figures with their identically plotted counterparts in Figures 24a and 24c ( which are for pl , = 2000 and pz , = 50000 ) shows that , as the ratio p1 , / p2 , is increased from 0 . 04 to 1 . 00 , the regular oscillations dissolve into random microscopic fluctuations about the nominal steady - state levels . Finally , to investigate the effects of moving somewhat closer to the high molecular population levels realized experimentally , we made a stochastic simulation run of the Oregonator in which all the population levels were uni - formly increased by a factor of 4 over the run plotted in Figure 24 . This was accomplished by choosing the reaction parameter values so that , in contrast to ( 62 ) Y1 , = 2000 , Yzs = 4000 , Y3s = 8000 , pis = 2000 , pZS = 50000 ( Figure 31 ) ( 66 ) Figure 31a is a 500 rpd plot showing the details of the cycling , and is to be compared with Figure 24b . Figure 31b is a 1000 rpd plot of the phase trajectory in YlYzY3 space , and is to be compared with Figure 24c . Evidently , the only significant difference between these plots is the fourfold increase in the molecular population levels , and an ac - companying decrease in the relative size of the random , microscopic fluctuations . Especially noteworthy is the fact that the curious “spreading” of the limit cycle path in YlYzY3 space does not seem to have been appreciably reduced ; certainly , this spreading is much greater than the microscopic fluctuations on the individual orbits . The fourfold increase in the molecular population levels in this run was attended by a fourfold increase in the numbers of reactions per cycle , and hence a fourfold increase in the execution time of the computer simulation program : Figure 31b shows the results of approximately 2 . 8 X lo6 reactions , which cost about $ 80 to simulate to the Univac 1110 . In view of the consistency between Figures 24b and 31a , and between Figures 24c and 31b , there would seem to be IDmO a 9003 I time 1 ; b Figure 28 . Same as Figures 24a and 24c , except that pl , = 2000 and p2 , = 20000 . . . . . . 4 a 0 0 I 2 3 5 time b I Flgure 29 . Same as Figures 24a and 24c , except that pIs = 4000 and p2 , = 20000 . little point to increasing the molecular population levels any further . In this connection , it should be recognized The Journal of Physical Chemistty , Vol . 81 , No . 25 , 1977 Daniel T . Gillespie 2360 1 P F r $ P a L E 2 . - om , am ma am Mm 3xa om , ICCC 0 0 I 2 3 5 time b I , I time Figure 30 . Same as Figures 24a and 24c , except that p , , = 5000 and p2 , = 5000 . that it is not necessarily desirable to scale the molecular population levels so high that all trajectories appear to be devoid of random fluctuations . Such fluctuations should be regarded as an intrinsically real aspect of the dynamical behavior of a chemically reacting system , not as some imperfection in our observational technique that ought to be eliminated . Indeed , part of the utility of our stochastic simulation procedure is that it affords us a unique op - portunity to examine these fluctuations in a wide variety of controlled situations . V . Concluding Remarks This paper has described and ilustrated the use of a novel method for numerically calculating the time evo - lution of a spatially homogeneous system of coupled chemical reactions . This “stochastic simulation algorithm” has been shown to be physically and mathematically well - grounded from a kinetic theory point of view , and rigorously equivalent to the spatially homogeneous master equation , yet surprisingly simple and straightforward to implement on a digital computer . The principle advan - tages and limitations of the algorithm have been sum - marized in section IIID . Suffice it here to say that the specific applications considered in section IV demonstrate quite convincingly both the feasibility and the potential usefulness of this computational approach . A comparison of the relative advantages of the stochastic simulation algorithm with those of the traditional method of numerically solving the deterministic reaction - rate equations is perhaps inevitable , and strong points can be scored on both sides . However , it would seem more fruitful to focus on the complementary aspects of these two computational methods instead of the competitive aspects . From this point of view , each method represents a tool , with specific advantages and limitations , which the Figure 31 . Showing the effects of increasing all molecular population levels In the Oregonator by a factor of 4 over their values in Figure 24 : Y1 , = 2000 , Yp , = 4000 , YB3 = 8000 , pl , = 2000 , and p , . = 50000 . ( a ) A 500 rpd plot of Y , ( low - peaking curve ) , Y , ( middle - peaking curve ) , and Y , ( high - peaking curve ) vs . f for 4 < t < 12 ( cf . Figure 24b ) . ( b ) A 1000 rpd plot of the trajectory In Y , Y , Y , space for 0 5 f 5 24 ( cf . Figure 24c ) . chemical kineticist may employ at his discretion to elu - cidate the temporal behavior of a chemically reacting system . As presented here , the stochastic simulation algorithm is applicable only to spatially homogeneous systems . Work toward extending the algorithm to accommodate molecular diffusion in spatially inhomogeneous systems is currently in progress , and will be reported on at a later date . Acknowledgment . The numerical results reported in this paper were calculated on the NWC Central Computing Facility’s Univac 1110 computer , and were plotted with their versatile DISSPLA / FR - 80 computerized plotting system ; the author is especially grateful to Hans Lindblom of the CCF for his helpful guidance in the use of the latter . The author acknowledges with thanks some fruitful dis - cussions and correspondence with Dr . Dan Walls and Dr . Crispin Gardiner of the University of Waikato , and also some clarifying remarks by Professor N . G . van Kampen and Dr . G . Nicolis . Finally , the author takes special pleasure in expressing his gratitude to his wife Carol , whose generous advice in her capacity as a professional scientific programmer made the author’s efforts on the computer much more productive and enjoyable than they would have been otherwise . References and Notes ( 1 ) D . T . Gillespie , J . Comput . Phys . , 22 , 403 ( 1976 ) . ( 2 ) In golng from ( 2a ) to ( 2b ) , and also from ( 3b ) to ( 3c ) , it might appear that we are suggestlng that an imminent collision is possible even between two molecules that are very far apart . However , this IS not implied here . For a detailed discussion of this point , see D . T . Gillespie , J . Stat . Phys . , 16 , 311 ( 1977 ) . The Journal of Physical Chemistry , Vol . 81 , No . 25 , 1977 Stochastic Simulation of Coupled Chemical Reactions 2361 ( 31 ) From our point of view , eq 61 do not assume the validity of the deterministic reaction - rate equations ( eq 60 ) ; rather , they simply offer an alfernate parametrization of the Oregonator rextion constants . ( 3 ) D . A . McQuarrie , J . Appi . Prob . , 4 , 413 ( 1967 ) . ( 4 ) This average Is equivalent to the “ensemble average” that WaS denoted by angular brackets in eq 5a and 6b . ( 5 ) It is considered implicit in ( 4 ) that the probability for more than one reaction to occur in dtis of order > 1 in dt , and is therefore effectively zero . Thus , between times tand t + dt , ether no reactions will occur , or else some one of the M R , reactlons will occur . ( 6 ) The reaction - rate equations ( eq 1 ) have only one independent variable , namely , the continuous variable t ; however , the master equatlon ( eq 13 ) has N + 1 independent variables , namely the Ndiscrete variables X , , . . . , XN and the one continuous variable t . ( 7 ) For a somewhat more rigorous version of the foregoing arguments , see section 111 of ref 1 . ( 8 ) The art of writing reliable unit - interval uniform random number generators is quite involved , and is best left to the experts ; see , for example , D . E . Knuth , “The Art of Computer Programming” , Vol . 2 , Addison - Wesley , Reading , Mass . , 1969 , and also G . Marsaglia and T . A . Bray , Commun . Assoc . Comput . Mach . , 11 , 757 ( 1968 ) . It is important to note that these generatot‘s , even those written in Fortran , are usually machine dependent ; a Fortran genelator written for one kind of computer wili seldom work properly on another kind of computer . ( 9 ) For a detailed discussion of this general procedure , see Chapter 2 of D . T . Gillespie , NWC Technical Paper No . 5714 ( “The Monte Carlo Method of Evaluating Integrals” ) , Naval Weapons Center , China Lake , Calif . , 1975 . [ Available from National Technical Information Service , Springfleld , Va . 22161 ; not available directly from the author , ] ( 10 ) T . Nakanishi , J . Phys . SOC . Jpn . , 32 , 1313 ( 1972 ) . See also T . Nakanishi , ibid . , 40 , 1232 ( 1976 ) . ( 1 1 ) D . L . Bunker , B . Garrett , T . Kleindienst , and G . S . Long , 111 , Combust . flame , 23 , 373 ( 1974 ) . ( 12 ) The discrete character of our 7 - selection process is nota result of any approximation scheme , but merely a consequence of the fact that any bounded chemical system contains a finite number of molecules . ( 13 ) M . Malek - Mansour and G . Nicolis , J . Stat . Phys . , 13 , 197 ( 1975 ) . ( 14 ) R . Gortz and D . F . Walls , Z . Phys . , 825 , 423 ( 1976 ) . See also R . Gortz , J . fhys . A , 9 , 1089 ( 1976 ) . ( 15 ) D . F . Walls , private communication . ( 16 ) G . Nicolis , J . Stat . Phys . , 6 , 195 ( 1972 ) . ( 17 ) R . Mazo , J . Chem . fhys . , 62 , 4244 ( 1975 ) . ( 18 ) A . Nitzan and J . Ross , J . Stat . Phys . , 10 , 379 ( 1974 ) . ( 19 ) Y . Kuramoto , Prog . Theor . Phys . , 49 , 1782 ( 1973 ) . ( 20 ) A barover any reactant species signifies that its molecular populatiofl is assumed to remain constant ; the system Is said to be “open” to that species . ( 21 ) A . J . Lotka , J . Am . Chem . SOC . , 42 , 1595 ( 1920 ) ; Proc . Natl . Acad . Sci . U . S . , 6 , 410 ( 1920 ) . ( 22 ) For a comprehensive review of Volterra’s and other nonlinear models of interacting populations , see N . S . Goel , S . C . Maitra , and E . W . Montroll , Rev . Mod . Phys . , 43 , 231 ( 1971 ) . ( 23 ) 1 . Prigogine and R . Lefever , J . Chem . Phys . , 48 , 1695 ( 1968 ) ; R . Lefever and 0 . Nicolis , J . Theor . Bio / . , 30 , 267 ( 1971 ) ; G . Nicolis , Adv . Chem . fhys . , 19 , 209 ( 1971 ) . ( 24 ) J . J . Tyson , J . Chem . Phys . , 58 , 3919 ( 1973 ) ; J . J . Tyson and J . C . Light , ibid . , 59 , 4164 ( 1973 ) . ( 25 ) Condttion ( 46 ) was obtained from eq 2 and 5 of J . J . Tyson , J . CMm . fhys . , 58 , 3919 ( 1973 ) . ( 26 ) R . J . Field and R . M . Noyes , J . Chem . Phys . , 60 , 1877 ( 1973 ) . ( 27 ) Field and Noyes actually write the fifth reaction as fY3 - + Y , , where f is a “stoichiometric factor” which is introduced in an attempt to obtain a better correspondence with the real Belousov - Zhabotinskii reactlons . In most cases , as here , fis simply taken as unity . The “reversible Oregonator” has been discussed by R . J . Field , J . Chem . Phys . , 63 , 2289 ( 1975 ) ; the ”closed OreQonator” has been discussed by R . M . Noyes , J . Chem . Phys . , 64 , 1266 ( 1976 ) . ( 28 ) 8 . P . Belousov , Sb . Ref . Radiat . Med . , 7958 , 145 ( 1959 ) ; A . M . Zhabotinskli , “Oscillatory Processes in Blological and Chemical Systems” , Science Publishers , Moscow , 1967 , p 149 . ( 29 ) R . J . Field , E . Koros , and R . M . Noyes , J . Am . Chem . Sac . , 94 , 8649 ( 1972 ) . ( 30 ) D . Edelson , R . J . Field , and R . M . Noyes , Int . J . Chem . Kin . , 7 , 417 ( 1975 ) . Discussion W . C . GARDINER , JR . ( University of Texas ) . ( 1 ) Your stochastic algorithm involves substantially more operations per “integration cycle” ( one more call to URN and one to ALOG ) than the procedure published by Bunker and co - workers ( Combust . Flame , 1974 ) . What does your procedure gain from this extra work ? ( 2 ) What is the largest ratio of species concentrations that can reasonably be handled in a practical application of your routine ? D . T . GILLESPIE : ( 1 ) The relationship between my stochastic simulation algorithm and the procedure of Bunker et al . ( ref 11 ) is discussed in sectior IIID of this paper , and also on p 429 of ref 1 . The main point is that my method is fully equivalent to the spatially homogeneous master equation , whereas the method of Bunker et al . is not . Therefore , a more appropriate question would be : “Under what conditions may one replace , in step 2 of Figure 2 , the statement t = ( l / ao ) In ( l / rl ) with the simpler statement t = ( l / ao ) , without introducing sensible alterations in the computational results ? ” I think it should certainly be possible to make this replacement when one is calculating the mean and variance of a stable or metastable state , as described in connection with eq 34 and 37 ; in fact , for that type of calculation one could probably just dispense with t altogether . However , for calculating a system’s transient behavior , I do not see how one could con - fidently answer this question except empirically on a case - by - case basis . I am sure that for many situations the shorter expression for t would prove to be adequate ; but notice , for example , that it could not be used for the simple isomerization reaction 22 if one were interested in studying fluctuations . I have made no study of this matter in these initial calculations , essentially taking the position that the a priori assurance of being rigorously correct , which comes with using the longer expression for t , is worth the fractional increase in computer running time . ( 2 ) The runs plotted in Figures 16 and 18 are “reasonable” , and show relative population ratios that span roughly four orders of magnitude . Of course , the fundamental limitation on this procedure is not the population ratios per se , but rather the total number of individual reaction events that must be simulated in order to cover the time span of interest . At typical charging rates on the Univac 1110 , I found a rough rule of thumb to be $ 30 per IO6 reactions . The runs plotted in Figures 16 and 18 contain between 1 and 2 X lo6 reactions each . ROBERT J . GELINAS ( Science Applications , Inc . ) . I must take exception to the remarks made subsequent to Gillespie’s talk by Professor Shuler , and the other allowed questioner , disparaging Gillespie’s method , Gillespie’s general method has strong foundations in quantum kinetic theory and in corresponding Langevin analysis which were not discussed . His imaginative reaction accounting method is to conventional statistical ap - proaches based on species concentrations , as second quantization is to first quantization in quantum theory . I cannot vouch for his algebra at this time , but his basic method is worthy of positive acknowledgment and encouragement . As with the origination of many new creative ideas , time is required to develop a veneer against unwarranted criticism . It would certainly be a disservice to discourage further pursuit of Gillespie’s work at this early time . The Journal of Physical Chemistry , Vol , 8 1 , No . 25 , 1977
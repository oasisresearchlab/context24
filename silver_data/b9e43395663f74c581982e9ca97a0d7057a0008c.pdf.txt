Mathematical Programming 14 ( 1978 ) 265 - 294 . North - Holland Publishing Company AN ANALYSIS OF APPROXIMATIONS FOR MAXIMIZING SUBMODULAR SET FUNCTIONS - I Gi . NEMHAUSER * and L . A . WOLSEY Center for Operations Research and Econometrics , University of Louvain , Louvain - La - Neuve , Belgium M . L . FISttERt University of Pennsylvania , Philadelphia , PA , U . S . A . Received 8 November 1976 Revised manuscript received 18 July 1977 Let N be a finite set and z be a real - valued function defined on the set of subsets of N that satisfies z ( S ) + z ( T ) > - z ( SUT ) + z ( SnT ) for all S , T in N . Such a function is called submodular . We consider the problem maXscN { z ( S ) : IS [ < - K , z ( S ) submodular } . Several hard combinatorial optimization problems can be posed in this framework . For example , the problem of finding a maximum weight independent set in a matroid , when the elements of the matroid are colored and the elements of the independent set can have no more than K colors , is in this class . The uncapacitated location problem is a special case of this matroid optimization problem . We analyze greedy and local improvement heuristics and a linear programming relaxation for this problem . Our results are worst case bounds on the quality of the approximations . For example , when z ( S ) is nondecreasing and z ( 0 ) = 0 , we . show that a " greedy " heuristic always produces a solution whose value is at least 1 - [ ( K - 1 ) / K ] K times the optimal value . This bound can be achieved for each K and has a limiting value of ( e - l ) / e , where e is the base of the natural logarithm . Key words : Heuristics , Greedy Algorithm , Interchange Algorithm , Linear Programming , Matroid Optimization , Submodular Set Functions . 1 . Introduction In a recent paper Cornuejols , Fisher and Nemhauser [ 2 ] give bounds on approximations ( heuristics and relaxations ) for the uncapacitated location prob - lem . Here we extend these results and generalize them to a larger class of problems . We can view the location problem as the following combinatorial one . Given a non - negative m x n matrix C = ( cii ) with column index set N and row index set / , for each non - empty S C N define z ( S ) = ~ max cii ( 1 . 1 ) i ~ l jES * On leave of absence from Cornell University and supported , in part , by NSF Grant ENG 75 - 00568 . t Supported , in part , by NSF Grant ENG 76 - 20274 . 266 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions and z ( 0 ) = 0 . The problem is to find an S of cardinality less than or equal to a specified integer K ( K < n ) such that z ( S ) is maximum ; i . e . , max { z ( S ) : IS ' l < - - K , z ( S ) given by ( 1 . 1 ) } . ( 1 . 2 ) Sc _ N As noted in [ 2 ] , problem ( 1 . 2 ) is a member of the class of NP - hard problems . A fundamental property of the function given by ( 1 . 1 ) is that , for R C S and k E N - S , adding k to S will increase z by no more than by adding k to R . Note that max cij - max ci i = max ( 0 , C ~ k - - max cij ) j ~ Su { k } j ~ S j ~ S - < max ( 0 , Cik - - max cii ) ( 1 . 3 ) j ~ R = max c ~ j - maxc # , iEL ] ~ RU ( k } ] ER where the inequality follows from maxjEs c # - maxj ~ R cij . By summing the in - equalities of ( 1 . 3 ) over i we obtain that z ( S ) defined by ( 1 . 1 ) satisfies z ( SU { k } ) - z ( S ) ~ - z ( RU { k } ) - z ( R ) , RCSCN , kEN - S . ( 1 . 4 ) 1 Furthermore , z ( S U { k } ) - z ( S ) > - O , S c N , k ~ N - S . ( 1 . 5 ) A real - valued function z ( S ) defined on the set of subsets of N that satisfies ( 1 . 4 ) [ and ( 1 . 5 ) ] is called a submodular [ nondecreasing ] set function . Thus a natural generalization of ( 1 . 2 ) , which we study in this paper , is max { z ( S ) : ISI < - K , z ( S ) submodular } . ( 1 . 6 ) SC _ N Note that when z is nondecreasing the cardinality constraint is necessary in ( 1 . 6 ) to obtain a nontrivial problem . However when z does not satisfy ( 1 . 5 ) , the problem is interesting even without the cardinality constraint ( i . e . , K = IN I = n ) . Although our results apply to arbitrary submodular functions , they are much sharper for nondecreasing submodular functions . In Section 2 we give several equivalent definitions of submodular functions and we will see that submodularity is in some sense a combinatorial analogue of concavity . Most of these results are not original ; we collect them together and prove them here to facilitate availability and use throughout this paper . A rich variety of combinatorial optimization problems can be modeled as the maximization of submodular functions as in ( 1 . 6 ) . In Section 3 we present three classes of these problems . One class , which contains the location problem , arises from matroids , another from the assignment problem and a third from boolean polynomials . To motivate the representation of combinatorial optimization I This property for the uncapacitated location problem has been observed by Babayev [ 1 ] , Frieze [ 6 ] and Spielberg [ 9 ] . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 267 problems by ( 1 . 6 ) , we now present the location problem in its matroid context . Let E be a finite set and ~ a nonempty collection of subsets of E . The system = ( E , ~ * ) is called a matroid if ( a ) F1 E ~ and F2 C F1 ~ F2 E ~ - . ( b ) For all E ' C E every maximal member of ~ - ( E ' ) = { F : F E ~ - , F C _ E ' } has the same eardinality . The members of o ~ are called independent sets . Suppose that the elements { e } of E are assigned weights { Ce } and consider the matroid optimization problem of determining v ( E ' ) = max ~ Ce . ( 1 . 7 ) FE ~ ( E ' ) eff . F The function v ( E ' ) is submodular and nondecreasing ( see Proposition 3 . 1 ) but it is completely unnecessary to consider approximations for ( 1 . 7 ) since it is well - solved by a simple greedy algorithm [ 5 ] . Consider , however , a generalization of ( 1 . 7 ) in which the elements of E are assigned colors as well as weights ; in other words E is partitioned into subsets { Qj : jEN } and the elements of Qr are colored j . The problem is to find a maximum weight independent set that contains no more than K colors . Let z ( S ) = = max jES e ~ F kj ~ S The function z ( S ) in ( 1 . 8 ) gives the value of a maximum weight independent set that is restricted to the colors contained in S . The submodularity of v ( E ' ) in ( 1 . 7 ) implies the submodularity of z ( S ) in ( 1 . 8 ) , see Proposition 2 . 5 . Thus the matroid optimization problem of finding a maximum weight independent set that contains no more than K colors is a case of ( 1 . 6 ) where z ( S ) is given by ( 1 . 8 ) . To show that the location problem can be placed in the framework of ( 1 . 7 ) and ( 1 . 8 ) let E = { ( i , j ) : i EI , jEN } and partition E into the subsets Ei = { ( i , j ) : j E N } , i ~ I . Define an F C E to be independent if and only if IF VI Ei [ - - < 1 , i ~ L This system clearly satisfies matroid property ( a ) and property ( b ) follows from the fact that every maximal independent set of E ' has cardinality [ { i E I : E ' V1Ei ~ 0 } [ . The matroid defined by this system is the well - known partition matroid . Let cir - - - 0 be the weight of ( i , j ) E E , i E I , j E N and Qr = { ( i , ] ) : i ~ I } , j ~ N . When E ' = U rEs Qr , S c _ N , we obtain v ( U 0r ) = ~ max cir . ( 1 . 9 ) z ( S ) = \ rES / iEl rES Note that ( 1 . 9 ) is identical to ( 1 . 1 ) so that we have described the location problem as an optimization problem with respect to a partition matroid and have obtained another proof that the location problem belongs to ( 1 . 6 ) . The result obtained in this indirect and tedious way provided impetus for our work . 268 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher ~ Maximizing submodular set functions Sections 4 - 7 contain the results on approximations . Here we briefly sum - marize the main results for z ( 0 ) = 0 , z nondecreasing and z ~ 0 . In Section 4 we study a greedy heuristic that first solves ( 1 . 6 ) for K = 1 and then iteratively approximates for larger K . If S , ] SI = p , is the approximate solution for K = p , then the approximate solution for K = p + 1 is determined by adding to S ( if possible ) a j * such that z ( S U { ] * } ) = maxj ~ sz ( S U { j } ) and z ( S U { j * } ) > z ( S ) . We obtain the bound value of greedy approximation > ( K _ ~ 1 ) K e - 1 value of optimal solution - 1 - - - - > - - e where e = 2 . 718 • • • is the base of the natural logarithm . This result is generalized to the case in which the greedy algorithm selects a subset of cardinality R at each iteration . In Section 5 we analyze an interchange heuristic for ( 1 . 6 ) that begins with an arbitrary set S of cardinality K and attempts to improve on the value of this set by replacing r members of S by r members of N - S , 1 - < r - < R . The procedure stops when no such improvement is possible . When R divides K we obtain the bound value of interchange approximation K value of optimal solution - 2K - R " For the matroid case , in which z ( S ) is given by ( 1 . 8 ) , we can state ( 1 . 6 ) as an integer program . In Section 6 we study a linear programming relaxation of this integer program . The quality of the linear programming approximation depends on the matroid structure relative to the sets { Qj } . For a particular case that includes the location problem we obtain the result value of greedy approximation > _ I _ [ K - - I ~ K . value of linear programming solution All of the bounds mentioned above are achieved by worst - case examples . The performance of a heuristic sometimes can be improved by combining it with partial enumeration . Suppose for some heuristic we have ( value of heuris - tic ) / ( value of optimal solution ) - > l - B ( K ) . In Section 7 we analyze the approx - imation that first enumerates all ( IRul ) subsets of N for a specified R < K and then applies the heuristic to each of the ( 1 ~ 1 ) problems ( 1 . 6 ) with a fixed subset of cardinality R , and K replaced by K - R . Choosing the best of these solutions yields value of R - enumeration plus heuristic approximation > value of optimal solution ( K - R ) > - 1 ~ B ( K - R ) . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 269 2 . Submodular set functions 2 Definition 2 . 1 . Given a finite set E , a real - valued function z on the set of subsets of E is called submodular if ( i ) z ( A ) + z ( B ) > - z ( A U B ) + z ( A VI B ) , VA , B C E . We shall often make use of the incremental value of adding element j to the set N ; let p ~ ( S ) = z ( S U { j } ) - z ( S ) . Proposition 2 . 1 . Each of the following statements is equivalent and defines a submodular set function . ( i ) z ( A ) + z ( B ) > - - z ( A U B ) + z ( A f - I B ) , ( ii ) oj ( S ) > - oj ( T ) , V S C T C E and ( iii ) oj ( S ) > - pj ( S U { k } ) , VS C _ E and ( iv ) z ( T ) < - z ( S ) + ~ pj ( S ) - ~ pj ( SUT - { j } ) , jET S jES - T ( v ) z ( T ) < - - z ( S ) + ~ oj ( S ) , VSC _ TCE . ] ET - S ( vi ) z ( T ) < - z ( S ) - ~ , pi ( S - { j } ) , VTCSCE . j @ S - T ( vii ) z ( T ) < - z ( S ) - ~ pj ( S - { j } ) + ~ ] pj ( SAT ) , VA , BCE . j @ E - T . j @ E - ( S U { k } ) . VS , TC _ E . VS , TCE . jES - T jET - S Proof . We will prove the equivalence of ( i ) and ( ii ) , and then ( iii ) ~ ( ii ) ~ ( iv ) ~ ( v ) ~ ( iii ) . Statements ( vi ) and ( vii ) can be shown to be equivalent in a similar manner . ( i ) ~ ( ii ) . Take SC T , jE T , A = S U { j } and B = T in ( i ) . This yields z ( S U { j } ) + z ( T ) > - z ( T U { j } ) + z ( S ) , or pj ( S ) = z ( S U { / } ) - z ( S ) > - z ( T U { j } ) - z ( T ) = pj ( T ) . ( ii ) ~ ( i ) . Let { j , . . . . . Jr } = A - B . From ( ii ) we obtain pj , ( A n B u { j , . . . . . ji - , } ) > - pi , ( B U { j ~ . . . . . Ji , } ) , i = 1 . . . . . r . Summing these r inequalities yields z ( A ) - z ( A N B ) > - z ( A U B ) - z ( B ) . 2 Edmonds [ 4 ] and Shapley [ 8 ] , among others , give various properties of submodular set functions . See also [ ll and [ 6 ] . 270 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions ( iii ) ~ ( ii ) . Take S C T , j(cid:127) T , and T - S = { J1 . . . . . Jr } . Then from ( iii ) we have pj ( S ) > pj ( S U ( Jl } ) , pj ( S U { j , } ) _ > pj ( S U { Jl , j2 } ) . . . . . pj ( S U { Jl . . . . . Jr - I } ) > - - pj ( T ) . Summing these r inequalities yields ( ii ) . ( ii ) ~ ( iv ) . For arbitrary S and T with T - S = { Jl . . . . . jr } and S - T = { kl . . . . . kq } we have z ( S U T ) - z ( S ) = ~ [ z ( S U { Ji . . . . . it } ) - - z ( S U { Jl . . . . . jt - l } ) ] t - 1 = ~ pj , ( SUljl . . . . . jt _ l } ) < - ~ Oi , ( S ) = ~ _ , pi ( S ) ( 2 . 1 ) t - 1 t = l j ~ T - S where the inequality follows from ( ii ) . Similarly q z ( S U T ) - z ( T ) = ~ _ , t = l [ z ( T U { k , . . . . . k , } ) - z ( T U { k , . . . . . kt - , } ) ] q q = ~ , & , ( T 0 { k , . . . . . kt } - { kt } ) - > ~ & , ( T U S - { kt } ) t = l t = l = ~ pj ( SU T - { j } ) . jES - T We obtain ( iv ) by subtracting ( 2 . 2 ) from ( 2 . 1 ) . ( iv ) ~ ( v ) . If SC _ T , S - T = t ~ and the last term of ( iv ) vanishes . ( v ) ~ ( iii ) . Substitute T = S U { j , k } , j¢ ~ S U { k } in ( v ) to obtain z ( S O { j , k } ) - < z ( S ) + pi ( S ) + pk ( S ) , or ( 2 . 2 ) pj ( s o { k } ) = z ( S o { / , k } ) - z ( S o { k } ) = z ( S 0 { ] , k } ) - pk ( S ) - - z ( S ) < ~ pj ( S ) . In many cases we consider nondecreasing submodular functions , which , in addition to ( i ) , satisfy z ( S ) < - z ( T ) , VS C T C E . Proposition 2 . 2 . Each of the following statements is equivalent and defines a nondecreasing submodular set function . ( i ' ) z ( A ) + z ( B ) > - z ( A U B ) + z ( A A B ) , VA , B C E , z ( A ) < - - z ( B ) , VACBCE . ( ii ' ) pj ( S ) > - pj ( T ) > - O , VSCTCE , Vj ~ E . ( iv ' ) z ( T ) < - z ( S ) + ~ _ ~ pj ( S ) , VS , T C E . jET - S Proof . ( i ' ) ¢ ~ ( ii ' ) is a trivial consequence of ( i ) ~ ( ii ) . Now ( ii ' ) © ( ii ) ~ ( iv ) . But pj ( T ) > - - 0 implies that the last term of ( iv ) is nonpositive , and this fact gives ( iv ' ) . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 271 Finally , ( iv ' ) ~ ( ii ' ) since choosing S = T U { j } in ( iv ' ) yields z ( T ) < - z ( T U { j } ) or pj ( T ) > - O . We remark that definitions ( ii ) and ( ii ' ) suggest decreasing returns to scale and the notion of concave set functions . Furthermore ( i ) and ( i ' ) when rewritten as [ z ( A ) - z ( A N B ) ] + [ z ( B ) - z ( A N B ) ] - > > - [ z ( AUB ) - z ( ANB ) ] , VA , BC _ E can be thought of as generalized subadditivity . However , subadditivity by itself is not sufficient to obtain any of our results on approximations given in Sections 4 , 5 and 6 . Now we look at other properties of submodular set functions that are useful in the following sections . Since E is a finite set , upper and lower bounds on pj ( S ) exist . Proposition 2 . 3 . VSC _ E , jEE - S , then ( a ) z ( T ) < - z ( S ) + If z is a submodular set function on E with 0 < - - oi ( S ) < - tO , ~ , oi ( S ) + l S - TIO , VS , TC _ E . ] ~ T - S ( b ) z ( T ) < - - z ( S ) - ~ oj ( S - { j } ) + IT - SIto , VS , TCE . ] cS - T Proof . Substitute the bounds on Or into definitions ( iv ) and ( vii ) . We shall also make use of the incremental value of adding subset J to subset S . Let o ] ( S ) = z ( S U J ) - z ( S ) . Proposition 2 . 4 . If z is a nondecreasing submodular set function on E and { J1 . . . . . Jr } is a partition of T - S , Then z ( T ) < - - z ( S ) + 2 p ] , ( S ) . i = 1 The next four propositions show how to generate new submodular functions from given ones . Of particular interest to us is the creation of submodular functions by letting subsets { Qj } of E be the elements in a set function . Proposition 2 . 5 ( See ( 70 ) of [ 4 ] ) . Given a submodular set function v on the set of subsets of E and a collection of subsets { Qi } , ] E N , orE ; if ( a ) v is nondecreasing , or ( b ) the { Qj } are disjoint , then z ( S ) = v ( U iesQi ) is a submodular set function on the set of subsets of N . Proof . ( Throughout the proof we abbreviate U iST Qj by U r Qj . ) Submodularity 272 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher [ Maximizing submodular set functions of v implies z ( A ) + z ( B ) = v ( U Oj ) + v ( U Oi ) A B - > vf ( U Qj ) u ( U Qp ] + v [ ( U Oj ) n ( U Qp ] . A B A B Also ( UAQj ) N ( UBQj ) ~ UANBQi wi / £h equality if ( b ) holds . Therefore either ( a ) or ( b ) implies v [ ( UAQj ) r ~ ( UBQj ) ] ~ v ( UArlBQj ) . Since ( UAQpU ( U B Qi ) = U AUB Qj we obtain z ( A ) + z ( B ) > - z ( A UB ) + z ( A N B ) . Proposition 2 . 6 . Let dj be the weight of j C E . The linear set function z ( S ) = ~ j ~ sd i , S C E , is submodular . Proposition 2 . 7 . A positive linear combination of submodular functions is sub - modular . Proposition 2 . 8 . Given a submodular set function v ( S ) , S C E , then the set function z ( S ) = v ( E - S ) is submodular on S C E . Proof . z ( A ) + z ( B ) = v ( E - A ) + v ( E - B ) > - v [ ( E - A ) U ( E - B ) ] + v [ ( E - A ) f3 ( E - B ) ] = v ( E - A 71B ) + v ( E - A U B ) = z ( A CI B ) + z ( A U B ) . 3 . Some classes of submodular functions A . Matroid optimization Let d / / = ( E , @ ) be a matroid , Ce the weight of e EE , and o % ( E ' ) = { F : F E J , F C E ' } , E ' C E . Members of the complement of ~ are called depen - dent sets , minimal dependent sets are called circuits . If F is independent and F U { j } is dependent then F U { j } contains exactly one circuit . If C ' and C 2 are distinct circuits of F and e E clcl C 2 , then C ~ U C2 - { e } contains a circuit . ( Refer to Section 1 for other terminology . ) Edmonds [ 5 ] has given a greedy algorithm that finds a maximum weight independent set in a matroid . ( Note that , since subsets of independent sets are independent , every maximum weight independent set contains a maximum weight set in which all elements have positive weight . Thus we assume , without loss of generality , that all elements of E have positive weight . ) The greedy algorithm proceeds as follows . Arrange the elements of E in a list such that e ' above e implies Ce , - - > Ce . Examine the topmost element of the list not yet considered and select it if it does not form a circuit with some of the elements already selected . The subset selected after the last element has been considered is of maximum weight . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 273 Lemma 3 . 1 . Assume that the elements of E have been put in a list as described above . Let F be the maximum weight independent set in ~ - ( E ' ) given by the greedy algorithm , G the maximum weight independent set in ~ ( E ' U { e } ) , e ~ E E ' , given by the greedy algorithm and f E E - ( E ' U { e } ) . Exactly one of the following four statements is true . and G U { S } are both independent . and G U { f } are both dependent and contain the same unique ( 1 ) FU { f } ( 2 ) F U { . f } circuit . ( 3 ) F U { f } ( 4 ) F U { f } the circuit of is independent and G U { f } is dependent . and G u { f } are both dependent . G = F U { e } - { er } , er # e , and er is in F ub ~ } . Proof . These four statements are mutually exclusive . Furthermore , the greedy algorithm implies that G must be F , FU { e } or FU { e } - { er } , e ~ # e . More precisely G = F U { e } if F O { e } is independent and otherwise G = F U { e } - { er } , where er ( er can be e ) is a minimum weight element in the unique circuit of F U { e } . We now prove , by considering separately the three possibilities for G , that one of the four statements must be obtained . ( a ) G = F . Either ( 1 ) or ( 2 ) must be true . ( b ) G = FU { e } . If GU { f } E ~ then FU { f } E ~ as FCG and we obtain ( I ) . If G U { f } ~ ~ , we obtain ( 2 ) if F U { f } ~ E ~ and we obtain ( 3 ) if F U { f } E . @ . ( c ) G = F U { e } - { G } , e ~ # e . Let C be the unique circuit in F U { e } . Suppose ' first that F U { f } E ~ . Then C is also the unique circuit in F U { e , f } . Thus er E C implies that F U { e , f } - { e ~ } = G U { f } is independent and we obtain ( 1 ) . Now suppose that F U { f } ~ E ~ and let C be the unique circuit inF U { f } . If e , E C , then C UC - { er } contains a circuit in G U { f } and we obtain ( 4 ) . If er ~ t ~ , then C F U { f } - { er } C G U { f } . Hence C is the unique circuit of G U { f } and we obtain ( 2 ) . Proposition 3 . 1 . 3 The set function v ( E ' ) = max ~ ce , E ' C _ E , FE ~ ( E ' ) eEF is submodular and nondecreasing . Proof . Since E C E ' implies ~ ( / ~ ) _ C ~ ( E ' ) , v is nondecreasing . To prove submodularity let F , G , e and f be defined as in Lemma 3 . 1 . By Proposition 2 . 1 it suffices to show that ps ( E ' ) ~ ps ( E ' U { e } ) . We will establish this result for the four mutually exclusive and collectively exhaustive statements of Lemma 3 . 1 . Note that for all / ~ c E , ps ( / ~ ) ~ - - Q . 3 j . Edmonds has pointed out to us that Proposition 3 . 1 also can be proved using Proposition 2 . 5 and the fact that the rank function of a matroid is submodular [ 4 ] . We prove Proposition 3 . 1 here because it does not seem to be in the literature , except in an unpublished paper by Woodall [ 10 ] , which proves a more general result for polymatroids . 274 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions ( 1 ) and ( 3 ) . Since F U { f } E o % , pI ( E ' ) = % ( 2 ) ps ( E ' ) = ps ( E ' U { e } ) = c I - min ~ ec % where C is the unique circuit in F U { f } and G U { f } . ( 4 ) In this case G = F U { e } - { er } , er # e , where er ~ . C , the unique circuit of F U { e } , and er E ( J , the unique circuit of F U { f } . Thus the unique circuit C ' of G U { f } is contained in C U C - { er } and ps ( E ' U { e } ) = c f - mincg - < c s - min cg g ~ C ' gCCOC - { er } - < c s - min Q = of ( E ' ) , gEC where the last inequality follows from G = F U { e } - { ¢ } , which implies % = min ~ ec % Combining Proposition 2 . 5 with Proposition 3 . 1 we obtain . Proposition 3 . 2 . Let { Q ~ } , ] ~ N , be a collection of subsets of E . The set function z ( S ) = maX { ~ e ~ FCe : F E o ~ ( Ujes Qj ) } , s c N , is submodular and nondecreasing . To interpret the use of Proposition 3 . 2 in the context of problem ( 1 . 6 ) we consider a graphic matroid . Given a graph G , a subset of its edges is an independent set it " the subgraph induced by these edges is a forest ( contains no cycles ) . Each edge is assigned a weight and one or more colors from the set N ; Qj , ] E N , is the subset of edges that are colored ] . z ( S ) , S C N , is the value of a maximum weight forest that contains colors only in the set S . Problem ( 1 . 6 ) is to find a maximum weight forest that contains no more than K colors . B . Generalized transportation problems Let I be a set of sources , J a set of sinks and cik the value of assigning source i to sink k . Consider the family of transportation ( or assignment ) problems parametrized by T C _ I : v ( T ) = max ~ ~ CikXik , iE T k ~ J ~ , Xik < - - bk , k ~ J , lET ( 3 . 1 ) ~ X ~ k < - - l , i ~ T , k @ J xik - > 0 , iET , kEJ . Proposition 3 . 3 ( Shapley [ 7 ] ) . v ( T ) , T C _ L given by ( 3 . 1 ) is submodular . We now consider a generalization of ( 3 . 1 ) in which there is a set N of suppliers . The ] th supplier , ] ~ N , can provide a0 units from source i and has a fixed cost of d i . Let z ( S ) be the value of an optimal solution to the transportation G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 275 problem when the set z ( S ) = max of suppliers S C _ N is employed , i . e . , E E E 4 , iel kEJ rES ~ x ~ k < - - bk , k ~ J , i ~ I ieI , kEJ jES Xik ~ O , iEI , kEJ . ( 3 . 2 ) Proposition 3 . 4 . z ( S ) , S C _ N , given by ( 3 . 2 ) is submodular . Proof . For the moment ignore the fixed costs { dj } and consider a problem of the form ( 3 . 1 ) with ~ iE1 ~ reN air sources each with an availability of one unit . Let M be the set of these sources and g ( T ) , T C _ M , the maximum value solution of ( 3 . 1 ) that can be obtained from the subset T . By Proposition 3 . 3 , ~ 7 ( T ) is submodular . Now let Qr be the subset of M corresponding to the jth supplier . By Proposition 2 . 5 , 2 ( S ) = g ( UresQj ) , SC _ N , is submodular . Finally , the sub - modularity of z ( S ) = ~ ( S ) - ~ , rEs di is a consequence of Propositions 2 . 6 and 2 . 7 . We note that with z ( S ) given by ( 3 . 2 ) , problem ( 1 . 6 ) , without the cardinality constraint , gives an optimal set of suppliers . In the particular case in which each supplier is associated with only one source , we obtain the so - called " capacitated location problem " . C . Boolean polynomials Let g be a real - valued function on the set of subsets of N and for all S C _ N define z ( S ) = ~ g ( T ) = ~ _ ~ g ( T ) I - [ xj , TC _ S TC _ N jET 1 , jE S , ( 3 . 3 ) wherex i = 0 , j ~ S . We note that any set function z ( S ) can be represented by ( 3 . 3 ) by defining g ( 0 ) = z ( 0 ) and g ( S ) = z ( S ) - ~ , rcsg ( T ) . The problem of maximizing z ( S ) is a nonlinear boolean program . Proposition 3 . 5 . z ( S ) given by ( 3 . 3 ) is submodular if and only if ~ , rc _ sg ( T U { j , k } ) - - < 0 for all SCN and ] , k ~ S , j # k , and nondecreasing if and only if ~ , Tc _ sg ( T U { j } ) - - > 0 for all S C N and ] ~ S . Proof . We have p ~ ( S ) = g ( T ) - ~ _ . g ( T ) = ~ g ( T O { j } ) TC _ SU { j } TC _ S TC _ S 276 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher ~ Maximizing submodular set functions and pj ( S ) - pj ( SU { k } ) = ~ g ( TU { j } ) - ~ , E ( TU { j } ) TCS TC _ SU { k } = - ~ g ( r u { j , k } ) . TcS An interesting case of ( 3 . 3 ) is the quadratic boolean polynomial that is obtained by putting g ( T ) = 0 for [ TI > 2 . Here a simple necessary and sufficient condition for submodularity is g ( { i , j } ) < - O for all { i , j } with i # j , and z is nondecreasing if and only if g ( { j } ) - - ~ , i¢ig ( { i , 1 } ) for all j ~ N . In this context , problem ( 1 . 6 ) takes the form : max { xHx : ex < - K , x i E { 0 , 1 } , j = 1 . . . . . n } , where H is a symmetric matrix with non - positive off - diagonal elements and e = ( 1 , 1 . . . . . 1 ) . Submodular quadratic polynomials can be used to describe the cut function of a graph . Given an undirected graph G = ( V , E ) , let w [ i > - O , i < j be the weight of edge ( i , ] ) E E . A cut in G is a partition of the vertices into sets S and V - S . The value of the cut is given by the function v ( S ) = ~ ies ~ , ie v - s wo , where wij = wii = wb if ( i , ] ) ~ E and wij = 0 otherwise . Let z ( S ) = - ½ ~ , iEs ~ , jes wii ; z is submodular since p , ( S ) - p , ( S U { k } ) = jESLI { k } £ Wrj - - ~ S " Wr ] = Wrk ~ O . The submodularity of v follows by noting that v ( S ) = z ( S ) + z ( V - S ) - z ( V ) and then using Propositions 2 . 7 and 2 . 8 . Problem ( 1 . 6 ) in this context , without the cardinality constraint , is to find a maximum cut in the graph . Using the set function z we see that it is equivalent to max { ½ [ eWe - xWx - ( e - x ) W ( e - x ) l : xj C { 0 , 1 } , j = 1 . . . . . n } , where W = { wij } . 4 . The greedy heuristic for submodular set functions A natural way to find solutions to problem ( 1 . 6 ) quickly is to start from the null set and add elements one at a time , taking at each step that element which increases z the most . The resulting solution is called a " greedy " solution , and the procedure , which we now define formally , the " greedy " heuristic . As before , we let pj ( S ) = z ( S U { j } ) - z ( S ) . The greedy heuristic for set functions Initialization . Let S ° = 0 , N O = N and set t = 1 . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 277 Iteration t . Select i ( t ) E N t - I for which pi ( t ) ( S t - l ) = maxieN , - l ( S t - l ) with ties settled arbitrarily . Set pt - ~ = Pi ( t ) ( St - 1 ) • Step 1 . If Pt 1 < - 0 , stop with the set S t ( * , K * = t - I < K . If pt - l > 0 , set S ' = S t - ~ U { i ( t ) } and N t = N t - ~ - { i ( t ) } . Continue . Step 2 . If t = K , stop with the set S K * , K * = K . Otherwise set t - ~ t + 1 . Let Z be the value of an optimal solution to problem ( 1 . 6 ) and let Z a be the value of a particular solution to ( 1 . 6 ) constructed by the greedy heuristic . Note that Z G = z ( 0 ) + p0 + ' ' ' + pK , - b K * - < K , and , since the { Or } may depend on how ties are settled , Z G may as well . We will assume throughout this section that K * - > 1 , thus excluding trivial problems with Z = Z ~ = z ( 0 ) . Let C ( O ) be the class of submodular set functions satisfying or ( S ) > - - O , VSCN , j ~ N - S . Proposition 4 . 1 . steps , then the corresponding { p ~ } ff _ - * o 1 satisfy Suppose z E C ( 0 ) , 0 - > 0 , and the greedy heuristic stops after K * t = 0 . . . . . K * - I t - 1 Z < - z ( fJ ) + Y ~ pi + Kp , + tO , i = 0 and also ( 4 . 1 ) K * - I Z < - z ( tt ) + ~ , pi + K * O , ifK * < K . i = 0 Proof . By Proposition 2 . 3 , z ( T ) < - z ( S ) + ~ jeT - spi ( S ) + [ S - T ] O . Taking T to be an optimal solution of problem ( 1 . 6 ) , S to be the set S t generated after t iterations of the greedy heuristic , and using Z = z ( T ) , pi ( S ' ) < - p , , p , > - O , [ St - Tl < _ t , 0 > _ 0 , [ T - StI ~ K , and we obtain t l z ( S ' ) = z ( O ) + ~ p ~ , i = 0 t - I Z < - z ( fa ) + ~ pi + Kpt + tO , t = 0 . . . . . K * - I . ; = 0 In addition , if K * < K , taking S = S K * yields K * - I Z < - - z ( O ) + ~ pi + K * O i = 0 as PK * ~ O . From Proposition 4 . 1 we immediately obtain some simple results . For exam - 278 G . L . Nemhauser , L . A . Wolsey , M . L , Fisher / Maximizing submodular set functions pie , putting 0 = 0 in the last inequality of ( 4 . 1 ) yields Proposition 4 . 2 . If the greedy heuristic is applied to problem ( 1 . 6 ) with z non - decreasing and stops after K * < K steps , the greedy solution is optimal . From the first inequality of ( 4 . 1 ) with t = 0 we obtain Proposition 4 . 3 . If the greedy heuristic is applied to problem ( 1 . 6 ) then Z - Z G K - 1 z - z ( O ) - K Proof . The inequality for t = 0 of ( 4 . 1 ) yields Z - z ( 0 ) - < Kpo < - K ( Z G - z ( 0 ) ) or , equivalently , Z - Z G K - 1 Z - z ( 0 ) - K The bound of Proposition 4 . 3 can be tight only for very large values of 0 . For example , when 0 = 0 we will obtain the much sharper bound Z - z ( 0 ) - < In fact , we will obtain a family of K bounds , each one of which is tight for a different interval containing / 9 . These intervals cover the whole nonnegative domain of / 9 that is of interest . The bounds are obtained by applying linear programming to the problem of minimizing Z c subject to the inequalities ( 4 . 1 ) . Lemma 4 . 1 states the linear program and its solution . After proving the lemma , we will use it to establish the bounds . Let a = ( K - 1 ) / K . Lemma 4 . 1 . Given positive integers j and K , j < K , and a non - negative real number b , let J P ( b ) = Kb + rain ~ xl , i = O t - 1 ~ _ ~ xi + Kxt > - l - ( K + t ) b , t = 0 . . . . . j , ( 4 . 2 ) i = 0 i xi ~ - 1 - ( K + j + 1 ) b , i = 0 then and ~ ' 1 - ( j + 1 ) b P ( b ) = ( 1 + ( K - ] - 1 ) b - O ~ j + l / / j " ~ - 1 ~ j + l minb _ ~ 0 P ( b ) ; 1 - ~ , - R - ] ~ . if b ~ aJ + l / K , if b > - ai + l / K , G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 279 If the last constraint is omitted from ( 4 . 2 ) , then P ( b ) = 1 + ( K - j - 1 ) b - ai - - i for all b > - O . Proof . The dual of problem ( 4 . 2 ) is j + l W ( b ) = Kb + max ~ ' ~ { 1 - ( K + t ) b } ut , t = 0 j + l Kui + ~ ut = l , i = O . . . . . j , ( 4 . 3 ) t = i + l ut > - - O , t = O . . . . . j + l . We now proceed to calculate W ( b ) , and hence by LP duality P ( b ) . Let h = 1 - ui + l in ( 4 . 3 ) . Then we observe that feasible values of the remaining variables ut , t = 0 . . . . . j , are uniquely determined with ut = ( MK ) a j - t and J { 1 - ( g + t ) b } ut = h [ 1 - o / j + l - ( J At - 1 ) b ] . t = O Therefore W ( b ) = max { Kb + x [ 1 - aj . l _ ( ] + 1 ) b ] + ( 1 - h ) [ 1 - ( K + j + 1 ) b ] } O ~ A ~ I = max { 1 - ( ] + 1 ) b + h ( Kb - aJ + l ) } . O _ < h ~ l It follows immediately that h = 0 ( us + 1 = 1 ) , if Kb < a i + l , and h = 1 ( uj - + t = O ) if Kb > a i + 1 . Therefore W ( b ) = max { l - ( j + l ) b , 1 + ( K - j - 1 ) b - iff j + l } if b < - d + l / K , if b > - aJ + l / K . and { l - ( j + l ) b , ( 4 . 4 ) P ( b ) = W ( b ) = + ( K - j - 1 ) b - ai + l , Now we observe that as ] + 1 > 0 and K - j - 1 - 0 , [ ai + l ' ~ / j + 1 " ~ i + , min P ( b ) = PI ] = 1 - b _ 0 - g - t - 2 - ) Consider now the case where the last constraint of ( 4 . 2 ) is omitted . Dropping this constraint is equivalent to finding an optimal dual solution with ui + l = 0 . But then from ( 4 . 4 ) we obtain P ( b ) = 1 + ( K - j - 1 ) b - a i + 1 . Theorem 4 . 1 . ff the greedy heuristic is applied to problem ( 1 . 6 ) with z E C ( 0 ) , then ( a ) if it terminates after K * steps , then ( b ) if Z - Z ~ [ K * \ K * z - z ( O ) + KO = - ' 0 < _ 0 OL k ~ 2m Z - z ( O ) + KO - - K ' 280 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions then Z - Z ° Z - z ( O ) + KO < ak + l O ( K - k - 1 ) < ak + l ' - - K - 0 - ( c ) there is a family of problems of the form 1 . . . . . K - 2 and k + l k ot 0 ot K - Z - z ( O ) + KO - K ' and fork = K - 1 and g 0 a 0 < - Z - z ( O ) + KO < - - K ' the first inequality of ( b ) is an equality and K * = k + 1 . k = 0 . . . . . K - l , ( 1 . 6 ) such that for k = Before proving Theorem 4 . l we state a much simpler version of it . Although far less general , the simplified version presents the most useful part of Theorem 4 . 1 . The right - hand side of ( a ) increases with K * , hence setting K * = K we obtain Theorem 4 . 2 . 4 / f the greedy heuristic is applied to problem ( 1 . 6 ) with z E C ( 0 ) , then Z - Z ° Z - z ( O ) + KO - ~ aK " Proof of Theorem 4 . 1 . We first dispose of the case 0 < 0 ( z strictly increasing ) in ( a ) . Let z ' ( S ) = z ( S ) + ] S ] O . We observe that Z - Z G - Z ' - Z ' G , Z - z ( O ) + KO = Z ' - z ' ( O ) and z ' is nondecreasing . Therefore applying the result for 0 = 0 to z ' yields the desired conclusion for z . For the remainder of the proof we assume that 0 - > 0 . The rest of the proof uses Lemma 4 . 1 with 0 and xi : Pi b = Z - z ( O ) + KO Z - z ( ~ ) + KO " With this transformation of variables the inequalities of the linear program are identical to the inequalities ( 4 . 1 ) of Proposition 4 . 1 and we obtain i P ( b ) ( Z - z ( O ) + KO ) < - - KO + ~ , pi . ( 4 . 5 ) i = O Now for j < K * , ~ ] ~ = o Pi < - - Z a - z ( O ) and ( 4 . 5 ) yields P ( b ) ( Z - z ( O ) + KO ) < - KO + Z G - z ( O ) . ( 4 . 6 ) 4 For uncapacltated location problems this result appears in [ 2 ] . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 281 The proof of ( a ) is now separated into two parts . ( K * < K ) . Here with j + 1 = K * all of the inequalities of ( 4 . 2 ) are valid and from Lemma 4 , . 1 , P ( b ) > - l - ~ a ( 4 . 7 ) By substituting ( 4 . 7 ) into ( 4 . 6 ) and doing some algebraic manipulation we obtain the result ( a ) . ( K * = K ) . Here with ] + 1 = K only the first K inequalities of ( 4 . 2 ) are valid and from Lemma 4 . 1 P ( b ) > - l + ( K - K ) b - a K = l - a K . ( 4 . 8 ) Now substituting ( 4 . 8 ) into ( 4 . 6 ) and doing some algebraic manipulation yields ( a ) . To prove ( b ) for a given non - negative integer k , suppose first that k < K * . Thus the first k + 1 inequalities of ( 4 . 2 ) are valid and by Lemma 4 . 1 O ( K - k - 1 ) k÷J P ( b ) > - I + z _ z ( O ) + K 0 a ( 4 . 9 ) Substituting ( 4 . 9 ) into ( 4 . 6 ) and doing some algebraic manipulation yields Z - Z G O ( K - k - 1 ) k + l - - < a if k < K * . ( 4 . 10 ) Z - z ( O ) + KO Z - z ( O ) + KO ' The right - hand side of ( 4 . 10 ) decreases with O / ( Z - z ( O ) + KO ) and a k + l - ( ak / K ) ( K - k - 1 ) = ( k / K ) a k . Therefore ( k ) ak < ak + , O ( K - k - l ) if0 < 0 a k - - ~ - - ( 4 . 11 ) Z - z ( O ) + KO ' Z - z ( O ) + KO - K " Now from ( a ) we have Z _ - z ~ O ~ - ~ KO - ~ a K * < - ~ a , if k > - g * ( 4 . 12 ) since ( k / K ) a k increases with k . Combining ( 4 . 11 ) and ( 4 . 12 ) yields Z - Z G O ( K - k - 1 ) k + l Z - z ( 0 ) + KO - Z - z ( 0 ) + KO ' k 0 a if k > K * and 0 < - ~ - - ( 4 . 13 ) - - Z - z ( 0 ) + KO - K " Finally , combining ( 4 . 10 ) and ( 4 . 13 ) yields ( b ) . ( c ) For K = 2 , 3 . . . . . let C K be a K ( K - 1 ) by 2K - 1 matrix with entries as follows ' ( K - 1 ) K K 2a J - l , ifi = ( j - 1 ) K + l . . . . . jK , forj = l , . . . , K - 1 , cif = 0 , otherwise , 282 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions and J ' K K - l , if i = l + j + ( l - 2 ) K , l = 1 . . . . . K - l , for J K 2K 1 , Ci K 1 ( 0 , otherwise , and let 0 be a nonnegative scalar . We claim that z ( S ) = Y ~ zel max ~ es c ( - O IS [ is the required function . For this function , problem ( 1 . 6 ) is an uncapacitated location problem with a fixed cost of 0 at each location . For the case 0 = 0 it can be shown ( the details are given in [ 2 ] ) that the greedy heuristic can select the first K columns so that Z a = ( K - 1 ) K ~ ( 1 - aK ) , while the last K columns are an optimal set so that Z = ( K - 1 ) K K . More generally when k + l 0 a - ( K - < 1 ) K ~ : - 1 - < ak ' k = O , . . . , K - 2 or 0 - < 0 - < ( K - I ) K for k = K - 1 , the greedy heuristic can select the first k + 1 columns while the last K columns are an optimal set . We then obtain Z G = ( K - 1 ) K ~ : ( 1 - ak + ~ ) - ( k + l ) O and Z = ( K - 1 ) K K - KO . Using these values of 0 , Z G and Z , ( c ) is easily verified . Having analyzed the worst - case behavior of the greedy heuristic , we consider whether the results can be substantially improved by finding the R best possible elements to add to the given solution at each iteration . The R - step greedy heuristic requires O ( n R + I ) evaluations of z so that increasing R by one increases the number of computations by a factor of n . However we will show that , in the worst case , increasing R does not yield a substantial improvement in the quality of solutions . For simplicity , we consider only nondecreasing functions . The R - step greedy heuristic for set functions Suppose K = qR - p , where q is a positive integer and 0 - < p < R . Let S t = [ . - J I = 1 1 i and S o = 0 . For t = 1 . . . . . q - 1 choose P _ c N - S t - I with ] P [ = R so as to maximize ~ t - 1 = z ( S t ) - z ( St - 1 ) . Finally choose I * _ C N - S q - I with [ I * ] = R - p so as to maximize ~ = z ( S q - 1 U 1 " ) - z ( Sq - ~ ) . Let q - 2 Z G ~ R ) = z ( O ) + Y ~ ~ i + n = z ( S q 1 U I * ) i = 0 denote the value of an R - step greedy solution . Theorem 4 . 3 . Suppose z is nondecreasing and the R - step greedy heuristic is applied to problem ( 1 . 6 ) : ( a ) If K = qR - p , with q a positive integer , p integer 0 < - p < - - R - 1 , Z - - z° ( R ) < { q - - A ) { q - - l ~ q - I < ( q - - l ) q - ~ , whereA - R - P Z - z ( O ) - \ q J \ q J " q / R ( b ) If p = 0 , i . e . , K is a multiple of R , the bound is tight . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set . functions 283 Proof . ( a ) Let ~ q _ ~ = maxll > R z ( Sq - ~ U I ) - z ( S q - ~ ) and T be an optimal solution _ _ _ + q to ( 1 . 6 ) . By submodularity and Proposition 2 . 4 , z ( r ) z ( S t ) ] ~ i = lOj ~ ( S ' ) , where { Ji } q ~ is any partition of T - S t with IJil < - R , i = 1 . . . . . q . Since z ( St ) = z ( ~ ) + ~ ] ' i2 - 1 ~ i and Oj ~ ( S ' ) < - ~ , , we have Z - < z ( 0 ) + ~ 0 + ~ l + ' ' ' + ~ , - j + q ~ t , t = 0 . . . . . q - 1 . ( 4 . 14 ) Also q - 2 q - 2 z ~ R ' = z ( O ) + ~ o ; ' + ~ > - ~ ( o ) + ~ o = ; ' + ~ ' q - ' = 2 ~ % since submodularity implies ~ ; - > ) ~ 6q _ ~ . Therefore Z - 2 o ( R ) Z - Z ° { R } z - z ( 0 ) - z - z ( 0 ) " It now suffices to prove that 2 ~ " ~ - z ( 0 ) { ¢im ~ } ~ Z - z ( O ) subject to ( 4 . 14 ) ( 4 . 15 ) equals 1 - [ ( q - A ) ] q ] [ ( q - 1 ) / q ] q - 1 . Reasoning as in the analysis of the 1 - step greedy heuristic ( see Lemma 4 . 1 with b = 0 ) , we can formulate problem ( 4 . 15 ) as the linear program q - 2 min ~ ~ i + ; t ~ q _ , , i = 0 t - 1 E ~ i + q¢ , > - - l , t = O . . . . . q - 1 . i = O Its dual is q - 1 max ~ ] ut , t = 0 q - 1 qui + 2 ~ ut = l , i = 0 . . . . . q - 2 t = i + l qUq - 1 = A , Ut > - - O , t = 0 . . . . . q - - 1 . The solutions ffi = q i = 0 . . . . . q - l , 1 [ q - X ~ ( q - 1 ~ q , - 1 = ~ _ " t = qlk - ~ - - f ~ l ] lT , ] , t = O . . . . . q - - R , Uq - 1 q , are primal and dual feasible , and give the required result . ( b ) To show that the bound ( Z - Za ( e ) ) l ( Z - z ( O ) ) = ( ( q - 1 ) lq ) q is attained when K - - qR , take the uncapacitated location problem with C = C q • C q 284 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher ~ Maximizing submodular set functions where the matrix C q defined in the proof of part ( c ) of Theorem 4 . 1 is repeated R times along the diagonal . At iteration t the R - step greedy heuristic can choose the tth column of each matrix C q , and therefore the behavior is the same same as if the greedy heuristic is applied to C q . Example . K = 6 , R = 3 , q = 2 , E c 2 1 C = C 2 = C 2 1 2 0 0 0 0 0 0 0 - 1 0 2 0 0 0 0 0 0 0 0 0 1 2 0 0 0 0 0 0 0 1 0 2 0 0 0 0 0 0 0 0 0 1 2 0 0 0 0 0 0 0 1 0 2 We obtain Z = 12 , ZG ( 3 ' = 9 , Z - za ( R ~ - 12 - 9 - ( ~ - ) 2 . Z - z ( O ) 12 Consider the problem max { z ( S ) : IS I > - [ NI - K , z ( S ) submodular } . ( 4 . 16 ) SCN For problem ( 4 . 16 ) we can apply a " stingy heuristic " , where one starts with the set N at each step removes an element so as to maximize the value of the remaining ones . An alternative but equivalent view of this heuristic is to apply the greedy heuristic with the submodular set function v ( S ) = z ( N - S ) , see Proposition 2 . 8 . This observation allows us to use Theorem 4 . 1 to obtain a worst case analysis for the stingy heuristic applied to ( 4 . 16 ) . Let Z be the optimal value and Z s the value of a stingy heuristic solution to ( 4 . 16 ) . Theorem 4 . 4 . If the stingy heuristic is applied to the problem ( 4 . 16 ) with pi ( S ) < _ 0 and terminates after K * steps , then Z - z ( N ) + KO - ~ ~ K * . When K = fNI problems ( 1 . 6 ) and ( 4 . 16 ) are identical and we can apply both the greedy and stingy heuristics and consequently obtain the better of the two bounds from Theorems 4 . 1 and 4 . 4 . 5 . The interchange heuristic for submodular set functions Here we consider another familiar way of trying to generate a good solution for problem ( 1 . 6 ) . If z is nondecreasing , there is an optimal solution containing K elements . Thus it makes sense to start from an arbitrary set of K elements and look for a subset of R or fewer elements that can be profitably replaced by an equal number of elements not in the set . The procedure is then repeated until no G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 285 further improvements of this type can be made . The resulting solution is called an R - interchange solution , and the procedure the R - interchange heuristic . The R - interchange heuristic for nondecreasing set functions Initialization . Pick an arbitrary set S° ' C _ N with IS°I - - K . Set t = 1 . Iteration t . Given a set S t - ~ with IS ' - ~ [ = K , try to find a set P C _ N with IPI = K , and ] P - St - l [ = IS ~ - ~ - PI < - - R such that z ( P ) > z ( St - ' ) . Set S ' = P , t - ~ t + 1 , and continue . If no such set P exists , stop . S * = S ' ~ is an R - interchange solution . Let Z ~ ¢R ~ = z ( S * ) denote the value of an R - interchange solution . We note that the above heuristic is far from being completely specified . In particular both the choice of starting set S ° , and the method of searching for P are arbitrary . The bound given in Theorem 5 . 1 applies , however , regardless of how we make these choices . Theorem 5 . 1 , 5 Suppose z is nondecreasing , and the R - interchange heuristic is applied to problem ( 1 . 6 ) . ( a ) / f K = qR - p with q a positive integer , and p integer 0 < - p ~ R - 1 , Z - Z ~ ( m K - R + p Z - z ( O ) - 2K - R + p " ( b ) If p = O , i . e . , K is a multiple of R , the bound is tight . Proof . ( a ) For simplicity we show the result only for p = 0 . Apply the R - step greedy heuristic of the previous section to problem ( 1 . 6 ) with N replaced by S * , the elements of the R - interchange solution . We obtain a partition { Ii } ~ = 1 of S * where [ I ' [ = e , ~ , ~ - - z P - z I i , bgo ~ - . . > / ~ q _ l , and Z I ~ R ) - z ( O ) + ~ q - I ~ - - i = 0 ~ i . Let I * II q - 1 i i S * = " ~ i = ~ , so that = I * t . J I q . Let T = U ~ = ~ T k be any partition of an optimal set T of cardinality K into q disjoint sets of size R . By submodularity , as in Proposition 2 . 4 , q Z = z ( T ) " < z ( I * ) + ~ { z ( I * U T k ) - z ( I * ) } . k - I However S * = I * U I q is an R - interchange solution . Therefore ( q l = z ( l * U14 ) - z ( l * ) ~ z ( l * kI T k ) - z ( I * ) , k = l . . . . . q , and hence Z < - z ( I * ) + q ~ q l = Z 1 ~ n ) + ( q - 1 ) ~ ' q - 1 . As ~ ' i ~ ' i + 1 , ( q - 1 ) ~ ' q - 1 ( ( q - 1 ) [ q ) ( Z I ~ n ) - z ( fJ ) ) . So finally we obtain Z < - Z ~ e ) + ( ( q - 1 ) / q ) ( Z l ~ m - z ( fJ ) ) , which , after rewriting as ( 2q - 1 ) ( Z - Z I ~ m ) < - ( q - 1 ) ( Z - z ( 0 ) ) , gives the required result . s For uncapacitated location problems and R = 1 this result appears in [ 2 ] . 286 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions When p > 0 the proof is almost identical to the proof given above , except that in applying the R - step greedy heuristic to S e a set of size ( R - p ) is chosen first , followed by ( q - 1 ) sets of size R . ( b ) The R - interchange algorithm applied to the following class of un - capacitated location problems in the form of problem ( 1 . 6 ) shows that the bound is tight for p = 0 . The matrix C = ( cij ) has K 2 rows and 2K columns . The first K columns consist of K ( K x K ) identity matrices , and column ( K + s ) , s = 1 . . . . . K has K successive entries equal to ( 2K - R ) / K in rows K ( s - 1 ) + t , t = 1 . . . . . K , and zeroes elsewhere . ( An example with K = 4 and R = 2 is shown below . ) We claim that the first K columns form an R - interchange solution . Suppose without loss of generality that columns K - R + 1 . . . . . K are removed , and columns K + 1 . . . . . K + R are added . The decrease in value from dropping the columns is KR . The increase when adding the new columns is R ( K - R ) ( ~ R 1t + ~ ( ~ - ~ ) _ - KR . On the other hand , if fewer than R columns are interchanged , the objective value decreases . Therefore the first K columns form an R - interchange solution and Z I ( R ~ = K 2 . The last K columns clearly form the optimal solution with Z = K2 ( ( 2K - R ) / K ) = K ( 2K - R ) . Hence Z - Z 1 ~ m K - R Z - z ( 0 ) 2K - R " Example . K = 4 , R = 2 , 1 1 C = 1 1 1 1 1 1 1 1 1 1 1 1 1 1 . 3 2 _ 3 2 3 2 3 2 _ 3 2 3 2 2 _ 3 2 _ 3 2 3 2 3 2 3 2 3 3 2 3 2 3 2 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 287 When K is not a multiple of R the bound of Theorem 5 . 1 is weaker than the corresponding tight bound for K = qR . It is possible that for nondecreasing submodular functions the bound ( Z - zI ~ R ) ) / ( Z - - z ( 0 ) ) - - < ( K - R ) / ( 2K - R ) holds for all R - - K . We have established this result for nondecreasing functions that arise from uncapacitated location problems . When 0 > 0 an optimal solution to problem ( 1 . 6 ) may contain fewer than K elements . Therefore , the R - interchange heuristic given above must be modified to allow sets of differing cardinality . In particular , at iteration t , given the set S t - I we attempt to find a set P C _ N with IP [ - < K , and IP - S ' - 1I - - R and IS t - ~ - P [ < - R such that z ( P ) > z ( St - 1 ) . With this generalized version of the R - interchange heuristic we have for R = I Theorem 5 . 2 . Suppose z E C ( 0 ) , 0 - > 0 , and the generalized 1 - interchange heuris - tic is applied to problem ( 1 . 6 ) . Then Z - Z I ( 1 ) K - 1 Z - z ( 0 ) + KO - 2K - 1 " Proof . Let S be the interchange solution . If IS [ = K , the proof parallels the proof of ( a ) in Theorem 5 . 1 . If ISI - < K - 1 , then by Proposition 2 . 3 and 0 - > 0 z ( T ) < - - z ( S ) + ~ pi ( S ) + ( K - 1 ) O . j ~ T - S As S is an interchange solution pj ( S ) < - 0 for j E N - S and p ~ ( S - { j } ) - 0 for j ~ S . This last inequality implies z ( S ) > - z ( O ) . Hence z ( T ) < - - z ( S ) + ( K - 1 ) 0 + - ~ ( z ( S ) - z ( 0 ) ) . Substituting z ( T ) = Z and z ( S ) = Z m ) into this last inequality yields the result . One might hope that the greedy heuristic followed by the R - interchange heuristic would yield a significant improvement on both . Unfortunately , in terms of worst case behavior this improvement is not achieved . We have constructed a family of uncapacitated location problems for which the R - interchange heuristic cannot improve on the greedy heuristic , For these problems the error approaches a ~ c as K ~ oo . Examples of this behavior are given in [ 2 ] for R = 1 . In the worst case the interchange heuristic does not perform as well as the greedy heuristic . Also the number of iterations required by the interchange heuristic depends on the method used to find improving solutions . A poor method can take an exponential number of iterations as shown by Theorem 5 . 3 . There is a family of uncapacitated location problems with IN [ = 288 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 2K , K = 2 , 3 , . . . , for which the 1 - interchange heuristic can take 2 K + I - ( K + 2 ) iterations . Proof . The Kth problem , K = 2 , 3 . . . . . is defined by the K × 2K matrix C K with elements c ~ where for i = I . . . . . K t 2 i - 1 , j = 2i - 1 , c ~ f = 2 ( U - l ) , j = 2i , L 0 , otherwise . Starting from S O = { 1 , 3 . . . . . 2K - 3 , 2K - 1 } with z ( S ° ) = 2 ~ : + ~ - ( K + 2 ) there is easily seen to be a sequence of 2K + ~ - ( K + 2 ) iterations where z ( St ) = 2 ~ : ÷j - ( K + 2 ) + t for t = 0 , 1 . . . . . 2 K + I - ( K + 2 ) . The example below gives C 3 and the sequence of interchanges for this problem . Example C 3 = 0 0 3 6 0 c0 0 0 0 7 14 The sequence of S t , t = 0 . . . . . 11 - - 2 K÷l - ( K + 2 ) is ( 1 , 3 , 5 ) ( 2 , 3 , 5 ) ( 3 , 4 , 5 ) ( 1 , 4 , 5 ) ( 2 , 4 , 5 ) ( 2 , 5 , 6 ) ( 3 , 5 , 6 ) ( 1 , 3 , 6 ) ( 2 , 3 , 6 ) ( 3 , 4 , 6 ) ( 1 , 4 , 6 ) ( 2 , 4 , 6 ) . Note that the first five and last five sets are identical except that the 6th element has replaced the 5th . Also these five sets without the last element are precisely the sets generated in the problem defined by K = 2 . 6 . A linear programming approximation Here we study problem ( 1 . 6 ) in the case where the submodular function is generated from a matroid as in Proposition 3 . 2 ; i . e . , z ( S ) = maX { ~ ecFce : FE ~ ( UicsQi ) } , and the { Qi } , j @ N are a partition of E and satisfy an independence condition to be given below . Under these conditions problem ( 1 . 6 ) can be formulated as an integer program and the linear program - ming relaxation of this integer program provides an upper bound on Z . The result we obtain is a bound on the " duality gap " between the optimal values of the integer and real solutions to this linear program . More generally , it is a strengthening of Theorem 4 . 2 in the case where z ( S ) is generated from a matroid . Let ~ = ( E , if ) be a matroid , C e the weight of e ~ E , ~ ( E ' ) = { F : F ~ ~ , F C E ' } for E ' C E and v ( E ' ) = maXFE ~ S ( E , ) Ee ~ FCe . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 289 Proposition 6 . 1 ( Edmonds [ 5 ] ) . v ( E ' ) = max ~ qXe , eEE ~ 2 Xe < _ r ( A ) , ACE , eEA ( 6 . 1 ) Xe - - > 0 , e ~ E ' , xe = 0 otherwise , where r ( A ) is the cardinality of a largest independent set in A and Xe = 1 if element e is chosen . Thus if z ( S ) = max { ~ eeFCe : F ~ of ( Urns Q ~ ) } , where { Qj } , j E N is a partition of E , problem ( 1 . 6 ) can be written as the integer program Z = max ~ CeXe , eEE E Xe ~ r ( A ) , A C _ E , ( 6 . 2 ) eEA Xe < - - yi , eEQi , jEN , ( 6 . 3 ) ~ Yi < - K , ( 6 . 4 ) j = l Xe > - - O , e E E , ( 6 . 5 ) yj ~ { 0 , 1 } , jEN . Define the linear programming relaxation of this integer program by Z LP = max ~ CeX e e ~ E subject to ( 6 . 2 ) - ( 6 . 5 ) and O ~ yi < - - l , j E N . ( 6 . 6 ) We have zLe - - > Z and , by Theorem 4 . 1 , ( Z - ZG ) / Z < - a K , where Z ~ is the value of the greedy solution to ( 1 . 6 ) . Theorem 6 . 1 . Let J / / = ( E , ~ - ) be a matroid and { Qj } , j E N , be a partition of E that satisfies the independence condition : " if e , f @ Qj , there is no circuit in containing both e and f . " Then Z LP _ Z G zLp ~ o / K . The " independence condition " holds for the uncapacitated location problem , for which Theorem 6 . 1 is given in [ 2 ] . More generally when the matroid ( E , ~ ) is obtained by combining r distinct matroids ( Ei , ~ i ) so that E = U Ei , with Ej n E ~ = 0 , j¢ k , and F E ~ only if F n E ~ E ~ for all i , 6 the independence property will hold if the { Qj } are chosen to satisfy IE ~ N Qi ] - < 1 , i = 1 . . . . . r , j ~ N . 6 R . Giles has pointed out to us that these conditions are also necessary for a matroid ( E , ~ ) to be partitionahle into sets { Q / } that satisfy the independence condition . 290 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher ~ Maximizing submodular set functions The proof of Theorem 6 . 1 is a simple consequence of the proof of Theorem 4 . 2 ( with 0 = 0 ) and Lemma 6 . 1 . ff the conditions of Theorem 6 . 1 hold , then Z LP < - z ( S ) + ~ pi ( S ) , SCN iES ( K ) where S ( K ) C _ N - S is an index set of K largest or ( S ) . The proof of Lemma 6 . 1 requires some properties of optimal dual variables to the linear program ( 6 . 1 ) . The dual of ( 6 . 1 ) is min ~ r ( A ) UA , ACE Z UA ~ Ce , e E E ' , ( 6 . 7 ) A ~ e UA ~ O , ACE . Let F = { e ~ . . . . . es } C E ' be the elements corresponding to an optimal solution of problem ( 6 . 1 ) with % > - . . . > - Ces , and let sp ( T ) , T C _ E , denote the set { eEE : r ( TU { e } ) = r ( T ) } . The following proposition is known and easily verified . Proposition 6 . 2 . Let A t = sp ( el . . . . . el ) , j = 1 . . . . . s , and define ces + ~ = O . An optimal solution of ( 6 . 7 ) is u * i = Cej - - C ~ + ~ , ] = 1 , . . . , S , and u * = 0 otherwise . We use Proposition 6 . 2 to establish other properties of the optimal dual variables . Proposition 6 . 3 . Suppose e ~ E - E ' . ( i ) If F U { e } E ~ , then ~ ' A ~ e U ~ = O . ( ii ) If F U { e } ~ o ~ , then ~ ' A ~ e U ~ = mini { Cei : ei E C - { e } } where C is the unique circuit in F U { e } . Proof . ( i ) If F U { e } E o ~ , eft Aj for any ] = 1 . . . . . s , and hence u ~ = 0 , VA ~ e . ( ii ) Suppose { el . . . . . e i , e } E o ~ , but { eb . . . , ej , ei + l , e } ff ~ . Then eft Ak for k < - ] , and e E Ak for k > ] . Therefore UA * = ~ ( c ~ - ce ~ + , ) = % , . ADe k > j Now ej + l ~ C C _ { el . . . . . ei , ej + l , e } , and therefore ~ ] u * = Cej + 1 = min { % : ei E C - { e } } . A3e G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 291 We now consider the change in v in problem ( 6 . 1 ) when the constraints x e = 0 and x i = 0 are suppressed , for e , f E E - E ' . Proposition 6 . 4 . ( i ) v ( E ' U { e } ) - v ( E ' ) = ( ce - EASe u ~ ) + , where x ÷ = max { 0 , x } . ( ii ) If there is no circuit containing e and f , + + v ( E ' U { e , f } ) - v ( E ' ) = ( Ce - - A ~ eU * A ) + ( Cf - - E U ~ ) . A3f Proof . ( i ) It follows from the greedy algorithm that if e enters the new solution , either F U { e } is independent or it replaces the cheapest element in the unique circuit C containing it . Therefore the result follows from ( i ) and ( ii ) of the previous proposition . ( ii ) Let G be the elements corresponding to an optimal solution of ( 6 . 1 ) over E ' U { e } given by the greedy algorithm . We now consider the forms of the optimal solutions over E ' U { e } and E ' U { e , f } given in Lemma 3 . 1 . However , note that when e and f are in no common circuit cases ( 3 ) and ( 4 ) of Lemma 3 . 1 cannot occur . This is obvious for case ( 3 ) . In case ( 4 ) G = F U { e } - { er } , er ~ e and er is in the circuit of F U { f } , which implies that F U { e , f } - { er } contains a circuit . Since F U { e } - { er } and F U { f } - { er } are independent , e and f are contained in a common circuit of F U { e , f } - - { e ~ } . Thus we are left withcases ( 1 ) and ( 2 ) , which imply that either F U { f } and G U { f } are both independent or both contain the same unique circuit . Therefore v ( E ' U { e , f } ) - v ( E ' U { e } ) = ~ ( E ' U { f } ) - v ( E ' ) , and the result follows . Proof of Lemma 6 . 1 . Let u s be the optimal variables as given in Proposition 6 . 2 for problem ( 6 . 7 ) with E ' = UiEsQj . From Propositions 6 . 1 and 6 . 2 , z ( S ) = v ( U j ~ s Qi ) = ~ A uSAr ( A ) , the value of the objective function Of ( 6 . 7 ) . By definition Z LP = max ~ CeXe , subject to ( 6 . 2 ) - ( 6 . 6 ) x , y e ~ E - - < max { e ~ z CeX , + ~ USa ( r ( A ) - e ~ aXe ) } , x , y AC _ E \ subject to ( 6 . 2 ) - ( 6 . 6 ) , ( since u s - > 0 and ( 6 . 2 ) holds ) < - - z ( S ) + max X ( ce - - E U ~ ) Xe ' subject to ( 6 . 3 ) - ( 6 . 6 ) x , y eEE \ A3e : z ( S ) + max ~ ' ~ X ( Ce - - A ~ ge USA ) Xe ' subject to ( 6 . 3 ) - ( 6 . 6 ) , x , y j ~ S eEQ i \ ( as U Qj = E , Q ~ NQk = O , j ~ kandc , - ~ uAS - - Ofor eE U Qj ) jEN A3e j ~ S , " 292 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions + } = z ( S ) + maxl ~ ( ~ ( Ce - EUA " ~ ) 2 - / : 2 ~ g , 0 ~ : yj < 1 _ _ _ Y ( jES \ eEOj A ~ e / / jff . 5 v U v U yj - - < K , 0 - < Yi - < 1 } ( by Proposition 6 . 4 ) j ~ S : z ( S ) + maxty . o , ( S ) , , : 2 i } kjffs j ~ S ( since p , ( S ) : z ( SU { ] , ) - z ( S ) : v ( ( i ? s Q ; ) U Q , ) - v ( , ? s Q ~ ) ) = z ( S ) + ~ p ~ ( s ) . ieS ( K ) Proof of Theorem 6 . 1 . Using Lemma 6 . 1 and S = S t , t = 0 . . . . . K - 1 as the sets chosen by the greedy heuristic we have that Z Le < - z ( S ' ) + ~ pi ( St ) , t = O . . . . . K - 1 jESt ( K ) and t - 1 Z Le < - ~ pi + Kp . t = O . . . . . K - 1 . i = 0 Exactly as in Theorem 4 . 1 ( with 0 = 0 ) , we obtain ( Z Le - ZG ) / Z Le < - a K . A surprising consequence of Theorem 6 . 1 is that if a particular problem is a worst case example for the greedy heuristic in the sense of Theorem 4 . 2 , then Z Le = Z , while if the duality gap is maximum i . e . , ( Z LP - Z ) / Z Le = a ~ , then the greedy heuristic gives the optimal solution . Finally , we note that under the hypotheses of Theorem 6 . 1 we can prove an analogous theorem for the interchange heuristic . Here we obtain the bound ( Z LP - ZI ( 1 ) ) / zLP ~ ( K - 1 ) / ( 2K - 1 ) ( see Theorem 5 . 1 ) . This theorem is proved by applying the greedy heuristic to the interchange solution and then using the result of Lemma 6 . 1 for t = K - 1 . 7 . Heuristics and partial enumeration By combining partial enumeration with the heuristics of Sections 4 and 5 we can improve the bounds given previously . Suppose for each subset S of cardinality R we apply some heuristic ( H ) to the problem max { z ( S U r ) : IT I - < K - R } . ( 7 . 1 ) TC _ N - S Call the value of the best of these ( 1 ~ J ) approximations Z * and the method the " R - enumeration plus H " heuristic . G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 293 Theorem 7 . 1 . Suppose that z ( S ) , S C _ N is submodular and nondecreasing and the heuristic ( H ) gives a bound of Z - Z H Z - z ( 0 ) ~ fl ( K ) when applied to problem ( 1 . 6 ) . Then Z - Z * K - R - - < - fl ( K - R ) . z - z ( O ) K Proof . Let T of cardinality K be an optimal solution to problem ( 1 . 6 ) . Apply at most R steps of the greedy heuristic of Section 4 to T to obtain a set S * C T , IS * ] - < R . If the greedy heuristic stops before R steps have been executed , then Proposition 4 . 2 implies that z ( S * ) = z ( T ) = Z . Otherwise submodularity implies that z ( S * ) - z ( O ) > - ( R / K ) ( Z - z ( O ) ) . Now applying heuristic ( H ) to problem ( 7 . 1 ) with S = S * , we obtain a set S * tO T * for which Z - z ( S * tO T * ) < - fl ( K - R ) . Z - z ( S * ) Noting that Z * > - z ( S * kJ T * ) and substituting z ( 0 ) + ( R / K ) ( Z - z ( O ) ) < - z ( S * ) we obtain the required result . Theorem 7 . 1 suggests that the " ( R - 1 ) - enumeration plus 1 - greedy " heuristic may outperform the R - step greedy heuristic , and similarly the " ( R - 1 ) - enumeration plus 1 - interchange heuristic " may be preferable to the R - interchange heuristic . We close this section by noting that all of the bounds on approximations can also be viewed as bounds on the value of an optimal solution . If we have a particular heuristic value and know that the heuristic value is at least a specified fraction of the optimal value , we then have an upper bound on the optimal value . Furthermore , if z is nondecreasing , from any heuristic solution S = { il . . . . . iK } we obtain Z _ < min z ( S t ) + ~ , oj ( S t ) ( 7 . 2 ) t = 0 . . . . . K - 1 j ~ St ( K ) where S t = { il . . . . . it } . For example , from the greedy heuristic and ( 7 . 2 ) we obtain a bound that is at most Z / ( 1 - aK ) . But on specific problems the bound computed from ( 7 . 2 ) frequently will be much tighter . Thus in branch - and - bound algorithms a heuristic solution can serve the dual purpose of providing an upper bound on the optimal value as well as the usual feasible solution and lower bound . In this regard , the bound of Theorem 7 . 1 could be helpful in an implicit enumeration algorithm that used a tree in which the nodes at level k represents subsets of N in which k elements are chosen . Similarly , when viewed in this way , linear programming approximations provide lower bounds as well as the usual upper bounds . 294 G . L . Nemhauser , L . A . Wolsey , M . L . Fisher / Maximizing submodular set functions 8 . Future work Problem ( 1 . 6 ) is a particular case of max { z ( S ) : z ( S ) submodular , SCN S an independent set in a matroid ~ } ( 8 . 1 ) where in ( 1 . 6 ) the maximal independent sets in d , / are all subsets of cardinality K . The approach and many of the results of this paper generalize to problem ( 8 . 1 ) and to the maximization of submodular functions over other independence systems as well . In a sequel to this paper we will analyze approximations for these problems . References [ 1 ] D . A . Babayev , " Comments on the note of Frieze " , Mathematical Programming 7 ( 1974 ) 249 - 252 . [ 2 ] G . Cornuejols , M . L . Fisher and G . L . Nemhauser , " Location of bank accounts to optimize float : An analytic study of exact and approximate algorithms " , Management Science 23 ( 1977 ) 789 - 810 . [ 3 ] J . Edmonds , " Matroid partition " , in : G . B . Dantzig and A . M . Veinott , eds . , Mathematics of the decision sciences , A . M . S . Lectures in Applied Mathematics 11 ( Am . Math . Soc . , Providence , RI , 1968 ) pp . 333 - 345 . [ 4 ] J . Edmonds , " Submodular functions , matroids and certain polyhedra " , in : R . Guy , ed . , Com - binatorial structures and their applications ( Gordon and Breach , New York , 1971 ) pp . 69 - 87 . [ 5 ] J . Edmonds , " Matroids and the greedy algorithm " , Mathematical Programming 1 ( 1971 ) 127 - 136 . [ 6 ] A . M . Frieze , " A cost function property for plant location problems " , Mathematical Program - ming 7 ( 1974 ) 245 - 248 . [ 7 ] L . S . Shapley , " Complements and substitutes in the optimal assignment problem " , Naval Research Logistics Quarterly 9 ( 1962 ) 45 - 48 . [ 8 ] L . S . Shapley , " Cores of convex games " , International Journal of Game Theory 1 ( 1971 ) 11 - 26 . [ 9 ] K . Spielberg , " Plant location with generalized search origin " , Management Science 16 ( 1969 ) 165 - 178 . [ 10 ] D . R . Woodall , " Application of polymatroids and linear programming to transversals and graphs " , presented at the 1973 British Combinatorial Conference ( Aberystwyth ) .
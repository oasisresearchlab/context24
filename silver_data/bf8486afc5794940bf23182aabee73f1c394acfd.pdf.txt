a r X i v : 1 310 . 0060v1 [ c ond - m a t . m e s - h a ll ] 30 S e p 2013 Eﬀective and accurate representation of extended Bloch states on ﬁnite Hilbert spaces Luis A . Agapito , 1 , 2 , ∗ Andrea Ferretti , 3 Arrigo Calzolari , 1 , 3 Stefano Curtarolo , 2 , 4 and Marco Buongiorno Nardelli 1 , 2 , † 1 Department of Physics , University of North Texas , Denton , TX 76203 , USA 2 Center for Materials Genomics , Duke University , Durham , NC 27708 , USA 3 CNR - NANO S3 Center , Istituto Nanoscienze , I - 41125 , Modena , Italy 4 Department of Mechanical Engineering and Materials Science , Duke University , Durham , NC 27708 , USA ( Dated : May 22 , 2014 ) We present a straightforward , noniterative projection scheme that can represent the electronic ground state of a periodic system on a ﬁnite atomic - orbital - like basis , up to a predictable number of electronic states and with controllable accuracy . By co - ﬁltering the projections of plane - wave Bloch states with high - kinetic - energy components , the richness of the ﬁnite space and thus the number of exactly - reproduced bands can be selectively increased at a negligible computational cost , an essential requirement for the design of eﬃcient algorithms for electronic structure simulations of realistic material systems and massive high - throughput investigations . PACS numbers : 71 . 15 . - m , 71 . 15 . Ap , 71 . 23 . An , 73 . 23 . Ad I . INTRODUCTION The electronic structure of solids is commonly de - scribed using plane waves ( PW ) basis functions , which represent naturally the Fourier algebra of periodic sys - tems and whose completeness is easily improvable up to any desirable accuracy . However , their delocalized char - acter is often not appropriate for the description of highly localized electronic systems unless a very large number of basis functions is used . For these reasons , the develop - ment of minimal - space solutions such as atomic - orbital ( AO ) Bloch sums , capable of capturing with satisfactory accuracy the properties of solids and molecules on ﬁnite Hilbert spaces , has been central to methodological devel - opments in quantum chemistry and solid state physics since the 70’s 1 , 2 . AO representations are desirable not only for compu - tational accuracy and ﬁniteness of the basis set , but also to gain a better chemical interpretation of the quantum - mechanical wavefunction . They are essential in a gamut of applications such as : construction of model Hamil - tonians for correlated - electrons and magnetic systems ; dynamical mean - ﬁled theory 3 ; evaluation of quantum transport properties 4 ; design of semiempirical poten - tials for solids 5 and biomolecules 6 ; calculation of exact - exchange integrals ; and applications within linear scal - ing of density - functional theory 7 , coupled cluster 8 , quan - tum Monte Carlo 9 and the gw 10 methods . More gener - ally , localized - space representations are increasingly in demand as novel materials with stronger electron local - ization and correlation are vigorously sought for their rich physical and chemical properties 11 . Moreover , they allow the calculation of the electronic states of materials on ultra dense k - space grids for accurate Brillouin zone ( BZ ) integrations , an essential requirement for the high - throughput computational materials applications central to the mission of the Materials Genome Initiative 11 , 12 . In the last decade , formidable eﬀorts towards this goal have resulted in a variety of methodologies using , for in - stance , Muﬃn - tin orbitals of arbitrary order ( N MTO ) 13 or maximally - localized Wannier functions ( MLWF ) 14 to construct minimal Hilbert spaces . The MLWF method stands as the norm for maximal localization of the real - space basis starting from pseudo - potential plane - wave ( PW ) calculations ; however , it is not straightforward either to decide the appropriate number of target PW bands ( energy range ) to match , and thus the size of the Hilbert space , or to achieve convergence for systems with diﬀused electrons . On the other hand , noniterative methods such as di - rect projection ( Ref . 14 , II . i . 1 ) , quambo 15 , and qo 16 , which do not seek an iterative construction of the ﬁnite Hilbert space but rely on an AO basis provided as in - put , are a good compromise between speed ( noniterative post - processing ) and accurate reproduction of the occu - pied energy bands while keeping AO similarity . While the primary goal of these methods is to con - struct real - space wavefunctions with high localization , reciprocal - space Hamiltonians matrices can be built us - ing these wavefunctions as well . The resulting band structure can exactly reproduce unentangled bands ( bun - dles of bands that do not overlap others in energy across the BZ and are , therefore , isolated by energy gaps ) , e . g . the occupied manifold of an insulator or a semiconduc - tor like silicon [ black curves in Fig . 1 ( a ) ] . In general , however , the bands in metals ( or the unoccupied mani - fold in semiconductors ) are entangled . While the itera - tive MLWF method can further enforce reproduction of those bands inside a frozen energy window via a disen - tanglement procedure 17 , adding an extra layer of compu - tational complexity , the noniterative methods fail to sys - tematically reproduce those bundles , especially the upper unoccupied states [ circles in Fig . 1 ( a ) ] . In this article , we present a fast , noniterative procedure that eﬀectively and accurately reproduces a predictable number of eigenenergies ( bands ) regardless of entangle - ment . The antibonding fraction of the wavefunction , scattered through the quasi - inﬁnite unoccupied subspace of the PW approach , is eﬃciently mapped into the ﬁnite - space Hamiltonian through straightforward matrix oper - 2 - 10 - 5 0 5 10 E - E F ( e V ) a ) b ) - 10 - 5 0 5 10 15 20 E - E F ( e V ) Γ X Γ W L K , UX Γ X W L Γ K , UX c ) d ) FIG . 1 . ( Color online ) Si bandstructures from projected LCAO Hamiltonian matrices H k ( κ , N ) . Eigenenergies are marked by circles , triangles , or solid lines ( ﬂat bands ) . The panels on the top ( bottom ) row show the electronic structure expanded in a sp ( spd ) ﬁnite space . ( a and c ) Direct - projection scheme ( no ﬁltering N = M , no shifting κ = 0 ) . ( b and d ) Fil - tered + shifted projections . The degenerate ﬂat bands ( 3 - and 10 - fold ) are rigidly shifted by κ ( 4 . 1 eV and 9 . 6 eV ) , and plotted as horizontal solid lines . The reference PW bands are shown in black ( P n ≥ 0 . 9 ) or gray ( < 0 . 9 ) . ations of projections on controlled basis and sequential ﬁltering to automatically discard all unphysical solutions . II . METHODOLOGY A . LCAO representation of Bloch states For simplicity , in this work we use the ﬁnite Hilbert spaces deﬁned by the set of pseudo atomic orbitals ( PAOs ) φ ( r ) , employed in the generation of atomic pseu - dopotentials . While the richness of the PAO basis can be systematically increased by including more radial func - tions and angular momentum projectors in the construc - tion of pseudo - wavefunctions , we stress that this is just a choice of convenience . Our procedure is completely general and can be applied to any ﬁnite basis , including polarized and diﬀused Gaussian sets , thus providing a di - rect bridge between the languages of solid - state physics and theoretical quantum chemistry . As a ﬁrst example we choose silicon , ( see Fig . 1 ) , where we have used a sp ( minimal ) basis set to construct the Bloch sums , φ µ k ( r ) = 1 √ N V P R e i k · R φ µ ( r − R ) , that span the ﬁnite Hilbert space Ω 1 18 . These Bloch sums can be seen as the discrete Fourier transform of the corresponding PAO φ µ ( r ) replicated on a periodic box containing N V lattice vectors R and , thus , the same number of k - vectors in the BZ . The starting PW Bloch states | ψ PWn k i are obtained using the quantum espresso packages 19 . For convenience , let us switch to a L¨owdin - orthogonalized basis representa - tion ¯ φ µ k = P ν ( S k − 12 ) µν φ ν k where S k µν = h φ µ k | φ ν k i are the overlap matrices . The PW states are projected onto the ﬁnite Hilbert space of the PAOs via the operator ˆ P k = P µν | ¯ φ µ k ih ¯ φ ν k | . Then , | ψ n k i = P µ a k µn | ¯ φ µ k i with expansion coeﬃcients a k µn = X νp ( S k − 12 ) µν ( S k νp ) − 1 h φ p k | ψ PWn k i . Similar expansions are used in the linear - combination - of - atomic - orbitals ( LCAO ) solution of the Kohn - Sham equation 20 , where the Hamiltonian is H k = A k E k A k † ( 1 ) and the matrices A k of the expansion coeﬃcients are found self consistently under the orthonormality con - straint A k † A k = I . Here A k is built columnwise from the projection coeﬃcients a k µν ; each column represents the LCAO wavefunction | ψ n k i for a given band n . H k , A k are of dimensions M × M , M × N , respectively . M is the size of the Hilbert space and N is the number of PW bands selected for projection . E k is a N × N di - agonal matrix of the N lowest PW eigenvalues , E k = diag ( ǫ PW 1 , ǫ PW 2 , . . . , ǫ PWN ) . B . Band projectability Going back to the example of Si in space Ω 1 ( M = 8 ) of Fig . 1 ( a ) , its corresponding LCAO Hamiltonian H k yields a manifold of 8 bands ( marked with circles ) , some of which , especially in the unoccupied energy region , noticeably deviate from the reference PW bands ( gray lines ) . This stems from the less than perfect projectabil - ity of those unoccupied PW states onto the inherently - incomplete ﬁnite space . In turn , low projectability breaks the unitary constraint of the LCAO method , A k A k † 6 = 1 . To quantify this eﬀect , we deﬁne a projectability number P n = min { P µ a k ∗ µn a k µn , ∀ k ∈ BZ } as an a priori test for the representability of each PW band . The closer P n to 1 , the better the ﬁdelity of the corresponding LCAO band . Numerical values of P n for the systems studied here are summarized in Table I . We set an arbitrary cutoﬀ of 0 . 9 as the condition for exact representability so that with the minimal space Ω 1 we can expect exact representabil - ity only for the lowest N = 4 PW bands ( the complete occupied manifold [ black lines in Fig . 1 ( a ) ] ) with devia - tions less than 57 . 2 meV . A richer space Ω 2 ( M = 18 18 ) , 3 which includes d functions , yields P 7 ≥ 0 . 9 and should therefore support exact representation of the electronic structure up to N = 7 PW bands [ black lines in Fig . 1 ( c ) ] , which includes 3 unoccupied bands . However , the appar - ently bad reproducibility of the electronic structure in the energy window 0 – 10 eV observed in Fig . 1 ( c ) seems to suggest otherwise . The progressive loss of representability of the top un - occupied PW bands mentioned above is a common is - sue even for more sophisticated noniterative and iterative approaches and not at all limited to the LCAO bands obtained as ﬁrst - order solutions via the direct - projection scheme . It is nonetheless observed that : ( i ) The over - all matching to the lower unoccupied bands signiﬁcantly improves with the richer space Ω 2 compared to Ω 1 ( cf . circles on solid lines for the 1st unoccupied band along the Γ - K path and along Γ - X for the 2nd and 3rd ) . ( ii ) Un - occupied states increasingly exhibit high - kinetic - energy plane - wave components , which do not project well on lo - calized basis . The low projectability of the upper PW states yields low values of the a k mn coeﬃcients . Con - sequently , the corresponding LCAO eigenstates consis - tently default to regions of lower energy and yield the apparent overall poor reproducibility seen in Fig . 1 ( c ) . ( iii ) Singular values are introduced in the Hamiltonian in the case of no projectability , thus the observed zero - energy LCAO eigenvalues . C . Band ﬁltering and shifting In order to resolve points ( ii ) and ( iii ) we ﬁlter out PW states with low projectability by choosing all the PW bands that satisfy P n ≥ 0 . 9 . The number of these PW bands , N , determines the number of columns of the matrix A k , which is generally not square and non unitary . In the formulation of the LCAO Hamiltonian we can always deﬁne a square M × M matrix [ A k 0 ] , which ex - tends A k with M − N columns of zeros , and ﬁll E k with the same number of zero eigenvalues . Then , Eq . ( 1 ) , can be more generally written as a product of square matrices H k = [ A k 0 ] diag ( ǫ PW 1 , . . . , ǫ PWN , 0 , . . . , 0 ) [ A k 0 ] † . ( 2 ) Since the product [ A k 0 ] [ A k 0 ] † is not unitary , the spec - trum of its eigenvalues will contain the ﬁrst N eigenvalues of A k A k † , of the form λ n = 1 − δ n , with 0 ≤ δ n ≤ 0 . 1 guaranteed by the projectability criterion adopted . The remaining M − N eigenvalues will all be zero . Using the canonical representation , [ A k 0 ] [ A k 0 ] † = UDU † we can write [ A k 0 ] = UD 12 , where D = diag ( λ 1 , . . . , λ N , λ N + 1 , . . . , λ M ) , and rewrite Eq . ( 2 ) as : H k = U diag ( ǫ PW 1 ( 1 − δ 1 ) , . . . , ǫ PW N ( 1 − δ N ) , 0 , . . . , 0 ) U † . This expression explicitly shows that having a non uni - tary space A k applies a multiplicative factor to each PW eigenvalue . Filtering the low - projectability bands is a necessary step to guarantee that these corrections are minimal . The M − N null eigenvalues appear as degener - ate “ﬂat” bands at zero energy and need to be selectively moved out of the energy window of interest . To do so we introduce the “shifting” operator : I k = I − A k A k † = U diag ( δ 1 , . . . , δ N , 1 , . . . , 1 ) U † and rewrite the Hamiltonian as : H k ( κ , N ) = H k + κ I k = U diag ( ¯ ǫ 1 , . . . , ¯ ǫ N , κ , . . . , κ ) U † . ( 3 ) Eq . ( 3 ) is the central result of our work . The I k op - erator allows a selective shifting , by κ , of the M − N ﬂat bands with negligible eﬀect on the other N high - projectability bands , with eigenenergy deviations ∆ ǫ n ≤ ( 1 − P n ) ( κ − ǫ PWn ) . The last factor is interpreted as the energy window between the highest band under consid - eration ( N th ) of energy ∼ κ and a given PW eigenvalue , and is maximal for the lowest band n = 1 . In practice , since the upper limit of the energy window is usually only ∼ 2 - 5 eV above E F , the correction can be made arbitrar - ily small by an appropriate choice of the projectability number P n . The LCAO bandstructures ( circles and triangles ) in Fig . 1 ( b ) and ( d ) showcase the dramatic improvement , with respect to ( a ) and ( c ) , that is achieved by ﬁltering and shifting the low - projectability bands . It conﬁrms the exact reproductibility of 4 and 7 bands ( circles ) expected for the two diﬀerent spaces , respectively . For further il - lustration , we included the projections of an additional PW band ( with P n < 0 . 9 ) in building the Hamiltonians . As expected , this LCAO band [ 5th in ( b ) and 8th in ( d ) , marked with triangles ] does not exactly reproduce the PW reference . Nonetheless , the band closely follow the reference across the BZ , except at X and U - X in ( b ) and L in ( d ) , which are the BZ regions where the projectabil - ity is the lowest . The 8th band shows an overall good ﬁdelity , consistent with the relatively high projectability P 8 = 0 . 8335 . To demonstrate the performance of our procedure in the case of entangled bands , we computed the band struc - ture of an intrinsically delocalized metallic systems , such TABLE I . Projectability ( P n ) and BZ rms average of ∆ ǫ n ( in eV ) per band n of H k ( κ , N ) . κ = 0 , 9 . 6 , 10 eV ; N = 5 , 8 , 13 for Si - Ω 1 , Si - Ω 2 , and Mo - Ω 3 , respectively Si - Ω 1 Si - Ω 2 Mo - Ω 3a n P n rms P n rms n P n rms 1 0 . 9927 0 . 0478 0 . 9953 0 . 0792 5 0 . 9979 0 . 0140 2 0 . 9622 0 . 0572 0 . 9933 0 . 0555 6 0 . 9937 0 . 0183 3 0 . 9622 0 . 0252 0 . 9952 0 . 0382 7 0 . 9873 0 . 0386 4 0 . 9622 0 . 0203 0 . 9967 0 . 0266 8 0 . 9924 0 . 0275 5 0 . 4755 1 . 9200 0 . 9934 0 . 0267 9 0 . 9905 0 . 0302 6 0 . 0660 0 . 9771 0 . 0316 10 0 . 9286 0 . 0602 7 0 . 0941 0 . 9728 0 . 0380 11 0 . 0000 3 . 5975 8 0 . 0652 0 . 8464 0 . 1382 12 0 . 0000 3 . 3524 a The 4 semicore bands have exact projectability . 4 - 5 0 5 10 15 20 E - E F ( e V ) - 5 0 5 10 15 20 E - E F ( e V ) - 5 0 5 10 15 20 E - E F ( e V ) a ) b ) c ) Γ H Γ N P N FIG . 2 . ( Color online ) Bandstructure of Mo bcc under space Ω 3 . ( a ) Direct - projection scheme ( N = 13 , κ = 0 eV ) . ( b ) Filtered + shifted projection ( N = 7 , κ = 10 eV ) ( c ) Un - ﬁltered + shifted projection ( N = M = 13 , κ = 12 . 5 eV ) . The eigenenergies of the LCAO Hamiltonian H k ( κ , N ) are shown with blue circles . The PW bands of high P n ≥ 0 . 9 ( low P n < 0 . 9 ) projectability are shown with solid black ( gray ) lines . The 4 low - lying semicore bands ( 4 s 4 p ) are not shown . Inset shows the Fermi surface in its Wigner - Seitz cell . as molybdenum bcc ( Fig . 2 , Ω 3 M = 13 18 ) and of a gold nanowire ( Fig . 4 , Ω 4 M = 90 18 ) . As observed in the sili - con case , in both metallic systems the low - projectability states can default to the bottom of the unoccupied en - ergy region , as in the direct - projection bandstructure in Fig . 2 ( a ) for Mo . The eﬀect of the low - projectability states is more detrimental in the nanowire case where they hybridize with states of otherwise high ﬁdelity and any resemblance to the PW reference is lost [ Fig . 4 ( a ) ] . For Mo , the space Ω 3 supports exact representation of up to 6 PW bands ( beyond the 4 semicore bands , not shown ) , as found in Table I for P n ≥ 0 . 9 . The bandstruc - ture from the ﬁltered + shifted scheme [ Fig . 2 ( b ) ] conﬁrms reproducibility of all these PW bands with root - mean - square ( rms ) deviations less than 60 . 2 meV even for the large value of κ ( 10 eV ) used here . In particular cases it may be advantageous to keep the low - projectability PW states as in the direct - projection scheme ; for instance , the low - projectability PW bands n = 11 and 12 of Mo bcc exhibit local high projectabil - ity around H and P . Applying a κ shift to the direct - projection Hamiltonian , i . e . H k ( 12 . 5 , M ) , yields an ex - panded range of bandstructure reproducibility of up to 12 . 5 eV [ Fig . 2 ( c ) ] , which is directly due to the inclusion of bands 11 and 12 . III . APPLICATIONS OF LCAO HAMILTONIANS A . Band interpolation Once the LCAO matrices H k ( κ , N ) are known , one can directly construct the real - space localized Hamiltonian as H 0R = 1 √ N V X k e − i k · R H k ( κ , N ) . ( 4 ) Conversely , these local matrices allow us to obtain the in - terpolated bandstructure at any arbitrary k - vector 21 , 22 , with the same accuracy deﬁned by the projectability number , by diagonalizing the interpolated reciprocal - space Hamiltonian H k , interpolated = X R e i k · R H 0R . B . Band decomposition and Fermi surface analysis A valuable application of this procedure is in the evalu - ation of fundamental physical properties of materials that require an accurate representation of the electronic states across the whole BZ . A typical example is the calcula - tion of the Fermi surface of any metal , which typically requires extraordinary computational eﬀorts . Within our approach the Fermi surface is straightforwardly obtained by the direct evaluation of the interpolated bandstruc - ture of the system via the real - space Hamiltonians . The Fermi energy of Mo bcc is crossed at various k - points in the 3 - dimensional BZ . The collection of all such points deﬁne its Fermi surface , which is shown in Fig . 3 ( e ) . Fur - thermore , it is determined that the crossing states can have three distinct atomic characters . Bands of diﬀerent character are marked with circles of diﬀerent colors at the crossing of the Fermi level ( horizontal dashed line ) in Fig . 3 ( a ) . The decomposition of the Fermi surface based on the atomic character of the crossing states is shown in Fig . 3 ( b ) - ( d ) . C . Electrical conductance Another straightforward application of LCAO Hamil - tonians is the calculation of the electrical conductance through a nanowire . Our procedure reduces the prob - lem of calculating electron transport 4 , 21 to the computa - tionally inexpensive post - process of evaluating Eq . ( A . 6 ) . We choose a gold nanowire 23 as a prototypical exam - ple . Bands obtained from the direct - projection scheme 5 FIG . 3 . ( Color online ) Fermi surface of Mo bcc bulk . ( a ) Colored circles identify the same band crossing the Fermi en - ergy ( dashed horizontal line ) . Orange = band 1 , green = band 2 , red = band 3 . ( b - d ) Individual - band contributions to the Fermi surface . ( e ) Total Fermi surface . are shown in Fig . 4 ( a ) . Unphysical zero - energy eigen - states , discussed in Section II C , cover the entirety of the BZ . They are removed by applying a shifting of κ = 3 eV to the ﬁltered bands ( lowest N = 62 bands ) and the re - sulting LCAO eigenstates are reported in Fig . 4 ( b ) with blue circles . The LCAO real - space Hamiltonians H 00 and H 01 are obtained according to Eq . ( 4 ) and the elec - trical transmittance T ( E ) , in Fig . 4 ( c ) , is computed from these matrices as described in the Appendix . Furthermore , formulating the LCAO Hamiltonian H k directly in reciprocal space allows the discrimination of the two most common sources of error in electronic trans - port simulations : ( i ) the incompleteness of the ﬁnite space , which is reﬂected in the mismatch between the PW and LCAO bandstructures [ cf . Fig . 5 ( b ) ] and can be made arbitrarily small by our procedure ; and ( ii ) the real - space interaction truncation in the choice of the prin - cipal layer . The latter is outside of the scope of any reciprocal - space mapping procedure ψ PWn k → ψ LCAOn k . Nonetheless , such error is introduced when formulating real - space local Hamiltonians H 0R [ via Eq . ( 4 ) ] . This real - space truncation error is reﬂected in the mismatch between the interpolated bandstructure ( solid lines ) and the LCAO eigenvalues ( blue circles ) seen in Fig . 5 ( a ) and can be systematically reduced by increasing the size of the principal layer . For instance , the mismatch is elim - inated when doubling the size of the nanowire principal layer ( to a lattice constant of 2 × 4 . 71 ˚A ) , as shown in Fig . 5 ( b ) . The three applications shown here are implemented in the GPL open - software packages WanT and quantum espresso of Refs . 4 and 19 , respectively . IV . CONCLUSIONS These results have far reaching implications , well be - yond the practical applications shown here . In fact , our method allows control of the size ( richness ) of the ﬁ - nite Hilbert space of the basis functions , an archetypal feature in quantum chemistry , which in turns provides ﬂexibility to converge to the true inﬁnite - space solution in the limit of inﬁnite plane waves 24 . Expanding the space increases the number of unoccupied bands with the concomitant bad reproducibility problem that challenges current methodologies and has biased solutions toward minimal basis , which only bypasses the problem by re - ducing the number of unoccupied bands . Contrarily to the spirit of the N MTO and MLWF methods , our technique does not seek construction of ( heavily customized , localized ) basis functions . Its im - portance resides on allowing noniterative reproduction a large number of energy bands using standard quantum - chemistry basis sets or equivalent . In that regards , the present methodology completely supersedes the need for engineered basis functions such as MLWFs or N MTOs . The central result of this article , Eq . ( 3 ) , allows us to obtain an exact representation of all the PW bands that complies with our high projectability criterion in a procedure of negligible computational cost , opening the way to the design of eﬃcient algorithms for electronic structure simulations of realistic material systems , within the high - throughput materials framework 25 . ACKNOWLEDGMENTS This work was supported , in part , by SRC through Task ID P14924 in the Center for Electronic Materials Processing and Integration at the University of North Texas , and by the Duke University , Center for Materials Genomics . Appendix : Electrical conductance in periodic nanowires The set of real - space Hamiltonian H 0R and overlap matrices S 0R , in the general case of nonorthogonal ba - sis , contain the necessary information to compute the electronic properties along the nanowire . In the site representation , the spatial coordinate r of the wavefunction is discretized to lattice vector R , thus , 6 - 2 - 1 0 1 2 E - E F ( e V ) 0 2 4 T ( 2e 2 / h ) Γ Γ A A a ) b ) c ) - - - - - - - - - - - - - - - - - - - - - - - - - 11111111111111111111111111111111111111111111111111111111111111111111 FIG . 4 . ( Color online ) Bandstructure and quantum transmit - tance spectrum of a gold nanowire . ( a ) The direct - projection and ( b ) ﬁltered + shifted ( N = 62 , κ = 3 eV ) bandstructures are marked with circles . Solid lines are PW bands . ( c ) Quantized transmittance of the nanowire . 0 k [ p / a ] - 2 - 1 . 5 - 1 - 0 . 5 0 0 . 5 1 1 . 5 2 E - E F ( e V ) 2 . 5 5 T ( 2e 2 / h ) 0 k [ p / 2a ] 2 . 5 5 T ( 2e 2 / h ) 10 10 ( a ) ( b ) FIG . 5 . ( Color online ) Eﬀect of the nearest principal - layer approximation on the interpolated bandstructure ( left ) and quantized conductance ( right ) . The principal layer is approx - imated with one and two unit cells ( a = 4 . 71 ˚A ) in panels ( a ) and ( b ) , respectively . The blue circles are the eigenvalues of H k and the underlying solid lines are the corresponding interpolated bands . each periodic cell is considered an abstract single site R . Following the translational Bloch theorem , a wavefunc - tion ψ k ≡ ψ k0 evaluated at a generic site r = 0 relates to the next site r = − 1 or 1 by a phase factor , that is ψ k − 1 = e − iθ ψ k0 and ψ k1 = e iθ ψ k0 , where θ = k · 1 . In a nonorthogonal LCAO space , the wavefunction sat - isﬁes the Roothaan equation H k ψ k = E ± S k ψ k ( A . 1 ) Both Hamiltonian and overlap matrices are obtained from the Fourier transform or the corresponding real - spaces quantities . H k = X R = − 1 , 0 , 1 e i k · R H 0R S k = X R = − 1 , 0 , 1 e i k · R S 0R The truncation in the Fourier transform corresponds to the principal - layer ( PL ) approximation . A PL is com - posed of one or more primitive cells , such that interac - tions beyond nearest PLs are made negligible . Then , Eq . ( A . 1 ) becomes (cid:2) Mλ − h − h t λ 2 (cid:3) ψ k1 = 0 ( A . 2 ) or equivalently , (cid:2) Mλ − 1 − h t − hλ − 2 (cid:3) ψ k − 1 = 0 ( A . 3 ) with λ = e − iθ ; M ± = E ± S 00 − H 00 ; h ± = H 01 − E ± S 01 , and the deﬁnition h t ( E ) ≡ h † ( E ∗ ) . It assumes hermitian matrices , i . e . H 0 , − 1 = ( H 01 ) † . Eqs . ( A . 2 ) and ( A . 3 ) are standard quadratic eigenvalue problems of the form a 2 λ 2 + a 1 λ + a 0 = 0 . The solutions λ n represent all the propagating modes of the nanowire . Solutions with | λ n | > 1 are evanescent modes decaying ( traveling ) to the right while | λ n | < 1 are evanescent modes traveling to the left . Modes with | λ n | = 1 are standing waves , i . e . Bloch states . An inﬁnitesimal imagi - nary quantity η is added to the energy , thus the deﬁnition E ± = E ± iη . In this way the phase factors are moved slightly away from the unitary circle and an unambiguous traveling direction can be assigned . As a result , half of the 2 M solutions of the quadratic equation , are discerned as left traveling and the other as right traveling , denoted by subscripts < and > , respec - tively . Compounding all the “left traveling” eigenvalues λ n < and eigenvectors ψ k1 n < into the M × M matrices Λ < and U 1 , < , respectively , the matrix α < is deﬁned as α < = U 1 , < Λ < ( U 1 , < ) − 1 , ( A . 4 ) which satisﬁes Eq . ( A . 2 ) , i . e . Mα − h − h t α 2 = 0 . - 3 - 2 - 1 0 1 2 3 h h h h t h t h t h t h β > α < M FIG . 6 . ( Color online ) Schematic representation of the quadratic eigenvalue equations ( A . 2 ) and ( A . 3 ) as a 1 - dimensional tight - binding model . Physically , it represents the propagating modes of a semi - inﬁnite right wire ( starting at site 1 ) leaking into 7 site 0 , as schematically shown in Fig . 6 . Analogously , the eﬀect of all right - moving modes of a semi - inﬁnite left wire ( which starts at site − 1 ) on site 0 is given by the solutions of Eq . A . 3 . The matrix β > that satisﬁes that equation is β > = U − 1 , > ( Λ > ) − 1 ( U − 1 , > ) − 1 ( A . 5 ) The use of h and h t is inverted in Eq . ( A . 3 ) with respect to Eq . ( A . 2 ) . This eﬀectively ﬂips the wavevector of the modes , i . e . λ ← λ − 1 = λ ∗ , and is accounted by taking the inverse of Λ in Eq . ( A . 5 ) . Finally , in the case of an inﬁnite nanowire , all relevant electronic properties such as the Green’s function G , and the electrical conductance T is directly obtained from α < and β > using the following Σ ± L = ( h ∓ ) † α ± < ; Σ ± R = ( h ± ) β ± > Γ L / R = i (cid:16) Σ + L / R − Σ − L / R (cid:17) G ± = (cid:16) h ± h(cid:0) α ± < (cid:1) − 1 − β ± > i(cid:17) − 1 T ( E ) = trace (cid:2) Γ L G + Γ R G − (cid:3) ( A . 6 ) ∗ luis . agapito @ gmail . com † mbn @ unt . edu 1 D . J . Chadi , Phys . Rev . B 16 , 3572 ( 1977 ) . 2 D . S´anchez - Portal , E . Artacho , and J . M . Soler , Solid State Communications 95 , 685 ( 1995 ) . 3 F . Lechermann , A . Georges , A . Poteryaev , S . Biermann , M . Posternak , A . Yamasaki , and O . K . Andersen , Phys . Rev . B 74 , 125120 ( 2006 ) . 4 WanT code by A . Ferretti , L . Agapito , A . Calzolari , and M . Buongiorno Nardelli , http : / / www . wannier - transport . org ; A . Calzolari , N . Marzari , I . Souza , and M . Buongiorno Nardelli , Phys . Rev . B 69 , 035108 ( 2004 ) . 5 A . Aguado , L . Bernasconi , and P . A . Madden , The Journal of Chemical Physics 118 , 5704 ( 2003 ) . 6 C . Sagui , P . Pomorski , T . A . Darden , and C . Roland , The Journal of Chemical Physics 120 , 4530 ( 2004 ) . 7 P . Ordej´on , E . Artacho , and J . M . Soler , Phys . Rev . B 53 , R10441 ( 1996 ) . 8 M . Schutz and H . - J . Werner , The Journal of Chemical Physics 114 , 661 ( 2001 ) . 9 A . J . Williamson , R . Q . Hood , and J . C . Grossman , Phys . Rev . Lett . 87 , 246406 ( 2001 ) . 10 P . Umari , G . Stenuit , and S . Baroni , Phys . Rev . B 79 , 201104 ( 2009 ) . 11 S . Curtarolo , G . L . W . Hart , M . Buongiorno Nardelli , N . Mingo , S . Sanvito , and O . Levy , Nature Mater . 12 , 191 ( 2013 ) . 12 Editorial , Nature Mater . 12 , 173 ( 2013 ) . 13 O . K . Andersen and T . Saha - Dasgupta , Phys . Rev . B 62 , R16219 ( 2000 ) . 14 N . Marzari , A . A . Mostoﬁ , J . R . Yates , I . Souza , and D . Vanderbilt , Rev . Mod . Phys . 84 , 1419 ( 2012 ) . 15 W . C . Lu , C . Z . Wang , T . L . Chan , K . Ruedenberg , and K . M . Ho , Phys . Rev . B 70 , 041101 ( 2004 ) . 16 X . Qian , J . Li , L . Qi , C . - Z . Wang , T . - L . Chan , Y . - X . Yao , K . - M . Ho , and S . Yip , Phys . Rev . B 78 , 245112 ( 2008 ) . 17 I . Souza , N . Marzari , and D . Vanderbilt , Phys . Rev . B 65 , 035109 ( 2001 ) . 18 The PAOs are from publicly available ﬁles . Ω 1 : [ Ne ] 3 s 2 3 p 2 , Si . pbe - n - rrkjus psl . 0 . 1 . UPF ; Ω 2 : [ Ne ] 3 s 2 3 p 2 3 d 0 , Si . pbe - n - rrkjus psl . 0 . 1 . UPF ; Ω 3 : [ core ] 4 s 2 4 p 6 5 s 1 4 d 5 5 p 0 , Mo . pbe - spn - rrkjus psl . 0 . 2 ; Ω 4 : [ core ] 5 d 9 . 5 6 s 1 6 p 0 . 5 , Au . pbe - van ak . UPF ; at http : / / www . quantum - espresso . org / ? page id = 190 . 19 P . Giannozzi , S . Baroni , N . Bonini , M . Calandra , R . Car , C . Cavazzoni , D . Ceresoli , G . L . Chiarotti , M . Cococcioni , I . Dabo , A . Dal Corso , S . de Giron - coli , S . Fabris , G . Fratesi , R . Gebauer , U . Ger - stmann , C . Gougoussis , A . Kokalj , M . Lazzeri , L . Martin - Samos , N . Marzari , F . Mauri , R . Maz - zarello , S . Paolini , A . Pasquarello , L . Paulatto , C . Sbraccia , S . Scandolo , G . Sclauzero , A . P . Seitso - nen , A . Smogunov , P . Umari , and R . M . Wentzcovitch , Journal of Physics : Condensed Matter 21 , 395502 ( 19pp ) ( 2009 ) . 20 R . Dovesi , B . Civalleri , C . Roetti , V . R . Saunders , and R . Orlando , Reviews in Computational Chemistry ( John Wiley & Sons , Inc . , 2005 ) pp . 1 – 125 . 21 L . A . Agapito and H . - P . Cheng , The Journal of Physical Chemistry C 111 , 14266 ( 2007 ) . 22 Y . - S . Lee , M . Buongiorno Nardelli , and N . Marzari , Phys . Rev . Lett . 95 , 076804 ( 2005 ) . 23 P . S . Krsti´c , X . - G . Zhang , and W . H . Butler , Phys . Rev . B 66 , 205319 ( 2002 ) . 24 L . Agapito and M . Buongiorno Nardelli , in preparation . 25 S . Curtarolo , W . Setyawan , S . Wang , J . Xue , K . Yang , R . H . Taylor , L . J . Nelson , G . L . W . Hart , S . San - vito , M . Buongiorno Nardelli , N . Mingo , and O . Levy , Comp . Mat . Sci . 58 , 227 ( 2012 ) .
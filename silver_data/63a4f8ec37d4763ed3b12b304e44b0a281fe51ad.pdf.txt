In Biometrics , 2002 , 58 , 21 – 29 . Principal Stratiﬁcation in Causal Inference Constantine E . Frangakis Department of Biostatistics , Johns Hopkins University 615 N . Wolfe St . , Baltimore , MD 21205 , U . S . A . cfrangak @ jhsph . edu Donald B . Rubin Department of Statistics , Harvard University 1 Oxford St . , Cambridge , MA 02138 , U . S . A . rubin @ stat . harvard . edu S UMMARY . Many scientiﬁc problems require that treatment comparisons be adjusted for post - treatment variables , but the estimands underlying standard methods are not causal effects . To address this defﬁciency , we propose a general framework for comparing treatments adjusting for post - treatment variables that yields “principal effects” based on “principal stratiﬁcation” . Principal stratiﬁcation with respect to a post - treatment variable is a cross - classiﬁcation of sub - jects deﬁned by the joint potential values of that post - treatment variable under each of the treatments being compared . Principal effects are causal effects within a principal stratum . The key property of principal strata is that they are not affected by treatment assignment , and there - fore , can be used just as any pre - treatment covariate , such as age category . As a result , the central property of our principal effects is that they are always causal effects , and do not suf - fer from the complications of standard post - treatment - adjusted estimands . We discuss brieﬂy that such principal causal effects are the link between three recent applications with adjustment for post - treatment variables : ( i ) treatment noncompliance ; ( ii ) missing outcomes ( dropout ) fol - lowing treatment noncompliance ; and ( iii ) “censoring by death” . We then attack the problem of surrogate or biomarker endpoints , where we show , using principal causal effects , that all current deﬁnitions of surrogacy , even when perfectly true , do not generally have the desired in - terpretation as causal effects of treatment on outcome . We go on to formulate estimands based on principal stratiﬁcation and principal causal effects , and show their superiority . K EY W ORDS : Biomarker ; Causal inference ; Censoring by death ; Missing data ; Noncompli - ance ; Post - treatment variablee ; Principal stratiﬁcation ; Quality of life ; Rubin causal model ; Surrogate . 1 . Background . Decisions in medicine , public health , and social policy depend critically on appropriate evalu - ation of competing treatments and policies . The extraction of information about such compar - isons , which we can broadly view as causal inference , has been a growing area of statistical research in recent years . A statistical framework for causal inference that has received espe - cially increasing attention is the one based on “potential outcomes” , originally introduced by Neyman ( 1923 ) for randomized experiments and randomization - based inference , and gener - alized and extended by Rubin ( 1974 , 1977 , 1978 ) for nonrandomized studies and alternative forms of inference . Fundamentally , in this framework , often termed Rubin’s causal model ( Holland , 1986 ) , a unit ( e . g . , a patient ) is considered at a particular place and time ; treatments are interventions each of which can be potentially applied to each unit ; and potential outcomes are all the outcomes that would be observed when each of the treatments would be applied to each of the units . Then , a causal comparison between , say , two treatments is a comparison of the potential outcomes of the same group of units under the two treatment conditions . A major difference between the potential outcomes and other frameworks for causal infer - ence ( e . g . , simultaneous equations , Goldberger , 1972 ; Heckman , 1978 ) is that in the former , the deﬁnition of causal effects is separated from any probability models about the way in which units are assigned to treatments , namely the assignment mechanism ( Rubin , 1978 ) , and this separation is regarded broadly ( though not uniformly ; see , e . g . , Dawid , 2000 ) as useful . This clarifying role of potential outcomes has been important in research , including , for example , the earlier works on the concept of ignorable assignment ( def . Rubin , 1974 , 1977 , 1978 ) ; propensity scores ( def . Rosenbaum and Rubin , 1983a ) ; the concept of sequential ignorability and associated methods ( Rubin , 1978 ; Robins , 1986 ) , and others . More recently , methods are also becoming available to address treatment noncompliance using potential outcomes , start - ing mainly with work by Baker and Lindeman ( 1994 ) , Imbens and Rubin ( 1994 ) , Robins and 2 Greenland ( 1994 ) , Angrist , Imbens , and Rubin ( 1996 ) , and currently receiving even more atten - tion ( e . g . , Frangakis and Rubin , 1999 ; Hirano et al . , 2000 ) , although an earlier related approach was discussed by Sommer and Zeger ( 1991 ) . In Sec . 2 we discuss the more general problem of how to formulate comparisons of treat - ments adjusting for a post - treatment outcome variable that is not the primary endpoint . We document that the current estimands called “net - treatment comparisons” are not causal effects , as noted by Rosenbaum ( 1984 ) . We also discuss that other current estimands in this problem ( e . g . , Robins and Greenland , 1992 ) assume the post - treatment variable is controllable and thus are difﬁcult to interpret when the post - treatment variable is not directly controlled . In Sec . 3 we present a general framework for comparing treatments where the estimands are adjusted for post - treatment variables and yet are always causal effects : “principal effects” using “principal stratiﬁcation” . A principal stratiﬁcation with respect to a post - treatment vari - able is a cross - classiﬁcation of the units based on their joint potential values of that variable under each of the treatments being compared . Principal effects are comparisons of treatments within principal strata . The key property of a principal stratiﬁcation is that it is not affected by treatment and , therefore , can be used as a pre - treatment covariate . Thus , the central property of our principal effects is that they are always causal effects . In Sec . 4 , we discuss brieﬂy that principal causal effects link three recent applications . In Sec . 5 we discuss the problem of surrogate endpoints , and show , using principal effects , that all current deﬁnitions of surrogacy , even when true , do not generally deﬁne causal effects of treatment on outcome . We go on to formulate estimands based on principal stratiﬁcation and principal effects , and show their superiority . Sec . 6 provides remarks and directions for further research ; throughout , we focus on the fundamental issue of deﬁnition of estimands rather than methods of estimation . 3 2 . Adjusting causal effects for post - treatment variables : goal and standard approaches . Consider a group of units (cid:0)(cid:2)(cid:1)(cid:4)(cid:3)(cid:6)(cid:5)(cid:8)(cid:7)(cid:9)(cid:7)(cid:9)(cid:7)(cid:10)(cid:5)(cid:12)(cid:11) where each can be potentially assigned either a standard treatment (cid:13)(cid:15)(cid:14) (cid:1)(cid:16)(cid:3)(cid:18)(cid:17) or a new treatment (cid:13)(cid:19)(cid:14) (cid:1)(cid:21)(cid:20)(cid:6)(cid:17) . ( For more treatments , see Sec . 6 ) . The objective is to measure an outcome (cid:22) ( e . g . survival status ) at a speciﬁc time after assignment of each unit . Let (cid:22)(cid:24)(cid:23)(cid:25)(cid:13)(cid:15)(cid:14) (cid:17) be the value of (cid:22) if unit (cid:0) is assigned treatment (cid:14) , for (cid:14) (cid:1)(cid:26)(cid:3)(cid:6)(cid:5)(cid:27)(cid:20) . Then , a causal effect of assignment on the outcome (cid:22) is deﬁned to be a comparison between the ordered sets of potential outcomes on a common set of units , e . g . , a comparison between (cid:28) (cid:22)(cid:24)(cid:23)(cid:29)(cid:13) (cid:3)(cid:18)(cid:17)(cid:31)(cid:30) (cid:0) " ! set # (cid:27) $ and (cid:28) (cid:22)(cid:24)(cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) & (cid:30) (cid:0)’ ! set ( ) $ (cid:5) ( 2 (cid:7) 1 ) given the groups of units , set # and set ( , being compared are identical ( Neyman , 1923 , Rubin , 1974 , 1978 ) . Examples include a comparison of the means of (cid:22) * (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) and (cid:22)(cid:24)(cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) , or the median of (cid:22)(cid:24)(cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)(cid:2) + (cid:22)(cid:24)(cid:23)(cid:29)(cid:13) (cid:3) , (cid:17) for (cid:0) - (cid:1) . (cid:3) / (cid:5)(cid:8)(cid:7)(cid:10)(cid:7)(cid:9)(cid:7)(cid:9)(cid:5)(cid:12)(cid:11) . The potential outcomes and the causal effects are generally not all observable , even with random assignment , although such assignment simpliﬁes estimation . When additional covariates are measured prior to the assignment , then comparisons in the sub - group of units with a given covariate value describe subgroup causal effects of the assignment . With no loss of generality and to avoid extra notation , we will subsequently assume we are al - ready within cells deﬁned by observed pre - treatment variables and ignore the issue of sampling of units from a population . In many types of studies , after each unit (cid:0) gets assigned treatment 01(cid:23) , a post - treatment variable 2(cid:2)3(cid:29)465(cid:23) is measured in addition to measuring the main outcome (cid:22) . For simplicity of notation , we assume the variable 2 3(cid:29)465(cid:23) is binary ( e . g . , 1 for low , 2 for high ) , although our approach can be immediately extended to any format ( e . g , see Sec . 6 ) . Important types of studies where such post - treatment variables arise , include : 7 clinical trials , where a post - treatment variable 2 38465 is a measure of subjects’ compliance to the originally assigned treatment ; 4 7 studies with long follow - up , where whether or not the subject drops out is a post - treatment variable ( missingness of outcome ) ; 7 studies where the outcome intended to be recorded can be “censored by death” ; 7 studies comparing drugs for AIDS patients , where “surrogate” markers of progression , such as CD4 count and measures of viral load ( Prentice , 1989 ; Lin , Fleming , and De Gruttola , 1997 ; Buyse et al . , 2000 ) , are post - treatment variables . The ﬁrst three are discussed brieﬂy in Sec . 4 , and the fourth is discussed at length in Sec . 5 . The variable 2 " 3(cid:29)465 generally encodes characteristics of the unit as well as of the treatment . For instance , in the example of clinical trials above , post - treatment noncompliance encodes information about efﬁcacy – the effect of taking the treatment , as well as characteristics of compliance behavior of individual subjects . In such cases , an important study goal , and our objective , is to compare the effects of treatments on (cid:22) “after adjusting” for the post - treatment characteristics , in a way that the adjusted estimands are causal effects . A standard method adjusts for the post - treatment variable using a comparison ( e . g . , differ - ence in means ) between the distributions pr (cid:28) (cid:22) 3(cid:29)465 (cid:23) 9 2 3(cid:29)465 (cid:23) (cid:1) ; : (cid:6)(cid:5) 0(cid:2)(cid:23) (cid:1) < (cid:3) $ and pr (cid:28) (cid:22) 38465 (cid:23) 9 2 38465 (cid:23) (cid:1) ; : (cid:6)(cid:5) 0(cid:2)(cid:23) (cid:1)(cid:21)(cid:20) $ (cid:5) ( 2 (cid:7) 2 ) where (cid:22) 38465 (cid:23) (cid:1) (cid:22) = (cid:23)(cid:25)(cid:13)(cid:19)0 " (cid:23) (cid:17) , the observed outcome . Comparison ( 2 (cid:7) 2 ) is called the “net treatment” effect of assignment 0 adjusting for the post - treatment variable 213(cid:29)465 ( Cochran , 1957 ; Rosen - baum , 1984 ) , and compares outcomes under standard versus new treatment for subjects who got a common value : ( e . g . , : = “high” ) of 2 - 38465 . For example , the current deﬁnitions for a sur - rogate endpoint by Prentice ( 1989 ) , Freedman et al . ( 1992 ) , Lin et al . ( 1997 , eq . 2 ) , Buyse and Molenbergh ( 1998 ) , and Buyse et al . ( 2000 ) are all based on regressions in the sense of 5 ( 2 (cid:7) 2 ) . The key to understanding such adjustments is to recognize that 2 3(cid:29)465(cid:23) is 2 > (cid:23)(cid:25)(cid:13)(cid:19)0 " (cid:23) (cid:17) , that is , the observed value of one of two potential values 2 ? (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) , depending on treatment assignment . Assume for simplicity the condition that the treatment assignment 01(cid:23) is completely ran - domized , that is , pr (cid:13)(cid:19)0’(cid:23) (cid:1) @ (cid:3) 9 2 > (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) 2 > (cid:23)(cid:29)(cid:13) (cid:20)(cid:6)(cid:17)(cid:27)(cid:5) (cid:22)(cid:24)(cid:23)(cid:29)(cid:13) (cid:3) , (cid:17)A(cid:5) (cid:22) = (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)B(cid:17) is a common constant across subjects . Then the net treatment comparison ( 2 (cid:7) 2 ) is equivalent to the comparison between pr (cid:28) (cid:22)(cid:24)(cid:23)(cid:29)(cid:13) (cid:3)(cid:18)(cid:17) 9 2 > (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17) " (cid:1)(cid:21) : $ and pr (cid:28) (cid:22) = (cid:23)(cid:25)(cid:13) (cid:20) / (cid:17) 9 2 > (cid:23)(cid:29)(cid:13) (cid:20) / (cid:17) - (cid:1)C : $ (cid:7) ( 2 (cid:7) 3 ) Comparison ( 2 (cid:7) 3 ) is problematic if the treatment has any effect on the post - treatment variable ( Rosenbaum , 1984 ) , because the groups (cid:28) (cid:0)D(cid:30) 2 ? (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)D(cid:1)E : $ ( i . e . , who get post - treatment value : under standard treatment ) and (cid:28) (cid:0)D(cid:30) 2F(cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)G(cid:1)H : $ ( i . e . , who get post - treatment value : under new treatment ) are not the same groups of subjects . Then , according to deﬁnition ( 2 (cid:7) 1 ) , the comparison ( 2 (cid:7) 3 ) is not a causal effect . This concern is known to epidemiologists as post - treatment selection bias in estimating causal effects ( e . g . , see Rosenbaum , 1984 ; Robins and Greenland , 1992 ) . Potential values 2 * (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) and 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) were also used by Robins and Greenland ( 1992 ) ( RG ) but , like Rosenbaum ( 1984 ) , RG did not use those values to deﬁne causal effects adjusted for the post - treatment variable . Instead , RG used a framework where both the treatment and the post - treatment variable are controllable , and deﬁned a priori counterfactual values of outcomes (cid:22) that would have been observed under assignment to treatment (cid:14) and if the post - treatment variable somehow were simultaneously forced to attain a value : . This framework with its a priori counterfactual estimands is not compatible with the studies we consider , which do not directly control the post - treatment variable . Speciﬁcally , most of the values of outcomes in this framework are not just unobserved - existent potential outcomes , but are nonexistent ( a priori counterfactual ) in the studies we consider . For example , consider a subject who , when assigned the standard treatment , yields a low value of the post - treatment CD4 : for that subject , 6 the value of the outcome (cid:22) if assignment to standard treatment were to yield a high value of the post - treatment CD4 is nonexistent ( i . e . , a priori counterfactual ) in the study ( see also Sec . 5 . 2 ) . Evidently , no existing approach has suitably addressed these limitations . 3 . Principal Stratiﬁcation and Principal Causal Effects . Our proposal for adjustment for the post - treatment variable always generates causal effects because it always compares potential outcomes for a common set of people . Consider all the potential values of the post - treatment variable jointly , and construct the following partitions . D EFINITION ( a ) The basic principal stratiﬁcation I(cid:2)J with respect to post - treatment variable 2 is the partition of units (cid:0)K(cid:1)H(cid:3) / (cid:5)(cid:8)(cid:7)(cid:10)(cid:7)(cid:9)(cid:7)(cid:9)(cid:5)(cid:12)(cid:11) such that within any set of I(cid:2)J , all units have the same vector (cid:13)(cid:19)2 * (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) 2 > (cid:23)(cid:29)(cid:13) (cid:20)(cid:6)(cid:17)L(cid:17) . ( b ) A principal stratiﬁcation I with respect to post - treatment variable 2 is a partition of the units whose sets are unions of sets in the basic principal stratiﬁcation I - J . An example of a principal stratiﬁcation I is the partition of subjects into the set whose post - treatment variable is unaffected by treatment in this study ( i . e . , with 2 ? (cid:23)(cid:25)(cid:13) (cid:20) / (cid:17)K(cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) ) and into the remaining subjects ( i . e . , with 2F(cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17)NM(cid:1) 2 > (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17) ) . It is important to note that , generally , we cannot directly observe the principal stratum to which a subject belongs because we cannot directly observe both 2 * (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) and 2 > (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) for any (cid:0) . For example , a subject with 2F(cid:23)O(cid:13) (cid:3)(cid:18)(cid:17)P(cid:1)Q(cid:20) may belong to either stratum (cid:28) (cid:0)R(cid:30) 2F(cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)R(cid:1)S(cid:20)T(cid:5) 2 > (cid:23)(cid:29)(cid:13) (cid:20)(cid:6)(cid:17)U(cid:1)V(cid:3) $ or stratum (cid:28) (cid:0)W(cid:30) 2 * (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)R(cid:1)(cid:26)(cid:20)T(cid:5) 2 > (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)R(cid:1)(cid:26)(cid:20) $ . It is , nevertheless , also important at this stage to act as if we knew both 2X(cid:13) (cid:3)(cid:18)(cid:17) and 2X(cid:13) (cid:20)(cid:6)(cid:17) in order to determine which quantities are causal . Generally , a principal stratiﬁcation generates the following estimands . D EFINITION Let I be a principal stratiﬁcation with respect to the post - treatment variable 2 , and let 2(cid:2)Y(cid:23) indicate the stratum of I to which unit (cid:0) belongs . Then , a principal effect with respect to that principal stratiﬁcation is deﬁned as a comparison of potential outcomes under 7 standard versus new treatment within a principal stratum Z in I , that is , a comparison between the ordered sets (cid:28) (cid:22) = (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)(cid:31)(cid:30) 2 Y(cid:23) (cid:1) Z [ $ and (cid:28) (cid:22) = (cid:23)(cid:25)(cid:13) (cid:20) / (cid:17) & (cid:30) 2 Y(cid:23) (cid:1) Z [ $ (cid:7) ( 3 (cid:7) 1 ) The importance of principal effects draws from their conditioning on principal strata . Al - though the potential variable 2 * (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) generally differs from 2 * (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) , the value of the ordered pair (cid:13)82 > (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17)B(cid:17) is , by deﬁnition , not affected by treatment , just like the pair ( birthdate , gender ) . Therefore , we have P ROPERTY 1 The stratum 2 " Y(cid:23) , to which unit (cid:0) belongs , is unaffected by treatment for any prin - cipal stratiﬁcation I . And , by deﬁnition ( 2 (cid:7) 1 ) , we have : P ROPERTY 2 Any principal effect , as deﬁned in ( 3 (cid:7) 1 ) , is a causal effect . Expressed in epidemiologists’ terminology , if memberships 21Y(cid:23) were known , stratiﬁcation of the subjects by 2 Y(cid:23) would adjust for the personal characteristics reﬂected in the post - treatment variable without introducing treatment selection bias , for any principal stratiﬁcation I . The standard net - treatment comparisons ( 2 (cid:7) 3 ) are functions of the basic principal causal ef - fects and the corresponding distribution across these strata , pr (cid:13)82 Y , \ (cid:23) (cid:1) Z (cid:17) . Thus , if we have the basic principal causal effects and the counts of units in each of the basic principal stratum , we learn more , not less , about the problem than if we have only net - treatment comparisons . More - over , because principal effects are causal effects , their estimation is critical for understanding the process by which treatments act on subjects , and in some situations also useful for more reliable generalization of results , as we shall see . Setting principal causal effects to be the goal also helps focus the role of inference . Infer - ence about the principal effects , for example , in I(cid:2)J , requires prediction of the subjects’ missing memberships to the principal strata , as determined by 2’ ] (cid:23) 5 (cid:1) (cid:28) 2 > (cid:23) % (cid:13)(cid:19)(cid:14) (cid:17) ^ (cid:30) all (cid:0)‘ _ (cid:14) M(cid:1) 0 " (cid:23)(cid:19) $ , as well 8 as prediction of the subjects’ missing potential outcomes (cid:22)D ] (cid:23) 5 (cid:1) (cid:28) (cid:22)(cid:24)(cid:23) % (cid:13)(cid:19)(cid:14) (cid:17)a(cid:30) all (cid:0)b _ (cid:14) M(cid:1) 0 " (cid:23)(cid:19) $ . Speciﬁcally , the observed data are cN3(cid:29)465 (cid:1) (cid:13)(cid:15)(cid:22)d3(cid:29)465 (cid:5) 2(cid:2)3(cid:29)465 (cid:5) 0 (cid:17) and the likelihood is e (cid:13)(cid:15)c 3(cid:29)465 _ (cid:24)fhg(cid:24)(cid:5)(cid:12)fhib(cid:17) " (cid:1)kjlj pr (cid:28) 0 9 (cid:13)(cid:19)(cid:22)m(cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) (cid:22)n(cid:13) (cid:20)(cid:6)(cid:17)B(cid:17)(cid:27)(cid:5) 2 Y , \ $ o pr (cid:13)82 Y , \ 9 f / gp(cid:17) o pr (cid:28) (cid:13)(cid:19)(cid:22)m(cid:13) (cid:3)(cid:18)(cid:17)(cid:27)(cid:5) (cid:22)q(cid:13) (cid:20)(cid:6)(cid:17)L(cid:17) 9 2 Y , \ _ rf [ i $ Ds(cid:24)(cid:22) ] (cid:23) 5 sp2 ] (cid:23) 5 (cid:5) ( 3 (cid:7) 2 ) where f g and f i denote parameters governing the proportions of basic principal strata , and the distribution of potential outcomes in these strata , respectively . In ( 3 (cid:7) 2 ) , omission of the unit subscript “ (cid:0) ” means collection over all subjects in the data ; integration over (cid:22)D ] (cid:23) 5 operates on the decomposition (cid:22) (cid:1) (cid:13)(cid:19)(cid:22) 3(cid:29)465 (cid:5) (cid:22)P ] (cid:23) 5 (cid:17) ; and integration over 2 " ] (cid:23) 5 operates on (cid:13)(cid:19)2 3(cid:29)465 (cid:5) 2‘ ] (cid:23) 5 (cid:17) that determine membership to the principal strata . ( Note : in problems where a principal stratum im - plies that the outcome (cid:22) 3(cid:29)465 itself is missing , e . g . , as in those discussed in Sec . 4 , the likelihood is a modiﬁcation of ( 3 (cid:7) 2 ) . ) The likelihood function ( 3 (cid:7) 2 ) can be used for estimation of principal causal effects as func - tions of f i and f g , with either likelihood or Bayesian inference . With no additional assump - tions , there is generally no unique maximum likelihood estimate of (cid:13) f i (cid:5)rf g (cid:17) . Nevertheless , we can often build plausible restrictions to capitalize on the scientiﬁc structure of each problem , for example , using covariates to predict principal strata , including information on dose - response curves within principal strata , or information on lag until and length of time for a treatment ac - tion based on pharmacokinetics . The framework can also host a combination of estimation with sensitivity analyses for the causal effects , for example in the sense of exploring ranges of unob - served quantities as done , in different contexts , in Rosenbaum and Rubin ( 1983b ) , Scharfstein , Rotnitzky , and Robins ( 1999 ) , and Goetghebeur et al . ( 2000 ) , and whose extreme application results in the use of bounds ( e . g . , Manski , 1990 ; Balke and Pearl , 1997 ) . 9 4 . Brief Review of Principal Effects in Three Examples . We brieﬂy review three examples of recently worked problems involving post - treatment vari - ables , ( i ) treatment noncompliance ; ( ii ) missing outcomes following treatment noncompliance ; and ( iii ) “censoring by death” . An example of recent methods for addressing treatment noncompliance is Imbens and Ru - bin ( 1994 , 1997 ) who reanalyzed a study on vitamin A by Sommer and Zeger ( 1991 ) . In that study : ( a ) the controlled intervention was randomization of children to receive vitamin A or not and the outcome was mortality ; ( b ) the uncontrolled post - treatment variable was the actual taking of vitamin A ; and interest focused on ( c ) formulating and estimating the effect of taking versus not taking vitamin A ( as opposed to the effect of being assigned or not assigned to take vitamin A ) . To address ( c ) , Imbens and Rubin ( 1997 ) estimated the “complier average causal effect” ( CACE ) , which is a causal effect of assignment on the subjects who would comply with treatment no matter the assignment ( “compliers” ) . Therefore , this approach to adjusting for noncompliance is a special case of the framework of Sec . 3 , where the compliers are a stra - tum in the principal stratiﬁcation with respect to the post - treatment “compliance behavior” . In that and related applications dealing with noncompliance , CACE is a special case of a prin - cipal effect . Thus , the following comparison of CACE to other estimands when faced with noncompliance shows the strengths of our framework . First , CACE is , by Property 2 , always a well deﬁned causal effect . In contrast , a stan - dard estimand to evaluate the actual taking of treatment compares the observed outcomes of subjects taking new treatment ( vitamin A ) to the observed outcomes of subjects taking con - trol , within treatment assignment arm . That is , it compares pr (cid:13)(cid:19)(cid:22)t3(cid:29)465 9 2(cid:2)3(cid:29)465 (cid:1) (cid:20)p(cid:5) 0 (cid:1) (cid:14) (cid:17) to pr (cid:13)(cid:15)(cid:22) 3(cid:29)465 9 2 3(cid:29)465 (cid:1)l(cid:3) / (cid:5) 0 (cid:1) (cid:14) (cid:17) for (cid:14) (cid:1)SuT(cid:5)(cid:8)(cid:3) , which , in analogy to ( 2 (cid:7) 2 ) , is a “net - treatment” effect of the new treatment adjusted for assignment . The comparison of these estimands for (cid:14) (cid:1)Cuv(cid:5)(cid:8)(cid:3) , also known as an “as - treated” estimand , is not a causal effect without the exchangeability of 10 prognosis for subjects who take and those who do not take new treatment within assignment arm . Quite generally , however , practitioners and regulatory agencies ( e . g . , US FDA ) do not trust such exchangeabilty assumptions for uncontrolled compliance ( e . g . , The Coronary Drug Project Research Group , 1980 ; Zelen , 1990 ) . Other estimands to address the actual taking of treatment are deﬁned by comparing subjects’ outcomes that , for a ﬁxed level of the controllable assignment (cid:14) , would have been observed under two scenarios : ﬁrst , if all subjects ( includ - ing noncompliers ) would have somehow been forced to take the new treatment ; second , if the same subjects would have somehow been forced to take the standard treatment . These esti - mands , therefore , involve outcome values that are a priori counterfactual ( see also Frangakis , Rubin , and Zhou , 2001 , rejoinder ) , that is , they do not exist as functions of the controllable factor ( (cid:14) ) alone , and , therefore , their meaning as causal effects is not well deﬁned . Considerable growth of literature has followed or was proposed independently of Imbens and Rubin ( 1994 , 1997 ) on methods to better address noncompliance ( e . g . , Baker and Linde - man , 1994 ; Robins and Greenland , 1994 ; Angrist et al . , 1996 , Goetghebeur and Molenberghs , 1996 ; Robins , 1998 ; Rubin , 1998 ) . On the other hand , we are aware of no previous work that has linked such recent approaches for noncompliance to the more general class of problems with post - treatment variables . An important such problem was recently reported by Barnard , Frangakis , Hill and Rubin ( 2001 ) in a large experiment to evaluate school choice programs , where ( a ) the randomized intervention was the offering of school vouchers to children of low income parents , and ( b ) uncontrolled post - treatment variables were both the actual use of vouchers , and the subsequent taking of tests to measure achievement . For such cases , Frangakis and Rubin ( 1997 , 1999 ) had shown that in order to estimate even the “intention - to - treat” effect of randomized treatment on achievement ability ( i . e , an effect that ignores compliance ) : ( i ) it is not appropriate to use “intention - to - treat” analyses ( i . e . , analyses that ignore compliance data ) ; and ( ii ) the princi - 11 pal strata deﬁned by both compliance and missingness of outcome must be used . Barnard et al . ( 2001 ) took into account these principal strata , and thereby proposed a more appropriate method of estimation of intention - to - treat effects as well as of other effects . Another important such problem is discussed by Rubin ( 1998 , Sec . 6 ; 2000 ) , “censoring by death” : subjects are assigned to treatments , the intended outome is quality of life at one year after assignment , and the post - treatment variable indicates death before the ﬁrst year . Quality of life is “missing” for such cases , not because a non - null value exists and is unobserved , as often treated by standard approaches , but simply because a non - null value does not exist . For - mulating causal effects of treatment on quality of life is subtle , ﬁrst because such comparisons are restricted by the life of subjects , and second because life , as a post - treatment variable , can be affected by treatment . The outline described in Rubin ( 2000 ) to address this problem is another special case of principal stratiﬁcation . Other types of post - treatment censoring can also be addressed using principal stratiﬁcation and effects . For example , Frangakis and Rubin ( 2001 ) use a related formulation to address design and estimation of survival curves using double sampling in the combined presence of administrative censoring and loss to follow - up ( see also , Baker , Wax , and Patterson , 1993 ) . 5 . Deﬁning Surrogate Endpoints Using Principal Causal Effects . 5 (cid:7) 1 The two goals of surrogate endpoints and previous approaches revisited . Often in therapeutic trials , comparison of treatments for the outcome of primary importance , e . g . , survival time , may require a long and practically infeasible follow - up . Nevertheless , if there exist variables measurable early in the follow - up and known to be linked to the effect of the treatments on survival , then such variables can arguably help understand the effect of treat - ment on the outcome . There is currently growing literature on such “surrogate” or “biomarker” endpoint variables ( e . g . , Prentice , 1989 ; Freedman et al . , 1992 ; Lin et al . , 1997 ; Buyse et al . , 12 2000 ) . The most fundamental question is the deﬁnition of a surrogate endpoint so that it has an appropriate interpretation and can be used reliably for prediction . To help ﬁx ideas , consider a study where the treatments are standard (cid:13)(cid:19)(cid:14) (cid:1) (cid:3)(cid:18)(cid:17) and new (cid:13)(cid:19)(cid:14) (cid:1)w(cid:20) / (cid:17) therapy for AIDS patients . If patient (cid:0) is assigned treatment (cid:14) , let (cid:22) > (cid:23)(cid:25)(cid:13)(cid:15)(cid:14) (cid:17) denote the outcome of survival time ( the primary endpoint ) , and let 2 ? (cid:23)(cid:25)(cid:13)(cid:19)(cid:14) (cid:17) denote the measurement of CD4 count ( “H” = high , “L” = low ) at 2 months after treatment assignment . Also , to better present our arguments in a simple setting , we assume that : no patient dies before 2 months so that 2 3(cid:29)465(cid:23) (cid:1) 2 > (cid:23)(cid:25)(cid:13)(cid:19)0 " (cid:23) (cid:17) is measured for all subjects , that treatment assignments (cid:28) 0 - (cid:23)8 $ are completely randomized , and that (cid:22)x3(cid:29)465(cid:23) is measured for all subjects , thereby creating what we call a “vali - dation” study . In order to have an appropriate interpretation as a surrogate , the post - treatment variable 2 should possess two properties : P ROPERTY 3 Causal Necessity : 2 is necessary for the effect of treatment on the outcome (cid:22) in the sense that an effect of treatment on (cid:22) can occur only if an effect of treatment on 2 has occurred . P ROPERTY 4 Statistical Generalizability : 2 3(cid:29)465 should well predict (cid:22) 3(cid:29)465 in an “application” study , where we do not wait for measurements (cid:22) 3(cid:29)465 . The property of causal necessity is important because it tells us if the treatment can act on the outcome without acting on the surrogate . This information is central for improving the focus of therapy or drug - development . The property of generalizability is important when it is not feasible to wait for the primary outcome in the application study . In an early effort to satisfy these properties , Prentice ( 1989 ) deﬁned 2 38465 to be a surro - gate if it satisﬁes certain criteria , mainly that the observed outcome (cid:22) 38465 (cid:23) (cid:13) (cid:1) (cid:22) = (cid:23)(cid:25)(cid:13)(cid:19)0 " (cid:23) (cid:17)B(cid:17) should be conditionally independent of the assigned treatment 01(cid:23) given the observed value 2 38465(cid:23) of the 13 post - treatment variable in the validation study . ( Prentice , 1989 , used a hazard regression pa - rameterization for multiple - time measurements on 2 - 38465 . For clarity , we discuss the single - time measurement case – the generalization is simple but notationally tedious . ) When exact inde - pendence is not expected , related approaches have been proposed that compare results of the regression of the outcome on treatment before and after conditioning on the variable 2 3(cid:29)465 , as with comparison of parameter coefﬁcients ( Freedman , et al . , 1992 , Lin et al . , 1997 ) , and more recently with comparison of coefﬁcients of determination ( e . g . , Buyse and Molenberghs , 1998 ; Buyse et al . , 2000 ; Gail et al . , 2000 ) . More generally , all these approaches are based on “net - treatment” comparisons ( Sec . 2 ) , where 2 3(cid:29)465 is considered a surrogate if 2 3(cid:29)465 is a good predictor ( relative to treatment 0 ) of outcome (cid:22) 3(cid:29)465 when conditioning on both 2 38465 and 0 in the validation study . Thus , with respect to the way of “adjusting” for 2 38465 , we can collectively regard all such current deﬁnitions as variants generated from Prentice’s main criterion for deﬁning a statistical surrogate : D EFINITION ( Statistical Surrogate in a Randomized Experiment ) . 2 is a statistical surrogate for a comparison of the effect of (cid:14) (cid:1) < (cid:3) vs . (cid:14) (cid:1)(cid:21)(cid:20) on (cid:22) if , for all ﬁxed : , that comparison of the distributions in ( 2 (cid:7) 2 ) results in equality . It may appear that this deﬁnition of surrogate based on “net - treatment” comparisons is sufﬁ - cient for both properties , causal necessity and generalizability . In contrast to standard beliefs ( e . g , Prentice , 1989 ; “individual - level surrogacy” of Buyse et al . , 2000 ) , however , none of the approaches based on the deﬁnition of statistical surrogacy satisﬁes Property 3 of causal necessity . As we will show in the next section , in a study where the post - treatment 2 is a statistical surrogate , there will generally exist units with no causal effect of treatment on the statistical surrogate and who , nevertheless , experience causal effects of treatment on outcome . Conversely , in a study where there is no causal effect of treatment on outcome unless it occurs 14 together with a causal effect of treatment on the surrogate , 2 will generally not be a statistical surrogate . We offer a new criterion for surrogacy using principal stratiﬁcation and principal causal effects . We show that the new criterion does satisfy Property 3 of causal necessity . Moreover , in Sec . 5 . 3 , we also discuss the role of principal stratiﬁcation for better satisfying Property 4 , statistical generalizability of the surrogate . 5 (cid:7) 2 Deﬁnition of Principal Surrogate and Property of Causal Necessity . Principal surrogate . Consider the basic principal strata of the simple study example of Sec . 5 . 1 : 7 subjects whose CD4 count would be low and unaffected by treatment , (cid:28) (cid:0)N(cid:30) 2y(cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17)N(cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1) e $ , whom we label for simplicity “sicker” patients ; 7 subjects whose CD4 count would be high and unaffected by the treatment (cid:28) (cid:0)U(cid:30) 2z(cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17)R(cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1) c { $ , and whom we label “healthier” ; 7 subjects whose CD4 count under new treatment would be higher than under standard treatment , (cid:28) (cid:0)’(cid:30) 2 > (cid:23)O(cid:13) (cid:3) , (cid:17) " (cid:1) e and 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1) c { $ , and whom we label “normal” ; 7 subjects whose CD4 count under new treatment would be lower than under standard treatment , (cid:28) (cid:0)’(cid:30) 2 > (cid:23)O(cid:13) (cid:3) , (cid:17) " (cid:1) c and 2 * (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) " (cid:1) e $ , and whom we label “special” ; We propose the following deﬁnition of a surrogate based on principal stratiﬁcation . D EFINITION 2 is a principal surrogate for a comparison of the effect of (cid:14) (cid:1)V(cid:3) vs . (cid:14) (cid:1)(cid:4)(cid:20) on (cid:22) if , for all ﬁxed : , that comparison between the ordered sets (cid:28) (cid:22) = (cid:23)(cid:25)(cid:13) (cid:3) , (cid:17) & (cid:30) 2 > (cid:23)(cid:25)(cid:13) (cid:3) , (cid:17) " (cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1)(cid:21) : $ and (cid:28) (cid:22) = (cid:23)(cid:25)(cid:13) (cid:20) / (cid:17) & (cid:30) 2 > (cid:23)(cid:25)(cid:13) (cid:3) , (cid:17) " (cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1)(cid:21) : $ (cid:5) ( 5 (cid:7) 1 ) results in equality . 15 That is , causal effects of treatment on outcome (cid:22) may only exist when causal effects of treat - ment on the post - treatment variable 2 exist . Thus our criterion based on principal stratiﬁcation immediately satisﬁes Property 3 of causal necessity of the previous section . Although deﬁnition ( 5 (cid:7) 1 ) does not involve an assumption about the assignment model for 0 " (cid:23) , under randomization , criterion ( 5 (cid:7) 1 ) implies that the same comparison applied to pr (cid:28) (cid:22) 3(cid:29)465 (cid:23) 9 2 > (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) " (cid:1) 2 > (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) " (cid:1)(cid:21) : (cid:6)(cid:5) 0(cid:2)(cid:23) (cid:1)(cid:16)(cid:3) $ and pr (cid:28) (cid:22) 3(cid:29)465 (cid:23) 9 2 > (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17) " (cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) " (cid:1)(cid:21) : (cid:6)(cid:5) 0(cid:2)(cid:23) (cid:1) ; (cid:20) $ (cid:7) ( 5 (cid:7) 2 ) also results in equality . The following result then asserts that Property 3 is not shared by a statistical surrogate . R ESULT 1 . In a randomized experiment , and with respect to any comparison , we have that : ( a ) If the post - treatment variable 2 is a principal surrogate , then it is not , generally , a statistical surrogate . ( b ) If the post - treatment variable 2 is a statistical surrogate , then it is not , generally , a principal surrogate . To understand better the implications of Result 1 , we offer a proof by discussing the two examples of Figure 1 for the comparison of averages ( to show the result , in the ﬁgures we need only consider scenarios with no “special” subjects ) . First consider Fig . 1 ( a ) . The subgroups of patients who experience no causal effect of treatment on the CD4 counts ( “sicker” and “healthier” ) experience no causal effect of treatment on survival . Therefore , by criterion ( 5 (cid:7) 2 ) , CD4 count is a principal surrogate in this study . However , when : | (cid:1) e , the subgroup (cid:28) (cid:0)d(cid:30) 2 3(cid:29)465(cid:23) (cid:1) e (cid:5) 0(cid:2)(cid:23) (cid:1)E(cid:3) $ of subjects in the left side conditioning of ( 2 (cid:7) 2 ) is the mixture of “sicker” and “normal” patients under standard treatment , whereas the subgroup (cid:28) (cid:0)x(cid:30) 2 3(cid:29)465(cid:23) (cid:1) e (cid:5) 0(cid:2)(cid:23) (cid:1)w(cid:20) $ is , in fact , a different group of subjects – the “sicker” patients only – under new treatment . Using the numbers of Fig . 1 ( a ) , the left side of ( 2 (cid:7) 2 ) has mean 20 months , whereas the right side of ( 2 (cid:7) 2 ) has mean 10 months . It follows that 16 CD4 is not a statistical surrogate . Therefore , although the standard interpretation would be that the new treatment decreases survival whenever it cannot change a low value of the surrogate , that conclusion is incorrect , as the principal surrogacy of 2 clearly indicates . Consider now Fig . 1 ( b ) . For the “sicker patients” , the new treatment has no causal effect on their CD4 count , but does have a 10 month causal effect on increasing survival ( comparing sicker patients’ survival under new vs . standard treatment ) . Similarly , a 10 - month increase in survival holds for the “healthier” patients in the study . Therefore , CD4 count is not a principal surrogate , that is , there can be an effect of treatment on survival when there is no effect of treat - ment on the surrogate . Using the criterion of statistical surrogacy , however , we obtain that , for : } (cid:1) e , both the left and right sides of ( 2 (cid:7) 2 ) have mean 20 months , and that , for : } (cid:1) c , both the left and right sides of ( 2 (cid:7) 2 ) have mean 50 months , so CD4 is , by deﬁnition , a statistical surro - gate for the average comparison . Therefore , although , here , the standard interpretation would be that treatment does not change survival without changing the surrogate , this conclusion is incorrect . The discrepancy indicated in Result 1 occurs more generally because a statistical surrogate does not generally involve causal effects . Associative and Dissociative effects . We also propose , more generally than assessing principal surrogacy , to evaluate the effects of treatment on outcome that are associative and dissociative with effects on the post - treatment variable in the validation study . An effect on outcome that is dissociative with an effect on surrogate is deﬁned as a comparison between the ordered sets (cid:28) (cid:22) = (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17) & (cid:30) 2 > (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17)’(cid:1) 2 > (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) $ and (cid:28) (cid:22) = (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)(cid:31)(cid:30) 2 > (cid:23)O(cid:13) (cid:3)(cid:18)(cid:17) " (cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) $ (cid:5) ( 5 (cid:7) 3 ) that were equated in ( 5 (cid:7) 1 ) . An effect on outcome that is associative with an effect on surrogate is deﬁned as a comparison between the ordered sets (cid:28) (cid:22) = (cid:23) % (cid:13) (cid:3)(cid:18)(cid:17) & (cid:30) 2 > (cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17)KM(cid:1) 2 > (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17) $ and (cid:28) (cid:22) = (cid:23) % (cid:13) (cid:20)(cid:6)(cid:17)(cid:31)(cid:30) 2 > (cid:23)O(cid:13) (cid:3)(cid:18)(cid:17) } M(cid:1) 2 > (cid:23)(cid:25)(cid:13) (cid:20)(cid:6)(cid:17) $ (cid:7) ( 5 (cid:7) 4 ) 17 Both ( 5 (cid:7) 3 ) and ( 5 (cid:7) 4 ) can , in principle , be further stratiﬁed on basic principal strata . Both the associative effect ( 5 (cid:7) 4 ) and the dissociative effect ( 5 (cid:7) 3 ) are causal effects , by Prop - erty 2 of Sec . 3 . If the dissociative effect is large ( small ) , then we are to conclude that there is large ( small ) causal effect of treatment on outcome for subjects for whom treatment does not affect CD4 . Similarly , if the associative effect is large ( small ) , then we are to conclude that there is large ( small ) causal effect of treatment on outcome for subjects for whom treatment does affect CD4 . A comparison between ( 5 (cid:7) 4 ) and ( 5 (cid:7) 3 ) then measures the degree to which a causal effect of treatment on outcome occurs together with a causal effect of treatment on the surrogate . For example , if this association is high , it can indicate that developing a drug to target biophysiological characteristics of the surrogate may be a good way to target the clinical endpoint (cid:22) . It is important to note that causal interpretation of the latter association is not automatic , in contrast to ( 5 (cid:7) 4 ) and ( 5 (cid:7) 3 ) , and should be examined experimentally in a new ( per - haps laboratory ) study where an intervention manipulating a factor in addition to (cid:14) would be applied , e . g . , to increase CD4 . For that new study , the potential outcomes would be regarded as functions , not of the uncontrolled post - treatment CD4 , but of the new factorial interventions used to change it . Finally , we emphasize that the approach we present is applicable to continuous post - treatment variables as well , where analogous comparisons are formulated as the conditional distributions of the causal effect of treatment on outcome given principal strata of the post - treatment vari - able , which differ from the “individual level” comparisons of Buyse et al . ( 2000 , Sec . 4 . 2 ) ( the latter still being net - treatment comparisons ) . 5 (cid:7) 3 Principal Stratiﬁcation and Property of Statistical Generalizability . We now examine the use of principal stratiﬁcation to predict outcomes in a randomized ap - plication study . Here , distinguish the distributions of principal strata and of outcomes given 18 principal strata between a validation and an application study , respectively : pr V (cid:28) 2X(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2X(cid:13) (cid:20)(cid:6)(cid:17) $ (cid:5) pr V (cid:28) (cid:22) 3(cid:29)465 9 2X(cid:13) (cid:3) , (cid:17)A(cid:5) 2X(cid:13) (cid:20) / (cid:17)A(cid:5) 0P $ (cid:5) ( 5 (cid:7) 5 ) pr A (cid:28) 2X(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2X(cid:13) (cid:20)(cid:6)(cid:17) $ (cid:5) pr A (cid:28) (cid:22) 3(cid:29)465 9 2X(cid:13) (cid:3) , (cid:17)A(cid:5) 2X(cid:13) (cid:20) / (cid:17)A(cid:5) 0P $ (cid:5) ( 5 (cid:7) 6 ) and assume all distributions are available except pr A (cid:28) (cid:22)d3(cid:29)465 9 2X(cid:13) (cid:3) , (cid:17)A(cid:5) 2X(cid:13) (cid:20) / (cid:17)A(cid:5) 0P $ . Before the outcomes (cid:22) 3(cid:29)465 (cid:23) in the application study are known , they could be predicted by their predictive distribution , denoted by pr A (cid:13)(cid:19)(cid:22)G38465 9 2(cid:2)3(cid:29)465 (cid:5) 0 (cid:17) . Because the distributions ( 5 (cid:7) 6 ) determine the distributions of all observable data in that study , we have ( under randomization ) : pr A (cid:13)(cid:19)(cid:22) 3(cid:29)465 9 2 3(cid:29)465 (cid:5) 0 (cid:17) " (cid:1)(cid:127) ~ pr A (cid:28) (cid:22)d38465 9 2R(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2R(cid:13) (cid:20)(cid:6)(cid:17)A(cid:5) 0P $ pr A (cid:28) 2X(cid:13) (cid:3) , (cid:17)A(cid:5) 2X(cid:13) (cid:20) / (cid:17) $ ‘sT2 ] (cid:23) 5 ~ pr A (cid:28) 2R(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2R(cid:13) (cid:20)(cid:6)(cid:17) $ ‘sp2 ] (cid:23) 5 (cid:7) ( 5 (cid:7) 7 ) Without waiting for any outcome (cid:22) 3(cid:29)465 , however , the correct predictive distribution is not avail - able because pr A (cid:28) (cid:22) 38465 9 2R(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2R(cid:13) (cid:20)(cid:6)(cid:17)A(cid:5) 0P $ is not available . To address this , the standard approach predicts the outcomes (cid:22) 3(cid:29)465 in the application study using the predictive distribution from the validation study , pr V (cid:13)(cid:15)(cid:22) 3(cid:29)465 9 2 3(cid:29)465 (cid:5) 0 (cid:17) , effectively replacing in ( 5 (cid:7) 7 ) both distributions of ( 5 (cid:7) 6 ) with those of ( 5 (cid:7) 5 ) . But the application study can differ from the validation study in either the distribution of principal strata or the potential outcomes given principal strata , in which case the validation predictive distribution will be incorrect for the application study . This may help to explain empirical evidence that regressions pr V (cid:13)(cid:19)(cid:22)P3(cid:29)465 9 2(cid:2)3(cid:29)465 (cid:5) 0 (cid:17) in one validation study can be quite different in another study with the same type of treatment , outcome , and surrogate ( e . g . , Fleming and DeMets , 1996 ) . Consider , alternatively , replacing only the outcome component in the right side of ( 5 (cid:7) 7 ) with that of the validation study , to obtain the synthetic predictive distribution deﬁned as , pr SYN (cid:13)(cid:19)(cid:22) 3(cid:29)465 9 2 3(cid:29)465 (cid:5) 0 (cid:17) " (cid:1) ~ pr V (cid:28) (cid:22) 38465 9 2R(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2R(cid:13) (cid:20)(cid:6)(cid:17)A(cid:5) 0P $ pr A (cid:28) 2X(cid:13) (cid:3) , (cid:17)A(cid:5) 2X(cid:13) (cid:20) / (cid:17) $ ‘sT2‘ ] (cid:23) 5 ~ pr A (cid:28) 2R(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) 2R(cid:13) (cid:20)(cid:6)(cid:17) $ ‘sp2 ] (cid:23) 5 (cid:7) ( 5 (cid:7) 8 ) 19 By any measure , it is more likely that “the left side of ( 5 (cid:7) 6 ) equals the left side of ( 5 (cid:7) 5 ) ” than it is that “both the right side and the left side of ( 5 (cid:7) 6 ) equal , respectively , those in ( 5 (cid:7) 5 ) ” . Therefore , using the synthetic predictive distribution ( 5 (cid:7) 8 ) should be a more plausible approximation to the correct predictive distribution in the application study , than the predictive distribution from the validation study . 6 . Remarks and Extensions . For comparing treatment effects on outcomes adjusting for post - treatment variables , we fo - cused on estimands before estimation , by formulating principal causal effects . We compared our estimands with existing estimands , and separated this discussion from issues of their esti - mation , which can only be relevant when the estimands are relevant . We discuss the estimation of principal effects in subsequent papers speciﬁcally for each open application . As discussed in Sec . 3 , membership of subjects to the principal strata is not generally fully observed , and so estimation must involve techniques for incomplete ( missing ) data . Moreover , because with no restrictions there is generally a range of parameter values that maximize the likelihood , it is important to couple our framework with plausible additional assumptions spe - ciﬁc to each context . Such explicit restrictions ( e . g . , “latent ignorability” of outcome missing - ness or the “compound exclusion restriction” , Frangakis and Rubin , 1999 ) , can be scientiﬁcally more plausible than the implicit assumptions of standard approaches and can also lead to in - creased precision of estimated principal causal effects . It is , therefore , a distinct advantage that our framework formalizes why and what types of assumptions are needed , and how to incorporate them to make inference in these problems . Although we concentrated on examples with two treatments and binary post - treatment vari - able , the framework is immediately applicable to post - treatment variables that are multivariate , ( e . g . , as in the experiment on school choice , Sec . 4 ) or time - dependent , or continuous ( end of 20 Sec . 5 . 2 ) , and to multiple treatments , say (cid:14) (cid:1)(cid:128)(cid:3) / (cid:5)(cid:8)(cid:7)(cid:10)(cid:7)(cid:9)(cid:7)(cid:9)(cid:5)(cid:27)(cid:129) . In the latter case , the basic principal strata with respect to 2 are subgroups of subjects with the same vector (cid:13)(cid:19)2y(cid:23)(cid:25)(cid:13) (cid:3)(cid:18)(cid:17)A(cid:5) ) (cid:7)(cid:10)(cid:7)(cid:9)(cid:7)(cid:10)(cid:5) 2 > (cid:23) % (cid:13) (cid:129)(cid:130)(cid:17)B(cid:17) . Then , as in ( 3 (cid:7) 1 ) , principal causal effects are comparisons of the potential outcomes among strata that are unions of the basic principal strata . In summary , continued use of the current frameworks in problems with post - treatment vari - ables ( e . g . , surrogate endpoints ) in principle makes incorrect attributions of effects of treat - ments . As Buyse ( 2000 ) noted recently about the comparison of our framework to the existing ones for surrogate endpoints : “Until now , we had always thought that the roles of biology and statistics did not mix in these complex problems . But principal causal effects set the framework for allowing biological assumptions in statistical methods and vice versa . ” We hope that this paper provokes the development and dissemination of more principled frameworks . A CKNOWLEDGEMENT We thank the Editor , the Associate Editor , two anonymous reviewers , and Stuart Baker , Marc Buyse , Steve Goodman , Jennifer Hill , Sue Marcus , Susan Murphy , Dan Scharfstein and Scott Zeger for constructive comments , and the H . - C . Yang Memorial Fund , the U . S . National In - stitute of Child Health and Human Development ( R01 HD38209 ) , and the National Science foundation for partial support . R EFERENCES Angrist , J . , Imbens , G . W . , and Rubin , D . B . ( 1996 ) . Identiﬁcation of causal effects using instrumental variables ( with discussion ) . Journal of the American Statistical Association , 91 , 444 - 472 . Baker , S . G . and Lindeman , K . S . ( 1994 ) . The paired availability design : a proposal for evaluating epidural analgesia during labor . Statistics in Medicine 13 , 2269 – 2278 . Baker , S . G . , Wax , Y . , and Patterson , B . H . ( 1993 ) . Regression analysis of grouped survival data : infor - mative censoring and double sampling . Biometrics , 49 , 379 – 389 . 21 Balke , A . and Pearl , J . ( 1997 ) . Bounds on treatment effects from studies with imperfect compliance . Journal of the American Statistical Association 92 , 1171 – 1176 . Barnard , J . , Frangakis , C . E . , Hill , J . L . , and Rubin , D . B . ( 2001 ) . School Choice in NY City : A Bayesian Analysis of an Imperfect Randomized Experiment . Forthcoming in Case Studies in Bayesian Statis - tics ( with discussion ) , C . Gatsonis et al . ( eds . ) . New York : Springer - Verlag . Buyse , M . ( 2000 ) . Rejoinder to Discussion by C . E . Frangakis on “Validation of Surrogate Endpoints” by M . Buyse . Presentation at the Biostatistics Grand Rounds Seminar , The Johns Hopkins University . Buyse , M . and Molenberghs , G . ( 1998 ) . The validation of surrogate endpoints in randomized experi - ments . Biometrics 54 , 1014 - 1029 . Buyse , M . , Molenberghs , G . , Burzykowski , T . , Renard , D . , and Geys , H . ( 2000 ) . The validation of surrogate endpoints in meta - analyses of randomized experiments . Biostatistics , 1 , 49 - 68 . Cochran , W . G . ( 1957 ) . Analysis of covariance : its nature and uses . Biometrics 13 , 261 – 281 . Dawid , A . P . ( 2000 ) . Causal inference wihout countefactuals ( with discussion ) . Journal of the American Statistical Association 95 , 407 – 448 . Fleming , T . R . and DeMets D . L . ( 1996 ) . Surrogate end points in clinical trials : are we being misled ? Annals of Internal Medicine . 125 , 605 - 613 . Frangakis , CE , and Rubin , DB ( 1997 ) . A new approach to the idiosyncratic problem of drug - noncompliance with subsequent loss to follow - up . In : American Statistical Association , Proc . Bio - pharm . Sec . , pp . 206 - 211 . Frangakis , C . E . and Rubin , D . B . ( 1999 ) . Addressing complications of intention - to - treat analysis in the combined presence of all - or - none treatment - noncompliance and subsequent missing outcomes . Biometrika 86 , 365 – 379 . Frangakis , C . E . , and Rubin , D . B . ( 2001 ) . Addressing an idiosyncrasy in estimating survival curves using double - sampling in the presence of self - selected right censoring . Biometrics ( with discussion ) , 57 , 333 – 353 . Frangakis , C . E . , Rubin , D . B . , and Zhou , X . H . ( 2001 ) . Clustered encouragement design with individual noncompliance : Bayesian inference and application to Advance Directive Forms . Forthcoming in 22 Biostatistics ( with discussion ) . Freedman , L . S . , Graubard , B . I , and Schatzkin , A . ( 1992 ) Statistical validation of intermediate end - points for chronic diseases . Statistics in Medicine 11 , 167 – 178 . Gail , M . , Pfeiffer , R . , Houwelingen , H . , and Carroll , R . J . ( 2000 ) . On meta - analytic assessment of surrogate outcomes . Biostatistics 1 , 3 , 231 – 246 . Goetghebeur , E . and Molenberghs , G . ( 1996 ) . Causal inference in a placebo - controlled clinical trial with binary outcome and ordered compliance . Journal of the American Statistical Association 91 , 928 – 934 . Goetghebeur , E . Kenward , M . , Molenberghs , G . , and Vansteelandt , S . ( 2000 ) . Inferential tools for sen - sitivity analysis and noncompliance in clinical trials . Paper presented at the Annual Meeting of the American Statistical Association , Indianapolis , IN . Goldberger , A . S . ( 1972 ) . Structural equation methods in the social sciences . Econometrica . 40 , 979 – 1001 . Heckman , J . J . ( 1978 ) . Dummy endogenous variables in a simultaneous equation system . Econometrika 46 , 931 - 959 . Hirano , K . , Imbens , G . , Rubin , D . B . , and Zhou , X . - H . ( 2000 ) . Estimating the effect of an inﬂuenza vaccine in an encouragement design . Biostatistics , 1 , 69 – 88 . Holland , P . ( 1986 ) . Statistics and causal inference . J . Am . Statist . Assoc . 81 , 945 - 70 . Imbens , G . W . and Rubin , D . B . ( 1994 ) . Causal inference with instrumental variables . Discussion paper # 1676 . Cambridge , MA : Harvard Institute of Economic Research . Imbens , G . W . and Rubin , D . B . ( 1997 ) . Bayesian inference for causal effects in randomized experiments with noncompliance . Annals of Statistics 25 , 305 – 327 . Lin , D . Y . , Fleming , T . R . , and De Gruttola , V . ( 1997 ) . Estimating the proportion of treatment effect explained by a surrogate marker . Statistics in Medicine 16 , 1515 – 1527 . Manski , C . F . ( 1990 ) . Non - parametric bounds on treatment effects . American Economic Review , Papers & Proceedings 80 , 319 – 23 . Neyman , J . ( 1923 ) . On the application of probability theory to agricultural experiments : essay on prin - 23 ciples , Section 9 . Translated in Statistical Science , 5 , 465 – 480 , 1990 . Prentice , R . L . ( 1989 ) . Surrogate endpoints in clinical trials : deﬁnition and operational criteria . Statistics in Medicine 8 , 431 – 440 . Robins , J . M . ( 1986 ) . A new approach to causal inference in mortality studies with sustained exposure periods - Application to control of the healthy worker survivor effect . Mathematical Modelling , 7 , 1393 - 1512 . Robins , J . M . ( 1998 ) . Correction for non - compliance in equivalence trials . Statist . Med . 17 , 269 – 302 . Robins , J . M . and Greenland , S . ( 1992 ) . Identiﬁability and exchangeability of direct and indirect effects . Epidemiology 3 , 143 - 155 . Robins , J . M . and Greenland , S . ( 1994 ) . Adjusting for differential rates of prophylaxis therapy for PCP in high - versus low - dose AZT treatment arms in an AIDS randomized trial . Journal of the American Statistical Association 89 , 737 – 479 . Rosenbaum , P . R . ( 1984 ) . The consequences of adjustment for a concomitant variable that has been affected by the treatment . The Journal of the Royal Statistical Society A 147 , 656 – 666 . Rosenbaum , P . , and Rubin , D . B . ( 1983a ) . The Central role of the propensity score in observational studies for causal effects . Biometrika 70 , 41 – 55 . Rosenbaum , P . R . and Rubin , D . B . ( 1983b ) . Assessing sensitivity to an unobserved binary covariate in an observational study with binary outcome . Journal of the Royal Statistical Society B 45 , 212 – 218 . Rubin , D . B . ( 1974 ) . Estimating causal effects of treatments in randomized and nonrandomized studies . Journal of Educational Psychology 66 , 688 – 701 . Rubin , D . B . ( 1977 ) . Assignment to a treatment group on the basis of a covariate . Journal of Educational Statistics 2 , 1 - 26 . Rubin , D . B . ( 1978 ) . Bayesian inference for causal effects . Annals of Statistics 6 , 34 – 58 . Rubin , D . B . ( 1998 ) . More powerful randomization - based p - values in double - blind trials with noncom - pliance ( with discussion ) . Statistics in Medicine 17 , 371 – 389 . Rubin , D . B . ( 2000 ) . Comment on “Causal inference without counterfactuals” , by AP Dawid , Journal of the American Statistical Association 95 , 435 – 437 . 24 Scharfstein , D . O . , Rotnitzky , A . , and Robins , J . M . ( 1999 ) . Adjusting for Nonignorable Drop - out Using Semiparametric Nonresponse Models ( with discussion ) . Journal of the American Statistical Associ - ation , 94 , 1096 – 1146 . Sommer , A . and Zeger , S . ( 1991 ) . On estimating efﬁcacy from clinical trials . Statist . Med . 10 , 45 – 52 . The Coronary Drug Project Research Group . ( 1980 ) . Inﬂuence of adherence to treatment and response of cholesterol on mortality in the coronary drug project . New England Journal of Medicine 303 , 1038 – 1041 . Zelen , M . ( 1990 ) . Discussion of presidential address ‘Biostatistical collaboration in medical research’ by J . H . Ellenberg . Biometrics 46 , 28 – 29 . 25 ( 2 ) ( 1 ) obs ( 3 ) obs S principal stratum of subject i Post−treatment Potential outcome i i survival ( average ) ( a ) Case where post−treatment is a principal surrogate but not a statistical surrogate = 1 i Z i Y variable − CD4 S L L 10 10 i sicker : ( 1 ) ( 2 ) healthier : H H normal : L H 30 50 Full data S ( Y , given assignment randomized study : Z i = 2 Observed data from ( L , 10 ) ( L , 20 ) ( 1 ) ( 2 ) Y i i ) ( average ) S 50 50 ( H , 50 ) ( H , 50 ) ( 4 ) ( 1 / 2 ) 40 + ( 1 / 2 ) 60 . ( 3 ) ( 1 / 2 ) 50 + ( 1 / 2 ) 50 . ( 1 ) We set equal proportions for each principal stratum , for simplicity of demonstration . ( 2 ) ( 1 / 2 ) 10 + ( 1 / 2 ) 30 . ( 2 ) ( 4 ) S L L 10 sicker : healthier : H H normal : L H 30 ( L , 20 ) ( H , 50 ) 20 50 ( L , 20 ) ( H , 50 ) ( b ) Case where post−treatment is a statistical surrogate but not a principal surrogate 40 60 26 Figure 1 . Distinction between statistical and principal surrogates . Dashed boxes represent missing information , solid boxes represent observed information . 27
a r X i v : c ond - m a t / 0204111v2 [ c ond - m a t . s t a t - m ec h ] 29 D ec 2002 Principles of statistical mechanics of random networks S . N . Dorogovtsev a , b , ∗ , J . F . F . Mendes c , † , and A . N . Samukhin a , b , ‡ a Departamento de F´ısica and Centro de F´ısica do Porto , Faculdade Ciˆencias , Universidade do Porto , Rua do Campo Alegre 687 , 4169 - 007 Porto , Portugal b A . F . Ioﬀe Physico - Technical Institute , 194021 St . Petersburg , Russia c Departamento de F´ısica , Universidade de Aveiro , Campus Universit´ario de Santiago , 3810 - 193 Aveiro , Portugal We develop a statistical mechanics approach for random networks with uncorrelated vertices . We construct equilibrium statistical ensembles of such networks and obtain their partition functions and main characteristics . We ﬁnd simple dynamical construction procedures that produce equilibrium uncorrelated random graphs with an arbitrary degree distribution . In particular , we show that in equilibrium uncorrelated networks , fat - tailed degree distributions may exist only starting from some critical average number of connections of a vertex , in a phase with a condensate of edges . PACS : 05 . 10 . - a , 05 . 40 . - a , 05 . 50 . + q , 87 . 18 . Sn Key words : Random graphs , Statistical ensembles , Zero - dimensional ﬁeld theory , Backgammon model I . INTRODUCTION Quite recently , it has been realized that the study of the structure of networks , which was formerly “a private domain” of mathematical graph theory [ 1 , 2 , 3 ] , is actually a ﬁeld of statistical physics [ 4 , 5 , 6 , 7 , 8 , 9 ] . Most achievements of physicists in the ﬁeld of random networks [ 10 ] ( structural and topological aspects ) are empirical ﬁndings and simple ideas , which were demonstrated by using very particular models . One of main questions that arise is : What is the nature of complex , non - Poisson degree distributions , which were observed in many real networks ? ( Degree of a vertex is the total number of its connections . ) However , few eﬀorts were made to develop a general statistical theory of networks ( see Refs . [ 11 , 12 , 13 , 14 ] ) . Without such a theory , the above question cannot be answered . Furthermore , the structure of the statistical theory of random networks can be related to a zero - dimensional ﬁeld theory and to a mean - ﬁeld description of simplicial gravity [ 15 ] . A condensation phase transition , which occurs in equilibrium networks , is close to that which occurs in branched polymers [ 16 , 17 ] . In this paper we focus on equilibrium network ensembles , which are less studied . We construct statistical ensembles of random uncorrelated networks in a natural way and establish a one - to - one correspondence between them and known construction procedures . One of conclusions is that , in equilibrium networks , fat - tailed degree distributions ( in particular , power - law ones ) are possible only starting from some critical value of the average degree . Above this critical point , a ﬁnite fraction of edges are in a “condensed state” , i . e . are attached to an inﬁnitely small fraction of vertices . This situation for equilibrium networks contrasts with that for growing ones , were fat - tailed degree distributions are realized over a wide range of a control parameter without any condensate . The keystone of network science are construction procedures . Erd¨os and R´enyi constructed ensembles of random graphs with a Poisson degree distribution by adding edges at random to a ﬁxed number of vertices [ 1 ] . When the total number of edges L is ﬁxed , this provides a canonical ensemble . When one ﬁxes the probability that two vertices are connected , the procedure produces a grand canonical ensemble . To obtain equilibrium random graphs with an arbitrary degree distribution Π ( q ) , a diﬀerent statistical ensemble was introduced [ 3 ] ( see also Ref . [ 18 ] ) . Roughly speaking , these are graphs , maximally random under the restriction that their degree distribution is equal to a given Π ( q ) ( see below ) . Here we demonstrate that this “static” construction produces a microcanonical ensemble , and construct equivalent ( in the thermodynamic limit , i . e . N → ∞ ) canonical and grand canonical ensembles as limiting equilibrium states of simple dynamical processes . In statistical mechanics , equilibrium ensembles arise as inﬁnite - time limiting distributions of some ergodic dynamics . Here we present naturally looking graph evolution models , using the generalization of the concept of “preferential linking” , which was introduced in [ 4 ] . We consider two kinds of a random network evolving under the mechanism of preferential linking and displaying ergodic behavior . The latter means that an evolving ensemble ﬁnally becomes equilibrium , and ﬁnal statistical weights for the complete set of graphs of the ensemble are independent of time and initial state . The speciﬁc rule of preferential linking that we use allows us to construct equilibrium statistical ensembles with an arbitrary Π ( q ) . The paper is organized as follows . In Section II we introduce the main notions of random graph theory . The next Section III is a key one : we establish a connection between ergodic evolution and statistical ensembles for undirected graphs . In Section IV these results are generalized to the case of directed graphs . Section V is devoted to networks 1 with a fat - tailed degree distribution , decaying slower than exponential . The results are discussed in the last Section VI . Technical details are described in three Appendices . II . DEFINITIONS AND MAIN NOTIONS A graph g is a set of N vertices connected by L edges , directed or undirected . It may be displayed as a set of points , with some pairs connected by one or more lines , with or without arrows . For analytic purposes , a graph is represented by an N × N adjacency matrix b g , whose elements g ij are numbers of edges connecting vertices i and j . An undirected graph ( with undirected edges ) , is represented by a symmetric adjacency matrix , g ij = g ji . In this case it is convenient to set diagonal elements g ii to be equal to twice the number of unit - length loops . Then , the adjacency matrix b g ( 1 ) of an undirected graph G 1 , obtained from a directed graph G with an adjacency matrix b g by replacing all directed edges with undirected ones , is simply g ( 1 ) ij = g ij + g ji . Mayer’s graphs are the ones without multiple connections and one - vertex loops . Their adjacency matrix elements satisfy the conditions : g 2 ij = g ij , g ii = 0 . Vertex in - degree r i of a vertex i in a directed graph is a number of incoming edges of the vertex i , r i = P j g ij . Similarly , out - degree s i is a number of edges , outgoing from the vertex i , s i = P j g ji . Vertex degree for undirected graph is q i = P j g ij = P j g ji . A statistical ensemble of graphs is deﬁned by choosing of a set G of graphs and a rule that associates some statistical weight ( unnormalized measure ) P ( g ) > 0 with any graph g ∈ G . Then the ensemble average of any quantity A ( g ) that depends on properties of a graph is h A i = Z − 1 P g ∈ G A ( g ) P ( g ) , where Z is a partition function , Z ≡ P g ∈ G P ( g ) . For instance , let A ( g ) be the total number of vertices of in - degree r and out - degree s : N ( r , s ; g ) = N X i = 1 δ [ r i ( g ) − r ] δ [ s i ( g ) − s ] . ( 1 ) Here N is the total number of vertices in the graph g ( we consider only ensembles with a ﬁxed number of vertices ) . The probability that a randomly chosen vertex has in - degree r and out - degree s ( a degree distribution ) is Π ( r , s ) ≡ h N ( r , s ) i N = 1 N * N X i = 1 δ [ r i ( g ) − r ] δ [ s i ( g ) − s ] + . ( 2 ) For an undirected graph , one can deﬁne the number of vertices with a given degree q N ( q ) = N X i = 1 δ [ q i ( g ) − q ] , ( 3 ) and a degree distribution Π ( q ) = h N ( q ) i N = 1 N * N X i = 1 δ [ q i ( g ) − q ] + . ( 4 ) In this paper we consider statistical ensembles with non - Mayer’s graphs allowed . The advantage of this assumption is that one can associate a statistical weight with a graph by using the same rules , as for the contribution of the corresponding Feynman diagram in an appropriately chosen zero - dimensional ﬁeld theory ( see [ 11 , 12 ] ) . Note that we consider labeled graphs . That is , two graphs , g and g ′ , which diﬀer only by numeration of vertices , are treated as diﬀerent ones . III . EVOLUTION OF GRAPHS AND STATISTICAL ENSEMBLES : UNDIRECTED GRAPHS In this section we discuss how ensembles of undirected graphs arise as a result of the network evolution . For simplicity , we restrict ourselves to undirected graphs—generalization to the case of directed ones is presented in the next section . We deﬁne the statistical weights of the canonical and grand canonical ensembles of random networks as a limiting equilibrium distribution of a process , during which one graph g ∈ G of the ensemble transforms to another graph g ′ ∈ G with probability W ( g ′ , g ) dt . The statistical weights P ( g , t ) evolve according to the master equation 2 ∂ t P ( g , t ) = X g ′ ∈ G [ W ( g , g ′ ) P ( g ′ , t ) − W ( g ′ , g ) P ( g , t ) ] . ( 5 ) An equilibrium ensemble is a stationary one . P ( g , t ) = P ( g ) is independent of t , where statistical weights are determined by the detailed balance condition ( absence of “currents” ) : W ( g , g ′ ) P ( g ′ ) = W ( g ′ , g ) P ( g ) . ( 6 ) This equilibrium ensemble exists if and only if the set of “hopping rates” W ( g , g ′ ) satisﬁes two conditions : ( i ) For any pair of graphs g , g ′ ∈ G , there exists a sequence of graphs g 1 , g 2 , . . . g n ∈ G such that W ( g ′ , g n ) W ( g n , g n − 1 ) . . . W ( g 2 , g 1 ) W ( g 1 , g ) 6 = 0 . ( 7 ) ( ii ) For any sequence of graphs g 1 , g 2 , . . . g n ∈ G , the equality : W ( g 1 , g 2 ) W ( g 2 , g 3 ) . . . W ( g n − 1 , g n ) W ( g n , g 1 ) = W ( g 1 , g n ) W ( g n , g n − 1 ) . . . W ( g 3 , g 2 ) W ( g 2 , g 1 ) , ( 8 ) is valid . These conditions ensure that ( a ) ascribing an arbitrary statistical weight to some graph , one can obtain statistical weights of all other graphs up to a constant multiple , and ( b ) this deﬁnition is unambiguous : the weights are indepen - dent of the ways connecting initial graph with all the other ones . To satisfy condition ( ii ) , it is suﬃcient to assume the factorization : W ( g ′ , g ) = V f ( g ′ ) V i ( g ) . ( 9 ) Our dynamical constructions , which are presented below , satisfy this condition . We use simple natural assumptions about the evolution rates W ( g ′ , g ) , but our choice is not unique ( e . g . , see a “Metropolis algorithm” from Refs . [ 11 , 12 ] ) . We consider the following equilibrium statistical ensembles of graphs with a ﬁxed total number of vertices N . A statistical ensemble is a set of graphs G plus rules that determine statistical weighs P ( g ) for all graphs g ∈ G . 1 . A microcanonical ensemble [ 3 ] . ( set ) Let N ( q ) be a sequence of non - negative integers such that 0 < P q N ( q ) = N < ∞ . G MC is the set of all graphs of size N , for which number of vertices of degree q is equal to N ( q ) . ( rule ) To each graph g ∈ G MC ascribe the weight P MC ( g ) = N − L N Y i = 1 q i ! g ii ! ! N Y j < k = 1 1 g jk ! . ( 10 ) This is a “static” construction . These statistical weights follow from pure combinatorics . They are just the number of possible ways to obtain a given graph g ∈ G MC by connecting together N vertices with degrees q 1 , q 2 , . . . q N ( see proof in Appendix A ) . The multiple N − L is introduced to ensure the extensiveness of the “free energy” , ln Z MC . Eq . ( 10 ) implies , that edges in the graph are distinguishable . Note that if only Mayer graphs are allowed , all graphs in this ensemble have equal weights . In the thermodynamic limit [ 19 ] , the microcanonical ensemble is described by a sequence of values { Π ( q ) } or , which is the same , { N ( q ) } ( in particular , this includes the mean degree ¯ q ← 2 L / N ) . To construct canonical and grand canonical ensembles we use the processes of rewiring [ 20 ] or of deletion / creation of edges [ 21 ] , and the idea of preferential linking [ 4 , 22 , 23 ] . We assume that the probability that an edge becomes attached to a vertex i depends only on the degree q i of this vertex . This probability is determined by some preference function f ( q ) . 2 . A canonical ensemble . ( set ) The set G C consists of all graphs with N vertices and L edges . ( rule ) At each step of the evolution , one of the ends of a randomly chosen edge is rewired to a preferentially chosen vertex k . Let the rate of this process be f ( q k ) [ 24 ] . The limiting stationary statistical weights give P C ( g ) . In the thermodynamic limit , the canonical ensemble is described by { f ( q ) } and ¯ q ← 2 L / N . Note that the multiplication of f ( q ) by a constant , f ( q ) → Cf ( q ) , is simply the rescaling of time , t → t / C . It does not inﬂuence equilibrium properties . 3 3 . A grand canonical ensemble . ( set ) The set G GC consists of all graphs with any number of edges and a ﬁxed number of vertices , N . ( rule ) There are two parallel processes in this case : edges are deleted and emerge permanently . Randomly chosen edges are deleted at a rate λN ( λ is the inverse lifetime of an edge , λ is ﬁxed as N → ∞ , i . e . , in the thermodynamic limit ) . Edges between vertices i and j emerge at a rate f ( q i ) f ( q j ) . To ensure the correspondence with the canonical ensemble , let the deletion rate of tadpoles be 2 λN . In the thermodynamic limit , the grand canonical ensemble is described by { f ( q ) } and λ . Let us obtain , for example , statistical weights for the canonical ensemble . Let an edge ( i , j ) of a graph g be rewired to ( i , k ) in a graph g ′ . We have the following balance equation for the statistical weights of these two graphs : g ′ ik f (cid:0) q ′ j (cid:1) P C ( g ′ ) = g ij f ( q k ) P C ( g ) . ( 11 ) Here quantities with a prime mark are referred to the graph g ′ , q ′ j = q j − 1 , g ′ ik = g ik + 1 + δ ik ( adding a tadpole increases g ii by two ) . The multiple g ij is present , because rewiring any of ( i , j ) edges gives the same result . One can look for the solution in the form : P C ( g ) = N − L N Y i = 1 p ( q i ) χ d ( g ii ) N Y j < k = 1 χ ( g jk ) , ( 12 ) where p , χ and χ d are some functions of an integer argument . Substituting Eq . ( 12 ) into Eq . ( 11 ) , we obtain at i 6 = j , i 6 = k : p ( q + 1 ) = f ( q ) p ( q ) , χ ( g + 1 ) = χ ( g ) / ( g + 1 ) . Setting i = j or i = k , we get : χ d ( g + 2 ) = χ d ( g ) / ( g + 2 ) . The constant multiple N − L is introduced to ensure the “free energy” to be extensive variable , ln Z C ∼ N . Thus we obtain : p ( q ) = q − 1 Y r = 0 f ( r ) for q > 0 , p ( 0 ) = 1 , χ ( g ) = 1 g ! , χ d ( g ) = 1 g ! ! . ( 13 ) Then we have P C ( g ) = N − L N Y i = 1 p ( q i ) g ii ! ! N Y j < k = 1 1 g jk ! . ( 14 ) Comparing Eq . ( 14 ) with Eq . ( 10 ) , one can see that P C ( g ) = P MC ( g ) N Y i = 1 p ( q i ) q i ! . ( 15 ) Analogously , for the grand canonical ensemble we have P GC ( g ) = ( λN ) − L ( g ) N Y i = 1 p ( q i ) g ii ! ! Y j < k = 1 1 g jk ! = λ − L ( g ) P C ( g ) , ( 16 ) where p ( q ) is again given by Eq . ( 13 ) . Here L ( g ) is the number of edges in a graph g . One can present the statistical weights in a diﬀerent form . For the canonical ensemble , one can write P C ( g ) = N Y i = 1 1 g ii ! ! Y j < k = 1 1 g jk ! exp " ∞ X q = 0 N ( q , g ) ln p ( q ) # , ( 17 ) The corresponding form for the grand canonical ensemble includes the additional term − L ( g ) ln ( λN ) in the expo - nential : 4 P GC ( g ) = N Y i = 1 1 g ii ! ! Y j < k = 1 1 g jk ! exp " − L ( g ) ln ( λN ) + ∞ X q = 0 N ( q , g ) ln p ( q ) # . ( 18 ) The above constructions are reasonable only if these ensembles are equivalent in the thermodynamic limit . Here we show that this is the case . One can see from Eq . ( 17 ) that statistical weights of graphs with the same sequences { N ( q , g ) , q = 0 , 1 , 2 , . . . } are equal . Then the canonical ensemble is equivalent to the microcanonical one with the same Π ( q ) = h N ( q ) i / N if ﬂuctuations of N ( q ) are negligibly small in the thermodynamic limit : h(cid:10) N 2 ( q ) (cid:11) − h N ( q ) i 2 i / h N ( q ) i 2 → 0 as N → ∞ . To study these ﬂuctuations , one may use the following standard relations : δ ln Z ( { p ( ˜ q ) } ) δ ln p ( q ) = h N ( q ) i , δ 2 ln Z ( { p ( ˜ q ) } ) δ ln p ( q ) δ ln p ( q ′ ) = h N ( q ) N ( q ′ ) i − h N ( q ) i h N ( q ′ ) i , ( 19 ) which follows from Eq . ( 17 ) and the deﬁnition of the partition function . Equation ( 19 ) holds both for the canonical and the grand canonical ensembles . Notice that the transition from a microcanonical ensemble to canonical one is basically the Legendre transform [ 25 ] , where some thermodynamically conjugated ﬁelds are used . In our case , the microcanonical ensemble is characterized by a sequence of { N ( q ) } , and the conjugated ﬁelds are { ln p ( q ) } . In the grand canonical ensemble , − ln ( λN ) is analogous to a standard chemical potential or , more precisely , to µ / kT . The partition function of the grand canonical ensemble is Z GC ( N , λ , { p ( q ) } ) = ∞ X L = 0 λ − L Z C ( N , L , { p ( q ) } ) . ( 20 ) Let us introduce a zero - dimensional theory of real scalar ﬁeld x with the action [ 11 , 12 ] S ( x ) = − Λ 2 x 2 − κ Φ ( x ) , ( 21 ) where Φ ( x ) = X q p ( q ) q ! x q . ( 22 ) Then the generating functional of this theory can be expanded in the series of all possible Feynman diagrams , whose contributions coincide with statistical weights : Z ( Λ , κ , { p ( q ) } ) = r Λ 2 π Z + ∞ −∞ dx exp S ( x ) = ∞ X N = 0 ( − κ ) N N ! Z GC ( N , Λ / N , { p ( q ) } ) . ( 23 ) Then we come to the expression Z GC ( N , λ , { p ( q ) } ) = r Nλ 2 π Z + ∞ −∞ dx exp (cid:18) − Nλ 2 x 2 (cid:19) [ Φ ( x ) ] N . ( 24 ) From Eq . ( 20 ) it follows that Z C ( N , L , { p ( q ) } ) = I C dλ 2 πiλ L − 1 Z GC ( N , λ ) , ( 25 ) where the integration contour C has no singularities outside of it . Substituting Eq . ( 24 ) into Eq . ( 25 ) , changing the order of integration , and calculating the integral over λ , we have Z C ( N , L , { p ( q ) } ) = N − L ( 2 L − 1 ) ! ! I c dx 2 πix − 2 L − 1 [ Φ ( x ) ] N . ( 26 ) 5 where the contour c encircles the point x = 0 . This derivation is rather formal , because convergence of the integrals for the generating functional Z , Eq . ( 23 ) , and for the grand canonical partition functions , Eq . ( 24 ) , depends on the properties of Φ ( x ) . These integrals are well deﬁned and converge if the diagrammatic series for the corresponding partition functions , or for the generating functional , converge . Note that the partition function of the grand canonical ensemble does not exist if either ln Φ ( x ) is growing faster than x 2 at x → ∞ , or Φ ( x ) has singularities at the real axis ( series ( 22 ) has a ﬁnite radius of convergence ) . But for the canonical ensemble , the partition function does exist for every Φ ( x ) , which is analytic at x = 0 . Indeed , for the canonical ensemble , the partition function is a sum over a ﬁnite set of graphs , while for the grand canonical ensemble , it is an inﬁnite series , which may diverge . More detailed derivation of Eqs . ( 24 ) and ( 26 ) is presented in Appendix B . Note also that the expression ( 26 ) coincides with that for the partition function of the backgammon ( “balls in boxes” ) model [ 15 ] . As N → ∞ , one can use the saddle point expression : Z C ( N , L , { p ( q ) } ) → (cid:18) ¯ q ex 2 s (cid:19) L [ Φ ( x s ) ] N , ( 27 ) where ¯ q = 2 L / N is the average vertex degree and the saddle point x s is given by the equation ¯ q = x s Φ ′ ( x s ) Φ ( x s ) . ( 28 ) We omitted a preexponential saddle - point multiple in Eq . ( 27 ) as insigniﬁcant in the thermodynamic limit . For grand canonical ensemble we have : Z GC ( N , λ , { p ( q ) } ) = exp (cid:18) − Nλ 2 x 2 s (cid:19) [ Φ ( x s ) ] N , ( 29 ) λx s = Φ ′ ( x s ) Φ ( x s ) . ( 30 ) From the fact that the logarithm of the partition function of the canonical ensemble is extensive , ln Z GC ∼ N ( see Eqs . ( 19 ) and ( 27 ) ) , it follows that h N ( q ) N ( q ′ ) i −h N ( q ) i h N ( q ′ ) i = O ( N ) , so that the canonical ensemble is indeed equivalent to the microcanonical one . Analogously , using the relations h L i = − ∂ ln Z GC ∂ ln λ , (cid:10) L 2 (cid:11) − h L i 2 = ∂ 2 ln Z GC ∂ ( ln λ ) 2 = O ( N ) , ( 31 ) one ﬁnds that the ﬂuctuations of the number of edges L in the grand canonical ensemble disappear in the thermo - dynamic limit . This demonstrates the equivalence of the grand canonical and canonical ensembles , if f ( q ) grows not very fast with q , which allows the existence of the grand canonical ensemble . Their parameters are related as : λ = Lx 2 s / N = ¯ qx 2 s . From Eqs . ( 19 ) , ( 22 ) and ( 27 ) – ( 30 ) , one sees that Π ( q ) = h N ( q ) i N = p ( q ) x qs q ! Φ ( x s ) . ( 32 ) This is valid for both the canonical and grand canonical ensembles . Note that Eq . ( 32 ) may be also derived directly from the evolution equation for the degree distribution ( see Appendix C ) . Equations ( 28 ) or ( 30 ) , and ( 32 ) ﬁx the one - to - one correspondence between the degree distribution Π ( q ) , which determines the microcanonical ensemble , and the set of parameters ( ¯ q , { f ( q ) } ) or , equivalently , ( ¯ q , { p ( q ) } ) ( see Eq . ( 13 ) ) . From Eqs . ( 13 ) and ( 32 ) , it follows Π ( q + 1 ) / Π ( q ) = f ( q ) x s / ( q + 1 ) . Then one can correspond the microcanonical ensemble which is described by a degree distribution Π ( q ) with the canonical and grand canonical ensembles characterized by ( i ) f ( q ) = ( q + 1 ) Π ( q + 1 ) Π ( q ) , ( 33 ) ( f ( q ) is deﬁned up to an arbitrary multiple ) , and ( ii ) by ¯ q = P q q Π ( q ) for the canonical ensemble , or λ = ¯ q for the grand canonical one . 6 IV . GENERALIZATION TO THE CASE OF DIRECTED GRAPHS A microcanonical ensemble of directed graphs is characterized by a distribution function Π ( r , s ) , which is the prob - ability that a randomly chosen vertex has in - degree r and out - degree s . More precisely , one must deﬁne non - negative integers N n ( r , s ) with the following properties : 0 < N n = P r , s N n ( r , s ) < ∞ , N n → ∞ and N n ( r , s ) / N n → Π ( r , s ) as n → ∞ . For a directed graph , we also must require , that total in - and out - degrees are equal : P r , s ( r − s ) N n ( r , s ) = 0 . Then for each n , we introduce the ensemble of directed graphs with N n ( r , s ) vertices of in - degree r and out - degree s , N n vertices in total , connected in all possible ways . To each this graph g , we ascribe for a statistical weight equal to the number of possible ways to construct the graph g : P MC ( g ) = N Y i = 1 r i ! s i ! N Y j , k = 1 1 g jk ! . ( 34 ) The limit of such a sequence at n → ∞ would be the microcanonical ensemble with a given degree distribution Π ( r , s ) . Canonical and grand canonical ensembles may be introduced quite analogously to what it had been done for undirected graphs . For example , the canonical ensemble may be introduced by using the process of rewiring one end of an edge . There are two diﬀerences from the undirected graph constructions : ( i ) we introduce two generalized preferential attachment functions , f 1 for rewiring the outgoing end of an edge , and f 2 for rewiring the incoming end , and ( ii ) in general , these function depend on both the in - and out - degrees of the destination vertex . Applying detailed balance conditions for transitions between graphs g 1 and g 2 ( edge i → j rewires to i → k ) , and between graphs g 3 and g 4 ( edge i ← j rewires to i ← k ) , we obtain the relations : g ( 2 ) ik f 1 (cid:16) r ( 2 ) j , s ( 2 ) j (cid:17) P C ( g 2 ) = g ( 1 ) ij f 1 (cid:16) r ( 1 ) k , s ( 1 ) k (cid:17) P C ( g 1 ) , g ( 2 ) ij = g ( 1 ) ij − 1 , g ( 2 ) ik = g ( 1 ) ik + 1 , r ( 2 ) j = r ( 1 ) j − 1 , s ( 2 ) j = s ( 1 ) j , r ( 2 ) k = r ( 1 ) k + 1 , s ( 2 ) k = s ( 1 ) k ; ( 35 ) g ( 4 ) ki f 2 (cid:16) r ( 4 ) j , s ( 4 ) j (cid:17) P C ( g 4 ) = g ( 3 ) ji f 2 (cid:16) r ( 3 ) k , s ( 3 ) k (cid:17) P C ( g 3 ) , g ( 4 ) ki = g ( 3 ) ki + 1 , g ( 4 ) ji = g ( 3 ) ji − 1 , r ( 4 ) j = r ( 3 ) j , s ( 4 ) j = s ( 3 ) j − 1 , r ( 4 ) k = r ( 3 ) k , s ( 2 ) k = s ( 1 ) k + 1 . ( 36 ) One can look for the solution of the above equations in the form : P C ( g ) = N Y i = 1 p ( r i , s i ) N Y j , k = 1 χ ( g jk ) . ( 37 ) Then we have : p ( r + 1 , s ) = f 1 ( r , s ) p ( r , s ) , p ( r , s + 1 ) = f 2 ( r , s ) p ( r , s ) ; ( 38 ) χ ( g + 1 ) = χ ( g ) g + 1 . ( 39 ) Applying subsequently Eqs . ( 38 ) in diﬀerent order , we have : p ( r + 1 , s + 1 ) = f 1 ( r , s + 1 ) f 2 ( r , s ) p ( r , s ) = f 2 ( r + 1 , s ) f 1 ( r , s ) p ( r , s ) . This means that the preferential linking functions f 1 and f 2 cannot be chosen arbitrary but must satisfy the condition f 1 ( r , s ) f 2 ( r , s + 1 ) = f 1 ( r + 1 , s ) f 2 ( r , s ) , ( 40 ) which is actually a consequence of the detailed balance condition ( 8 ) . The solution of Eqs . ( 38 ) is constructed in the following way . Let us consider a 2D square lattice . We associate f 1 ( r , s ) with each horizontal bond connecting sites ( r , s ) and ( r + 1 , s ) , and associate f 2 ( r , s ) with the vertical bond , connecting sites ( r , s ) and ( r , s + 1 ) . Let L be some path connecting points ( 0 , 0 ) with ( r , s ) . Then , p ( r , s ) = p ( 0 , 0 ) Y L f dα ( ρ , σ ) . ( 41 ) Here ( ρ , σ ) are coordinates of points along the path L , α = 1 ( 2 ) for the horizontal ( vertical ) direction , and d = + 1 ( − 1 ) if the bond is passed in its positive ( negative ) direction . The condition ( 40 ) ensures the independence of the product 7 in Eq . ( 41 ) of the path L . In fact , this is the condition of the potentiality ( zero vorticity ) of the vector ﬁeld ln f α deﬁned on the square lattice . Then ln p is a potential for this ﬁeld , that is ln f α is a lattice gradient of ln p ( see Eq . ( 38 ) ) . The arbitrary multiple p ( 0 , 0 ) may be set , e . g . , to 1 . Solution of Eq . ( 39 ) is simple : χ ( g ) = 1 g ! . ( 42 ) The grand canonical ensemble may be constructed quite analogously to what it had been done for undirected graphs . Two opposite processes are introduced : one is of edge creation , at a rate f 2 ( r i , s i ) f 1 ( r j , s j ) for the edge , going from the vertex i to j , the other is of the edge removal , at a rate λN . Again , f 1 and f 2 must satisfy the condition ( 40 ) to ensure the equilibrium character of a stationary state . The statistical weight of a graph is given by the expression P GC ( g ) = e − λL ( g ) N Y i = 1 p ( r i , s i ) N Y j , k = 1 1 g jk ! . ( 43 ) The derivation of the integral representation of the partition function is quite similar to that for undirected graphs , but Feynman’s diagrams with directed lines now are generated by complex ﬁelds . We introduce a complex scalar ﬁeld x , and write the action : S ( x , x ∗ ) = − Λ | x | 2 − κ Φ ( x , x ∗ ) , ( 44 ) Φ ( x , x ∗ ) = ∞ X r , s = 0 p ( r , s ) r ! s ! x r ( x ∗ ) s . ( 45 ) Then the following generating functional of this ﬁeld theory will produce all possible graphs with any number of vertices as its Feynman diagrams . Their contributions are the same as statistical weights of graphs in the grand canonical ensemble ( 43 ) with λ = Λ / N , except the additional multiples ( − κ ) N / N ! . Therefore , one can write : Z ( κ , Λ , { p ( r , s ) } ) = Λ π Z dxdx ∗ exp S ( x , x ∗ ) = ∞ X N = 0 ( − κ ) N N ! Z GC ( N , Λ / N , { p ( r , s ) } ) , ( 46 ) where the integration is over the entire complex plane ( compare with Eq . ( 23 ) ) . Therefore , Z GC ( N , λ , { p ( r , s ) } ) = Nλ π Z dxdx ∗ exp (cid:16) − Nλ | x | 2 (cid:17) [ Φ ( x , x ∗ ) ] N . ( 47 ) In Eqs . ( 46 ) , ( 47 ) one should treat x and x ∗ as independent integration variables when actually calculating the integrals . The partition function of the canonical ensemble is given by Z C ( N , L , { p ( r , s ) } ) = L ! N L I C 1 dx 2 πi I C 2 dy 2 πi ( xy ) − L − 1 [ Φ ( x , y ) ] N , ( 48 ) where the integration contours C 1 , 2 encircle points x = 0 , y = 0 , respectively . The derivation of Eq . ( 48 ) is quite similar to that of Eq . ( 26 ) for undirected graphs . Again , in the thermodynamic limit , N → ∞ , L → ∞ , 2 L / N → ¯ q , one can use a saddle point approximation , which gives Z C ( N , L , { p ( r , s ) } ) → (cid:18) ¯ q ex s y s (cid:19) L [ Φ ( x s , y s ) ] N , ( 49 ) where x s and y s are deﬁned from the stationary point equations : ¯ q = x s ∂ ln Φ ( x s , y s ) ∂x s = y s ∂ ln Φ ( x s , y s ) ∂y s . ( 50 ) For the grand canonical ensemble , we have Z GC ( N , λ , { p ( r , s ) } ) → exp ( − Nλx s y s ) [ Φ ( x s , y s ) ] N , ( 51 ) where the saddle point coordinates x s and y s are determined from the equations : 8 λy s = ∂ ln Φ ( x s , y s ) ∂x s , λx s = ∂ ln Φ ( x s , y s ) ∂y s . ( 52 ) The degree distribution both for the canonical and grand canonical ensembles is deﬁned by Π ( r , s ) = h N ( r , s ) i N = δ ln Z ( { p ( u , v ) } ) Nδ ln p ( r , s ) → p ( r , s ) r ! s ! x rs y ss , ( 53 ) where the last relation is valid in the thermodynamic limit . Eqs . ( 53 ) , ( 50 ) and ( 41 ) establish correspondence between the microcanonical ensemble with the degree distribution Π ( r , s ) and the canonical one , characterized by the preferential linking functions f 1 , 2 and the mean vertex degree ¯ q . The parameters of the canonical and grand canonical ensembles with the same degree distribution are related as ¯ q = λx s y s . ( 54 ) This relation follows from Eqs . ( 50 ) and ( 52 ) . Again , as it was for undirected graphs , the canonical ensemble does exist for every p ( r , s ) , provided that power series ( 45 ) has ﬁnite radii of convergence on both x and y . Conditions for the existence of the grand canonical ensemble are essentially more strict : the integral in Eq . ( 47 ) must be well deﬁned and convergent . V . FAT - TAILED DEGREE DISTRIBUTIONS In this section we shall consider in detail properties of the canonical ensembles of graphs , which arise if a preference function f ( q ) grows rapidly enough . For brevity , we focus on the undirected graphs . The generalization to the ensembles of directed graphs is straight - forward . As one can see from Eq . ( 24 ) , the grand canonical ensemble does not exist in two cases . In the ﬁrst case the integral , representing the partition function , diverges , since the function Φ ( x ) grows fast enough at x → ±∞ . In the second case , the integral is not determined , because Φ ( x ) has a singularity on the real axis . In both the situations we have degree distributions , which decay relatively slowly as q → ∞ . Let us begin with the case , when Φ ( x ) has no singularities , but ln Φ ( x ) grows faster than x 2 as | x | → ∞ . Using Eqs . ( 22 ) and ( 32 ) , one can write the following relation : Φ ( x ) Φ ( x s ) = ∞ X q = 0 Π ( q ) (cid:18) x x s (cid:19) q , ( 55 ) that is Φ ( x ) is expressed in terms of the Z - transform of Π ( q ) . Using the formula for the inverse of Z - transform , we obtain Π ( q ) = I dx 2 πix (cid:16) x s x (cid:17) q Φ ( x ) Φ ( x s ) . ( 56 ) For ﬁnding the relation between the asymptotic behaviours of Φ ( x ) and Π ( q ) , let us use a saddle point approximation in Eq . ( 56 ) . It is convenient to set Φ ( x ) = exp φ ( x ) . The equation for the saddle point x a is q = x a φ ′ ( x a ) . Then the asymptotic expression for Π ( q ) is Π ( q ) → { 2 πx a [ x a φ ′′ ( x a ) − φ ′ ( x a ) ] } − 1 / 2 (cid:18) x s x a (cid:19) q exp [ φ ( x a ) − φ ( x s ) ] ( 57 ) The integral for the grand canonical partition function in Eq . ( 24 ) is divergent , if φ ( x ) grows as x 2 or faster at x → ∞ . Assume that φ ( x ) → Ax µ as x → ∞ . Then the saddle point equation is q = Aµx µ , and x a → ( q / Aµ ) 1 / µ . Omitting irrelevant multiples , we have from Eq . ( 57 ) : Π ( q ) ∼ ( 2 πq ) − 1 / 2 (cid:18) ¯ q q e (cid:19) q / µ ∼ [ Γ ( q ) ] − 1 / µ . ( 58 ) Thus , if the degree distribution Π ( q ) decays slower than [ Γ ( q ) ] − 1 / 2 as q → ∞ , then the partition function of the corresponding grand canonical ensemble diverges . 9 The reason for this divergence is that we have admitted the existence of non - Mayer’s graphs . Indeed , let us choose some pair of vertices in a graph . Let us add more and more edges connecting this pair . The statistical weight of the graph with ν edges between this pair contains multiple p ( q i ) p ( q j ) / ν ij ! , where q i = ν ij + const , q j = ν ij + const . One can easily conclude that the statistical weights approach 0 as ν → ∞ only if p 2 ( q ) / q ! → 0 , or √ q ! Π ( q ) → 0 . The same result may be attained if we consider a sequence of graphs obtained by subsequent addition of closed loops to a chosen vertex . This result may also be presented in the diﬀerent way : if the preference function f ( q ) = p ( q + 1 ) / p ( q ) grows faster than √ q at large q , then the partition function of the grand canonical ensemble diverges . The radius of convergence of the series expansion ( 22 ) is R c = lim q →∞ ( q + 1 ) p ( q ) p ( q + 1 ) = lim q →∞ q + 1 f ( q ) . ( 59 ) If f ( q ) grows as q → ∞ slower than a linear function , then R c = ∞ . In this case Φ ( x ) has no singularities at all . This means that ( i ) the partition function of the canonical ensemble may be expressed in the form ( 26 ) , and ( ii ) in the thermodynamic limit , one can use for this function its saddle point expression , Eqs . ( 27 ) and ( 28 ) . If f ( q ) grows faster than a linear function , then R c = 0 . This means that although the canonical ensemble exists ( the canonical ensemble always exists , because it is represented by a ﬁnite set of graphs at any ﬁnite N and L ) , its partition function can not be written in the form of the integral representation ( 26 ) . Actually , this means the absence of any meaningful thermodynamic limit . The interesting case is 0 < R c < ∞ . In this case , the partition function of the canonical ensemble can be expressed as an integral , but the saddle point expression for this integral may not be longer valid . The saddle point expression is not valid at a large enough number of edges in the network , when the saddle point approaches the position of singularity . We show that in this situation , “fat - tailed” degree distributions , i . e . ones decreasing slower than an exponent , may arise . Without any lack of generality , one can set R c = 1 in this case . This is equivalent to f ( q ) = q + o ( q ) as q → ∞ . In Eq . ( 28 ) its right hand side is a monotonously increasing function of x s . This means that as ¯ q = 2 L / N grows , x s grows too . As x s < R c = 1 , the degree distribution contains exponentially decaying multiple x qs . There are two possibilities depending on the character of the singularity of Φ ( x ) at x = 1 : either Φ ′ ( x s ) → ∞ , or it approaches some ﬁnite value as x s → ∞ . In the former case , again there are two possibilities : either lim x → 1 Φ ( x ) is ﬁnite , or this limit is inﬁnite . If Φ ( 1 ) is ﬁnite ( but Φ ′ ( 1 ) is inﬁnite ) , then the degree distribution approaches some limiting form as ¯ q → ∞ , and the ﬁrst moment of this limiting distribution diverges . This means that such a degree distribution can not be realized in any canonical ensemble with a ﬁnite number of edges per vertex . To construct networks with such a distribution , one has to change the conditions of the thermodynamic limit transition in the canonical ensemble , assuming N → ∞ , L → ∞ and ¯ q = 2 L / N → ∞ , instead of keeping ¯ q ﬁxed . Another way is to use a microcanonical ensemble . If Φ ( 1 ) is inﬁnite , no normalizable degree distribution without an exponential cut - oﬀ is possible . Now , let us consider the case Φ ′ ( 1 ) < ∞ . The degree distribution becomes “fat - tailed” when x s = 1 , which takes place when ¯ q = ¯ q c = Φ ′ ( 1 ) / Φ ( 1 ) . If ¯ q > q c , the saddle point equation ( 28 ) has no solution 0 < x s < 1 . In this case , in the thermodynamic limit , the partition function remains the same up to a preexponential factor as for ¯ q = q c . Indeed , let us rewrite Eq . ( 26 ) as Z C ( N , L , { p ( q ) } ) = N − L ( 2 L − 1 ) ! ! I c dx 2 πix (cid:2) x − ¯ q Φ ( x ) (cid:3) N . ( 60 ) To calculate a large N asymptotics one has to deform the integration contour into the steepest descent one , intercepting the real axis at the point , where x − ¯ q Φ ( x ) is minimal within the interval ( 0 , 1 ) , and going along the line of the constant ( i . e . zero ) imaginary part . If ¯ q < q c , this is a usual saddle - point contour , crossing the real axis perpendicularly at some point x s < 1 . If ¯ q > q c , this contour consists of two complex conjugate parts meeting always at x = 1 . As ¯ q grows , the point , where the integrand is maximal , x s = 1 , does not move . The only change is that the two branches of the contour become closer and closer to the real axis in the vicinity of x = 1 at x > 1 . But it is x s and Φ ( x s ) that determine the value of the main ( extensive ) contribution to the logarithm of the partition function : ln Z C = − L ln ( ¯ qx s ) + N ln Φ ( x s ) + o ( N ) . The extensive part of the “free energy” − ln Z does not depend on ¯ q as ¯ q > q c . So , the degree distribution N − 1 δ ln Z / δ ln p ( q ) ( see Eqs . ( 4 ) and ( 19 ) ) remains equal to its critical point value Π c ( q ) . Consequently , the ﬁnite fraction of edges , ¯ q / ¯ q c − 1 , is attached to an inﬁnitely small fraction of vertices , forming a “condensate” , quite analogous to the one in the backgammon model [ 15 , 26 ] . A speciﬁc form of the degree distribution at the critical point depends on the behaviour of this diﬀerence f ( q ) − q = o ( q ) as q → ∞ . For example , for the so called “scale - free” distributions , Π ( q ) ∝ q − γ as q → ∞ ( γ > 2 ) , we obtain from Eq . ( 33 ) : f ( q ) = q + 1 − γ + O (cid:0) q − 1 (cid:1) ( 61 ) 10 at the critical point . For the same f ( q ) but for lower average degrees ¯ q < ¯ q c , we have Π ( q ) ∝ x − q s q − γ at large q . So , the state with a power - law degree distribution is marginal for the phase without the condensate of edges [ 27 ] . ( A “scale - free” state as a line between “generic” and “crumpled” phases on the phase diagram of trees was found in Ref . [ 11 ] , see also the condensation transition in the backgammon model [ 15 ] . ) Our analysis has shown that the condensation takes place above ¯ q c [ 28 ] . Furthermore , the fat - tailed degree distribution is present also in the condensed phase . The problem of the condensed phase is more complex for the ensembles of Mayer’s graphs , that is the ones without tadpoles and melons . The nature of condensation transition in such ensembles will be discussed elsewhere . VI . CONCLUSIONS Thus , we have developed the consistent description of random networks in the framework of classical statistical mechanics . Using the traditional formalism of statistical mechanics , we have constructed a set of equilibrium statistical ensembles of uncorrelated random networks and have found their partition functions and main characteristics . We have proposed a set of natural dynamical procedures , which generate equilibrium networks as a limiting state of the evolution , and have established a one - to - one correspondence between rules of these ergodic procedures and equilibrium ensembles of networks . This program has been realized both for directed and undirected networks . We have shown that a “scale - free” state ( and fat - tailed degree distributions ) in equilibrium uncorrelated networks without condensation of edges on vertices may exist only in a single marginal point . So , it is rather an exception [ 29 ] . This diﬀers crucially from the situation for growing networks . The latter , while growing , may self - organize into scale - free structures in a wide range of parameters without any condensation . In summary , we have developed a statistical physics approach to equilibrium random networks . S . N . D . thanks PRAXIS XXI ( Portugal ) for a research grant PRAXIS XXI / BCC / 16418 / 98 . S . N . D . and J . F . F . M . were partially supported by the project POCTI / 99 / FIS / 33141 . A . N . S . acknowledges the NATO program OUT - REACH for support . We also thank V . V . Bryksin , A . V . Goltsev , A . Krzywicki , and F . Slanina for useful discussions . APPENDIX A : STATISTICAL WEIGHTS FOR THE MICROCANONICAL ENSEMBLE Initially , we have N vertices ( “hedgehogs” ) with q i edges ( “halves” of edges , speaking more precisely ) protruding from an i - th one . Here we count the number of ways of connecting them in pairs to obtain a given graph with a given number of edges g ij between vertices i and j . For vertices with unit - length loops ( “tadpoles” ) we set g ii to be equal to twice the number of such loops . The number of ways to choose g i 1 , g i 2 , . . . g iN edges from q i = g i 1 + g i 2 + · · · + g iN ones , attached to the i - th vertex is q i ! g i 1 ! g i 2 ! · · · g iN ! . ( A1 ) Then we have to connect in pairs g ij dangling edges , attached to the i - th vertex , and g ji = g ij edges attached to the j 6 = i vertex . This can be done by g ij ! diﬀerent ways . Also , the number of ways to join g ii dangling edges in pairs to form g ii / 2 closed loops is ( g ii − 1 ) ( g ii − 3 ) · · · 1 = ( g ii − 1 ) ! ! . Finally , combining together N multiples ( A1 ) for each vertex , N ( N − 1 ) / 2 multiples g ij ! for each pair of vertices , multiples ( g ii − 1 ) ! ! for each vertex , containing unit - length loops , and taking into account that ( g ii − 1 ) ! ! / g ii ! = 1 / g ii ! ! , we arrive at Eq . ( 10 ) . APPENDIX B : INTEGRAL REPRESENTATION OF THE PARTITION FUNCTION FOR CANONICAL ENSEMBLE The partition function of the canonical ensemble is Z C ( N , L ) = N − L X g ∈ Ω ( N , L ) N Y i = 1 p ( q i ) g ii ! ! N Y j < k = 1 1 g jk ! , ( B1 ) where the set Ω ( N , L ) is a set of N 2 non - negative integers g ij ≥ 0 with the following properties : ( i ) g ii are even , ( ii ) g ij = g ji , and ( iii ) 11 1 2 N X i , j = 1 g ij = N X i = 1 g ii 2 + N X i > j = 1 g ij = L . ( B2 ) So , N ( N + 1 ) / 2 variables g ij , i ≥ j , are subjected to the restriction ( B2 ) . Introducing Φ ( x ) = ∞ X q = 0 p ( q ) q ! x q , ( B3 ) one can write Eq . ( B1 ) as Z C ( N , L ) = N − L X { g } ∈ Ω ( N , L ) N Y i = 1 h(cid:16) g ii 2 (cid:17) ! 2 g ii / 2 i − 1 (cid:18) ∂ 2 ∂x 2 i (cid:19) g ii / 2 N Y j < k = 1 ( g jk ! ) − 1 ∂ 2 ∂x j ∂x k N Y l = 1 Φ ( x l ) (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) x 1 = ··· = x N = 0 = ( 2 N ) − L L !   N X i = 1 ∂ 2 ∂x 2 i + 2 N X i > j = 1 ∂ 2 ∂x i ∂x j   L N Y l = 1 Φ ( x l ) (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) x 1 = ··· = x N = 0 = ( 2 N ) − L L ! N X i = 1 ∂ ∂x i ! 2 L N Y l = 1 Φ ( x l ) (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) x 1 = ··· = x N = 0 , ( B4 ) where the relation ( B2 ) was used . If we pass from x 1 , . . . , x N to a new set of variables : x = ( x 1 + · · · + x N ) / N , and diﬀerence variables y i = x i − x i + 1 , i = 1 , . . . , N − 1 , we have ∂ ∂x = N X i = 1 ∂x i ∂x ∂ ∂x i = N X i = 1 ∂ ∂x i . Then Z C ( N , L ) = ( 2 N ) − L L ! ∂ 2 L ∂x 2 L [ Φ ( x ) ] N (cid:12)(cid:12)(cid:12)(cid:12)(cid:12) x = 0 . ( B5 ) Finally , one can write Z C ( N , L ) = ( 2 N ) − L L ! ( 2 L ) ! I c dx 2 πi x − 2 L − 1 [ Φ ( x ) ] N , ( B6 ) which is exactly Eq . ( 26 ) . The contour c encircles the point x = 0 . APPENDIX C : EVOLUTION EQUATION FOR THE DEGREE DISTRIBUTION Here we present a simpliﬁed derivation of the evolution equation for the degree distribution Π ( q , t ) . For example , we consider a network with the rewiring of edges according to the rules formulated in Section III for the canonical ensemble ( for the grand canonical ensemble , the procedure is essentially the same ) . The total number of vertices , N , and of edges , L , are ﬁxed . With some probability n per unit time , a randomly chosen end of a randomly chosen edge is rewired to some vertex of the graph . This vertex is chosen from vertices of the graph with probability proportional to a given function f ( q i ) of the degree q i of the vertex . Then , the probability that a vertex i receives a new edge per time dt is f ( q i ) n dt P j f ( q j ) → nf ( q i ) Nf ( q ) . ( C1 ) 12 In Eq . ( C1 ) its left - hand side may be replaced with the right - hand side in the thermodynamic limit N → ∞ ( self - averaging ) if the ﬂuctuations of N ( q ) can be neglected . This is true for the equilibrium state ( see Eq . ( 19 ) ) , and so here we restrict ourselves to the nonequilibrium states that fulﬁll this condition . Then , the inﬁnitesimal change of the degree distribution due to the rewiring of edges to a chosen vertex is [ d Π ( q , t ) ] to = n Nf ( q ) [ f ( q − 1 ) Π ( q − 1 , t ) − f ( q ) Π ( q , t ) ] dt . ( C2 ) Also , we must take into account that the vertex may loose one of its q i edges , which will be rewired to another vertex . The probability nq i dt / L that one of these edges is chosen for rewiring per time dt , must be multiplied by 1 / 2 . This is the probability that of the two ends of the edge , the one attached to the i - th vertex , is chosen . Thus , the change of the degree distribution due to rewiring of edges from a vertex is [ d Π ( q , t ) ] from = n Nq [ ( q + 1 ) Π ( q + 1 , t ) − q Π ( q , t ) ] , ( C3 ) where ¯ q = 2 L / N is the average vertex degree . Combining Eqs . ( C2 ) and ( C3 ) we arrive at the evolution equation N n ∂ Π ( q , t ) ∂t = 1 f ( q ) [ f ( q − 1 ) Π ( q − 1 , t ) − f ( q ) Π ( q , t ) ] + 1 ¯ q [ ( q + 1 ) Π ( q + 1 , t ) − q Π ( q , t ) ] . ( C4 ) Looking for the stationary solution of Eq . ( C4 ) , one can easily ﬁnd its ﬁrst integral : q + 1 ¯ q Π ( q + 1 ) − f ( q ) f ( q ) Π ( q ) = const . ( C5 ) One must set const = 0 in Eq . ( C5 ) , because Π ( q ) = 0 at q < 0 . Then we have Π ( q + 1 ) = x s f ( q ) q + 1Π ( q ) , ( C6 ) where we have introduced x s = ¯ q / f ( q ) . The solution of Eq . ( C6 ) is Π ( q ) = C p ( q ) q ! x qs . ( C7 ) Here C and x s must be determined from the normalization condition and from the equality of the mean degree to a given value ¯ q = 2 L / N : ∞ X q = 0 Π ( q ) = 1 , ∞ X q = 0 q Π ( q ) = ¯ q . ( C8 ) ∗ E - mail address : sdorogov @ fc . up . pt † E - mail address : jfmendes @ ﬁs . ua . pt ‡ E - mail address : samukhin @ fc . up . pt [ 1 ] P . Erd¨os and A . R´enyi , Publ . Math . Debrecen 6 ( 1959 ) 290 ; Publ . Math . Inst . Hung . Acad . Sci . 5 ( 1960 ) 17 . [ 2 ] B . Ballob´as , Random Graphs , Academic Press , New York , 1985 . [ 3 ] A . Bekessy , P . Bekessy , and J . Komlos , Stud . Sci . Math . Hungar . 7 ( 1972 ) 343 ; E . A . Bender and E . R . Canﬁeld , J . Combi - natorial Theory A 24 ( 1978 ) 296 ; B . Ballob´as , Eur . J . Comb . 1 ( 1980 ) 311 ; N . C . Wormald , J . Combinatorial Theory B 31 ( 1981 ) 156 , 168 ; M . Molloy and B . Reed , Random Structures and Algorithms 6 ( 1995 ) 161 . [ 4 ] A . - L . Barab´asi and R . Albert , Science 286 ( 1999 ) 509 . [ 5 ] D . J . Watts , Small Worlds : The Dynamics of Networks between Order and Randomness , Princeton Univ . Press , Princeton , NJ , 1999 . [ 6 ] S . H . Strogatz , Nature 401 ( 2001 ) 268 . 13 [ 7 ] R . Albert and A . - L . Barab´asi , Rev . Mod . Phys . 47 ( 2002 ) 74 . [ 8 ] S . N . Dorogovtsev and J . F . F . Mendes , Adv . Phys . 51 ( 2002 ) 1079 . [ 9 ] S . N . Dorogovtsev and J . F . F . Mendes , Evolution of Networks : From Biological Nets to the Internet and WWW , Oxford Univ . Press , Oxford , 2003 , in press . [ 10 ] Notice that in graph theory , “random graphs” are usually networks with a Poisson distribution of connections . [ 11 ] Z . Burda , J . D . Correia , and A . Krzywicki , Phys . Rev . E 64 ( 2001 ) 046118 . [ 12 ] A . Krzywicki , cond - mat / 0110574 . [ 13 ] J . Berg and M . L´assig , cond - mat / 0205589 . [ 14 ] Z . Burda and A . Krzywicki , cond - mat / 0207020 . [ 15 ] P . Bialas , Z . Burda , and D . Johnston , Nucl . Phys . B 493 ( 1997 ) 505 ; Nucl . Phys . B 542 ( 1999 ) 413 . [ 16 ] J . Ambjørn , B . Durhuus , and T . J´onsson , Phys . Lett . B 244 ( 1990 ) 403 . [ 17 ] J . Ambjørn and J . Jurkiewicz , Nucl . Phys . B 451 ( 1995 ) 643 . [ 18 ] M . E . J . Newman , S . H . Strogatz , and D . J . Watts , Phys . Rev . E 64 ( 2001 ) 026118 . [ 19 ] To approach thermodynamic limit of the microcanonical ensemble , one may consider a sequence of microcanonical ensembles : P q N n ( q ) = N n → ∞ , N n ( q ) / N n → Π ( q ) as n → ∞ . Here Π ( q ) is the degree distribution . [ 20 ] R . Albert and A . - L . Barab´asi , Phys . Rev . Lett . 85 ( 2000 ) 5234 . [ 21 ] S . N . Dorogovtsev and J . F . F . Mendes , Europhys . Lett . 52 ( 2000 ) 33 . [ 22 ] P . L . Krapivsky , S . Redner , and F . Leyvraz , Phys . Rev . Lett . 85 ( 2000 ) 4629 ; P . L . Krapivsky and S . Redner , Phys . Rev . E 63 ( 2001 ) 066123 . [ 23 ] S . N . Dorogovtsev , J . F . F . Mendes , and A . N . Samukhin , Phys . Rev . Lett . 85 ( 2000 ) 4633 . [ 24 ] In the thermodynamic limit , this is equivalent to rewiring both the ends of a randomly chosen edge to vertices i and k at the rate f ( q i ) f ( q k ) . [ 25 ] A . N . Vasiliev , Functional Methods in Quantum Field Theory and Statistical Physics , Gordon & Breach , Amsterdam , 1998 . [ 26 ] Z . Burda , D . Johnston , J . Jurkiewicz , M . Kaminski , M . A . Nowak , G . Papp , and I . Zahed , Phys . Rev . E 65 ( 2002 ) 026102 . [ 27 ] In contrast , in growing networks , power - law degree distributions are realized in the case of any linear preference function f ( q ) . In growing networks , if f ( q ) ∼ q δ , δ < 1 , the distribution has a size - independent cutoﬀ ; if δ > 1 , a ﬁnite fraction of edges are attached to a single vertex [ 22 ] . [ 28 ] For such a condensation we do not need inhomogeneity of vertices unlike a condensation in inhomogeneous growing networks due to G . Bianconi and A . - L . Barab´asi , Phys . Rev . Lett . 86 ( 2001 ) 5632 . [ 29 ] Main analytical results on percolation and disease spread on scale - free networks were obtained just for these exceptional equilibrium uncorrelated scale - free nets without condensate . 14
Vol . 129 , JUNE 2007 Copyright © 2007 by ASME Transactions of the ASME [ DOI : 10 . 1115 / 1 . 2720924 ] Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm Contributed by the Bioengineering Division of ASME for publication in the J OUR - NAL OF B IOMECHANICAL E NGINEERING . Manuscript received June 12 , 2006 ; ﬁnal manu­ script received November 15 , 2006 . Review conducted by Clark T . Tung . Robust Strategies for Automated AFM Force Curve Analysis—I . Non - adhesive Indentation of Soft , Inhomogeneous Materials David C . Lin Laboratory of Integrative and Medical Biophysics , National Institutes of Health , 9 Memorial Drive , Bldg . 9 Rm . 1E118 , Bethesda , MD 20892 e - mail : lindavid @ mail . nih . gov Emilios K . Dimitriadis National Institute of Biomedical Imaging and Bioengineering , National Institutes of Health , 13 South Drive , Bldg . 13 Rm . 3N17 , Bethesda , MD 20892 e - mail : dimitria @ helix . nih . gov Ferenc Horkay Laboratory of Integrative and Medical Biophysics , National Institutes of Health , 13 South Drive , Bldg . 13 Rm . 3W16 , Bethesda , MD 20892 e - mail : horkay @ helix . nih . gov Abstract The atomic force microscope ( AFM ) has found wide applicability as a nanoindentation tool to measure local elastic properties of soft materials . An automated approach to the processing of AFM indentation data , namely , the extraction of Young’s modulus , is es­ sential to realizing the high - throughput potential of the instrument as an elasticity probe for typical soft materials that exhibit inhomogeneity at microscopic scales . This paper focuses on Hertzian analysis techniques , which are applicable to linear elastic indenta­ tion . We compiled a series of synergistic strategies into an algorithm that overcomes many of the complications that have previously impeded efforts to automate the ﬁtting of contact mechanics models to indentation data . AFM raster data sets containing up to 1024 individual force - displacement curves and macroscopic compression data were ob­ tained from testing polyvinyl alcohol gels of known composition . Local elastic properties of tissue - engineered cartilage were also measured by the AFM . All AFM data sets were processed using customized software based on the algorithm , and the extracted values of Young’s modulus were compared to those obtained by macroscopic testing . Accuracy of the technique was veriﬁed by the good agreement between values of Young’s modulus obtained by AFM and by direct compression of the synthetic gels . Validation of robust­ ness was achieved by successfully ﬁtting the vastly different types of force curves gener­ ated from the indentation of tissue - engineered cartilage . For AFM indentation data that are amenable to Hertzian analysis , the method presented here minimizes subjectivity in preprocessing and allows for improved consistency and minimized user intervention . Automated , large - scale analysis of indentation data holds tremendous potential in bioengineering applications , such as high - resolution elasticity mapping of natural and artiﬁcial tissues . Keywords : atomic force microscopy , contact mechanics , elasticity , indentation 430 / Introduction The atomic force microscope ( AFM ) has become ubiquitous in biomedical sciences as a tool for characterizing topographical and elastic properties of biological and synthetic materials . The small tip size and control of tip - sample interactions make it possible to image subnanometer features . Unlike electron microscopes , samples being imaged can be immersed in liquid ( e . g . , physiologi - cal salt solution ) , allowing biological specimens to be maintained at or near their native conditions . Investigators have taken advan­ tage of the force spectroscopy capabilities of the AFM , which has force sensitivity on the order of 10 pN , to probe the elasticity of materials that are very soft and exhibit inhomogeneity at micro - scopic scales and to study among many things , the stretching be­ havior of single molecules as well as inter - and intramolecular interactions ( see , e . g . , [ 1 – 7 ] ) . When the cantilever tip is used as a nanoindenter , the AFM is well suited for probing the local elasticity of small , very soft , and inhomogeneous samples . It has been used to study the elasticity of bacteria [ 8 ] , cells [ 9 – 12 ] , endothelia [ 13 ] , articular cartilage [ 14 – 16 ] , and bony tissue [ 17 ] . However , despite its advantages over more conventional testing methodologies , data processing issues hinder the consistency of elasticity measurements on soft biological tissues and preclude the use of the AFM in large - scale studies . Many of these issues are associated with the spatial vari­ ability of elastic properties and tip - sample interactions in micro - scopically inhomogeneous samples , which produce a diversity of force - displacement curves . A number of analysis techniques are utilized by investigators to identify the pertinent , linear elastic portion of each dataset and subsequently extract Young’s modulus by ﬁtting the data with a contact mechanics model [ 11 , 12 , 18 – 20 ] . However , attempts to automate these approaches have not proven to be successful in eliminating the need for subjective user input ( e . g . , specifying an estimate of the contact point based on visual inspection [ 19 ] or specifying the range of the noncontact region [ 11 ] ) or capable of accurately processing diverse populations of curves . We have compiled a collection of complementary strate­ gies that addresses the known issues in the analysis of AFM force curves , and implemented these strategies in a robust algorithm for extracting the elastic properties of soft , highly inhomogeneous tissue samples . These strategies allow automated analysis of large numbers of indentation datasets , thus offering a highly desirable tool for elasticity mapping of materials that exhibit inhomogeneity at microscopic scales . To validate the procedure , a comparison of results from AFM measurements and conventional macroscopic compression tests performed on polyvinyl alcohol ( PVA ) gels of known composition is presented . Additionally , tissue - engineered cartilage was probed at multiple locations along the surface to generate a set of visually distinct force curves consistent with the inhomogeneous nature of the biological tissue . This paper focuses on the analysis of indentation data that ex - hibit Hertzian behavior ( i . e . , linear elastic with negligible adhe­ 2 2 E a - b Journal of Biomechanical Engineering sive interactions , as in the approach curves of all experimental data sets presented ) . Extension of the strategies to non - Hertzian , adhesive contact [ 21 – 23 ] will be discussed in a separate paper . In the follwing sections , relevant force - indentation relationships de­ rived from contact mechanics theories are ﬁrst presented , fol­ lowed by a summary of existing approaches for extracting the elastic properties of the indented material . Essential features of a comprehensive strategy are then outlined and the scheme devised by the authors is introduced . Next , typical experimental results are presented and discussed . The signiﬁcance of a robust , automated procedure is reiterated in the concluding remarks . Theory Contact Mechanics Models . The classical problem of an elas­ tic half - space indented by a rigid object was ﬁrst treated by Hertz in 1881 and Boussinesq in 1885 [ 18 ] . Numerous others have con­ tributed to the theoretical framework , which is widely used in interpreting the results of indentation tests at all length scales . Exact solutions in the form of force - indentation relationships , contact pressure distributions , and stress and displacement ﬁelds exist for axisymmetric indenter geometries ( e . g . , cylinder , sphere , and cone ) . By necessity , approximate solutions are derived in the case of more complex geometries , such as the pyramid . Many solutions of interest in the indentation of linear elastic materials can be represented by the generalized force - indentation relation [ 19 , 24 ] , F = Ao f ( 1 ) where F is the force applied to the indenter and o is the indenta­ tion depth . The term A and exponent f are given in Table 1 for indenters that are spherical ( from the original Hertz theory of contact between two ellipsoidal bodies and oftentimes referred to as the Hertz equation or model ) , sharp conical [ 5 , 25 ] , or sharp - tipped pyramidal [ 26 ] in geometry . For typical tapered indenters with a blunt tip ( Fig . 1 ) , the relationship is [ 25 , 27 , 28 ] 3 R tan ¢ 3 R ( ) [ ] { F = a o − m − arcsin 1 − v 2 tan ¢ 2 a a 3 b a 2 − b 2 2 − b 2 ) 1 / 2 − + ( a m + ( 2 a ) [ ] } where 2 ¢ is the tip angle , b is the radius at which the tapered sides transition into a spherical tip of radius R , a is the contact radius , and the constant m has different values for the cone ( = 1 2 ) and the pyramid ( = 2 1 / 2 / - ) . When o < b 2 / R , the Hertz model ap­ plies . The contact radius is related to the indentation depth by a 2 − b 2 ) 1 / 2 − a ] − n a - b o + [ ( a − arcsin = 0 ( 2 b ) [ ( ) ] R tan ¢ 2 a with n = 1 for the cone and n = 2 3 / 2 / - for the pyramid . The sharp - tipped models are recovered when R = b = 0 while the limiting case of R → o yields the solutions for truncated tips . Note that since a circle is used to approximate the area of contact of the pyramid in Eqs . ( 2 a ) and ( 2 b ) , reduction to the sharp - tipped model produces results that differ slightly from the Bilodeau solution , which as­ sumes a realistic square contact region ( see Table 1 ) . Table 1 Terms of the generalized form of the force - indentation relation for various models Model A f Hertz : sphere of radius R 4 ER 1 / 2 3 ( 1− v 2 ) 3 / 2 Sharp cone of tip angle 2 ¢ ( see Fig . 1 ) 2 E tan ¢ - ( 1− v 2 ) 2 Sharp pyramid of tip angle 2 ¢ ( see Fig . 1 ) : Bilodeau solution [ 26 ] : 1 . 4906 E tan ¢ 2 ( 1− v 2 ) 2 Rico et al . solution [ 28 ] : E tan ¢ 2 1 / 2 ( 1− v 2 ) 2 v is Poisson’s ratio and E is Young’s modulus Fig . 1 Blunt and sharp tips of the same tip angle . Both conical and pyramidal tips are shown . Radius a is the contact radius and c is the indentation radius . The blunt tips transition at ra­ dius or half - width b to a round tip with radius R . The incline angle of the faces of the pyramid is represented by 8 . Equations ( 1 ) and ( 2 ) describe what is commonly referred to as Hertzian indentation in which the interaction between tip and sample is due solely to the externally applied force . When signiﬁ­ cant adhesive forces exist between the contacting solids , they must be accounted for . Adhesive contact mechanics models will be discussed in a separate paper ( Part II ) [ 29 ] . Basic Approaches to Extracting Elastic Properties From AFM Data . Indentation is performed by moving the cantilever in the direction perpendicular to the sample surface , z , between a starting position , z = 0 , and an end position , z = z max . Regardless of tip geometry , the force of indentation is related to the stiffness and motion of the cantilever by F = k c ( d − d 0 ) ( 3 ) where k c is the spring constant of the cantilever , d is the measured deﬂection , and d 0 is the deﬂection offset at the point of contact between the indenter and the sample where the force is zero . The indentation depth o is therefore given by o = ( z − z 0 ) − ( d − d 0 ) = ( z − d ) − ( z 0 − d 0 ) = w − w 0 ( 4 ) where z 0 is the translation of the cantilever at the contact point . The transformed variable w = z − d ( computed from the raw , d ver­ sus z , data ) and its value at the contact point , w 0 , are introduced for simpliﬁcation [ 18 ] . Together with Eqs . ( 1 ) or ( 2 ) , Eqs . ( 3 ) and ( 4 ) allow ﬁtting of contact mechanics models to AFM indentation data . The simplest ﬁtting approach is to select the contact point ( z 0 , d 0 ) by visually inspecting the force - displacement curve . The portion of the data representing the noncontact region is then dis­ carded and regression analysis is used to ﬁt the data ( z , d ) with the appropriate contact mechanics model to obtain the value of Young’s modulus . Alternatively , a Young’s modulus value can be calculated for each point in the indentation region [ 18 ] . The point - wise calculations of E will tend toward a constant value that is dependent on the chosen contact point . Typically , Poisson’s ratio is assumed to be 0 . 5 for soft , gel - like materials [ 5 , 20 , 30 ] . To avoid uncertainties about the compressibility of the sample , some re­ searchers deﬁne an elastic constant incorporating the terms E and ( 1− v 2 ) , thereby combining the linear elastic and compressibility properties of the sample into a single material constant [ 31 – 33 ] . JUNE 2007 , Vol . 129 / 431 Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm Objective Schemes for Extracting Elastic Properties . A - Hassan et al . introduced an automated , contact point indepen­ dent technique to generate relative elasticity maps by showing that the relative work of indentation at some force is proportional to the relative measure of stiffness [ 31 ] . However , an absolute mea­ sure of elastic properties requires ﬁtting of force - indentation data to contact mechanics models . Since both F and o are dependent on the contact point , objective approaches to optimally estimating the contact point are necessary ; the features of a number of these techniques are summarized in Table 2 and discussed below . Table 2 Strategies for objectively extracting linear elastic properties from AFM data Method Description Deﬁciencies Constrained sequential search [ 18 ] Fit contact model to each ( z , d ) pair and select best ﬁt Fitting parameters : E Contact point may not be located on curve Contact point must lie within ramp Semi - constrained sequential search Similar to sequential search , but only z coordinate is speciﬁed at each iteration Fitting parameters : E , d 0 Contact point must lie within ramp Unconstrained sequential search Similar to sequential search , but the ﬁrst ( z , d ) pair in each iteration is input as the initial guess Fitting parameters : E , z 0 , d 0 Contact point must lie within ramp Extrapolation of ﬁrst derivative of cantilever deﬂection [ 12 ] Contact is assumed to occur when the change in deﬂection with respect to piezoposition is zero Fitting parameters : E Extrapolation may not be precise if derivative is not well behaved in the contact region For spherical indenters , ﬁtting of derivative requires very good initial estimates of parameters Derivatives of cantilever deﬂection [ 20 ] Initial contact occurs at maximum change in deﬂection with respect to piezoposition Fitting parameters : E Large uncertainties when signal - to­ noise is high or when sample is soft Contact point may not be located on curve Contact point must lie within ramp Average deﬂection in noncontact region [ 11 ] Set d 0 equal to the average value of d in the noncontact region Fitting parameters : E , z 0 Need to identify noncontact region Large uncertainties when signal - to­ noise is high or when sample is soft Contact point must lie within ramp Power series correction [ 19 ] / Taylor series expansion Contact model is expanded in a two - term power series about an arbitrary point in the vicinity of the contact point Fitting parameters : E , d 0 Ambiguity and subjectivity in the selection of assumed contact point Inclusion of data from noncontact region will bias results Note : The ﬁrst four strategies are most amenable to automation . The ﬁrst two strategies form the basis of our comprehensive scheme . One type of approach restricts the contact point to be a member of the dataset and henceforth will be referred to as the constrained approach . Nyland and Maughan [ 20 ] devised a method using the ﬁrst and second derivatives of the cantilever deﬂection with re­ spect to the piezodisplacement . After smoothing the data curve , the data point corresponding to the maximum value of the second derivative or to the extrapolated point of zero ﬁrst derivative is chosen as ( z 0 , d 0 ) . For probing very soft materials in which the cantilever deﬂection is small , even small levels of noise can greatly affect calculations of the derivatives and introduce large errors . Hence , the second derivative method is limited in its applicability . In sequential or linear search schemes , the candidate contact point is marched ( either directly or indirectly , depending on the variation ) along the force - displacement curve . The point that pro­ duces the best least - squares ﬁt of the indentation data is selected as the solution . Note that the derivative and visual inspection methods generate comparatively poorer ﬁts because the contact point in those noniterative methods is determined without consid­ ering its effect on the quality of ﬁt . We have identiﬁed three varia­ tions of sequential search ( see the ﬁrst three entries in Table 2 ) . The constrained variation is best suited for data with low levels of noise because it selects the contact point from among the collected dataset . No probe - sample long - range interactions are assumed to exist . Dimitriadis et al . [ 18 ] employed this variant to demonstrate that selection of the contact point by subjective visual inspection produces ﬁts that may differ signiﬁcantly from those obtained by objectively selecting the best contact point through a methodical search procedure . In the semi - constrained variation of sequential search , the z coordinate at each iteration is chosen from the acquired z - position vector and the corresponding d 0 along with E are the ﬁtting pa­ rameters . Finally , neither z 0 nor d 0 is ﬁxed in the unconstrained variant of the ﬁtting procedure . Rather , the ( z , d ) pair is used as the initial guess in the regression analysis . In a noniterative scheme proposed by Radmacher [ 11 ] , d 0 is estimated by averag­ ing the range of d values over the noncontact region , leaving z 0 and Young’s modulus E as the ﬁtting parameters . This approach can be considered the semi - constrained counterpart to the visual inspection method and is likewise prone to error when noise levels are high . Kolambkar [ 19 ] formulated a more rigorous unconstrained ap­ proach by evaluating the error associated with assuming an incor­ rect contact point . He expanded the resulting force - indentation relation in a power series in ( d 1 − d 0 ) , where d 1 is the d coordinate of the assumed contact point ( z 1 , d 1 ) chosen from within the neighborhood of the contact point . We developed a variation of Kolambkar’s scheme with less ambiguity in the selection of ( z 1 , d 1 ) by making use of the transformed variable w and expand­ ing the generalized equation in a Taylor series about some value of cantilever deﬂection d 1 arbitrarily chosen from the contact re­ gion . A major disadvantage of the power series methods is that they are extremely sensitive to the inclusion of data from the noncontact region ( i . e . , attempting to ﬁt contact mechanics models to a data set that contains a substantial number of points from the noncontact region will weaken the ﬁt of the contact portion ) . Up to this point , the methods discussed all require the contact 432 / Vol . 129 , JUNE 2007 Transactions of the ASME Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm point to be bracketed by the endpoints of the dataset ( i . e . , 0 < z 0 < z max ) . In certain instances , however , the contact point may not even be captured within the data set or may be situated in a por­ tion of the data that exhibits non - Hertzian behavior . The former condition is most likely to occur in the indentation of very soft materials ( Young’s modulus < 1 kPa ) , where the cantilever deﬂec­ tion at the onset of contact may not be discernible from the real - time deﬂection versus piezodisplacement ( d versus z ) plot . Con­ sequently , it may be difﬁcult to determine an appropriate ramp starting position that brackets the contact point . The latter condi­ tion is usually attributable to the existence of tip - sample interac­ tions ; it is necessary here to make a distinction between adhesive and nonadhesive interactions . Adhesive interaction is easily iden­ tiﬁed by a decrease or dip in cantilever deﬂection from the equi­ librium , zero - load position as the tip approaches the surface of the sample ( i . e . , the direction of deﬂection is opposite that during indentation ; see curve “d” in Fig . 2 ) . In the forthcoming paper , various models of adhesive contact will be examined . Large , non­ adhesive tip - sample interactions present an ill - deﬁned complication—the contact point may be situated in a portion of the curve that exhibits nonlinearity , as shown by curve “c” in Fig . 2 . Elimination of such data ( e . g . , by truncating the dataset at the inﬂection point ) may result in the exclusion of the contact point from the retained data set . We now introduce a rearward search scheme that allows accurate ﬁtting of such previously intractable data sets . The method is essentially a semi - constrained sequential search using smoothed data to minimize the effect of noise . At each step , the value of the assumed z 0 from the previous iteration is decremented by the z spacing in the original data . The search is halted once no further improvement to the least - squares ﬁt of the retained data is detected . Fig . 2 „ a … – „ c … : Force curves „ open diamonds … , best - ﬁt curves „ solid lines … and corresponding plots of the MSE as a function of position of the assumed contact point . Three separate indentations of cartilage specimens are presented . The portion of each curve bracketed by the D symbols is the linearly elastic region identiﬁed during data preprocessing . For ease of visualization , curves were shifted vertically with no effect on the solutions . When the contact point „ indicated by • … lies within the range of the retained data , the MSE plot is unimodal „ curves “a” and “b” … . When the contact point lies outside the range of the retained data , the MSE plot does not have a global minimum ; in this example „ curve “c” … , tip - sample interactions „ not adhesive in nature … obscured the location of the contact point by distorting the initial contact portion of the force curve . The inset in the large plot shows the ﬁrst , second , and third derivatives of deﬂection d with respect to w for curve “c . ” Each deriva­ tive is normalized such that the difference between the maximum and minimum value is one . The cutoff point „ f f = 0 and f f > 0 … is indicated by • . „ d … : A representative force - displacement curve showing signiﬁcant adhesive interactions . Jaasma et al . [ 12 ] formulated a derivative - based approach that removes the need for subjective input and serves as a good alter­ native to the search strategies under certain conditions . This method differs from that of Nyland and Maughan [ 20 ] in that the solution is derived by evaluating data from the contact region , thereby eliminating bias from the high levels of noise and nonlin­ earity commonly observed in the vicinity of the contact point . The method is discussed in greater detail in Appendix A . Integration of Strategies for Automation . Using a single ob­ jective approach in an automated ﬁtting routine will not consis­ tently produce acceptable results because each approach has deﬁ­ ciencies with respect to certain types of data sets . The basic requirement of a comprehensive scheme for extracting elastic properties from indentation data is the capability to accurately process the data regardless of whether the contact point is situated within the retained dataset . Hence , at least one of the objective approaches in Table 2 should be integrated with the rearward search method . There is wide latitude in the choice and sequence of the methods incorporated into the comprehensive scheme . However , we eliminated the power - series methods despite their requirement of only a single function evaluation because of the inaccuracy associated with including points from the noncontact Journal of Biomechanical Engineering JUNE 2007 , Vol . 129 / 433 Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm region . We also chose to exclude the ﬁrst derivative extrapolation method because of the difﬁculties in applying it in conjunction with the Hertz equation ( discussed in Appendix A ) . The sequential search methods are ideally suited for automation because they eliminate the need for subjective user intervention . Discussed brieﬂy in the next paragraph are the particularities of each variant that should be considered in their integration into a comprehen­ sive strategy . As with all methods that restrict the contact point to the set of the collected data points , the constrained sequential search ap­ proach is greatly inﬂuenced by noise . When signiﬁcant noise or long - range probe - sample interactions are present , the contact point may lie some distance away from the collected data points ; constraining the solution to the dataset may produce large errors . This variant is therefore suitable for locating the vicinity of the contact point . The unconstrained and semi - constrained search strategies provide improved accuracy at the expense of increased complexity associated with greater numbers of ﬁtting parameters . The semi - constrained approach is preferred because it is less com­ putationally intensive . Based on the level of noise in the data , one may choose to impose lower and upper bounds in the formulation of the semi - constrained problem to limit the deviation of the con­ tact point from the data . However , the chief advantage of applying the semi - constrained method without bounds is that it is amenable to efﬁcient search techniques ( e . g . , the Golden Section search ) . We elected to implement the bounded method in our comprehen­ sive strategy for this reason . Design of Algorithm for Extraction of Young’s Modulus . De­ tailed in this section is the integrative strategy we developed with the goal of maximizing computational efﬁciency in the analysis of large collections of indentation datasets ( up to 1024 force - displacement curves in a single collection ) . The algorithm , which is represented by the ﬂowchart in Fig . 3 , has been implemented in Mathematica ( Wolfram Research , Champaign , IL ) and MATLAB ( MathWorks , Natick , MA ) , and includes routines for data prepro­ cessing and addressing uncertainties in tip geometry . Fig . 3 Flowchart representation of the algorithm START I Linear search for best aggregate fit of line and Hertz - type power law . Common point denoted by ( w * , (cid:71)(cid:13)(cid:12)(cid:17)(cid:3) (cid:36)(cid:71)(cid:75)(cid:72)(cid:86)(cid:76)(cid:89)(cid:72)(cid:3)(cid:68)(cid:81)(cid:68)(cid:79)(cid:92)(cid:86)(cid:76)(cid:86) (cid:39)(cid:68)(cid:87)(cid:68)(cid:3)(cid:86)(cid:80)(cid:82)(cid:82)(cid:87)(cid:75)(cid:76)(cid:81)(cid:74)(cid:29)(cid:3)(cid:70)(cid:88)(cid:69)(cid:76)(cid:70)(cid:3)(cid:86)(cid:83)(cid:79)(cid:76)(cid:81)(cid:72)(cid:3) fit (cid:82)(cid:73)(cid:3)(cid:71)(cid:68)(cid:87)(cid:68)(cid:3)(cid:83)(cid:82)(cid:76)(cid:81)(cid:87)(cid:86)(cid:3)(cid:86)(cid:83)(cid:68)(cid:70)(cid:72)(cid:71)(cid:3)(cid:68)(cid:87)(cid:3) (cid:72)(cid:89)(cid:72)(cid:85)(cid:92)(cid:3)(cid:24)(cid:8)(cid:3)(cid:82)(cid:73)(cid:3)(cid:87)(cid:82)(cid:87)(cid:68)(cid:79)(cid:3)(cid:83)(cid:82)(cid:76)(cid:81)(cid:87)(cid:86)(cid:17) (cid:38)(cid:68)(cid:79)(cid:70)(cid:88)(cid:79)(cid:68)(cid:87)(cid:72)(cid:3)(cid:73)(cid:76)(cid:85)(cid:86)(cid:87)(cid:3)(cid:87)(cid:75)(cid:85)(cid:82)(cid:88)(cid:74)(cid:75)(cid:3)(cid:87)(cid:75)(cid:76)(cid:85)(cid:71)(cid:3)(cid:71)(cid:72)(cid:85)(cid:76)(cid:89)(cid:68)(cid:87)(cid:76)(cid:89)(cid:72)(cid:86)(cid:3)(cid:82)(cid:73)(cid:3)(cid:86)(cid:80)(cid:82)(cid:82)(cid:87)(cid:75)(cid:72)(cid:71)(cid:3)(cid:70)(cid:88)(cid:85)(cid:89)(cid:72)(cid:17) (cid:44)(cid:71)(cid:72)(cid:81)(cid:87)(cid:76)(cid:73)(cid:92)(cid:3)(cid:76)(cid:81)(cid:73)(cid:79)(cid:72)(cid:70)(cid:87)(cid:76)(cid:82)(cid:81)(cid:86)(cid:29)(cid:3)(cid:73)(cid:76)(cid:85)(cid:86)(cid:87)(cid:3)(cid:68)(cid:81)(cid:71)(cid:3)(cid:79)(cid:68)(cid:86)(cid:87)(cid:3)(cid:83)(cid:82)(cid:76)(cid:81)(cid:87)(cid:86)(cid:3)(cid:73)(cid:82)(cid:85)(cid:3)(cid:90)(cid:75)(cid:76)(cid:70)(cid:75)(cid:3) (cid:71) (cid:71)(cid:76)(cid:3) (cid:3) dz 2 = ( (cid:19)(cid:3)(cid:68)(cid:81)(cid:71)(cid:3) dddd (cid:33)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19) (cid:38)(cid:82)(cid:80)(cid:83)(cid:88)(cid:87)(cid:72)(cid:3)(cid:11)(cid:53)(cid:48)(cid:54)(cid:40)(cid:12)(cid:15)(cid:86)(cid:80)(cid:82)(cid:82)(cid:87)(cid:75)(cid:257)(cid:3)(cid:54)(cid:72)(cid:87)(cid:3)(cid:71)(cid:76)(cid:86)(cid:87)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3)(cid:87)(cid:82)(cid:79)(cid:72)(cid:85)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3) Dd max - ± ( RMSE ) smooth· Apply unbounded , semi - constrained fit to first point and a point offset slightly . Unbounded , semi - constrained , Golden Section search . Bounded , semi - constrained search . Rearwards search . A cursory ﬁtting process using the following steps is ﬁrst per­ formed to determine whether signiﬁcant adhesive interactions are present : 1 . Marching along the data set , the initial portion ( assumed noncontact region ) is ﬁt with a line while the latter portion is ﬁt with a power function of the form ( i ) ) 3 / 2 d = d ( i ) + b ( w − w ( 3 ' ) where b is the lone ﬁtting parameter , i is the current itera­ tion , and the exponent of 3 / 2 is characteristic of Hertzian indentation with a rigid sphere ( Table 1 ) . Hence , ( w ( i ) , d ( i ) ) takes on all values between the ﬁrst ( i = 1 ) and last points . In the adopted convention , the last point refers to the point of maximum indentation , regardless of whether extension or retraction data are considered . 2 . At each iteration , an aggregate mean square error ( MSE ) is calculated , with the contribution from the nonlinear ﬁt given greater weight to offset the typically low MSE values from the zero - force , noncontact region . In most cases , multiplying the MSE of the nonlinear ﬁt by a factor of 2 is sufﬁcient . However , if the noncontact region comprises a dispropor­ tionately large segment of the data , a larger factor ( e . g . , 10 ) is necessary to identify the best ﬁt to the contact region . The linear ﬁt associated with the lowest aggregate MSE is used as the preliminary check for the presence of adhesive forces—a negative slope using either factor indicates that such interactions are potentially present . If the slopes using both factors are positive , Hertzian analysis is applied and the ( w ( i ) , d ( i ) ) pair corresponding to the lowest MSE , denoted ( w * , d * ) , is used as an approximate contact point to calculate the strain at maximum indentation . It is necessary to employ the Johnson - Kendall - Roberts ( JKR ) and associated adhesive contact models [ 21 – 23 ] if the slopes are negative . 434 / Vol . 129 , JUNE 2007 If Hertzian analysis is applicable , data preprocessing is carried out to identify and trim spurious portions of the curves . A smooth­ ing operation is performed by ﬁtting cubic splines to a subset of the complete dataset ( e . g . , we use a spacing of 5 % of the total number of points ) . Alternative smoothing methods ( e . g . , low - pass ﬁltering ) may be applied . From the smoothed curve , ﬁrst order ( a d / a w ) through third - order derivatives are obtained . Inﬂection points are then identiﬁed by evaluating second and third deriva­ tives along the curve ( e . g . , zeros of the second derivative with a corresponding positive third derivative is an upturn in the curve ; see inset to the large plot in Fig . 2 ) . Convex inﬂections near the beginning of the curve ( e . g . , curve “c” in Fig . 2 ) are indicative of nonadhesive tip - sample interactions . Costa and Yin have shown numerically that solutions derived using linear elasticity theory produce large errors when applied to materials that exhibit non­ linear behavior [ 25 ] . The preprocessing step is therefore also nec­ essary to identify and remove contributions from such nonlinear effects . Nonlinearities may appear after some depth of indentation due to experimental factors ( e . g . , use of a cantilever of insufﬁcient stiffness , sample defects , such as rigid inclusions , and contribution from the underlying substrate caused by small sample thickness ) ; their existence is conﬁrmed by an inﬂection near the point of maximum cantilever deﬂection . After truncating the data set , non­ linearities caused by material - dependent phenomenon , such as Transactions of the ASME Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm strain hardening and softening may still exist . If the strain thresh­ old at which the linear assumption breaks down is known , it can be used to further limit the range of data to be analyzed . For a spherical indenter of radius R , the normal strain s zz is [ 18 ] 2 a s zz = ( 5 ) - R ( 1 − v ) where the contact radius a is equal to ( R o ) 1 / 2 and the approximate indentation is o = w − w * . The position w lim at which the speciﬁed strain limit s lim occurs is therefore [ ] 2 - s lim R 1 / 2 ( 1 − v ) w lim = w * + ( 6 ) 2 In the ﬁnal preprocessing step , the level of noise in the data is determined by computing the root - mean - square error ( RMSE ) of the smoothed ﬁt . This value , which we denote by ( RMSE ) smooth is used to deﬁne the distance tolerance , i . e . , set an upper bound of allowable deviation of the contact point from the original data curve . In the algorithm , the difference in cantilever deﬂection be­ tween the contact point and the curve ( 1 d ) is computed , with the tolerance set to 1 d max = ± ( RMSE ) smooth . Following preprocessing , the unbounded , semi - constrained se­ quential search procedure is implemented . Using the MSE as a measure of goodness of ﬁt , points from the beginning of the re­ tained data to the current assumed contact point are ﬁtted with a straight line while the remaining points are ﬁtted with the appro­ priate contact model . The linear ﬁt is necessary to maintain con­ sistency in the total number of data points ; goodness - of - ﬁt mea­ sures are prone to improve as the size of the dataset decreases . We ﬁrst determine the existence of a viable solution ( i . e . , whether the contact point is bracketed by the endpoints of the data set ) . If a viable solution exists ( condition 1 ) , the MSE is a well - behaved , unimodal function of the assumed z 0 ( see curves “a” and “b” Fig . 2 ) . Otherwise , the MSE demonstrates an initially increasing trend with the assumed z 0 ( condition 2 ; curve “c” in Fig . 2 ) . This latter condition is exploited in the evaluation by comparing the MSE at the ﬁrst point and a point offset from it by a small distance . It is important to note that the well - behaved manner in which the MSE varies with the assumed z 0 is characteristic of the un­ bounded semi - constrained search method , making it the method of choice when computational efﬁciency is desired . Under condi­ tion 1 of this implementation , a Golden Section search is applied to ﬁnd a viable solution ( E 0 , z 0 , d 0 ) . If the contact point does not exceed the distance tolerance , no further processing is necessary . Otherwise , a bounded semi - constrained search is performed in the vicinity of z 0 . We ﬁnd for our data that a spread of roughly 200 nm centered about z 0 is sufﬁcient . The range of d 0 at each iteration is limited to ( d − 1 d max < d 0 < d + 1 d max ) . Imposing bounds on the deviation of the contact point further ensures accu­ racy in the force - indentation behavior ( i . e . , when the deviation of the contact point from the data curve is small , there will be virtu­ ally no indentation force at the onset of contact ) . Under condition 2 , the rearward search is invoked . The ﬁrst local minimum in MSE encountered during the search procedure is the solution . A detail worthy of mention is that in rare cases , the contact point lies so far outside the range of the retained data that the MSE function becomes unimodal . We detect such instances by comparing the MSE of solution returned by the Golden Section or bounded semi - constrained search to that of the smoothed ﬁt . If the former value exceeds the latter by a large margin ( � 1 . 5 times ) , the rearwards search is executed . The steps outlined above are also applicable to blunt conical and pyramidal indenters . Following the procedure set forth in Ap­ pendix B , the data is ﬁrst ﬁt to a generalized quadratic equation . The corresponding sharp tip model can then be used to approxi­ mate the elastic properties of the sample . Journal of Biomechanical Engineering Materials and Methods Preparation of PVA Gels . PVA gels were prepared by ﬁrst dissolving 56 g of PVA ( molecular weight 70 , 000 – 100 , 000 ; Sigma ) in 344 ml of deionized water at 99°C . The ﬁnal concen­ tration of the stock solution was 14 % ( w / w ) . Gels were made by crosslinking the PVA in aqueous solution with glutaraldehyde ( GDA ) at pH � 1 . 5 . The pH was adjusted by HCl . To create samples of increasing stiffness , the PVA concentration was in­ creased while maintaining a constant crosslink density ( one unit of GDA per 100 units of vinyl alcohol ) [ 34 ] . Gel cylinders and thick layers ( 2 mm to > 1 cm ) with ﬁnal PVA concentrations of 3 % , 6 % , 9 % , and 12 % ( w / w ) were cast in molds ( 1 cm diam and 1 cm high ) and 35 mm Petri dishes , respectively . All samples were stored in deionized water until testing . Direct Compression Test of PVA Cylinders . A texture analy­ ser bench top materials testing system ( Stable Micro Systems , UK ) was used to perform load - controlled compression of the gel cylinders at a ramp speed of 1 mm / s . For all samples ( at least three of each concentration ) , the shear modulus was determined from the rubber elasticity equation [ 35 , 36 ] u = G ( A − A −2 ) ( 7 ) where u is the normal component of the engineering , or nominal , stress ( force per undeformed area ) ; G is the shear modulus ; and A is the deformation ratio ( = L / L 0 , where L and L 0 are the deformed and undeformed lengths , respectively ) . The undeformed dimen­ sions of each cylinder were measured using a micrometer . The absence of volume change and barreling during the compression measurements was checked . Preparation of Tissue - Engineered Cartilage Specimens . De­ tails on the growth of cartilaginous tissue from chondrocytes iso­ lated from chick embryo sternum have been described previously by Horkay et al . [ 37 ] . Brieﬂy , the chondrocytes were seeded on PVA disks ( 25 mm diam and 2 mm thick ) and cultured for dura­ tions of up to 30 days . The tissue layer was removed from the surface of the PVA gel at the end of the culture period and sec­ tioned transversely . Thin ( � 1 mm ) pieces of tissue were glued to glass cover slips using a cyanoacrylate adhesive ( Loctite , Rocky Hill , CT ) , with the sectioned surface exposed . The specimens were stored at 0°C until testing . AFM Nanoindentation of PVA Films and Cartilage Specimens . Nanoindentation of samples was performed using a commercial AFM ( Bioscope I with a Nanoscope IIIA controller , Veeco Instruments , Santa Barbara , CA ) seated atop an inverted optical microscope . General purpose , oxide - sharpened silicon ni­ tride tips with square pyramidal geometry , incline angles of 55 deg ( see Fig . 1 ) , and 10 nm nominal tip radius were used ( model DNP - S , Veeco ) . The cantilevers were modiﬁed by gluing either a 9 . 6 µ m dia polystyrene bead or a 5 . 5 µ m dia glass bead near the tip . The 3 % gel required a much more compliant canti­ lever ( 0 . 06 N / m nominal spring constant ) than the other gels ( 0 . 58 N / m nominal spring constant ) . The spring constant of each cantilever was determined using the thermal tune method [ 38 , 39 ] . The algorithm outlined previously was used to extract Young’s modulus from each dataset . Multiple force curves for each PVA ﬁlm were collected using the “force - volume” mode of the AFM . In this automated raster scanning method , the user deﬁnes the size of the square region to be scanned , the resolution , and the relative trigger threshold ( i . e . , the maximum cantilever deﬂection ) . Because the gels were as­ sumed to be relatively homogeneous , the resolution was set to the lowest limit of 16 X 16 indentations covering a 20 µ m X 20 µ m region . Relative trigger thresholds were set to either 100 nm or 50 nm . For each sample , at least two regions spaced over 1 cm apart were scanned . The 9 % gel was chosen to test the high - resolution force - volume scanning capability of the instrument ; JUNE 2007 , Vol . 129 / 435 Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm one of the scans was set to a resolution of 32 X 32 indentations covering a region of 50 µ m X 50 µ m . To avoid problems that may be caused by deviations of the sample surface from the horizontal , we set the ramp size to the maximum allowed by each piezoscan­ ner . This ensured that the tip was fully clear of the surface follow­ ing the last indentation of a raster line and as it was moved 20 µ m or 50 µ m to the beginning of the next line . Cartilage samples were equilibrated to room temperature and allowed to swell to equilibrium in phosphate - buffered saline ( pH 7 . 4 ) . Indentations were performed along a linear direction by off­ setting the tip successively by 2 . 5 µ m to 5 µ m . The ramp size and start position were adjusted as necessary to accommodate changes in topography and load - deﬂection behavior . Results and Discussion Results of the macroscopic compression and AFM nanoinden­ tation tests on the PVA gels shown in Fig . 4 demonstrate reason­ able agreement across a broad range of mechanical compliances equivalent to that found in soft biological tissues . It is obvious from Fig . 4 that an initial polymer content of 3 % is close to the gelation threshold of this system . Furthermore , the nonlinear scal­ ing of Young’s modulus with the polymer content is attributable to the increased amount of entanglements frozen into the network as more polymer chains are introduced . In the cylindrical samples of the 6 % , 9 % , and 12 % gels , no corrections for the end conditions were deemed necessary because no barrel distortion was ob­ served . However , the 3 % gels were not self - supporting , with sig­ niﬁcant compression even in the absence of an external load ; stresses and deformation ratios were therefore calculated from es­ timated dimensions . Hence , the accuracy of the macroscopic test results for the 3 % gels are suspect because of uncertainties in the end conditions and undeformed dimensions . In contrast , nanoin­ dentation of the samples posed no untoward difﬁculties , making the AFM a good alternative for measuring the bulk elastic prop­ erties of very soft materials . Fig . 4 Results of macroscopic compression and AFM indenta­ tion tests on PVA gels . Due to the large difference in sample size between AFM and macroscopic measurements , error bars show standard deviation rather than standard error . Inset shows data for the 3 % gel in larger scale . Large strain AFM values were obtained by including points up to maximum in­ dentation . Small strain values were obtained by truncating the data at È 20 – 25 % strain . In the analysis of the AFM data , the PVA gels were assumed to be incompressible based on experimental results reported in the literature ( v slightly < 0 . 5 for PVA swollen in water ) [ 40 ] and on generally accepted macroscopic properties of rubberlike materials [ 41 ] . Likewise , the cartilage samples were assumed to be incom­ pressible under the test conditions because each indentation oc­ curred too rapidly for liquid to be forced from the specimens ; Mow et al . found the instantaneous Poisson’s ratio of articular cartilage to indeed be 0 . 5 [ 42 ] . Indentation results for the cartilage specimens are plotted as a function of probe position in Fig . 5 . Fig . 5 Sample plot of Young’s modulus of tissue - engineered cartilage as a function of position along a line . Points were spaced È 2 . 5 � m apart . Regions of very low stiffness most likely are chondrocytes . Insets show sample curve ﬁts . Adhesive tip - sample interactions were observed in many in­ stances as the AFM tip was retracted . Hence , tip retraction data for the PVA gels and cartilage specimens are not presented here . As alluded to in prior sections , analysis of such curves requires non - Hertzian models and will be discussed in detail in a later paper . The applicability of linear elastic models to biological tissues and cells is an unresolved issue in AFM nanoindentation . Clearly , large strains are capable of causing substantial deviations from linear behavior [ 18 ] although the existence and limit of the linear regime is intrinsic to the probed material . In the PVA gels , maxi­ mum strains approaching 50 % were attained with no visually de­ tectable detriment to the quality of the Hertzian ﬁts . However , limiting the strains to 20 – 25 % resulted in a decrease in the average Young’s modulus ( for the results plotted in Fig . 4 , the overall decrease was 12 % ) as well as the MSE ( overall decrease of 66 % , due to a large reduction in the number of data points ﬁtted ) , revealing the existence of strain stiffening . The increase in the standard deviations of Young’s modulus can be ascribed to the loss in resolution due to truncation of a signiﬁcant portion of each 436 / Vol . 129 , JUNE 2007 Transactions of the ASME Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm data set . When the indentation depth at which the linear assump­ tion becomes invalid is unknown , it is therefore judicious to per­ form a preliminary analysis to establish a baseline of cantilever deﬂection in order to prevent excessive truncation . Maximum strains in the cartilage datasets were all < 30 % , and no truncation was performed based on the MSE values . Differences of 15 % were found in the two sets of Young’s moduli extracted from the 12 % PVA sample ( mean±standard de­ viation : 139 . 48±3 . 29 kPa and 118 . 46±3 . 26 kPa ) . We attribute this to the coincidence of the ﬁrst set of 16 X 16 indentations with a region of high polymer concentration . In biological materials such as cartilage , local variations in mechanical properties are detected by performing multiple measurements throughout the re­ gion of interest . To estimate the bulk properties from local mea­ surements , a statistically signiﬁcant number of measurements are required over a large area . This usually entails the use of software - controlled automation of the AFM data collection process . For this purpose , an automated algorithm to process the large number of datasets is necessary . Our analysis of the force - volume datasets , one of which contained 1024 curves , demonstrated the great ben­ eﬁt of a robust , automated procedure . The measurements on car­ tilage were of low resolution by intent and performed for the purpose of demonstrating the capability of the algorithm to accu­ rately process a diverse population of curves . We now have the means to process high - resolution force - volume datasets of inho­ mogeneous samples . A signiﬁcant component of the algorithm is the rearward search strategy , which addresses the issue of extracting the Young’s modulus of materials for which the contact point is not captured in the ramp or is far removed due to nonadhesive tip - sample inter­ actions . We found the frequency of such occurrences to be signiﬁ­ cant ( � 5 % ) in the cartilage data . Hence , a scheme that does not provide for this contingency cannot be considered robust . The approach was validated by truncating several data sets to remove the contact point , applying the rearward search , and evaluating the accuracy as a function of the number of truncated points . In a simulated dataset with perfectly ﬁtted data , the error in Young’s modulus was negligible despite the number of points truncated . For actual datasets , the error increased with the amount of noise in the data and as more points were excluded ; errors generally did not exceed 5 % . Of all tip geometries , blunt pyramidal indenters are perhaps the most widely used . Their advantage in mechanical probing lies in the capability to concurrently produce high - resolution images ( with resolution dependent on the tip radius ) . However , the ap­ proximate analytical solution given by Eq . ( 2 ) is difﬁcult to apply directly to experimental data . In lieu of the ﬂawed approach of approximating the tip as either a sphere or a sharp cone , some researchers generate calibration curves by combining nanoinden­ tation with macroscopic test methods [ 15 ] . The alternative ap­ proach introduced in Appendix B makes use of sharp tip models for dealing with blunt indenters and complements the strategies in our algorithm . Applied in reverse order , the technique can be used as a calibration method for estimating tip radii by scanning a sample of known compliance ; the procedure is described in Ap­ pendix C . These methods provide a means of using common , tapered tips to measure the elasticity of soft samples . The reader is cautioned that the assumption of small strains intrinsic to the con­ tact mechanics theory used in deriving Eqs . ( 1 ) and ( 2 ) is easily violated with sharply tapered tips [ 18 , 26 ] . Hence , use of pyrami­ dal indenters in elasticity measurement should be reserved for situations requiring imaging of the probed region . In general , poor data resulting from experimental conditions and / or improper technique present difﬁculties in data ﬁtting . The many variables include sample preparation and tip selection to minimize interactions ; calibration of voltage - deﬂection sensitiv­ ity ; calibration of cantilever stiffness k c ( many researchers use the nominal value provided by the manufacturer , but uncertainties can be quite large and since E is directly proportional to k c , large errors in the extracted moduli can result from using incorrect val­ ues ) ; and setting of ramp size and ramp starting position . Of equal importance are the geometry and dimensions of the indenter . Al­ though the effects of tip shape and radius on AFM images are now well understood , their effects on elasticity measurements have not received the same level of attention . The common practice of applying the Hertz model [ 16 , 43 ] for indentation with blunt pyra­ midal tips is generally erroneous in the probing of soft materials because most commercial pyramidal tips have nominal tip radii on the order of 10 – 20 nm , whereas maximum indentation depths of up to several hundred nanometers are typical in such samples . Figure 6 shows simulated force curves for the various geometries listed in Table 1 . Clearly , the equations are not interchangeable ( e . g . , the Hertz solution does not accurately model indentation by a pyramidal tip ) . Assuming a sharp conical or pyramidal tip [ 11 , 17 , 30 , 39 , 44 – 46 ] is also ill - advised in many situations because it introduces signiﬁcant errors even for small tip radii ( refer to Fig . 7 for simulations of the effect of tip radius for a blunt conical indenter ) . Corrections for the discrepancy in force - indentation be­ havior between sharp and blunt tips , such as the scheme proposed Fig . 6 Simulated force - indentation curves for tips of various geometries . Forces are normalized against material properties of the indented half space . Fig . 7 Simulated force - indentation curves for blunt conical tips of various tip radii . The curves are nearly parallel beyond a certain indentation depth and at small radii , are virtually indis­ tinguishable from one another . Journal of Biomechanical Engineering JUNE 2007 , Vol . 129 / 437 Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm in Appendix B , can reduce the error signiﬁcantly but result in greater computational expense . An additional complication in the use of tapered tips to measure elastic properties is the potential damage or alteration to the tip geometry subsequent to indenting a hard surface [ 47 ] , required for instance , to calibrate the voltage - deﬂection sensitivity . Care must be exercised to minimize the con­ tact force when performing these calibrations . Uncertainties associated with the aforementioned variables pre­ clude quantitative comparisons of measurements using different cantilevers and are likely a source of the large discrepancies in reported values of Young’s modulus for various soft biological materials . In the interest of achieving consistency and accuracy in absolute measurements of elastic properties , it is necessary to uti­ lize the calibration methods available for determining cantilever stiffness [ 38 , 39 , 48 , 49 ] and tip geometry [ 50 – 53 ] . Although the strategies discussed here have been applied to contact mechanics models dealing with the indentation of an inﬁ­ nite half - space , they are readily applicable to models that account for the effects of ﬁnite sample thickness . Dimitriadis et al . [ 18 ] derived force - indentation relations suitable for thin samples and used the constrained sequential search method in ﬁtting their data . Determination of the need to apply the modiﬁed models is based on knowledge of the sample thickness in relation to the maximum indentation depth . Conclusions The potential of the AFM in high - throughput local elasticity measurements has not been realized due to the lack of robust , automated data processing schemes . The strategies presented here are valid for the analysis of indentation data that can be assumed to obey the fundamental conditions of the Hertz theory ( i . e . , ma­ terial isotropy and homogeneity at the length scale of the probe , small indentation depth and probe size relative to sample size , and deformations that do not exceed the linear stress - strain regime ) . These strategies , when combined systematically as illustrated in the sample algorithm , address the known issues in ﬁtting elastic contact models to AFM force curves , and eliminate subjectivity in the determination of Young’s moduli . High - resolution elasticity maps exemplify how the capabilities of the AFM can be more fully exploited with the availability of automated data ﬁtting . Combined with the judicious selection of indenter geometry , choice of contact model , and proper calibration techniques , it is feasible to produce accurate AFM elasticity measurements using tips of various shapes and sizes . Acknowledgment This work was supported by the Intramural Research Program of the NIH / NICHD . Appendix A : Method Based on Extrapolation of the First Derivative The method developed by Jaasma et al . [ 12 ] requires smoothing of the force - displacement curve and calculating the ﬁrst derivative of the cantilever deﬂection with respect to the piezoposition . Sub­ stituting Eqs . ( 3 ) and ( 4 ) into Eq . ( 1 ) and then differentiating with respect to w gives the mathematical basis of the method k c ( d − d 0 ) = A ( w − w 0 ) f ( A1 ) a d a w = fA k c ( w − w 0 ) f −1 ( A2 ) It is obvious from Eq . ( A2 ) that the derivative is zero at the point of contact . In probing whole cells using microspheres , Jaasma et al . found that the force - displacement behavior did not follow the Hertz model ( f = 3 / 2 ) , but instead followed a parallel - spring re­ cruitment model ( f = 2 ) . For such a relationship , Eq . ( A2 ) is lin­ ear . Hence , Jaasma and colleagues were able to ﬁt lines to pre­ deﬁned regions of interest within the contact region and then extrapolate the lines to a d / a w = 0 in order to estimate w 0 . The regions of interest were set as the range over which the derivative was 0 – 15 % and 10 – 40 % of its extreme value at or close to maxi­ mum indentation depth . The predicted w 0 corresponding to the greater cantilever extension was selected . Depending on whether an actual point within the dataset is selected as the contact point , this approach may be applied as either a constrained or semi - constrained method in the subsequent regression analysis . Note that it can also be used as an alternative to the unbounded , semi - constrained search procedure that we implement as a preliminary step to check the existence of a viable solution—if the extrapo­ lated contact point falls beyond the range of the dataset , a rear­ ward search will be necessary . The extrapolation method can be adapted for analyzing curves that obey the Hertz model by replacing the linear ﬁtting function with a power law of exponent 1 / 2 . Although a d / a w transitions abruptly from a horizontal line to a convex curve at the point of contact for an ideal curve , in actual data with some level of noise , error propagation associated with the smoothing , differentiation , and ﬁtting operations may introduce an inﬂections in a d / a w and signiﬁcantly bias the extrapolation . This is illustrated in Fig . 8 for a simulated dataset generated using the Hertz equation . Based on this shortcoming , we do not recommend this approach for precise detection of the contact point when spherical indenters are used . It can , however , be substituted for the preliminary semi - constrained search process ; used for that purpose , a quadratic function , for which the quality of initial estimates of ﬁtting parameters is much less stringent , may be used to ﬁt the derivative in the regions of interest . Fig . 8 Plot of the ﬁrst derivative „ a d / a w … for a simulated curve „ indicated by + … that obeys the Hertz equation and for the same curve after performing a smoothing operation using splines „ indicated by D … . Predicted contact points „ indicated by 0 … are from ﬁts to the region of interest in the range 10 – 40 % of the maximum value of a d / a w „ solid line for the simulated data and dotted line for the smoothed data … . Note the deviation in the behavior of the derivative after smoothing and the concomitant degradation in the ﬁt , resulting in an early predicted point of contact . The inset shows the simulated d vs . w data „ indicated by < ; range of d : −122 to −59 nm … and the smoothed ﬁt „ solid line … . Appendix B : Strategy for Analyzing AFM Curves Ob­ tained Using Blunt Tips Figure 6 shows simulated force curves for the various geom­ etries represented listed in Table 1 . Clearly , the equations are not interchangeable ( e . g . , the Hertz solution does not accurately model indentation by a pyramidal tip ) . The effect of tip radius for a blunt conical indenter can be seen in Fig . 7 . Without resorting to numerical methods or approximate solutions to the contact me­ chanics problem , we show that the sharp pyramid model can be 438 / Vol . 129 , JUNE 2007 Transactions of the ASME Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm used with minimal error to the analysis of indentation with a blunt pyramid when the correction presented here is applied . Starting with sharp and blunt tips of identical opening angle f , we note that a much larger indentation is required with the sharp tip in order to achieve the same contact radius a . We introduce the equivalent deﬂection o eq , deﬁned as the indentation with the sharp tip for which the indentation radii for both tips are equal to c ( see Fig . 1 ) . From basic geometric relations , b o eq = o + p = o + − R + R 2 − b 2 ( B1 ) tan ¢ where p is the difference in depth between the two tips for the same indentation radius c . For a given indentation o with the blunt tip , the sharp - tipped model can be used to approximate the force - indentation behavior by using the equivalent deﬂection . The range of deﬂections for which the approximation is valid , expressed as a multiple of blunt tip radius , is shown in Fig . 9 . The error in force reaches a minimum of 0 . 65 % at o eq = 2 R and does not exceed 4 % for o eq > 2 R . Errors in Young’s modulus ( not shown ) are compa­ rable . The use of the equivalent deﬂection allows the use of a simple relation , i . e . , Eq . ( 1 ) to model the indentation mechanics of a geometrically more complex tip . Fig . 9 Error in force as a function of the ratio of equivalent deﬂection to tip radius This approach is conducive to automation by using the strate­ gies discussed . To apply it in practice : 1 . Note that Eq . ( 2 a ) can be approximated by a generalized quadratic . Hence , the contact point can be found by ﬁtting the data to the equation F = to 2 + yo , where t and y are co­ efﬁcients to be determined along with ( z 0 , d 0 ) . 2 . Once the contact point is determined , the data can be ex­ pressed in terms of F versus o or F versus o eq . 3 . From the transformed data retain only the points for which o eq � 2 R . These points represent the portion of the curve that matches well with the shape of the curve for the sharp tip . The curve of F versus o should now be nearly parallel with the curve for the sharp tip . 4 . To account for the shifts in the curve from that for the sharp tip , reﬁt the data with a quadratic of the most generalized form , F = q o 2 + Ko + x , where K and x account for the hori­ zontal and vertical shifts and q = A . 5 . E can be calculated from the following relationships : Journal of Biomechanical Engineering - q ( 1 − v 2 ) E = ( blunt cone ) ( B2 ) 2 tan ¢ 1 . 4906 q E = ( blunt pyramid ) ( B3 ) 2 tan 8 ( 1 − v 2 ) Appendix C : Finding the Radius of a Blunt Tip by In­ denting a Calibration Sample of Known E In order to apply the strategy described in Appendix B , the radius of the tip must be known . Direct ( e . g . , electron microscopy ) and indirect ( e . g . , AFM imaging of well - deﬁned grids ) calibration methods exist , but may not be readily available . The approach presented here can be applied by indenting a calibration sample of known stiffness . Ideally , multiple indentations are performed on a homogeneous sample , and the mean of the results is taken as the tip radius . The procedure is as follows : 1 . Obtain a force curve and ﬁt it to the equation F = to 2 + yo in order to ﬁnd the contact point . 2 . The ﬁtted curve is used to compare with the theoretical curve for the sharp tip , which is of the form F = 2 Ao eq . Hence , calculate the true value of A from the known E using Table 1 . 3 . Solving for R in Eq . ( 9 ) using the substitutions o eq = 2 R and b = R cos ¢ , we obtain o R = ( C1 ) 3 − 1 / sin ¢ 4 . Iteratively assume each successive value of o to be the equivalent indentation o eq = 2 R . At each iteration I , calculate the approximate value of A using F = 2 A i o eq . 5 . The error in A ( i . e . , I A − A i I ) follows the trend shown in Fig . 9 . The value of o corresponding to the minimum of the error is used to ﬁnd the radius of the tip ( R ) using Eq . ( 12 ) . References [ 1 ] El Kirat , K . , Burton , I . , Dupres , V . , and Dufrene , Y . F . , 2005 , “Sample Prepa­ ration Procedures for Biological Atomic Force Microscopy , ” J . Microsc . , 218 ( Pt 3 ) , pp . 199 – 207 . [ 2 ] Fotiadis , D . , Scheuring , S . , Muller , S . A . , Engel , A . , and Muller , D . J . , 2002 , “Imaging and Manipulation of Biological Structures With the AFM , ” Micron , 33 ( 4 ) , pp . 385 – 397 . [ 3 ] Greulich , K . O . , 2005 , “Single - Molecule Studies on DNA and RNA , ” ChemP­ hysChem , 6 ( 12 ) , pp . 2458 – 2471 . [ 4 ] Kienberger , F . , Ebner , A . , Gruber , H . J . , and Hinterdorfer , P . , 2006 , “Molecular Recognition Imaging and Force Spectroscopy of Single Biomolecules , ” Acc . Chem . Res . , 39 ( 1 ) , pp . 29 – 36 . [ 5 ] Radmacher , M . , 1997 , “Measuring the Elastic Properties of Biological Samples With the AFM , ” IEEE Eng . Med . Biol . Mag . , 16 ( 2 ) , pp . 47 – 57 . [ 6 ] Silva , L . P . , 2005 , “Imaging Proteins With Atomic Force Microscopy : An Overview , ” Curr . Protein Peptide Sci . , 6 , pp . 387 – 395 . [ 7 ] Simon , A . , and Durrieu , M . , 2006 , “Strategies and Results of Atomic Force Microscopy in the Study of Cellular Adhesion , ” Micron , 37 , pp . 1 – 13 . [ 8 ] Schaer - Zammaretti , P . , and Ubbink , J . , 2003 , “Imaging of Lactic Acid Bacteria With AFM—Elasticity and Adhesion Maps and Their Relationship to Biologi­ cal and Structural Data , ” Ultramicroscopy , 97 ( 1 – 4 ) , pp . 199 – 208 . [ 9 ] Almqvist , N . , Bhatia , R . , Primbs , G . , Desai , N . , Banerjee , S . , and Lal , R . , 2004 , “Elasticity and Adhesion Force Mapping Reveals Real - Time Clustering of Growth Factor Receptors and Associated Changes in Local Cellular Rheo­ logical Properties , ” Biophys . J . , 86 ( 3 ) , pp . 1753 – 1762 . [ 10 ] Hutter , J . L . , Chen , J . , Wan , W . K . , Uniyal , S . , Leabu , M . , and Chan , B . M . , 2005 , “Atomic Force Microscopy Investigation of the Dependence of Cellular Elastic Moduli on Glutaraldehyde Fixation , ” J . Microsc . , 219 ( Pt 2 ) , pp . 61 – 68 . [ 11 ] Radmacher , M . , 2002 , “Measuring the Elastic Properties of Living Cells by the Atomic Force Microscope , ” Methods Cell Biol . , 68 , pp . 67 – 90 . [ 12 ] Jaasma , M . J . , Jackson , W . M . , and Keaveny , T . M . , 2006 , “Measurement and Characterization of Whole - Cell Mechanical Behavior , ” Ann . Biomed . Eng . , 34 ( 5 ) , pp . 748 – 758 . [ 13 ] Mathur , A . B . , Collinsworth , A . M . , Reichert , W . M . , Kraus , W . E . , and Trus­ key , G . A . , 2001 , “Endothelial , Cardiac Muscle and Skeletal Muscle Exhibit Different Viscous and Elastic Properties as Determined by Atomic Force Mi­ croscopy , ” J . Biomech . , 34 ( 12 ) , pp . 1545 – 1553 . [ 14 ] Radhakrishnan , P . , Lewis , N . T . , and Mao , J . J . , 2004 , “Zone - Speciﬁc Micro - mechanical Properties of the Extracellular Matrices of Growth Plate Carti­ lage , ” Ann . Biomed . Eng . , 32 ( 2 ) , pp . 284 – 291 . [ 15 ] Stolz , M . , Raiteri , R . , Daniels , A . U . , VanLandingham , M . R . , Baschong , W . , and Aebi , U . , 2004 , “Dynamic Elastic Modulus of Porcine Articular Cartilage Determined at Two Different Levels of Tissue Organization by Indentation - JUNE 2007 , Vol . 129 / 439 Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm Type Atomic Force Microscopy , ” Biophys . J . , 86 ( 5 ) , pp . 3269 – 3283 . [ 16 ] Tomkoria , S . , Patel , R . V . , and Mao , J . J . , 2004 , “Heterogeneous Nanome­ chanical Properties of Superﬁcial and Zonal Regions of Articular Cartilage of the Rabbit Proximal Radius Condyle by Atomic Force Microscopy , ” Med . Eng . Phys . , 26 ( 10 ) , pp . 815 – 822 . [ 17 ] Tao , N . J . , Lindsay , S . M . , and Lees , S . , 1992 , “Measuring the Microelastic Properties of Biological Material , ” Biophys . J . , 63 , pp . 1165 – 1169 . [ 18 ] Dimitriadis , E . K . , Horkay , F . , Maresca , J . , Kachar , B . , and Chadwick , R . S . , 2002 , “Determination of Elastic Moduli of Thin Layers of Soft Material Using the Atomic Force Microscope , ” Biophys . J . , 82 ( 5 ) , pp . 2798 – 2810 . [ 19 ] Kolambkar , Y . M . , 2004 , “Extracting Mechanical Properties of Cells / Biomaterials Using the Atomic Force Microscope , ” Master’s thesis , University of Cincinnati , Cincinnati , http : / / www . ohiolink . edu [ 20 ] Nyland , L . R . , and Maughan , D . W . , 2000 , “Morphology and Transverse Stiff­ ness of Drosophila Myoﬁbrils Measured by Atomic Force Microscopy , ” Bio­ phys . J . , 78 ( 3 ) , pp . 1490 – 1497 . [ 21 ] Derjaguin , B . V . , Muller , V . M . , and Toporov , Y . P . , 1975 , “Effect of Contact Deformations on the Adhesion of Particles , ” J . Colloid Interface Sci . , 53 , pp . 314 – 326 . [ 22 ] Johnson , K . L . , Kendall , K . , and Roberts , A . D . , 1971 , “Surface Energy and the Contact of Elastic Solids , ” Proc . R . Soc . London , Ser . A , 324 , pp . 301 – 313 . [ 23 ] Muller , V . M . , Yushchenko , V . S . , and Derjaguin , B . V . , 1980 , “On the Inﬂu­ ence of Molecular Forces on the Deformation of an Elastic Sphere and Its Sticking to a Rigid Plane , ” J . Colloid Interface Sci . , 77 ( 1 ) , pp . 91 – 101 . [ 24 ] Butt , H . , Capella , B . , and Kappl , M . , 2005 , “Force Measurements with the Atomic Force Microscope : Technique , Interpretation and Applications , ” Surf . Sci . Rep . , 59 , pp . 1 – 152 . [ 25 ] Costa , K . D . , and Yin , F . C . P . , 1999 , “Analysis of Indentation : Implications for Measuring Mechanical Properties With Atomic Force Microscopy , ” ASME J . Biomech . Eng . , 121 , pp . 462 – 471 . [ 26 ] Bilodeau , G . , 1992 , “Regular Pyramid Punch Problem , ” ASME J . Appl . Mech . , 59 , pp . 519 – 523 . [ 27 ] Na , S . , Sun , Z . , Meininger , G . A . , and Humphrey , J . D . , 2004 , “On Atomic Force Microscopy and the Constitutive Behavior of Living Cells , ” Biomech . Model . Mechanobiol . , 3 ( 2 ) , pp . 75 – 84 . [ 28 ] Rico , F . , Roca - Cusachs , P . , Gavara , N . , Farre , R . , Rotger , M . , and Navajas , D . , 2005 , “Probing Mechanical Properties of Living Cells by Atomic Force Mi­ croscopy With Blunted Pyramidal Cantilever Tips , ” Phys . Rev . E , 72 ( 2 Pt 1 ) , pp . 021914 . [ 29 ] Lin , D . C . , Dimitriadis , E . K . , and Horkay , F . , 2007 , “Robust Strategies for Automated AFM Force Curve Analysis—II . Adhesion - Inﬂuenced Indentation of Soft , Elastic Materials , ” ASME J . Biomech . Eng . , accepted for publication . [ 30 ] Domke , J . , and Radmacher , M . , 1998 , “Measuring the Elastic Properties of Thin Polymer Films With the Atomic Force Microscope , ” Langmuir , 14 , pp . 3320 – 3325 . [ 31 ] A - Hassan , E . , Heinz , W . F . , Antonik , M . D . , D’Costa , N . P . , Nageswaran , S . , Schoenenberger , C . , and Hoh , J . H . , 1998 , “Relative Microelastic Mapping of Living Cells by Atomic Force Microscopy , ” Biophys . J . , 74 , pp . 1564 – 1578 . [ 32 ] Sun , Y . , Akhremitchev , B . , and Walker , G . C . , 2004 , “Using the Adhesive Interaction between Atomic Force Microscopy Tips and Polymer Surfaces to Measure the Elastic Modulus of Compliant Samples , ” Langmuir , 20 , pp . 5837 – 5845 . [ 33 ] Touhami , A . , Nysten , B . , and Dufrene , Y . F . , 2003 , “Nanoscale Mapping of the Elasticity of Microbial Cells by Atomic Force Microscopy , ” Langmuir , 19 , pp . 4539 – 4543 . [ 34 ] Horkay , F . , and Nagy , M . , 1980 , “Elasticity of Swollen Polyvinyl Alcohol and Poly ( Vinyl Acetate ) Networks , ” Polym . Bull . ( Berlin ) , 3 ( 8 – 9 ) , pp . 457 – 463 . [ 35 ] Aklonis , J . J . , and MacKnight , W . J . , 1983 , Introduction to Polymer Viscoelas­ ticity , Wiley , New York . [ 36 ] Treloar , L . R . G . , 1975 , The Physics of Rubber Elasticity , Oxford University Press , London . [ 37 ] Horkay , F . , Horkayne - Szakaly , I . , and Basser , P . J . , 2005 , “Measurement of the Osmotic Properties of Thin Polymer Films and Biological Tissue Samples , ” Biomacromolecules , 6 ( 2 ) , pp . 988 – 993 . [ 38 ] Burnham , N . A . , Chen , X . , Hodges , C . S . , Matei , G . A . , Thoreson , E . J . , Roberts , C . J . , Davies , M . C . , and Tendler , S . J . B . , 2003 , “Comparison of Calibration Methods for Atomic - Force Microscopy Cantilevers , ” Nanotechnol­ ogy , 14 , pp . 1 – 6 . [ 39 ] Hutter , J . L . , and Bechhoefer , J . , 1993 , “Calibration of Atomic - Force Micro­ scope Tips , ” Rev . Sci . Instrum . , 64 ( 7 ) , pp . 1868 – 1873 . [ 40 ] Urayama , K . , Takigawa , T . , and Masuda , T . , 1993 , “Poisson’s Ratio of Poly­ ( Vinyl Alcohol ) Gels , ” Macromolecules , 26 ( 12 ) , pp . 3092 – 3096 . [ 41 ] Geissler , E . , and Hecht , A . M . , 1980 , “The Poisson Ratio in Polymer Gels , ” Macromolecules , 13 , pp . 1276 – 1280 . [ 42 ] Mow , V . C . , Lai , W . M . , and Holmes , M . H . , 1982 , “Advanced Theoretical and Experimental Techniques in Cartilage Research , ” Biomechanics : Principles and Applications , Huiskes , R . , Van Campen , D . , and Dewijn , J . , eds . , Martinus Nijhoff , The Hague , pp . 47 – 74 . [ 43 ] Nie , H . Y . , Motomatsu , M . , Mizutani , W . , and Tokumoto , H . , 1996 , “Local Elasticity Measurement on Polymers Using Atomic Force Microscopy , ” Thin Solid Films , 273 , pp . 143 – 148 . [ 44 ] Alcaraz , J . , Buscemi , L . , Grabulosa , M . , Trepat , X . , Fabry , B . , Farre , R . , and Navajas , D . , 2003 , “Microrheology of Human Lung Epithelial Cells Measured by Atomic Force Microscopy , ” Biophys . J . , 84 ( 3 ) , pp . 2071 – 2079 . [ 45 ] Jiao , Y . , and Schaffer , T . E . , 2004 , “Accurate Height and Volume Measure­ ments on Soft Samples With the Atomic Force Microscope , ” Langmuir , 20 , pp . 10038 – 10045 . [ 46 ] Rotsch , C . , Jacobson , K . , and Radmacher , M . , 1999 , “Dimensional and Me­ chanical Dynamics of Active and Stable Edges in Motile Fibroblasts Investi­ gated by Using Atomic Force Microscopy , ” Proc . Natl . Acad . Sci . U . S . A . , 96 ( 3 ) , pp . 921 – 926 . [ 47 ] Kopycinska - Muller , M . , Geiss , R . H . , and Hurley , D . C . , 2006 , “Contact Me­ chanics and Tip Shape in AFM - Based Nanomechanical Measurements , ” Ultra - microscopy , 106 ( 6 ) , pp . 466 – 474 . [ 48 ] Cumpson , P . J . , Hedley , J . , Clifford , C . A . , Chen , X . , and Allen , S . , 2004 , “Microelectromechanical System Device for Calibration of Atomic Force Mi­ croscope Cantilever Spring Constants Between 0 . 01 and 4 N / M , ” J . Vac . Sci . Technol . A , 22 ( 4 ) , pp . 1444 – 1449 . [ 49 ] Torii , A . , Sasaki , M . , Hane , K . , and Okuma , S . , 1996 , “A Method for Deter­ mining the Spring Constant of Cantilevers for Atomic Force Microscopy , ” Meas . Sci . Technol . , 7 ( 2 ) , pp . 179 – 184 . [ 50 ] Jarausch , K . F . , Stark , T . J . , and Russell , P . E . , 1996 , “Silicon Structures for in Situ Characterization of Atomic Force Microscope Probe Geometry , ” J . Vac . Sci . Technol . B , 14 ( 6 ) , pp . 3425 – 3430 . [ 51 ] Li , Y . , and Lindsay , S . M . , 1991 , “Polystyrene Latex Particles as a Size Cali­ bration for the Atomic Force Microscope , ” Rev . Sci . Instrum . , 62 ( 11 ) , pp . 2630 – 2633 . [ 52 ] Markiewicz , P . , and Goh , M . C . , 1995 , “Atomic Force Microscope Tip Decon­ volution Using Calibration Arrays , ” Rev . Sci . Instrum . , 66 ( 5 ) , pp . 3186 – 3190 . [ 53 ] Vesenka , J . , Manne , S . , Giberson , R . , Marsh , T . , and Henderson , E . , 1993 , “Colloidal Gold Particles as an Incompressible Atomic Force Microscope Im­ aging Standard for Assessing the Compressibility of Biomolecules , ” Biophys . J . , 65 ( 3 ) , pp . 992 – 997 . 440 / Vol . 129 , JUNE 2007 Transactions of the ASME Downloaded 29 May 2007 to 128 . 231 . 88 . 5 . Redistribution subject to ASME license or copyright , see http : / / www . asme . org / terms / Terms _ Use . cfm
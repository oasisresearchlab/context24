Enhancing Spatial Spread Prediction of Infectious Diseases through Integrating Multi - scale Human Mobility Dynamics Yinzhou Tang Department of Electronic Engineering , Tsinghua University Beijing , China tangyinzhou0131 @ 163 . com Huandong Wang ∗ Department of Electronic Engineering , Tsinghua University Beijing , China wanghuandong @ tsinghua . edu . cn Yong Li Department of Electronic Engineering , Tsinghua University Beijing , China liyong07 @ tsinghua . edu . cn ABSTRACT With the increasing prevalence of infectious diseases like COVID - 19 , there is a growing interest in modeling and predicting their transmission . Leveraging the wealth of mobile trajectory data col - lected through advanced localization and mobile communication techniques , numerous approaches have been proposed to predict the spatial spread of infectious diseases based on human mobil - ity dynamics characterized by microscopic user contact graphs or macroscopic population flow graphs . However , existing pure macroscopic and microscopic models have limitations in terms of modeling capabilities or in protecting user privacy . Thus , in this study , we present a M ulti - scale S patial D isease prediction Net work ( MSDNet ) for predicting the spatial spread of infectious diseases . The model predicts the spread of infectious diseases using a macro - micro collaborative approach by combining the temporal and spatial characteristics of the macroscopic information in the population flow graph and the microscopic information in the user contact graph . To understand the coupling between human mobility and infectious disease transmission , we propose a loss term that com - bines infectious disease spread dynamics and modeling of infectious disease parameters that can achieve stable adaptation to key charac - teristics of infectious diseases even when human mobility is affected by policy measures such as travel restrictions . Extensive experi - mental results show the MSDNet model’s superiority for epidemic prediction on graph networks using macro - micro collaboration , achieving a 15 % - 20 % improvement in terms of RMSE and a 15 % - 30 % improvement in terms of SMAPE compared to existing baseline models . In addition , we predict infectious disease parameters under changes in human mobility , and the results show that MSDNet could effectively distinguish between human mobility and infec - tious disease characteristics , achieving a relative improvement of 76 % in terms of RMSE and 80 % in terms of SMAPE in predicting infectious disease parameters under changes in human mobility . ∗ Corresponding author . Email : wanghuandong @ tsinghua . edu . cn . Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page . Copyrights for components of this work owned by others than the author ( s ) must be honored . Abstracting with credit is permitted . To copy otherwise , or republish , topostonserversortoredistributetolists , requirespriorspecificpermission and / or a fee . Request permissions from permissions @ acm . org . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany © 2023 Copyright held by the owner / author ( s ) . Publication rights licensed to ACM . ACM ISBN 979 - 8 - 4007 - 0168 - 9 / 23 / 11 . . . $ 15 . 00 https : / / doi . org / 10 . 1145 / 3589132 . 3625586 CCS CONCEPTS • Information systems → Spatial - temporal systems ; • Com - puting methodologies → Artificial intelligence . KEYWORDS HumanMobility , EpidemicSpreading , GraphNeuralNetwork , Multi - scale ACM Reference Format : Yinzhou Tang , Huandong Wang ∗ , and Yong Li . 2023 . Enhancing Spatial Spread Prediction of Infectious Diseases through Integrating Multi - scale Human Mobility Dynamics . In The 31st ACM International Conference on Advances in Geographic Information Systems ( SIGSPATIAL ’23 ) , November 13 – 16 , 2023 , Hamburg , Germany . ACM , New York , NY , USA , 12 pages . https : / / doi . org / 10 . 1145 / 3589132 . 3625586 1 INTRODUCTION In recent years , epidemics like COVID - 19 have constituted a sub - stantial danger to worldwide public health , the economy , and daily life [ 16 , 33 ] . Accurate epidemiological measurement , modeling , and monitoring are essential to inform public health experts , govern - ment administrators , policymakers , emergency responders , and the general public [ 4 ] . Leveraging the wealth of mobile trajectory data collected through advanced localization and mobile communication techniques , numerous approaches have been proposed to predict the spatial spread of infectious diseases based on human mobility dynamics . Based on the granularity of the study , prevalent models for predicting infectious diseases can be divided into two categories : microscopic and macroscopic models [ 36 ] . Microscopic models em - ploy a microscopic user contact graph with users as nodes and contacts between users as edges to model and predict at the user level [ 20 , 28 ] . However , these models require fine - grained user mo - bility trajectories associated with individual - level user infection information status , which are difficult to obtain due to privacy concerns and regulatory requirements such as the General Data Protection Regulation ( GDPR ) . Macroscopic models model and pre - dict infectious disease spread between regions using population flow graphs . However , macroscopic modeling has the disadvan - tages of ignoring individual - level variation , oversimplifying reality , and using incomplete or imprecise data , although the data is highly standardized and stable [ 2 , 9 ] . In this study , we employ collaborative macroscopic and microscopic information to predict infectious dis - ease transmission between regions at the macroscopic level , which can compensate for the reduced prediction accuracy caused by the lack of information at the individual level in the macroscopic model , and the prediction at the macroscopic level can provide insights to policymakers to understand the transmission patterns of infectious diseases and take appropriate epidemic control measures . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . When modeling the transmission of infectious diseases at a macroscopic level , existing approaches face a number of challenges . First , when modeling the parameters of infectious diseases , the transmission capacity and pathogen characteristics are uncertain due to the leakage of prior knowledge and the possible pathogen’s inherent variability [ 23 ] . Consequently , it is challenging to charac - terize the entire process of infectious disease transmission using constant parameters [ 13 ] . Second , modeling the regional spread of infectious diseases is influenced by both infectious diseases them - selves and human mobility [ 3 , 22 ] . Nonetheless , macroscopic level data only models the density of population movement between re - gions and lacks a depiction of human mobility , which is associated with the spread of infectious diseases . This makes it difficult for the current models to predict the spread of infectious diseases with precision . In this work , we propose a M ulti - scale S patial D isease predic - tion Net work ( MSDNet ) for modeling and predicting the spread of infectious diseases at the macroscopic level using collaborative macro - micro information . In order to overcome the limitations of existing macroscopic models in terms of incorporating fine - grained human mobility dynamics , we use a pooling module to extract infor - mation from microscopic user contact graphs and combine it with data on population mobility between regions for infectious disease prediction in the model . In addition , we propose a loss function based on infectious disease spread dynamics and infectious disease parameters to separate parameters from human mobility in com - plex observational data and predict infectious disease parameters in real time . We also make our code and data publicly available at https : / / github . com / tsinghua - fib - lab / MSDNet . Our main contributions can be summarized as follows : • We propose MSDNet , a multi - scale spatial disease network that learns the representation of regional user contact sub - graphs with contact features between users by introducing pooling modules to obtain coarsened microscopic features , and then achieves better modeling of infectious disease trans - mission by integrating macroscopic and microscopic data . • We construct the loss function used to separate the effect of human mobility patterns from the infectious disease parame - ters . Specifically , it contains three loss terms to optimize the transmission of infectious diseases in terms of long - term pre - diction , short - term prediction , and prediction of infectious disease parameters , respectively . • Extensive experimental results show that our approach out - performs existing machine learning models in predicting the spread of infectious diseases , with a 15 % - 20 % improvement in terms of RMSE and a 15 % - 30 % improvement in terms of SMAPE . Regardless of changes in human mobility patterns , MSDNet achieves accurate prediction of infectious disease parameters with an error of about 10 % , a 76 % improvement in terms of RMSE , and an 80 % improvement in terms of SMAPE over models without incorporating microscopic human mo - bility dynamics . 2 RELATED WORKS Numerous models of infectious disease transmission have been proposed and investigated [ 8 , 36 ] . According to their modeling granularity , we can divide them into two categories : macroscopic models to forecast the trend of diseases at coarse granularity ( e . g . , region , country , etc . ) and microscopic models to predict the illness of individual users . 2 . 1 Macroscopic Models We can classify macroscopic models into mechanical models and machine learning models according to [ 19 ] . Mechanicalmodels : Mechanistic modelsdefineasetof O rdinary D ifferential E quations ( ODEs ) that capture the transmission pat - terns of an epidemic and determine its long - term trajectory . The Susceptible - Infectious ( SI ) is the earliest mechanical model . But it cannot demonstrate disease elimination and recovery . This issue is addressed by the Susceptible - Infectious - Susceptible ( SIS ) para - digm . In contrast to the SI model , the SIS model permits susceptible and infected states to be interchangeable with a given probability , making it simpler to describe the equilibrium state of an infectious disease in a population . During the COVID - 19 pandemic , novel sta - tistical models [ 14 , 29 , 34 ] were proposed , and numerous infectious disease models have been modified and implemented as well . Nev - ertheless , non - machine learning models frequently include weighty assumptions , such as population randomization and the invariance of infectious diseases . Due to these assumptions , the predictions of these models may be flawed . Machine learning models : Machine learning models use big data and algorithms to predict infectious disease transmission pat - terns . It processes more complex data and is more accurate and robust than mathematical models [ 26 ] . In 2020 , Pa A et al . used multiple deep learning models to predict and analyze the COVID - 19 epidemic in India , accurately predicting the epidemic trend , high period , and other vital information for the following days [ 1 ] . Re - cent research has demonstrated that graph neural networks ( GNN ) are a promising method of machine learning for modeling the spread of infectious diseases , as several studies have effectively employed GNN for this purpose . In 2020 , Deng et al . proposed Cola - GNN [ 7 ] , which accurately predicted influenza - like diseases by incorporating a cross - location focus mechanism and capturing their long - term trend . In the same year , Kapoor et al . proposed a novel machine learning model that improved the model’s predictive ability [ 18 ] . More recently , Gao et al . presented the STAN model in 2021 , which leverages spatio - temporal attention mechanisms and disease spreading dynamics to handle complex geographic and temporal data . It uses multi - layer GAT to capture spatial informa - tion and GRU to capture temporal information , which has high accuracy and robustness [ 12 ] . These studies demonstrate the po - tential for GNN - based models to model the spread of infectious diseases and improve prediction accuracy . However , machine learn - ing models , particularly deep learning models , can frequently only predict short - term trends in infectious diseases due to an absence of the spread dynamics of infectious diseases [ 25 ] . Thus , we add an infectious disease spread dynamics to the model , increasing its ability to capture infectious disease spread dynamics and improv - ing its long - term predictive performance . Especially , compared to STAN , we added microscopic information and a loss term of human mobility to improve prediction performance . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany 2 . 2 Microscopic Models In recent years , machine learning and micro - simulation theory models have also been developed to forecast infectious disease micro - spread . A data - driven A gent - B ased M odel ( ABM ) can be used to examine microscopic models . ABMs simulate people’s be - havior , mobility , and interactions to forecast disease spread . In 2011 , Fras - Martnez et al . suggested an ABM that used human mobility and social network data to model infectious disease propagation and control tactics . Because it took into consideration human be - havior and interpersonal ties , this model accurately predicted the spread of infectious illnesses [ 11 ] . Deep learning techniques also incorporate several data sources ( mobile trajectories , weather , etc . ) and models with different degrees of detail to improve infectious illness prediction . Wang et al . [ 32 ] presented the DEFSI , a deep learning - based epidemic prediction approach that autonomously generates data to compensate for miss - ing values in real data . However , these microscopic models require fine - grained user mobility trajectories associated with individual - level user infection information status , which are difficult to obtain in practice . Different from them , our model only utilizes the user contact graph to characterize microscopic human mobility dynam - ics , which can be constructed from anonymous user trajectories without the requirement to be associated with individual - level user infection information status . Thus , our proposed model is feasible in practical applications . 3 PROBLEM FORMULATION In this paper , we focus on using macroscopic and microscopic information to predict the spread of infectious diseases . To define this problem , we first introduce the concepts of macro - graphs and regional micro - graphs to capture the dynamics of macroscopic and microscopic human mobility and the corresponding disease spread dynamics , respectively . Specifically , macroscopic information on population movements between regions and regional spread dynamics of infectious dis - eases can be captured by macro - graphs , which are defined as fol - lows : DEFINITION 1 ( Macro - graph ) . The macro - graph G 𝐴 ( V 𝐴 , E 𝐴 ) is the graph of population movement between regions , where V 𝐴 is the set of regions and E 𝐴 is the set of edges of population movement between regions . For each node , it has a static feature of size 𝐹 𝑆 and a dynamic feature of size 𝐹 𝐷 . In the macro - graph , each node represents a region with static and dynamic features . The static feature is the proportion of the region’s population to the population of all regions , which remains constant across all time steps . The dynamic feature consists of a matrix containing information on existing infected numbers , newly infected numbers , existing susceptible numbers , and newly sus - ceptible numbers in all time steps , where the spread of disease is denoted as 𝐼 ( 𝑡 ) . The edge characterizes the population flow be - tween regions . Specifically , the edge weight 𝜔 𝑖𝑗 between node 𝑖 and node 𝑗 is defined as follows : 𝜔 𝑖𝑗 = 𝛼 𝑖𝑗 (cid:205) 𝑖 (cid:205) 𝑗 𝛼 𝑖𝑗 , ( 1 ) in which 𝑤 𝑖𝑗 is the normalized value of 𝛼 𝑖𝑗 defined by : 𝛼 𝑖𝑗 = (cid:205) 𝑚 𝑝 𝑚 𝑖𝑗 (cid:205) 𝑛 ≠ 𝑖 (cid:205) 𝑚 𝑝 𝑚 𝑖𝑛 , ( 2 ) where 𝑝 𝑚 𝑖𝑗 represents the time taken for the user 𝑚 in region 𝑖 to travel from region 𝑖 to region 𝑗 . Thus , 𝛼 𝑖𝑗 represents the ratio of 𝑡ℎ𝑒 𝑛𝑢𝑚𝑏𝑒𝑟 𝑜𝑓 𝑡𝑟𝑖𝑝𝑠 × 𝑡𝑖𝑚𝑒 for all users in region 𝑖 to region 𝑗 to 𝑡ℎ𝑒 𝑛𝑢𝑚𝑏𝑒𝑟 𝑜𝑓 𝑡𝑟𝑖𝑝𝑠 × 𝑡𝑖𝑚𝑒 for all users in region 𝑖 to all regions . Intuitively , this definition indicates that regions with high popula - tion mobility density are more similar in terms of their infectious disease transmission patterns and dependence . On the other hand , the microscopic information about human mobility patterns in each region can be represented by the regional micro - graphs defined as follows : DEFINITION 2 ( Regional micro - graphs ) . At 𝑡 𝑡ℎ time step , for region 𝑛 , a regional micro - graph is described as G 𝐼 𝑛 ( V 𝐼 𝑛 , E 𝐼 𝑛 ) , where V 𝐼 𝑛 is the set of users belonging to region 𝑛 , and E 𝐼 𝑛 is the set of contacts between users in region 𝑛 at the current time step . In the regional micro - graphs , nodes denote the set of users whose home is in the region 𝑛 , and edges between the nodes indicate the situation where two users have contact outside region 𝑛 . That is , if two users are located in regions other than 𝑛 at 𝑡 𝑡ℎ time step , there is an edge between them . Specifically , the size of the microscopic information feature ma - trix 𝑋 𝐼 is 𝑁 × 𝐹 𝑃 , the size of the macroscopic information feature matrix is 𝑁 × ( 𝐹 𝑆 + 𝐿 𝐻 × 𝐹 𝐷 ) , and the size of the macro - micro col - laborative information feature matrix 𝑋 is 𝑁 × ( 𝐹 𝑃 + 𝐹 𝑆 + 𝐿 𝐻 × 𝐹 𝐷 ) . In addition , 𝐹 𝑆 is the static feature size of each region , 𝐹 𝐷 is the dynamic feature size of each region , 𝐹 𝑃 is the feature size extracted from the regional micro - graphs , 𝐿 𝐻 is defined as the length of the history window ( days ) of each region , and 𝑁 is the number of all regions . With the above definitions , we can define the multi - scale spatial disease spread prediction problem as follows : PROBLEM 1 ( Multi - scale spatial disease spread prediction ) . Given a macro - graph G 𝐴 ( V 𝐴 , E 𝐴 ) and a series of regional micro - graphs G 𝐼 𝑛 ( V 𝐼 𝑛 , E 𝐼 𝑛 ) within 𝐿 𝐻 days before the prediction time step 𝑡 . For each region , predict the trends in the future spread of infectious diseases 𝐼 ( 𝑡 ) and the parameters of infectious diseases separately from human mobility . 4 METHOD In this chapter , we provide a detailed introduction to the architec - ture of M ulti - scale S patial D isease prediction N etwork ( MSDNet ) . As shown in Figure 1 , MSDNet consists of two primary compo - nents : the pooling module and the prediction module . The former is responsible for extracting microscopic information from regional micro - graphs , while the latter combines the extracted microscopic information with macroscopic information to form macro - micro collaborative information , facilitating the learning and prediction of infectious disease spread dynamics . By integrating these two modules , the model can consider information from both macro - scopic and microscopic perspectives , identifying potential features in the data . We will present these two modules separately in the following subsections . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . Regional user contact sub - graphs   Disease dynamics Micro - graph Macro - graph GRU MLP MLP   ∆     +    SIS ∆   ℎ ℒ  ℒ  ℒ  Macro information Static features Dynamic features Pooling Module Prediction Module Micro information   Multi - layer GAT Figure 1 : Model architecture of MSDNet 4 . 1 Pooling Module The regional micro - graphs that capture the contact information between individuals currently present significant computational challenges due to their sparse and extensive nature . To address this issue , MSDNet proposes a pooling module to extract the necessary microscopic information from the graph by coarsening it somehow . Specifically , we use the 𝐷𝐼𝐹𝐹𝑃𝑂𝑂𝐿 model proposed in [ 35 ] to learn the graph representation in an end - to - end approach . In the pooling module of MSDNet , we stack the L - layer GNN module , layer 𝑙 uses the pooled embeddings generated in layers 𝑙 − 1 , and learns to group nodes into clusters of clusters in layer 𝑙 . GNNs are used to extract node embeddings useful for graph regression and to extract node embeddings useful for hierarchical pooling . We denote the cluster assignment matrix learned at layer 𝑙 as 𝑆 ( ℓ ) ∈ R 𝑏 ℓ × 𝑏 ℓ + 1 . Each row in 𝑆 ( ℓ ) corresponds to a node or cluster in layer 𝑙 , and each of its columns corresponds to a cluster in layer 𝑙 + 1 . We can generate features for each cluster in layer 𝑙 using the following formula : 𝑋 ( ℓ + 1 ) = 𝑆 ( ℓ ) 𝑇 𝑍 ( ℓ ) ∈ R 𝑏 ℓ + 1 × 𝑑 , ( 3 ) andgenerateacoarsened adjacencymatrixrepresentingthe strength of the connections between each pair of clusters as follows : 𝐴 ( ℓ + 1 ) = 𝑆 ( ℓ ) 𝑇 𝐴 ( ℓ ) 𝑆 ( ℓ ) ∈ R 𝑏 ℓ + 1 × 𝑏 ℓ + 1 , ( 4 ) where 𝑆 ( ℓ ) is the assignment matrix , 𝐴 ( ℓ ) is the adjacency matrix and 𝑍 ( ℓ ) is the feature matrix . We express the GNN embedding for layer 𝑙 using the following formula : 𝑍 ( ℓ ) = GNN ℓ , embed (cid:16) 𝐴 ( ℓ ) , 𝑋 ( ℓ ) (cid:17) , ( 5 ) that is , the adjacency matrix and convergence features between the cluster nodes at layer 𝑙 are input into the GNN to obtain the new embedding of the cluster nodes . We use the input convergence features and adjacency matrix to generate the assignment matrix as follows : 𝑆 ( ℓ ) = softmax (cid:16) GNN ℓ , 𝑝𝑜𝑜𝑙 (cid:16) 𝐴 ( ℓ ) , 𝑋 ( ℓ ) (cid:17)(cid:17) , ( 6 ) which can generate the probabilistic assignments of the input nodes to the clusters at layer 𝑙 + 1 . In our experiments , the final graph embeddings are obtained by coarsening the regional micro - graphs of the 𝐿 layer , as shown in Figure 1 . We first pre - train the pooling module with the input of the micro - graph for a region at a certain time step and output the average degree of contact outside the region for each individual in the region to obtain the final embedding vector for the whole graph . This embedding vector captures the contact information of all users in the region at the current time step , allowing for the extraction of microscopic information . In particular , as the output of the last dimension is low - dimensional and the data is highly compressed after the 𝐿 layer pooling , we extract the penultimate embedding vector ( 𝐿 − 1 𝑡ℎ layer ) as the output of the pooling module to ensure information integrity and balance computational difficulty . Overall , MSDNet abstracts the regional micro - graphs by extract - ing the necessary microscopic information through the pooling module . The proposed approach enhances the accuracy of predic - tive models and enables the analysis of complex infectious disease spread dynamics . 4 . 2 Prediction Module The prediction module aims to implement collaborative macro - scopic and microscopic information and utilize neural networks to predict infectious disease transmission . To achieve this , we combine the macroscopic information matrix 𝑋 𝑡𝐴 of size 𝑁 × 𝐹 𝑆 + 𝐹 𝐷 × 𝐿 𝐻 and the pooled microscopic information matrix 𝑋 𝑡𝐼 of size 𝑁 × 𝐹 𝑃 to obtain the collaborative information matrix 𝑋 𝑡 . In MSDNet , we use a concatenate approach to achieve this combination , as outlined as follows : 𝑋 𝑡 = 𝑐𝑜𝑛𝑐𝑎𝑡 ( 𝑋 𝑡𝐴 | 𝑋 𝑡𝐼 ) . ( 7 ) We then extract spatio - temporal information into graph embed - dings based on the macro - graph structure using GAT [ 31 ] . Subse - quently , we input these graph embeddings into GRU [ 6 ] to extract temporal information for predicting the trend of infectious dis - eases . Additionally , we incorporate constraints to ensure accurate infectious disease transmission dynamics predictions . To constrain long - term predictions , we implement a constraint on the spread dynamics of infectious diseases . Moreover , to achieve stable pre - dictions of infectious disease parameters in the presence of human mobility , we implement a constraint on the parameters to disen - tangle the relationship between human movement and infectious disease characteristics . Overall , the prediction module utilizes collaborative macroscopic and microscopic information to predict infectious disease trans - mission dynamics while incorporating constraints to improve pre - diction accuracy . This approach enables accurate predictions of infectious disease trends and parameters , even in the presence of complex dynamics such as human mobility . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany 4 . 2 . 1 Modeling of spatio - temporal patterns using GAT . In our pre - diction module , we model the population movement between re - gions using a graph structure . To simulate disease transmission patterns , we need to consider the spatial similarity of the graph , as the virus is more likely to spread between nodes that are in close contact during transmission . Therefore , we utilize GAT to extract spatio - temporal features between regions . The GAT’s underlying idea is to update the embedding of each node by aggregating neighbouring nodes , with information spread - ing mainly on edges with high weights . We use a multi - layer GAT to extract spatio - temporal features from the macro - graph , and historical data within a sliding window is used to construct the graph . Specifically , at each time step , we take a certain length of historical features as input , where the input feature of node 𝑖 is 𝑋 𝑡𝑖 ∈ R 𝐿 𝐻 × ( 𝐹 𝐷 + 𝐹 𝑃 ) + 𝐹 𝑆 and the size of the input history window is denoted as 𝐿 𝐻 . The graph attention mechanism is then used to compute the node representation 𝑧 𝑖𝑡 ∈ R 𝐹 𝑧 for each node , with 𝐹 𝑧 representing the output dimension of the GAT layer and being a hyper - parameter . To compute node representations , we utilize the multi - head atten - tion mechanism , which runs the graph convolution independently several times , generating different attention weights by focusing on various features in the graph . The attention weight of the 𝑘 𝑡ℎ head between node 𝑖 and node 𝑗 is calculated by : 𝑒 𝑘𝑖𝑗 = 𝜎 (cid:16) 𝑊 𝑘𝑎 (cid:16) 𝑊 𝑘𝑧 𝑋 𝑡𝑖 | 𝑊 𝑘𝑧 𝑋 𝑡𝑗 (cid:17)(cid:17) , ( 8 ) where 𝑊 𝑘𝑧 ∈ R 𝐹 𝑧 × | 𝑋 𝑡𝑖 | represents the parameter of the linear trans - formation weight matrix , 𝑊 𝑘𝑎 ∈ R 1 × 2 𝐹 𝑧 represents the attention weight calculation matrix of the 𝑘 𝑡ℎ head , and 𝜎 is the nonlinear activation function , with 𝐿𝑒𝑎𝑘𝑦𝑅𝑒𝐿𝑢 utilized here . We then use the 𝑠𝑜𝑓 𝑡𝑚𝑎𝑥 function to calculate the attention score for each edge to evaluate how much information should be received from the neighbouring node 𝑗 , which is described as : 𝑎 𝑘𝑖𝑗 = softmax (cid:16) 𝑒 𝑘𝑖𝑗 (cid:17) = exp (cid:16) 𝑒 𝑘𝑖𝑗 (cid:17) (cid:205) 𝑁𝑛 = 1 exp (cid:16) 𝑒 𝑘𝑖𝑛 (cid:17) . ( 9 ) Finally , the final representation of the node is obtained by summing the embedding vectors of all heads as follows : 𝑧 𝑖𝑡 = 1 𝐾 𝐾 ∑︁ 𝑘 = 1 𝑁 ∑︁ 𝑗 = 1 𝑎 𝑘𝑖𝑗 𝑊 𝑘𝑧 𝑋 𝑡𝑖 . ( 10 ) This approach enables us to accurately simulate spatio - temporal transmission patterns of infectious diseases by leveraging popula - tion flow data and simulating the spatial similarity of the graph . By extracting spatio - temporal features using a multi - layer GAT and the multi - headed attention mechanism [ 30 ] , we can effectively cap - ture complex relationships between regions and improve prediction accuracy . 4 . 2 . 2 Modeling temporal features using GRU . To better predict fu - ture trends of infectious diseases , the prediction model needs to capture the pattern of graphical information over time and the relationship between infectious diseases and time . Additionally , the spread of epidemics in different regions at different stages needs to be considered , as different models of epidemic spread are devel - oped for each region with different parameters but share a graph structure . We begin by utilizing 𝑀𝑎𝑥𝑃𝑜𝑜𝑙 to aggregate the graph embed - dings and reduce the number of dimensions as follows : ˜ 𝑧 𝑡 = MaxPool (cid:16)(cid:104) 𝑧 0 𝑡 , 𝑧 1 𝑡 , . . . , 𝑧 𝑁𝑡 (cid:105)(cid:17) , ( 11 ) where ˜ 𝑧 𝑡 = MaxPool (cid:16)(cid:2) 𝑧 0 𝑡 , 𝑧 1 𝑡 , . . . , 𝑧 𝑁𝑡 (cid:3)(cid:17) is a matrix and the 𝑖 𝑡ℎ col - umn is 𝑧 𝑡𝑖 , thus˜ 𝑧 𝑡 incorporates the most important features of all nodes extracted from the graph . This step helps to extract the most important features of all nodes , which is crucial for accurate pre - dictions . Following this , we input the graph embedding into a G ated R egression logic U nit ( GRU ) to model the time series . The hidden states of the GRU contain the learned spatial and temporal patterns , it is calculated by : ℎ 𝑡 = GRU ( ˜ 𝑧 1 , ˜ 𝑧 2 , . . . , ˜ 𝑧 𝑡 ) , ( 12 ) where the obtained hidden state of the GRU ℎ 𝑡 at the 𝑡 𝑡ℎ time step for a particular location contains both spatial and temporal patterns learned from real - world data . This approach enables the model to capture the temporal dynamics of infectious diseases , allowing for more accurate predictions of future trends . In summary , by leveraging 𝑀𝑎𝑥𝑃𝑜𝑜𝑙 and GRU , the model is able to capture the relationship between infectious diseases and time , as well as the spread of epidemics in different regions at different stages . By combining these techniques with the graph structure , the model achieves high prediction accuracy , allowing for timely and effective responses to infectious disease outbreaks . 4 . 2 . 3 Dual output of infectious disease trends and parameter pre - dictions . When MSDNet forecasts using macro - micro collaborative data from the history window , we will get the following two out - puts : Dynamic parameters of infectious diseases : The traditional SIS models assume that the transmission rate 𝛽 and recovery rate 𝛾 are constant over time and only reflect the inherent characteris - tics of the infectious disease virus . However , in reality , changes in human mobility - whether due to policy changes or spontaneous reductions - can render these parameters time - varying . As a result , parameters no longer reflect only the characteristics of the infec - tious disease . Consequently , MSDNet incorporates a propagation dynamics constrained loss term to separate human movement and infectious disease parameters so that 𝛽 and 𝛾 should have stable values that are not affected by human movement . Daily increment of the number of infections : For the 𝑡 𝑡ℎ history window , the infectious disease trend for the output window days ( i . e . , future 𝐿 𝑃 days ) can be predicted based on the information of the first 𝐿 𝐻 days as follows : (cid:99) Δ 𝐼 , (cid:99) Δ 𝑆 = MLP ( ℎ 𝑡 ) , ( 13 ) where (cid:99) Δ 𝐼 is the increment of infected persons , (cid:99) Δ 𝑆 is the increment of susceptible persons , and 𝑀𝐿𝑃 is the neural network . 4 . 2 . 4 Loss function with disease spread dynamics constraint and parameter prediction constraint . The MSDNet model is designed SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . to predict both short - term and long - term disease transmission dy - namics , as well as the parameters of infectious diseases . To achieve this , the model incorporates a loss function mechanism that con - siders the multi - prediction task of transmission dynamics , which utilizes an evaluation of both short - term and long - term prediction performance to update the parameters jointly , ensuring accurate predictions across all timescales . Furthermore , to separate human mobility from infectious disease characteristics , we introduce a constraint term for the prediction of infectious disease parameters . This constraint ensures that the predicted parameters remain basically unchanged despite changes in human mobility patterns , thus allowing the parameters to reflect only the infectious disease characteristics . By incorporating this constraint into the MSDNet model , we can accurately predict dis - ease transmission patterns while effectively separating the effects of human movement on disease spread . In order to enhance the model’s parameters’ performance for both short - and long - term forecasting , we defined three loss func - tion terms to look at forecasting performance from different angles . Infectious disease trend forecast loss term : The infectious disease trend forecast loss term is used to measure the MSDNet’s forecast for the short term and is represented by the M ean S quared E rror ( MSE ) of the model’s direct forecast of future 𝐿 𝑃 days infec - tious disease spread dynamics versus the true value of , which can be calculated as : L 𝑟 = ( (cid:99) Δ 𝐼 − Δ 𝐼 ) 2 + ( (cid:99) Δ 𝑆 − Δ 𝑆 ) 2 . ( 14 ) Propagation dynamics constrained loss terms : The loss term in the MSDNet model is utilized to optimize the long - term forecast for the transmission rate 𝛽 and recovery rate 𝛾 . However , due to the limited information content and small dimensionality of 𝛽 and 𝛾 , we do not directly calculate the MSE for these parameters . Instead , we utilize the disease trends generated from 𝛽 and 𝛾 predictions for the next 𝐿 𝑃 days to calculate the loss . Specifically , after predicting 𝛽 and 𝛾 using 𝑀𝐿𝑃 , we employ the dynamic - based prediction ap - proach , which involves iteratively calculating disease transmission dynamics ( (cid:99) Δ 𝐼 𝑝ℎ , (cid:99) Δ 𝑆 𝑝ℎ ) using the 𝑆𝐼𝑆 formula and initial dynamics of the current moment . We can then optimize 𝛽 and 𝛾 by calculat - ing the loss between the dynamic - based prediction and the ground truth . The dynamic - based prediction is formulated as : (cid:99) Δ 𝐼 𝑝ℎ = (cid:104)(cid:99) Δ 𝐼 𝑝ℎ𝑡 + 1 , (cid:99) Δ 𝐼 𝑝ℎ𝑡 + 2 , . . . , (cid:99) Δ 𝐼 𝑝ℎ𝑡 + 𝐿 𝑝 (cid:105) , each (cid:99) Δ 𝐼 𝑝ℎ 𝑖 = 𝛽𝑆 𝑖 − 1 − 𝛾𝐼 𝑖 − 1 = 𝛽 (cid:16) 𝑁 𝑃 − (cid:99) Δ 𝐼 𝑝ℎ𝑖 − 1 (cid:17) − 𝛾 (cid:99) Δ 𝐼 𝑝ℎ𝑖 − 1 , ( 15 ) and (cid:99) Δ 𝑆 𝑝ℎ = (cid:104)(cid:99) Δ 𝑆 𝑝ℎ𝑡 + 1 , (cid:99) Δ 𝑆 𝑝ℎ𝑡 + 2 , . . . , (cid:99) Δ 𝑆 𝑝ℎ𝑡 + 𝐿 𝑃 (cid:105) , each (cid:99) Δ 𝑆 𝑝ℎ𝑖 = − 𝛽𝑆 𝑖 − 1 + 𝛾𝐼 𝑖 − 1 = − 𝛽 (cid:16) 𝑁 𝑃 − (cid:99) Δ 𝐼 𝑝ℎ𝑖 − 1 (cid:17) + 𝛾 (cid:99) Δ 𝐼 𝑝ℎ𝑖 − 1 , ( 16 ) where (cid:99) Δ 𝐼 𝑝ℎ 𝑖 − 1 and (cid:99) Δ 𝑆 𝑝ℎ 𝑖 − 1 are calculated based on the true values from the previous day of the current predict window , and 𝑁 𝑃 represents the population size at the location . To further optimize the predic - tion consistency with the long - term infectious disease trend , we utilize the propagation dynamics constrained loss , as formulated by : L 𝑑 = (cid:16)(cid:99) Δ 𝐼 𝑝ℎ − Δ 𝐼 (cid:17) 2 + (cid:16)(cid:99) Δ 𝑆 𝑝ℎ − Δ 𝑆 (cid:17) 2 . ( 17 ) This loss measures the mean square error of the transmission dynamics - based prediction and helps ensure that the prediction remains consistent with the long - term trend . Human movements loss terms : Solely utilizing the propa - gation dynamics constrained loss to constrain the prediction of parameters can lead to inaccurate results . This is due to the poten - tial impact of changes in human mobility , such as travel restrictions imposed by government policies , on the transmission dynamics of infectious diseases . If we fit the dynamic equation to the trend of the disease , it may incorporate information regarding human mo - bility into the parameters of the infectious disease . Consequently , the extracted parameters may no longer solely reflect the inherent characteristics of the disease . Therefore , we need a loss term to distinguish the characteristics of the infectious disease from hu - man movement . For this purpose , we trained an MLP that is able to output a feature MLP ( 𝑋 𝐼 ) related to microscopic information of the 𝐿 𝑃 , such that it is linearly related to the parameters , thus permitting the separation of human movement from infectious disease characteristics . Specifically , the parameters reflecting only the infectious disease characteristics are denoted as 𝛽 0 and 𝛾 0 , and the parameters reflecting both the infectious disease and human movement characteristics are denoted as 𝛽 and 𝛾 . We presume that the relationship between human movement and infectious disease is a simple multiplication , i . e . , 𝛽 = 𝛽 0 𝑀𝐿𝑃 ( 𝑋 𝐼 ) . Thus , the infectious disease parameter at each moment can be expressed as 𝛽 0 = 𝛽 𝑀𝐿𝑃 ( 𝑋 𝐼 ) , and because this should be a constant with time , we calculate the difference of the parameter Δ 𝛽 0 between two time steps , which should be made to converge to 0 . 𝛾 also has a similar representation . Based on the above assumptions , we construct the human movement loss term , and its formula is as follows : L 𝑚 = Δ 𝛽 𝑀𝐿𝑃 ( 𝑋 𝐼 ) + Δ 𝛾 𝑀𝐿𝑃 ( 𝑋 𝐼 ) . ( 18 ) The complete loss function is obtained by summing the three loss terms for each region at each time step in the prediction window 𝐿 𝑃 , as described by : L = 𝐿 𝑝 ∑︁ 𝑁 ∑︁ ( L 𝑑 + L 𝑟 + L 𝑚 ) . ( 19 ) 4 . 2 . 5 Predict infectiousdiseasetrendsandparametersusingMSDNet . Once the MSDNet model has been trained , it can be applied to predict the transmission of infectious diseases at all locations , given the historical window length 𝐿 𝐻 , prediction window length 𝐿 𝑃 , and graph information G . To achieve this , we first input the regional micro - graph into the pooling module , which generates the coarsened microscopic infor - mation vector . This vector is then combined with the information from the macro - graph and fed into the prediction module . Here , the graph embedding is generated via GAT , while temporal changes in features are captured through GRU networks . At the last time slice , the results of infectious disease trend ( (cid:99) Δ 𝐼 , (cid:99) Δ 𝑆 ) and infectious disease parameter ( 𝛽 , 𝛾 ) predictions for all locations are outputted . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany It should be noted that our model is solely optimized during training . Consequently , predictions for different lengths of time in the future can be obtained by adjusting the prediction window length 𝐿 𝑃 . In summary , the MSDNet model can effectively predict the trans - mission of infectious diseases across multiple locations by integrat - ing both macroscopic and microscopic information . By leveraging GAT and GRU networks , our model can capture both spatial and temporal dynamics , enabling accurate predictions for both trends and parameters at every location . 5 EXPERIMENT 5 . 1 Dataset We build a simulation environment that can use real - world data to generate the dynamics of infectious disease transmission for a specific number of people over a specific length of time . Specifically , we use TimeGeo [ 17 ] to simulate the trajectories of a specific num - ber of people based on real - world regional divisions , demographic information , and human travel rhythm information . Based on it , we further use the Independent Contagion Model ( ICM ) [ 27 ] to sim - ulate the spread dynamics of infectious disease transmission over a specific length of time . This simulation environment can simulate infectious disease spread dynamics with different human mobility patterns and different infectious disease by importing different pa - rameters to TimeGeo and ICM . The introduction to TimeGeo , ICM , and details for generating mobility trajectories as well as dynamic infection states of users can be found in Appendix . 5 . 2 Experimental settings In our experiments , as in [ 37 ] , we use the simulation environment to simulate the " no intervention " and " movement restriction " datasets . The former is the case of transmission in the absence of government policy and drug intervention . In this dataset , we use the same pa - rameters as in the original text for the TimeGeo dataset and use the parameters in [ 24 ] to model the spread of the infectious disease . In addition , to simulate the transmission of infectious diseases under " mobility restriction " scenarios ( e . g . , government policy interven - tions , travel restrictions , and spontaneous behavioral responses of the population ) , we introduce a movement restriction threshold 𝑇𝐻 and a movement decay rate 𝑅 𝑐 to simulate the transmission of infectious diseases under different mobility restriction scenarios [ 37 ] . A detailed description can be found in the Appendix . For sim - plicity , we chose the curves for the 𝑇𝐻 = 0 . 5 and 𝑅 𝑐 = 0 . 5 cases as the " movement - limited " dataset , i . e . , when the number of infections reaches 50 % of the total number resulting in a 50 % reduction in the probability of movement of individuals . In each dataset , we use 60 % of the data as the training set , 20 % as the validation set , and 20 % as the test set . We use the two datasets above to measure the performance of MSDNet in the following aspects : We first evaluate the improvement in the predictive performance of the MSDNet model compared to the existing baseline under " no intervention " and " movement restriction " scenarios in terms of RMSE and SMAPE [ 5 ] . The definition of these metrics and how they are used to evaluate the performance of the model are described in Appendix . In the second section , we explore the effectiveness of MSDNet for separating infectious disease parameters from human mobility patterns . We also conduct an ablation study to experimen - tally support the need for three loss terms . Finally , a case study is conducted to explore the predictive stability of the MSDNet model for regions with different numbers of people . 5 . 3 Baselines We use the following models as baselines of prediction : ( 1 ) RNN [ 10 ] is a neural network capable of processing sequential data through recurrence . ( 2 ) LSTM [ 15 ] is a recurrent neural network designed to retain long - term dependencies in sequential data . ( 3 ) GRU [ 6 ] is a compact type of recurrent neural network designed to pro - cess sequential data with fewer parameters and gating mechanisms than LSTM . ( 4 ) GCN [ 21 ] is a neural network that handles graph - structured data by propagating information between nodes through edge connectivity . ( 5 ) GAT [ 31 ] is a graph neural network that lever - ages attention mechanisms to improve information flow and node classification in graph - structured data . ( 6 ) STAN [ 12 ] is a state - of - the - art epidemic prediction model that uses spatio - temporal atten - tion mechanisms and disease spread dynamics to handle complex geographic and temporal data with high accuracy and robustness . In addition , to better validate the necessity of microscopic and macroscopic information , we compare MSDNet with the following simplified models : ( 1 ) MSDNet - L 𝑟 removes the L 𝑟 loss component of MSDNet , i . e . , reduce the constraints on infectious disease spread dynamics . ( 2 ) MSDNet - L 𝑚 removes the L 𝑚 loss component of the MSDNet , i . e . , reduce the constraints on the infectious disease parameters . ( 3 ) MSDNet - L 𝑑 removes the L 𝑑 loss component of MSDNet , i . e . , reduce the constraint on infectious disease trends . 5 . 4 Prediction performance In this study , we evaluate the performance of MSDNet by com - paring it with a baseline model under different prediction window lengths ( 𝐿 𝑃 ) and movement restriction situations , using RMSE and SMAPE . To assess the short - term , medium - term , and long - term prediction performance , we set the 𝐿 𝑃 values to 4 , 7 , and 10 days , respectively . Additionally , we use a historical window length of 𝐿 𝐻 = 7 to measure the accuracy of different models for transmission prediction and set the hyperparameters of the movement restriction dataset as 𝑇𝐻 = 0 . 5 , 𝑅 𝑐 = 0 . 5 . The predictions of various models were reported in Table 1 . 5 . 4 . 1 Prediction performance with no intervention . The experimen - tal results demonstrate that MSDNet achieves higher accuracy than the baseline model under all 𝐿 𝑃 conditions and maintains its stable performance as the 𝐿 𝑃 increases . Specifically , in the short - term prediction phase , while the prediction performance of all models is comparable , the spatio - temporal models , including STAN and MSD - Net , exhibit higher accuracy due to their enhanced ability to capture spatial information . In the medium - term forecast , the predictive per - formance of all models is worse because of the longer time period . In the long - term prediction phase , only the spatio - temporal mod - els , STAN and MSDNet , retain higher accuracy , while the spatial models GCN and GAT fail to capture the complex spatio - temporal interactions . Furthermore , we find that MSDNet outperforms STAN across all prediction window lengths , with 15 % - 20 % improvements in terms of RMSE and 15 % - 30 % in terms of SMAPE . The outstanding SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . Table 1 : Average performance comparison with 𝐿 𝑃 = 7 and { 𝐿 𝑃 = 4 , 7 , 10 } . A lower RMSE and MAPE indicate better performance . The best results are highlighted in bold . no intervention movement restriction 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RNN 9 . 29 7 . 91 % 82 . 99 21 . 05 % 182 . 64 36 . 32 % 15 . 26 11 . 31 % 101 . 32 33 . 67 % 234 . 33 49 . 57 % LSTM 7 . 65 5 . 68 % 52 . 70 19 . 82 % 146 . 50 37 . 55 % 9 . 43 7 . 88 % 96 . 90 31 . 62 % 210 . 30 47 . 23 % GRU 6 . 24 3 . 87 % 38 . 37 15 . 96 % 87 . 15 24 . 40 % 8 . 32 6 . 33 % 83 . 72 29 . 77 % 199 . 74 43 . 22 % GCN 4 . 77 3 . 52 % 15 . 89 7 . 66 % 24 . 64 12 . 66 % 7 . 37 5 . 49 % 20 . 77 12 . 74 % 40 . 24 29 . 47 % GAT 5 . 05 3 . 62 % 17 . 82 8 . 66 % 27 . 65 14 . 57 % 7 . 46 5 . 64 % 21 . 63 13 . 08 % 43 . 22 30 . 10 % STAN 3 . 83 3 . 23 % 7 . 84 5 . 67 % 12 . 67 6 . 34 % 6 . 47 4 . 89 % 19 . 27 12 . 84 % 39 . 66 27 . 65 % MSDNet 3 . 22 2 . 84 % 5 . 64 3 . 97 % 8 . 49 5 . 64 % 4 . 34 3 . 07 % 6 . 91 4 . 33 % 10 . 55 7 . 84 % ( a ) RMSE ( b ) SMAPE Figure 2 : Evaluation in terms of RMSE and SMAPE indicators for different models with different 𝐿 𝑃 Table 2 : Prediction of infectious disease parameters ( transmission rate 𝛽 and recovery rate 𝛾 ) in different 𝐿 𝑃 scenarios . The best results are highlighted in bold . no intervention movement restriction 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE STAN 0 . 13 30 . 2 % 0 . 17 43 . 6 % 0 . 19 45 . 7 % 0 . 21 61 . 4 % 0 . 25 67 . 8 % 0 . 31 73 . 6 % MSDNet - L 𝑟 0 . 21 62 . 7 % 0 . 23 65 . 8 % 0 . 30 71 . 8 % 0 . 32 73 . 6 % 0 . 36 81 . 5 % 0 . 41 86 . 8 % MSDNet - L 𝑚 0 . 03 6 . 3 % 0 . 05 9 . 1 % 0 . 07 11 . 5 % 0 . 15 35 . 4 % 0 . 19 43 . 6 % 0 . 22 51 . 5 % MSDNet 0 . 03 6 . 2 % 0 . 04 8 . 2 % 0 . 06 10 . 1 % 0 . 04 7 . 2 % 0 . 05 10 . 3 % 0 . 08 12 . 5 % performance of MSDNet can be attributed to its unique capability to capture both macroscopic and microscopic information , model interactions between regions , and capture disease - time correlations relative to the time series and spatial models . 5 . 4 . 2 Prediction performance with movement restriction . In the case of restricted movement , only the MSDNet model is capable of pro - ducing accurate predictions . This is due to the fact that none of the other models can account for the change in infectious disease spread dynamics caused by human movement and can only foresee the trend of infectious disease transmission within 𝐿 𝑃 days . MSD - Net , on the other hand , is able to accurately predict the impact of human movement on infectious disease spread dynamics due to the fact that it takes human movement into consideration . In conclusion , MSDNet outperforms state - of - the - art baseline models in short - and long - term prediction due to its effective inte - gration of macroscopic and microscopic data to predict infectious disease spread dynamics . MSDNet captures spatial data using a spatial - temporal model , thereby enhancing our understanding of disease patterns . In addition , MSDNet is able to use micro - graphs to capture human movement in the presence of changes in human movement , allowing for accurate prediction of infectious disease spread dynamics . 5 . 5 Parameters prediction performance In traditional models of infectious diseases , transmission param - eters are typically assumed to remain unchanged as the disease advances . However , such models frequently fail to provide accu - rate predictions of infectious diseases in situations where govern - ment interventions or population self - protection measures can influence the dynamics of disease transmission . When an infectious disease poses a significant threat to human health and safety , for instance , government measures such as " city closures " or popula - tion responses such as masking , disinfection , and ventilation can restrict movement and alter the transmission parameters of the disease over time . In this subsection , we investigate whether MSDNet can accu - rately predict the parameters of infectious diseases , i . e . , transmis - sion rate 𝛽 and recovery rate 𝛾 , even when human mobility pattern changes . Specifically , we aim to determine whether MSDNet can separate the parameters of human mobility and infectious diseases while still predicting the disease transmission dynamics correctly . To evaluate MSDNet’s ability to distinguish between human mo - bility and disease transmission characteristics , we train the MSDNet model for prediction using the disease spread dynamics after move - ment restriction , focusing on the outputs related to the infectious SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany ( a ) RMSE ( b ) SMAPE Figure 3 : Analysis of the predictive accuracy of MSDNet in regions with different numbers of people Table 3 : Ablation study on major components of MSDNet with 𝐿 𝑃 = 7 and { 𝐿 𝑃 = 4 , 7 , 10 } . The best results are highlighted in bold . no intervention movement restriction 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days 𝐿 𝑃 = 4days 𝐿 𝑃 = 7days 𝐿 𝑃 = 10days RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE RMSE SMAPE MSDNet - L 𝑟 3 . 78 3 . 22 % 8 . 97 5 . 05 % 12 . 24 7 . 11 % 4 . 87 3 . 65 % 10 . 87 6 . 85 % 15 . 54 9 . 42 % MSDNet - L 𝑚 3 . 66 3 . 01 % 6 . 55 4 . 26 % 10 . 25 6 . 95 % 8 . 48 5 . 92 % 20 . 74 12 . 99 % 40 . 27 28 . 75 % MSDNet - L 𝑑 5 . 42 4 . 30 % 9 . 56 5 . 79 % 14 . 24 8 . 68 % 10 . 51 7 . 04 % 22 . 59 13 . 05 % 42 . 66 30 . 21 % MSDNet 3 . 22 2 . 84 % 5 . 64 3 . 97 % 8 . 49 5 . 64 % 4 . 34 3 . 07 % 6 . 91 4 . 33 % 10 . 55 7 . 84 % disease parameters 𝛽 and 𝛾 . In this experiment , we only investigate STAN and MSDNet and their simplified models , as other models don’t have the ability to model parameters of infectious diseases . Our objective is to assess the efficacy of our loss function with three loss terms in distinguishing the essential characteristics of human mobility and infectious diseases . The results in Table 2 show that STAN , MSDNet - L 𝑚 and MSD - Net can achieve more accurate predictions than MSDNet - L 𝑟 when there is no intervention , because in STAN only SIS is used to con - strain the infectious disease spread dynamics , while in MSDNet - L 𝑚 , although there is also only infectious disease spread dynamics to SIS , it combines microscopic features , so the characteristics are bet - ter than STAN . In the presence of human mobility change , because other models do not capture human mobility , they can only model human mobility into the change of parameters when predicting them , resulting in a decrease in prediction , whereas MSDNet can still make accurate predictions because it has the mechanism to model human mobility . It can be seen from the results that MSDNet can achieve less error in predicting parameters , i . e . , it can achieve stable prediction for infectious disease parameters regardless of changes in human movement , so long as the infectious disease remains the same . Thus , MSDNet can effectively separate the characteristics of human movement and infectious diseases . 5 . 6 Ablation study To demonstrate that each part of the loss function contributes to the modeling of the parameters to improve the performance of the model , we conducted ablation experiments . So we argue the necessity of the three loss terms by comparing the evaluation metrics of each MSDNet loss term under different experimental conditions . The results are described in Table 3 . Due to the lack of constraints on the spread dynamics of infec - tious diseases , the long - term prediction performance of MSDNet decreases after removing L 𝑟 , while the short - term prediction per - formance is comparable to that of MSDNet . When L 𝑚 is removed from MSDNet , the prediction performance in the restricted case decreases significantly due to the loss of constraints on human motion and parameters . When L 𝑑 is removed from MSDNet , the prediction performance decreases with or without movement con - straints because the capture of the infectious disease trend is lost , and only SIS dynamics and human movement can be used to predict the infectious disease trend . Thus , modeling parameters in MSDNet is indispensable for ac - curately predicting infectious diseases in the short term , long term , and with and without changes in human mobility . 5 . 7 Case study in different regions In order to explore the relationship between MSDNet predictors and regional population numbers and to investigate whether the prediction effect of MSDNet is equally accurate for regions with different numbers of people , we analyzed the final output of RMSE and SMAPE , which are average values for all regions . The regional division is closely related to real - world population density , making it necessary to examine these metrics across diverse regions . To carry out the experiment , we divide regions into 10 intervals based on population size and tabulated the prediction indexes of each interval . The results are presented in Figure 3 . Through this experimental approach , we determine that MSDNet predictions remain accurate for regions with varying population sizes when measured by the MSE indicator . However , for SMAPE , it is observed that their indicators gradually increased as the number of people in a region decreased . This is due to the fact that as the number of people decreases , the relative deviation increases even when the prediction produces the same absolute deviation . Thus , SMAPE , which are indicators reflecting relative deviations , also increases . In summary , MSDNet can effectively predict infectious disease spread dynamics in regions with diverse population sizes . 6 CONCLUSION In this article , we present a M ulti - scale S patial D isease prediction Net work , MSDNet , which integrates macroscopic and microscopic SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . information to achieve accurate epidemic trend predictions . The model incorporates constraints on infectious disease spread dynam - ics and separates the impact of human mobility from infectious disease transmission characteristics . Extensive experiments con - firm its superiority and robustness . Future research should consider additional influencing factors , such as weather and government policies to improve prediction accuracy . More interaction between macroscopic and microscopic graphs can also be used , even model - ing the two in association , as well as incorporating hyper - graphs to model macroscopic and microscopic information , etc . These ad - vancements are critical for the timely monitoring and prediction of infectious diseases . ACKNOWLEDGMENTS This work was supported in part by the National Key Research and Development Program of China under2020YFA0711403 , the National Key Research and Development Program of China under U21B2036 , U20B2060 , 62171260 , and Young Elite Scientists Spon - sorship Program by CIC ( Grant No . 2021QNRC001 ) . REFERENCES [ 1 ] Parul Arora , Himanshu Kumar , and Bijaya Ketan Panigrahi . 2020 . Prediction and analysis of COVID - 19 positive cases using deep learning models : A descriptive case study of India . Chaos , Solitons & Fractals 139 ( 2020 ) , 110017 . [ 2 ] Norman TJ Bailey . 1986 . Macro - modelling and prediction of epidemic spread at community level . Mathematical Modelling 7 , 5 - 8 ( 1986 ) , 689 – 717 . [ 3 ] Andrew W Bartlow , Carrie Manore , Chonggang Xu , Kimberly A Kaufeld , Sara Del Valle , Amanda Ziemann , Geoffrey Fairchild , and Jeanne M Fair . 2019 . Fore - casting zoonotic infectious disease response to climate change : mosquito vectors and a changing environment . Veterinary sciences 6 , 2 ( 2019 ) , 40 . [ 4 ] Cristiane M Batistela , Diego PF Correa , Átila M Bueno , and José Roberto C Piqueira . 2021 . SIRSi compartmental model for COVID - 19 pandemic with immu - nity loss . Chaos , Solitons & Fractals 142 ( 2021 ) , 110388 . [ 5 ] Davide Chicco , Matthijs J Warrens , and Giuseppe Jurman . 2021 . The coefficient of determination R - squared is more informative than SMAPE , MAE , MAPE , MSE and RMSE in regression analysis evaluation . PeerJ Computer Science 7 ( 2021 ) , e623 . [ 6 ] Junyoung Chung , Caglar Gulcehre , KyungHyun Cho , and Yoshua Bengio . 2014 . Empirical evaluation of gated recurrent neural networks on sequence modeling . arXiv preprint arXiv : 1412 . 3555 ( 2014 ) . [ 7 ] Songgaojun Deng , Shusen Wang , Huzefa Rangwala , Lijing Wang , and Yue Ning . 2020 . Cola - GNN : Cross - location attention based graph neural networks for long - term ILI prediction . In Proceedings of the 29th ACM international conference on information & knowledge management . 245 – 254 . [ 8 ] AngelNDesai , MoritzUGKraemer , SangeetaBhatia , AnneCori , PierreNouvellet , MarkHerringer , EmilyLCohn , MalwinaCarrion , JohnSBrownstein , LawrenceC Madoff , et al . 2019 . Real - time epidemic forecasting : challenges and opportunities . Health security 17 , 4 ( 2019 ) , 268 – 275 . [ 9 ] Martin Eichenbaum , Sergio T Rebelo , and Mathias Trabandt . 2020 . Epidemics in the neoclassical and new - Keynesian models . ( 2020 ) . [ 10 ] Jeffrey L Elman . 1990 . Finding structure in time . Cognitive science 14 , 2 ( 1990 ) , 179 – 211 . [ 11 ] Enrique Frias - Martinez , Graham Williamson , and Vanessa Frias - Martinez . 2011 . An agent - based model of epidemic spread using human mobility and social network information . In IEEE international conference on privacy , security , risk and trust and IEEE international conference on social computing . IEEE , 57 – 64 . [ 12 ] Junyi Gao , Rakshith Sharma , Cheng Qian , Lucas M Glass , Jeffrey Spaeder , Justin Romberg , Jimeng Sun , and Cao Xiao . 2021 . STAN : spatio - temporal attention network for pandemic prediction using real - world evidence . Journal of the American Medical Informatics Association 28 , 4 ( 2021 ) , 733 – 743 . [ 13 ] Nicholas C Grassly and Christophe Fraser . 2008 . Mathematical models of infec - tious disease transmission . Nature Reviews Microbiology 6 , 6 ( 2008 ) , 477 – 487 . [ 14 ] Shaobo He , Yuexi Peng , and Kehui Sun . 2020 . SEIR modeling of the COVID - 19 and its dynamics . Nonlinear dynamics 101 ( 2020 ) , 1667 – 1680 . [ 15 ] SeppHochreiterandJürgenSchmidhuber . 1997 . Longshort - termmemory . Neural computation 9 , 8 ( 1997 ) , 1735 – 1780 . [ 16 ] Ruvim Izikson , Daniel Brune , Jean - Sébastien Bolduc , Pierre Bourron , Marion Fournier , Tamala Mallett Moore , Aseem Pandey , Lucia Perez , Nessryne Sater , AnjuShrestha , etal . 2022 . Safetyandimmunogenicityofahigh - dosequadrivalent influenza vaccine administered concomitantly with a third dose of the mRNA - 1273 SARS - CoV - 2 vaccine in adults aged 65 years : a phase 2 , randomised , open - label study . The Lancet Respiratory Medicine 10 , 4 ( 2022 ) , 392 – 402 . [ 17 ] Shan Jiang , Yingxiang Yang , Siddharth Gupta , Daniele Veneziano , Shounak Athavale , and Marta C González . 2016 . The TimeGeo modeling framework for urban mobility without travel surveys . Proceedings of the National Academy of Sciences 113 , 37 ( 2016 ) , E5370 – E5378 . [ 18 ] AmolKapoor , XueBen , LuyangLiu , BryanPerozzi , MattBarnes , MartinBlais , and Shawn O’Banion . 2020 . Examining covid - 19 forecasting using spatio - temporal graph neural networks . arXiv preprint arXiv : 2007 . 03113 ( 2020 ) . [ 19 ] Nikos Kargas , Cheng Qian , Nicholas D Sidiropoulos , Cao Xiao , Lucas M Glass , and Jimeng Sun . 2021 . Stelar : Spatio - temporal tensor factorization with latent epidemiologicalregularization . In ProceedingsoftheAAAIConferenceonArtificial Intelligence , Vol . 35 . 4830 – 4837 . [ 20 ] Cliff C Kerr , Robyn M Stuart , Dina Mistry , Romesh G Abeysuriya , Katherine Rosenfeld , Gregory R Hart , Rafael C Núñez , Jamie A Cohen , Prashanth Selvaraj , Brittany Hagedorn , et al . 2021 . Covasim : an agent - based model of COVID - 19 dynamics and interventions . PLOS Computational Biology 17 , 7 ( 2021 ) , e1009149 . [ 21 ] ThomasNKipfandMaxWelling . 2016 . Semi - supervisedclassificationwithgraph convolutional networks . arXiv preprint arXiv : 1609 . 02907 ( 2016 ) . [ 22 ] Moritz UG Kraemer , Nick Golding , Dionisio Bisanzio , Samir Bhatt , David M Pigott , SE Ray , OJ Brady , JS Brownstein , NR Faria , DAT Cummings , et al . 2019 . Utilizing general human movement models to predict the spread of emerging infectious diseases in resource poor settings . Scientific reports 9 , 1 ( 2019 ) , 5151 . [ 23 ] Shannon L LaDeau , Gregory E Glass , N Thompson Hobbs , Andrew Latimer , and Richard S Ostfeld . 2011 . Data – model fusion to better understand emerging pathogens and improve infectious disease forecasting . Ecological Applications 21 , 5 ( 2011 ) , 1443 – 1460 . [ 24 ] Ying Liu and Joacim Rocklöv . 2022 . The effective reproductive number of the Omicron variant of SARS - CoV - 2 is several times relative to Delta . Journal of Travel Medicine 29 , 3 ( 2022 ) , taac037 . [ 25 ] Dang Lien Minh , Abolghasem Sadeghi - Niaraki , Huynh Duc Huy , Kyungbok Min , and Hyeonjoon Moon . 2018 . Deep learning approach for short - term stock trends prediction based on two - stream gated recurrent unit network . Ieee Access 6 ( 2018 ) , 55392 – 55404 . [ 26 ] Xiaolan Mo , Xiujuan Chen , Chifong Ieong , Xia Gao , Yingjie Li , Xin Liao , Huabin Yang , Huiyi Li , Fan He , Yanling He , et al . 2021 . Early prediction of tacrolimus - induced tubular toxicity in pediatric refractory nephrotic syndrome using ma - chine learning . Frontiers in Pharmacology 12 ( 2021 ) , 638724 . [ 27 ] Charles Murphy , Edward Laurence , and Antoine Allard . 2021 . Deep learning of contagion dynamics on complex networks . Nature Communications 12 , 1 ( 2021 ) , 4720 . [ 28 ] Petrônio CL Silva , Paulo VC Batista , Hélder S Lima , Marcos A Alves , Frederico G Guimarães , and Rodrigo CP Silva . 2020 . COVID - ABS : An agent - based model of COVID - 19 epidemic to simulate health and economic effects of social distancing interventions . Chaos , Solitons & Fractals 139 ( 2020 ) , 110088 . [ 29 ] Alexis Akira Toda . 2020 . Susceptible - infected - recovered ( sir ) dynamics of covid - 19 and economic impact . arXiv preprint arXiv : 2003 . 11221 ( 2020 ) . [ 30 ] Ashish Vaswani , Noam Shazeer , Niki Parmar , Jakob Uszkoreit , Llion Jones , Aidan N Gomez , Łukasz Kaiser , and Illia Polosukhin . 2017 . Attention is all you need . Advances in neural information processing systems 30 ( 2017 ) . [ 31 ] Petar Veličković , Guillem Cucurull , Arantxa Casanova , Adriana Romero , Pietro Lio , and Yoshua Bengio . 2017 . Graph attention networks . arXiv preprint arXiv : 1710 . 10903 ( 2017 ) . [ 32 ] Lijing Wang , Jiangzhuo Chen , and Madhav Marathe . 2019 . DEFSI : Deep learning based epidemic forecasting with synthetic information . In Proceedings of the AAAI Conference on Artificial Intelligence , Vol . 33 . 9607 – 9612 . [ 33 ] Shuai Xia , Qiaoshuai Lan , Yun Zhu , Chao Wang , Wei Xu , Yutang Li , Lijue Wang , Fanke Jiao , Jie Zhou , Chen Hua , et al . 2021 . Structural and functional basis for pan - CoV fusion inhibitors against SARS - CoV - 2 and its variants with preclinical evaluation . Signal Transduction and Targeted Therapy 6 , 1 ( 2021 ) , 288 . [ 34 ] Zifeng Yang , Zhiqi Zeng , Ke Wang , Sook - San Wong , Wenhua Liang , Mark Zanin , Peng Liu , Xudong Cao , Zhongqiang Gao , Zhitong Mai , et al . 2020 . Modified SEIR and AI prediction of the epidemics trend of COVID - 19 in China under public health interventions . Journal of thoracic disease 12 , 3 ( 2020 ) , 165 . [ 35 ] ZhitaoYing , JiaxuanYou , ChristopherMorris , XiangRen , WillHamilton , andJure Leskovec . 2018 . Hierarchical graph representation learning with differentiable pooling . Advances in neural information processing systems 31 ( 2018 ) . [ 36 ] Linyun Yu , Peng Cui , Fei Wang , Chaoming Song , and Shiqiang Yang . 2015 . From micro to macro : Uncovering and predicting information cascading process with behavioral dynamics . In IEEE international conference on data mining . IEEE , 559 – 568 . [ 37 ] Juanjuan Zhang , Maria Litvinova , Yuxia Liang , Yan Wang , Wei Wang , Shanlu Zhao , Qianhui Wu , Stefano Merler , Cécile Viboud , Alessandro Vespignani , et al . 2020 . Changes in contact patterns shape the dynamics of the COVID - 19 outbreak in China . Science 368 , 6498 ( 2020 ) , 1481 – 1486 . SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Region division Region population distribution Human travel rhythm TimeGeo Individual trajectories ICM Disease transmission dynamics Micro - graph Figure 4 : Data generation logic A DATASET GENERATION We can use the data generation logic shown in Figure 4 to simulate the movement trajectories of a specific number of people based on TimeGeo . We then obtain a microscopic contact graph of all users in all regions by statistics . Unlike the regional micro - graphs , there is no concept of regions in this graph , and all users are used as nodes , and the edges are the contacts between users at the current moment . Afterwards , we use ICM based on this microscopic contact graph to simulate the disease status of each user on a specific number of days . Use TimeGeo to simulate user trajectories : To simulate user trajectories , the TimeGeo model is used in conjunction with real - world human travel rhythms . The TimeGeo model is a mechanical model that generates urban traffic patterns based on the inferred location of home and work activities . It takes into account seasons , weather and holidays , and other variables to determine each indi - vidual’s activity time , number of trips per day , and visit times . the key features of the TimeGeo model are three factors : number of trips per week 𝑛 𝑤 , dwell rate 𝛽 1 , and burst rate 𝛽 2 . To generate move - ment restriction data , during dataset generation using TimeGeo , we introduce two novel parameters : the travel limit threshold ( 𝑇𝐻 ) and trajectory decay rate ( 𝑅 𝑐 ) . Specifically , when the number of infected people ratio does not reach the threshold 𝑇𝐻 , human mobility is the same as when there is no intervention , and after the number of infected people ratio reaches 𝑇𝐻 , we use the decay rate 𝑅 𝑐 to act on the number of trips per week 𝑛 𝑤 to simulate the movement restriction mechanism , i . e . , the new number of trips 𝑛 𝑟𝑒𝑠𝑤 = 𝑛 𝑤 × 𝑅 𝑐 . These features allow inferring the duration of activity , the number of trips per day and the duration of visits to each location for each individual . By setting parameters in TimeGeo , the movement tra - jectories of a specific number of people at a specific time can be generated on a microscopic user contact graph . Use ICM to simulate infectious disease dynamics : After using TimeGeo to generate individual trajectories , the I ndependent C ontagion M odel ( ICM ) is used to simulate the dynamics of infec - tious diseases on this graph . The ICM is based on the SIS concept [ 27 ] , and uses two hyper - parameters to simulate the spread of dis - ease on a specific network : the daily recovery rate ( 𝛾 ) of the disease and the transmission rate ( 𝛽 ) . Using the probability of disease and recovery for a particular user , the propagation of disease can be modeled day - by - day on the micro - graph . Specifically , if a user’s status is infected at the current moment , the probability of recovery at the next moment is 𝛽 , as described by : 𝑃𝑟 ( 𝐼 → 𝑆 ) = 𝛽 . ( 20 ) If a user’s status is susceptible at the current moment , their proba - bility of infection at the next moment is independently propagated by their first - order neighbors as follows : 𝑃𝑟 ( 𝐼 → 𝑆 | 𝑙 ) = 1 − ( 1 − 𝛾 ) 𝑙 , ( 21 ) in which 𝑙 is the infected first - order neighbors of a specific individ - ual . Figure 5 : Trends of infectious diseases in different 𝑇𝐻 and 𝑅 𝑐 scenarios Tuning parameters to generate different data sets : By tun - ing the parameters of TimeGeo and ICM , we can generate the fol - lowing two types of datasets : • Generation of no intervention dataset In this type of dataset , human movement is always unaffected by external factors such as policy , so we set 𝑛 𝑤 = 2 , 𝛽 1 = 60 , 𝛽 2 = 80 , and hold it constant throughout the transmission of the infection . Because the human mobility throughout the transmission of the infectious disease received no effect , we set 𝑇𝐻 = 1 and 𝑅 𝑐 = 0 . The infectious disease transmission curve generated by this method is shown as " No restriction " in Figure 5 . • Generation of movement restriction datasets We generate this type of dataset with the original data kept the same as when there is no movement restriction , i . e . , 𝑛 𝑤 = 2 , 𝛽 1 = 60 , and 𝛽 2 = 80 . However , we can generate the propagation curves after the change of human mobility in different cases SIGSPATIAL ’23 , November 13 – 16 , 2023 , Hamburg , Germany Yinzhou Tang , et al . by changing 𝑇𝐻 and 𝑅 𝑐 , as shown in Figure 5 . In this experi - ment , for simplicity , we only use one curve , 𝑇𝐻 = 0 . 5 and 𝑅 𝑐 = 0 . 5 , in Figure 5 . To set 𝛽 and 𝛾 , we use a basic regeneration number of infectious diseases R0 of 8 . 6 and a recovery period 𝜙 of 7 days based on previ - ous research [ 24 ] . The relationship between the basic regeneration number , recovery period , and transmission and recovery rates of infectious diseases enables us to obtain the parameters of transmis - sion to simulate the disease spread using the ICM mechanism on the network . B MODEL EVALUATION METRICS After getting the prediction results of the model , we can evaluate the absolute error and relative error of the model by comparing with the true value using RMSE and SMAPE , respectively . For ease of description , suppose that for day 𝑖 in the future 𝐿 𝑃 days , the predicted number of infected people in one of the 𝑁 regions , 𝑛 , is ˆ 𝑦 𝑖𝑛 and the true number is 𝑦 𝑖𝑛 , then RMSE and SMAPE can be defined as follows . Use RMSE to evaluate absolute errors : The RMSE defined below evaluates the average number of the root mean square error over the prediction window over all regions : 𝑅𝑀𝑆𝐸 = √︄ 1 𝑁 ∑︁ 𝑁 1 𝐿 𝑃 ∑︁ 𝐿 𝑃 (cid:0) ˆ 𝑦 𝑖𝑛 − 𝑦 𝑖𝑛 (cid:1) 2 . ( 22 ) Use SMAPE to evaluate relative errors : The SMAPE defined below evaluates the average number of the symmetric mean abso - lute percentage error over the prediction window over all regions : 𝑆𝑀𝐴𝑃𝐸 = 1 𝑁 ∑︁ 𝑁 1 𝐿 𝑃 ∑︁ 𝐿 𝑃 (cid:12)(cid:12) ˆ 𝑦 𝑖𝑛 − 𝑦 𝑖𝑛 (cid:12)(cid:12) (cid:0)(cid:12)(cid:12) ˆ 𝑦 𝑖𝑛 (cid:12)(cid:12) − (cid:12)(cid:12) 𝑦 𝑖𝑛 (cid:12)(cid:12)(cid:1) / 2 × 100 % . ( 23 )
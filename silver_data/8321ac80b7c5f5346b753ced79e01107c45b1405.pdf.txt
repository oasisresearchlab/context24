a r X i v : 1503 . 08583v2 [ m a t h - ph ] 1 A p r 2015 Hierarchical Random Graphs Based on Motifs Monika Kotorowicz ∗ Yuri Kozitsky † April 2 , 2015 Abstract Network motifs are characteristic patterns which occur in the networks essentially more frequently than the other patterns . For ﬁve motifs found in S . Itzkovitz , U . Alon , Phys . Rev . E , 2005 , 71 , 026117 - 1 , hierarchical random graph models are proposed in which the motifs appear at each hierarchical level . A rigorous construction of such graphs is performed and a number of their structural properties are analyzed . This includes degree distribution , amenability , clustering , and the small world property . For one of the motifs , annealed phase transitions in the Ising model based on the corresponding graph are also studied . 1 Introduction In view of the complexity and unknown organizing principles of large real - world networks , they usually are modeled by means of random graphs , the study of which traces back to P . Erd˝os and A . R´enyi [ 1 ] . Many of such networks contain characteristic patterns recurring essentially more frequently than the other ones . These are network motifs [ 2 , 3 , 4 , 5 ] . Quite often real networks are build up mostly of motifs , which thus can be treated as constructing units for their modeling , cf . [ 5 ] . In [ 3 ] , the authors introduced a random graph model based on some geometric principles ( constraints ) . Then they compared the appearance of eight elementary three - and four - node patterns in their model with the same characteristics of the Erd˝os - R´enyi random graph . It turned out that ﬁve of these patterns are motifs for their model , but not for the Erd˝os - R´enyi random graph , see Fig . 1 . ✡✡✡✡ ❏❏❏❏ ✡✡✡✡ ❏❏❏❏ (cid:0)(cid:0)(cid:0)(cid:0) (cid:0)(cid:0)(cid:0)(cid:0)❅❅❅❅ Figure 1 : Three and four node motifs M 1 , M 2 , M 3 , M 4 , M 5 found in [ 3 ] . One of the ways to get information about inﬁnite graphs is to study the properties of certain models of statistical physics deﬁned thereon . The most popular ones are the Ising and Potts models , see [ 6 ] . On the other hand , graphs are employed to mimic crystal lattices . For graphs with special structure , the critical behavior of the Ising model can be described in an explicit and rigorous way . This , in particular , holds for the so - called hierarchical lattices introduced in [ 7 , 8 ] . Such lattices are constructed in an algorithmic way by means of basic patterns , e . g . , by a ‘diamond’ , see M 3 in Fig . 1 . The relative simplicity of the theory makes hierarchical lattices attractive in studying critical point behavior of various types , see quite recent works [ 9 , 10 ] and the references therein . A mathematical description of the Gibbs states of the Ising model on such graphs was done by P . M . Bleher and E . ˇZalys in [ 11 , 12 ] . M . Hinczewski and A . Nihat Berker [ 13 ] studied the critical point properties of the Ising model on the diamond hierarchical lattice ‘decorated’ by adding random bonds . In the present paper , we follow the way suggested in [ 13 ] and introduce hierarchical graphs constructed by means of the motifs shown in Fig . 1 , decorated by random bonds which somehow repeat the corresponding motif . We analyze a number of their characteristics , such as the average degree , the node degree distribution , amenability , the ∗ Instytut Matematyki , Uniwersytet Marii Curie - Sk lodwskiej , 20 - 031 Lublin , Poland , e - mail : monika @ hektor . umcs . lublin . pl † Instytut Matematyki , Uniwersytet Marii Curie - Sk lodwskiej , 20 - 031 Lublin , Poland , e - mail : jkozi @ hektor . umcs . lublin . pl 1 small - world property . We also study a ferromagnetic phase transition in the Ising model deﬁned on the graph based on M 1 . A preliminary study of the models introduced here was performed in [ 14 , 15 ] . 2 The Graphs : Construction and Structural Properties 2 . 1 The construction : informal description As is typical for hierarchical graphs , e . g . , for hierarchical lattices in [ 8 , 13 ] , the construction is carried out in an algorithmic way : at k - th level , k ∈ N , one produces a subgraph , say Λ k , which is then used as a construction element for producing Λ k + 1 . The procedure is the same at each level . The starting element at level 1 is obtained from the corresponding motif . Let us illustrate this in the simplest case based on M 1 – the triangle . To obtain Λ 1 , we label the nodes of M 1 by a , b , and c , as shown in Fig . 2 . The graph Λ 2 is created in two step . First we take three graphs of level 1 and label them by Λ a 1 , Λ b 1 and Λ c 1 . Thereafter , the triangles are being glued up according to the following rule : for i , j ∈ { a , b , c } , i 6 = j , node i of triangle Λ j 1 is glued up with node j of triangle Λ i 1 . The nodes i od triangle Λ i 1 remain untouched . These are the external nodes of Λ 2 . The remaining nodes are called internal . The bonds of the initial triangles Λ i 1 , i ∈ { a , b , c } turn into the bonds of Λ 2 . We call them basic bonds ; they are depicted as solid lines . At the second step , we add bonds connecting the external nodes in the same way as it is in the motif M 1 . Such bonds are depicted as dotted lines and called decorations . As a result , we obtain the graph Λ 2 , which has nine basic bonds and three decorations , three external and three internal nodes . ✡✡✡ ❏❏❏ a b c Λ a 1 ✡✡✡ ❏❏❏ a b c Λ b 1 ✡✡✡ ❏❏❏ a b c Λ c 1 ✲ ✡✡✡ ❏❏❏ a ✡✡✡ ❏❏❏ b ✡✡✡ ❏❏❏ c ✲ ✡✡✡ ❏❏❏ a ✡✡✡ ❏❏❏ b ✡✡✡ ❏❏❏ c Figure 2 : Construction of the graph Λ 2 based on M 1 To obtain Λ k , k = 3 , 4 , . . . , we repeat the same procedure - take three copies of Λ k − 1 and label them by Λ ak − 1 , Λ bk − 1 , and Λ ck − 1 . Then the graphs Λ ik − 1 , i ∈ { a , b , c } are glued up as described above . Thereafter , three decorating bonds are drawn to connect the external nodes . This procedure is repeated ad inﬁnitum . 2 . 2 Deﬁnitions In this subsection we begin performing the mathematical construction of the model outlined above . In order to ﬁx the terminology , we recall relevant mathematical notions . A simple graph G is a pair of sets ( V , E ) , where V is the set of nodes , whereas E is a subset of the Cartesian product V × V . It is symmetric and irreﬂexive , i . e . , h j , i i ∈ E whenever h i , j i ∈ E , and h i , i i / ∈ E for every i , j ∈ V . We say that i and j are connected by a bond if h i , j i ∈ E . In this case , we write i ∼ j and say that i and j are adjacent or that they are neighbors . Hence , the elements of E themselves can be called bonds . The graph is said to be complete , if each two nodes are adjacent . For a given i , by n ( i ) we denote the degree of i – the number of its neighbors . If V , and hence E , are ﬁnite , the graph is said to be ﬁnite . Otherwise , the graph is inﬁnite . An inﬁnite graph is called locally ﬁnite , if n ( i ) is ﬁnite for every node . Given G = ( V , E ) and G ′ = ( V ′ , E ′ ) , let φ : V → V ′ be such that φ ( i ) ∼ φ ( j ) whenever i ∼ j . Such a map φ is called a morphism . A bijective morphism is called an isomorphism . If φ is an isomorphism , then its inverse φ − 1 is also an isomorphism , and then the graphs G and G ′ are said to be isomorphic . Such graphs have identical structures and thus can be identiﬁed . In this case , we also say that G ′ is a copy of G . One observes that this refers to both ﬁnite and inﬁnite graphs . An isomorphism φ : V → V , i . e . which maps the graph onto itself , is called an automorphism . The graph G ′ = ( V ′ , E ′ ) such that V ′ ⊂ V and E ′ ⊂ E is said to be a subgraph of G = ( V , E ) . In this case , we write G ′ ⊂ G . Suppose that a subgraph G ′ ⊂ G has a copy , say G ′′ , 2 that is , there exists an isomorphism φ : G ′′ → G ′ . Then φ , considered as a map φ : G ′′ → G , is called an embedding of G ′′ into G , whereas G ′ is called the image of G ′′ under this embedding . Fig . 1 presents the so called unlabeled graphs , which are studied in this work . After labeling , i . e . , attaching a label to each of the nodes , such a pattern turns into a graph . Another labeling may or may not give the same graph up to an automorphism . This depends on whether or not there exists the corresponding automorphism . ✡✡✡✡ ❏❏❏❏ a b c ✡✡✡✡ ❏❏❏❏ a b c d a b d c a b d c a b d c (cid:0)(cid:0)(cid:0)(cid:0) (cid:0)(cid:0)(cid:0)(cid:0)❅❅❅❅ Figure 3 : Labelled graphs of level one based on motifs M 1 , M 2 , M 3 , M 4 , M 5 . For instance , any labeling of the triangle M 1 yields the same graph as in any case each of the nodes has the same neighbors . So the triangle has six automorphisms . For the pattern M 2 , the corresponding graph shown in Fig . 3 with the interchanged labels a and b is the same . However , the graph with the interchanged c and d is not the same anymore . Of course , this new graph is isomorphic to the initial one . This is because there is only one nontrivial automorphism of M 2 : the one which interchanges a and b , and preserves c and d . Let G ′ ⊂ G and G ′′ ⊂ G and there exists an isomorphism φ : G ′ → G ′′ . Then we can consider φ as an equivalence G ′ ∼ G ′′ . The equivalence class of G ′ is deﬁned as the set [ G ′ ] = { G ′′ : G ′ ∼ G ′′ } . It is called motif . If the number of appearances of motif [ G ′ ] in a network G is higher than the number of its appearances in the Erd˝os - R´enyi random graph , then [ G ′ ] is called network motif . Now we present the notion of a random graph , which we use in this work . The random graph model is deﬁned to be a pair consisting of an underlying graph G = ( V , E ) and a probability space ( E , E , P ) . If G is ﬁnite , as E one can take the set of all subsets of E . In the sequel , we deal with such random graph models only . Thus , for E ′ ∈ E , we say that E ′ has been picked at random with probability P ( E ′ ) . In many models , the bonds are being picked independently with probability which may depend on the bond . In this case , one deals with a random graph model with independent bonds . For such graphs , P ( E ′ ) = Y e ∈ E ′ p ( e ) , ( 2 . 1 ) where p ( e ) is the probability of picking bond e . The set of graphs { G ′ = ( V , E ′ ) } E ′ ∈E is called the graph ensemble – each G ′ is being picked at random from this ensemble . Now suppose that we have two random graph models with independent bonds . We have to specify the deﬁnition of isomorphism for such graphs . Let G 1 = ( V 1 , E 1 ) and G 2 = ( V 2 , E 2 ) be their underlying graphs and p 1 , p 2 be their corresponding probability ( 2 . 1 ) . Then the map φ : V 1 → V 2 is said to be the isomorphism of the random graphs if there exists isomorphism f : G 1 → G 2 ( in the meaning shown previously for non - random graphs ) such , that for every h i , j i ∈ E we have p 1 ( h i , j i ) = p 2 ( h f ( i ) , f ( j ) i ) . 2 . 3 The construction As was mentioned above , each of our graphs is constructed in an algorithmic way from the corresponding motif presented in Fig . 1 . As they are random graphs with independent bonds , we have to construct the corresponding underlying graphs and to deﬁne the probability of picking the bonds , cf . ( 2 . 1 ) . In all our models , the bonds will be of two kinds , which we call basic bonds and decorations . Basic bonds are non - random , i . e . , picked with probability one . Decorating bonds appear with probability p ∈ [ 0 , 1 ] , which is a parameter of the model . Now we present the formal construction of the underlying graphs . Let q be the number of nodes in the corresponding motif , i . e . , q = 3 for M 1 and q = 4 for the remaining motifs . At step k = 1 , we just label the nodes of the corresponding motif by i = 1 , . . . , q and obtain the initial graph Λ 1 = ( V 1 , E 1 ) . All its bonds are set to be basic . Suppose now that we have q + 1 copies of Λ 1 obtained by the 3 isomorphisms φ j 2 , j = 0 , 1 , . . . , q . Thus , in j - th copy the nodes are φ j 2 ( i ) , i = 1 , . . . , q . The graph Λ 2 is obtained from these copies under the following conditions φ 02 ( i ) = φ i 2 ( i ) , i = 1 , . . . , q ; φ i 2 ( j ) = φ j 2 ( i ) , i = 1 , . . . , q , i 6 = j . ( 2 . 2 ) Thus , the images of V 1 under φ i 2 and φ j 2 with i 6 = j intersect only at one node where ( 2 . 2 ) holds . The maps φ j 2 , j = 0 , 1 , . . . , q embed Λ 1 into Λ 2 . The nodes φ i 2 ( i ) , i = 1 , . . . , q , are called the external nodes of Λ 2 . All other nodes are called internal . Thus , Λ 2 has q external and q ( q − 1 ) / 2 internal nodes . At this stage , we label them by i = 1 , . . . , q ( q + 1 ) / 2 in such a way that the external nodes have the same labels as in Λ 1 , that is , φ i 2 ( i ) = i , i = 1 , . . . q . By construction , the bonds obtained as images under the map φ 02 are decorations : they are of the form h φ 02 ( i ) , φ 02 ( j ) i where i and j are adjacent in Λ 1 . From the ﬁrst condition in ( 2 . 2 ) we see that the decorating bonds connect the external nodes of Λ 2 . The remaining bonds of Λ 2 are set to be basic . Now we construct Λ k for k ≥ 3 from one copy of Λ 1 and q copies of Λ k − 1 . Let φ 0 k be the map which produces the copy of Λ 1 and φ jk , j = 1 , . . . , q be the maps which produce the copies of Λ k − 1 . We then impose the conditions φ 0 k ( i ) = φ ik ( i ) , i = 1 , . . . , q ; φ ik ( j ) = φ jk ( i ) , i = 1 , . . . , q , i 6 = j ( 2 . 3 ) and obtain Λ k . Thus , φ 0 k embeds Λ 1 → Λ k , and φ ik : Λ k − 1 → Λ k , i = 1 , 2 , . . . , q . As above , the nodes φ ik ( i ) are set to be external , and the remaining nodes are internal . The images of V 2 under φ ik and φ jk with i 6 = j intersect only at one node where ( 2 . 3 ) holds . Again we label the nodes of Λ k is such a way that φ ik ( i ) = i , i = 1 , . . . , q . Now let us establish which bonds of Λ k − 1 are decorating and which are basic . As above , the bonds connecting the external nodes are decorating . The images of decorating bonds of Λ k − 1 are decorating bonds in Λ k ; the same is true also for the basic bonds – the basic bonds of Λ k are exactly the images of the basic bonds of Λ k − 1 . As above , by V k and E k we denote the sets of nodes and bonds of Λ k , respectively . Thus , for k ≥ 2 we have E k = E ′ k ∪ E ′′ k , where E ′ k ( respectively , E ′′ k ) consists of basic ( respectively , decorating ) bonds . All Λ k , k ∈ N , are considered as subgraphs of an inﬁnite graph Λ ∞ , the structure and properties of which are not important for the study presented in this article . Note that the construction principle used above essentially diﬀers from that used in [ 8 , 11 , 12 , 13 ] . Namely , in our case to obtain Λ k one replaces each node of the basic pattern by a copy of the graph Λ k − 1 . In the hierarchical lattices , one replaces a bond . As we shall see in the sequel , this leads to essentially diﬀerent properties of the resulting graphs . Below in Fig . 4 , we illustrate the construction described above for the case where the basic pattern is the motif M 1 . In this case , the bare graph ( which occurs for p = 0 ) is the approximating graph for the Sierpi´nski triangle . The elements of E ′ 2 ( middle graph ) and of E ′ 3 ( right - hand graph ) are depicted as solid lines , whereas the elements of E ′′ 2 and of E ′′ 3 appear as dotted lines . We omit some dotted lines to indicate that they are random and hence may be absent in a given realization of the graph . Note that Λ 3 can be viewed as the triangle composed from three copies of Λ 2 . In Fig . 5 , we present the construction of the bare graph Λ 3 corresponding to M 2 . In contrast to the former case , it is not a planar graph . In Fig . 4 , we construct the bare graph Λ 2 for motif M 3 . One observes that in this picture the node c of the lower left - hand quadrat ( i . e . quadrat a ) is glued up with node a of the upper right - hand quadrat . It is interesting that the corresponding fractal can be obtained by the following procedure , resembling the one which yields the Sierpi´nski triangle . One takes the full quadrat and cuts it out into four equal quadrates , not cutting the external lines . Then one glues up the vertices of the smaller quadrates as depicted and proceeds with cutting out the smaller quadrates . The fractal which one obtains from M 5 is a three dimensional version of the Sierpi´nski triangle . One takes the full tetrahedra and cuts out its inner one fourth in such a way that the remaining four tetrahedrae are glued up according to the rule : vertex b of tetrahedra a is glued up with vertex a of tetrahedra b , etc . 2 . 4 Degree distribution Now we turn to the structural properties of the graphs constructed above . Here and subsequently , q and r stand for the number of nodes and bonds in the corresponding motif , respectively . By the construction described above , the number of nodes in Λ k is | V k | = q | V k − 1 | − q ( q − 1 ) / 2 and | V 1 | = q . Likewise , the expected number of bonds is | E 1 | = r and h | E k | i = q h | E k − 1 | i + rp . Hence | V k | = q k + q 2 , h | E k | i = rq k − 1 + rp q k − 1 − 1 q − 1 , k ∈ N . ( 2 . 4 ) 4 ✡✡✡ ❏❏❏ a b c ✲ ✡✡✡ ❏❏❏✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏ a b γ c β α ✲ ✡✡✡ ❏❏❏✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏✡✡✡ ❏❏❏ ✡✡✡ ❏❏❏ a b c Figure 4 : Construction of the graph Λ 3 based on M 1 ✟✟✟✟✟✟✁✁✁ a b c d ✲ ✟✟✟✟✟✟✁✁✁✟✟✟✟✟✟✁✁✁✁✁✁✟✟✟✟✟✟✁✁✁ a b c d ✲ a ✟✟✟✟✟✟✁✁✁✟✟✟✟✟✟✁✁✁✁✁ ✁ ✟✟✟✟✟✟✁✁✁ α b ✟✟✟✟✟✟✁✁✁✟✟✟✟✟✟✁✁✁✁✁ ✁ ✟✟✟✟✟✟✁✁✁ β γ c ✁✁✁✁✁✁✁✁✁ δ ǫ ζ d ✟✟✟✟✟✟✁✁✁✟✟✟✟✟✟✁✁✁✁✁✁✟✟✟✟✟✟✁✁✁ Figure 5 : Construction of the bare graph Λ 3 based on M 2 As was mentioned above , the degree distribution is an important characteristic of the graph . In contrast to the Erd˝os - R´enyi type graphs , the distribution of the random variable n ( i ) in our graphs depends on the type of i . Thus , the simplest way to describe this distribution is to average n ( i ) over the nodes of a given Λ k , that is , to consider n k = | V k | − 1 P i ∈ V k n ( i ) . Let h n k i be the expected value of n k . Then h n k i = 2 h | E k | i | V k | = 4 r q ( q − 1 ) (cid:16) q − 1 + p − q − 1 + 2 p q k − 1 + 1 (cid:17) . ( 2 . 5 ) However , this result gives only partial information about the node degree distribution . To get more let us analyze the structure of the node sets V k , k = 1 , 2 , . . . . For a given Λ k and l = 1 , . . . , k , let V ( l ) k be the set of nodes i ∈ V k which have the same degree distribution , independent of k for l ≤ k − 1 . For the graphs based on regular motifs M 1 , M 3 and M 5 , V ( l ) k consists of the nodes which are external for some Λ l and , at the same time , are internal for any Λ l + 1 . Here we mean those Λ l ’s which are subgraphs for Λ k . As an example , let us consider the graph Λ 2 based on M 1 , see the middle graph in Fig . 4 . The nodes a , b , and c constitute V ( 2 ) 2 , d c a b ✲ d c a b Figure 6 : Construction of the bare graph Λ 2 based on M 3 5 whereas the remaining nodes constitute V ( 1 ) 2 . For M 2 and M 4 , this partition is more complicated and will be discussed below . First we analyze Λ k based on complete motifs M 1 and M 5 . The elements of V ( k − 1 ) k are exactly the nodes at which the subgraphs Λ jk − 1 , j = 1 , . . . , q are glued up to form Λ k , whereas the elements of V ( k ) k are exactly the external nodes of Λ k . Then | V ( k ) k | = q and | V ( k − 1 ) k | = q ( q − 1 ) / 2 . For l < k − 1 , we have | V ( l ) k | = q | V ( l ) k − 1 | , which can be solved to yield | V ( l ) k | = 1 2 q k − l ( q − 1 ) , l = 1 , . . . , k − 1 , | V ( k ) k | = q . ( 2 . 6 ) The degrees of i ∈ V ( 1 ) k are non - random as these nodes receive no decorating bonds . For such i , n ( i ) = P j n ( 0 ) ( j ) , where n ( 0 ) ( j ) is the degree of the corresponding node in the basic pattern , and the sum is taken over all such patterns which are glued up . By the symmetry of M 1 and M 5 , we have that n ( i ) = 4 for M 1 and n ( i ) = 6 for M 5 . For i ∈ V ( l ) k , l = 2 , 3 , . . . , k − 1 , we have n ( i ) = ˜ n ( i ) + ν ( i ) , where ˜ n ( i ) is non - random and has to be calculated as just described . The summand ν ( i ) is the number of decorating bonds attached to i . For l = 1 , . . . , k − 1 and i ∈ V ( l ) k , we have ˜ n ( i ) = 2 ( q − 1 ) and ν ( i ) takes values ν = 0 , 1 , 2 , . . . , 2 ( q − 1 ) ( l − 1 ) , with probability Prob ( ν ( i ) = ν ) = (cid:18) 2 ( q − 1 ) ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 2 ( q − 1 ) ( l − 1 ) − ν . ( 2 . 7 ) For i ∈ V ( k ) k , ν ( i ) takes values 0 , 1 , . . . , ( q − 1 ) ( k − 1 ) . As is usual in the theory of real world networks , which are in fact non - random , the randomness manifests itself as the random choice of a node . If we apply this principle here , then ( 2 . 7 ) can be considered as the conditional probability distribution , conditioned at the event that the node i is been picked from the set V ( l ) k . The probability of this event is taken to be proportional to the number of elements , that is , Prob (cid:16) i ∈ V ( l ) k (cid:17) = | V ( l ) k | | V k | = q − 1 1 + q 1 − k q − l , l ≤ k − 1 , ( 2 . 8 ) Prob (cid:16) i ∈ V ( k ) k (cid:17) = 2 q k − 1 + 1 . Now we take the expectation of n ( i ) with respect to this distribution and obtain 1 h n k i = q k − 1 ( 2 q − 2 + 2 p ) − 2 p q k − 1 + 1 , ( 2 . 9 ) which agrees with ( 2 . 5 ) . In the same way we ﬁnd the second moment h n 2 i = 4 ( q − 1 ) 2 + ( 8 q − 6 ) p + ( 4 q + 2 ) p 2 . In order to ﬁgure out the limit k → + ∞ of the distribution given by ( 2 . 7 ) and ( 2 . 8 ) we calculate its characteristic function , cf . ( 5 . 1 ) , ϕ k ( t ) = k − 1 X l = 1 2 ( q − 1 ) ( l − 1 ) X ν = 0 e ( 2 ( q − 1 ) + ν ) i t ( q − 1 ) · q − l 1 + q 1 − k · · (cid:18) 2 ( q − 1 ) ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 2 ( q − 1 ) ( l − 1 ) − ν + + ( q − 1 ) ( k − 1 ) X ν = 0 e ( q − 1 + ν ) i t 2 q k − 1 + 1 × (cid:18) ( q − 1 ) ( k − 1 ) ν (cid:19) p ν ( 1 − p ) ( q − 1 ) ( k − 1 ) − ν . Then the limiting characteristic function is ϕ ( t ) = ( q − 1 ) e 2 ( q − 1 ) i t q − ( e i t p + 1 − p ) 2 ( q − 1 ) . ( 2 . 10 ) 1 Detailed calculations of this and similar quantities are given in Appendix below . 6 As was mentioned above for the graph based on M 3 , the same node partition can be applied also for the graphs based on M 1 and M 5 . Motif M 3 is regular hence ( 2 . 6 ) and ( 2 . 8 ) still holds . Here for l = 1 , 2 , . . . , k − 1 and i ∈ V ( l ) k we have n ( i ) = 4 + ν ( i ) and ν ( i ) takes values ν = 0 , 1 , 2 , . . . , 4 ( l − 1 ) with probability Prob ( ν ( i ) = ν ) = (cid:18) 4 ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 4 ( l − 1 ) − ν . The external node i ∈ V ( k ) k has random degree ν ( i ) = 0 , 1 , . . . , 2 ( k − 1 ) . Taking the expectation of n ( i ) with respect to this distribution one obtains , see Appendix , h n k i = 4 + 4 3 (cid:18) p − 3 + 2 p 4 k − 1 + 1 (cid:19) , ( 2 . 11 ) and the k → + ∞ limit of the second moment h n 2 i = 16 + 12 p + 68 9 p 2 . The characteristic function is ϕ k ( t ) = 3 e 4i t 1 + 4 1 − k · 1 − 4 1 − k (cid:0) e i t p + 1 − p (cid:1) 4 ( k − 1 ) 4 − ( e i t p + 1 − p ) 4 + + 2 e 2i t 4 k − 1 + 1 (cid:0) e i t p + 1 − p (cid:1) 2 ( k − 1 ) , i = √− 1 , which in the limit k → ∞ takes the form ϕ ( t ) = 3 e 4i t 4 − ( e i t p + 1 − p ) 4 . ( 2 . 12 ) It remains to analyze the graphs based on M 2 and M 4 . Label the nodes of M 2 as shown in the Fig . 3 . For the external nodes of the corresponding graph , we have n ( a ) = n ( b ) = 2 + ν ( a ) , ν = 0 , 1 , . . . , 2 ( k − 1 ) , n ( c ) = 3 + ν ( v ) , ν = 0 , 1 , . . . , 3 ( l − 1 ) , n ( d ) = 1 + ν ( d ) , ν = 0 , 1 , . . . , k − 1 . For each l = 1 , 2 , . . . , k − 1 set the V ( l ) k consists of three subsets of the same cardinality with the following degrees n ( i ) = 3 + ν ( i ) , ν = 0 , 1 , . . . , 3 ( l − 1 ) , n ( i ) = 4 + ν ( i ) , ν = 0 , 1 , . . . , 4 ( l − 1 ) , n ( i ) = 5 + ν ( i ) , ν = 0 , 1 , . . . , 5 ( l − 1 ) . This yields , see Appendix , h n k i = 4 + 4 3 (cid:18) p − 3 + 2 p 4 k − 1 + 1 (cid:19) , ( 2 . 13 ) and the second moment h n 2 i = 50 3 + 112 9 p + 214 27 p 2 . For the characteristic function , we have ϕ k ( t ) = 1 1 + 4 1 − k h e 3i t 1 − 4 1 − k ( pe i t + 1 − p ) 3 ( k − 1 ) 4 − ( pe i t + 1 − p ) 3 + + e 4i t 1 − 4 1 − k ( pe i t + 1 − p ) 4 ( k − 1 ) 4 − ( pe i t + 1 − p ) 4 + + e 5i t 1 − 4 1 − k ( pe i t + 1 − p ) 5 ( k − 1 ) 4 − ( pe i t + 1 − p ) 5 i + + 2 4 k + 4 h 2 e 2i t ( pe i t + 1 − p ) 2 ( k − 1 ) + + e 3i t ( pe i t + 1 − p ) 3 ( k − 1 ) + e i t ( pe i t + 1 − p ) k − 1 i , 7 which in the limit k → ∞ yields ϕ ( t ) −→ e 3i t 4 − ( e i t p + 1 − p ) 3 + e 4i t 4 − ( e i t p + 1 − p ) 4 + ( 2 . 14 ) + e 5i t 4 − ( e i t p + 1 − p ) 5 . For the graphs based on M 4 , we obtain h n k i = 5 + 5 3 (cid:16) p − 3 + 2 p 4 k − 1 + 1 (cid:17) h n 2 i = 76 3 + 167 9 p + 335 27 p 2 , ϕ ( t ) = e 4i t 2 (cid:0) 4 − ( e i t p + 1 − p ) 4 (cid:1) + 2 e 5i t 4 − ( e i t p + 1 − p ) 5 + ( 2 . 15 ) + e 6i t 2 (cid:0) 4 − ( e i t p + 1 − p ) 6 (cid:1) . For all our graphs , the limiting characteristics functions can be continued to functions analytic in some complex neighborhood of the point t = 0 . This means that the limiting node degree distribution has all moments and hence cannot be of scale - free type 2 . Another observation here is that the characteristic function of the Poisson distribution ϕ Poisson ( t ) = exp (cid:2) c (cid:0) e i t − 1 (cid:1)(cid:3) , can be continued to a function analytic on the whole complex plane . Therefore , the degree distributions in our graphs with p > 0 are intermediate as compared to the Poisson and scale - free distributions . For p = 0 , our functions ( 2 . 10 ) , ( 2 . 12 ) , ( 2 . 14 ) , ( 2 . 15 ) are also entire . 2 . 5 Amenability The property of our graphs which we address now is amenability . Let G = ( V , E ) be a countable graph with node set V and bond set E . For a ﬁnite ∆ ⊂ V , by ∂ ∆ we denote the set of nodes which are not in ∆ but have neighbors in ∆ . By | ∆ | and | ∂ ∆ | we denote the number of elements in these sets . The graph G is said to be amenable if there exists a sequence of ﬁnite node sets { ∆ k } k ∈ N , such that lim k → + ∞ | ∂ ∆ k | | ∆ k | = 0 . ( 2 . 16 ) If such a limit is positive for any sequence { ∆ k } k ∈ N , the graph is called nonamenabile . Some - times , sequences for which ( 2 . 16 ) holds are called Van Howe sequences . Cayley trees , except for Z , are nonamenable . Let us consider the underlying graphs of our random graphs . Due to their hierarchical structure , it is convenient to check ( 2 . 16 ) for the sequence of node sets of Λ k , that is for { V k } k ∈ N . By the construction of Λ k , the inner boundary of each V k is the set of all its external nodes , the number of which is equal to the number of nodes in the corresponding motif , i . e . it is q . By construction , q − 1 of them become inner nodes of Λ k + 1 , and receive new k ( q − 1 ) neighbors ( and none in the next steps ) . The remaining one becomes an external node of Λ k + 1 . We can choose { V k } k ∈ N in the way that this external node becomes an internal one in the next step . And then it receives new ( q − 1 ) ( k + 2 ) neighbors outside Λ k and none in the next steps . Then for all the graphs we obtain | ∂ Λ k | | Λ k | = k ( q − 1 ) 2 + ( q − 1 ) ( k + 2 ) 12 ( q k + q ) k →∞ −−−→ 0 , which means that all our random graphs are amenable with probability one . 2 For scale - free graphs , the node degree distribution is P ( k ) = Ck − γ , k ≥ 1 , γ > 1 ; hence , P ∞ k = 1 k m P ( k ) diverges for all m ≥ γ − 1 . 8 2 . 6 Clustering For a given node i ∈ V of degree n ( i ) , let N ( i ) be the number of bonds linking its neighbors with each other , which is the number of triangles with vertex i . Clearly , N ( i ) ≤ n ( i ) [ n ( i ) − 1 ] / 2 and the maximum value of this parameter is attained for complete graphs where each node is a neighbor to all other ones . Thus , the quantity Q ( i ) : = 2 N ( i ) n ( i ) [ n ( i ) − 1 ] characterizes clustering at node i . Then the clustering of our graphs we deﬁne as Q = lim k → + ∞ 1 | V k | X i ∈ V k Q ( i ) . Note that for many graphs , e . g . , for trees or bipartite graphs , one has Q ( i ) = 0 for any node i , see also [ 16 , 17 ] . For random graphs , the degree n ( i ) , as well as the parameter N ( i ) , are random . The calculation of Q in this case is much more involved . We will address it in a forthcoming paper . Here we only compare the values of Q obtained for the bare and fully decorated versions of our graphs , i . e . , for p = 0 and p = 1 . For the bare graph Λ k based on M 1 , we have n ( i ) = 4 for internal node i ∈ V k and n ( i ) = 2 for external node i ∈ V k . Besides N ( i ) =    3 i ∈ V ( 1 ) k , 2 i ∈ V ( l ) k , l = 2 , 3 , . . . , k − 1 , 1 i ∈ V ( k ) k , which follows directly from the construction of the graphs . By ( 2 . 4 ) and ( 2 . 6 ) one gets 1 | V k | X i ∈ V k Q ( v ) = 1 | V k | k X l = 1 X i ∈ V ( l ) k Q ( i ) = = | V ( 1 ) k | 2 | V k | + | V k | − | V ( 1 ) k | − 3 3 | V k | + 3 | V k | = 1 3 + | V ( 1 ) k | 6 | V k | + 2 | V k | . Hence , Q = lim k → + ∞ 1 | V k | X i ∈ V k Q ( i ) = 4 9 = 0 , 4444 . . . . For the fully decorated graph based on M 1 , internal node i ∈ V ( l ) k , l = 1 , 2 , . . . , k − 1 , has degree n ( i ) = 4 l and N ( i ) = 4 l whereas for external node i ∈ V ( k ) k , we have n ( i ) = 2 k and N ( i ) = 2 k − 1 . Then 1 | V k | X i ∈ V k Q ( i ) = 1 | V k | k X l = 1 X i ∈ V ( l ) k Q ( v ) = = 1 | V k |   k − 1 X l = 1 X i ∈ V ( l ) k 2 · 4 l 4 l ( 4 l − 1 ) + | V ( k ) k | 2 ( 2 k − 1 ) 2 k ( 2 k − 1 )   = = 1 | V k | 2 · 3 k k − 1 X l = 1 3 − l 4 l − 1 + 3 k ! = 4 · 3 k 3 k + 3 k − 1 X l = 1 3 − l 4 l − 1 + 6 k ( 3 k + 3 ) . Hence Q = 2 · 3 − 1 / 4 arctan 3 − 1 / 4 − 3 − 1 / 4 ln 3 1 / 4 + 1 3 1 / 4 − 1 ≈ 0 , 525897 . For the bare graph based on M 5 , one obtains for internal node i ∈ V ( l ) k , l = 1 , 2 , . . . , k − 1 : n ( i ) = 6 , N ( i ) = 8 for l = 1 , and n ( i ) = 6 , N ( i ) = 6 for l ≥ 2 . For the fully decorated graph 9 based on M 5 we have for all internal nodes n ( i ) = 6 l , and N ( i ) = 8 for l = 1 , and N ( i ) = 12 l − 3 for l ≥ 2 . Hence , for the bare graph , we get Q = lim k → + ∞ 2 5 + 2 | V ( 1 ) k | 15 | V k | + 12 5 | V k | ! = 0 . 5 , ( 2 . 17 ) and for the fully decorated graph Q ≈ 0 . 554145 , which surprisingly is quite close to the clustering in the bare version ( 2 . 17 ) . 2 . 7 Small - world property There exists one more property of real - world networks which Erd˝os - R´enyi type graphs do not share , see e . g . [ 18 , 19 ] . It is the so called small - world property . To formulate it one needs the following notion . A path in the graph is a sequence of nodes such that every two consecutive elements are neighbors to each other . The length of the path is the number of such consecutive pairs , which is equal to the number of bonds one passes on the way from the origin to the terminus . If every two nodes can be connected by a path , the graph is said to be connected . For a given two nodes , i and j , the length of the shortest path connecting them is said to be the distance ρ ( i , j ) between these nodes . Informally speaking , a graph G = ( V , E ) has the small - world property ( is a small - world graph ) if every two nodes i , j ∈ V are ‘not too far’ from each other . More precisely this property is formulated as follows . An inﬁnite graph G has a small - world property if there exists a sequence of its connected ﬁnite subgraphs { G k } k ∈ N with the following property . Let diam ( G k ) = max i , j ∈ V k ρ ( i , j ) be the diameter of G k , k ∈ N , and h n k i be the average value of the node degree in G k , that is , h n k i = 2 | E k | / | V k | . Then the sequence { G k } k ∈ N , and hence the graph G , are said to have the small - world property if there exists a positive constant C such that for all k ∈ N diam ( G k ) ≤ C log h n k i | V k | . In such graphs , the distances between the nodes scale at most logarithmically with the size of the graph . Let us consider this characteristic of our graphs without decorations , i . e . , for p = 0 . For a chosen motif , the diameter or Λ k is the maximum distance between two external nodes diam ( Λ k ) = max i , j ρ ( i , j ) , i , j ∈ V ( k ) k , i 6 = j . For the complete motifs M 1 and M 5 there is diam ( Λ 1 ) = 1 , and for the other motifs diam ( Λ 1 ) = 2 . By the construction of Λ k , k = 2 , 3 , . . . , it is easily seen that the distances between two external nodes increases two times ay each step . Hence diam ( Λ k ) = 2 k − 1 for M 1 and M 5 , diam ( Λ k ) = 2 k for M 2 , M 3 and M 4 , that means that the diameters scale exponentially with the size of the graph . For p = 1 , the distance between two chosen external nodes in Λ k , k = 1 , 2 , . . . , is 1 . Hence , we have to analyze the distances between other pairs of nodes . Here we present the results for graphs based on motif M 1 only . The distance between an internal and an external node in Λ 2 does not exceed 2 . The distance between two such nodes in Λ 3 is not greater than 3 , and k in Λ k . Therefore , to estimate the distance between two internal nodes in Λ k , one has to ﬁnd the greatest l ≤ k − 1 such that these nodes belong to diﬀerent Λ l . Then add the distances between these nodes and the common external node . Hence diam ( Λ k ) ≤ 2 ( k − 1 ) . Thus , neither of our bare graphs has the small - world property . At the same time , this property holds for all fully decorated graphs . 10 3 Phase Transitions in the Ising Model There exists a deep connection between the properties of Gibbs random ﬁelds of the Ising model and the structural properties of the underlying graphs , see [ 6 ] . In the physical terminology , each ( pure ) Gibbs random ﬁeld corresponds to a state of thermal equilibrium of the model , see [ 20 ] for more details . Accordingly , the existence of multiple Gibbs random ﬁelds corresponds to the existence of multiple equilibrium states and hence to phase transitions . For noninteracting spins , the Gibbs random ﬁeld is unique . However , if the interaction is strong enough and if it is eﬀectively propagated by the underlying graph ( due to high ’connectivity’ ) , the Gibbs ﬁelds can be multiple . The Ising model on an inﬁnite graph G = ( V , E ) is deﬁned by assigning spin variables σ i = ± 1 , i ∈ V . Two spins , σ i and σ j , interact whenever i ∼ j . The space of spin conﬁgurations is then Σ : = { − 1 , 1 } V . It is equipped with the discrete topology and the corresponding Borel σ - ﬁeld . A Gibbs random ﬁeld is deﬁned as a probability measure on Σ which satisﬁes a certain condition formulated by means the so called Gibbs speciﬁcation , see [ 20 ] . The speciﬁcation in turn is constructed by means of conditional model Hamiltonians , deﬁned as follows . For a ﬁnite ∆ ⊂ V , ξ ∈ Σ , and a ﬁxed value of the inverse temperature β > 0 , the conditional Hamiltonian in ∆ is given by the following expression − β H ∆ ( σ ∆ | ξ ) = h X i ∈ ∆ σ i + X { i , j } ∈ E ∆ J ij σ i σ j + X i ∈ ∆ X j ∈ ∆ c : i ∼ j J ij σ i ξ j , ( 3 . 1 ) where σ ∆ = { σ i : i ∈ ∆ } , h is an external ﬁeld , and J ij ∈ R is the spin - spin interaction intensity . Note that the latter parameters include β . For hierarchical graphs constructed in an algorithmic way , the inﬁnite graph ( V , E ) is obtained as limiting object , deﬁned by means of a system of embeddings which map each ﬁnite fragment into the graph , see [ 11 , 12 ] . In this article , however , we do not follow this way and consider the annealed case , see [ 21 ] , where one deals exclusively with states on such ﬁnite fragments . Here we mean the randomness related to the decorating bonds . In view of the hierarchical structure of our graphs , we take ∆ = ∆ k in ( 3 . 1 ) to be the set of the inner nodes of a given Λ k corresponding to motif M 1 . Then j in the last term in ( 3 . 1 ) runs through the set of external vertices of Λ k . We also restrict our consideration to the case of h = 0 . For k = 1 we have no internal nodes and no randomness either . Thus the corresponding Hamiltonian is − β H 1 = K ( ab + ac + bc ) , here we use the shorthand like a = σ a , and K stands for the interaction intensity corresponding to nonrandom bonds . Recall that , for k > 1 , by E ′ k ( resp . E ′′ k ) we denote the set of solid ( resp . decorating ) bonds of Λ k . To take the latter randomness into account we introduce independent random variables ω ∈ { 0 , 1 } E ′′ k such that Prob ( ω ij = 1 ) = p . Then we set J ij = J ωij = K for h i , j i ∈ E ′ k , and J ij = J ωij = Lω ij for h i , j i ∈ E ′′ k . In general , we assume that K 6 = L as the random and nonrandom bonds play diﬀerent roles in our constructions . The nonrandom bonds form a skeleton of the graphs , whereas the random ones increase its connectivity . Moreover , by setting K = 0 we can pass to the model deﬁned on a purely random graph . Then , for k ≥ 2 , ( 3 . 1 ) takes the form − β H k ( σ ∆ k | a , b , c ) : = − β H ∆ k ( σ ∆ k | a , b , c ) = L ( ω ab ab + ω ac ac + ω bc bc ) ( 3 . 2 ) + a X i ∈ N ak J ωai σ i + b X i ∈ N bk J ωbi σ i + c X i ∈ N ck J ωci σ i + X h i , j i∈ E ink J ωij σ i σ j , where N vk = { i ∈ V k : i ∼ v } is the set of the neighbors of v in Λ k and E ink ⊂ E k is the set of bonds connecting the inner nodes of Λ k to each other . The Hamiltonian in ( 3 . 2 ) can be rewritten in a recursion way , see Fig . 7 , as follows − β H k ( σ ∆ k | a , b , c ) = L ( ω ab ab + ω ac ac + ω bc bc ) − β H k − 1 ( σ ∆ ak − 1 | a , γ , β ) − β H k − 1 ( σ ∆ b k − 1 | γ , b , α ) − β H k − 1 ( σ ∆ c k − 1 | β , α , c ) , ( 3 . 3 ) 11 ✡✡✡✡✡ ❏❏❏❏❏✡✡✡✡✡ ❏❏❏❏❏ ✡✡✡✡✡ ❏❏❏❏❏ a b γ c β α Λ ak − 1 Λ bk − 1 Λ ck − 1 Figure 7 : Graph Λ k where ∆ xk − 1 stands for the set of inner nodes of Λ xk − 1 , x ∈ { a , b , c } . Then the annealed Gibbs distribution in Λ k is deﬁned as follows π ωk ( σ ∆ k | a , b , c ) = 1 Z k ( a , b , c ) exp ( − β H k ( σ ∆ k | a , b , c ) ) , k ≥ 2 , and π ω 1 = 1 as ∆ 1 = ∅ . Here the partition function has the form Z k ( a , b , c ) = (cid:28) X σ k exp ( − β H k ( σ ∆ k | a , b , c ) ) (cid:29) , Z 1 ( a , b , c ) = exp ( K ( ab + ac + bc ) ) , and h·i denotes the expectation in ω . For k ≥ 2 let f : { − 1 , 1 } ∆ k → R be a local observable , which is a function dependent on σ Λ m with some m < k such that Λ m ⊂ Λ k . Set F k ( f | a , b , c ) = X σ ∆k (cid:28) f ( σ ∆ k ) π ωk ( σ ∆ k | a , b , c ) (cid:29) , k > m . ( 3 . 4 ) The sequence { F k ( f | a , b , c ) } k ≥ m is bounded and thus has accumulation points . Our aim is to study their dependence on the values of the boundary spins a , b , c . In view of the independence of the bond variables ω , we have Z k ( a , b , c ) = (cid:28) exp ( Lω ab ab ) (cid:29)(cid:28) exp ( Lω ac ac ) (cid:29)(cid:28) exp ( Lω bc bc ) (cid:29) ( 3 . 5 ) × X α , β , γ Z k − 1 ( a , γ , β ) Z k − 1 ( γ , b , α ) Z k − 1 ( β , α , c ) . Assume now that the observable f depends on the spins indexed by Λ m ⊂ ∆ ak − 1 . Then by ( 3 . 3 ) and ( 3 . 4 ) we have F k ( f | a , b , c ) = 1 Z k ( a , b , c ) (cid:28) exp ( Lω ab ab ) (cid:29)(cid:28) exp ( Lω ac ac ) (cid:29)(cid:28) exp ( Lω bc bc ) (cid:29) × X α , β , γ (cid:20)(cid:28) X σ ∆ak − 1 f ( σ ∆ ak − 1 ) exp (cid:16) − β H k − 1 ( σ ∆ ak − 1 | a , γ , β ) (cid:17) (cid:29) × × (cid:28) X σ ∆bk − 1 exp (cid:16) − β H k − 1 ( σ ∆ bk − 1 | γ , b , α ) (cid:17) (cid:29) × × (cid:28) X σ ∆ck − 1 exp (cid:16) − β H k − 1 ( σ ∆ ck − 1 | β , α , c ) (cid:17) (cid:29)(cid:21) , k > m , that can be rewritten as follows F k ( f | a , b , c ) = ( 3 . 6 ) = P α , β , γ F k − 1 ( f | a , γ , β ) Z k − 1 ( a , γ , β ) Z k − 1 ( γ , b , α ) Z k − 1 ( β , α , c ) P α , β , γ Z k − 1 ( a , γ , β ) Z k − 1 ( γ , b , α ) Z k − 1 ( β , α , c ) . 12 From now on we assume that the locality of f is such that it m = 1 , see ( 3 . 4 ) , and that the corresponding Λ 1 is a subset of Λ ak − 1 for all k ≥ 2 . Then , in addition to ( 3 . 4 ) , we set F 1 ( f | a , b , c ) = f ( a , b , c ) = f ( a , c , b ) > 0 , ( 3 . 7 ) where we assume also that f is positive and symmetric with respect to b ↔ c . Next we introduce the following variables A k : = Z k ( 1 , 1 , 1 ) = Z k ( − 1 , − 1 , − 1 ) , ( 3 . 8 ) B k : = Z k ( 1 , ± 1 , ∓ 1 ) = Z k ( − 1 , ± 1 , ∓ 1 ) , Y 1 k : = F k ( f | 1 , 1 , 1 ) = F k ( f | − 1 , − 1 , − 1 ) , Y 2 k : = F k ( f | 1 , 1 , − 1 ) = F k ( f | 1 , − 1 , 1 ) , Y 3 k : = F k ( f | 1 , − 1 , − 1 ) = F k ( f | − 1 , 1 , 1 ) , and R + = (cid:0) pe L + 1 − p (cid:1) 3 , R − = (cid:0) pe L + 1 − p (cid:1) (cid:0) pe − L + 1 − p (cid:1) 2 . Then from ( 3 . 5 ) and ( 3 . 6 ) we get A k + 1 = R + (cid:0) A 3 k + 3 A k B 2 k + 4 B 3 k (cid:1) , B k + 1 = R − (cid:0) A 2 k + 4 A k B 2 k + 3 B 3 k (cid:1) , ( 3 . 9 ) and Y 1 k + 1 = Y 1 k A k ( A 2 k + B 2 k ) + 2 Y 2 k B 2 k ( A k + B k ) + 2 Y 3 k B 3 k A 3 k + 3 A k B 2 k + 4 B 3 k , ( 3 . 10 ) Y 2 k + 1 = Y 1 k A k B k ( A k + B k ) + 2 Y 2 k B 2 k ( A k + B k ) + Y 3 k B 2 k ( A k + B k ) B k A 2 k + 4 A k B 2 k + 3 B 3 k , Y 3 k + 1 = 2 Y 1 k A k B 2 k + 2 Y 2 k B 2 k ( A k + B k ) + Y 3 k B k ( A 2 k + B 2 k ) B k A 2 k + 4 A k B 2 k + 3 B 3 k , with the initial conditions A 1 = e 3 K , B 1 = e − K , ( 3 . 11 ) and Y 11 = f ( 1 , 1 , 1 ) , Y 21 = f ( 1 , 1 , − 1 ) , Y 31 = f ( 1 , − 1 , − 1 ) . Then for x k = A k / B k , x 1 = e 4 K > 0 , ( 3 . 12 ) by ( 3 . 9 ) we get x k + 1 = tφ ( x k ) , where φ ( x ) = x 3 + 3 x + 4 x 2 + 4 x + 3 = x 2 − x + 4 x + 3 , ( 3 . 13 ) and t = R + R − = (cid:18) pe L + 1 − p pe − L + 1 − p (cid:19) 2 . ( 3 . 14 ) In these notations , ( 3 . 10 ) can be rewritten in the following form Y k + 1 = T ( x k ) Y k , k ∈ N , ( 3 . 15 ) where Y k is the column vector transposed to ( Y 1 k , Y 2 k , Y 3 k ) and T ( x ) =   x ( x 2 + 1 ) x 3 + 3 x + 4 2 ( x + 1 ) x 3 + 3 x + 4 2 x 3 + 3 x + 4 x ( x + 1 ) x 2 + 4 x + 3 2 ( x + 1 ) x 2 + 4 x + 3 x + 1 x 2 + 4 x + 3 2 x x 2 + 4 x + 3 2 ( x + 1 ) x 2 + 4 x + 3 x 2 + 1 x 2 + 4 x + 3   . ( 3 . 16 ) 13 Observe that , for each x > 0 , T ( x ) is a stochastic matrix , which means that each of its rows consists of nonnegative elements and sums up to one . Then , for each k ∈ N , the matrix S k = T ( x k ) T ( x k − 1 ) · · · T ( x 2 ) T ( x 1 ) ( 3 . 17 ) is also stochastic , and the solution of the recursion in ( 3 . 15 ) is Y k + 1 = S k Y 1 . ( 3 . 18 ) Products of stochastic matrices as in ( 3 . 17 ) appear in the theory of inhomogeneous Markov chains , see e . g . [ 22 , 23 , 24 ] . They also are being used in communication networks , control theory , parallel computing , and decision making , see [ 25 , 26 , 27 , 28 ] and the references therein . As mentioned above , our aim is to study the limits of the sequences { Y ik } , i = 1 , 2 , 3 , deﬁned in ( 3 . 8 ) – ( 3 . 11 ) , and hence described by ( 3 . 15 ) , ( 3 . 18 ) . If , for an arbitrary Y 1 , the limit Y ∞ = lim k →∞ Y k is a vector with all components equal to each other , then the limiting average ( 3 . 4 ) is independent of the boundary spins , which corresponds to the uniqueness of the limiting Gibbs state , and hence of the state of thermal equilibrium of the model . In the terminology of Markov chains , this is related to the ergodicity of the sequence { T ( x k ) } . By deﬁnition , see e . g . [ 28 , Deﬁnition 1 , page 1479 ] , such a sequence is ergodic if the product sequence { S k } as in ( 3 . 17 ) converges to a stochastic matrix with identical rows . In [ 26 ] , such a sequence is called consensus . In this case , the sequence { Y k } converges to a vector with identical entries . Likewise , the existence of subsequences { Y k l } l ∈ N convergent to vectors with nonequal components corresponds to the multiplicity of such states , and hence of a phase transition . Since we do not introduce the Gibbs states of our model explicitly , we use the following Deﬁnition 3 . 1 . For ﬁxed K , L i p , the Ising model on our graph is said to be in an unordered state if for each observable f satisfying ( 3 . 7 ) , there exists lim k → + ∞ F k ( f | a , b , c ) independent of b and c , and hence of a . Otherwise , the model is said to be in an ordered state . As might be seen from ( 3 . 15 ) , the limiting properties of the sequence { x k } k ∈ N are crucial for the corresponding properties of { Y k } k ∈ N . Lemma 3 . 2 . Assume that the sequence { x k } k ∈ N deﬁned in ( 3 . 12 ) – ( 3 . 14 ) converges to a certain x ∗ > 0 . Then the sequence { T ( x k ) } k ∈ N deﬁned in ( 3 . 16 ) is ergodic . Proof . By deﬁnition , each row τ i = ( τ i 1 , . . . , τ in ) of a stochastic matrix T = ( τ ij ) n × n is a proba - bility distribution . For two such rows , we deﬁne k τ i − τ j k = 1 2 n X l = 1 | τ il − τ jl | . Then the Dobrushin ergodicity coeﬃcient of T is D ( T ) : = max i , j = 1 , . . . , n k τ i − τ j k . It can also be written in the form : D ( T ) = 1 − min i < j n X l = 1 min { τ il ; τ jl } , which yields that D ( T ) < 1 whenever all τ ij are strictly positive , see [ 27 ] for more detail on this issue . On the other hand , for two stochastic matrices T and Q , it is known that , see [ 23 , Chapter 3 ] , D ( T Q ) ≤ D ( T ) ( Q ) . ( 3 . 19 ) Since the matrix elements of T ( x ) in ( 3 . 16 ) are continuous in x > 0 , one has T ( x k ) → T ( x ∗ ) , component - wise , as k → + ∞ . Therefore , each element of the latter matrix is strictly positive , which yields D ( T ( x ∗ ) ) = : δ < 1 . By the mentioned continuity we also have that , for a given ǫ > 0 such that δ + ǫ < 1 , there exists k ǫ such that D ( T ( x k ) ) < δ + ǫ < 1 for all k > k ǫ . This yields by ( 3 . 17 ) and ( 3 . 19 ) that D ( S k ) → 0 . As a sequence of stochastic matrices , { S k } k ∈ N contains convergent subsequences , each of which converges to a stochastic matrix S with strictly positive elements , for which D ( S ) = 0 . By the Perron - Frobenius theorem there exists only one such limit . 14 For a given k ∈ N , let d ( Y k ) be the diameter of Y k , that is , d ( Y k ) : = max i , j = 1 , 2 , 3 ( Y ik − Y jk ) . It is known that , see [ 27 ] , for each Y 1 , d ( S k Y 1 ) ≤ D ( S k ) d ( Y 1 ) , which yields d ( Y k ) → 0 as k → ∞ if { T ( x k ) } k ∈ N is ergodic . On the other hand , for each ǫ > 0 , one ﬁnds Y 1 with positive entries such that d ( S k Y 1 ) > [ D ( S k ) − ǫ ] d ( Y 1 ) . ( 3 . 20 ) As possible limits of { x k } k ∈ N , there can appear the solutions of the following equation : x = tφ ( x ) , x > 0 . ( 3 . 21 ) First , let us consider the case of L < 0 where the interaction along the random bonds is antifer - romagnetic . Then t < 1 , see ( 3 . 14 ) , and the only solution of ( 3 . 21 ) is x ∗ = − 3 − t + √ 9 + 22 t − 15 t 2 2 ( 1 − t ) < 1 , ( 3 . 22 ) which is clearly positive . By ( 3 . 13 ) we have φ ′ ( x ) = 1 − (cid:18) 4 x + 3 (cid:19) 2 . Therefore , the solution ( 3 . 22 ) is stable and x k → x ∗ for all x 1 > 0 . Thus , by Lemma 3 . 2 the model is in an unordered state for such L and all K ∈ R and p ∈ [ 0 , 1 ] . This possibly holds due to the frustration caused by the motif the graph is based on . For L = 0 , i . e . , for the graph without decorations , we have t = 1 and the only solution of ( 3 . 21 ) is x ∗ = 1 . In this case , the model is in an unordered state for all K ∈ R . Let us turn now to the case of L > 0 , in which t > 1 . Now ( 3 . 21 ) has two solutions x ( 1 ) ∗ = 3 + t − √ 9 + 22 t − 15 t 2 2 ( t − 1 ) , x ( 2 ) ∗ = 3 + t + √ 9 + 22 t − 15 t 2 2 ( t − 1 ) , which exist and are distinct provided t ∈ ( 1 , 9 / 5 ) . ( 3 . 23 ) By direct calculations we get that tφ ′ ( x ( 1 ) ∗ ) < 1 and tφ ′ t ( x ( 2 ) ∗ ) > 1 , see Fig . 8 . Hence , x ( 1 ) ∗ is stable , whereas x ( 2 ) ∗ is unstable . This means that lim k → + ∞ x k =   x ( 1 ) ∗ if x 1 < x ( 2 ) ∗ ; x ( 2 ) ∗ if x 1 = x ( 2 ) ∗ ; + ∞ if x 1 > x ( 2 ) ∗ . ( 3 . 24 ) Note also that x ( 1 ) ∗ → 1 and x ( 2 ) ∗ → ∞ as t → 1 . Lemma 3 . 3 . Assume that x 1 > x ( 2 ) ∗ , and hence x k → ∞ as k → ∞ . Then the sequence { T ( x k ) } k ∈ N deﬁned in ( 3 . 16 ) is not ergodic . Proof . The proof will be done by showing that the sequence of γ k = T 23 ( x k ) + T 32 ( x k ) , k ∈ N , is summable . This will imply that the sequence { T ( x k ) } k ∈ N fails to have the inﬁnite ﬂow property in the sense of [ 28 , Deﬁnition 2 , page 1479 ] . This implies in turn , see [ 28 , Theorem 1 , page 1480 ] and also [ 25 ] , the property in question . Standard linearization yields x k + 1 − x ( 2 ) ∗ ≥ κ ( x k − x ( 2 ) ∗ ) , κ : = tφ ′ ( x ( 2 ) ∗ ) , 15 ✲ ✻ (cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0)(cid:0) 43 t x ( 1 ) ∗ x ( 2 ) ∗ tφ ( x ) Figure 8 : Graphical solution of ( 3 . 21 ) which can be iterated to give x k + 1 − x ( 2 ) ∗ ≥ κ k ( x 1 − x ( 2 ) ∗ ) . At the same time , by ( 3 . 16 ) it follows that γ k = 3 x k + 3 < 3 x k − x ( 2 ) ∗ ≤ 3 κ − ( k − 1 ) x k − x ( 2 ) ∗ , which is summable as κ > 1 . By ( 3 . 20 ) we obtain from the latter the following Corollary 3 . 4 . For each x 1 > x ( 2 ) ∗ , there exist ǫ > 0 and the observable f such that , for each k ∈ N , one ﬁnds l > k with the property d ( Y l ) > ǫ . Hence , the model is in an ordered state . The unstable solution x ( 2 ) ∗ corresponds to the critical point which separates two basins of attraction , see ( 3 . 24 ) . Note that the sequence { T ( x k ) } k ∈ N is still ergodic since all the entries of T ( x ( 2 ) ∗ ) = T ( x k ) , k ∈ N , are strictly positive . Now let us turn to the condition ( 3 . 23 ) . It yields p < ψ ( L ) : = 3 − √ 5 √ 5 exp ( L ) − 3 exp ( − L ) + 3 − √ 5 . As ψ ( L ) is a decreasing function , the equation ψ ( L ) = 1 has a unique solution L ∗ = 1 4 ln 9 5 . ( 3 . 25 ) For L < L ∗ , one has ψ ( L ) > 1 , which means that t < 9 / 5 for all p ∈ ( 0 , 1 ] . For such L and p , let K ∗ ( L , p ) be the solution of the equation exp ( 4 K ) = x ( 2 ) ∗ > 1 . Then ( 3 . 24 ) can be rewritten in the form lim k → + ∞ x k =   x ( 1 ) ∗ if K < K ∗ ( L , p ) ; x ( 2 ) ∗ if K = K ∗ ( L , p ) ; + ∞ if K > 4 K ∗ ( L , p ) . ( 3 . 26 ) For t = 9 / 5 , we have x ( 1 ) ∗ = x ( 2 ) ∗ = 3 , which corresponds to K ∗ = ( ln 3 ) / 4 . In this case , x k → 3 if K ≤ K ∗ , and x k → + ∞ if K > K ∗ . For L > L ∗ there exists p ∗ = ψ ( L ) < 1 such , that for p ∈ ( 0 , p ∗ ) , there exists K ∗ ( L , p ) with the properties as in ( 3 . 26 ) . For p ∈ [ p ∗ , 1 ] , the whole graph of tφ lies above the line tφ ( x ) = x , which means that x k → + ∞ for all initial x 1 ≥ 0 . The results of the analysis just performed can be summarized in the following form . 16 Theorem 3 . 5 . The Ising model on the graph based on M 1 and described by the Hamiltonian ( 3 . 2 ) has the following properties related to Deﬁnition 3 . 1 : ( i ) for L ≤ 0 , it is in an unordered state for all values of K ∈ R and p ∈ [ 0 , 1 ] ; ( ii ) for L ∈ ( 0 , L ∗ ] as in ( 3 . 25 ) and p ∈ ( 0 , 1 ] , there exists K ∗ ( L , p ) > 0 such that the model is in an unordered state for K ≤ K ∗ ( L , p ) , and in an ordered state for K > K ∗ ( L , p ) ; for K = K ∗ ( L , p ) , the model is in the critical state ; ( iii ) for L > L ∗ , there exists p ∗ ∈ ( 0 , 1 ) such that , for p < p ∗ , there exists K ∗ ( L , p ) with the properties as in item ( ii ) ; for p ∈ [ p ∗ , 1 ] , the model is in an ordered state for all K . 4 Concluding Remarks In this article , we introduce hierarchical random graphs based on motifs presented in Fig . 1 . The construction principles resemble those used in [ 13 ] : a nonrandom skeleton ( hierarchical diamond lattice in [ 13 ] ) is accompanied by random bonds . In our case they repeat the motif used in the construction . As a result , the motif appears at each hierarchical level . The construction is performed in a rigorous way and is illustrated by an informal description . The analysis of the node degree distribution in the constructed graphs is based on characteristic functions obtained in an explicit form . For p > 0 , these functions are meromorphic for all motifs . This means that , for all our graphs , the node degree as a random variable has all moments with the property h n m i ∼ C m m ! . Thus , the degree distributions are intermediate as compared to the Poisson and scale - free cases . Such properties as clustering and small world property are studied only for p = 0 , 1 . In particular , it turns out that for all motifs the small world property is absent for p = 0 and present for p = 1 . Thus , it would be interesting to ﬁnd out how and at which value of p is emerges . In Theorem 3 . 5 , we analyze phase transitions in the Ising model based on motif M 1 . Unlike to [ 13 ] in our case the Ising model has no phase transition for p = 0 , which manifests the diﬀerence between our construction and that used in [ 13 ] . We also show that , for L ≤ L ∗ , the model is in an unordered state whenever K = 0 , i . e . , the spin - spin interactions along the nonrandom bonds is absent . For L > L ∗ and p ≥ p ∗ , the model is in an ordered state even for K = 0 . We plan to study the phase diagram of this model in the ( K , h ) - plane in a separate work , where we also plan to consider such problems for the graphs based on the remaining motifs . Acknowledgment : This work was supported in part by the DFG through the SFB 701 : ‘Spek - trale Strukturen und Topologische Methoden in der Mathematik’ and by the European Com - mission under the project STREVCOMS PIRSES - 2013 - 612669 . 5 Appendix Here we give detailed calculations of the quantities from subsection 2 . 4 . First we get the quantity in ( 2 . 9 ) : h n k i = k − 1 X l = 1 2 ( q − 1 ) ( l − 1 ) X ν = 0 ( 2 ( q − 1 ) + ν ) ( q − 1 ) · q − l 1 + q 1 − k · ( 5 . 1 ) · (cid:18) 2 ( q − 1 ) ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 2 ( q − 1 ) ( l − 1 ) − ν + + ( q − 1 ) ( k − 1 ) X ν = 0 ( q − 1 + ν ) 2 q k − 1 + 1 × (cid:18) ( q − 1 ) ( k − 1 ) ν (cid:19) p ν ( 1 − p ) ( q − 1 ) ( k − 1 ) − ν = = 2 ( q − 1 ) ( 1 − p ) ( 1 − q 1 − k ) 1 + q 1 − k + 2 p ( kq 1 − k ( 1 − q ) + q − q 1 − k ) 1 + q 1 − k + + 2 ( q − 1 + ( q − 1 ) ( k − 1 ) p ) q k − 1 + 1 = q k − 1 ( 2 q − 2 + 2 p ) − 2 p q k − 1 + 1 . 17 Next , for the quantity in ( 2 . 11 ) , we have h n k i = k − 1 X l = 1 4 ( l − 1 ) X ν = 0 ( 4 + ν ) 3 · 4 − l 1 + 4 1 − k · (cid:18) 4 ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 4 ( l − 1 ) − ν + + 2 ( k − 1 ) X ν = 0 ( 2 + ν ) 2 4 k − 1 + 1 · (cid:18) 2 ( k − 1 ) ν (cid:19) p ν ( 1 − p ) 2 ( k − 1 ) − ν = = 4 + 4 3 (cid:18) p − 3 + 2 p 4 k − 1 + 1 (cid:19) . Now we calculate the quantity in ( 2 . 13 ) h n k i = k − 1 X l = 1 h 3 ( l − 1 ) X ν = 0 ( 3 + ν ) 4 − l 1 + 4 1 − k · (cid:18) 3 ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 3 ( l − 1 ) − ν + + 4 ( l − 1 ) X ν = 0 ( 4 + ν ) 4 − l 1 + 4 1 − k · (cid:18) 4 ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 4 ( l − 1 ) − ν + + 5 ( l − 1 ) X ν = 0 ( 5 + ν ) 4 − l 1 + 4 1 − k · (cid:18) 5 ( l − 1 ) ν (cid:19) p ν ( 1 − p ) 5 ( l − 1 ) − ν i + + 2 ( k − 1 ) X ν = 0 ( 2 + ν ) 4 4 k + 4 · (cid:18) 2 ( k − 1 ) ν (cid:19) p ν ( 1 − p ) 2 ( k − 1 ) − ν + + 3 ( k − 1 ) X ν = 0 ( 3 + ν ) 2 4 k + 4 · (cid:18) 3 ( k − 1 ) ν (cid:19) p ν ( 1 − p ) 3 ( k − 1 ) − ν + + k − 1 X ν = 0 ( 1 + ν ) 2 4 k + 4 · (cid:18) k − 1 ν (cid:19) p ν ( 1 − p ) k − 1 − ν = = 4 + 4 3 (cid:18) p − 3 + 2 p 4 k − 1 + 1 (cid:19) . References [ 1 ] Erd˝os P and R´enyi A , On the evolution of random graphs , 1960 Magyar Tud . Akad . Mat . Kutat´o Int . K¨ozl . 5 17 [ 2 ] Itzkovitz S , Milo R , Kashtan N , Ziv G , Alon U , Subgraphs in random networks , 2003 Phys . Rev . E 68 026127 [ 3 ] Itzkovitz S and Alon U , Subgraphs and network motifs in geometric networks , 2005 Phys . Rev . E 71 026117 [ 4 ] Matias C , Schbath S , Birmel´e E , Daudin J . - J , Robin S , Network motifs : mean and variance for the count , 2006 REVSTAT 4 31 [ 5 ] Milo R , Shen - Orr S , Itzkovitz S , Kashtan N , Chklovskii D , Alon U , Network motifs : simple building blocks of complex networks , 2002 Science 298 , 824 [ 6 ] H¨aggstr¨om O , Markov random ﬁelds and percolation on general graphs , 2000 Adv . Appl . Prob . 32 39 [ 7 ] Berker A N and Ostlund S , Renormalisation - group calculations of ﬁnite systems : order parameter and speciﬁc heat for epitaxial ordering , 1979 J . Phys . C 12 4961 [ 8 ] Griﬃths R B and Kaufman M , Spin systems on hierarchical lattices . Introduction and ther - modynamic limit , 1982 Phys . Rev . B 26 5022 18 [ 9 ] Antenucci F , Crisanti A , Leuzzi L , Critical study of hierarchical lattice renormalization group in magnetic ordered and quenched disordered systems : Ising and Blume - Emmery - Griﬃths models , 2014 J . Stat . Phys . 155 909 [ 10 ] Aral N and Berker A N , Chaotic spin correlations in frustrated Ising hierarchical lattices , 2009 Phys . Rev . B 79 014434 [ 11 ] Bleher P M and ˇZalys E , Limit Gibbs distributions for the Ising model on hierarchical lattices , 1988 Litovsk . Mat . Sb . 28 252 ; translation in 1989 Lithuanian Math . J . 28 127 [ 12 ] Bleher P M and ˇZalys E , Asymptotics of the susceptibility for the Ising model on the hierarchical lattices , 1989 Commun . Math . Phys . 120 409 [ 13 ] Hinczewski M and Berker A N , Inverted Berezinskii - Kosterlitz - Thouless singularity and high - temperature algebraic order in an Ising model on a scale - free hierarchical - lattice small - world network , 2006 Phys . Rev . E 73 066126 [ 14 ] Kotorowicz M and Kozitsky Yu , Motif based hierarchical random graphs : structural prop - erties and the critical point behavior of an Ising model , 2011 Condens . Matter Phys . 14 13801 [ 15 ] Wr´obel M , Modelling complex networks by random hierarchical graphs , 2008 Condens . Matter Phys . 11 341 [ 16 ] Erd˝os P , Kleitman D J , Rothschild B L , Asymptotic enumeration of K n - free graphs , In : Colloquio Internazionale sulle Teorie Combinatorie ( Rome , 1973 ) , Tomo II , pp . 19 – 27 . Atti dei Convegni Lincei , No . 17 , Accad . Naz . Lincei , Rome , 1976 [ 17 ] Futorny V and Ustimenko V , On small world semiplanes with generalised Schubert cells , 2007 Acta Appl . Math . 98 47 [ 18 ] Newman M E J , The structure and function of complex networks , 2003 SIAM Review , 45 , 167 [ 19 ] Barrat A and Weigh M , On the properties of small - world network models , 2000 Eur . Phys . J . B 13 547 [ 20 ] Georgii H . - O , Gibbs Measures and Phase Transitions . de Gruyter Studies in Mathematics , 9 . Walter de Gruyter & Co . , Berlin 1988 [ 21 ] Bovier A , Statistical mechanics of disordered system . A mathematical perspective , Cam - bridge Series in Statistical and Probabilistic Mathematics , 18 2006 [ 22 ] Sarymsakov T A , Inhomogeneous Markov chains , 1961 Teor . Verojatnost . i Primen . 6 194 [ 23 ] Bremaud P , Markov Chains , Gibbs Fields , Monte Carlo Simulations , and Queus , Springer - Verlag , 1999 [ 24 ] Hajnal J , The ergodic properties of non - homogeneous ﬁnite Markov chains , 1956 Proc . Cambridge Philos . Soc . 52 ( 1 ) 67 [ 25 ] Touri B and Nedi´c A , On ergodicity , ﬁnite ﬂow and consensus in random models , 2012 IEEE Transections on Automatic Control 56 ( 7 ) 1593 [ 26 ] Blondel V D and Olshevsky A , How to decide consensus ? A combinatorial necessary and suﬃcient condition and a proof that consensus is decidable but NP - hard , 2014 SIAM J . Control Optim . 52 2707 [ 27 ] Gaubert S and Qu Zheng , Dobrushin’s ergodicity coeﬃcient for Markov operators on cones , 2015 Integr . Equ . Oper . Theory 81 127 [ 28 ] Touri B and Nedi´c A , On backward product of stochastic matrices , 2012 Automatica 48 , 1477 19
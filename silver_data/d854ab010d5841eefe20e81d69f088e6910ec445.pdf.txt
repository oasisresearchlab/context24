MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION JARED C . BRONSKI AND TIMOTHY FERGUSON Abstract . In this paper we illuminate some algebraic - combinatorial structure underlying the second order networks ( SONETS ) random graph model of Nykamp , Zhao and collab - orators [ 14 , 26 , 27 ] . In particular we show that this algorithm is deeply connected with a certain homogeneous coherent conﬁguration , a non - commuting generalization of the classi - cal Johnson scheme . This algebraic structure underlies certain surprising identities ( that do not appear to have been previously observed ) satisﬁed by the covariance matrices in the Nykamp - Zhao scheme . We show that an understanding of this algebraic structure leads to simpliﬁed numerical methods for carrying out the linear algebra required to implement the SONETS algorithm . We also show that this structure extends naturally to the problem of generating random subgraphs of graphs other than the complete directed graph . 1 . Introduction The Erd˝os - R´enyi G ( n , p ) model is a common model of a random graph of n nodes , where each possible edge is independently present ( resp . absent ) with probability p ( resp . 1 − p ) . However it has long been understood that many , if not most , real world networks show substantial departures from independence . [ 2 , 5 , 20 ] One indicator of the departure from independence is given by the relative frequency of certain motifs , or subgraphs . In real world networks it is frequently the case that the number of certain motifs occuring in the graph diﬀers substantially from what one would expect based on the assumption of independent edges , indicating correlations among the edges . This has led to a large eﬀort to understand this phenomenon . While it is diﬃcult to do justice to the vast amount of literature on this subject most of the work has proceeded in two complementary directions : developing tools for identifying important motifs or other structures in a given ( large ) network [ 7 , 19 , 23 , 25 ] , and algorithms for generating random networks with certain desirable properties including , but not limited to , having speciﬁed probabilities for diﬀerent motifs . The latter random graph models include the well - known preferential attachment model [ 6 , 21 ] and small world network models [ 22 , 24 ] as well as a number of models and methods of generation [ 1 , 8 , 9 , 11 , 12 , 18 ] . The motivation for this work is the work of Nykamp , Zhao and collaborators [ 14 , 26 , 27 ] on generating what they refer to as second order networks , or SONETS . This generalization of the Erd˝os - R´enyi random graph model that allows for the generation of random networks ( directed graphs ) with second order correlations among the edges : one can not only specify the single edge probabilities , but one can also independently vary the probabilities of all possible two edge motifs . We show that the correlation matrices of the SONETS model enjoy some remarkable algebraic identities . We further show that these identities can be explained by the fact that there is a coherent conﬁguration , a particular type of algebraic structure , that underlies these models . We also construct some other examples of second order networks , and the related coherent conﬁgurations . In each case the existence of a coherent conﬁguration has strong numerical implications for the implementation of the method . In particular all of the 1 a r X i v : 1808 . 05076v1 [ m a t h . C O ] 1 3 A ug 2018 2 JARED C . BRONSKI AND TIMOTHY FERGUSON spectral operation that need to be done on the covariance matrix – mainly the extraction of the positive deﬁnite square root – can be done in time independent of the size of the matrix . We begin with a brief description of the Nykamp - Zhao scheme for generating second order networks ( simple directed graphs ) . The Nykamp - Zhao approach generates a random directed graph in the following manner . One ﬁrst generates a Gaussian random vector ω ∈ R E , where E = N ( N − 1 ) is the number of potential edges . One then performs “thresholding” : an edge is present at site i if ω i > x and absent if ω i ≤ x for some choice of the threshold level x . This would simply give an Erd˝os - R´enyi random graph if the ω i were independent and identically distributed ( iid ) – in other words if the covariance were a multiple of the identity matrix – but the covariance matrix Σ is instead chosen as follows . The authors ﬁrst identify various two edge motifs : • Reciprocal : The edges point between the same pair of vertices , in opposite directions . • Convergent : Both edges point inwards to a common vertex . • Divergent : Both edges point outward from a common vertex . • Chain : One edge points inward to a vertex , the other points outward from the same vertex . We add to this collection the disjoint motif , where the edges do not share a common vertex . This motif was not considered in the original SONETS work but ﬁts into this framework naturally , and must be included here for reasons of algebraic completeness . These motifs are illustrated in Figure 1 . The covariance for each pair of edges is then assigned according to the motif which they form . For instance , Σ ij = α div for every pair of edges ( i , j ) that form a divergent motif . This gives an N ( N − 1 ) × N ( N − 1 ) covariance matrix Σ ( α ) depending on ﬁve arbitrary constants α = ( α recip , α conv , α div , α chain , α disj ) . For instance , when N = 5 the covariance Σ ( α ) is a 20 × 20 matrix given by    1 α recip α conv α chain α conv α chain α conv α chain α chain α div α chain α div α chain α div α disj α disj α disj α disj α disj α disj α recip 1 α chain α div α chain α div α chain α div α conv α chain α conv α chain α conv α chain α disj α disj α disj α disj α disj α disj α conv α chain 1 α recip α conv α chain α conv α chain α div α chain α disj α disj α disj α disj α chain α div α chain α div α disj α disj α chain α div α recip 1 α chain α div α chain α div α chain α conv α disj α disj α disj α disj α conv α chain α conv α chain α disj α disj α conv α chain α conv α chain 1 α recip α conv α chain α disj α disj α div α chain α disj α disj α div α chain α disj α disj α chain α div α chain α div α chain α div α recip 1 α chain α div α disj α disj α chain α conv α disj α disj α chain α conv α disj α disj α conv α chain α conv α chain α conv α chain α conv α chain 1 α recip α disj α disj α disj α disj α div α chain α disj α disj α div α chain α div α chain α chain α div α chain α div α chain α div α recip 1 α disj α disj α disj α disj α chain α conv α disj α disj α chain α conv α chain α conv α chain α conv α div α chain α disj α disj α disj α disj 1 α recip α conv α chain α conv α chain α chain α div α chain α div α disj α disj α div α chain α chain α conv α disj α disj α disj α disj α recip 1 α chain α div α chain α div α conv α chain α conv α chain α disj α disj α chain α conv α disj α disj α div α chain α disj α disj α conv α chain 1 α recip α conv α chain α div α chain α disj α disj α chain α div α div α chain α disj α disj α chain α conv α disj α disj α chain α div α recip 1 α chain α div α chain α conv α disj α disj α conv α chain α chain α conv α disj α disj α disj α disj α div α chain α conv α chain α conv α chain 1 α recip α disj α disj α div α chain α div α chain α div α chain α disj α disj α disj α disj α chain α conv α chain α div α chain α div α recip 1 α disj α disj α chain α conv α chain α conv α disj α disj α chain α conv α div α chain α disj α disj α chain α conv α div α chain α disj α disj 1 α recip α conv α chain α chain α div α disj α disj α div α chain α chain α conv α disj α disj α div α chain α chain α conv α disj α disj α recip 1 α chain α div α conv α chain α disj α disj α chain α conv α disj α disj α div α chain α chain α conv α disj α disj α div α chain α conv α chain 1 α recip α div α chain α disj α disj α div α chain α disj α disj α chain α conv α div α chain α disj α disj α chain α conv α chain α div α recip 1 α chain α conv α disj α disj α disj α disj α chain α conv α div α chain α disj α disj α chain α conv α div α chain α chain α conv α div α chain 1 α recip α disj α disj α disj α disj α div α chain α chain α conv α disj α disj α div α chain α chain α conv α div α chain α chain α conv α recip 1    The problem of generating a Gaussian random vector with a given covariance matrix is an exercise in spectral theory . In particular one needs to compute the positive semi - deﬁnite square root of the matrix , Σ 12 , and act on a Gaussian iid random vector ω ∈ R E with this matrix . We note the following remarkable algebraic facts about the spectrum of the covariance Σ ( α ) , which do not appear to have been noted previously : • For ﬁxed values of α the covariance matrix Σ ( α ) has at most ﬁve distinct eigenvalues , independent of the size of the matrix , so the multiplicities of the eigenvalues are typically very large . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 3 • The eigenvalues of the covariance matrix can be computed explicitly as a function of α for all N . • The dependence of the eigenvalues on the components of α is simple : the eigenvalues are either linear functions in the components of α , or are algebraic of degree two ( they are the roots of a quadratic ) . In particular for any number of vertices N there are only ﬁve distinct eigenvalues of Σ ( α ) , which are given by λ 1 = 1 + α recip + ( N − 2 ) α conv + 2 ( N − 2 ) α chain + ( N − 2 ) α div + ( N − 2 ) ( N − 3 ) α disjoint λ 2 = 1 − α recip − α conv + 2 α chain − α div λ 3 = 1 + α recip − α conv − 2 α chain − α div + 2 α disjoint λ 4 / 5 = 1 + ( N − 3 ) 2 α conv − α chain + ( N − 3 ) 2 α div − ( N − 3 ) α disjoint ± τ 2 where τ 2 = N ( N − 2 ) ( α conv − α div ) 2 + ( α conv + α div − 2 ( N − 3 ) ( α chain − α disj ) − 2 α recip ) 2 In order to be admissible as a covariance matrix Σ ( α ) must be positive deﬁnite . One consequence of the above formulae is that one can compute , reasonably explicitly , the region of parameter space in which Σ ( α ) is positive deﬁnite : it is given by the intersection of three half - planes ( λ 1 , 2 , 3 > 0 ) and the region cut out by two hyperboloids ( λ 4 , 5 > 0 ) . We show that the algebra satisﬁed by the covariance matrices is isomorphic to an algebra of matrices of ﬁxed and rather modest size : 7 × 7 in the case of the Nykamp - Zhao algorithm . Any linear algebraic operation that one might want to perform on an N ( N − 1 ) × N ( N − 1 ) covariance matrix can instead be done on a representative from the algebra of 7 × 7 matrices , and the results can be translated back to the N ( N − 1 ) × N ( N − 1 ) covariance matrix . This includes computation of eigenvalues , inversion and extraction of the square root , the main operation required to apply the SONETS algorithm . To reiterate : the existence of a map to a seven dimensional algebra implies that all of these linear algebraic operations can be done in time independent of the size of the matrix . The basic algebraic explanation for this collection of facts is that there is , underlying the SONETS method , an algebraic object known as an association scheme or a coherent conﬁg - uration [ 4 , 10 , 17 , 28 ] . Association schemes and coherent conﬁgurations arise in a number of applications , including coding theory [ 13 ] and the design of experiments [ 3 ] . These structures represent a generalization of the notion of a group encoding certain nice pairwise relations between elements of a set . The SONETS method arises naturally from a homogeneous coher - ent conﬁguration ( HCC ) , a non - commuting generalization of the classical Johnson J ( N , 2 ) association scheme . The relations in the HCC roughly correspond to motifs in the network . Actually , as will be explained , the relations represent a slight reﬁnement of the idea of a motif . One of the basic facts about association schemes and coherent conﬁgurations is that they give rise to a natural ﬁnite dimensional algebra , the Bose - Meisner algebra . The algebra underlying the SONETS algorithm as described by Nykamp and Zhao has degree seven , implying that the number of distinct eigenvalues of the covariance matrix is at most seven independent of the size of the network . For SONETS the number is actually less , and there are only ﬁve distinct eigenvalues . 4 JARED C . BRONSKI AND TIMOTHY FERGUSON We refer the interested reader to any number of texts on coherent conﬁgurations and association schemes [ 3 , 4 , 28 ] , but in the interests of making this paper relatively self - contained we will include proofs of the results that we need . 1 . 1 . Association Schemes and Coherent Conﬁgurations . Association schemes and coherent conﬁgurations are algebraic structures that arise in a number of areas including statistics , particularly the theory of experimental design , and coding theory . They are also used as a tool in abstract algebra for studying permutation groups , and can be thought of as representing a generalization of group theory and the associated representation theory . A coherent conﬁguration can be described as follows . Deﬁnition 1 . Given an index set X and the product set X × X of ordered pairs of indices , a coherent conﬁguration is a set of d + 1 relations R ( 0 ) , R ( 1 ) , . . . , R ( d ) given by subsets of X × X satisfying the following properties : ( 1 ) For every x and y in X there is a unique relation R ( k ) such that the ordered pair ( x , y ) ∈ R ( k ) . In other words the relations partition X × X . ( 2 ) There is a subset of relations R ( 0 ) , R ( 1 ) , . . . , R ( j ) that partition the diagonal set { ( x , x ) | x ∈ X } . ( 3 ) If R ( k ) is a relation in the set the adjoint relation deﬁned by ( R ( k ) ) † : = { ( y , x ) | ( x , y ) ∈ R ( k ) } is also a relation in the set . ( 4 ) Given any pair ( x , y ) ∈ R ( i ) the number of elements z such that ( x , z ) ∈ R ( k ) and ( z , y ) ∈ R ( j ) depends only on i , j , k and not on the individual ( x , y ) . A homogeneous coherent conﬁguration ( HCC ) is a coherent conﬁguration for which property ( 2 ) above is replaced by the stronger condition that one of the relations be the identity relation . ( 2’ ) R ( 0 ) = { ( x , x ) | x ∈ X } . An association scheme is is a homogeneous coherent conﬁguration for which property ( 3 ) above is replaced by the stronger condition that the relations be symmetric . ( 3’ ) ( R ( k ) ) † = R ( k ) . We should warn the reader that we are adhering to the terminology of Cameron [ 10 ] and the earlier work of Higman [ 17 ] but that this is not followed by all authors . For instance in the work of Hanaki and Miyamoto [ 15 , 16 ] what they call association schemes would be called homogeneous coherent conﬁgurations in the nomenclature above : there is a single identity relation but relations are not necessarily symmetric . For any coherent conﬁguration there exists a set of non - negative integers ρ ( k ) ij , commonly referred to as the structure constants or intersection numbers . These integers play a funda - mental role in the algebraic theory of coherent conﬁgurations , and are deﬁned as follows . Deﬁnition 2 . The integers ρ ( k ) ij are deﬁned as follows : given a representative pair ( x , y ) ∈ R ( i ) ρ ( k ) ij = (cid:12) (cid:12) { z ∈ X | ( x , z ) ∈ R ( k ) and ( z , y ) ∈ R ( j ) } (cid:12) (cid:12) . In other words ρ ( k ) ij counts the number of z such that ( x , z ) belongs to relation k and ( z , y ) belongs to relation j . Note that this well deﬁned by ( 4 ) of Deﬁnition 1 : this only depends on the relation to which ( x , y ) belongs , and not on the individual x and y . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 5 For each relation we deﬁne a corresponding adjacency matrix , as follows : R ( k ) = χ R ( k ) , where χ is the usual characteristic function . In other words , R ( k ) ij = (cid:40) 1 if ( i , j ) ∈ R ( k ) , 0 if ( i , j ) / ∈ R ( k ) . This deﬁnes a collection of ( d + 1 ) ( 0 , 1 ) matrices representing the relations . We wish to note three important facts about the matrices { R ( i ) } di = 0 , which all follow immediately from the facts above : • The matrices { R ( i ) } di = 0 are linearly independent and orthogonal under the usual ma - trix inner product (cid:104) A , B (cid:105) = Tr ( A (cid:62) B ) . • The matrices form a closed algebra , in the sense that R ( k ) R ( j ) = (cid:80) i ρ ( k ) ij R ( i ) . Here the product is the usual matrix product . • The matrices satisfy (cid:80) i R ( i ) = 1 | X | × | X | , where 1 | X | × | X | is the | X | × | X | matrix with all entries equal to 1 . The structure constants ρ ( k ) ij play an important role in the theory as they can be used to deﬁne an isomorphism of algebras that explains the special properties of covariance matrices in the SONETS scheme . We will address this in the following section . Note that , if the relations are all symmetric , then clearly ρ ( k ) ij = ρ ( j ) ik and thus the corre - sponding adjacency matrices commute . While this will be true in the simplest example that we consider , that of the classical Johnson J ( N , 2 ) scheme , it will not be true for most of the examples that we consider . One classical example of a coherent conﬁguration is distance on a distance regular graph : a pair of edges ( x , y ) belongs to relation R ( k ) if x distance k from y in the graph . In this scheme all relations are obviously symmetric , as the distance is symmetric , so this is actually an association scheme . Throughout this paper we frequently reference the Johnson association scheme : this arises from the distance regular Johnson ( N , 2 ) graphs in exactly this way . A second example of a coherent conﬁguration is given by any group . There is one relation for each group element g , and a pair of elements e , f are in R g if e = gf . For this scheme the adjacency matrices are permutation matrices – there is one non - zero entry in each row and column – and the adjoint relation is R g − 1 . This scheme is , of course , typically not symmetric . In fact it is not hard to see that any association scheme where the adjacency matrices are permutation matrices comes from a group in this way , so in this way groups are a special case of association schemes where the scheme has the largest possible number of relations , and the adjacency matrix for any relation is a permutation matrix . In the context of networks the relations roughly correspond to two edge motifs in the network . The correspondence is not quite exact , for reasons that we will see shortly . In fact the idea of a relation is slightly more precise than that of a motif , and each relation can be thought of as a motif together with a role for each edge in the motif . Example ( The Johnson Scheme ) . Consider the complete undirected graph with E = N ( N − 1 ) 2 edges . There is a natural association scheme on the edge set with three relations : • R ( 0 ) = { ( x , y ) | x = y } – the identity relation . The corresponding matrix is the identity matrix • R ( 1 ) = { ( x , y ) | x and y share one vertex } • R ( 2 ) = { ( x , y ) | x and y share no vertices } . 6 JARED C . BRONSKI AND TIMOTHY FERGUSON One way to think about this is as follows : edges in the complete undirected graph can be indexed by unordered pairs ( i , j ) , where the edge connects vertices i and j . Two edges x and y are in R ( k ) if the number of elements in the intersection satisﬁes | x ∩ y | = 2 − k . This is distance in the line graph of the complete graph – the Johnson graph – a distance regular graph . In this case one can imagine using the SONETS idea to generate random undirected graphs with correlations among the edges . We will do this later in the paper . There are three motifs here , corresponding to the three relations : the identity motif ( the edges are the same ) , the adjacent motif ( the edges share a vertex ) and the disjoint motif ( the edges do not share a vertex ) . For N = 4 the covariance matrix would be given by R ( 0 ) + α 1 R ( 1 ) + α 2 R ( 2 ) =   1 α 1 α 1 α 1 α 1 α 2 α 1 1 α 1 α 1 α 2 α 1 α 1 α 1 1 α 2 α 1 α 1 α 1 α 1 α 2 1 α 1 α 1 α 1 α 2 α 1 α 1 1 α 1 α 2 α 1 α 1 α 1 α 1 1   where α 1 and α 2 are constants representing the correlations between adjacent edges and dis - joint edges . It is easy to conﬁrm that the covariance is a linear combination of three com - muting matrices and therefore that the eigenvalues are linear in α 1 and α 2 . In fact the eigenvalues are λ = 1 + 4 α 1 + α 2 , with multiplicity one , λ = 1 − 2 α 1 + α 2 , with multiplicity two , and λ = 1 − α 2 , with multiplicity three . The next example is the most important one for the purposes of this paper , and underlies the SONETS algorithm detailed by Nykamp and Zhao . Example ( The Nykamp - Zhao Homogeneous Coherent Conﬁguration ) . This HCC is deﬁned on a complete directed graph with E = N ( N − 1 ) edges , and has seven relations on ordered pairs of edges ( x , y ) . • Identity : Edges x and y are the same edge . • Reciprocal : Edges x and y point between the same vertices but in opposite directions . • Convergence : Edges x and y point inward towards the same vertex . • Chain : Edge x points inward to a vertex , edge y points outward from the same vertex . • Anti - Chain : Edge x points outward from a vertex , edge y points inward to the same vertex . • Divergence : Edges x and y point outward from the same vertex . • Disjoint : Edges x and y do not share any vertices . Note that the Nykamp and Zhao discuss only four motifs : Reciprocal , Convergence , Chain , and Divergence . The identity motif is , of course , implicitly present in their work but is not discussed . The chain motif translates into two relations , Chain and Anti - Chain . Both are required in order for the relations to form a coherent conﬁguration although one can of course choose the coeﬃcients of the two to be equal , recovering the motif . Nykamp and Zhao do not discuss the disjoint motif , though in principle it could be considered in the same framework . Remark . Some things to note about this coherent conﬁguration . There are two relations ( Identity and Reciprocal ) where the edges share two vertices . There are four relations ( Con - vergence , Chain , Anti - chain and Divergence ) where the edges share a single vertex . There is a single relation ( Disjoint ) where the edges do not share any vertices . These generalize the three relations in the Johnson scheme : distance zero , one and two respectively . Five of the MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 7 relations ( Identity , Reciprocal , Convergence , Divergence and Disjoint ) are symmetric , while the remaining two ( Chain and Anti - Chain ) are adjoints of one another . The symmetric relations exactly correspond to the associated motifs , while non - symmetric motifs generate a pair of relations . For instance the ﬁrst row of R Chain gives the edges that are outgoing from the vertex that edge one is incoming to . The ﬁrst row of R Anti - Chain , however , gives the edges that are incoming to the vertex that edge one is outgoing from . Of course the union R Chain ∪ R Anti - Chain is symmetric and corresponds to the motif exactly . Six of the seven relations are illustrated in Figure ( 1 ) . Reciprocal Motif Divergent Motif Convergent Motif Chain Motif Anti - Chain Motif Disjoint Motif Figure 1 . Six of the relations in the homogeneous coherent conﬁguration described in the text . We have not depicted the identity motif . The thick red edge denotes the ﬁrst edge in the conﬁguration , the thick dashed blue edge denotes the second edge . We next illustrate how to compute the structure constants ρ ( k ) ij . These integers count how many edges are in a certain relation with two other edges . Speciﬁcally given that the pair of edges ( x , y ) is in relation i the coeﬃcient ρ ( k ) ij counts the number of edges z such that ( x , z ) is in relation k and ( z , y ) is in relation j . Example ( The Johnson scheme multiplication laws ) . The classical Johnson scheme J ( N , 2 ) has 3 relations . The identity relation gives the identity matrix , so R ( 0 ) = I . The remaining multiplication laws are R ( 1 ) R ( 1 ) = 2 ( N − 2 ) R ( 0 ) + ( N − 2 ) R ( 1 ) + 4 R ( 2 ) , ( 1 . 1 ) R ( 1 ) R ( 2 ) = R ( 2 ) R ( 1 ) = ( N − 3 ) R ( 1 ) + 2 ( N − 4 ) R ( 2 ) , ( 1 . 2 ) R ( 2 ) R ( 2 ) = ( N − 2 ) ( N − 3 ) 2 R ( 0 ) + ( N − 3 ) ( N − 4 ) 2 R ( 1 ) + ( N − 4 ) ( N − 5 ) 2 R ( 2 ) . ( 1 . 3 ) 8 JARED C . BRONSKI AND TIMOTHY FERGUSON We illustrate the computation of one of these terms , say the coeﬃcient of R ( 1 ) in the expan - sion of R ( 1 ) R ( 1 ) . Obviously we have ( R ( 1 ) R ( 1 ) ) xy = (cid:80) z R ( 1 ) xz R ( 1 ) zy To compute the coeﬃcient of R ( 1 ) in this product we choose edges x and y such that the pair ( x , y ) are in the R ( 1 ) relation , meaning they share exactly one vertex . By hypothesis it doesn’t matter which pair we choose , so long as they are in the right relation , so choose x = { 1 , 2 } and y = { 1 , 3 } . The coeﬃcient of R ( 1 ) is the number of edges z that share exactly one vertex with x = { 1 , 2 } and exactly one vertex with y = { 1 , 3 } . There are exactly N − 2 such edges : the edges { 1 , x } where x ≥ 4 ( of which there are N − 3 ) and the edge ( 2 , 3 ) , giving a coeﬃcient of N − 3 + 1 = N − 2 . As a second example we take the coeﬃcient of R ( 2 ) in the product R ( 1 ) R ( 2 ) . In this case x and y have to belong to relation R ( 2 ) , so take x = { 1 , 2 } and y = { 3 , 4 } . We want to count the number of z that have exactly one element in common with { 1 , 2 } and no elements in common with { 3 , 4 } . These are exactly z = { 1 , x } with x ≥ 5 and z = { 2 , x } with x ≥ 5 . Thus the coeﬃcient of R ( 2 ) in the product R ( 1 ) R ( 2 ) is 2 ( N − 4 ) . Example ( The Nykamp - Zhao multiplication laws . ) . The computation of one multiplication law satisﬁed by the adjacency matrices in the Nykamp - Zhao coherent conﬁguration is illus - trated in Figure 2 for N = 7 . This illustrates R conv R disj = ( N − 3 ) R anti + ( N − 3 ) R div + ( N − 4 ) R disj . In this ﬁgure the solid edge ( red online ) denotes the ﬁrst edge ( x in the notation above ) , the dashed edge the last edge ( y above ) and the dotted edges ( z above ) are the inter - mediate edges to be counted . To compute the coeﬃcient of R anti in the product R conv R disj we choose ( x , y ) a pair of edges in the anti - chain conﬁguration , and we count the number of edges z that form the convergent motif with the ﬁrst edge and the disjoint motif with the second edge . There are 7 − 3 = 4 such edges . The other two subﬁgures show the computation of the structure coeﬃcients of R div and R disj respectively . It is easy to see that the remaining structure constants must be zero . For instance the coeﬃcient of R recip would count the num - ber of edges that are convergent with one edge and disjoint from the reciprocal edge . There are clearly no edges that satisfy both of those conditions , and thus the coeﬃcient of R recip in the expansion of R conv R disj is zero . Coeﬃcient of R div Coeﬃcient of R anti Coeﬃcient of R disj Figure 2 . The multiplication law R conv R disj = ( N − 3 ) R div + ( N − 3 ) R anti + ( N − 4 ) R disj . Coherent conﬁgurations are often summarized by the table (cid:80) k k R ( k ) , which indicates which subsets belong to which relations . Since each relation consists of a ( 0 , 1 ) matrix with disjoint entries the relations follow immediately from such a table . Hanaki and Miyamoto give a complete list of all ( up to isomorphism ) homogeneous coherent conﬁgurations ( HCC’s ) MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 9 with | X | ≤ 34 at http : / / math . shinshu - u . ac . jp / ∼ hanaki / as . Note that Hanaki and Miyamoto require an association scheme to have an identity relation but do not require relations to be symmetric , thus what they call an association scheme we would call a homogeneous coherent conﬁguration . There are 243 such HCC’s of order 30 . If we take the relations and edges to be ordered as follows : • R ( 0 ) – Identity relation • R ( 1 ) – Reciprocal relation • R ( 2 ) – Divergent relation • R ( 3 ) – Convergent relation • R ( 4 ) – Chain relation • R ( 5 ) – Anti - chain relation • R ( 6 ) – Disjoint relation X = { ( 1 , 2 ) , ( 2 , 1 ) , ( 3 , 2 ) , ( 4 , 2 ) , ( 5 , 2 ) , ( 6 , 2 ) , ( 1 , 3 ) , ( 1 , 4 ) , ( 1 , 5 ) , ( 1 , 6 ) , ( 3 , 1 ) , ( 4 , 1 ) , ( 5 , 1 ) , ( 6 , 1 ) , ( 2 , 3 ) , ( 2 , 4 ) , ( 2 , 5 ) , ( 2 , 6 ) , ( 3 , 4 ) , ( 3 , 5 ) , ( 3 , 6 ) , ( 4 , 3 ) , ( 5 , 3 ) , ( 6 , 3 ) , ( 4 , 5 ) , ( 4 , 6 ) , ( 5 , 4 ) , ( 6 , 4 ) , ( 5 , 6 ) , ( 6 , 5 ) } then it is apparent that the Nykamp - Zhao HCC with N = 6 is isomorphic to number 99 in Hanaki and Miyamoto’s list of schemes of order 30 , while the Nykamp - Zhao HCC with N = 5 appears as number 51 in their list of 95 schemes of order 20 . 2 . Algebraic Implications An important algebraic fact is that there is a homomorphism from the algebra of the adjacency matrices for the relations ( of size N ( N − 1 ) × N ( N − 1 ) in the case of the Nykamp - Zhao coherent conﬁguration ) to an algebra of ( d + 1 ) × ( d + 1 ) matrices , where d + 1 is the number of relations in the coherent conﬁguration ( 7 × 7 in this case ) . This is generally known as the intersection algebra . This is deﬁned through Deﬁnition 3 . We deﬁne a linear map from the algebra generated by R ( 0 ) , R ( 1 ) , . . . , R ( d ) to ( d + 1 ) × ( d + 1 ) matrices by ρ (cid:32)(cid:88) k α k R ( k ) (cid:33) = (cid:88) k α k ρ ( R ( k ) ) where ρ ( R ( k ) ) is deﬁned to be the ( d + 1 ) × ( d + 1 ) matrix given by ρ ( R ( k ) ) ij = ρ ( k ) ij . The algebraic coincidences in the SONETS algorithm basically arise from the fact that the map deﬁned above is an injective homomorphism . Essentially any linear - algebraic calculation that needs to be done on R ( k ) can instead be done at the level of the ρ ( k ) instead , with the result then lifted back to the R ( k ) . To begin we state a proposition to this eﬀect but defer the proof to the appendix . Proposition 1 . Let ρ be the linear map in Deﬁnition 3 , and let M denote a matrix in the algebra generated by R ( 0 ) , R ( 1 ) , . . . , R ( d ) . Then ρ is an injective homomorphism satisfying the following properties : • ρ ( M ) is diagonalizable if and only if M is . • λ is an eigenvalue of ρ ( M ) if and only if it is for M ( hence M has at most d + 1 distinct eigenvalues ) . 10 JARED C . BRONSKI AND TIMOTHY FERGUSON • The algebraic multiplicity of an eigenvalue λ of M is Mult ( λ ) = rank ( ( (cid:88) k β k R ( k ) ) β ∈B λ ) where B λ is a basis for the generalized left eigenspace of ρ ( M ) for λ . Note the special case that ρ ( M ) is diagonalizable if M is . This is signiﬁcant to the SONETS problem because the R matrices , while large , are symmetric and thus diagonaliz - able . The corresponding elements of the intersection algebra , in contrast , are not symmetric or normal and there is no guarantee a priori that they are diagonalizable . Example ( The Johnson Scheme intersection algebra ) . The ﬁrst example is the classical Johnson scheme . Recall that R ( 0 ) = I and that R ( 1 ) R ( 1 ) = 2 ( N − 2 ) R ( 0 ) + ( N − 2 ) R ( 1 ) + 4 R ( 2 ) , R ( 1 ) R ( 2 ) = R ( 2 ) R ( 1 ) = ( N − 3 ) R ( 1 ) + 2 ( N − 4 ) R ( 2 ) , R ( 2 ) R ( 2 ) = ( N − 2 ) ( N − 3 ) 2 R ( 0 ) + ( N − 3 ) ( N − 4 ) 2 R ( 1 ) + ( N − 4 ) ( N − 5 ) 2 R ( 2 ) . This gives the homomorphism ρ ( R ( 0 ) ) = ρ ( 0 ) =   1 0 0 0 1 0 0 0 1   , ( 2 . 1 ) ρ ( R ( 1 ) ) = ρ ( 1 ) =   0 1 0 2 ( N − 2 ) N − 2 4 0 N − 3 2 ( N − 4 )   , ( 2 . 2 ) ρ ( R ( 2 ) ) = ρ ( 2 ) =   0 0 1 0 N − 3 2 ( N − 4 ) (cid:0) N − 2 2 (cid:1) (cid:0) N − 3 2 (cid:1) (cid:0) N − 4 2 (cid:1)   . ( 2 . 3 ) It is straightforward to verify that this is indeed a homomorphism , that the matrices ρ ( k ) satisfy the same algebraic identities as R ( k ) . The eigenvalues of a general linear combination I + α 1 ρ ( 1 ) + α 2 ρ ( 2 ) are easily computed to be λ 0 = 1 + 2 ( N − 2 ) α 1 + (cid:18) N − 2 2 (cid:19) α 2 , ( 2 . 4 ) λ 1 = 1 + ( N − 4 ) α 1 − ( N − 3 ) α 2 , ( 2 . 5 ) λ 2 = 1 − 2 α 1 + α 2 . ( 2 . 6 ) These are the eigenvalues of I + α 1 R ( 1 ) + α 2 R ( 2 ) as well , although the multiplicities obviously diﬀer . It follows from the Perron - Frobenius theorem that λ 0 is a simple eigenvalue of I + α 1 R ( 1 ) + α 2 R ( 2 ) . It is possible , though tedious , to check that λ 1 has multiplicity N − 1 and λ 2 has multiplicity N ( N − 3 ) 2 , though we will not show this here . Example ( The Nykamp - Zhao intersection algebra ) . The following are the elements of the intersection algebra . We order the relations as follows : Identity , Reciprocal , Divergent , MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 11 Chain , Anti - chain , Convergent , Disjoint . ρ id = ρ ( 0 ) =   1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1   ρ recip = ρ ( 1 ) =   0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1   ρ div = ρ ( 2 ) =   0 0 1 0 0 0 0 0 0 0 0 1 0 0 N − 2 0 N − 3 0 0 0 0 0 0 0 0 0 1 1 0 N − 2 0 0 N − 3 0 0 0 0 0 1 0 0 1 0 0 0 N − 3 0 N − 3 N − 4   ρ chain = ρ ( 3 ) =     0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 N − 2 0 N − 3 0 0 0 0 0 0 0 1 0 1 N − 2 0 0 0 0 N − 3 0 0 0 1 0 0 0 1 0 0 N − 3 0 N − 3 0 N − 4     ρ anti = ρ ( 4 ) =   0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 1 N − 2 0 N − 3 0 0 0 0 0 0 0 1 0 0 1 0 N − 2 0 0 N − 3 0 0 0 0 0 N − 3 0 N − 3 N − 4   ρ conv = ρ ( 5 ) =   0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1 0 N − 2 0 N − 3 0 0 0 0 0 1 0 0 0 1 N − 2 0 0 0 0 N − 3 0 0 0 N − 3 0 N − 3 0 N − 4   ρ disj = ρ ( 6 ) =    0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 N − 3 N − 3 N − 4 0 0 0 0 N − 3 N − 3 N − 4 0 0 N − 3 N − 3 0 0 N − 4 0 0 N − 3 N − 3 0 0 N − 4 ( N − 3 ) ( N − 2 ) ( N − 3 ) ( N − 2 ) ( N − 4 ) ( N − 3 ) ( N − 4 ) ( N − 3 ) ( N − 4 ) ( N − 3 ) ( N − 4 ) ( N − 3 ) ( N − 5 ) ( N − 4 )    The algebraic identities satisﬁed by { R ( k ) } 6 k = 0 can be read oﬀ from rows of elements of the intersection algebra . For instance the ﬁfth row of ρ chain is ( N − 2 , 0 , 0 , 0 , 0 , N − 3 , 0 ) . The ﬁfth relation is the Anti - Chain relation , so this row implies that R chain R anti = ( N − 2 ) R id + ( N − 3 ) R conv . In the context of network generation one can assume a symmetric covariance matrix , so the coeﬃcients of the chain and anti - chain relations are assumed equal . The eigenvalues of Σ ( α ) can be found by computing the eigenvalues of the corresponding 7 × 7 matrix ρ ( Σ ( α ) ) . This can be done analytically , and obviously implies that Σ can have no more than 7 distinct eigenvalues . In fact there are only ﬁve distinct eigenvalues , as λ 4 / 5 have multiplicity two . It is still somewhat surprising that the eigenvalues have such simple dependence of α : linear or algebraic of degree two . There is an algebraic reason for this but it is somewhat involved , and 12 JARED C . BRONSKI AND TIMOTHY FERGUSON not terribly important to the problem of random network generation , so we will not address this issue in the current paper . 2 . 1 . Numerical Implications for the SONETS method . The fact that there is a coher - ent conﬁguration underlying the SONETS algorithm has some implications for numerically implementing the method . There are two basic issues to be addressed . The ﬁrst is un - derstanding the region in α space where Σ ( α ) is positive deﬁnite and represents a valid covariance . The second is ﬁnding an eﬃcient way to compute Σ 12 ( α ) . Of course one can always do this using the spectral theorem for symmetric matrices , but for large networks this can be costly . The ﬁrst problem has essentially been solved , as we have given formula for the eigenvalues as a function of α valid for any N . In this section we show how to compute Σ 12 ( α ) very eﬃciently - in time independent of the size of the network . We would like to emphasize at this point that the work of Nykamp and Zhao , particularly Zhao’s thesis [ 26 ] , presaged a lot of the ideas in this section . While they did not have the full algebraic structure of the problem Zhao gives an asymptotic expansion ( for N large ) for computing Σ 1 2 ( α ) which is closely related to what we will talk about in this section . What we show in this section is that , for basically the same amount of computation , one can actually compute Σ 12 ( α ) exactly . In the interest of simplicity we ﬁrst discuss the extraction of the square root for the Johnson scheme , which is simpler for several reasons , and then we will discuss the problem for the directed scheme . 2 . 2 . The Johnson scheme and undirected graph generation . For the Johnson scheme the analogous problem would be as follows . We have a covariance matrix of the form Σ ( α ) = I + α 1 R ( 1 ) + α 2 R ( 2 ) for which we would like to ﬁnd the matrix square root . One way to do this would be to ﬁnd β 0 , 1 , 2 such that ( β 0 I + β 1 R ( 1 ) + β 2 R ( 2 ) ) 2 = I + α 1 R ( 1 ) + α 2 R ( 2 ) . Using the fact that fact that the R ( k ) form a closed algebra this is equivalent to the following system of coupled quadratic equations : β 20 + 2 ( N − 2 ) β 21 + (cid:18) N − 2 2 (cid:19) β 22 = 1 , ( 2 . 7 ) ( N − 2 ) β 21 + 2 β 0 β 1 + 2 ( N − 3 ) β 1 β 2 + (cid:18) N − 3 2 (cid:19) β 22 = α 1 , ( 2 . 8 ) 4 β 21 + 2 β 0 β 2 + 4 ( N − 4 ) β 1 β 2 + (cid:18) N − 4 2 (cid:19) β 22 = α 2 . ( 2 . 9 ) At this point we should say a word about multiplicity of solutions . The covariance matrix Σ is an (cid:0) N 2 (cid:1) × (cid:0) N 2 (cid:1) matrix , so there are in principle 2 ( N 2 ) possible matrix square roots - there is one sign choice for each eigenvalue . We are only interested in one , say the unique positive deﬁnite one . The equations ( 2 . 7 – 2 . 9 ) will have eight real solutions if α 1 , 2 are such that Σ is positive deﬁnite . This is because , by assuming that Σ 12 ( α ) lies in the algebra , we are forcing the square root to have three invariant subspaces , so there is one sign choice for each invariant subspace . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 13 Rather than attempt to solve the system of coupled quadratic equations ( 2 . 7 – 2 . 9 ) directly it is easier to work through the eigenvalues . Since there are three distinct eigenspaces if all of the eigenvalues agree the matrices must agree . At the level of eigenvalues , using ( 2 . 4 – 2 . 6 ) , we have the equations (cid:18) β 0 + 2 ( N − 2 ) β 1 + (cid:18) N − 2 2 (cid:19) β 2 (cid:19) 2 = 1 + 2 ( N − 2 ) α 1 + (cid:18) N − 2 2 (cid:19) α 2 , ( 2 . 10 ) ( β 0 + ( N − 4 ) β 1 − ( N − 3 ) β 2 ) 2 = 1 + ( N − 4 ) α 1 − ( N − 3 ) α 2 , ( 2 . 11 ) ( β 0 − 2 β 1 + β 2 ) 2 = 1 − 2 α 1 + α 2 , ( 2 . 12 ) which is equivalent to   1 2 ( N − 2 ) (cid:0) N − 2 2 (cid:1) 1 N − 4 − N + 3 1 − 2 1     β 0 β 1 β 2   =   ± (cid:113) 1 + 2 ( N − 2 ) α 1 + (cid:0) N − 2 2 (cid:1) α 2 ± (cid:112) 1 + ( N − 4 ) α 1 − ( N − 3 ) α 2 ±√ 1 − 2 α 1 + α 2   where the ± are independent . The matrix is invertible for N > 2 so this gives an explicit formula for the eight roots of ( 2 . 7 – 2 . 9 ) . Having done this it is straightforward to implement the SONETS procedure for an undi - rected graph . We compute Σ 12 ( α ) ω , an then perform thresholding on Σ 12 ( α ) ω to determine the presence or absence of a particular edge . In this example , and most of the numerical examples in this paper the graphs have N = 100 vertices and α 0 = 1 , and the thresholding level x is chosen to make the probability of a single edge P ( ω i > x ) = . 1 . The other two parameters are chosen to satisfy 2 ( N − 2 ) α 1 + (cid:0) N − 2 2 (cid:1) α 2 = 0 . A word about this choice is in order . The covariance matrices considered here always have the vector ( 1 , 1 , 1 , . . . , 1 ) t as an eigenvector : in this particular case the corresponding eigenvalue is α 0 + 2 ( N − 2 ) α 1 + (cid:0) N − 2 2 (cid:1) α 2 . If each ω i has unit variance then ω . ( 1 , 1 , 1 , . . . , 1 ) is , by the central limit theorem , typically of the order of √ N . If α 0 + 2 ( N − 2 ) α 1 + (cid:0) N − 2 2 (cid:1) α 2 is large ( meaning much larger than O ( 1 ) ) then the mean of Σ 12 ( α ) will typically be much larger than O ( √ N ) . What happens in this case is that realizations of the graph will tend to either have very few edges , or very many edges , and the vertex degree distribution of a single realization will look nothing like the average distribution . For this reason in all numerics examples we choose the coeﬃcients so that the eigenvalue of Σ corresponding to the vector ( 1 , 1 , 1 , . . . , 1 ) is O ( 1 ) . In Figure 3 we give the results of some numerical simulations for α 1 = { 0 . 0 , 0 . 2 , 0 . 4 } . The left - hand panels depict a single realization of the random graph . The graph is drawn with vertices of high degree located most centrally , while those of the lowest degree lie near the periphery . The right - hand panels give a histogram of the vertex degrees from an ensemble of one hundred realizations of the random graph , with a dark square denoting the sample mean vertex degree . Since the single edge probability is p = 0 . 1 the expected value of the vertex degree is 9 . 9 , and the sample mean is quite close to this value in all of the experiments . The case α 1 = 0 corresponds exactly to the Erd˝os - R´enyi case . Here we see a roughly normal distribution of the vertex degree about the mean . Recall that α 1 measures correlations between edges that share a vertex . Increasing this correlation coeﬃcient to α 1 = 0 . 2 we induce correlations between edges sharing a vertex . This produces a dramatic broadening of the distribution : there are many more vertices of high degree as well as many more vertices of low degree . This becomes even more pronounced as the coeﬃcent is further increased to α 1 = 0 . 4 . 14 JARED C . BRONSKI AND TIMOTHY FERGUSON ■ 0 10 20 30 40 50 0 500 1000 1500 Vertex Degree N u m be r ■ 0 10 20 30 40 50 0 500 1000 1500 Vertex Degree N u m be r ■ 0 10 20 30 40 50 0 500 1000 1500 Vertex Degree N u m be r Centrality Graph Histogram of Vertex Degree Figure 3 . Random graphs ( N = 100 vertices ) generated with the undirected analog of the Nykamp - Zhao algorithm . The parameters were chosen so that α 0 = 1 and 2 ( N − 2 ) α 1 + (cid:0) N − 2 2 (cid:1) α 2 = 0 . The lefthand panels depict one realization of the random graph , with the graph drawn so that higher degree vertices are located more centrally and lower degree vertices are further out , with unconnected vertices arranged along the bottom edge . The righthand panels represent histograms of the vertex degree drawn from 100 realizations of the random graph . The parameter values are ( to to bottom ) α 1 = 0 . 0 , 0 . 2 , 0 . 4 . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 15 2 . 3 . The Nykamp - Zhao HCC and random directed graph generation . There are a couple of minor complications when moving from the Johnson association scheme to the Nykamp - Zhao HCC . It is straightforward to compute that , owing to the algebra satisﬁed by the Nykamp - Zhao HCC we have the following identity ( β 0 R id + β 1 R recip + β 2 R div + β 3 R chain + β 3 R anti + β 4 R conv + β 5 R disj ) 2 = α 0 R id + α 1 R recip + α 2 R div + α 3 R chain + α 3 R anti + α 4 R conv + α 5 R disj where the coeﬃcients { α i } 5 i = 0 and { β i } 5 i = 0 are related through α 0 = β 20 + β 21 + ( N − 2 ) ( β 22 + 2 β 23 + β 24 ) + ( N − 3 ) ( N − 2 ) β 25 , ( 2 . 13 ) α 1 = 2 β 0 β 1 + ( N − 2 ) ( 2 β 2 β 3 + 2 β 3 β 4 ) + ( N − 2 ) ( N − 3 ) β 25 , ( 2 . 14 ) α 2 = 2 β 0 β 2 + 2 β 1 β 3 + ( N − 3 ) β 23 + 2 β 3 β 4 + 2 ( N − 3 ) β 3 β 5 ( 2 . 15 ) + 2 ( N − 3 ) β 4 β 5 + ( N − 3 ( N − 4 ) ) β 25 + ( N − 3 ) β 22 , α 3 = β 1 β 2 + 2 β 0 β 3 + ( N − 3 ) β 2 β 3 + a 23 + β 1 β 4 + β 2 β 4 + ( N − 3 ) β 3 β 4 ( 2 . 16 ) + ( N − 3 ) β 2 β 5 + 2 ( N − 3 ) β 3 β 5 + ( N − 3 ) β 4 β 5 + ( N − 3 ) ( N − 4 ) β 25 , α 4 = 2 β 1 β 3 + 2 β 2 β 3 + ( N − 3 ) β 23 + 2 β 0 β 4 + ( N − 3 ) β 24 ( 2 . 17 ) + 2 ( N − 3 ) β 2 β 5 + 2 ( N − 3 ) β 3 β 5 + ( N − 3 ) ( N − 4 ) β 25 , α 5 = 2 β 2 β 3 + 2 β 23 + 2 β 2 β 4 + 2 β 3 β 4 + 2 β 0 β 5 + 2 β 1 β 5 + 2 ( N − 4 ) β 2 β 5 ( 2 . 18 ) + 4 ( N − 4 ) β 3 β 5 + 2 ( N − 4 ) β 4 β 5 + ( N − 4 ) ( N − 5 ) β 25 . Here we have assumed the symmetric case , where the coeﬃcients of the chain and anti - chain motifs are the same . Note that similar equations were derived by Zhao in his thesis work : on pages 94 and 95 in Appendix A of Zhao’s thesis the ﬁrst ﬁve of these equations appear ( with β 5 = 0 ) as ( A . 3 ) - ( A . 7 ) . The reason β 5 = 0 is because Nykamp and Zhao do not consider the disjoint motif . Note that this implies that the algorithm , as presented by Zhao , induces correlations among disjoint edges , as α 5 is typically not zero when β 5 = 0 . The algorithm presented in Zhao’s thesis presents an approximate method for solving the above coupled system of quadratic equations by assuming β div / chain / conv = O ( 1 √ N ) and relating the resulting reduced system to the numerical extraction of the square root of a 2 × 2 symmetric matrix . The main point of this section is to observe that one can , for essentially the same computational work , solve this system exactly rather than approximately . In the previous Johnson scheme calculation there were three eigenvalues that depended linearly on the three coeﬃcients deﬁning an element of the algebra . This allowed us the “diagonalize” the solution of the coupled quadratic equations . In the Nykamp - Zhao HCC there are only ﬁve distinct eigenvalues , and seven parameters that deﬁne an element of the algebra ( six if we are assuming a symmetric matrix ) , so obviously the eigenvalues cannot be used as coordinates in the same way . Further the map between the parameters of the algebra and the eigenvalues is not linear , so the inversion of the map becomes more complicated . However there is still a simple way to extract the square root of a linear combination of the matrices R ( k ) in computational time which is independent of the size of the graph . To begin we note a couple of facts : • The seven matrices R ( k ) and the corresponding matrices ρ ( k ) are linearly independent as vectors in R N ( N − 1 ) × N ( N − 1 ) and R 49 respectively . 16 JARED C . BRONSKI AND TIMOTHY FERGUSON • The map between the algebra spanned by R ( k ) and that spanned by ρ ( k ) is therefore invertible . • Given ρ = (cid:80) k α k ρ ( k ) in the intersection algebra one can recover the coeﬃcients α k by solving the linear system G α = β where β k = Tr ( ρ (cid:62) ρ ( k ) ) and G =   7 1 3 N − 10 N − 4 N − 4 3 N − 10 N 2 − 9 N + 20 1 7 N − 4 3 N − 10 3 N − 10 N − 4 N 2 − 9 N + 20 3 N − 10 N − 4 7 N 2 − 40 N + 66 N 2 − 8 N + 18 3 N 2 − 20 N + 34 N 2 − 8 N + 16 3 N 3 − 33 N 2 + 126 N − 166 N − 4 3 N − 10 N 2 − 8 N + 18 7 N 2 − 40 N + 66 N 2 − 8 N + 16 3 N 2 − 20 N + 34 3 N 3 − 33 N 2 + 126 N − 166 N − 4 3 N − 10 3 N 2 − 20 N + 34 N 2 − 8 N + 16 7 N 2 − 40 N + 66 N 2 − 8 N + 18 3 N 3 − 33 N 2 + 126 N − 166 3 N − 10 N − 4 N 2 − 8 N + 16 3 N 2 − 20 N + 34 N 2 − 8 N + 18 7 N 2 − 40 N + 66 3 N 3 − 33 N 2 + 126 N − 166 N 2 − 9 N + 20 N 2 − 9 N + 20 3 N 3 − 33 N 2 + 126 N − 166 3 N 3 − 33 N 2 + 126 N − 166 3 N 3 − 33 N 2 + 126 N − 166 3 N 3 − 33 N 2 + 126 N − 166 7 N 4 − 94 N 3 + 499 N 2 − 1232 N + 1186   is the Gram matrix of { ρ ( k ) } k : G ij = Tr ( ( ρ ( i ) ) (cid:62) ρ ( j ) ) . It is easy to check that the Gram matrix G has a determinant that is a polynomial of degree 12 in N with no real roots , and is thus always invertible . Therefore an eﬃcient way to compute the ( positive deﬁnite ) square root of a positive deﬁnite covariance matrix Σ ( α ) = (cid:80) k α k R ( k ) is as follows : ( 1 ) Compute the image of Σ under the homomorphism : ς = ρ ( Σ ) = ρ ( (cid:80) k α k R ( k ) . ( 2 ) Compute the square root of ς spectrally in the usual way : ς 12 = UΛ 12 U − 1 , where ς = UΛU − 1 . While non - symmetric ς is diagonalizable with positive eigenvalues . ( 3 ) Compute the coeﬃcients β k in the decomposition of ς 12 = (cid:80) k β k ρ ( k ) by solving (cid:80) j G ij β j = Tr ( ( ς 12 ) (cid:62) ρ ( i ) ) . ( 4 ) Pull back to the covariance via Σ 12 = (cid:80) k β k R ( k ) . We will generally assume that positive deﬁnite square root is the one taken , although any of the 2 5 = 32 branches of the square roots are compatible with the algebra may be chosen . As a ﬁnal practical note we remark that for large networks all of the matrices R X are sparse except for R Disj . The matrices sum to the matrix with entries 1 , which is rank one . It is simple to multiply any vector x by the matrix of all ones , since it is rank one , so one can eﬃciently multiply any vector by the covariance using sparse techniques . We refer the reader to the original papers of Nykamp , Zhao and collaborators for more numerical studies , but we present a few numerical simulations of graphs generated using the SONETS scheme as presented here . As one might expect our results are qualitatively similar . To keep things simple we vary only two parameters , α recip and α conv . As a reminder α recip induces correlations between a directed edge and the reciprocal ( oppositely directed ) edge , while α conv induces correlations between edges that are oriented into the same vertex . Figure ( 4 ) presents some numerical experiments . As in the previous experiments we have taken a random graph with N = 100 vertices and a threshold chosen to give an individual edge probability of p = 0 . 1 . The top row shows α recip = α conv = 0 . The expected number of edges with no reciprocal edge in this case is 9900 × ( . 1 ) × ( 1 − . 1 ) = 891 , while the expected number of edges where the reciprocal edge is also present is 9900 × ( . 1 ) × ( . 1 ) = 99 . The leftmost panel depicts a single realization of the random graph , again drawn with the vertices of highest degree located most centrally . This realization had 867 single edges and 98 reciprocal edge pairs . The middle ﬁgure gives a pixel plot of the adjacency matrix of the graph – each block is black if the corresponding edge is present and white if the edge is absent . The ﬁnal panel depicts a histogram of the distribution of the in - degree of the vertices along with a smooth curve approximating the distribution of the out - degree . As one MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 17 might expect both the in and out - degree are roughly normal with a mean of ≈ 9 . 9 . The sample mean in - degree and out - degree ( which must be the same ) are indicated by the square and diamond respectively . Note that here we have chosen the eigenvalue corresponding to eigenvector ( 1 , 1 , 1 , . . . , 1 ) t to be zero , not one . This implies that the case α 1 = 0 is not quite the ER case , since α 2 is small and negative , indicating that disjoint edges are slightly anti - correlated . Numerics on the pure ER case looked quite similar . The next row shows the eﬀect of increasing correlations between reciprocal edges by taking α recip = 0 . 75 . The graphs and histograms look quite similar , as do the pixel plots , though the second pixel plot appears to have more symmetry across the diagonal than the ﬁrst picture . This is born out by the table below , which gives an average of the number of missing edges , single edges ( those where the reciprocal edge is not present ) and reciprocal edge pairs for one hundred realizations of a random graph . ( α recip , α conv ) # absent edges # edges not in reciprocal motif # edges in reciprocal motif ( 0 , 0 ) 8912 . 49 887 . 63 99 . 88 ( 0 . 75 , 0 ) 8905 . 86 485 . 78 508 . 36 ( 0 , 0 . 75 ) 8895 . 67 903 . 99 100 . 34 While the average number of edges has not substantially changed from the ﬁrst experi - ment , and the histograms of in - degree and out - degree also look quite similar , the number of reciprocal edge pairs has gone up dramatically , from roughly one tenth of the total edges to just over half of the total edges . The ﬁnal sequence of plots depicts the case where correlations are induced between edges incident to the same vertex by increasing α conv , but reciprocal edges are uncorrelated α recip = 0 . For these parameter values we have many unconnected vertices , which are not drawn . This should broaden the distribution of the in - degree ( which is governed by α conv but is not expected to markedly change the distribution of the out - degree ( governed by α div ) . In this case all three plots diﬀer markedly from the ﬁrst two . The distribution of in - degrees ( histogram ) is much broader , though the distibution of out - degrees ( continuous curve ) does not seem to have changed appreciably . There are many vertices of low in - degree together with a few vertices of very high in - degree – substantially higher than occured in the ﬁrst two sets of experiments . In fact the scale chosen cuts oﬀ the total number of vertices of degree zero : there were about 5500 over the one hundred realizations , so on average more than half the vertices were unconnected . The pixel plot shows strong layering , as one might expect , with the horizontal lines representing vertices with a high in - degree and the horizontal white stripes representing vertices with low in - degree . Increasing α div , conversely , would lead to vertical striping , as well as a broadening of the distribution of out - degree . Also note from the previous table that reciprocal motif again occurs with the probability that one would expect based on the assumption of independent edges . 18 JARED C . BRONSKI AND TIMOTHY FERGUSON ■◆ 0 10 20 30 40 50 60 70 0 200 400 600 800 1000 1200 1400 Vertex In / Out Degree N u m be r ■◆ 0 10 20 30 40 50 60 70 0 200 400 600 800 1000 1200 1400 Vertex In / Out Degree N u m be r ■◆ 0 10 20 30 40 50 60 70 0 200 400 600 800 1000 1200 1400 Vertex In / Out Degree N u m be r Centrality Graph Pixel plot Distributions of vertex in and out - degree . Figure 4 . Some numerical simulations with N = 100 vertices , 100 realiza - tions of the random graph , and P ( ω ≥ x ) = 0 . 1 . The three panels depict ( left to right ) a single realization of the random graph , a pixel plot of the adjacency matrix for the graph of that realization , and histograms of the in - degree and out - degree of the vertices . The parameter values are ( α recip , α conv ) = ( 0 , 0 ) , ( α recip , α conv ) = ( 0 . 75 , 0 ) , ( α recip , α conv ) = ( 0 , 0 . 75 ) . 2 . 4 . Other examples . In addition to the Johnson scheme and the Nykamp - Zhao coherent conﬁguration there are many other situations where association schemes or coherent conﬁg - urations might arise in generating a random network . The main assumption required for a coherent conﬁguration , assumption ( 4 ) in Deﬁnition ( 1 ) , is a strong homogeneity assump - tion . In essence it requires that every pair satisfying a particular relation in some sense looks like every other pair satisfying that relation . One situation that might be of interest in , say , a neuroscience context would be a network with two ( or more ) diﬀerent types of vertex . In the directed case one would have ( with two types of vertex ) four diﬀerent types of edge ( a → a , a → b , b → a , b → b ) and numerous possible diﬀerent motifs . We work out the simplest possible such example here . There is a single distinguished vertex ( type a ) and N undistinguished vertices ( type b ) . Edges are undirected , and therefore of MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 19 two types : those between two undistinguished vertices ( undistinguished edges ) and those between an undistinguished vertex and the distinguished one ( distinguished edges ) . This leads to a ( non - homogeneous ) coherent conﬁguration with nine relations . • R 11 I – the identity relation for undistiguished edges . • R 11 A – the relation for adjacent undistinguished edges . • R 11 D – the relation for disjoint undistinguished edges . • R 12 A – two adjacent edges , the ﬁrst of which is undistinguished , the second distin - guished . • R 21 A = ( R 12 A ) † – two adjacent edges , the ﬁrst of which is distinguished , the second undistinguished . • R 12 D – two disjoint edges , the ﬁrst of which is undistinguished , the second distin - guished . • R 21 D = ( R 12 D ) † – two disjoint edges , the ﬁrst of which is distinguished , the second undistinguished . • R 22 I – the identity relation for distinguished edges . • R 22 A – two adjacent edges , both of which are distinguished . The notations here are that the subscripts I , A , D denote identity , adjacent and disjoint relations , meaning the edges share two , one or zero vertices . The superscripts ij indicate whether the the ﬁrst edge ( i ) and the second edge ( j ) are undistinguished ( 1 ) or distinguished ( 2 ) . Note that this is a non - homogeneous coherent conﬁguration , as R 11 I and R 22 I provide a partition of the diagonal . There are in principle 9 3 = 729 structure constants , but these are very sparse due to the block structure of the relations . In particular it is easy to see that the following rules apply • ( R ijx ) † = R jix • R ijx R kly = 0 if j (cid:54) = k • R ijx R jky = (cid:80) z R ikz where x , y , z ∈ { I , A , D } . There are ﬁve symmetric relations , and four transpose - conjugate pairs , so the covariance matrix has seven parameters . The remaining quadratic relations 20 JARED C . BRONSKI AND TIMOTHY FERGUSON satisﬁed by the algebra are given below , and deﬁne all of the non - zero intersection numbers : R 11 I · R ikx = R 1 kx R 11 I · R 2 kx = 0 R 22 I · R ikx = 0 R 22 I · R 2 kx = R 2 kx R 11 A · R 11 A = 2 ( N − 2 ) R 11 I + ( N − 2 ) R 11 A + 4 R 11 D R 11 A · R 11 D = ( N − 3 ) R 11 A + 2 ( N − 4 ) R 11 D R 11 A · R 12 A = ( N − 2 ) R 12 A + 2 R 12 D R 11 A · R 12 D = ( N − 2 ) R 12 A + 2 ( N − 3 ) R 12 D R 11 D · R 11 A = ( N − 3 ) R 11 A + 2 ( N − 4 ) R 11 D R 11 D · R 12 A = ( N − 3 ) R 12 D R 11 D · R 12 D = (cid:18) N − 2 2 (cid:19) R 12 A + (cid:18) N − 3 2 (cid:19) R 12 D R 12 A · R 21 A = 2 R 11 I + R 11 A R 12 A · R 21 D = R 11 A + 2 R 11 D R 12 A · R 22 A = R 12 A + 2 R 12 D R 12 D · R 21 A = R 11 A + 2 R 11 D R 12 D · R 21 D = ( N − 2 ) R 11 I + ( N − 3 ) R 11 A + ( N − 4 ) R 11 D R 12 D · R 22 A = ( N − 2 ) R 12 A + ( N − 3 ) R 12 D . This coherent conﬁguration contains the Johnson scheme J ( N , 2 ) as a subscheme . Since this scheme has nine relations any covariance matrix built up from this scheme will have , at most , nine distinct eigenvalues . In fact one can compute the eigenvalues using the 9 × 9 intersection algebra to ﬁnd that there are only ﬁve distinct eigenvalues . We do not list them here but note that , similar to the Nykamp - Zhao scheme , the eigenvalues are linear or algebraic of degree two . We generate some second order networks , again with N = 100 vertices , for the model of a complete graph with a single distinguished vertex . In previous cases there was a single identity element , the coeﬃcient of which could always be scaled to α I = 1 . In this case since there are two types of edge the identity partitions into two parts , which can in principle have diﬀerent weights . We have chosen α 22 I ( associated with distinguished edges ) to always be equal to 1 , and chosen the threshold so that the probability of distinguished edges is p = . 1 . The coeﬃcient of the undistinguished edges α 11 I is chosen to be either α 11 I = 1 , giving a single undistinguished edge probability of . 1 , or α 11 I = 2 giving a single edge probability of about . 183 . In these experiments we always pick α 12 A = α 21 A = α 22 A = 0 , so there are no correlations between a pair of adjacent distinguished edges , or between an adjacent distinguished and MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 21 undistinguished edge . We enforce the mean zero conditions α 11 I + 2 ( N − 2 ) α 11 A + (cid:18) N − 2 2 (cid:19) α 11 D + ( N − 2 ) α 12 D = 0 ( N − 1 ) α 12 A + (cid:18) N − 2 2 (cid:19) α 12 D + α 22 I + ( N − 1 ) α 22 D = 0 . Figure 5 presents the results of some numerical experiments . The left - most panel depicts a single realization of the random graph with the undistinguished vertices arranged around a circle with the distinguished vertex at the center of the circle . The second panel repre - sents the same graph with the vertices arranged by centrality , with vertices of higher degree closer to the center . The ﬁnal panel gives a histogram of the vertex degrees of the undis - tinguished vertices together with a square ( blue online ) denoting the sample mean degree of the distinguished vertex and a diamond ( red online ) depicting the sample mean degree of the undistinguished vertices . The ﬁrst row depicts the case α 11 I = 1 and α 22 I = 1 . In this case we see a roughly normal distribution of the vertex degrees around the expected value , 9 . 9 . If we increase the variance of the undistinguished edges ( keeping the same threshold for all edges ) we of course see the distribution of the degrees of the undistiguished vertices shift to the right , with no real change in shape . The sample mean degree of the distinguished vertex remains the same , however . Next we increase α 11 A , meaning that we have positive correlations between undistinguished edges that are incident to the same vertex ( necessarily undistinguished ) . Here again we see a distinct broadening of the distribution of the undis - tinguished vertex degrees , with a higher probability of having vertices of high and of low degree . One can see this reﬂected in the second graph : as compared with the graph above it there is a denser “core” of strongly connected vertices together with a “halo” of weakly connected vertices . Note that this change in the degree distribution is very diﬃcult to see in the circular imbedding of the graph . This example can itself be generalized in a number of ways . One could consider the case where there are N vertices of one type and M vertices of a second type . In this case there are three types of edge and twenty relations , ten symmetric relations and ten relations that are conjugate - transposes of one another , leading to a covariance matrix depending on ﬁfteen parameters . As in the previous case the actual number of distinct eigenvalues is somewhat less than is guaranteed by the theorem : the theorem guarantees that there are at most twenty distinct eigenvalues , but numerical computations suggest that there are , in fact , only ten distinct eigenvalues . We have not computed all of the intersection numbers for this case , but it would be relatively straightforward to do so using a symbolic manipulator such as Mathematica . Similarly one could consider a directed analog of the above . Another example would be an extension of the SONETS algorithm to generating random subgraphs of a graph other than the complete graph – say the Johnson J ( N , 2 ) graph . In the undirected SONETS based on the complete graph there are only three relations , the identity relation , the adjacent relation , and the disjoint relation . This corresponds to the fact that that line graph of the complete graph ( the Johnson graph ) is a distance regular graph of diameter two . The line graph of the Johnson graph is not a regular graph , but it does have an underlying homogeneous coherent conﬁguration , which can be described as follows . The vertices of the Johnson graph J ( N , 2 ) are indexed by two element subsets of { 1 . . . N } . Vertices are connected by an edge if they intersect in one element , so it is natural to index the edges by a two element subset and a disjoint one element subset , { { i , j } , { k } } , 22 JARED C . BRONSKI AND TIMOTHY FERGUSON ■◆ 0 10 20 30 40 50 60 0 200 400 600 800 1000 1200 1400 Vertex Degree N u m be r ■ ◆ 0 10 20 30 40 50 60 0 200 400 600 800 1000 1200 1400 Vertex Degree N u m be r ■ ◆ 0 10 20 30 40 50 60 0 200 400 600 800 1000 1200 1400 Vertex Degree N u m be r Circular Graph Centrality Graph Histogram of Vertex Degrees Figure 5 . Some numerical experiments for the second order network based on a complete graph with one distinguished vertex . The left and center panels give diﬀerent presentations of the same graph . The ﬁnal panel gives a histogram of vertex degrees . with i , j , k all distinct , representing the edge from vertex { i , k } to vertex { j , k } . Given two edges { { i , j } , { k } } and { { i (cid:48) , j (cid:48) } , { k (cid:48) } } there are a total of twelve relations which are most naturally indexed by a 4 - tuple ( p , q , r , s ) deﬁned as follows . p = | { i , j } ∩ { i (cid:48) , j (cid:48) } | q = | { k } ∩ { k (cid:48) } | r = | { k } ∩ { i (cid:48) , j (cid:48) } | s = | { k (cid:48) } ∩ { i , j } | . Clearly p ∈ { 0 , 1 , 2 } and q , r , s ∈ { 0 , 1 } , however we have the additional constraint that r and s must be zero if either p or q takes the maximal value ( p = 2 and q = 1 respectively . ) This leads to a homogeneous coherent conﬁguration with twelve relations . One could use this to generate , via the SONETS algorithm , a random subgraph of the Johnson graph in which edges in various relations are correlated . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 23 3 . Conclusions and Future Directions We have considered the problem of generating second order networks random networks – networks in which the edges are not statistically independent but rather diﬀerent two - element subgraphs ( motifs ) occur with diﬀerent probabilities . We show that the algorithm proposed by Nykamp , Zhao and collaborators for generating such networks is intimately connected with a certain family of coherent conﬁgurations , and that the underlying algebraic structure of the coherent conﬁguration , namely the existence of a ﬁxed dimensional representation of the algebra ( the intersection algebra ) makes many of the linear algebraic computations simple to carry out . Further we have shown that it is possible to generalize this structure to generate many new types of random networks . While it is straightforward to write down ( in terms of multidimensional error type integrals ) the probability of having any particular two or , indeed , k edge motif it is not clear what the large N limiting distribution of ( for instance ) quantities like the vertex degree distribution might be . It would be interesting , though potentially diﬃcult , to derive asymptotics for the large N limit of quantities such as the vertex degree distribution . Acknowledgements : The authors would like to acknowledge support from the National Science Foundation under Grant DMS - 1615418 . References [ 1 ] William Aiello , Fan Chung , and Linyuan Lu . A random graph model for massive graphs . In Proceedings of the Thirty - second Annual ACM Symposium on Theory of Computing , STOC ’00 , pages 171 – 180 , New York , NY , USA , 2000 . ACM . [ 2 ] R´eka Albert and Albert - L´aszl´o Barab´asi . Statistical mechanics of complex networks . Rev . Modern Phys . , 74 ( 1 ) : 47 – 97 , 2002 . [ 3 ] R . A . Bailey . Association schemes , volume 84 of Cambridge Studies in Advanced Mathematics . Cam - bridge University Press , Cambridge , 2004 . Designed experiments , algebra and combinatorics . [ 4 ] Eiichi Bannai and Tatsuro Ito . Algebraic combinatorics . I . The Benjamin / Cummings Publishing Co . , Inc . , Menlo Park , CA , 1984 . Association schemes . [ 5 ] Albert - L´aszl´o Barab´asi . Scale - free networks : A decade and beyond . Science , 325 ( 5939 ) : 412 – 413 , 2009 . [ 6 ] Albert - L´aszl´o Barab´asi and R´eka Albert . Emergence of scaling in random networks . Science , 286 ( 5439 ) : 509 – 512 , 1999 . [ 7 ] Danielle S . Bassett , Mason A . Porter , Nicholas F . Wymbs , Scott T . Grafton , Jean M . Carlson , and Peter J . Mucha . Robust detection of dynamic community structure in networks . Chaos : An Interdisci - plinary Journal of Nonlinear Science , 23 ( 1 ) : 013142 , 2018 / 07 / 18 2013 . [ 8 ] Vladimir Batagelj and Ulrik Brandes . Eﬃcient generation of large random networks . Phys . Rev . E , 71 : 036113 , Mar 2005 . [ 9 ] Joseph Blitzstein and Persi Diaconis . A sequential importance sampling algorithm for generating random graphs with prescribed degrees . Internet Mathematics , 6 ( 4 ) : 489 – 522 , 03 2011 . [ 10 ] Peter J Cameron . Coherent conﬁgurations , association schemes and permutation groups . In Groups , Combinatorics And Geometry : DURHAM 2001 , pages 55 – 71 . World Scientiﬁc , 2003 . [ 11 ] Fan Chung , Linyuan Lu , and Van Vu . The spectra of random graphs with given expected degrees . Internet Mathematics , 1 ( 3 ) : 257 – 275 , 2004 . [ 12 ] Charo I . Del Genio , Hyunju Kim , Zolt´an Toroczkai , and Kevin E . Bassler . Eﬃcient and Exact Sampling of Simple Graphs with Given Arbitrary Degree Sequence . PLoS ONE , 5 ( 4 ) : e10012 + , April 2010 . [ 13 ] P . Delsarte and V . I . Levenshtein . Association schemes and coding theory . IEEE Transactions on In - formation Theory , 44 ( 6 ) : 2477 – 2504 , 1998 . [ 14 ] Samantha Fuller . Second order networks with spatial structure . Master’s thesis , 2016 . [ 15 ] A . Hanaki and I . Miyamoto . Classiﬁcation of association schemes with 16 and 17 vertices . Kyushu Journal of Mathematics , 52 ( 2 ) : 383 – 395 , 1998 . 24 JARED C . BRONSKI AND TIMOTHY FERGUSON [ 16 ] A Hanaki and I Miyamoto . Classiﬁcation of association schemes with 18 and 19 vertices . Korean Journal of Computational & Applied Mathematics , 5 ( 3 ) : 543 – 551 , 1998 . [ 17 ] Donald G Higman . Coherent conﬁgurations . Geometriae Dedicata , 4 ( 1 ) : 1 – 32 , 1975 . [ 18 ] S . Itzkovitz , R . Milo , N . Kashtan , G . Ziv , and U . Alon . Subgraphs in random networks . Phys . Rev . E , 68 : 026127 , Aug 2003 . [ 19 ] N . Kashtan , S . Itzkovitz , R . Milo , and U . Alon . Eﬃcient sampling algorithm for estimating subgraph concentrations and detecting network motifs . Bioinformatics , 20 ( 11 ) : 1746 – 1758 , 2004 . [ 20 ] R . Milo , S . Shen - Orr , S . Itzkovitz , N . Kashtan , D . Chklovskii , and U . Alon . Network motifs : Simple building blocks of complex networks . Science , 298 ( 5594 ) : 824 – 827 , 2002 . [ 21 ] M . E . J . Newman . Clustering and preferential attachment in growing networks . Phys . Rev . E , 64 : 025102 , Jul 2001 . [ 22 ] M . E . J . Newman and D . J . Watts . Renormalization group analysis of the small - world network model . Physics Letters A , 263 ( 4 ) : 341 – 346 , 1999 . [ 23 ] Mason A . Porter , Jukka - Pekka Onnela , and Peter J . Mucha . Communities in networks . Notices Amer . Math . Soc . , 56 ( 9 ) : 1082 – 1097 , 2009 . [ 24 ] Duncan J . Watts and Steven H . Strogatz . Collective dynamics of ‘small - world’networks . Nature , 393 : 440 EP – , 06 1998 . [ 25 ] Elisabeth Wong , Brittany Baur , Saad Quader , and Chun - Hsi Huang . Biological network motif detection : principles and practice . Brieﬁngs in Bioinformatics , 13 ( 2 ) : 202 – 215 , 2012 . [ 26 ] Liqiong Zhao . Synchronization on second order networks . PhD thesis , 2012 . [ 27 ] Liqiong Zhao , Bryce II Beverlin , Tay Netoﬀ , and Duane Quinn Nykamp . Synchronization from second order network connectivity statistics . Frontiers in computational neuroscience , 5 : 28 , 2011 . [ 28 ] Paul - Hermann Zieschang . Theory of association schemes . Springer Monographs in Mathematics . Springer - Verlag , Berlin , 2005 . 4 . Appendix Proof of Proposition 1 . We begin by proving that ρ is a homomorphism which is equivalent to demonstrating that ρ ( R ( i ) R ( j ) ) = ρ ( R ( i ) ) ρ ( R ( j ) ) . Expanding the left and right hand sides gives ρ ( R ( i ) R ( j ) ) rs = ρ ( (cid:88) k ρ ( R ( i ) ) kj R ( k ) ) rs = (cid:88) k ρ ( R ( i ) ) kj ρ ( R ( k ) ) rs and ( ρ ( R ( i ) ) ρ ( R ( j ) ) ) rs = (cid:88) k ρ ( R ( i ) ) rk ρ ( R ( j ) ) ks . In order to conclude that these two quantities are equal we compute the product R ( i ) R ( j ) R ( s ) in two diﬀerent ways , namely , ( R ( i ) R ( j ) ) R ( s ) = (cid:88) k ρ ( R ( i ) ) kj R ( k ) R ( s ) = (cid:88) k ρ ( R ( i ) ) kj (cid:88) r ρ ( R ( k ) ) rs R ( r ) = (cid:88) r ( (cid:88) k ρ ( R ( i ) ) kj ρ ( R ( k ) ) rs ) R ( r ) and R ( i ) ( R ( j ) R ( s ) ) = (cid:88) k ρ ( R ( j ) ) ks R ( i ) R ( k ) = (cid:88) k ρ ( R ( j ) ) ks (cid:88) r ρ ( R ( i ) ) rk R ( r ) = (cid:88) r ( (cid:88) k ρ ( R ( i ) ) rk ρ ( R ( j ) ) ks ) R ( r ) . MOTIFS , COHERENT CONFIGURATIONS AND SECOND ORDER NETWORK GENERATION 25 Comparing the coeﬃcients of R ( r ) gives the desired result . Now we turn our attention to eigenvalues . Throughout the rest of the proof we will make use of the simple identity M ( (cid:88) k β k R ( k ) ) = (cid:88) k β (cid:62) ρ ( M ) k R ( k ) ( 4 . 1 ) which follows directly from the deﬁnition of ρ . It easily follows from ( 4 . 1 ) that if λ is an eigenvalue of ρ ( M ) with left eigenvector β , then M ( (cid:88) k β k R ( k ) ) = λ ( (cid:88) k β k R ( k ) ) . ( 4 . 2 ) Since R ( 0 ) , R ( 1 ) , . . . , R ( d ) have disjoint support we know that rank ( (cid:80) k β k R ( k ) ) ≥ 1 so that λ is also an eigenvector of M . To show the converse , namely , that if λ is an eigenvalue of M , then it is an eigenvalue of ρ ( M ) , we note that it suﬃces to only consider the case λ = 0 . This is because ρ is linear , I is in the algebra generated by R ( 0 ) , R ( 1 ) , . . . , R ( d ) , and ρ ( I ) is the identity matrix in its algebra . Therefore for the sake of contradiction suppose that zero is an eigenvalue of M but not of ρ ( M ) . By ( 4 . 1 ) we see that det ( (cid:88) k β (cid:62) ρ ( M ) k R ( k ) ) = 0 for any β . Since zero is not an eigenvalue of ρ ( M ) the map β (cid:55)→ β (cid:62) ρ ( M ) is surjective and hence there exists a β for which (cid:80) k β (cid:62) ρ ( M ) k R ( k ) = I . This of course leads to the contradiction det ( I ) = 0 completing the argument . Next we prove that Mult ( λ ) = rank ( ( (cid:88) k β k R ( k ) ) β ∈B λ ) . We will start by proving that Mult ( λ ) is at least as large as the right hand side . As mentioned before it suﬃces to consider λ = 0 . To start we note that there exists a k ≥ 1 for which B λ is a basis for the left null space of ρ ( M ) k = ρ ( M k ) . By ( 4 . 2 ) this implies that the dimension of the left eigenspace of M k is at least rank ( ( (cid:80) k β k R ( k ) ) β ∈B λ ) . However , every eigenvector of M k is a generalized eigenvector of M . This establishes our inequality . Finally , there exists a vector γ so that (cid:88) λ ∈ σ ( ρ ( M ) ) Mult ( λ ) ≥ (cid:88) λ ∈ σ ( ρ ( M ) ) rank ( ( (cid:88) k β k R ( k ) ) β ∈B λ ) ≥ (cid:88) λ ∈ σ ( ρ ( M ) ) rank ( (cid:88) k (cid:88) β ∈B λ β k γ β R ( i ) ) ≥ rank ( (cid:88) k (cid:88) λ ∈ σ ( ρ ( M ) ) (cid:88) β ∈B λ β k γ β R ( k ) ) = rank ( I ) . Therefore all inequalities are in fact equalities giving the result . Now to show that ρ is injective suppose that ρ ( M ) = 0 . Then ρ ( M ) has a left eigenbasis for the eigenvalue zero . By repeating the above argument with k = 1 we see that M has a right eigenbasis for the eigenvalue zero and hence is zero . This completes the proof . 26 JARED C . BRONSKI AND TIMOTHY FERGUSON Finally we consider diagonalizability . If P is a polynomial then clearly ρ ( P ( M ) ) = P ( ρ ( M ) ) . In particular , if P is the minimal polynomial of M then P ( ρ ( M ) ) = 0 . A necessary and suﬃcient condition for diagonalizability is that the eigenvalues are simple roots of the minimal polynomial . Since M and ρ ( M ) have the same eigenvalues the result follows . (cid:3)
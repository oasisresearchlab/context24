Fast Two - Dimensional Bubble Analysis of Biopolymer Filamentous Networks Pore Size from Confocal Microscopy Thin Data Stacks Matteo Molteni , † Davide Magatti , † Barbara Cardinali , ‡ Mattia Rocco , ‡ and Fabio Ferri † * † Dipartimento di Scienza e Alta Tecnologia , Università dell’Insubria , Via Valleggio 11 , Italy ; and ‡ S . S . Biopolimeri e Proteomica , Istituto Nazionale per la Ricerca sul Cancro , Genova , Italy . Molteni et al . 2D - Bubble Analysis of Biopolymer Networks Submitted July 23 , 2012 , and accepted for publication January 7 , 2013 . * Correspondence : fabio . ferri @ uninsubria . it Davide Magatti’s present address is Light in Light s . r . l . via Ferrari 14 , I - 22100 Como , Italy . Barbara Cardinali’s present address is SS Sviluppo Terapie Innovative , IRCCS AOU San Martino IST , Genova , Italy . Editor : Charles Wolgemuth . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 1 Supporting Material Supplement Appendix A - Pore size of in silico gels ( other morphologies ) . In this section we present five three - dimensional ( 3D ) in silico networks that have been generated , in addition to the in silico fibrin gels described in the main text , for the validation of our 2D bubble method . Below , we will briefly describe how these networks are synthesized , what are the main features of their geometrical properties , and present in detail the results that have been summarized in Table 1 of Sect . Results and Discussion of the main text . As for the in silico fibrin gels , the aim of this section is to investigate whether is possible to establish a simple relationship between the 2D - average bubble diameter < D > 2D found with the 2D method and the corresponding 3D - average diameter < D > 3D found with the 3D method . The networks that we studied were generated according to : ( a ) a standard Voronoi tessellation ; ( b ) a standard Delaunay triangulation ; ( c ) a simulated annealing Euclidean Graph Generation ( EGG ) algorithm for mimicking the structural and elastic properties of collagen gels ( 1 ) ; ( d ) a Delaunay designed algorithm for producing Photonic Band Gap ( PBG ) materials characterized by complete large band gaps in the optical frequency range ( 2 , 3 ) . Each network was synthesized by first computing the coordinates of its nodal points ( the points at which the fibers are linked together ) and then by finding which couples of nodal points are linked by a fiber . Each fiber was represented as a straight cylinder of diameter d and length L equal to the distance between the connected nodal points . To avoid boundary effects , the nodal points were first Figure S1 – 3D renderings of in silico networks of different morphologies : Voronoi ( a ) , Delaunay ( b ) , Euclidean Graphic Generation ( EGG ) of collagen gels ( c ) , Photon Band Gap ( PBG ) networks ( d ) , fibrin gels ( e ) . Cube side = 25 µ m . ( d ) ( e ) ( b ) ( c ) ( a ) 25 µ m Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 2 generated over an extended volume , and then cropping or cutting parts of all the fibers that fall outside the volume of analysis . At the end of this procedure , the coordinates of all the fibers constituting the network were determined , and the network geometrical properties were characterized in terms of the distributions of its fibers length , angle between fibers and branching order of its nodal points . A 3D renderings of the five networks studied in this work , together with the in silico gel of Ref . ( 4 ) , are illustrated in Fig . S1 . a ) Voronoi networks Three dimensional Voronoi networks were generated starting from a set of N randomly distributed seeding points in a volume V . By using the freeware “qhull” routines available online ( http : / / www . qhull . org ) , the convex polyhedron that defines the Voronoi cell of each seeding point was found , and its edges and vertices were determined . The edges of all the Voronoi cells are the line segments that represent the fibers of the network , while the vertices are the nodal points at which these fibers are connected together . A 3D rendering of a Voronoi network is shown in Fig . S1 ( a ) . The geometrical properties of a Voronoi gel are characterized ( see Fig . S2 , first row ) by an angle distribution between fibers similar to that of the in silico fibrin gels , with < α > = 111 ± 36 degs , but quite different branching order and fiber length distributions . The first one is monodisperse with < k > = 4 . 0 ± 0 . 0 , while the second one is much broader and peaked for L → 0 , with σ L / < L > ~ 0 . 73 . When our 2D and 3D bubble methods are applied to Voronoi gels of different concentrations , we obtain the distributions reported in Fig . S3 , first row . As for the fibrin gels , all the 2D and 3D distributions can be rescaled onto two single master curves , but in this case , they appear to be rather different , with the 2D one broader than the 3D one and skewed toward small D / < D > values . The corresponding two relative standard deviations are σ 2D / < D > 2D ~ 0 . 33 and σ 3D / < D > 3D ~ 0 . 19 . Nevertheless , when the 2D and 3D average diameters are compared , they are remarkably similar with a ratio of < D > 2D / < D > 3D ~ 1 . 00 ± 0 . 02 constant over the entire investigated φ range . b ) Delaunay networks As for the Voronoi case , 3D Delaunay networks were generated starting from a set of N randomly distributed nodal points in a volume V and performing a 3D triangulation by using the “qhull” routines . In this way the nodal points become the vertices of the tetrahedra , whose edges represent the fibers of the network . A 3D rendering of a Delaunay network is shown in Fig . S1 ( b ) . The geometrical properties of a Delaunay gel are characterized ( see Fig . S2 , second row ) by an angle distribution between fibers somewhat more symmetric with respect that of the Voronoi gels , with < α > = 93 ± 37 degs . The branching order distribution is bell shaped with a much higher average value < k > = 15 . 5 ± 3 . 3 , and the fiber length distribution is a smooth bell shaped curve with a relative standard deviation σ L / < L > ~ 0 . 32 . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 3 The 2D and 3D bubble diameter distributions obtained with our bubble methods are reported in Fig . S3 , second row . As for the Voronoi gels , all the 2D and 3D distributions can be rescaled onto two single master curves , which are characterized by quite different shapes and relative standard deviations , i . e . σ 2D / < D > 2D ~ 0 . 50 and σ 3D / < D > 3D ~ 0 . 34 . Nevertheless , also in this case the 2D and 3D average diameters scale in the same manner , with their ratio of < D > 2D / < D > 3D ~ 1 . 14 ± 0 . 03 constant over the entire φ range . Figure S2 – Comparison between the angle distributions between fibers ( left column ) , branching order distributions ( central column ) and fiber length distributions ( right column ) for different in silico networks : Voronoi ( row a ) , Delaunay ( row b ) , EGG collagen ( row c ) and Photonic Band Gap ( PBG ) ( row d ) networks at different volume fractions φ . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 4 Figure S3 – Comparison between the 2D ( left column ) and 3D ( right column ) bubble diameter distributions obtained for different types of in silico networks : Voronoi ( row a ) , Delaunay ( row b ) , EGG collagen ( row c ) and Photonic Band Gap ( PBG ) ( row d ) networks at different volume fractions φ . The insets ( panels 2 and 4 ) represent the master curves obtained rescaling the data of panels 1 and 3 by their corresponding average diameters ( < D > 2D or < D > 3D ) and by their maximum values ( P 2D ( < D > 2D ) or P 3D ( < D > 3D ) ) . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 5 c ) Euclidean Graph Generation of collagen networks The artificial regeneration of collagen type - I networks was recently performed with a simulated annealing method based on a novel algorithm called Euclidean Graph Generation ( EGG ) ( 1 ) . The networks reconstructed in this way are made of a collection of straight fibers linked at some nodal points , with a structure characterized by the same statistical geometrical features ( fiber length , branching order and fiber - fiber angle distributions ) and similar mechanical properties as those of the original networks . EGG collagen networks were regenerated for three different concentrations and analyzed with our 2D and 3D bubble methods ( EGG networks identical to the ones described in Ref . ( 1 ) of the main article were gently provided us by S . Lindström , Royal Institute of Technology , Stockholm , Sweden ) . A 3D rendering of an EGG network is shown in Fig . S1 ( c ) . The geometrical properties of an EGG network are characterized ( see Fig . S2 , third row ) by an angle distribution between fibers similar to that Voronoi gels , with < α > = 110 ± 32 degs . The branching order distribution is similar to the of fibrin gels with < k > = 3 . 4 ± 0 . 7 , and the fiber length distribution is a smooth bell shaped curve with a relative standard deviation σ L / < L > ~ 0 . 59 . The results relative to our 2D and 3D bubble methods , shown in Fig . S3 , third row , are very similar to the previous cases : there are two single master curves characterized by similar relative standard deviations , i . e . σ 2D / < D > 2D ~ 0 . 44 and σ 3D / < D > 3D ~ 0 . 46 , and the ratio < D > 2D / < D > 3D ~ 1 . 36 ± 0 . 01 is constant over the entire φ range . d ) Photonic Band Gap networks Photonic Band Gap ( PBG ) networks are novel isotropic disordered materials that exhibits complete large band gaps in the optical frequency range , independently from direction and polarization of the incident light ( 2 ) . These unusual features , which are related to the structural topology of the PBG networks , make these materials quite interesting for many applications , such as radiation sources , sensors , waveguides , and optical computer chips . For a recent review on PBG materials , as well as for their implementation in 3D see Refs . ( 3 , 5 ) . Following ( 3 , 5 ) we generated PBG networks by performing a 3D Delaunay triangulation from a set of N points distributed in a volume V . Then the centroids ( centers of mass ) of all the tetrahedra were treated as the nodal points of the network and connected with fibers to their nearest neighbors centroids . Since each tetrahedra has four facets , all the nodal points have the same branching order , equal to four . In order to optimize the optical properties of the PBG network , the initial points must be distributed not randomly ( as done for Delaunay networks ) , but according to a so called hyperuniform patterns distribution , where the points positions are anticorrelated on a short length scale . This feature was realized by randomly spreading the points in the volume , but with the exclusion of a spherical shell of diameter d scr around each of them . Practically , whenever the random position of a point was whiting the screening region of any other point previously generated , that point is rejected and another one is generated . The procedure ends when no more points can be added to the volume . The final result is a hyperuniform pattern ( 6 ) characterized by a ratio between the average point distance d pnt = ( V / N ) 1 / 3 and the screening diameter given by Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 6 ρ = d pnt / d scr ~ 1 . 1 , which would correspond , if all the points were considered as spheres of diameter d scr , to a volume fraction of ~ 40 % . The hyperuniform exponent ( 6 ) of the pattern was ~ 2 . 5 . The geometrical properties of a PBG gel are characterized ( Fig . S2 , fourth row ) by an angle distribution between fibers much more symmetric with respect that of the other networks , with < α > = 106 ± 27 degs . The branching order distribution is monodisperse with < k > = 4 . 0 ± 0 . 0 and the fiber length distribution is a smooth bell shaped curve with a relative standard deviation σ L / < L > ~ 0 . 25 . The 2D and 3D bubble diameter distributions of PBG networks obtained with our bubble methods are reported in Fig . S3 , fourth row . As for the other cases , all the 2D and 3D distributions can be rescaled onto two single master curves characterized by quite different shapes and relative standard deviations , i . e . σ 2D / < D > 2D ~ 0 . 50 and σ 3D / < D > 3D ~ 0 . 34 . Remarkably , also in this case the 2D and 3D average diameters scale in the same manner , with their ratio of < D > 2D / < D > 3D ~ 1 . 17 ± 0 . 02 constant over the entire φ range . Appendix B – Estimate of systematic errors present in the 2D - and 3D - bubble methods . The 3D - and 2D - bubble methods described in the Materials and Methods Section of the main text , are based on iterative algorithms that need to be stopped at a given point because of the increasingly larger processing times . Indeed , due to the overlapping mechanism , the rates at which new bubbles are added to the set of already selected covering bubbles become increasingly slower , and eventually vanish . In our methods , we adopted a stopping criterion determined by a target covering area ( or covering volume in 3D ) , according to which the coverage procedures are considered to be completed when the filling ratios of the covered zones reach a threshold equal to values of 0 . 50 for 3D - and 0 . 70 for the 2D - bubble methods , respectively . In this section , we want to estimate the systematic errors introduced in the recovered distributions by using these thresholds . We mainly focus on the 2D method ( which is the one of interest in this work ) , but we will discuss also the main results of the 3D method . Our analysis starts by analyzing the features of the “asymptotic” distributions P 2D ( D ) that one would recover with an ideally infinite number of seeding points . Practically , such distributions were found by using a number of seeding points much larger than the number of covering bubble ( typically a factor ~ 10 ) , so that the covering can be considered completed . We carried out this test on five in silico fibrin gels ( set B of in Fig . 4 of main text ) whose volume fractions ranges between 3 . 9×10 −4 < φ < 1 . 1×10 −2 . Fig . S4 shows two examples of the covering areas attained with the asymptotic distributions for gel # 1 and # 3 of set B , whose volume fractions are φ 1 = 1 . 1×10 −2 and φ 3 = 2 . 6×10 −3 . As one can notice , gel # 1 and # 3 are characterized by similar average covering areas < a > , but different standard deviations , i . e . < a 1 > = 0 . 84 ± 0 . 04 and < a 3 > = 0 . 81 ± 0 . 10 . This occurs because , being φ 1 > φ 3 , bubbles of gel # 1 are smaller than bubbles of gel # 3 and , consequently , a higher number of bubbles ( < N 1 > = 26 . 4 ± 3 . 6 against < N 3 > = 8 . 3 ± 2 . 3 . ) is necessary to reach , on average and with reduced fluctuations , the same covering area . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 7 For both gels , the behavior of the average diameters < D i > 2D of each single slice as a function of the covering area is shown in Fig . S5 . The corresponding overall average diameters , < D > 2D , are indicated by the two horizontal dashed lines [ ( < D > 2D ) 1 = 4 . 38 ± 3 . 6 µ m , ( < D > 2D ) 3 = 7 . 32 ± 3 . 6 µ m ] . The important information that can be gathered from Fig . S5 is that there is no correlation between the average diameter recovered for each slice and the corresponding covering area , meaning that < D i > 2D is ( statistically ) independent on the covering area attained for that slice . This implies that all the slices are equivalent , and the correct overall bubble diameter distribution P 2D ( D ) can be obtained by averaging all the diameters of all the slices . The distribution Figure S4 – Behaviors of the covered areas attained with the asymptotic distributions ( number of seeding points → ∞ ) of gel # 1 ( a ) and gel # 3 ( b ) as a function of slice number . ( a ) ( b ) Figure S5 – Behaviors of the average 2D - bubble diameter < D i > 2D obtained from the asymptotic distributions ( number of seeding points → ∞ ) of each slice of gel # 1 ( circles ) and gel # 3 ( triangles ) as a function of the corresponding i - th covered area . The horizontal dashed lines indicate the overall average diameters of the two gels . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 8 retrieved in this way is a number distribution , because each bubble diameter is counted only once during the computation . Unfortunately , the procedure outlined above is not generally applicable because requires quite long processing times ( hundreds of seconds / slice ) . Thus the procedure must be stopped at a given point , in correspondence of which the covering area will be smaller than the maximum covering area attainable for that slice . As a consequence , some systematic errors are unavoidably introduced in the recovered distributions . These errors derive from the reduced number of bubbles used for the ( partial ) covering and are due to the fact that the probability of selecting a bubble is not uniform . Consequently , larger bubbles are weighted more heavily for two reasons : ( i ) before going through the including / discarding procedure , the bubbles are sorted according to their decreasing diameters , so that larger bubbles are selected before smaller bubbles ; ( ii ) the initial probability of selecting a bubble , when there is no or only marginal overlapping , scales as D 2 in 2D . Thus , the lower the covering area , the higher the bias introduced in the recovered distribution . As an extreme example , we can mention that , if only one bubble / slice were selected , being in this case the probability rigorously proportional to D 2 , one would recover area distributions rather than number distributions , with consequent very large systematic errors . As mentioned above , we have adopted as a stopping criterion for the 2D - bubble method the attainment of a target covering area , whose threshold was set to a value of 0 . 7 . This threshold was set empirically on the basis of a tradeoff between processing times , statistics and accuracy . With a threshold of 0 . 7 , typical processing times are < 1 min / slice , the percentage of slices reaching target covering area are higher 80 - 90 % and accuracy is ~ 5 % . The latter one was estimated by studying the behavior of the average bubble diameter < D > 2D associated to a distribution P 2D ( D ) recovered with a given covering area , as a function of the covering area . Fig . S6 reports such a behavior , in which the recovered average diameters have been normalized to their values retrieved with the asymptotic Figure S6 – Behavior of the ratio between the average 2D - bubble diameter < D > 2D retrieved at a given covering area and the asymptotic average diameter as a function of the covering area threshold . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 9 distributions . Average values and error bars have been obtained by averaging results over the five in silico gels of Set B . The figure shows clearly that the use of a threshold for the target covering area produces a systematic error , which tends to increasingly overestimate the average diameter as the threshold is lowered . At a threshold of 0 . 7 , such overestimate is of the order of ~ 5 ± 1 % for all the in silico gels of set B , therefore independent of gel concentration or , equivalently , independent of number of bubbles / slice . The systematic deviations introduced by the threshold = 0 . 7 are also evident in Fig . S7 , where the asymptotic and the 0 . 7 threshold distributions relative to gels # 1 and # 3 , are compared . The figure shows clearly that the 0 . 7 threshold distributions slightly overestimates the probability of finding bubbles with diameters larger than average and slightly underestimates the probability of bubbles with diameters smaller than average . In terms of distribution moments , this distortion produces a ~ 5 % overestimate of the average diameter ( Fig . S6 ) and a ~ 2 % overestimate of its standard deviation . As a further comment , it is important to recall that the analysis described above throughout Figs . S4 - S7 has been carried out on in silico gels , i . e . , networks of an assigned morphology . While we expect that the main conclusions ( overestimates of average recovered diameters ) would remain the same also for other network morphologies , the exact figures are likely to change from case to case , depending on the shape of the asymptotic P 2D ( D ) distribution . Thus , since the stopping criterion associated to the target covering area favors the selection of larger bubbles more than smaller bubbles , broad and asymmetric distributions skewed toward smaller diameters ( such as the Delaunay and EGG distributions of Fig . S3 , left column ) should exhibit the largest systematic errors . Our preliminary results confirm such a trend ( data not shown ) , but in any case , for all the morphologies of Fig . S3 , the systematic errors are less than ~ 10 % . The analysis of systematic errors just described for the 2D method was performed also for the 3D - bubble method . Here , the situation is quite different because , although apparently very similar Figure S7 – Comparison between the asymptotic ( filled symbols ) and the distribution retrieved at a covering area threshold = 0 . 7 ( open symbols ) for gel # 1 ( circles ) and # 3 ( triangles ) of the in silico gels of set B . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 10 as far as concern the iterative algorithms , the two methods presents profound differences that make them to behave quite differently in term of convergence . In the 2D method , each generated bubble lies somewhere around the position of the seeding point that has produced it . This is because the algorithm has been designed [ see main text at point a5 ) of the iterative procedure in 2D - pore size analysis of the gel pore size ] to find the bubble in the same pore zone where the seeding point is generated . Thus , as described above , the first ( non overlapped ) bubbles are found with a probability that scales as D 2 and this is the mechanism that is responsible for the systematic errors present in the final distribution retrieved at a covering area threshold = 0 . 7 . In the 3D method , there is no feedback mechanism that prevents a bubble from being produced in a pore zone different from the one where the seeding point was generated . Thus , the strong correlation between seeding points and location of the generated bubble present in the 2D method is ( almost ) completely lost in 3D , making the probabilities of generating bubbles of different diameters much more uniform . The final effect is that there is no preferred route leading to the final volume coverage of the pore zones , and almost no systematic errors are introduced if a distribution is retrieved with partial volume covering . In the 3D method , the average volume covering of the asymptotic P 3D ( D ) distributions is ~ 0 . 60 - 0 . 65 , a figure that is rather smaller than the one found in 2D , which is ~ 0 . 80 - 0 . 85 . Thus , based on the same tradeoff of the 2D case between processing times , statistics and accuracy , we decided to set the target covering volume to a value of 0 . 5 . The associated errors introduced in the parameters of the recovered distribution ( average value and standard deviation ) were non systematic and of the order of ~ 1 % . A detailed analysis of these errors as well as a theoretical a priori justification of the results reported in this section will be presented elsewhere . ( M . Molteni , F . Ferri . Stereology approach to the pore size determination of biopolymer filamentous networks . In preparation . ) Appendix C – Validation of the 3D bubble method via the covering radius transform ( CRT ) technique . The validation of our 3D bubble method was carried out by comparing our method with the well known ( maximal ) covering radius transform ( CRT ) technique ( 7 , 8 ) . When applied to the same in silico gels , the two methods provide quite consistent results , provided that corrected weighted distributions are considered . Indeed , while our method recovers number distributions , because each bubble diameter is counted only once during the computation due to covering procedure , the CRT method returns weight ( or volume ) distributions because the statistics is performed over all the voxels belonging to the pore regions . A comparison between the volume diameter distributions characterizing one of the gels of Fig . 3 ( c ) of the main text ( φ = 1 . 2 × 10 −2 ) , recovered with the CRT and our method is shown in Fig . S8 . The two distributions appear to be quite similar with average diameters which differs less than 1 % , namely < D > 3D , vol = 1 . 96 ± 0 . 49 µ m and < D > CRT = 1 . 98 ± 0 . 41 µ m . For comparison , the average ( number ) diameter associated to the recovered number distribution P 3D ( D ) recovered with our method was < D > 3D , num = 1 . 64 ± 0 . 48 µ m . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 11 Appendix D - Fibrin gels preparation for confocal microscopy Lyophilized plasminogen - Von Willebrand factor - and fibronectin - depleted human fibrinogen ( FG ) was type FIB3 from Enzyme Research Laboratories ( South Bend , IN , USA ) . It was reconstituted at 37 °C at a nominal concentration of 20 mg / ml in the original buffer ( sodium citrate – HCl 20 mM , pH 7 . 4 ) with the addition of 10 kallikrein inhibitor units ( KIU ) / ml of aprotinin ( serine protease inhibitor , Sigma – Aldrich , St . Louis , MO ) . The FG solution was then dialyzed twice at 4 °C for 4 h against TBS buffer ( 50 mM tris ( hydroxymethyl ) aminomethane ( Tris ) , 104 mM NaCl , pH 7 . 4 ) . The concentration was determined from the absorbance at 280 nm , after correcting for scattering contributions by subtracting the absorbance at 320 nm , using a specific adsorption coefficient E 280 of 1 . 51 ml mg - 1 cm - 1 . All spectroscopic measurements were performed in a Beckman DU - 640 spectrophotometer ( Beckman Analytical , Milan , Italy ) . The solution was then divided in aliquots , snap - frozen in liquid N 2 , and stored at - 80°C . Lyophilized human thrombin ( Sigma - Aldrich ) was reconstituted with HPLC - grade water to a final nominal concentration of 1 NIH ( National Institutes of Health ) units / ml . It was then divided in aliquots and stored at - 20 °C . Thrombin activity was determined with the chromogenic substrate N - benzoyl - Phe - Val - Arg - p - nitroanilide ( Sigma B - 7632 ) using the method of Lottenberg et al . ( 10 ) and with a turbidimetric clotting time assays . For the latter , 200 μL of a 1 . 1 mg / ml FG solution in Hepes 0 . 43 % , sodium citrate 5 . 45 mM , pH 7 . 4 , were dispensed in 5 plastic disposable UV micro - cuvettes placed in the 6 - position sample holder of the Beckman DU - 640 spectrophotometer , thermostatted at 37 °C . Polymerization was started by the addition at 20 s intervals of 100 µ L of a solution of the thrombin stock used for the gel formation , appropriately diluted to ~ 0 . 05 NIH u / ml in Hepes 0 . 85 % , pH 7 . 4 ( except to the first cuvette , where 100 μL of Hepes buffer were added ) . The reaction was monitored at 350 nm for 30 min . The end of the lag time was determined by fitting the first 400 s data points with a Cascade equation using TableCurve2D ( SSI , San José , CA , USA ) , and the NIH u / ml were determined by comparison with a standard curve obtained with a WHO international standard thrombin sample . Figure S8 – Comparison between our 3D - bubble method and the Covering Radius transform ( CRT ) method of Ref . ( 9 ) . The two curves represent the volume weighted distribution of the spheres diameters used for covering the pore zones of the gel of Fig . 3 ( c ) . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 12 FG labeling was carried out using Alexa Fluor 488 succinimidyl ester ( Molecular Probes , Eugene , OR , USA ) , a water soluble primary amine specific dye , pH - insensitive in the pH 4 – 10 range . The labeling reaction was performed using a slightly modified protocol from the one suggested by the manufacturer , optimized to roughly have a single dye molecule per FG molecule . We found that a higher degree of labeling influences FG polymerization and therefore the final architecture of the fibrin gel ( data not shown ) . Before labeling , the FG solution was dialyzed twice for 4 h at 4 °C against 0 . 1 M NaHCO 3 , pH 8 . 3 . The Alexa Fluor 488 solution was prepared dissolving 5 mg of dye in 0 . 5 ml of dimethylsulfoxide ( DMSO ) and its exact concentration was determined spectrophotometrically from the absorbance at 495 nm with a specific molar extinction coefficient ε 495 = 71 , 000 M - 1 cm - 1 . The unused dye was divided in small amount aliquots and stored at - 80 °C . Labeling was performed by adding drop wise over a 3 min period a 1 - fold molar ratio of the probe to a 10 mg / ml protein solution in 0 . 1 M NaHCO 3 , pH 8 . 3 , and the reaction was let to proceed on a rotating device at 22 °C ( temperature controlled room ) in the dark for 2 h . The excess of fluorescent probe was eliminated first through centrifiltration at 13 , 000 rpm for 10 min using 0 . 22 µ m spin - X disposable centrifilters ( Sigma - Aldrich ) and then by dialysis at 4 °C for 4 h once against bicarbonate buffer and twice against TBE buffer ( 50 mM Tris , 104 mM NaCl , 1 mM EDTA - Na 2 , pH 7 . 4 ) . The labeled FG concentration was determined correcting the protein absorbance at 280 nm for the contribution of the probe at this wavelength ( correction factor CF = 0 . 15 × A 495 , where the constant was experimentally determined from the ratio A 280 / A 495 of the Alexa Fluor 488 spectrum in TBE ) . The degree of labeling was calculated from the molar ratio between FG and the bound dye determined from its absorbance at 495 nm . The functionality of the labeled FG was determined by comparing the polymerization induced by thrombin of Alexa Fluor 488 - labeled FG with unlabeled material , following the turbidity changes at 350 nm . A 1 / 3 ratio of labeled / unlabeled FG was found to give practically identical curves with totally unlabeled FG . In order to remove aggregates and more degraded FG species , the protein mixture containing 1 / 3 of Alexa Fluor 488 - labelled FG was further purified by size - exclusion chromatography on a 93 × 1 . 6 cm column packed with Superdex 200 Prep Grade resin ( Pharmacia Biotech ) , operated at 4 °C by a FPLC system ( GradiFrac , HiLoad Pump P - 50 , UV - 1 monitor , and Rec 102 recorder , Pharmacia Biotech ) . The loading volume was ~ 1 . 5 ml , the flow rate was 0 . 6 ml / min , and the elution was monitored at 278 nm . The monomeric material was then collected and used for gel formation . The purity of the material was checked in each step of the preparation using SDS - PAGE analysis under reducing and not reducing conditions , as previously reported ( 11 ) ( data not shown ) . Fibrin gels to be analyzed by confocal microscopy were prepared in a “home - made” flow cell , consisting of a Plexiglas ring ( height 0 . 5 cm , diameter 2 cm ) closed on both sides by glued round 0 . 2 mm thick coverslip glasses . At opposite sides of the Plexiglas ring , two small holes were drilled , inside which two pieces of polyethylene tubing ( cut from transfer pipettes ) were inserted and sealed with nail polish . The gels were prepared by mixing in a 1 : 1 ratio a FG solution containing 1 / 3 of Alexa Fluor 488 - labeled FG with a thrombin solution . Mixing was achieved using a double syringe system adapted from the fibrin sealant Tisseel Kit ( Baxter , Deerfield , IL , USA ) . Each syringe was Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 13 equipped with a 0 . 22 µ m low protein binding filter and was connected to the plastic mixer of the Tisseel Kit . The mixer was connected via a three way valve to one of the polyethylene tubing glued to the flow cell . Another three way valve was connected to the exit polyethylene tubing . The cell was mounted in a vertical position on a stand , and was filled from the bottom hole so that no bubbles were trapped inside it . Filling was completed in about 5 - 6 s . After filling , the cell was isolated closing the two valves , and the gel was left to polymerize for about 2 h . Different gels were prepared at a FG concentration of 0 . 5 mg / ml in TBE varying the thrombin concentration ( either 1 / 100 thrombin : FG molar ratio or 0 . 25 NIH u / mg FG ( 1 / 1800 thrombin : FG molar ratio ) . Appendix E - Data processing of confocal images The confocal microscopy data are convolved , noisy data , which , in order to be analyzed with our 2D bubble method , must be first pre - processed and reduced to binary data . To tackle this not trivial problem , we investigated and optimized the data handling procedure by using one of the in silico fibrin gels of Fig . 3 ( c ) of the main text ( φ = 1 . 2 × 10 −2 ) . To this aim , we first convolved all the images of the 3D stack with the typical PSF of a 60 × confocal oil - immersion objective , which for simplicity was assumed to be Gaussian with full - width half maxima FWHM x = FWHM y = 200 nm and FWHM z = 600nm ( 12 ) . Then the overall data were digitized to 4096 levels ( 12 bits ) and Poisson uncorrelated noises equal to 5 % and 10 % of the max level were added to them . The resulting noisy data , which at this point represent a realistic sample of the real data , were processed ( by using the graphical routines available in LabView 2010 ) in the following way : a ) each 2D image of the stack was convolved with a narrow symmetric ( σ x = σ y = σ ) Gaussian distribution for dampening the shot noise in the pore regions and avoiding the insurgence of spurious signals which might be associated to fake fibers . The Gaussian width was set to be σ = 0 . 25 d ( = 1 pixel in our case ) so that it effectively screens out the shot noise signal , but not the signal associated to a real fiber of diameter d . Indeed when convolving the shot noise signal ( 1 pixel wide ) with a Gaussian function whose σ = 1 pixel , its amplitude is dampened by a factor ~ 0 . 13 . Conversely , the convolution of the fiber signal ( 4 pixels wide in our case ) with the same Gaussian function produces an amplitude dampening factor of only ~ 0 . 9 , therefore not affecting the clipping procedure carried out at next step . b ) the data of each image were clipped to the binary values of n = 1 ( fibers ) or n = 0 ( pores ) according to a given ( fractional ) threshold level γ . Since the value of γ was assigned relatively to the maximum count of each image , I max , all the pixels with max I I γ > were set to 1 , while all pixels with max I I γ ≤ were set to 0 . Typical values for γ were in the range 0 . 2 - 0 . 5 . c ) the defects arising from the noising and clipping procedure were removed by applying to each image two standard morphological operations , i . e . the filling of any hole found in a fiber ( a hole is pore island inside a fiber ) and the removal of all the fibers whose area was smaller than Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 14 the minimum area associated to the assigned ( or expected in the case of real gels ) fiber diameter d . The latter operation was introduced for avoiding , as for step a ) , the insurgence of spurious fake fibers . In the case of our in silico gels ( d = 0 . 2 µ m , pixel size = 50 nm ) this minimum area , which corresponds to the case when the fiber is perpendicular to the image plane , was set equal to 13 pixels . The 3D stacks resulting from the procedure outlined trough steps a - c ) were then analyzed with our 2D bubble method and , for any value of γ and noise , the distributions of the bubble diameters were recovered and compared with the expected distribution retrieved from the original gel . In this way an optimal value of γ was found . An example of this analysis is shown in Fig . S9 ( a ) where five diameter distributions recovered at various γ values in the range 0 . 2 - 0 . 5 for a 5 % noise level added to the data , are compared with the expected one ( dashed black curve ) retrieved from the original gel of Fig . 3 ( c ) ( φ = 1 . 2 × 10 −2 ) . As one can easily notice , for small γ - values the recovered distributions are narrower and peaked at lower D values than the expected one , while for large γ - values they are broader and peaked at larger D values . We can quantify the mismatching between the recovered and expected distributions by means of the mean square error ( MSE ) 2 1 i i exp i rec ] ) ( ) ( [ ) / 1 ( ∑ = − = N D P D P N MSE ( S1 ) where D i , i = 1 , . . N are the diameters at which the two distributions are sampled and P rec ( D i ) and P exp ( D i ) are both normalized to unity ( 1 ) ( i rec = δ ∑ D D P , being δ D the bin size ) . The behavior of MSE as a function of γ is reported in Fig . S9 ( b ) for the ( number ) distributions of Fig . S9 ( a ) , together with the MSE evaluated on volume distributions . The figures shows that the two curves follow similar behaviors , with broad minima that occur at γ min ~ 0 . 34 and γ min ~ 0 . 31 for number and volume distributions , respectively . In correspondence of these values , the average ( number ) < D > 2D was recovered with an uncertainty of + 4 % , while the average ( volume ) < D > 2D was recovered with an uncertainty of − 1 % . Similar behaviors are observed when the noise level added to the data was 10 % ( data not shown ) . So , in conclusion , we can state that the optimal value of γ to be used in the analysis of real gels is in the range γ min ~ 0 . 30 − 0 . 35 , depending on which kind of distribution one is interested in , Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 15 However , it should be pointed out that the data handling procedure outlined above is quite critical and require great attention when applied to real confocal data . For example , in a standard confocal image the spatial resolution ( ~ 200 nm ) may be comparable to the fiber diameter and , consequently , in steps a ) and c ) it may become hard to distinguish between real fibers’ signals and shot noise . On the other hand , resolution cannot be increased too much because , otherwise , the field of view of the image becomes too narrow , and boundary effects may dominate and alter the estimation of < D > 2D . Other possible critical situations can arise from the use of oil immersion objectives for imaging aqueous samples , where the axial PSF is highly dependent on the depth at which the sample is imaged , and can reach lengths FWHM z ~ 1 µ m or even longer . In these cases , the 2D - bubble method has to be applied with care because , as we checked on in silico data convolved with PSF of different axial length ( data not shown ) , it provides accurate ( ≤ 5 % ) estimates of < D > 2D only when < D > 2D / FWHM z ≥ 5 . Supporting References . 1 . Lindström , S . B . , D . A . Vader , A . Kulachenko , and D . A . Weitz . 2010 . Biopolymer network geometries : Characterization , regeneration , and elastic properties . Phys . Rev . E . 82 : 051905 / 1 - 5 . 2 . Busch , K . and John , S . Liquid - crystal photonic - band - gap materials : The tunable electromagnetic vacuum . 1999 . Phys . Rev . Lett . 83 : 967 - 970 . 3 . Florescu , M . , S . Torquato , and P . J . Steinhardt . 2009 . Designer disordered materials with large , complete photonic band gaps . Proc . Natl . Acad . Sci . USA 106 : 20658 - 206663 . Figure S9 – Panel ( a ) : 2D diameter distributions recovered for one of the in silico gels of Fig . 3 ( φ = 1 . 2 × 10 −2 ) , for different thresholding levels γ . The noise added to the data was 5 % . The black dashed curve shows the expected distribution , which is retrieved from the original gel . Panel ( b ) : number ( squares ) and volume ( circles ) mean square errors ( MSE ) between the expected and recovered distributions as a function of the γ level ; Panel ( c ) : zoom of Panel ( b ) showing that the minima of the two curves occur at γ min ~ 0 . 34 for ( MSE ) nb and γ min ~ 0 . 31 for ( MSE ) vol . Molteni et al . 2D - bubble analysis of biopolymer networks - Supporting Material Supplement 16 4 . Magatti , D . , M . Molteni , B . Cardinali , M . Rocco , and F . Ferri . 2012 . Modeling of fibrin gels based on confocal microscopy and light scattering data . Submitted to Bioph . J . 5 . Liew , S . F . , Yang , J . K . , Noh , H . , Schreck , C . F . , Dufresne , E . R . , O’Hern , C . S . , and Cao , H . 2011 . Photonic band gaps in three - dimensional network structures with short - range order . Phys . Rev . A . 84 : 063818 / 1 - 6 6 . Torquato S , Stillinger F . H . Local density fluctuations , hyperuniformity , and order metrics . 2003 . Phys . Rev . E . 68 : 041113 / 1 – 25 . 7 . Serra , J . 1982 . Image analysis and mathematical morphology . Academic Press , London . – Chapter X . 8 . Thovert , J . - F . , F . Yousefian , P . Spanne , C . G . Jacquin , and P . M . Adler . 2001 . Grain reconstruction of porous media : application to a low porosity Fontainebleau sandstone . Phys . Rev . E . 63 : 061307 / 1 - 17 . 9 . Mickel , W . , S . Munster , L . M . Jawerth , D . A . Vader , D . A . Weitz , A . P . Sheppard , K . Mecke , B . Fabry , and G . Schroder - Turk . 2008 . Robust pore size analysis of filamentous networks from three - dimensional confocal microscopy . Bioph . J . 95 : 6072 - 6080 . 10 . Lottenberg , R . , U . Christensen , C . M . Jackson , and P . L . Coleman . 1981 . Assay of coagulation proteases using peptide chromogenic and fluorogenic substrates . Meth . Enzymol . 80 : 341 - 361 . 11 . Cardinali , B . , A . Profumo , A . Aprile , O . Byron , G . Morris , S . E . Harding , W . F . Stafford , and M . Rocco . 2010 . Hydrodynamic and mass spectrometry analysis of nearly - intact human fibrinogen , chicken fibrinogen , and of a substantially monodisperse human fibrinogen fragment X . Arch . Biochem . Biophys . 493 : 157 - 168 . 12 . Egner , A . , and S . W . Hell . 2006 . Aberrations in confocal and multi - photon fluorescence microscopy induced by refractive index mismatch , in Handbook of biological confocal microscopy . ( J . B . Pawley Editor , 3th edition , Springer ) , Chapter 15 .
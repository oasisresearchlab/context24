Separating intrinsic from extrinsic fluctuations in dynamic biological systems Andreas Hilfinger and Johan Paulsson 1 Department of Systems Biology , Harvard University , 200 Longwood Avenue , Boston , MA 02115 Edited by John Ross , Stanford University , Stanford , CA , and approved May 19 , 2011 ( received for review December 15 , 2010 ) From molecules in cells to organisms in ecosystems , biological populations fluctuate due to the intrinsic randomness of individual events and the extrinsic influence of changing environments . The combined effect is often too complex for effective analysis , and many studies therefore make simplifying assumptions , for example ignoring either intrinsic or extrinsic effects to reduce the number of model assumptions . Here we mathematically demonstrate how two identical and independent reporters embedded in a shared fluctuating environment can be used to identify intrinsic and extrinsic noise terms , but also how these contributions are quali - tatively and quantitatively different from what has been pre - viously reported . Furthermore , we show for which classes of biological systems the noise contributions identified by dual - repor - ter methods correspond to the noise contributions predicted by correct stochastic models of either intrinsic or extrinsic mechan - isms . We find that for broad classes of systems , the extrinsic noise from the dual - reporter method can be rigorously analyzed using models that ignore intrinsic stochasticity . In contrast , the intrinsic noise can be rigorously analyzed using models that ignore extrinsic stochasticity only under very special conditions that rarely hold in biology . Testing whether the conditions are met is rarely possible and the dual - reporter method may thus produce flawed conclu - sions about the properties of the system , particularly about the in - trinsic noise . Our results contribute toward establishing a rigorous framework to analyze dynamically fluctuating biological systems . gene expression ∣ stochastic networks A ll biological systems are networks of individual agents that interact probabilistically in changing environments . Fluctua - tions in population sizes — whether of chemical species in cells ( 1 ) or of organismic species in ecosystems ( 2 ) — thus arise both from probabilistic births and deaths at low numbers ( “ intrinsic noise ” ) and the randomizing effects of the physical and biological envir - onment ( “ extrinsic noise ” ) . The stochastic dynamics of any given species therefore reflects all directly and indirectly connected processes , many of which are poorly characterized . This explains why fluctuations are so prevalent in biology , but also why they can be overwhelmingly difficult to analyze . For example , even an ac - curate microscopic model of gene expression could not predict fluctuations in protein levels without accounting for variations in , e . g . , RNA polymerases and ribosomes , which in turn depend on yet other components . An ingeniously simple approach to this seemingly intractable problem is to embed a second independent system in the same environment and observe the two copies simultaneously . Corre - lations between the systems then reflect the influence of the common environment , whereas differences between them reflect the spontaneous noise created within each system ( Fig . 1 ) . Such approaches promise to distinguish the intrinsic or extrinsic origin of fluctuations in one fell swoop without knowledge of the micro - scopic details of either the system or its environment . For exam - ple , in microrheology two - particle methods have been used to disentangle material inhomogeneities from diffusion effects ( 3 ) , whereas twin studies attempt to separate genetic from envir - onmental influences during human development ( 4 ) . Here we derive generally applicable methods but focus on dual - reporter applications in molecular biology that are used to identify the cellular sources of fluctuations in protein numbers . The normalized covariance between two reporter proteins within a gene regulatory network has been used as a measure of extrinsic noise defining the remaining noise as intrinsic ( 5 – 8 ) , allowing each category to be modeled and evaluated separate from the other . To ensure that this is a mechanistically sound interpreta - tion rather than an arbitrary definition , early theoretical analyses reported that the total noise indeed can be decomposed into intrinsic and extrinsic parts by conditioning on the state of the shared environment ( 9 ) and that the dual - reporter method can identify those two parts . However , the authors later emphasized relations that contradict key steps of the original proof ( 10 ) . This implies that the originally reported decomposition allows only for static environmental heterogeneity ( Fig . 1 B ) . This may be A C B Fig . 1 . The dual - reporter setup . ( A ) Cartoon illustrating an example dual - reporter setup in which a common cellular environment affects the rates ofgene activation , transcription , and translation of two different fluorescent proteins . ( B ) Signal of two reporters ( red and blue lines ) subject to a common environment ( dashed gray line ) reflecting two sources of variability : stochas - tic events within a system leading to uncorrelated fluctuations ; changes in the common environment leading to correlated fluctuations . In contrast to a dynamic environment , a static heterogenous environment takes differ - ent but constant values . ( C ) Jump processes for two copies of identical and independent stochastic systems with intrinsic variables x ¼ x 1 ; x 2 ; x 3 ; … x n and y ¼ y 1 ; y 2 ; y 3 ; … y n undergoing reactions with step size s k and rates r k that depend on a common time - dependent set of environmental variables z ð t Þ . Generalmasterequation forthetime evolutionofthejoint conditionalprob - ability distribution P ð x ; y j z ð t ÞÞ of the two reporters given a realization of the stochastic environment Z ¼ z ð t Þ . Authorcontributions : A . H . andJ . P . designedresearch , performedresearch , analyzeddata , and wrote the paper . The authors declare no conflict of interest . This article is a PNAS Direct Submission . Freely available online through the PNAS open access option . 1 Towhomcorrespondenceshouldbeaddressed . E - mail : Johan _ Paulsson @ hms . harvard . edu . This article contains supporting information online at www . pnas . org / lookup / suppl / doi : 10 . 1073 / pnas . 1018832108 / - / DCSupplemental . www . pnas . org / cgi / doi / 10 . 1073 / pnas . 1018832108 PNAS ∣ July 19 , 2011 ∣ vol . 108 ∣ no . 29 ∣ 12167 – 12172 S Y S T E M S B I O L O G Y A PP L I E D M A T H E M A T I C S approximately true in special systems , but in many biological net - works the environment and the system are expected to change on similar time scales because they are governed by similar types of processes . For example , in the first experimental analysis ( 5 ) based on this approach , the extrinsic noise was traced back to the influence of a repressor that is expected to change at least as quickly as the fluorescent proteins measured . The main practical reason for decomposing noise into separate terms is to more effectively evaluate models without having to specify both the intrinsic and extrinsic mechanisms simulta - neously — simplifying analyses greatly by reducing the number of ad hoc assumptions and free parameters . However , for that approach to work , the top - down statistical decomposition that is inherent to the dual - reporter method must capture the same noise terms as correct bottom - up mechanistic mathematical mod - els . This is often taken for granted ( 6 – 8 ) but is in fact nontrivial . Here we address these key questions of fluctuations in biology : How can intrinsic and extrinsic types of noise be separated in complex systems ? What do the two categories mean biologically ? How should measurements be compared to mechanistic models ? Decomposing Noise with the Dual - Reporter Method Noise arising from the inherently probabilistic reactions within a system is typically called intrinsic or internal , whereas the effect of environmental fluctuations on a system is called extrinsic or external ( 11 ) . The distinction thus depends on what is defined as system and environment in any particular experiment . The two contributions have been suggested to add up to the total variance with the extrinsic noise identified by the covariance between independent and identical reporters . For example , with x and y denoting the levels of the dual - reporter proteins ( Fig . 1 ) observed in single cells we would have η 2 tot ≡ σ 2 x h x i 2 ¼ η 2 int þ η 2 ext ; [ 1 ] η 2 ext ¼ Cov ð x ; y Þ h x ih y i ; [ 2 ] where averages correspond to an ensemble snapshot over a population of cells ( 5 ) . Here we discuss the idealized scenario of dual reporters that are strictly identical and independent . This assumption is fundamental to the approach and always needs to be established experimentally as in the original dual - reporter study ( 5 ) in which the marginal distributions of the two reporters were almost indistinguishable and the addition of a second repor - ter did not significantly affect the distribution of the first . In ad - dition to the natural heterogeneity , experimental errors can contribute to the observed intrinsic and extrinsic variability . For example , the fluorescence from reporter proteins may imper - fectly reflect the actual protein copy numbers due to slow fluor - ophore maturation . Here we consider only the dynamics of the proteins themselves rather than any technical issues associated with specific experimental methods to infer protein copy numbers . Because intrinsic and extrinsic noise have physical meanings that reflect the origin of fluctuations , the above equations are not definitions but interpretable claims . To prove that the dual - reporter covariance can identify the origin of fluctuations we must thus show that the total noise can be meaningfully decom - posed according to Eq . 1 and that the extrinsic noise is given by Eq . 2 . In the limit where all noise is either intrinsic or extrinsic , this is trivially true : Statistically independent variables by definition do not covary , whereas identical deterministic systems subject to the same inputs by definition take the same values , so that the covar - iance equals the variance . However , the fact that a decomposition “ works ” in the limit where there is nothing to decompose in no way suggests that it is suitable to separate the two noise con - tributions . There are in fact infinitely many pairwise statistical measures that converge to zero in the limit of deterministic extrinsic dynamics and to the covariance in the limit of determi - nistic intrinsic dynamics , but produce different values for inter - mediate scenarios . Because the whole purpose of the approach is to separate between the noise sources , it is thus essential to find a decomposition that provably performs this separation . That was indeed the great appeal of the original motivation ( 5 , 9 ) , though later results ( 10 ) imply that it unfortunately applies only to static environments . Furthermore , for any decomposition to be of practical value beyond a phenotypic classification , the noise terms obtained should also be relatable to mathematical models that account for one type of noise without the other . We will thus establish if the intrinsic part of the total noise corresponds to the fluctuations exhibited by the system in the absence of environmental variability and if the extrinsic part of the total noise corresponds to the fluctuations the system would exhibit in the absence of intrinsic variability . Decomposing Noise by the State of the Environment . The effect of specific variables could in principle be accounted for by condi - tioning experimental data on the state of those variables , for ex - ample , by gating data based on morphology . To summarize this effect in a single number for the whole dataset , the conditional variance so obtained can be averaged over the full process . This is formalized by the law of total variance that splits up the variance of any variable into the expectation of a conditional variance and the variance of a conditional expectation . For example , looking at gene expression with X denoting the number of molecules ( of a protein in interest ) in a given cell , we can always rewrite the ob - served cell - to - cell variability σ 2 X by conditioning the data on the state Z of environmental variables such as the number of poly - merases , ribosomes , etc . σ 2 X ¼ h σ 2 X j Z i | ﬄﬄ { zﬄﬄ } unexplained by Z þ σ 2 h X j Z i | ﬄﬄ { zﬄﬄ } explained by Z : [ 3 ] Here σ 2 X j Z is the variance of X in the subpopulation of cells with some given value of Z , and the angular brackets denote averages over all such subpopulations , whereas σ 2 h X j Z i is the variance of the conditional average of X given Z ( Appendix ) . Though formulated differently , this is mathematically equivalent to the noise decom - position used previously in the motivation for dual - reporter methods ( 9 ) and is also the most common approach to account for the influence of observable variables . To illustrate the biological implications of the above decompo - sition , consider a toy system in which a fluctuating extrinsic vari - able z affects the birth rate of the intrinsic variable x : extrinsic dynamics intrinsic dynamics z (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! λ ext z þ 1 x (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! λ int z x þ 1 z (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! β ext z z − 1 x (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! β int x x − 1 ; [ 4 ] where the reaction rates are transition probabilities per unit time . At stationarity , the total variance of x is then η 2 tot ¼ 1 h x i | { z } η 2 int þ 1 h z i τ z τ x þ τ z | ﬄﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄﬄ } η 2 ext ; [ 5 ] where τ z ¼ 1 ∕ β ext and τ x ¼ 1 ∕ β int are the respective average lifetimes of the environmental and intrinsic components ( 12 ) . Eq . 5 is an exact result for the variance of the above system and highlights two distinct terms : the first term comes from the intrinsic stochastic reactions in X and the second term comes from extrinsic fluctuations in Z levels that are inherited by X in a time - averaged way because as Z changes , X levels adjust only par - tially before the value of Z changes again . In this example the 12168 ∣ www . pnas . org / cgi / doi / 10 . 1073 / pnas . 1018832108 Hilfinger and Paulsson total noise is thus indeed the sum of a purely intrinsic noise η 2 int that is unaffected by environmental fluctuations and a purely ex - trinsic noise η 2 ext that is unaffected by the intrinsic stochasticity . The corresponding decomposition using ( Eq . 3 ) is less straight - forward to derive because conditional master equations are harder to formulate or solve , which perhaps explains why decom - positions are rarely illustrated explicitly in specific examples . Here we derive an exact analytical recurrence relation for the conditional average h x j z i of the system defined in reaction scheme 4 ( SI Appendix ) , leading to the following unexplained and explained parts of the normalized stationary state variance : σ 2 h X j Z i h x i 2 ¼ η 2 ext τ z τ x þ τ z h σ 2 X j Z i h x i 2 ¼ η 2 int þ η 2 ext (cid:3) 1 − τ z τ x þ τ z (cid:4) ; [ 6 ] with η 2 int and η 2 ext as given in Eq . 5 . The above noise decomposition based on the state of the environment thus exaggerates the intrin - sic noise and underestimates the extrinsic noise ( Fig . 2 ) . Even in the limit in which the average h x i is so large that intrinsic fluctua - tions η 2 int are negligible , and X levels respond deterministically to a fluctuating environment , the decomposition of Eq . 3 reports substantial intrinsic noise ( Fig . 2 A ) . Hence , even if we could ex - perimentally measure the current state of all environmental vari - ables , we thus still cannot infer the variability that is due to those variables , simply because the whole history matters . Conditioning on the state of the environment captures the correct contribu - tions only in the limit of infinitely slow environmental fluctuations ( τ z ≫ τ x ) . But few if any cellular components are slow compared to the stable fluorescent proteins studied , let alone static . Con - ditioning on the state of an environmental variable thus does not identify how much it contributes to the overall variance if the environment is dynamic . This problem applies to the motiva - tion of the dual - reporter method and to the many studies that first gate data based on morphology or other observable features . Cell size and age are to some extent excepted from this problem , because the current state is a good predictor of the recent history ( unless growth rates fluctuate rapidly ) but another type of decom - position is still needed . Decomposing Noise by the History of the Environment . To identify the noise contributions in dynamical systems , we instead condi - tion on the full histories of the extrinsic variables ( 13 ) and then average the instantaneous conditional averages over all possible histories . The law of total variance then gives σ 2 X ¼ h σ 2 X t j Z ½ 0 ; t (cid:1) i | ﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄ } σ 2 int þ σ 2 h X t j Z ½ 0 ; t (cid:1)i | ﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄ } σ 2 ext ; [ 7 ] where the intrinsic term is the variance of X t in a group of cells sharing an environmental history Z ½ 0 ; t (cid:1) averaged over all possible histories , and the extrinsic term is the variance of the average X t over different sample paths of the history Z ½ 0 ; t (cid:1) , where time t ¼ 0 corresponds to the infinite past . To stress the time dependence of the conditional averages we have introduced the subscript t for the random variable in the above equation and will use this nota - tion for the remainder of the article . For ergodic systems , aver - aging over all possible histories is equivalent to averaging a single trace over time ( Appendix ) . The so - defined extrinsic noise σ 2 ext can then be interpreted as the variation of the average over time , whereas the intrinsic noise σ 2 int corresponds to the variation around that average ( Fig . 3 ) . Applying those definitions to the example system of reaction scheme 4 leads to the correct intrinsic and extrinsic noise contributions as given in Eq . 5 . In principle , the generalized decomposition Eq . 7 could be ex - perimentally obtained by simultaneously observing a large num - ber of identical reporters in the same cell . However , the two noise contributions can also be obtained using just two reporters . If sys - tems X and Y are identical and independent reporters embedded in the same environment — requiring that the two reporters can - not affect environmental variables , affect each other ’ s reaction rates , or be stoichiometrically coupled in any chemical reaction ( 14 ) — the time evolution of the conditional averages satisfy h X t Y t j Z ½ 0 ; t (cid:1)i ¼ h X t j Z ½ 0 ; t (cid:1)ih Y t j Z ½ 0 ; t (cid:1)i and h X t j Z ½ 0 ; t (cid:1)i ¼ h Y t j Z ½ 0 ; t (cid:1)i ( Appendix ) . The covariance between two independent and iden - tical reporters thus corresponds to the extrinsic noise as defined in Eq . 7 , for any nonlinear or multivariate process : Cov ð X ; Y Þ ¼ hh X t Y t j Z ½ 0 ; t (cid:1)ii − hh X t j Z ½ 0 ; t (cid:1)iihh Y t j Z ½ 0 ; t (cid:1)ii ¼ hh X t j Z ½ 0 ; t (cid:1)ih Y t j Z ½ 0 ; t (cid:1)ii − hh X t j Z ½ 0 ; t (cid:1)ii 2 ¼ hh X t j Z ½ 0 ; t (cid:1) 2 i − hh X t j Z ½ 0 ; t (cid:1)ii 2 ≡ σ 2 ext ; [ 8 ] where the outer brackets denote time averages . Hence measuring the covariance between two reporters can replace an infinite number of reporters to decompose the total noise . Periodic Versus Stochastic Environmental Influences . In some cases the unknown environmental influence z ð t Þ may have a more or less deterministic component that varies periodically over time . For example , many cellular processes are coupled to the cell cy - cle , and in population biology much of the overall variation is explained by the seasons . Previously such a periodic signal has been treated as just one example of a varying extrinsic variable A B Fig . 2 . Decompositions based on the current state of the environment do not separate between intrinsic and extrinsic origins of fluctuations in dyna - micalsystems . ( A ) Comparingthe trueintrinsicnoise ( black line ) ofthesystem defined in reaction scheme 4 with the decomposition that conditions on the current state of the environment ( dashed orange line ) given in Eq . 6 for dif - ferent values of the intrinsic reporter average h x i . The decomposition reports substantial intrinsic noise ( dashed gray line ) even in the deterministic limit h x i → ∞ . Only in the absence of extrinsic noise , or for infinitely slow envir - onmental fluctuations ( τ x ≪ τ z ) , do the two measures agree . ( B ) Comparing the true extrinsic noise ( black line ) with the decomposition of Eq . 6 ( dashed orange line ) for different values of the relative time scale of fluctuations τ x ∕ τ z . Only in the limit of very slow environmental fluctuations does the extrinsicnoiseestimatebasedonanenvironmentalvaluedecomposition con - verge to the true value . ( Insets ) Respective relative errors 1 − h σ 2 X j Z i ∕ σ 2 int and 1 − σ 2 h X j Z i ∕ σ 2 ext . The curves represent families of systems ( cf . Eq . 6 ) , with examplerate parameters corresponding to ( A ) λ ext ¼ 2 and β ext , β int ¼ 1 while varying λ int and ( B ) λ ext , λ int , β ext ¼ 1 while varying β int . Time S i gna l Fig . 3 . Physical definition of intrinsic and extrinsic noise for dynamical systems . Illustrated are two stochastic realizations ( red and blue lines ) of the intrinsic system subject to a given environmental time trace z ð t Þ ( dashed gray line ) . The extrinsic noise corresponds to the variability of the conditional in - trinsic average trace ( solid green line ) , whereas the intrinsic noise is deter - mined by the average variability of the conditioned intrinsic system ( indicated by light green corridor ) . Hilfinger and Paulsson PNAS ∣ July 19 , 2011 ∣ vol . 108 ∣ no . 29 ∣ 12169 S Y S T E M S B I O L O G Y A PP L I E D M A T H E M A T I C S ( 9 ) . However , periodically changing environments are different from truly stochastic environments , not only because the variabil - ity has little to do with noise , but also because the current value of the environment explains much of the variability in the recent history . Asynchronous cell populations then exhibit a nonrandom source of heterogeneity simply because cells at different stages of the cell cycle are different on average . Levels of independent re - porters will thus correlate creating an extrinsic “ noise ” that may completely overshadow truly stochastic sources of extrinsic noise ( 15 ) . The question is thus if we can separate such nonrandom variability due to a periodic but deterministic extrinsic signal from stochastic sources of extrinsic noise . The heterogeneity due to unsynchronized observations can be identified by conditioning on the phase t (cid:2) , with 0 < t (cid:2) < T where T is the period of the environmental signal . The total observed variability for asynchronous cells is then given by ( outer brackets denote averages over the cell - cycle phase ) σ 2 int σ 2 ext σ 2 X = σ 2int ( t ∗ ) + σ 2ext ( t ∗ ) + σ 2 X t ∗ | t ∗ , unexplained by cell cycle position t ∗ explained by cell cycle position t ∗ [ 9 ] where the intrinsic and extrinsic contributions for synchronized cells are given by ( SI Appendix ) σ 2 int ð t (cid:2) Þ ¼ h σ 2 X t j Z ½ 0 ; t (cid:2) (cid:1) i ; σ 2 ext ð t (cid:2) Þ ¼ σ 2 h X t j Z ½ 0 ; t (cid:2) (cid:1)i with outer brackets denoting averages over all histories Z ½ 0 ; t (cid:2) (cid:1) that end at the specific phase t (cid:2) within the periodic cell cycle . The three contributions in Eq . 9 can be inferred from the dual - reporter covariance of asynchronous populations by addi - tionally measuring bulk averages of synchronized populations , making the intrinsic and extrinsic noise contributions experimen - tally accessible without having to follow a synchronized popula - tion at the level of single cells . Observing dual reporters in synchronized cells in turn allows for direct control experiments because the extrinsic noise term is related to the phase depen - dent dual - reporter covariance in synchronized cells ( SI Appendix ) : σ 2 ext ð t (cid:2) Þ ¼ Cov sync ð x ; y ; t (cid:2) Þ . Another important experimental consideration is that growing populations of cells generally exhibit an age structure , with more newborn cells than dividing cells . Bulk observations of asynchro - nous cells will thus correspond to averages over a nonuniform distribution of cell - cycle positions . Eq . 9 can be applied to averages over any distribution of cell - cycle times , but must be used consistently for all measurements . In the following we use it exclusively to analyze decompositions that correspond to cell - cycle averages obtained by picking cells at random times dur - ing the cell cycle with uniform probability . Analyzing Intrinsic Versus Extrinsic Sources of Noise The above results show that a noise decomposition based on environmental history can separate intrinsic and extrinsic noise contributions regardless of microscopic details and that the con - tributions can be experimentally identified using just two inde - pendent reporters . This provides independent interpretations of the intrinsic and extrinsic categories and ensures that the approach is self - consistent without resorting to circularity . How - ever , this level of description is entirely phenotypic and not con - nected to mechanistic representations of the underlying system . There is in fact no guarantee that the intrinsic and extrinsic con - tributions correspond to what is typically thought of as intrinsic and extrinsic processes , except in the trivial and nonuseful limit that there is only one type of noise . Specifically , we ask : Can each noise term be compared to mod - els that account only for either intrinsic or extrinsic mechanisms rather than the whole complex system that is subject to both types of noise ? That is arguably the main purpose of the whole ap - proach and has been taken for granted in practical applications of the dual - reporter method ( 6 – 8 ) . To address this issue we differentiate between different classes of systems . We call the system linear in intrinsic variables if all reaction rates r k are linear functions of x — still allowing nonlinear effects with respect to the environmental variables — so that the total fluxes follow R ð x ; z Þ ¼ a ð z Þ þ J ð z Þ x , for some vector a and Jacobian matrix J . Borrowing terminology from stochastic differ - ential equations we then call the environment additive when the matrix J is independent of z , and multiplicative otherwise . Multi - plicative noise is the rule rather than exception in biology : The rate of encounters between predators and prey depends on the product of population sizes , just as the rates of degradation , tran - scription , and translation depend on the products of substrate and enzyme levels . Modeling Extrinsic Noise . The response of a deterministic system to extrinsic variables is described by a conventional deterministic equation with rates r k where the continuous variables ¯ x ð t Þ re - spond to changes in the environment , according to d ¯ x dt ¼ ∑ k r k ð ¯ x ð t Þ ; z ð t ÞÞ s k ; [ 10 ] for a given environmental sample path z ð t Þ . If such a model could be rigorously compared to the extrinsic noise in Eq . 7 , we could analyze the nature of extrinsic variability without having to specify details of the intrinsic stochastic reactions , such as burst sizes . Starting from the conditional master equation and without spe - cifying the unknown environmental influences we can prove that for systems linear in intrinsic variables , the conditional average h X t j Z ½ 0 ; t (cid:1)i follows the above time evolution equation for the de - terministic system ¯ x ð t Þ ( Appendix ) . The extrinsic noise of the full system thus indeed equals the noise of the intrinsically determi - nistic system ( Eq . 10 ) subjected to the fluctuating environment : σ 2 ext ¼ h ¯ x ð t Þ 2 i − h ¯ x ð t Þi 2 , where brackets denote time averages . As long as the system is linear in intrinsic variables the extrinsic noise obtained from the covariance between dual reporters can thus be rigorously analyzed by a simple deterministic model where the rate “ constants ” vary in time . This is true regardless of the details of the system and allows for arbitrary , nonlinear environmental influences of both stochastic or periodically changing nature . The condition of intrinsic linearity is less restricting than it may seem because many reporter systems have been constructed to be lin - ear in this sense ( 5 , 6 ) . The dual - reporter method is thus broadly applicable to analyze extrinsic fluctuations in complex networks and effectively reduces the number of unknown parameters that would otherwise be necessary to specify the system ’ s intrinsic sto - chasticity on top of the environmental dynamics . If the rates r k instead are nonlinear functions of the intrinsic variables , the sys - tem generally does not satisfy ¯ x ð t Þ ¼ h X t j Z ½ 0 ; t (cid:1)i with ¯ x ð t Þ following Eq . 10 . The extrinsic noise , according to the top - down definition of Eq . 7 , can then still be extracted using the dual - reporter meth - od , but it cannot be rigorously analyzed using mathematical mod - els that ignore the intrinsic stochasticity . Modeling Intrinsic Noise . Many studies instead focus on intrinsic noise and use dual reporters to eliminate the need to account for unknown or complex environmental influences . The remain - ing intrinsic fluctuations in gene expression are often thought of as the variability within a population of cells “ identical not just genetically but also in the concentrations and states of their cellular components ” ( 5 ) . This can be modeled in several ways . For example , if molecules of species X are degraded with a variable degradation rate β ð z Þ x , a constant environment could be created by replacing β ð z Þ by its average . But such approaches , which have been modeled using Langevin approximations ( 10 ) , do not capture the correct aver - 12170 ∣ www . pnas . org / cgi / doi / 10 . 1073 / pnas . 1018832108 Hilfinger and Paulsson age abundances and therefore will not capture the correct intrin - sic noise that is greatly affected by abundances . We follow an al - ternative approach by replacing the fluctuating rate “ constants ” by true constants that ensure that the average abundance and life - time of X are preserved . For systems that are linear in intrinsic variables and subject to additive environmental influences , the noise decomposition based on the environmental history can be obtained analytically . The master equation ( Fig . 1 C ) determines the time evolution of the ensemble variance for a given environmental time trace , and by time averaging the conditional ensemble variance σ 2 X t j Z ½ 0 ; t (cid:1) we can calculate the intrinsic noise σ 2 int for arbitrary additive envir - onmental fluctuations . This shows ( SI Appendix ) that the intrinsic noise is captured by models that replace the fluctuating rates by their averages , which for such systems is equivalent to using rate constants that preserve the average abundances . The intrinsic noise can then be modeled and interpreted separately from ex - trinsic noise . For multiplicative environments we first consider the simplest example where X molecules are produced with rate λ ð z Þ and degraded with rate β ð z Þ per molecule : x (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! λ ð z Þ x þ 1 x (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! β ð z Þ x x − 1 ; [ 11 ] where both β and λ depend in some unspecified way on the fluc - tuating environment . Replacing the fluctuating rates with con - stants that ensure correct average abundances and average lifetimes of X leads to a model that correctly captures the intrinsic noise ( SI Appendix ) — even though noise terms generally are not superimposable in systems with multiplicative noise ( 10 , 14 , 16 ) . Unfortunately this is a special case , and the same strategy fails already if we simply allow for molecules to be produced in bursts instead of one by one , i . e . , x (cid:2) ! λ ð z Þ x þ b . The approach then misleadingly produces the expected scaling with h x i but with an incorrect burst size ( Fig . 4 A ) . Such discrepancies are the rule rather than the exception . Consider for example the commonly used toy model for gene ex - pression ( cf . Fig . 1 A ) where mRNAs x 1 and proteins x 2 follow : mRNA dynamics protein dynamics x 1 (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! λ 1 ð z Þ x 1 þ 1 x 2 (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! λ 2 ð z Þ x 1 x 2 þ 1 x 1 (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! β 1 ð z Þ x 1 x 1 − 1 x 2 (cid:2)(cid:2)(cid:2)(cid:2)(cid:2) ! β 2 ð z Þ x 2 x 2 − 1 : [ 12 ] Replacing the fluctuating rates with a constant environment such that average abundances and lifetimes are preserved will not reproduce the intrinsic noise . This inevitably leads to incorrect inferences of key features , such as how much noise in protein levels is inherited from mRNA fluctuations ( Fig . 4 B ) . Because multiplicative noise is the expectation in virtually all systems , due to bimolecular interactions , this is a severe limitation : Inter - preting the intrinsic noise σ 2 int from dual - reporter experiments in terms of models that ignore the environmental influences does not work even for systems that are linear in all intrinsic variables . The approach also fails for systems with additive environmental influences but nonlinear intrinsic mechanisms , because the aver - age behavior is directly affected by the fluctuations around the average . Discussion From biochemistry to embryonic development , population dynamics and social interactions , many processes are both inher - ently stochastic as well as affected by a wide range of fluctuating inputs ( 1 , 2 , 17 – 23 ) . Experimental observations must then be compared to models that account for both the system of interest as well as its environment , often introducing so many variables that mathematical analysis can degrade from hypothesis testing to mere curve fitting . The effect of “ uninteresting ” variables can to some extent be accounted for by physically or statistically holding them constant , but not all relevant variables are experi - mentally accessible or even known . Alternatively one could use identical pairs of reporters to infer the influence of a shared environment . For example , genetically identical twins can be used to determine what fraction of the phenotypic variance across a population is explained by the shared genes . Here we extend this approach to dynamically changing envir - onments and prove how , e . g . , two protein reporters can be used to determine how much protein noise is explained by variations in the intracellular environment . We show that the extrinsic noise can often be analyzed by models that ignore intrinsic fluctuations , whereas the same approach applied to intrinsic noise will lead to misinterpretations of data . The reason is that , by construction , the law of total variance separates an explained contribution from an unexplained rest — it does not identify multiple explained con - tributions . Even if a random variable is only a function of two statistically independent other random variables , the contribu - tions explained by each of those do not sum up to the total — if 40 % of the total variability is explained by extrinsic fluctuations in gene expression , the remaining 60 % is not explained by intrin - sic fluctuations , except in very special cases . Unfortunately it is not possible to reverse the roles of intrinsic and extrinsic : Two proteins cannot share the same physical copies of genes and mRNAs and at the same time be in different cells . Despite these limitations , dual - reporter methods are still pre - ferable to using a single reporter , where interpretations always rely on detailed assumptions about both the intrinsic and extrinsic mechanisms . In addition to identifying extrinsic contributions , dual reporters can estimate intrinsic contributions in any situa - tion where these completely dominate . Also , comparing distribu - tions across a population of dual - reporter cells to the distribution across single - reporter cells can reveal feedback or competition effects . Even in cases when dual - reporter data cannot be inter - preted without explicit model assumptions about both system and environment , measuring a second reporter allows for more rigorous model testing by providing access to different types of measurable outputs without introducing new parameters . A B inferred lifetime ratio actual lifetime ratio I n t r i n s i c N o i s e Average inferred burst size actual burst size I n t r i n s i c N o i s e Average Average Average Fig . 4 . Intrinsic noise cannot be modeled independently of extrinsic fluctua - tions . ( A ) Numerical results for the normalized intrinsic noise of the the sim - ple birth and death process ( reaction scheme 11 ) with bursts of synthesis . The top - down intrinsic noise as measured by the dual - reporter method ( orange dots ) differs from the fluctuations exhibited by the system in the absence of environmental fluctuations ( black squares ; see formula in legend ) . ( Inset ) Inferred versus the actual value of the burst size . ( B ) Analyzing the mRNA - protein model ( reaction scheme 12 ) . The dual - reporter intrinsic noise measure ( orange dots ) differs from the normalized fluctuations exhibited by the system in the absence of environmental fluctuations ( black squares ; see formula in legend ) . ( Inset ) Inferred time - averaging factor τ m ∕ ð τ p þ τ m Þ when incorrectly interpretingtheintrinsic noise as thefluctuationsexhibited by the system in the absence of environmental fluctuations versus its actual value determined by the respective average mRNA and protein lifetimes τ m and τ p . Note the inferred nonsensical value of a time - averaging factor larger than one . Parameters used : λ ð z Þ ¼ α , β ð z Þ ¼ 10 z , b ¼ 4 and λ 1 ¼ 1 , β 1 ¼ 0 . 5 , λ 2 ð z Þ ¼ α z , β 2 ¼ 1 , where α was varied to generate systems of dif - ferent averages . The extrinsic variable z followed simple Poissonian dynamics ( cf . reaction scheme 11 ) with τ z ¼ 10 and τ z ¼ 1 ∕ 3 , respectively . Hilfinger and Paulsson PNAS ∣ July 19 , 2011 ∣ vol . 108 ∣ no . 29 ∣ 12171 S Y S T E M S B I O L O G Y A PP L I E D M A T H E M A T I C S We have shown that dual - reporter methods facilitate quanti - tative analysis in many ways , without relying on detailed assump - tions about every aspect of the system . However , because many biological processes are nonstationary , have nonlinear rate func - tions , and are subject to multiplicative environmental influences , complementary mathematical approaches are also required . Accounting for fluctuations in single cells may facilitate rather than complicate such analyses , for example , by providing condi - tional independences ( 24 , 25 ) where the unknown mechanisms are accounted for via the fluctuations they create . Such methods will be key for quantitative biology , both because they account for the stochastic mechanisms and because they rigorously deal with complex and poorly characterized networks . Appendix In this appendix we clarify the mathematical definitions and per - spectives introduced in the main text . The proofs of our technical results ( the example environmental state decomposition , the noise decomposition in periodically changing environments , and intrinsic noise models in additive or multiplicative environ - ments ) are detailed in SI Appendix . LawofTotalVariance . By introducing conditional averages the total variance σ 2 X ¼ h x 2 i − h x i 2 can be written as σ 2 X ¼ hh x 2 j Z ii − hh x j Z i 2 i | ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ } h σ 2 X j Z i þ hh x j Z i 2 i − hh x j Z ii 2 | ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ } σ 2 h X j Z i ; where the outer brackets indicate averages over all states of Z . Averaging Over All Possible Histories . For ergodic systems the aver - age over all histories can be written as a time average of the time - dependent ensemble average : hh X t j Z ½ 0 ; t (cid:1)ii Z ½ 0 ; t (cid:1) ¼ lim T → ∞ 1 T Z T 0 lim m → ∞ 1 m ∑ m j ¼ 1 x j ð t Þ | ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ { zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ } ensemble average h X t j Z j½ 0 ; t (cid:1)i dt zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ } | ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ { timeaverage where x j ð t Þ for j ¼ 1 ; 2 ; 3 ; … are different realizations of the repor - ter signal subjected to the same given sample path of the envir - onmental time trace Z ¼ z ð t Þ . Conditional Independence of Dual Reporters . Overall X , Y are not statistically independent , or there would be no covariance to dis - cuss . However , assuming that the dual reporters are independent in a mechanistic sense , i . e . , they do not influence each other in any way ( directly or indirectly through feedbacks to the environ - ment ) , implies that the dual reporters are statistically indepen - dent for a given sample path of the environment . That means for a fixed environmental history Z ½ 0 ; t (cid:1) ¼ z ð t Þ we require that the marginal distribution of X t at time t given an environmental history is not affected by knowing the value of Y t implying that h X t Y t j Z ½ 0 ; t (cid:1)i ¼ h X t j Z ½ 0 ; t (cid:1)ih Y t j Z ½ 0 ; t (cid:1)i . This condition of causal in - dependence is not the same as assuming that h XY j Z ¼ z i is equal to h X j Z ¼ z ih Y j Z ¼ z i , which only holds for static environmental variability but not for dynamically changing environments . Modeling Extrinsic Noise . For systems with fluxes that are linear functions of the intrinsic variables the conditional average given a sample path of the environmental time trace Z ½ 0 ; t (cid:1) ¼ z ð t Þ fol - lows : d h X t j Z ½ 0 ; t (cid:1)i dt ≡ ∑ x ; y x dP ð x ; y j Z ½ 0 ; t (cid:1)Þ dt ¼ ∑ k ∑ x r k ð x ; z ð t ÞÞ s k P ð X t j Z ½ 0 ; t (cid:1)Þ ¼ ∑ k s k h r k ð x ; z ð t ÞÞj Z ½ 0 ; t (cid:1)i ¼ ∑ k s k r k ðh X t j Z ½ 0 ; t (cid:1)i ; z ð t ÞÞ ; because by assumption the rates r k ð x ; z ð t ÞÞ are linear functions of the intrinsic variable x . That means that the extrinsic noise σ 2 ext as given by Eq . 7 corresponds to the variability exhibited by the above deterministic system ( cf . Eq . 10 ) responding to a variable environmental input z ð t Þ . ACKNOWLEDGMENTS . A . H . gratefully acknowledges the German Academic Exchange Service ( DAAD Postdoctoral Fellowship ) and the US National Insti - tutes of Health ( Grant P50GM068763 ) for financial support . J . P . gratefully acknowledges support from the Division of Mathematical Sciences of the National Science Foundation through Grant 0748760 and support from the US National Institutes of Health through Grant GM081563 - 01A . 1 . Raj A , Van Oudenaarden A ( 2008 ) Nature , nurture , or chance : Stochastic gene expres - sion and its consequences . Cell 135 : 216 – 226 . 2 . ToddA , KeithL , FischerC ( 1981 ) Populationecologyofcoyotesduringafluctuationof snowshoe hares . J Wildlife Manage 45 : 629 – 640 . 3 . Crocker JC , et al . ( 2000 ) Two - point microrheology of inhomogeneous soft materials . Phys Rev Lett 85 : 888 – 891 . 4 . Bouchard TJ , Lykken DT , McGue M , Segal NL , Tellegen A ( 1990 ) Sources of human psychological differences : The Minnesota study of twins reared apart . Science 250 : 223 – 228 . 5 . Elowitz MB , Levine AJ , Siggia ED , Swain PS ( 2002 ) Stochastic gene expression in a single cell . Science 297 : 1183 – 1186 . 6 . Raser JM , O ’ Shea EK ( 2004 ) Control of stochasticity in eukaryotic gene expression . Science 304 : 1811 – 1814 . 7 . Maamar H , Raj A , Dubnau D ( 2007 ) Noise in gene expression determines cell fate in Bacillussubtilis . Science 317 : 526 – 529 . 8 . Mao C , et al . ( 2010 ) Quantitative analysis of the transcription control mechanism . Mol Syst Biol 6 : 431 . 9 . SwainPS , ElowitzMB , SiggiaED ( 2002 ) Intrinsicandextrinsiccontributionstostochas - ticity in gene expression . Proc Natl Acad Sci USA 99 : 12795 – 12800 . 10 . Shahrezaei V , Ollivier JF , Swain PS ( 2008 ) Colored extrinsic fluctuations and stochastic gene expression . Mol Syst Biol 4 : 196 . 11 . van Kampen NG ( 1992 ) Stochastic Processes in Physics and Chemistry ( North - Holland , Amsterdam ) , revised and enlarged edition . 12 . Paulsson J ( 2005 ) Models of stochastic gene expression . Phys Life Rev 2 : 157 – 175 . 13 . Rausenberger J , Kollmann M ( 2008 ) Quantifying origins of cell - to - cell variations in gene expression . Biophys J 95 : 4523 – 4528 . 14 . T ă nase - NicolaS , WarrenPB , ReintenWoldeP ( 2006 ) Signaldetection , modularity , and thecorrelationbetweenextrinsicandintrinsicnoiseinbiochemicalnetworks . PhysRev Lett 97 : 068102 . 15 . Huh D , Paulsson J ( 2011 ) Non - genetic heterogeneity from random partitioning at cell division . Nat Genet 43 : 95 – 100 . 16 . Papoulis A ( 1984 ) Probability , Random Variables , and Stochastic Processes ( McGraw Hill , New York ) . 17 . Kaern M , Elston TC , Blake WJ , Collins JJ ( 2005 ) Stochasticity in gene expression : From theories to phenotypes . Nat Rev Genet 6 : 451 – 464 . 18 . Golding I , Paulsson J , Zawilski SM , Cox EC ( 2005 ) Real - time kinetics of gene activity in individual bacteria . Cell 123 : 1025 – 1036 . 19 . Eldar A , Elowitz MB ( 2010 ) Functional roles for noise in genetic circuits . Nature 467 : 167 – 173 . 20 . ZengL , et al . ( 2010 ) Decisionmakingata subcellularlevel determinesthe outcome of bacteriophage infection . Cell 141 : 682 – 691 . 21 . Houchmandzadeh B ( 2005 ) Filtering the noise of embryonic development . J Phys Condens Matter S1245 . 22 . Macarthur BD , Ma ’ ayan A , Lemischka IR ( 2009 ) Systems biology of stem cell fate and cellular reprogramming . Nat Rev Mol Cell Biol 10 : 672 – 681 . 23 . Hanna J , et al . ( 2009 ) Direct cell reprogramming is a stochastic process amenable to acceleration . Nature 462 : 595 – 601 . 24 . Bowsher CG ( 2010 ) Information processing by biochemical networks : A dynamic approach . J Roy Soc Interface 8 : 186 – 200 . 25 . BowsherCG ( 2010 ) Stochastickineticmodels : Dynamicindependence , modularityand graphs . Ann Stat 38 : 2242 – 2281 . 12172 ∣ www . pnas . org / cgi / doi / 10 . 1073 / pnas . 1018832108 Hilfinger and Paulsson Separating Intrinsic from Extrinsic Fluctuations in Dynamic Biological Systems ( Supplementary Information ) Andreas Hilﬁnger and Johan Paulsson Department of Systems Biology , Harvard University 200 Longwood Ave , Boston , MA 02115 , USA Johan Paulsson @ hms . harvard . edu This supplementary material presents the proofs of the mathematical results presented in the main text . Example environmental state decomposition : The discrepancy between a static decomposition ( cf . Eq . 3 of the main text ) and intrinsic and extrinsic noise contributions in dynamical systems is illustrated by the example reaction scheme 4 ( main text ) . Making use of the fact that P ( z ) follows a Poisson distribution satisfying P ( z + 1 ) = P ( z ) × λ z / ( β z ( z + 1 ) ) we can derive the following recurrence relation for (cid:104) x | z (cid:105) = (cid:80) x xP ( x , z ) / P ( z ) from the master equation λ x z = β x (cid:104) x | z (cid:105) − β z z ( (cid:104) x | z − 1 (cid:105) − (cid:104) x | z (cid:105) ) − λ z ( (cid:104) x | z + 1 (cid:105) − (cid:104) x | z (cid:105) ) . Substitution veriﬁes that this equation has a simple solution of the form (cid:104) x | z (cid:105) = A + Bz and we ﬁnd (cid:104) x | z (cid:105) = β x β x + β z (cid:18) λ x λ z β x β x + λ x β x z (cid:19) , which also satisﬁes the additional conditions that determine the solution to a second order recurrence relation : (cid:80) x (cid:104) x | z (cid:105) P ( z ) = (cid:104) x (cid:105) and (cid:104) x | 0 (cid:105) = (cid:104) x | 1 (cid:105) λ z / ( λ z + β x ) ( from evaluating the master equation at the z = 0 edge ) . Averaging over the extrinsic distribution then leads to (cid:104)(cid:104) x | Z (cid:105) 2 (cid:105) ≡ (cid:88) z (cid:104) x | z (cid:105) 2 P ( z ) = (cid:104) x (cid:105) 2 (cid:18) 1 + 1 (cid:104) z (cid:105) τ z τ x + τ z (cid:19) , and the result of Eq . 6 ( main text ) for (cid:104) σ 2 X | Z (cid:105) = (cid:104)(cid:104) x | Z (cid:105) 2 (cid:105) − (cid:104)(cid:104) x | Z (cid:105)(cid:105) 2 follows . Periodically changing environments : Introducing conditional averages for a given environmental time trace Z [ 0 , t ∗ ] that ends at a speciﬁc phase t ∗ , and then averaging over all phases t ∗ allows us to re - write the conditional averages in Eq . 9 ( main text ) : (cid:104)(cid:104) X t | Z [ 0 , t ] (cid:105)(cid:105) Z [ 0 , t ] = (cid:104)(cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) Z [ 0 , t ∗ ] (cid:105) t ∗ where the subscripts denote the variable we average over . Using those conditional averages and making use of (cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) Z [ 0 , t ∗ ] = (cid:104) X t | t ∗ (cid:105) we can apply the law of total variance to the extrinsic noise σ 2ext = (cid:104)(cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105) 2 (cid:105) Z [ 0 , t ∗ ] − (cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) 2 Z [ 0 , t ∗ ] (cid:124) (cid:123)(cid:122) (cid:125) σ 2 ext ( t ∗ ) (cid:105) t ∗ + (cid:104)(cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) 2 Z [ 0 , t ∗ ] (cid:105) t ∗ − (cid:104)(cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) Z [ 0 , t ∗ ] (cid:105) 2 t ∗ (cid:124) (cid:123)(cid:122) (cid:125) σ 2 (cid:104) Xt ∗ | t ∗(cid:105) , 1 and the result of Eq . 9 ( main text ) follows . Because the two reporters are independent when conditioned on an environmental history Z [ 0 , t ∗ ] we furthermore have σ 2 ext ( t ∗ ) = (cid:104)(cid:104) X t Y t | Z [ 0 , t ∗ ] (cid:105)(cid:105) Z [ 0 , t ∗ ] − (cid:104)(cid:104) X t | Z [ 0 , t ∗ ] (cid:105)(cid:105) 2 Z [ 0 , t ∗ ] = (cid:104) X t Y t | t ∗ (cid:105) − (cid:104) X t | t ∗ (cid:105)(cid:104) Y t | t ∗ (cid:105) (cid:124) (cid:123)(cid:122) (cid:125) Cov sync ( x , y ; t ∗ ) . Modeling intrinsic noise – additive environments : By considering (cid:80) x , y x 2 d P / d t we ﬁnd that for intrinsically linear systems the time evolution of the condi - tional covariance matrix C ij ≡ (cid:104) X i , t X j , t | Z [ 0 , t ] (cid:105) − (cid:104) X i , t | Z [ 0 , t ] (cid:105)(cid:104) X j , t | Z [ 0 , t ] (cid:105) follows d C d t = JC + ( JC ) T + B , with Jacobian J ij = (cid:80) k s ki d r k / d x j and diffusion matrix B ij = (cid:80) k r k ( (cid:104) X t | Z [ 0 , t ] (cid:105) , z ( t ) ) s ki s kj . For sys - tems subject to additive environmental inﬂuences the Jacobian matrix is constant , which means that by taking time averages we obtain an equation for the covariance matrix : 0 = J (cid:104) C (cid:105) + ( J (cid:104) C (cid:105) ) T + (cid:104) B (cid:105) . Replacing the ﬂuctuating rate constants of the original system with their averages leads to a system with a constant diffusion matrix given by (cid:104) B (cid:105) while leaving the Jacobian unchanged . Its covariance matrix therefore satisﬁes the same equation as C . Thus the intrinsic noise σ 2int ≡ (cid:104) C nn (cid:105) can indeed be mod - eled by replacing ﬂuctuating rates with their averages and thereby eliminating the extrinsic variability from systems linear in intrinsic variables and subject to additive environmental noise . Modeling intrinsic noise – multiplicative environments : For the system described in reaction scheme 11 ( main text ) the conditional average and the conditional variance follow d (cid:104) X t | Z [ 0 , t ] (cid:105) d t = λ ( z ( t ) ) − β ( z ( t ) ) (cid:104) X t | Z [ 0 , t ] (cid:105) d σ 2 X t | Z [ 0 , t ] d t = λ ( z ( t ) ) + β ( z ( t ) ) (cid:104) X t | Z [ 0 , t ] (cid:105) − 2 β ( z ( t ) ) σ 2 X t | Z [ 0 , t ] . Substituting the ansatz f ( t ) = σ 2 X t | Z [ 0 , t ] − (cid:104) X t | Z [ 0 , t ] (cid:105) we obtain d f / d t = − 2 β ( z ( t ) ) f and therefore f ( t ) ∼ exp [ − 2 (cid:82) β ( z ( t ) ) d t ] which tends to zero as t → ∞ . Hence the time averages satisfy (cid:104) σ 2 X t | Z [ 0 , t ] (cid:105) = (cid:104)(cid:104) X t | Z [ 0 , t ] (cid:105)(cid:105) . Replacing β ( z ) with the constant (cid:104) β ( z ) x (cid:105) / (cid:104) x (cid:105) and replacing λ ( z ) with (cid:104) λ ( z ) (cid:105) removes the effect of environmental variability while preserving the system average . This process thus eliminates the inﬂuence of environmental variability while leading to a system whose ﬂuctuations model the intrinsic noise . 2
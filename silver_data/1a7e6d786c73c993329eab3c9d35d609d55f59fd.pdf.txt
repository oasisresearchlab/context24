A Kermack - McKendrick model with age of infection starting from a single or multiple cohorts of infected patients Jacques Demongeot ( a ) , Quentin Griette ( b ) , ∗ , Yvon Maday ( c ) , and Pierre Magal ( b ) , † ( a ) Université Grenoble Alpes , AGEIS EA7407 , F - 38700 La Tronche , France ( b ) Univ . Bordeaux , IMB , UMR 5251 , F - 33400 Talence , France . CNRS , IMB , UMR 5251 , F - 33400 Talence , France . ( c ) Sorbonne Université and Université de Paris , CNRS , Laboratoire Jacques - Louis Lions ( LJLL ) , F - 75005 Paris , France Institut Universitaire de France , 75005 Paris , France June 6 , 2022 Abstract During an epidemic , the infectiousness of infected individuals is known to depend on the time since the individual was infected , that is called the age of infection . Here we study the parameter identiﬁability of the Kermack - McKendrick model with age of infection which takes into account this dependency . By considering a single cohort of individuals , we show that the daily reproduction number can be obtained by solving a Volterra integral equation that depends on the ﬂow of new infected individuals . We test the consistency our the method by generating data from deterministic and stochastic numerical simulations . Finally we apply our method to a dataset from SARS - CoV - 1 with detailed information on a single cluster of patients . We stress the necessity of taking into account the initial data in the analysis to ensure the identiﬁability of the problem . Keywords : Age of infection ; epidemic model ; single and multiple cohorts ; cluster of infected patients ; daily repro - duction number ; Volterra equation ; parameter identiﬁcation . 1 Introduction The existence of an individual infection ( or contagiousness ) period of variable length among infected individuals and during the history of an epidemic is a proven fact in all contagious diseases . The origin of this variability is multiple . It may be due to ( i ) a variation in the symptomatic state of the infected person ( such as the change in frequency and intensity of the cough , source of emission of the infectious agent ) due to variable immune defenses since the beginning of his infection ( e . g . , due to the transition between initial innate immune reaction and secondary adaptive reaction ) ; ( ii ) a variation in the environmental conditions of transport and survival of the infectious agent in the atmosphere ( heat , humidity , sunshine , altitude , etc . ) , in a more or less favorable socio - sanitary environment presenting diﬀerent spreading characteristics ( as compliance with distancing or conﬁnement , existence of preventive vitamin supplementation , educational level , food quality , demographic isolate , etc . ) ; ( iii ) a variation in the state of defense of the ﬁnal host ( immune defense and self - protection ) ; ∗ Q . G . acknowledges support from ANR via the project Indyana under grant agreement ANR - 21 - CE40 - 0008 . † Corresponding author . e - mail : pierre . magal @ u - bordeaux . fr 1 a r X i v : 2205 . 15634v2 [ m a t h . A P ] 3 J un 2022 ( iv ) a variation in the virulence of the infectious agent , which can mutate or possibly change of intermediary host . Due to the complexity of the contagion mechanisms and of their variations , accentuated by the fact that the rate of the epidemic may be the result of several geographically distant clusters starting at diﬀerent times , it is preferable , in a ﬁrst approach , to assume that the initial conditions are reduced to a single cluster . The challenge is then to estimate , on each day of the infection period , the transmissibility rate allowing the calculation of the daily reproduction number of the contagious disease . Continuous time model : Recall that the age of infection a is the time since individuals become infected . The major diﬃculty in comparing the data and the Kermack - McKendrick model with age of infection is to identify : 1 ) the initial distribution of infected with respect to the age of infection ; 2 ) the daily reproduction number R 0 ( a ) which is the reproduction number at the age of infection a ( i . e . the average number of secondary cases produced by a single infected at the age of infection a ) . We can decompose the daily reproduction number as follows R 0 ( a ) = τ 0 (cid:124)(cid:123)(cid:122)(cid:125) ( A ) × S 0 (cid:124)(cid:123)(cid:122)(cid:125) ( B ) × β ( a ) (cid:124)(cid:123)(cid:122)(cid:125) ( C ) × e − νa (cid:124)(cid:123)(cid:122)(cid:125) ( D ) , where ( A ) is the rate of transmission rate at time t 0 ( we assume the transmission rate to be constant during the period where R 0 ( a ) is evaluated ) , ( B ) is the number of susceptible individuals at time t 0 ( we assume the number of susceptibles to be constant during the period where R 0 ( a ) is evaluated ) , ( C ) is the probability that an infected who have been for a days is infectious i . e . , capable to transmit the pathogen ( or the fraction of infectious among the infected with age of infection a ) , ( D ) the probability for an infected for a days to be still infected . Then the basic reproduction number ( i . e . the number of secondary cases produced by a single infected ) is given by R 0 = (cid:90) ∞ 0 R 0 ( a ) da . Here we partly solve the problem of ﬁnding the initial distribution of infected by assuming that we start the epidemic at time t 0 with a single cohort of I 0 new infected patients . That is , the epidemic starts with I 0 infected patients all with age of infection a = 0 . The case of an epidemic starting from a single infected patient ( usually called the patient 0 ) corresponds to the case I 0 = 1 . This is a common assumption in epidemiology . Note that the time t 0 at which the ﬁrst patient becomes infected is also unknown for most epidemics . Assume that the epidemic starts at time t 0 with a cohort of I 0 new infected patients ( i . e . , all with age of infection a = 0 ) . Then N ( t ) the ﬂow of infected at time t satisﬁes the model starting from a single cohort of infected N ( t ) = R 0 ( t − t 0 ) × I 0 (cid:124) (cid:123)(cid:122) (cid:125) ( I ) + (cid:90) t − t 0 0 R 0 ( s ) × N ( t − s ) ds (cid:124) (cid:123)(cid:122) (cid:125) ( II ) , ∀ t ≥ t 0 , ( 1 . 1 ) where ( I ) is the ﬂow of infected produced directly by the I 0 infected individuals already present on day t 0 ; and ( II ) is the ﬂow of new infected individuals at time t produced by the new infected individuals since day t 0 . Here what we call “ﬂow of new infected individuals” is the distribution N ( t ) such that (cid:90) t 2 t 1 N ( σ ) dσ , is the number of new infected individuals during the period of time [ t 1 , t 2 ] . The equation ( 1 . 1 ) will be derived as an extension of the Kermac - McKendrick model starting from a single cohort of infected ( see equation ( 4 . 5 ) ) . This model remains valid as long as the transmission rate τ ( t ) and the number of susceptible hosts S ( t ) remain constant . So this model is valid when the epidemic starts . Assume that I 0 is ﬁxed and the function a → R 0 ( a ) is given . Then the map t → N ( t ) can be obtained by solving ( 1 . 1 ) . The goal of the article is consider the converse problem . That is , assume that I 0 is ﬁxed and assume 2 that t → N ( t ) is given from the data . Then the map a → R 0 ( a ) can be obtained by solving the Volterra integral equation R 0 ( a ) = N ( a + t 0 ) I 0 − 1 I 0 (cid:90) a 0 R 0 ( s ) N ( a − s + t 0 ) ds , ∀ a ≥ 0 . ( 1 . 2 ) Therefore if the map t → N ( t ) is known , we can theoretically derive the average dynamics of infection at the level of a single patient . The standard assumption used in the literature is R 0 ( a ) = 0 , ∀ a ≥ a + , ( 1 . 3 ) where a + > 0 the maximal age of infectiousness for an infected patient . Then for t ≥ t 0 + a + , the equation ( 1 . 1 ) becomes N ( t ) = (cid:90) a + 0 R 0 ( s ) × N ( t − s ) ds . ( 1 . 4 ) Now assume for example that N ( t ) = N 0 e λt , we obtain after simpliﬁcations a standard characteristic equation 1 = (cid:90) a + 0 R 0 ( s ) × e − λs ds . ( 1 . 5 ) Assume that λ > 0 is given . Consider a → χ ( a ) any non - negative and non - null continuous function satisfying χ ( a ) = 0 , ∀ a ≥ a + . Then R 0 ( a ) = χ ( a ) (cid:82) a + 0 χ ( s ) × e − λs ds satisﬁes ( 1 . 5 ) . Therefore , neglecting the initial value in the Volterra equation leads to a non - identiﬁable problem ( in general ) . This shows the crucial role of the initial value in identifying the function a → R 0 ( a ) . Day by day model : The model ( 1 . 1 ) with a single cohort of infected becomes a discrete Volterra equation N ( t ) = R 0 ( t − t 0 ) × I 0 (cid:124) (cid:123)(cid:122) (cid:125) ( I ) + t − t 0 (cid:88) d = 1 R 0 ( d ) × N ( t − d ) (cid:124) (cid:123)(cid:122) (cid:125) ( II ) , ∀ t ≥ t 0 , ( 1 . 6 ) where ( I ) is the number of infected produced directly by the I 0 infected individuals already present on day t 0 ; and ( II ) is the number of new infected individuals at time t produced by the new infected individuals since day t 0 . Next , by setting a = t − t 0 , we obtain the day by day equation for the daily reproduction number R 0 ( a ) = N ( t 0 + a ) I 0 − 1 I 0 a (cid:88) d = 1 R 0 ( d ) × N ( t 0 + a − d ) , ∀ a ≥ 0 . ( 1 . 7 ) In the above formula and throughout the paper , we use the following convention for the sum m (cid:88) d = k = 0 , whenever m < k . If we consider the ﬁrst terms of the discrete time Volterra equation ( 1 . 6 ) , we obtain 3 N ( t 0 ) = R 0 ( 0 ) × I 0 , N ( t 0 + 1 ) = R 0 ( 1 ) × I 0 + R 0 ( 1 ) × N ( t 0 ) , N ( t 0 + 2 ) = R 0 ( 2 ) × I 0 + R 0 ( 2 ) × N ( t 0 ) + R 0 ( 1 ) × N ( t 0 + 1 ) , N ( t 0 + 3 ) = R 0 ( 3 ) × I 0 + R 0 ( 3 ) × N ( t 0 ) + R 0 ( 2 ) × N ( t 0 + 1 ) + R 0 ( 1 ) × N 0 ( t 0 + 2 ) , . . . In practice , we can assume that R 0 ( 0 ) = 0 since infected individuals are not infectious immediately after being infected . Under this additional assumption , we obtain the system N ( t 0 ) = 0 , N ( t 0 + 1 ) = R 0 ( 1 ) × I 0 , N ( t 0 + 2 ) = R 0 ( 2 ) × I 0 + R 0 ( 1 ) × N ( t 0 + 1 ) , N ( t 0 + 3 ) = R 0 ( 3 ) × I 0 + R 0 ( 2 ) × N ( t 0 + 1 ) + R 0 ( 1 ) × N 0 ( t 0 + 2 ) , . . . When reliable information is available on the ﬁrst cluster ( s ) , the best formula for calculating daily basic repro - duction numbers is equation ( 1 . 2 ) ( or its the discrete time version ( 1 . 7 ) ) . Based on ( 1 . 4 ) , some methods have been developed in the literature to cope with the lack of a precise information . For instance in [ 2 , 3 ] , the authors following [ 27 ] propose an optimization algorithm for estimating the daily basic reproduction numbers . In [ 4 ] , D . Bernoulli mentions in 1760 the changes in the contagiousness parameters and places as a crucial challenge for the prediction of the transition between endemic and epidemic peaks in a prophetic sentence : “Le retour d’une épidémie longtemps suspendue fait un ravage plus terrible dans une seule année qu’une endémie uniforme ne pourrait faire pendant un nombre d’années considérable” ( The return of a long - suspended epidemic wreaks more terrible havoc in a single year than a uniform endemic could do for a considerable number of years ) . In [ 10 ] , the authors use a deconvolution algorithm for calculating the daily basic reproduction numbers . In each case , the problem of the initial conditions is evoked at best only through the hypothesis of a unique “patient zero” . Despite the considerable means of current investigation , in particular those of the WHO and the members of the government of the WHO , it is rare that this patient is identiﬁed ( this was the case for H1N1 in Mexico ) . The patient zero , also called index or primary case is the ﬁrst patient identiﬁed in a given population during an epidemiological investigation . It points out the source of the spread of a disease in a given reservoir , but this search is in general very diﬃcult as it was the case for HIV in North America [ 32 ] . One of the main diﬃculties in estimating the R 0 ( a ) function is its non - identiﬁability in general . Recent studies [ 8 , 9 , 16 , 17 , 25 ] developed methods to identify the various parameters for the COVID - 19 pandemic by using cumulative reported cases data and diﬀerential equations models . Diﬀerential equations can be written in the form studied here by assuming that R 0 ( a ) ( or equivalently , β ( a ) ) is independent of a . Suppose that we are restricted to a period when the data is growing exponentially fast . If we take a ﬁxed function β ( a ) , then by adapting the method developed in [ 25 ] , we could identify a transmission rate τ so that the output of the model stays very close to the data , for any function β ( a ) . The same could be achieved with a good phenomenological description of the data by using the method developed in [ 8 , 16 , 17 ] with a time - dependent transmission rate . This means that the reported cases data is not suﬃcient to determine accurately the function R 0 ( a ) . Without a good description of the initial distribution , it is hopeless to identify R 0 ( a ) by using reported cases only . In this article , we ﬁrst extend the Kermack - McKendrick model to initial conditions that are a linear combination of Dirac masses . The PDE model ( 2 . 1 ) can not be extended in the space of measures ( due to a lack of time continuity for the solutions ) . However , the Volterra integral equation can be extended and still makes perfect sense whenever we use Dirac masses for the initial condition . In many real examples , the initial distribution must be a linear combination of Dirac masses since the data are discrete at the early stage of an epidemic ( in a city , a country ) . Indeed , at the early beginning of an epidemic , the epidemic starts from a few cases imported from other places . Therefore Dirac masses make perfect sense . In practice , the early stage of an outbreak is often undocumented and 4 generally diﬃcult to determine . But our study applies to data from a ﬁnite collection of clusters that is easier to determine using contact tracing . Consequently , for the single cohort model , we can reverse the problem , and by assuming that the daily number of new infected is known , we can compute the daily reproduction number by solving a Volterra integral equation . The daily basic reproduction number informs us about the dynamics of infection at the level of a single patient . Therefore , knowing R 0 ( a ) should help the medical doctors decide about quarantine measures . Reported case data for clusters are particularly valuable for reconstructing the dynamics of infection at the level of a single individual . In this paper , we also provide an Individual - Based Model ( IBM ) ( see Appendix B ) . This IBM converges to the deterministic model whenever the initial number of infected increases . We use this IBM to generate sample data to test our method and compute the daily basic reproduction number . This will allow us to test the eﬀects of the day - to - day discretization ( on the data ) and the impact of stochastic perturbations on the daily reproduction number . We conclude the paper by applying our approach to a cluster of SARS - CoV - 1 in Singapore . The plan of the paper is the following . In Section 2 , we recall the Kermack - McKendrick model with age of infection . We explain how to derive the Volterra formulation of the model , and we compare it with the Kermack - McKendrick SI model with age of infection ( ODE model ) . In Section 3 , we explain how to connect the model with the data . In Section 4 , we extend the Kermack - McKendrick model with age of infection in the case where the epidemic starts from a single or multiple cohorts of infected individuals . In Section 5 we derive an equation to compute the daily reproduction number from the data . In Section 6 we consider a day by day discretized Kermack - McKendrick model with age of infection . In Section 7 , we run some numerical simulations , we compare the deterministic model with a stochastic individual based simulation presented in appendix . In Section 8 , we compare the model with some data from SARS - CoV - 1 , and we discuss the data from SARS - CoV - 2 . 2 Kermack - McKendrick model with age of infection 2 . 1 Partial diﬀerential equation formulation of the model The age of infection a is the time since individuals become infected . Let a → i ( t , a ) be the distribution of population of infected individuals at time t ( with respect to a the age of infection ) . The term distribution of population means that the integral (cid:90) a 2 a 1 i ( t , a ) da is the number of infected at time t with infection age between a 1 and a 2 . Therefore the total number of infected individuals at time t is I ( t ) = (cid:90) + ∞ 0 i ( t , a ) da . Let β ( a ) ∈ [ 0 , 1 ] be the probability to be contagious or infectious ( i . e . capable to transmit the pathogen ) at the age of infection a . The quantity β ( a ) can be interpreted as the fraction of infected individuals with age of infection a that are infectious . Then the total number of contagious individuals ( or also called infectious individuals ) ( i . e . , the individuals capable of transmitting the pathogen ) at time t is C ( t ) = (cid:90) + ∞ 0 β ( a ) i ( t , a ) da . The model of Kermack - McKendrick [ 22 ] with age of infection is the following , for each t ≥ t 0    S (cid:48) ( t ) = − τ ( t ) S ( t ) (cid:90) + ∞ 0 β ( a ) i ( t , a ) da , ∂ t i + ∂ a i = − ν i ( t , a ) , for a ≥ 0 , i ( t , 0 ) = τ ( t ) S ( t ) (cid:90) + ∞ 0 β ( a ) i ( t , a ) da , ( 2 . 1 ) 5 this system is supplemented by initial data S ( t 0 ) = S 0 ≥ 0 , and i ( t 0 , a ) = i 0 ( a ) ∈ L 1 + ( 0 , ∞ ) . ( 2 . 2 ) In the model , S ( t ) is the number of susceptible individuals at time t , and t → τ ( t ) is the transmission rate at time t , and ν ≥ 0 is the rate at which individuals die or recover . Here , the parameter ν is assumed to be independent of the age of infection a . This is a simplifying assumption to improve the readability of the paper . The parameter ν combines both the speciﬁc fatality rate and the recovery rate . The above equation can be understood ﬁrst as follows I (cid:48) ( t ) = τ ( t ) S ( t ) (cid:90) + ∞ 0 β ( a ) i ( t , a ) da (cid:124) (cid:123)(cid:122) (cid:125) ( I ) − (cid:90) + ∞ 0 ν i ( t , a ) da (cid:124) (cid:123)(cid:122) (cid:125) ( II ) , where ( I ) is the ﬂow of new infected , and ( II ) is the ﬂow of individuals who die or recover . We make the following assumption . Assumption 2 . 1 . We assume that ( i ) The transmission rate t → τ ( t ) is a bounded continuous map from [ t 0 , + ∞ ) in [ 0 , + ∞ ) ; ( ii ) The probability to be infectious at the age of infection a → β ( a ) ∈ L ∞ + ( 0 , + ∞ ) is a non - negative and measurable function of a which is bounded by 1 ; 2 . 2 Volterra integral equation formulation of the model In the model ( 2 . 1 ) , the quantity N ( t ) : = τ ( t ) S ( t ) (cid:90) + ∞ 0 β ( a ) i ( t , a ) da , ( 2 . 3 ) is the ﬂow of new infected individuals at time t . By using the S - equation in system ( 2 . 1 ) , we obtain S ( t ) = S 0 − (cid:90) t t 0 N ( σ ) dσ , ∀ t ≥ t 0 . ( 2 . 4 ) By integrating the i - equation of system ( 2 . 1 ) along the characteristics , we obtain i ( t , a ) = (cid:40) e − ν ( t − t 0 ) i 0 ( a − ( t − t 0 ) ) , if a ≥ t − t 0 , e − ν a N ( t − a ) , if t − t 0 ≥ a . ( 2 . 5 ) By using ( 2 . 5 ) , we deduce that t → N ( t ) satisﬁes the following Volterra integral equation N ( t ) = τ ( t ) S ( t ) (cid:90) + ∞ t − t 0 β ( a ) e − ν ( t − t 0 ) i 0 ( a − ( t − t 0 ) ) da (cid:124) (cid:123)(cid:122) (cid:125) ( I ) + τ ( t ) S ( t ) (cid:90) t − t 0 0 β ( a ) e − ν a N ( t − a ) da (cid:124) (cid:123)(cid:122) (cid:125) ( II ) ( 2 . 6 ) where ( I ) is the ﬂow of new infected individuals at time t produced by the infected individuals already present on day t 0 ; ( II ) is the ﬂow of new infected individuals at time t produced by the new infected individuals since day t 0 . 6 By using equations ( 2 . 4 ) and ( 2 . 6 ) , we can summarize the epidemic model ( 2 . 1 ) , by saying that t → N ( t ) is the unique continuous map satisfying N ( t ) = τ ( t ) S ( t ) (cid:20) Λ ( t ) + (cid:90) t − t 0 0 β ( a ) e − ν a N ( t − a ) da (cid:21) , ∀ t ≥ t 0 , ( 2 . 7 ) where S ( t ) = S 0 − (cid:90) t t 0 N ( σ ) dσ , ∀ t ≥ t 0 , ( 2 . 8 ) and Λ ( t ) : = e − ν ( t − t 0 ) (cid:90) + ∞ t − t 0 β ( a ) i 0 ( a − ( t − t 0 ) ) da , ∀ t ≥ t 0 . ( 2 . 9 ) The function Λ ( t ) is the number of infectious individuals ( capable to transmit the pathogen ) at time t among the infected individuals already present at time t 0 . The function t → Λ ( t ) plays a fundamental role in solving the Volterra equation . Indeed , the quantity (cid:90) t 2 t 1 τ ( σ ) S ( σ ) Λ ( σ ) dσ , is the number of infected produced between the instants t 1 and t 2 by the infected already present at time t 0 . So , for example , if no new infected are produced by the infected already present at time t 0 , that is if Λ ( t ) = 0 , ∀ t ≥ t 0 , then there will be no new infected at all after the time t 0 , that is N ( t ) = 0 , ∀ t ≥ t 0 . The function t → Λ ( t ) can be regarded as the initial distribution of the Volterra integral equation ( 2 . 7 ) . 3 Connecting the data and the model The data are represented by the function t → CR ( t ) which is the cumulative number of reported cases at time t . We assume that the ﬂow of reported cases is a fraction 0 ≤ f ≤ 1 of the ﬂow of recovering individuals , that is CR (cid:48) ( t ) = f ν (cid:90) + ∞ 0 i ( t , a ) da . ( 3 . 1 ) By using ( 2 . 5 ) , we can compute the number of infected at time t . That is (cid:90) + ∞ 0 i ( t , a ) da = e − ν ( t − t 0 ) I 0 + (cid:90) t − t 0 0 e − ν a N ( t − a ) da , ( 3 . 2 ) where I 0 = (cid:90) + ∞ 0 i 0 ( a ) da is the total number of infected at time t 0 . By using equations ( 3 . 1 ) and ( 3 . 2 ) , we obtain CR (cid:48) ( t ) = νf (cid:20) e − ν ( t − t 0 ) I 0 + (cid:90) t − t 0 0 e − ν a N ( t − a ) da (cid:21) , 7 or equivalently ( by using the change of variable σ = t − a ) CR (cid:48) ( t ) = νf (cid:20) e − ν ( t − t 0 ) I 0 + (cid:90) t t 0 e − ν ( t − σ ) N ( σ ) dσ (cid:21) . By choosing t = t 0 we obtain I 0 = CR (cid:48) ( t 0 ) νf , and (cid:90) t t 0 e νσ N ( σ ) dσ = e ν t CR (cid:48) ( t ) νf − e ν t 0 I 0 , and by diﬀerentiating both sides of the above equation , we obtain e νt N ( t ) = νe ν t CR (cid:48) ( t ) + e ν t CR (cid:48)(cid:48) ( t ) νf . Therefore we obtain the following connection between the data and the model . Connection between the data and the model Let t → CR ( t ) be the cumulative number of reported cases . Then the initial number of infected is given by I 0 = CR (cid:48) ( t 0 ) νf , ( 3 . 3 ) and the ﬂow of new infected individuals N ( t ) at time t is given by N ( t ) = ν CR (cid:48) ( t ) + CR (cid:48)(cid:48) ( t ) νf , ∀ t ≥ t 0 . ( 3 . 4 ) 4 Kermack - McKendrick model starting from a single and multiple co - horts of infected patients The major diﬃculty to compare the model ( 2 . 4 ) with the data is to identify the functions a → i 0 ( a ) and a → β ( a ) . To simplify the discussion , let us consider the model at the early stage of the epidemic . When the epidemic just starts we can assume that the transmission rate t → τ ( t ) remains constant , and the number of susceptible individuals t → S ( t ) is constant and equal to S 0 . Under such a simplifying assumption the Volterra equation ( 2 . 4 ) becomes N ( t ) = τ S 0 (cid:20) Λ ( t ) + (cid:90) t − t 0 0 β ( a ) e − ν a N ( t − a ) da (cid:21) , ∀ t ≥ t 0 . ( 4 . 1 ) 4 . 1 Initial distribution for a single cohort of infected with age of infection a = 0 In order to understand the mathematical concept of Dirac mass centered at 0 , we ﬁrst consider an approximation by an exponential law i 0 ( a ) = I 0 κ e − κa , mean and standard deviation equal to 1 / κ . Then a Dirac mass centered at 0 can be understood as the limit of such a distribution when κ goes to + ∞ . The limit of needs some explanations . Recall that (cid:90) a 2 a 1 i 0 ( a ) da = I 0 (cid:2) e − κa 1 − e − κa 2 (cid:3) , 8 is the initial number of infected individuals with infection age a in between a 1 and a 2 at time t = 0 . We deduce that lim κ →∞ (cid:90) a 2 a 1 i 0 ( a ) da = (cid:26) 0 , if a 2 > a 1 > 0 , I 0 , if a 2 > a 1 = 0 . That is to say that , when κ tends to + ∞ , the initial distribution of population i 0 ( a ) is approaching the case where all the infected individuals at time t 0 have the same age of infection a = 0 . For short , we write i 0 ( a ) = I 0 δ 0 ( a ) , where δ 0 ( a ) is called the Dirac mass centered at 0 . 4 . 2 Model starting from a single cohort of infected with age of infection a = 0 Recall that Λ ( t ) = e − ν ( t − t 0 ) (cid:90) + ∞ 0 β ( a + ( t − t 0 ) ) i 0 ( a ) da , so when i 0 ( a ) is replaced by I 0 × κ × e − κa we obtain f κ ( t ) : = I 0 e − ν ( t − t 0 ) (cid:90) + ∞ 0 β ( a + ( t − t 0 ) ) × κ × e − κa da . In order to derive the Kermack - McKendrick model with Dirac mass initial distribution as limit , we ﬁrst need the following result . Lemma 4 . 1 . Let Assumption 2 . 1 be satisﬁed , and assume in addition that a → β ( a ) is continuous . Then we have lim κ →∞ f κ ( t ) = I 0 e − ν ( t − t 0 ) β ( t − t 0 ) , where the limit is uniform in t ≥ t 0 . That is lim κ → + ∞ sup t ≥ t 0 | f κ ( t ) − I 0 e − ν ( t − t 0 ) β ( t − t 0 ) | = 0 . Proof . Let ε > 0 . We observe that f κ ( t ) − I 0 e − ν ( t − t 0 ) β ( t − t 0 ) = I 0 e − ν ( t − t 0 ) (cid:90) + ∞ 0 [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da , = I 0 e − ν ( t − t 0 ) (cid:90) η 0 [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da , + I 0 e − ν ( t − t 0 ) (cid:90) + ∞ η [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da . Let t 1 > t 0 be such that I 0 e − ν ( t − t 0 ) sup a ≥ 0 β ( a ) ≤ ε 4 , ∀ t ≥ t 1 . Let η > 0 be such that a ≤ η ⇒ | β ( a + t ) − β ( t ) | ≤ ε 2 , ∀ t ∈ [ t 0 , t 1 ] . Then we have | I 0 e − ν ( t − t 0 ) (cid:90) η 0 [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da | ≤   I 0 e − ν ( t − t 0 ) 2 sup a ≥ 0 β ( a ) , if t ≥ t 1 , I 0 e − ν ( t − t 0 ) (cid:82) η 0 ε 2 κ e − κa da if t ∈ [ t 0 , t 1 ] , 9 therefore | f κ ( t ) − I 0 e − ν ( t − t 0 ) β ( t − t 0 ) | ≤ ε 2 + | I 0 e − ν ( t − t 0 ) (cid:90) + ∞ η [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da | . The result from the fact that | I 0 e − ν ( t − t 0 ) (cid:90) + ∞ η [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da | ≤ 2 I 0 sup a ≥ 0 β ( a ) (cid:90) + ∞ η κ e − κa da hence | I 0 e − ν ( t − t 0 ) (cid:90) + ∞ η [ β ( a + ( t − t 0 ) ) − β ( t − t 0 ) ] κ e − κa da | ≤ 2 I 0 sup a ≥ 0 β ( a ) e − κη → 0 , as κ → ∞ . Deﬁne Γ ( a ) = e − ν a β ( a ) , ∀ a ≥ 0 . ( 4 . 2 ) Then by using ( 2 . 6 ) , the Kermack - McKendrick model can be reformulated for t ≥ t 0 , as the following system N κ ( t ) = τ ( t ) S κ ( t ) (cid:20) f κ ( t ) + (cid:90) t − t 0 0 Γ ( a ) N κ ( t − a ) da (cid:21) , where f κ ( t ) is deﬁned in ( 4 . 2 ) , and S κ ( t ) = S 0 − (cid:90) t t 0 N κ ( σ ) dσ . By taking ﬁrst a formal limit when κ → + ∞ , we obtain the model starting from a single cohort of infected . Kermack - McKendrick model starting from a single cohort of infected Assume that the initial distribution of infected only contains a single cohort composed of I 0 individuals all with age of infection a = 0 at time t 0 . Then the ﬂow of new infected t → N ( t ) is the unique continuous solution of the Volterra integral equation N ( t ) = τ ( t ) S ( t ) (cid:20) I 0 × Γ ( t − t 0 ) + (cid:90) t − t 0 0 Γ ( a ) N ( t − a ) da (cid:21) , ∀ t ≥ t 0 , ( 4 . 3 ) where S ( t ) is obtained from ( 2 . 4 ) . The following theorem says that the model with a single cohort of infected extends the earlier model of Kermack - McKendrick with initial distribution in L 1 . This theorem is a consequence of Lemma 4 . 1 and the continuity of the semiﬂow generated by the Volterra integral equation . We refer to Ducrot and Magal [ 14 ] for more results on this topic . Theorem 4 . 2 . Let Assumption 2 . 1 be satisﬁed , and assume in addition that a → β ( a ) is continuous . Then lim κ →∞ N κ ( t ) = N ( t ) , where the limit is uniform in t on every closed and bounded interval of [ t 0 , + ∞ ) , and the map t → N ( t ) is the unique continuous solution of the Volterra integral equation ( 4 . 3 ) - ( 4 . 1 ) . Remark 4 . 3 . When the initial distribution is a Dirac mass centered at a = 0 , the total number of infected individuals at time t is C ( t ) = e − ν ( t − t 0 ) I 0 + (cid:90) t − t 0 0 e − ν a N ( t − a ) da , ∀ t ≥ t 0 , and the number of infectious individuals at time t is I ( t ) = β ( t − t 0 ) e − ν ( t − t 0 ) I 0 + (cid:90) t − t 0 0 β ( a ) e − ν a N ( t − a ) da , ∀ t ≥ t 0 . 10 Kermack - McKendrick model starting from multiple cohorts of infected Assume that the initial distribution of infected consists in n ≥ 1 cohorts of infected with age of infection a 1 < a 2 < . . . < a n at time t 0 . That is i 0 ( a ) = I 10 δ a 1 ( a ) + . . . + I n 0 δ a n ( a ) . where I j 0 is the number of infected in the j th - cohort at time t 0 . Then the ﬂow of infected t → N ( t ) satisﬁes the following Volterra integral equation N ( t ) = τ ( t ) S ( t )   n (cid:88) j = 1 Γ ( t − t 0 + a j ) I j 0 e − νa j + (cid:90) t − t 0 0 Γ ( a ) N ( t − a ) da   , where S ( t ) is obtained from ( 2 . 4 ) . 4 . 3 Basic reproduction number for the extended model ( 4 . 3 ) In this section , we assume that the transmission t → τ ( t ) is constant equal to τ , and t → S ( t ) is constant equal to S 0 . Deﬁne the daily reproduction numbers R 0 ( a ) = τ × S 0 × Γ ( a ) = τ × S 0 × β ( a ) × e − ν a , ∀ a ≥ 0 . ( 4 . 4 ) Assuming that the number of susceptible individuals t → S ( t ) is constant and equal S 0 in the N - equation ( 4 . 3 ) , then we obtain N ( t ) = I 0 × R 0 ( t − t 0 ) + (cid:90) t − t 0 0 R 0 ( a ) N ( t − a ) da , ∀ t ≥ t 0 . ( 4 . 5 ) By using the change of variable s = t − t 0 , N ( s + t 0 ) = I 0 × R 0 ( s ) + (cid:90) s 0 R 0 ( a ) N ( s + t 0 − a ) da , ∀ s ≥ 0 . Replacing the notation s by t , and deﬁne N t 0 ( t ) = N ( t + t 0 ) , ∀ t ≥ 0 , the equation ( 4 . 5 ) becomes N t 0 ( t ) = (cid:20) I 0 × R 0 ( t ) + (cid:90) t 0 R 0 ( a ) N t 0 ( t − a ) da (cid:21) , ∀ t ≥ 0 . ( 4 . 6 ) By replacing N t 0 ( t ) by the right hand side of ( 4 . 6 ) in the integral term of ( 4 . 6 ) we obtain N t 0 ( t ) = I 0 × R 0 ( t ) + (cid:90) t 0 R 0 ( a ) I 0 × R 0 ( t − a ) da + (cid:90) t 0 R 0 ( a 0 ) (cid:90) t − a 0 0 R 0 ( a 1 ) N t 0 ( t − a 0 − a 1 ) da 1 da 0 and by induction N t 0 ( t ) = I 0 R 0 ( t ) + I 0 ( R 0 ∗ R 0 ) ( t ) + I 0 ( R 0 ∗ R 0 ∗ R 0 ) ( t ) + . . . + I 0 ( R 0 ∗ R 0 ∗ . . . ∗ R 0 ) (cid:124) (cid:123)(cid:122) (cid:125) n times ( t ) + . . . 11 where the convolution is deﬁned by ( U ∗ V ) ( t ) = (cid:90) t 0 U ( a ) V ( t − a ) da = (cid:90) t 0 U ( t − a ) V ( a ) da . We deﬁne (cid:16) U ∗ ( 2 ) (cid:17) ( t ) = ( U ∗ U ) ( t ) , and for each integer n ≥ 3 , (cid:16) U ∗ ( n ) (cid:17) ( t ) = (cid:16) U ∗ ( n − 1 ) ∗ U (cid:17) ( t ) = (cid:16) U ∗ U ∗ ( n − 1 ) (cid:17) ( t ) = ( U ∗ U ∗ . . . ∗ U ) (cid:124) (cid:123)(cid:122) (cid:125) n times ( t ) . We can interpret the N - equation ( 4 . 5 ) concretely as follows N t 0 ( t ) = I 0 R 0 ( t ) (cid:124) (cid:123)(cid:122) (cid:125) Flow of infected produced at time t by the ﬁrst I 0 infected individuals + I 0 (cid:16) R ∗ ( 2 ) 0 (cid:17) ( t ) (cid:124) (cid:123)(cid:122) (cid:125) Flow of infected produced at time t by the second generation of infected individuals + I 0 (cid:16) R ∗ ( 3 ) 0 (cid:17) ( t ) (cid:124) (cid:123)(cid:122) (cid:125) Flow of infected produced at time t by the third generation of infected individuals + . . . + I 0 (cid:16) R ∗ ( n ) 0 (cid:17) ( t ) (cid:124) (cid:123)(cid:122) (cid:125) Flow of infected produced at time t by the n th generation of infected individuals + . . . Basic reproduction number The total number of the ﬁrst generation of new infected produced by a single infected patient with age of infection a = 0 at time t = t 0 is called the basic reproduction number . That is R 0 = (cid:90) ∞ 0 R 0 ( a ) da . The ﬂow of the ﬁrst generation of new infected produced by a single infected patient have been infected for a days is called the daily reproduction numbers . When the time scale is one day , the function R 0 ( a ) is also the average daily number of case produced by a single patient at the age of infection a . Proposition 4 . 4 . The total number of cases produced by the n th generation of infected resulting from a single infected patient is (cid:90) ∞ 0 (cid:16) R ∗ ( n ) 0 (cid:17) ( t ) dt = ( R 0 ) n . Proof . By using Fubini’s theorem we have (cid:90) ∞ 0 ( R 0 ∗ V ) ( t ) dt = (cid:90) ∞ 0 (cid:90) t 0 R 0 ( t − a ) V ( a ) da dt = (cid:90) ∞ 0 (cid:90) + ∞ a R 0 ( t − a ) dt V ( a ) da 12 and by making the change of variable l = t − a we obtain (cid:90) ∞ 0 ( R 0 ∗ V ) ( t ) dt = (cid:90) + ∞ 0 R 0 ( l ) dl × (cid:90) + ∞ 0 V ( a ) da . Replacing V ( t ) by ( R ∗ ( n − 1 ) 0 ) ( t ) in the above equation we obtain (cid:90) ∞ 0 (cid:16) R ∗ ( n ) 0 (cid:17) ( t ) dt = (cid:90) + ∞ 0 R 0 ( l ) dl (cid:90) ∞ 0 (cid:16) R ∗ ( n − 1 ) 0 (cid:17) ( t ) dt , and the result follows by induction . 5 Computing the age dependent reproduction number Γ ( a ) from the data By using ( 4 . 3 ) , we obtain the following result . Computing Γ ( a ) from the data Assume in addition that the parameters t 0 , S 0 > 0 , I 0 , ν > 0 , and the function t → τ ( t ) are given . Then the function t → Γ ( t ) can be obtained from the ﬂow of new infected t → N ( t ) , as the unique solution of the Volterra integral equation Γ ( t − t 0 ) = 1 I 0 (cid:18) N ( t ) τ ( t ) S ( t ) − (cid:90) t − t 0 0 Γ ( a ) N ( t − a ) da (cid:19) , ∀ t ≥ t 0 , ( 5 . 1 ) where S ( t ) is obtained by using ( 2 . 4 ) . Remark 5 . 1 . Assume that patients can not transmit the pathogen when the age of infection is above a + > 0 . That is Γ ( a ) = 0 , ∀ a ≥ a + . Then the equation ( 5 . 1 ) becomes for all t ≥ t 0 + a + , N ( t ) τ ( t ) S ( t ) = (cid:90) a + 0 Γ ( a ) N ( t − a ) da ⇔ N ( t ) = τ ( t ) S ( t ) (cid:90) a + 0 Γ ( a ) N ( t − a ) da . 5 . 1 Some explicit examples of a → R 0 ( a ) We assume that the transmission t → τ ( t ) is constant equal to τ , and t → S ( t ) is constant equal to S 0 . Then R 0 ( a ) = τ × S 0 × Γ ( t − t 0 ) , and by setting a = t − t 0 , the equation ( 5 . 1 ) becomes R 0 ( a ) = N ( a + t 0 ) I 0 − 1 I 0 (cid:90) a 0 R 0 ( σ ) N ( a − σ + t 0 ) dσ , ∀ a ≥ 0 . ( 5 . 2 ) 13 5 . 1 . 1 Exponential decay Assume that N ( t ) = χ 1 I 0 e − χ 2 ( t − t 0 ) . Then we obtain R 0 ( a ) = χ 1 e − χ 2 a − (cid:90) a 0 R 0 ( σ ) χ 1 e − χ 2 ( a − σ ) dσ , ∀ a ≥ 0 . Therefore R (cid:48) 0 ( a ) = − ( χ 1 + χ 2 ) R 0 ( t ) , ∀ a ≥ 0 , and R 0 ( 0 ) = χ 1 , and we obtain R 0 ( a ) = χ 1 e − ( χ 1 + χ 2 ) a , ∀ a ≥ 0 . ( 5 . 3 ) 5 . 1 . 2 Exponential decay with latency Let t 1 > t 0 . Assume that N ( t ) = (cid:40) I 0 χ 1 e − χ 2 ( t − t 0 ) , if t ≥ t 1 , 0 , if t 0 ≤ t < t 1 . Then we obtain R 0 ( a ) = 0 , ∀ a ∈ [ 0 , t 1 − t 0 ] , and R 0 ( a ) = χ 1 e − χ 2 a − (cid:90) a t 1 − t 0 R 0 ( σ ) χ 1 e − χ 2 ( a − σ ) dσ , ∀ t ≥ t 1 . By setting a 1 = t 1 − t 0 , we obtain R 0 ( a ) = 0 , ∀ a ∈ [ 0 , a 1 ) , R 0 ( a ) = χ 1 e − χ 2 a − (cid:90) a a 1 R 0 ( σ ) χ 1 e − χ 2 ( a − σ ) dσ , ∀ a ≥ a 1 , hence by setting a = (cid:98) a + a 1 , R 0 ( (cid:98) a + a 1 ) = χ 1 e − χ 2 ( (cid:98) a + a 1 ) − (cid:90) (cid:98) a + a 1 a 1 χ 1 e − χ 2 ( (cid:98) a + a 1 − σ ) R 0 ( σ ) dσ , ∀ (cid:98) a ≥ 0 , and by setting (cid:98) a = a − a 1 , and (cid:98) R 0 ( (cid:98) a ) = R 0 ( (cid:98) a + a 1 ) , we obtain (cid:98) R 0 ( (cid:98) a ) = C 1 e − χ 2 (cid:98) a − (cid:90) (cid:98) a 0 χ 1 e − χ 2 ( (cid:98) a − σ ) (cid:98) R 0 ( σ ) dσ , ∀ (cid:98) a ≥ 0 , where C 1 = χ 1 e − χ 2 a 1 . Thus (cid:98) R 0 ( (cid:98) a ) = C 1 e − ( χ 1 + χ 2 ) (cid:98) a , ∀ (cid:98) a ≥ 0 . We conclude that R 0 ( a ) = (cid:40) 0 , if 0 ≤ a ≤ a 1 , χ 3 e − ( χ 1 + χ 2 ) a , if a > a 1 , ( 5 . 4 ) where χ 3 = χ 1 e χ 1 a 1 , and a 1 = t 1 − t 0 . 14 6 Day by day Kermack - McKendrick model with age of infection The variation of the number of susceptible individuals S ( t ) is given each day t = t 0 , t 0 + 1 , . . . , by S ( t ) = S 0 − t − 1 (cid:88) d = t 0 N ( d ) , ( 6 . 1 ) where S 0 is the number of susceptible on day 0 , S ( t ) is the number of susceptible on day t and N ( d ) is the daily number of new infected individuals on day d . By analogy with the equation ( 2 . 6 ) , the daily number of new infected individuals satisﬁes the following discrete time Volterra integral equation for all ∀ t = t 0 , t 0 + 1 , t 0 + 2 , . . . , N ( t ) = τ ( t ) S ( t ) + ∞ (cid:88) d = t − t 0 Γ ( d ) I 0 ( d − ( t − t 0 ) ) e − ν ( d − ( t − t 0 ) ) + τ ( t ) S ( t ) t − t 0 (cid:88) d = 1 Γ ( d ) × N ( t − d ) , ( 6 . 2 ) where Γ ( d ) : = β ( d ) e − ν d , ∀ d = 0 , 1 , 2 , . . . , and τ ( t ) is the transmission rate , β ( d ) is the probability to be infectious ( i . e . capable to transmit the pathogen ) after d days of infection and e − ν d is the probability to stay infected after d days of infection ( i . e . the probability not to recover or to die after d days of infection ) . The quantities I 0 ( d ) is the number of infected on day 0 which have being infected d days ago . The model ( 4 . 3 ) with a single cohort of infected becomes N ( t ) = τ ( t ) S ( t ) (cid:34) Γ ( t − t 0 ) I 0 ( 0 ) + t − t 0 (cid:88) d = 1 Γ ( d ) × N ( t − d ) (cid:35) . ( 6 . 3 ) Day by day single cohort model and daily basic reproduction number Assume that t → τ ( t ) equal τ 0 , and t → S ( t ) is constant equal to S 0 . Assume that the epidemic starts at time t 0 with a cohort of I 0 new infected patient ( i . e . with age of infection a = 0 ) . The model ( 4 . 5 ) with a single cohort of infected becomes a discrete Volterra equation N ( t ) = (cid:34) R 0 ( t − t 0 ) × I 0 + t − t 0 (cid:88) d = 1 R 0 ( d ) × N ( t − d ) (cid:35) , ∀ t ≥ t 0 . ( 6 . 4 ) We obtain the day by day equation for the daily reproduction number R 0 ( a ) = N ( t 0 + a ) I 0 − 1 I 0 a (cid:88) d = 1 R 0 ( d ) × N ( t 0 + a − d ) , ∀ a ≥ 0 . ( 6 . 5 ) 7 Numerical simulations 7 . 1 Comparison of deterministic and stochastic simulations In the simulations , the unit of time is one day , and we ﬁx S 0 = 10 7 = 10 000 000 , 1 / ν = 9 days , and R 0 = 1 . 1 . 15 For each function β ( a ) described below , the parameter τ is obtained numerically by using the following formula τ = R 0 S 0 (cid:82) ∞ 0 β ( a ) e − νa da , where the integral is computed by using the Simpson integration method . In the following , we use the numerical scheme described in Appendix A to run the simulation of the Volterra integral equation ( 4 . 3 ) - ( 4 . 1 ) . We use the Individual Based Model ( IBM ) described in Appendix B to run the stochastic simulations of the model . In the following , we illustrate the convergence of the IBM to the deterministic model whenever I 0 increases . 7 . 1 . 1 Example 1 We assume that the probability to be infectious is a shifted gamma like distribution . That is β ( a ) = β 0 ( a − a 0 ) + e − β 1 ( a − a 0 ) + , ( 7 . 1 ) with a 0 = 3 days , β 0 = e / 2 = 1 . 3591 , and β 1 = 1 / 2 = 0 . 5 . 0 5 10 15 20 25 30 a 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 ( a ) 0 5 10 15 20 25 30 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 Figure 1 : On the left - hand side , we plot the function a → β ( a ) . On the right - hand side , we plot the function a → R 0 ( a ) = τ 0 × S 0 × β ( a ) × e − νa . In the Figures 2 - 3 we use the IBM to investigate some properties of the clusters obtained from the stochastic simulations . We compare such a stochastic sample with the original a → R 0 ( a ) . By comparing Figures 4 - 5 ( for I 0 = 10 ) and Figures 9 - 10 ( for I 0 = 1 000 ) , we observe the convergence of the IBM to the deterministic model . Then in Figures 6 - 8 ( for I 0 = 10 ) and Figures 11 - 13 ( for I 0 = 1 000 ) , we apply the discrete - time equation ( 6 . 5 ) to reconstruct a → R 0 ( a ) from the trajectories of the deterministic or stochastic models . In the deterministic model , we observe the eﬀect of the day - by - day discretization ( which corresponds to the daily reported data ) . In the stochastic case , we observe the eﬀect of the stochasticity of the IBM . First generation of secondary cases produced by a single infected : 16 ( a ) 0 2 4 6 8 10 12 14 16 18 20 Age since infection 0 0 . 2 0 . 4 0 . 6 0 . 8 1 S ec ond a r y cases Standard Deviation 95 % Confidence Interval AverageDeterministic ( b ) 0 2 4 6 8 10 12 14 16 18 20 Age 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 A ve r a g e nu m b e r o f sec ond a r y cases Figure 2 : In these ﬁgures , we present sets of 500 samples of secondary cases produced by a single infected individual in a population of S = 10 7 susceptible hosts . Theses samples are produced by using the IBM . ( a ) Statistical summary : the blue curve represents the average number of cases at age of infection a ; the dark blue area is the 95 % conﬁdence interval of this average obtained by ﬁtting a Gaussian distribution to the data ; the light blue area corresponds to the standard deviation ; the orange curve is the deterministic daily basic reproductive number at age a . ( b ) Bar graph of the average number of secondary cases as a function of the age since infection . 0 1 2 3 4 5 6 7 Number of secondary cases 0 0 . 1 0 . 2 0 . 3 0 . 4 0 . 5 P r ob a b ili t y Figure 3 : In these ﬁgures , we present sets of 500 samples of secondary cases produced by a single infected individual in a population of S = 10 7 susceptible hosts . Theses samples are produced by using the IBM . We plot a histogram of the total number of secondary cases produced during the whole infection . This estimates the probability of a single infected to generate n secondary cases ( with n in the abscissa ) . Simulations for I 0 = 10 : 0 5 10 15 20 25 t 0 0 . 5 1 1 . 5 2 2 . 5 3 N ( t ) 0 5 10 15 20 25 t 0 2 4 6 8 10 12 14 D a il y nu m b e r o f cases DeterministicStochastic Figure 4 : On the left - hand side , we plot the function t → N ( t ) solution of ( 4 . 3 ) with ( 2 . 4 ) . On the right - hand side , we plot the function t → (cid:82) t t − 1 N ( s ) ds ( for t = 1 , 2 , . . . ) which corresponds to the daily number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the daily number of cases obtained from 500 runs of the IBM . 17 0 5 10 15 20 25 t 0 20 40 60 80 100 120 140 C u m u l a t i ve nu m b e r o f cases DeterministicStochastic 0 5 10 15 20 25 t 0 20 40 60 80 100 C u m u l a t i ve nu m b e r o f cases Stochastic : 10 % - 90 % Quantiles Stochastic : 25 % - 75 % Quantiles Stochastic : Average Deterministic Figure 5 : On the left - hand side , we plot the function t → (cid:82) t 0 N ( s ) ds ( for t = 0 , 1 , 2 , . . . ) which corresponds to the cumulative number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the cumulative number of cases obtained from 500 runs of the IBM . On the right - hand side , we plot the average values of the 500 runs obtained from the IBM as well as the quantiles ( 10 % − 90 % ( light blue ) and 25 % − 75 % ( blue ) ) . In Figures 6 - 8 we focus on the reconstruction of the daily reproduction number R 0 ( a ) = τ S 0 e − ν a β ( a ) . In Figure 6 , we focus on the reconstruction of the daily reproduction number from deterministic simulations , while in Figures 7 - 8 we focus on the reconstruction of the daily reproduction number from stochastic simulations . 0 5 10 15 20 25 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Original 0 5 10 15 20 25 - 0 . 4 - 0 . 2 0 0 . 2 0 . 4 OriginalI 0 = 6 I 0 = 10 I 0 = 14 Figure 6 : On the left hand side , we plot the daily basic reproduction number by using the original formula R 0 ( a ) with ( 7 . 1 ) . On the right - hand side , we apply formula ( 6 . 5 ) to the ﬂow of new infected obtained from the deterministic model . We vary I 0 = 6 , 10 , 14 . The value I 0 = 10 corresponds to the value used for the simulation of the deterministic model . The yellow curve gives the best visual ﬁt , and the R 0 ( a ) becomes negative whenever I 0 becomes too small . 0 5 10 15 20 25 0 1 2 3 4 0 5 10 15 20 25 - 0 . 4 - 0 . 2 0 0 . 2 0 . 4 0 . 6 Figure 7 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained from a single run of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 10 ) to the daily number of cases of case obtained from the IBM . 18 0 5 10 15 20 25 0 200 400 600 800 1000 1200 1400 0 5 10 15 20 25 - 0 . 05 0 0 . 05 0 . 1 0 . 15 0 . 2 Figure 8 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained by summing the daily number of cases for 500 runs of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 500 × 10 ) to the daily number of cases obtained from the IBM . Simulations for I 0 = 1000 : 0 5 10 15 20 25 t 0 50 100 150 200 250 300 N ( t ) 0 5 10 15 20 25 t 0 50 100 150 200 250 300 350 D a il y nu m b e r o f cases DeterministicStochastic Figure 9 : On the left - hand side , we plot the function t → N ( t ) solution of ( 4 . 3 ) with ( 2 . 4 ) . On the right - hand side , we plot the function t → (cid:82) t t − 1 N ( s ) ds ( for t = 1 , 2 , . . . ) which corresponds to the daily number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the daily number of cases obtained from 500 runs of the IBM . 0 5 10 15 20 25 t 0 1000 2000 3000 4000 5000 6000 7000 C u m u l a t i ve nu m b e r o f cases DeterministicStochastic 0 5 10 15 20 25 t 0 1000 2000 3000 4000 5000 6000 C u m u l a t i ve nu m b e r o f cases Stochastic : 10 % - 90 % Quantiles Stochastic : 25 % - 75 % Quantiles Stochastic : Average Deterministic Figure 10 : On the left - hand side , we plot the function t → (cid:82) t 0 N ( s ) ds ( for t = 0 , 1 , 2 , . . . ) which corresponds to the cumulative number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the cumulative number of cases obtained from 500 runs of the IBM . On the right - hand side , we plot the average values of the 500 runs obtained from the IBM as well as the quantiles ( 10 % − 90 % ( light blue ) and 25 % − 75 % ( blue ) ) . In Figures 11 - 13 we focus on the reconstruction of the daily reproduction number R 0 ( a ) = τ S 0 e − ν a β ( a ) . In Figure 11 , we focus on the reconstruction of the daily reproduction number from deterministic simulations , while in Figures 12 - 13 we focus on the reconstruction of the daily reproduction number from stochastic simulations . 19 0 5 10 15 20 25 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Original 0 5 10 15 20 25 - 0 . 4 - 0 . 2 0 0 . 2 0 . 4 OriginalI 0 = 600 I 0 = 1000 I 0 = 1400 Figure 11 : On the left hand side , we plot the daily basic reproduction number by using the original formula R 0 ( a ) with ( 7 . 1 ) . On the right - hand side , we apply formula ( 6 . 5 ) to the ﬂow of new infected obtained from the deterministic model . We vary I 0 = 600 , 1000 , 1400 . The value I 0 = 1000 corresponds to the value used for the simulation of the deterministic model . The yellow curve gives the best visual ﬁt , and the R 0 ( a ) becomes negative whenever I 0 becomes too small . 0 5 10 15 20 25 0 50 100 150 200 250 300 0 5 10 15 20 25 - 0 . 05 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 Figure 12 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained from a single run of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 1000 ) to the daily number of cases of case obtained from the IBM . 0 5 10 15 20 25 0 2 4 6 8 10 12 14 10 4 0 5 10 15 20 25 - 0 . 05 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 Figure 13 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained by summing the daily number of cases for 500 runs of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 500 × 1000 ) to the daily number of cases obtained from the IBM . 7 . 1 . 2 Example 2 It is common to see biphasic ﬂu clinically : after incubation of one day , there is a high fever , then a drop in temperature before rising again , hence the term " V " fever [ 7 ] . Such a biphasic contagiousness is also observed in Covid - 19 . The viral load in throat swab and sputum has been measured for Covid - 19 patients , which leads to biphasic contagiousness [ 10 , 28 ] . To cover these type of infectious diseases , we introduce the following form for the probability to be infectious β ( a ) = 0 . 5 × 4 q { ( a − a 0 ) ( 1 − q ( a − a 0 ) ) } + + 4 q { ( a − pa 0 ) ( 1 − q ( a − pa 0 ) ) } + , ( 7 . 2 ) 20 with a 0 = 3 days , p = 2 . 5 , and q = 0 . 3 . 0 5 10 15 20 25 30 a 0 0 . 2 0 . 4 0 . 6 0 . 8 1 ( a ) 0 5 10 15 20 25 30 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Figure 14 : On the left - hand side , we plot the function a → β ( a ) . On the right - hand side , we plot the function a → R 0 ( a ) = τ 0 × S 0 × β ( a ) × e − νa . In the Figures 15 - 16 we use the IBM to investigate some properties of the clusters obtained from the stochastic simulations . We compare such a stochastic sample with the original a → R 0 ( a ) . By comparing Figures 17 - 18 ( for I 0 = 10 ) and Figures 22 - 23 ( for I 0 = 1 000 ) , we observe the convergence of the IBM to the deterministic model . Then in Figures 19 - 21 ( for I 0 = 10 ) and Figures 24 - 26 ( for I 0 = 1 000 ) , we apply the discrete - time equation ( 6 . 5 ) to reconstruct a → R 0 ( a ) from the trajectories of the deterministic or stochastic models . In the deterministic model , we observe the eﬀect of the day - by - day discretization ( which corresponds to the daily reported data ) . In the stochastic case , we observe the eﬀect of the stochasticity of the IBM . First generation of secondary cases produced by a single infected : ( a ) 0 2 4 6 8 10 12 14 16 18 20 Age since infection 0 0 . 2 0 . 4 0 . 6 0 . 8 1 S ec ond a r y cases Standard Deviation 95 % Confidence Interval AverageDeterministic ( b ) 0 2 4 6 8 10 12 14 16 18 20 Age 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 A ve r a g e nu m b e r o f sec ond a r y cases Figure 15 : In these ﬁgures , we present sets of 500 samples of secondary cases produced by a single infected individual in a population of S = 10 7 susceptible hosts . Theses samples are produced by using the IBM . ( a ) Statistical summary : the blue curve represents the average number of cases at age of infection a ; the dark blue area is the 95 % conﬁdence interval of this average obtained by ﬁtting a Gaussian distribution to the data ; the light blue area corresponds to the standard deviation ; the orange curve is the deterministic daily basic reproductive number at age a . ( b ) Bar graph of the average number of secondary cases as a function of the age since infection . 21 Figure 16 : In these ﬁgures , we present sets of 500 samples of secondary cases produced by a single infected individual in a population of S = 10 7 susceptible hosts . Theses samples are produced by using the IBM . We plot a histogram of the total number of secondary cases produced during the whole infection . This estimates the probability of a single infected to generate n secondary cases ( with n in the abscissa ) . Simulations for I 0 = 10 : 0 5 10 15 20 25 t 0 1 2 3 4 N ( t ) 0 5 10 15 20 25 t 0 5 10 15 20 D a il y nu m b e r o f cases DeterministicStochastic Figure 17 : On the left - hand side , we plot the function t → N ( t ) solution of ( 4 . 3 ) with ( 2 . 4 ) . On the right - hand side , we plot the function t → (cid:82) t t − 1 N ( s ) ds ( for t = 1 , 2 , . . . ) which corresponds to the daily number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the daily number of cases obtained from 500 runs of the IBM . 0 5 10 15 20 25 t 0 20 40 60 80 100 120 140 C u m u l a t i ve nu m b e r o f cases DeterministicStochastic 0 5 10 15 20 25 t 0 20 40 60 80 100 120 C u m u l a t i ve nu m b e r o f cases Stochastic : 10 % - 90 % Quantiles Stochastic : 25 % - 75 % Quantiles Stochastic : Average Deterministic Figure 18 : On the left - hand side , we plot the function t → (cid:82) t 0 N ( s ) ds ( for t = 0 , 1 , 2 , . . . ) which corresponds to the cumulative number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the cumulative number of cases obtained from 500 runs of the IBM . On the right - hand side , we plot the average values of the 500 runs obtained from the IBM as well as the quantiles ( 10 % − 90 % ( light blue ) and 25 % − 75 % ( blue ) ) . In Figures 19 - 21 we focus on the reconstruction of the daily reproduction number R 0 ( a ) = τ S 0 e − ν a β ( a ) . In Figure 19 , we focus on the reconstruction of the daily reproduction number from deterministic simulations , while in Figures 20 - 21 we focus on the reconstruction of the daily reproduction number from stochastic simulations . 22 0 5 10 15 20 25 30 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Original 0 5 10 15 20 25 - 0 . 5 0 0 . 5 OriginalI 0 = 6 I 0 = 10 I 0 = 14 Figure 19 : On the left hand side , we plot the daily basic reproduction number by using the original formula R 0 ( a ) with ( 7 . 2 ) . On the right - hand side , we apply formula ( 6 . 5 ) to the ﬂow of new infected obtained from the deterministic model . We vary I 0 = 6 , 10 , 14 . The value I 0 = 10 corresponds to the value used for the simulation of the deterministic model . The yellow curve gives the best visual ﬁt , and the R 0 ( a ) becomes negative whenever I 0 becomes too small . 0 5 10 15 20 25 0 1 2 3 4 5 0 5 10 15 20 25 - 0 . 4 - 0 . 2 0 0 . 2 0 . 4 Figure 20 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained from a single run of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 10 ) to the daily number of cases of case obtained from the IBM . 0 5 10 15 20 25 0 500 1000 1500 2000 0 5 10 15 20 25 - 0 . 1 0 0 . 1 0 . 2 0 . 3 Figure 21 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained by summing the daily number of cases for 500 runs of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 500 × 10 ) to the daily number of cases obtained from the IBM . Simulations for I 0 = 1000 : 23 0 5 10 15 20 25 t 0 100 200 300 400 N ( t ) 0 5 10 15 20 25 30 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Figure 22 : On the left - hand side , we plot the function t → N ( t ) solution of ( 4 . 3 ) with ( 2 . 4 ) . On the right - hand side , we plot the function t → (cid:82) t t − 1 N ( s ) ds ( for t = 1 , 2 , . . . ) which corresponds to the daily number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the daily number of cases obtained from 500 runs of the IBM . 0 5 10 15 20 25 t 0 1000 2000 3000 4000 5000 6000 C u m u l a t i ve nu m b e r o f cases Deterministic Stochastic 0 5 10 15 20 25 t 0 1000 2000 3000 4000 5000 C u m u l a t i ve nu m b e r o f cases Stochastic : 10 % - 90 % Quantiles Stochastic : 25 % - 75 % Quantiles Stochastic : Average Deterministic Figure 23 : On the left - hand side , we plot the function t → (cid:82) t 0 N ( s ) ds ( for t = 0 , 1 , 2 , . . . ) which corresponds to the cumulative number of cases obtained from by solving ( 4 . 3 ) with ( 2 . 4 ) , and we compare it with the cumulative number of cases obtained from 500 runs of the IBM . On the right - hand side , we plot the average values of the 500 runs obtained from the IBM as well as the quantiles ( 10 % − 90 % ( light blue ) and 25 % − 75 % ( blue ) ) . In Figures 24 - 26 we focus on the reconstruction of the daily reproduction number R 0 ( a ) = τ S 0 e − ν a β ( a ) . In Figure 24 , we focus on the reconstruction of the daily reproduction number from deterministic simulations , while in Figures 25 - 26 we focus on the reconstruction of the daily reproduction number from stochastic simulations . 0 5 10 15 20 25 a 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 0 . 3 Original 0 5 10 15 20 25 - 0 . 5 0 0 . 5 OriginalI 0 = 600 I 0 = 1000 I 0 = 1400 Figure 24 : On the left hand side , we plot the daily basic reproduction number by using the original formula R 0 ( a ) with ( 7 . 2 ) . On the right - hand side , we apply formula ( 6 . 5 ) to the ﬂow of new infected obtained from the deterministic model . We vary I 0 = 600 , 1000 , 1400 . The value I 0 = 1000 corresponds to the value used for the simulation of the deterministic model . The yellow curve gives the best visual ﬁt , and the R 0 ( a ) becomes negative whenever I 0 becomes too small . 24 0 5 10 15 20 25 0 50 100 150 200 250 300 350 0 5 10 15 20 25 - 0 . 1 0 0 . 1 0 . 2 0 . 3 Figure 25 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained from a single run of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 1000 ) to the daily number of cases of case obtained from the IBM . 0 5 10 15 20 25 0 0 . 5 1 1 . 5 2 10 5 0 5 10 15 20 25 - 0 . 05 0 0 . 05 0 . 1 0 . 15 0 . 2 0 . 25 Figure 26 : On the left - hand side , we plot the daily number of cases t → N ( t ) ( for t = 0 , 1 , 2 , . . . ) obtained by summing the daily number of cases for 500 runs of the IBM . On the right - hand side , we apply formula ( 6 . 5 ) ( with I 0 = 500 × 1000 ) to the daily number of cases obtained from the IBM . 8 Application to SARS - CoV - 1 In practice , the Kermack - McKendrick model starting from a Dirac mass means that the epidemic starts from a single patient at time t 0 ( whenever I 0 = 1 ) or from a group of I 0 infected patients all with the same age of infection a = 0 at time t 0 . This assumption corresponds to the standard conception of a cluster in epidemiology . An example of such a cluster is obtained [ 34 ] for the SARS - CoV - 1 epidemic in Singapore in 2003 . The cluster is represented by a network of contact between individuals in Figure 27 . Feb 28 Mar 05 Mar 10 Mar 15 Mar 20 Mar 25 Mar 30 Apr 04 Apr 09 Apr 14 Apr 19 Apr 24 Apr 29 2003 0 2 4 6 8 10 12 14 case 1 case 2 case 3 case 4 case 5 other Figure 27 : On the left - hand side , we plot the contact network of the ﬁve super spreader cases in the SARS epidemic in Singapore in 2003 [ 34 ] . The super spreaders are patient 1 , patient 6 , patient 35 , patient 130 and patient 127 . On the right - hand side , we plot the daily reported cases from Singapore for the epidemic of SARS in 2003 . Case 1 generated 21 cases and 3 suspected cases , case 2 generated 23 cases and 5 suspected cases , case 3 generated 23 cases and 18 suspected cases , case 4 generated 40 cases and 22 suspected cases , case 5 generated 15 cases and 0 suspected cases [ 34 ] . The cases 1 , 2 , 3 , 4 , 5 correspond respectively to the patients 1 , 6 , 35 , 130 and 127 . 25 Figure 27 presents the time series of reported cases by source of infection and date of fever onset . In Figure 28 we present three representations of these data in continuous time : as a step function , regularized by Gaussian average and rolling weekly average . In Figure 29 we apply the continuous - time model to the rolling weekly regularization of the data . Similar to the reconstruction of R 0 ( a ) presented in Figures 6 - 8 , 11 - 13 , 19 - 21 , 24 - 26 , the basic reproduction number R 0 ( a ) becomes negative after a given age . Our interpretation is that the data are far from perfect and involves sampling errors and probably a large number of undetected cases . The fact that the transmission rate is subject to variations in time could also explain this negativity . In Figure 30 we apply the discrete model ( 1 . 6 ) to the original data for diﬀerent values of I 0 . Finally , in Figure 31 , we transform the data by taking advantage of the information on the source of infection given in [ 34 ] . We ﬁx an incubation period of 5 days , which corresponds to the average incubation period reported in [ 34 ] . Then we shift all secondary cases produced by the six sources identiﬁed in the article [ 34 ] to the same origin , as if all cases had been produced by the same cluster of six individuals . We present the data on the left - hand side of Figure 31 and apply the method to obtain R 0 ( a ) for parameters I 0 = 30 , I 0 = 50 , I 0 = 100 . M a r 0 1 M a r 0 8 M a r 1 5 M a r 2 2 M a r 2 9 A p r 0 5 A p r 1 2 A p r 1 9 A p r 2 6 2003 0 2 4 6 8 10 12 Daily Reported Gaussian Weekly Average Rolling Weekly Average Figure 28 : Regularizations of the daily cases data from the SARS - CoV - 1 outbreak in Singapore [ 34 ] . The applications in Figure 29 are done with the “Rolling Weekly” regularization . Mar 04 Mar 11 Mar 18 Mar 25 Apr 01 Apr 08 Apr 15 2003 0 2 4 6 8 ModelData 0 10 20 30 40 50 60 - 1 - 0 . 5 0 0 . 5 1 I 0 = 30 I 0 = 50 I 0 = 100 Figure 29 : Left : Regularized data of the SARS - CoV - 1 outbreak in Singapore in 2003 [ 34 ] ( black line ) and the numerical solution of the model ( 1 . 1 ) with I 0 = 30 and R 0 ( a ) computed by ( 1 . 6 ) ( blue line ) . The solutions N ( t ) of the model ( 1 . 1 ) with I 0 = 50 and I 0 = 100 are exactly the same when we use the corresponding R 0 ( a ) , therefore they are not represented here . Right : numerical solution of the R 0 ( a ) function computed by using the continuous model ( 1 . 4 ) with I 0 = 30 , I 0 = 50 and I 0 = 100 . 26 Feb 28 Mar 07 Mar 14 Mar 21 Mar 28 Apr 04 Apr 11 Apr 18 Apr 25 2003 0 2 4 6 8 10 12 0 10 20 30 40 50 60 - 1 - 0 . 5 0 0 . 5 1 Figure 30 : Left : Original daily reported cases data of the SARS - CoV - 1 outbreak in Singapore in 2003 [ 34 ] ( blue line ) . Right : Numerical solution of the R 0 ( a ) function computed by using the discrete model ( 1 . 6 ) with I 0 = 30 , I 0 = 50 and I 0 = 100 . Feb 28 Mar 07 Mar 14 Mar 21 Mar 28 Apr 04 Apr 11 Apr 18 2003 0 5 10 15 0 5 10 15 20 25 30 35 40 45 50 - 1 - 0 . 5 0 0 . 5 1 Figure 31 : Left : Daily reported cases of a theoretical cluster based on the data from the SARS - CoV - 1 outbreak in Singapore in 2003 [ 34 ] ( blue line ) . The secondary cases produced by the six patients identiﬁed in [ 34 ] are shifted to the same initial infection date of the infector , as if all were produced by the same cluster starting at t = 0 . We also use an incubation period of 5 days , as indicated in [ 34 ] . Right : Numerical solution of the R 0 ( a ) function computed by using the discrete model ( 1 . 6 ) with I 0 = 30 , I 0 = 50 and I 0 = 100 . 9 Discussion We see from the numerical simulations in Section 7 that the initial number of infected I 0 has a very signiﬁcant inﬂuence on the value of the basic daily reproduction numbers R 0 ( d ) : these decrease sharply with I 0 , until they become negative and their ﬂuctuations increase in stochastic simulations . This tendency to negativity for small I 0 and these ﬂuctuations are only corrected when the results are averaged for a large number of stochastic simulations ( 500 ) . It can also be noted that the stochastic simulations lead to a behavior of the hyper exponential type in the coeﬃcient of variation of the secondary cases produced by an infectious individual , that is to say that it is relatively constant and much greater than 1 . This phenomenon is to be related to the exponential character of the gamma distribution used in the simulations . In deterministic simulations , one can observe a great dependence of the results with regard to the value of I 0 concerning the reconstruction of the daily basic reproduction numbers R 0 ( a ) along the contagiousness period of an individual . In particular , the set of days at which R 0 ( a ) ﬂuctuates becoming in some cases negative is important for the great values of I 0 . In stochastic simulations , we observe the same behavior for the diﬀerent curves related to the R 0 ( a ) curves sample , but the expectation of this curves sample considerably attenuates these ﬂuctuations and the coeﬃcient of variation of the curves remains approximately constant , while being greater than 1 , as in the case of hyperexponential distributions , in agreement with the exponential character of the part D of the equation ( 1 . 7 ) deﬁning R 0 ( a ) . Concerning the clusters , from observations made during investigations of the start of the outbreak in some countries [ 1 , 5 , 6 , 11 , 15 , 18 – 21 , 24 , 29 – 31 , 33 ] , it is possible to get spatial and temporal information on the start of the epidemic , but these studies rarely allow the estimation of the parameters S 0 and τ in the concerned population and 27 worse , they give no indication of how long they remain constant . Here we assumed that they remained constant only during the period of exponential growth of new cases observed . Our work provides a method to reconstruct the daily basic reproduction number R 0 ( a ) from the daily reported cases data , as long as we consider a cluster starting from a single infected . This is a strong assumption which is usually neglected . It is extremely hard to ﬁnd in the literature a datasets which satisﬁes this assumption . For COVID - 19 , we did not ﬁnd any publication including suitable data . While not published yet , we believe that this kind of data could be gathered by a detailed contact - tracing and – duly anonymized – could be made available by request . That would allow the development of more realistic and accurate methods for the analysis and forecast of epidemics . Appendix A Euler approximation for the Volterra integral equation We use a numerical scheme for the equation ( 4 . 3 ) and ( 4 . 1 ) . N ( t ) = τ S ( max ( t − ∆ t , t 0 ) ) (cid:34) I 0 × Γ ( t − t 0 ) + (cid:90) max ( t − ∆ t − t 0 , 0 ) 0 Γ ( a ) N ( t − a ) da (cid:35) , ( A . 1 ) with S ( t ) = S 0 − (cid:90) t t 0 N ( σ ) dσ , ( A . 2 ) and we use the Simpson’s rule to compute the integrals . B Stochastic simulations : Individual Based Model In order to estimate the uncertainty expected in real datasets , we use stochastic simulations that reproduce the ﬁrst stages of the epidemic in ﬁnite populations . We consider a population composed of a ﬁnite number N = S 0 + I 0 of individuals . We start the simulation a time t = 0 with S 0 ∈ N susceptible individuals and I 0 ∈ N infected individuals all with age of infection a = 0 . For each infected individuals we also compute the time spent in the I - compartment which follows an exponential law with parameters 1 / ν . The principles of the simulations are as follows : 1 . Individuals meet at random at rate τ > 0 . In other words , each pair of individual in the population has a contact which occurs at a time following an exponential law of average 1 / τ . 2 . When a contact occurs between an infected individual of age a and a susceptible individual , the contact results in a newly infected individual of age 0 with probability β ( a ) . When the infection occurs , the newly infected individual is assigned a duration of infection which follows an exponential law of rate ν . Therefore individuals stay infected on average for a duration of 1 / ν . 3 . The age of all individuals is updated at ﬁxed intervals of time of size ∆ t . Simultaneously the life - span of each infected inviduals is decreased by ∆ t and individual whose life - span has become negative are removed from the system . The MATLAB code of the IBM is available online at : https : / / github . com / romainvieme / 2022 - kermack - mckendrick - single - cohort . 28 References [ 1 ] D . C . Adam , et al . , Clustering and superspreading potential of SARS - CoV - 2 infections in Hong Kong , Nature Medicine , 26 . 11 ( 2020 ) , 1714 - 1719 . [ 2 ] L . Alvarez , M . Colom , J . D . Morel , & J . M . Morel , Computing the daily reproduction number of COVID - 19 by inverting the renewal equation using a variational technique . Proceedings of the National Academy of Sciences , 118 ( 50 ) ( 2021 ) . [ 3 ] L . Alvarez , J - D . Morel , J - M . Morel , Modeling Covid - 19 incidence by the renewal equation after removal of administrative bias and noise , Biology 11 ( 4 ) , 540 ( 2022 ) . [ 4 ] D . Bernoulli , Essai d”une nouvelle analyse de la mortalité causé par la petite vérole et des avantages de l’inoculation pour la prévenir , Mém . Math . Phys . Acad . Roy . Sci . Paris , ( 1760 ) , 1 - 45 . [ 5 ] M . M . Böhmer , U . Buchholz , V . M . Corman , M . Hoch , K . Katz , D . V . Marosevic , et al . Investigation of a COVID - 19 outbreak in Germany resulting from a single travel - associated primary case : a case series . The Lancet Infectious Diseases , 20 . 8 ( 2020 ) , 920 - 928 . [ 6 ] T . C . Chan , and C . C . King . Surveillance and epidemiology of infectious diseases using spatial and temporal lustering methods . In : Infectious disease informatics and biosurveillance ( pp . 207 - 234 ) . Springer , Boston , MA ( 2011 ) . [ 7 ] D . L . Chao , M . E . Halloran , V . J . Obenchain , & Jr , I . M Longini , FluTE , a publicly available stochastic inﬂuenza epidemic simulation model . PLoS computational biology , 6 ( 1 ) ( 2010 ) , e1000656 . [ 8 ] J . Demongeot , Q . Griette , and P . Magal . SI epidemic model applied to COVID - 19 data in mainland China . R . Soc . Open Sci . 7 . 12 ( 2020 ) , 201878 . [ 9 ] J . Demongeot , Q . Griette , P . Magal , and G . Webb . Modeling vaccine eﬃcacy for COVID - 19 outbreak in New York city . Biology , 11 . 3 ( 2022 ) , 345 . [ 10 ] J . Demongeot , K . Oshinubi , M . Rachdi , H . Seligmann , F . Thuderoz & J . Waku , Estimation of Daily Repro - duction Rates in COVID - 19 Outbreak . Computation , 9 , 109 ( 2021 ) . [ 11 ] M . R . Desjardins , A . Hohl , and E . M . Delmelle . Rapid surveillance of COVID - 19 in the United States using a prospective space - time scan statistic : Detecting and evaluating emerging clusters . Applied geography 118 ( 2020 ) , 102202 . [ 12 ] K . Dietz and J . A . P . Heesterbeek , Daniel Bernoulli’s epidemiological model revisited , Math . Biosci . , 180 , ( 2002 ) , 1 - 21 . [ 13 ] K . Dietz and J . A . P . Heesterbeek , Daniel Bernoulli’s epidemiological model revisited , Math . Biosci . , 180 , 1 - 21 , ( 2002 ) . [ 14 ] A . Ducrot , and P . Magal , Volterra integral equations in the framework of integrated semigroups ( in preparation ) . [ 15 ] T . Ganyani , C . Kremer , D . Chen , A . Torneri , C . Faes , J . Wallinga , and N . Hens Estimating the generation interval for coronavirus disease ( COVID - 19 ) based on symptom onset data , March 2020 . Eurosurveillance , 25 . 17 ( 2020 ) 2000257 . [ 16 ] Q . Griette , J . Demongeot , and P . Magal . A robust phenomenological approach to investigate COVID - 19 data for France . Math . Appl . Sci . Eng . , 2021 . [ 17 ] Q . Griette , J . Demongeot , and P . Magal . What can we learn from COVID - 19 data by using epidemic models with unidentiﬁed infectious cases ? . Mathematical Biosciences and Engineering , 19 . 1 ( 2022 ) , 537 - 594 . 29 [ 18 ] A . Guttmann , L . Ouchchane , X . Li , I . Perthus , J . Gaudart , J . Demongeot , and J . Y . Boire . Performance map of a cluster detection test using extended power . International Journal of Health Geographics , 12 . 1 ( 2013 ) , 1 - 10 . [ 19 ] L . Han , P . Shen , J . Yan , Y . Huang , X . Ba , W . Lin , et al . Exploring the Clinical Characteristics of COVID - 19 Clusters Identiﬁed Using Factor Analysis of Mixed Data - Based Cluster Analysis . Frontiers in medicine , 8 ( 2021 ) . [ 20 ] S . Hisada , T . Murayama , K . Tsubouchi , S . Fujita , S . Yada , S . Wakamiya , and E . Aramaki . Surveillance of early stage COVID - 19 clusters using search query logs and mobile device - based location information . Scientiﬁc Reports , 10 . 1 ( 2020 ) , 1 - 8 . [ 21 ] Q . L . Jing , M . J . Liu , Z . B . Zhang , L . Q . Fang , J . Yuan , A . R . Zhang , et al . Household secondary attack rate of COVID - 19 and associated determinants in Guangzhou , China : a retrospective cohort study . The Lancet Infectious Diseases , 20 . 10 ( 2020 ) , 1141 - 1150 . [ 22 ] W . O . Kermack and A . G . McKendrick , Contributions to the mathematical theory of epidemics : II , Proc . R . Soc . Lond . Ser . B , 138 , ( 1932 ) , 55 - 83 . [ 23 ] C . Kremer , T . Ganyani , D . Chen , A . Torneri , C . Faes , J . Wallinga , and N . Hens . Authors’ response : estimating the generation interval for COVID - 19 based on symptom onset data . Eurosurveillance , 25 . 29 ) ( 2020 ) , 2001269 . [ 24 ] A . Ladoy , O . Opota , P . N . Carron , I . Guessous , S . Vuilleumier , S . Joost , and G . Greub . Size and duration of COVID - 19 clusters go along with a high SARS - CoV - 2 viral load : A spatio - temporal investigation in Vaud state , Switzerland . Science of The Total Environment , 787 ( 2021 ) , 147483 . [ 25 ] Z . Liu , P . Magal , O . Seydi , & G . Webb , Understanding unreported cases in the COVID - 19 epidemic outbreak in Wuhan , China , and the importance of major public health interventions . Biology , 9 ( 3 ) , 50 ( 2020 ) . [ 26 ] H . Nishiura , Time variations in the transmissibility of pandemic inﬂuenza in Prussia , Germany , from 1918 - 19 . Theor . Biol . Med . Model . 4 , 20 ( 2007 ) . [ 27 ] H . Nishiura , G . Chowell , “The eﬀective reproduction number as a prelude to statistical estimation of time - dependent epidemic trends” in Mathematical and Statistical Estimation Approaches in Epidemiology , G . Chow - ell , J . M . Hyman , L . M . A . Bettencourt , C . Castillo - Chavez , Eds . ( Springer , Dordrecht , Netherlands , 2009 ) , pp . 103 - 121 . [ 28 ] Y . Pan , D . Zhang , P . Yang , L . L . M . Poon , and Q . Wang , Viral load of sars - cov - 2 in clinical samples . The Lancet Infectious Diseases , 20 ( 4 ) ( 2020 ) , 411 – 412 . [ 29 ] R . Pung , C . J . Chiew , B . E . Young , S . Chin , M . I . Chen , H . E . Clapham , et al . Investigation of three clusters of COVID - 19 in Singapore : implications for surveillance and response measures . The Lancet , 395 . 10229 ( 2020 ) , 1039 - 1046 . [ 30 ] F . Shams , A . Abbas , W . Khan , U . S . Khan , and R . Nawaz . A death , infection , and recovery ( DIR ) model to forecast the COVID - 19 spread . Computer Methods and Programs in Biomedicine Update , 2 ( 2022 ) , 100047 . [ 31 ] A . Tariq , Y . Lee , K . Roosa , S . Blumberg , P . Yan , S . Ma , and G . Chowell . Real - time monitoring the transmission potential of COVID - 19 in Singapore , March 2020 . BMC medicine , 18 . 1 ( 2020 ) , 1 - 14 . [ 32 ] M . Worobey , T . Watts , R . McKay , et al . 1970s and ‘Patient 0’ HIV - 1 genomes illuminate early HIV / AIDS history in North America . Nature 539 ( 2016 ) , 98 – 101 . https : / / doi . org / 10 . 1038 / nature19827 [ 33 ] S . E . F . Yong , et . al . , Connecting clusters of COVID - 19 : an epidemiological and serological investigation , The Lancet Infectious Diseases 20 . 7 ( 2020 ) , 809 - 815 . [ 34 ] Centers for Disease Control and Prevention ( CDC ) , Severe acute respiratory syndrome Singapore , MMWR . Morbidity and mortality weekly report 52 . 18 , 2005 . https : / / www . cdc . gov / mmwr / preview / mmwrhtml / mm5218a1 . htm 30
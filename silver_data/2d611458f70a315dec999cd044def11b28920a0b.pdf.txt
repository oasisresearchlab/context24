A General Approach to Causal Mediation Analysis Kosuke Imai Princeton University Luke Keele Ohio State University Dustin Tingley Harvard University Traditionally in the social sciences , causal mediation analysis has been formulated , understood , and implemented within the framework of linear structural equation models . We argue and demonstrate that this is problematic for 3 reasons : the lack of a general deﬁnition of causal mediation effects independent of a particular statistical model , the inability to specify the key identiﬁcation assumption , and the difﬁculty of extending the framework to nonlinear models . In this article , we propose an alternative approach that overcomes these limitations . Our approach is general because it offers the deﬁnition , identiﬁcation , estimation , and sensitivity analysis of causal mediation effects without reference to any speciﬁc statistical model . Further , our approach explicitly links these 4 elements closely together within a single framework . As a result , the proposed framework can accommodate linear and nonlinear relationships , parametric and nonparametric models , continuous and discrete mediators , and various types of outcome variables . The general deﬁnition and identiﬁcation result also allow us to develop sensitivity analysis in the context of commonly used models , which enables applied researchers to formally assess the robustness of their empirical conclusions to violations of the key assumption . We illustrate our approach by applying it to the Job Search Intervention Study . We also offer easy - to - use software that implements all our proposed methods . Keywords : causal inference , causal mechanisms , direct and indirect effects , linear structural equation models , sensitivity analysis Causal inference is a central goal of social science research . In this context , randomized experiments are typically seen as a gold standard for the estimation of causal effects , and a number of statistical methods have been developed to make adjustments for methodological problems in both experimental and observational settings . However , one common criticism of experimentation and statistics is that they can provide only a black - box view of cau - sality . The argument is that although the estimation of causal effects allows researchers to examine whether a treatment causally affects an outcome , it cannot tell us how and why such an effect arises . This is an important limitation because the identiﬁcation of causal mechanisms is required to test competing theoretical expla - nations of the same causal effects . Causal mediation analysis plays an essential role in potentially overcoming this limitation by help - ing to identify intermediate variables ( or mediators ) that lie in the causal pathway between the treatment and the outcome . Traditionally , causal mediation analysis has been formulated , understood , and implemented within the framework of linear struc - tural equation modeling ( LSEM ; e . g . , Baron & Kenny , 1986 ; Hyman , 1955 ; James , Mulaik , & Brett , 1982 ; Judd & Kenny , 1981 ; MacKinnon , 2008 ; MacKinnon & Dwyer , 1993 ) . We argue and demonstrate that this is problematic for two reasons . First , by construction , the LSEM framework cannot offer a general deﬁni - tion of causal mediation effects that are applicable beyond speciﬁc statistical models . This is because the key identiﬁcation assump - tion is stated in the context of a particular model , making it difﬁcult to separate the limitations of research design from those of the speciﬁc statistical model . 1 Second , the methods developed in the LSEM framework are not generalizable to nonlinear models , 1 By “identiﬁcation , ” we mean whether the causal mediation effects can be consistently estimated . Thus , identiﬁcation is a minimum requirement for valid statistical inference and precedes the issue of statistical estima - tion , which is about how to make inferences from a ﬁnite sample . See below for the formal discussion in the context of causal mediation analysis and Manski ( 2007 ) for a general discussion . Kosuke Imai , Department of Politics , Princeton University ; Luke Keele , Department of Political Science , Ohio State University ; Dustin Tingley , Department of Government , Harvard University . Funding for this study was supported in part by National Science Foundation Grant SES - 0918968 . The two companion articles , one forming the theoretical basis of this article and the other providing the details of software implementation of the proposed methods , are available as Imai , Keele , and Yamamoto ( 2010 ) and Imai et al . ( 2010a ) , respectively . The easy - to - use software , mediation , is freely available at the Comprehensive R Archive Network ( http : / / cran . r - project . org / web / packages / mediation ) . The replication materials for all the empirical results presented in this article are available at the authors’ dataverse ( Imai et al . , 2010 ) . We thank Matt Incantalupo , Dave Kenny , Dave MacKinnon , Keith Markus , Scott Max - well , Walter Mebane , and Kris Preacher for useful comments that signif - icantly improved the presentation of this article . Correspondence concerning this article should be addressed to Kosuke Imai , Department of Politics , Princeton University , Princeton , NJ 08544 . E - mail : kimai @ princeton . edu Psychological Methods 2010 , Vol . ●● , No . ● , 000 – 000 © 2010 American Psychological Association 1082 - 989X / 10 / $ 12 . 00 DOI : 10 . 1037 / a0020761 1 tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn1 including logit and probit models , for discrete mediators and outcomes as well as non - or semiparametric models . In this article , we propose a general approach that overcomes these limitations . We use a single framework for the deﬁnition , identiﬁcation , estimation , and sensitivity analysis of causal medi - ation effects without reference to any speciﬁc statistical model . First , following the recently published work ( e . g . , Jo , 2008 ; Sobel , 2008 ) , we place causal mediation analysis within the counterfac - tual framework of causal inference and offer the formal deﬁnition of causal mediation effects . This deﬁnition formalizes , indepen - dent of any speciﬁc statistical models , the intuitive notion about mediation held by applied researchers that the treatment indirectly inﬂuences the outcome through the mediator . Second , we slightly extend the result of Imai , Keele , and Yamamoto ( 2010 ) , who proved that under the sequential ignor - ability assumption the average causal mediation effects are non - parametrically identiﬁed ( i . e . , can be consistently estimated with - out any functional form and distributional assumptions ) . Sequential ignorability consists of two assumptions : ( a ) Condi - tional on the observed pretreatment covariates , the treatment is independent of all potential values of the outcome and mediating variables , and ( b ) the observed mediator is independent of all potential outcomes given the observed treatment and pretreatment covariates . Such a nonparametric identiﬁcation analysis is impor - tant because it establishes a minimum set of assumptions required for mediation effects to be interpreted as causal without respect to statistical models used by researchers . Third , using our nonparametric identiﬁcation result , we develop general estimation procedures for causal mediation effects that can accommodate linear and nonlinear relationships , parametric and nonparametric models , continuous and discrete mediators , and various types of outcome variables . In the literature , some have extended the LSEM framework to these settings ( e . g . , Li , Schnei - der , & Bennett , 2007 ; MacKinnon , 2008 ; MacKinnon , Lockwood , Brown , Wang , & Hoffman , 2007 ; Wang & Taylor , 2002 ) . Our approach encompasses many of the existing methods as special cases , thereby accomplishing many of future statistical tasks iden - tiﬁed in a recent review article by MacKinnon and Fairchild ( 2009 ) . The last and yet perhaps most important contribution of our proposed approach is a set of sensitivity analyses we develop for statistical models commonly used by applied researchers . Sensi - tivity analysis allows researchers to formally quantify the robust - ness of their empirical conclusions to the potential violation of sequential ignorability , which is the key and yet untestable as - sumption needed for identiﬁcation . The fundamental difﬁculty in the causal mediation analysis is that there may exist unobserved confounders that causally affect both the mediator and the outcome even after conditioning on the observed treatment and pretreatment covariates . Therefore , assessing the sensitivity of one’s empirical ﬁndings to the possible existence of such confounders is required in order to evaluate the validity of any mediation study . In the LSEM framework , Imai , Keele , and Yamamoto ( 2010 ) proposed a straightforward way to check how severe the violation of the key identifying assumption would need to be for the original conclu - sions to be reversed . We generalize this sensitivity analysis so that it can be applied to other settings . Because our approach is developed without any reference to a particular statistical model , it is applicable across a wide range of situations . In this article , we illustrate its applicability using a variety of cross - section settings . Our general approach also al - lowed us to develop the easy - to - use software , mediation , which is freely available as an R package ( R Development Core Team , 2009 ) at the Comprehensive R Archive Network . 2 All the analyses presented in this article are conducted with this software . The details about the software implementation and its usage are given in a companion article ( Imai , Keele , Tingley , & Yamamoto , 2010a ) . Future research should address the application of our approach to the panel data settings ( e . g . , Cole & Maxwell , 2003 ; MacKinnon , 2008 , Chapter 8 ) , and multiple ( e . g . , MacKinnon , 2000 ; Preacher & Hayes , 2008 ) and multilevel ( e . g . , Krull & MacKinnon , 1999 ) mediators , all of which are beyond the scope of the current article . A Running Example : The Job Search Intervention Study ( JOBS II ) To motivate the concepts and methods that we present , we rely on an example from the psychology literature on mediation and use the JOBS II for our illustration . JOBS II is a randomized ﬁeld experiment that investigates the efﬁcacy of a job training interven - tion on unemployed workers . The program is designed not only to increase reemployment among the unemployed but also to enhance the mental health of the job seekers . In the experiment , 1 , 801 unemployed workers received a prescreening questionnaire and were then randomly assigned to treatment and control groups . Those in the treatment group participated in job skills workshops in which participants learned job search skills and coping strate - gies for dealing with setbacks in the job search process . Those in the control condition received a booklet describing job search tips . In follow - up interviews , two key outcome variables were mea - sured : a continuous measure of depressive symptoms based on the Hopkins Symptom Checklist and a binary variable , representing whether the respondent had become employed . Researchers who originally analyzed this experiment hypothe - sized that workshop attendance leads to better mental health and employment outcomes by enhancing participants’ conﬁdence in their ability to search for a job ( Vinokur , Price , & Schul , 1995 ; Vinokur & Schul , 1997 ) . In the JOBS II data , a continuous measure of job search self - efﬁcacy represents this key mediating variable . The data also include baseline covariates measured be - fore administering the treatment . The most important of these is the pretreatment level of depression , which is measured with the same methods as the continuous outcome variable . There are also several other covariates that are included in our analysis ( as well as in the original analysis ) to strengthen the validity of the key identifying assumption of causal mediation analysis . They include measures of education , income , race , marital status , age , sex , previous occupation , and the level of economic hardship . Statistical Framework for Causal Mediation Analysis In this section , we describe the counterfactual framework of causal inference , which is widely used in the statistical literature 2 The web address is http : / / cran . r - project . org / web / packages / mediation . 2 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn2 ( e . g . , Holland , 1986 ) and is beginning to gain acceptance in psychology ( e . g . , Jo , 2008 ; Little & Yau , 1998 ; MacKinnon , 2008 , Chapter 13 ; Schafer & Kang , 2008 ) . Following prior work ( e . g . , Imai , Keele , & Yamamoto , 2010 ; Pearl , 2001 ; Robins & Green - land , 1992 ) , we deﬁne causal mediation effects using the potential outcomes notation . We then review the key result of Imai , Keele , and Yamamoto ( 2010 ) and show a minimum set of the conditions under which the product of coefﬁcients method ( MacKinnon , Lockwood , Hoffman , West , & Sheets , 2002 ) and its variants yield valid estimates of causal mediation effects . Finally , we brieﬂy explain how our approach differs from the existing approach based on the instrumental variable methods of Angrist , Imbens , and Rubin ( 1996 ) . As we noted earlier , the strength of this framework is that it helps to clarify the assumptions needed for causal medi - ation effects without reference to speciﬁc statistical models . The Counterfactual Framework In the counterfactual framework of causal inference , the causal effect of the job training program for each worker can be deﬁned as the difference between two potential outcomes : one that would be realized if the worker participates in the job training program and the other that would be realized if the worker does not participate . Suppose that we use T i to represent the binary treat - ment variable , which is equal to 1 if worker i participated in the program and to 0 otherwise ( see later sections for an extension to nonbinary treatment ) . Then , we can use Y i ( t ) to denote the poten - tial employment status that would result under the treatment status t . For example , Y i ( 1 ) measures worker i ’s employment status if the worker participates in the job training program . Although there are two such potential values for each worker , only one of them is observed ; for example , if worker i actually did not participate in the program , then only Y i ( 0 ) is observed . Thus , if we use Y i to denote the observed value of employment status , then we have Y i (cid:1) Y i ( T i ) for all i . Given this setup , the causal effect of the job training program on worker i ’s employment status can be deﬁned as Y i ( 1 ) (cid:2) Y i ( 0 ) . Because only either Y i ( 1 ) or Y i ( 0 ) is observable , even randomized experiments cannot identify this unit - level causal effect . Thus , researchers often focus on the identiﬁcation and estimation of the average causal effect , which is deﬁned as (cid:1) (cid:3) Y i (cid:3) 1 (cid:4) (cid:1) Y i (cid:3) 0 (cid:4)(cid:4) , where the expectation is taken with respect to the random sampling of units from a target population . If the treatment is randomized as done in JOBS II , then T i is statistically independent of potential outcomes ; formally , we write ( Y i ( 1 ) , Y i ( 0 ) ) T i . When this is true , the average causal effect can be identiﬁed by the observed mean difference between the treatment and control groups , (cid:1) ( Y i ( 1 ) (cid:2) Y i ( 0 ) ) (cid:1) (cid:1) ( Y i ( 1 ) (cid:1) T i (cid:1) 1 ) (cid:2) (cid:1) ( Y i ( 0 ) (cid:1) T i (cid:1) 0 ) (cid:1) (cid:1) ( Y i (cid:1) T i (cid:1) 1 ) (cid:2) (cid:1) ( Y i (cid:1) T i (cid:1) 0 ) , which is the familiar result that the difference - in - means estimator is unbiased for the average causal effect in ran - domized experiments . Finally , we note that the above notation implicitly assumes no interference between units . In the current context , this means , for example , that worker i ’s employment status is not inﬂuenced by whether another worker j participates in the training program . This assumption is apparent from the fact that the potential values of Y i are written as a function of T i , which does not depend on T j for i (cid:5) j . The assumption is best addressed through research design . For example , analysts would want to ensure that participants in the experiment were not from the same household . The analyses that follow were conducted under this assumption , and the extension of our approach to the situation where the assumption is violated is left for future research . Deﬁning Causal Mediation Effects In the statistics literature , the counterfactual framework and notation have been extended to deﬁne causal mediation effects . We relate this notation to the quantities of interest in the JOBS II study . For example , suppose we are interested in the mediating effect of the job training program on depression in which the mediating variable is workers’ level of conﬁdence in their ability to perform essential job search activities such as completing an employment application . One possible hypothesis is that the participation in the job training program reduces the level of depression by increasing the level of workers’ self - conﬁdence to search for a job . We use M i to denote the observed level of job search self - efﬁcacy , which was measured after the implementation of the training program but before measuring the outcome variable . Because the level of job search self - efﬁcacy can be affected by the program participation , there exist two potential values , M i ( 1 ) and M i ( 0 ) , only one of which will be observed , that is , M i (cid:1) M i ( T i ) . For example , if worker i actually participates in the program ( T i (cid:1) 1 ) , then we observe M i ( 1 ) but not M i ( 0 ) . Next , we deﬁne the potential outcomes . Previously , the potential outcomes were only a function of the treatment , but in a causal mediation analysis the potential outcomes depend on the mediator as well as the treatment variable . Therefore , we use Y i ( t , m ) to denote the potential outcome that would result if the treatment and mediating variables equal t and m , respectively . For example , in the JOBS II study , Y i ( 1 , 1 . 5 ) represents the degree of depressive symptoms that would be observed if worker i participates in the training program and then has a job search self - efﬁcacy score of 1 . 5 . As before , we observe only one of multiple potential out - comes , and the observed outcome Y i equals Y i ( T i , M i ( T i ) ) . Lastly , recall that no interference between units is assumed throughout ; the potential mediator values for each unit do not depend on the treatment status of the other units , and the potential outcomes of each unit also do not depend on the treatment status and the mediator value of the other units . We now deﬁne causal mediation effects or indirect effects for each unit i as follows : (cid:6) i (cid:3) t (cid:4) (cid:2) Y i (cid:3) t , M i (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) t , M i (cid:3) 0 (cid:4)(cid:4) , ( 1 ) for t (cid:1) 0 , 1 . Thus , the causal mediation effect represents the indirect effect of the treatment on the outcome through the medi - ating variable ( Pearl , 2001 ; Robins , 2003 ; Robins & Greenland , 1992 ) . The key to understanding Equation 1 is the following counterfactual question : What change would occur to the outcome if one changes the mediator from the value that would be realized under the control condition , M i ( 0 ) , to the value that would be observed under the treatment condition , M i ( 1 ) , while holding the treatment status at t ? If the treatment has no effect on the mediator , that is , M i ( 1 ) (cid:1) M i ( 0 ) , then the causal mediation effect is zero . Although Y i ( t , M i ( t ) ) is observable for units with T i (cid:1) t , Y i ( t , M i ( 1 (cid:2) t ) ) can never be observed for any unit . 3 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 In the JOBS II study , for example , (cid:6) i ( 1 ) represents the difference between the two potential depression levels for worker i who partic - ipates in the training program . For this worker , Y i ( 1 , M i ( 1 ) ) equals an observed depression level if the worker actually participated in the program , whereas Y i ( 1 , M i ( 0 ) ) represents the depression level that would result if worker i participates but the mediator takes the value that would result under no participation . Similarly , (cid:6) i ( 0 ) represents an impact worker i ’s depression level due to the change in the mediator induced by the participation in the program while suppressing the direct effect of program participation . Therefore , this deﬁnition for - malizes , independent of any speciﬁc statistical models , the intuitive notion about mediation held by applied researchers that the treatment indirectly inﬂuences the outcome through the mediator . Similarly , we can deﬁne the direct effect of the treatment for each unit as follows : (cid:7) i (cid:3) t (cid:4) (cid:2) Y i (cid:3) 1 , M i (cid:3) t (cid:4)(cid:4) (cid:1) Y i (cid:3) 0 , M i (cid:3) t (cid:4)(cid:4) , ( 2 ) for t (cid:1) 0 , 1 . In the JOBS II study , for example , (cid:7) i ( 1 ) represents the direct effect of the job training program on worker i ’s depression level while holding the level of his or her job search self - efﬁcacy constant at the level that would be realized under the program participation . 3 Then , the total effect of the treatment can be de - composed into the causal mediation and direct effects : (cid:8) i (cid:2) Y i (cid:3) 1 , M i (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) 0 , M i (cid:3) 0 (cid:4)(cid:4) (cid:2) 1 2 (cid:3) t (cid:1) 0 1 (cid:9)(cid:6) i (cid:3) t (cid:4) (cid:3) (cid:7) i (cid:3) t (cid:4)(cid:10) . In addition , if we assume that causal mediation and direct effects do not vary as functions of treatment status ( i . e . , (cid:6) i (cid:1) (cid:6) i ( 1 ) (cid:1) (cid:6) i ( 0 ) and (cid:7) i (cid:1) (cid:7) i ( 1 ) (cid:1) (cid:7) i ( 0 ) , called the no - interaction assumption ) , then the mediation and direct effects sum to the total effect , that is , (cid:8) i (cid:1) (cid:6) i (cid:11) (cid:7) i . Finally , in causal mediation analysis , we are typically interested in the following average causal mediation effect : (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:1) (cid:3) Y i (cid:3) t , M i (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) t , M i (cid:3) 0 (cid:4)(cid:4)(cid:4) , for t (cid:1) 0 , 1 . For the JOBS II study , this would represent the average causal mediation effect among all workers of the popula - tion , of which the analysis sample can be considered as represen - tative . Similarly , averaging over the relevant population of work - ers , we can deﬁne the average direct and total effects as (cid:7) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:1) (cid:3) Y i (cid:3) 1 , M i (cid:3) t (cid:4)(cid:4) (cid:1) Y i (cid:3) 0 , M i (cid:3) t (cid:4)(cid:4)(cid:4) and (cid:8) (cid:1) (cid:2) (cid:1) (cid:3) Y i (cid:3) 1 , M i (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) 0 , M i (cid:3) 0 (cid:4)(cid:4)(cid:4) (cid:2) 1 2 (cid:3) t (cid:1) 0 1 (cid:9)(cid:6) (cid:1) (cid:3) t (cid:4) (cid:3) (cid:7) (cid:1) (cid:3) t (cid:4)(cid:10) , respectively . As before , under the no - interaction assumption ( i . e . , (cid:6) (cid:1) (cid:1) (cid:6) (cid:1) ( 1 ) (cid:1) (cid:6) (cid:1) ( 0 ) and (cid:7) (cid:1) (cid:1) (cid:7) (cid:1) ( 1 ) (cid:1) (cid:7) (cid:1) ( 0 ) ) , the average causal mediation and average direct effects sum to the average total effect , that is , (cid:8) (cid:1) (cid:1) (cid:6) (cid:1) (cid:11) (cid:7) (cid:1) , yielding the simple decomposition of the total effect into direct and indirect effects . Note that the average total effect may be close to zero in some cases , but this does not necessarily imply that the average causal mediation effects are also small . It is possible that the average causal mediation and average direct effects have opposite signs and thus offset each other , yielding a small average total effect . In the context of program evaluation , this is an important circum - stance because it implies that a policy can be improved by mod - ifying it so that an effective mediator plays a larger role to increase its overall efﬁcacy . Sequential Ignorability Assumption We now turn to the key assumption , which allows us to make valid inferences about the causal mediation effects deﬁned above . The question is , what assumptions are needed to give the average medi - ation effect a causal interpretation ? For randomized experiments , we only need to assume no interference between units to estimate the average treatment effect without bias . Causal mediation analysis , however , requires an additional assumption . In particular , we rely on the following assumption introduced by Imai , Keele , and Yamamoto ( 2010 ) . Let X i be a vector of the observed pretreatment confounders for unit i where (cid:1) denotes the support of the distribution of X i ( i . e . , the range of values X i can take on ) . In the JOBS II data , X i includes for each unemployed worker the pretreatment level of depressive symp - toms as well as some demographic characteristics such as education , race , marital status , sex , previous occupation , and the level of eco - nomic hardship . Given these observed pretreatment confounders , the assumption can be formally written as Assumption 1 ( Sequential Ignorability ; Imai , Keele , & Yamamoto , 2010 ) : We assume that the following two state - ments of conditional independence hold : (cid:9) Y i (cid:3) t (cid:12) , m (cid:4) , M i (cid:3) t (cid:4)(cid:10) T i (cid:1) X i (cid:2) x , ( 3 ) Y i (cid:3) t (cid:12) , m (cid:4) M i (cid:3) t (cid:4) (cid:1) T i (cid:2) t , X i (cid:2) x , ( 4 ) where 0 (cid:13) Pr ( T i (cid:1) t (cid:1) X i (cid:1) x ) and 0 (cid:13) p ( M i ( t ) (cid:1) m (cid:1) T i (cid:1) t , X i (cid:1) x ) for t (cid:1) 0 , 1 , and all x (cid:1) (cid:1) and m (cid:1) (cid:2) . Imai , Keele , and Yamamoto ( 2010 ) discussed how this assump - tion differs from those proposed in the prior literature . The main advantage of this assumption over other alternatives is its ease of interpretation . Assumption 1 is called sequential ignorability be - cause two ignorability assumptions are made sequentially . First , given the observed pretreatment confounders , the treatment assign - ment is assumed to be ignorable , that is , statistically independent of potential outcomes and potential mediators . In the JOBS II study , this ﬁrst ignorability assumption is satisﬁed because work - ers were randomly assigned to the treatment and control groups . In contrast , this part of the assumption is not guaranteed to hold in observational studies in which subjects may self - select into the treatment group . In such situations , a common strategy of empir - ical researchers is to collect as many pretreatment confounders as possible so that the ignorability of treatment assignment is more 3 Pearl ( 2001 ) called (cid:7) i ( t ) a natural direct effect to distinguish it from a controlled direct effect of the treatment . Imai et al . ( 2009 ) argued that the former corresponds to causal mechanisms , whereas the latter represents the causal effect of direct manipulation . Imai et al . also discussed the impli - cations of this distinction for experimental designs . 4 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn3 credible once the observed differences in these confounders be - tween the treatment and control groups are appropriately adjusted . The second part of Assumption 1 states that the mediator is ignorable given the observed treatment and pretreatment con - founders . That is , the second part of the sequential ignorability assumption is made conditional on the observed value of the ignorable treatment and the observed pretreatment confounders . Unlike the ignorability of treatment assignment , however , the ignorability of the mediator may not hold even in randomized experiments . In the JOBS II study , for example , the randomization of the treatment assignment does not justify this second ignorabil - ity assumption because the posttreatment level of workers’ job search self - efﬁcacy is not randomly assigned by researchers . In other words , the ignorability of the mediator implies that among those workers who share the same treatment status and the same pretreatment characteristics , the mediator can be regarded as if it were randomized . We emphasize that the second stage of sequential ignorability is a strong assumption and must be made with care . It is always possible that there might be unobserved variables that confound the relationship between the outcome and the mediator variables even after conditioning on the observed treatment status and the observed covariates . Moreover , the conditioning set of covariates must be pretreatment variables . Indeed , without an additional assumption , we cannot condition on the posttreatment confounders even if such variables are observed by researchers ( e . g . , Avin , Shpitser , & Pearl , 2005 ) . This means that similar to the ignorability of treatment assignment in observational studies , it is difﬁcult to know for certain whether the ignorability of the mediator holds even after researchers collect as many pretreatment confounders as possible . Such an assumption is often referred to as nonrefutable because it cannot be directly tested from the observed data ( Manski , 2007 ) . Thus , we develop a set of sensitivity analyses that will allow researchers to quantify the degree to which their empirical ﬁndings are robust to a potential violation of the sequential ignorability assumption . Sensitivity analyses are an appropriate approach to nonrefutable assumptions because they allow the researcher to probe whether a substantive conclusion is robust to potential violations of the assumption . Nonparametric Identiﬁcation Under Sequential Ignorability We now turn to the issue of identiﬁcation and speciﬁcally that of nonparametric identiﬁcation . By nonparametric identiﬁcation , we mean that without any additional distributional or functional form assumptions , the average causal mediation effects can be consis - tently estimated . This result is important for three reasons . First , it suggests the possibility of constructing a general method of esti - mating the average treatment effect for outcome and mediating variables of any type and using any parametric or nonparametric models . Second , it implies that we may estimate causal mediation effects while imposing weaker assumptions about the correct func - tional form or distribution of the observed data . Third , nonpara - metric identiﬁcation analysis reveals the key role of the sequential ignorability assumption irrespective of the statistical models used by researchers . We ﬁrst slightly generalize the nonparametric identiﬁcation result of Imai , Keele , and Yamamoto ( 2010 ) . The following result states that under Assumption 1 the distribution of any counterfac - tual outcome is identiﬁed . Theorem 1 ( Nonparametric Identiﬁcation ) : Under Assump - tion 1 , we can identify f (cid:3) Y i (cid:3) t , M i (cid:3) t (cid:12)(cid:4)(cid:4) (cid:1) X i (cid:2) x (cid:4) (cid:2) (cid:4) (cid:2) f (cid:3) Y i (cid:1) M i (cid:2) m , T i (cid:2) t , X i (cid:2) x (cid:4) dF M i (cid:3) m (cid:1) T i (cid:2) t (cid:12) , X i (cid:2) x (cid:4) , for any x (cid:1) (cid:1) and t , t (cid:12) (cid:1) 0 , 1 . The proof is a generalization of Theorem 1 of Imai , Keele , and Yamamoto ( 2010 ) and thus is omitted . Theorem 1 shows that under sequential ignorability , the distribution of the required potential out - come ( i . e . , the quantity in the left - hand side of the equation ) can be expressed as a function of the distributions of the observed data , that is , the conditional distribution of M i given ( T i , X i ) and that of Y i given ( M i , T i , X i ) . Thus , the assumption lets us make inferences about the counterfactual quantities we do not observe ( i . e . , the potential out - comes and mediators of workers in the opposite treatment status ) using the quantities we do observe ( i . e . , observed outcomes and mediators for workers in a particular treatment status ) . As we show next , in the LSEM framework , for example , these conditional distri - butions are given by a set of the linear regression models . Because Theorem 1 is not based on any speciﬁc model , however , it enables us to develop a general estimation procedure for causal mediation effects under various nonlinear conditions . Causal Interpretation of the Product of Coefﬁcients and Related Methods Before turning to our general method , we show that the potential outcomes framework encompasses the standard mediation analysis based on the single mediator LSEM as a special case . For illus - tration , consider the following set of linear equations : Y i (cid:2) (cid:14) 1 (cid:3) (cid:15) 1 T i (cid:3) (cid:16) 1 (cid:2) X i (cid:3) ε i 1 , ( 5 ) M i (cid:2) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:16) 2 (cid:2) X i (cid:3) ε i 2 , ( 6 ) Y i (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) X i (cid:3) ε i 3 . ( 7 ) After ﬁtting each linear equation via least squares , the product of coefﬁcients method uses (cid:15) ˆ 2 (cid:17) ˆ as an estimated mediation effect ( MacKinnon et al . , 2002 ) . Similarly , the difference of coefﬁcient methods yields the numerically identical estimate by computing (cid:15) ˆ 1 (cid:2) (cid:15) ˆ 3 in this linear case ( MacKinnon et al . , 2007 , 2002 ) . Because (cid:15) ˆ 1 (cid:1) (cid:15) ˆ 2 (cid:17) ˆ (cid:11) (cid:15) ˆ 3 and (cid:15) 1 (cid:1) (cid:15) 2 (cid:17) (cid:11) (cid:15) 3 always holds , Equation 5 is redundant given Equations 6 and 7 . Does the product of coefﬁcients method yield a valid estimate for the causal mediation effect under the potential outcomes frame - work ? Imai , Keele , and Yamamoto ( 2010 ) prove that under se - quential ignorability and the additional no - interaction assumption , that is , (cid:6) (cid:1) ( 1 ) (cid:1) (cid:6) (cid:1) ( 0 ) , the estimate based on the product of coefﬁ - cients method can be interpreted as a valid estimate ( i . e . , asymp - 5 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 totically consistent ) of the causal mediation effect as long as the linearity assumption holds ( see also Jo , 2008 ) . To understand the connection between the product of coefﬁcients method and the causal mediation effect deﬁned earlier , we ﬁrst write each potential outcome within the LSEM framework : Y i (cid:3) T i , M i (cid:3) T i (cid:4)(cid:4) (cid:2) (cid:14) 1 (cid:3) (cid:15) 1 T i (cid:3) (cid:16) 1 (cid:2) X i (cid:3) ε i 1 (cid:3) T i , M i (cid:3) T i (cid:4)(cid:4) , M i (cid:3) T i (cid:4) (cid:2) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:16) 2 (cid:2) X i (cid:3) ε i 2 (cid:3) T i (cid:4) , Y i (cid:3) T i , M i (cid:3) T i (cid:4)(cid:4) (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) X i (cid:3) ε i 3 (cid:3) T i , M i (cid:3) T i (cid:4)(cid:4) . An argument that is nearly identical to the proof of Theorem 2 in Imai , Keele , and Yamamoto shows that under Assumption 1 the average causal mediation and direct effects are identiﬁed as (cid:6) (cid:1) ( t ) (cid:1) (cid:15) 2 (cid:17) and (cid:7) (cid:1) ( t ) (cid:1) (cid:15) 3 , respectively , for t (cid:1) 0 , 1 . 4 Thus , as long as an analyst is willing to adopt the linearity and no - interaction assumptions along with sequential ignorability , the product of coefﬁcients method provides a valid estimate of the causal mediation effect . However , Theorem 1 implies that only the sequential ignorability assumption is needed and neither the linearity nor the no - interaction assumption is required for the identiﬁcation of causal mediation effects . To illustrate this point , we next explore relaxing the no - interaction assumption . Relaxing the No - Interaction Assumption Judd and Kenny ( 1981 ) , and more recently Kraemer and col - leagues ( Kraemer , Kiernan , Essex , & Kupfer , 2008 ; Kraemer , Wilson , Fairburn , and Agras , 2002 ) , proposed an alternative to the standard product of coefﬁcients method by relaxing the no - inter - action assumption . They argued that assuming no interaction be - tween the treatment and the mediator is often unrealistic and replaced Equation 7 with the following alternative speciﬁcation : Y i (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:18) T i M i (cid:3) (cid:16) 3 (cid:2) X i (cid:3) ε i 3 . ( 8 ) Such an interaction might arise in the JOBS II study if , for example , the average mediation effect via the improvement of the workers’ mental health depends on whether they receive the job training program . Kraemer et al . ( 2008 ) argued that in addition to (cid:15) ˆ 2 , either (cid:17) ˆ or (cid:18) ˆ must be statistically indistinguishable from zero in order to conclude that average mediation effects exist . Although the inclusion of the interaction term , T i M i , is a rea - sonable suggestion , the proposed procedure can be improved so that the hypothesis test is conducted directly on the average causal mediation effects . Following Imai , Keele , and Yamamoto ( 2010 ) , one can show that under Assumption 1 , the average causal medi - ation effects are given by (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:15) 2 (cid:3)(cid:17) (cid:3) (cid:18) t (cid:4) , ( 9 ) for t (cid:1) 0 , 1 . Estimation of this quantity in the JOBS II example would give different mediation effects , taking into account an interaction between program participation and job search self - efﬁ - cacy . In addition , the average direct and total effects are given by (cid:7) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:15) 3 (cid:3) (cid:18)(cid:9)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) (cid:1) (cid:3) X i (cid:4)(cid:10) , ( 10 ) (cid:8) (cid:1) (cid:2) (cid:15) 2 (cid:17) (cid:3) (cid:15) 3 (cid:3) (cid:18)(cid:9)(cid:14) 2 (cid:3) (cid:15) 2 (cid:3) (cid:16) 2 (cid:2) (cid:1) (cid:3) X i (cid:4)(cid:10) , ( 11 ) for t (cid:1) 0 , 1 . The consistent estimates of (cid:7) (cid:1) ( t ) and (cid:8) (cid:1) can be obtained by replacing the coefﬁcients of Equations 10 and 11 with their least squares estimates and (cid:1) ( X i ) by the sample average of X i , which we denote by X (cid:1) . 5 In Appendix A , we derive the asymptotic variance for each of these quantities of interest . Although analysts can easily relax the no - interaction assump - tion , extending the LSEM mediation framework to models for discrete outcomes , for example , is much more difﬁcult . In contrast , as we demonstrate later , our general approach can handle nonlinear models such as logit and probit in a straightforward manner . Relationship With Instrumental Variables Recently , some scholars have considered the use of instrumental variables for causal mediation analysis ( e . g . , Albert , 2008 ; Jo , 2008 ; Sobel , 2008 ) . Using instrumental variables to estimate causal mediation effects requires an alternative set of identiﬁcation assumptions , which differ from Assumption 1 in important ways . In particular , although the existence of unobserved confounders is allowed , the direct effect is assumed to be zero ( see Appendix B for details ) . This means that the instrumental variables approach eliminates , a priori , alternative causal mechanisms . For this reason , we believe that it is less than ideal for the causal mediation analysis used in social science research . A more general and promising approach is the causal mediation analysis based on principal stratiﬁcation ( e . g . , Gallop et al . , 2009 ) . An Application to JOBS II We illustrate the product of coefﬁcients method and related approaches using the JOBS II data . Here the outcome variable is a measure of depression and the mediator is the level of worker’s job search self - efﬁcacy . Both measures range from one to ﬁve . To make sequential ignorability more credible , we include the full set of covariates described in the outline of JOBS II . Table 1 presents the estimated quantities of interest based on the product of coef - ﬁcients and instrumental variables methods . First , we use the standard product of coefﬁcients method , assuming no interaction between the mediator and the treatment . We ﬁnd a small ( but statistically signiﬁcant at the 95 % level ) negative mediation effect ( the ﬁrst column ) . Because the average treatment effect on the mediator is negative , the results imply that the program participa - tion on average decreases slightly the depressive symptoms by increasing the level of job search self - efﬁcacy . The average direct and total effects are estimated to be negative as well , and their effect sizes are larger . However , these estimates are statistically indistinguishable from zero . Next , we relax the no - interaction assumption by allowing the average causal mediation effect to depend on the treatment status . The second and third columns of the table present the results . The basic ﬁndings resemble the ones based on the standard product of coefﬁcients method , and there is little evidence for the presence of 4 The average total effect is given by (cid:15) 1 , which equals (cid:15) 2 (cid:17) (cid:11) (cid:15) 3 . 5 To estimate the average total effect , we may ﬁt the following model , Y i (cid:2) (cid:14) 1 (cid:3) (cid:15) 1 T i (cid:3) (cid:16) 1 (cid:2) X i (cid:3) (cid:19) (cid:2) T i X i (cid:3) ε i 1 , where the average total effect is given by (cid:8) (cid:1) (cid:2) (cid:15) 1 (cid:3) (cid:19) (cid:2) (cid:1) (cid:3) X i (cid:4) . 6 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn4 Fn5 T1 the interaction effects . Although these calculations were done with the formulas described in the previous sections , the simulation approach to estimation described subsequently and implemented in our software returns nearly identical results . This correspondence is important because it shows how our approach encompasses the product of coefﬁcients method as a special case . In later sections , we extend our approach to nonlinear models . Finally , we apply the instrumental variables method , though the assumption of no direct effect is unlikely to hold in this application . Under this method , the average mediation effect equals the average total effect . Thus , the results are somewhat different from those based on the other two methods ; the average causal mediation effect is estimated to be negative but is not statistically signiﬁcantly different from zero . Sensitivity Analysis We now turn to the ﬁnal and important component of our approach . One advantage of the potential outcomes framework is that it helps to clarify the role of key identiﬁcation assumptions . As we demonstrated above , randomization of the treatment alone does not identify causal mediation effects . This means that even in randomized experiments , an additional assumption ( e . g . , sequen - tial ignorability in our approach ) is required for identiﬁcation . As such , this assumption is of particular interest , because if it is not satisﬁed , the estimated quantity cannot be given a causal interpre - tation . In particular , the second part of Assumption 1 is nonrefut - able in the sense that it cannot be directly tested with the observed data . As in many applications , it is reasonable to think that the sequential ignorability may have been violated in the JOBS II study . For example , Jo ( 2008 ) pointed out that the second part of Assumption 1 might be violated by stating that “individuals who improved their sense of mastery by one point in the intervention program may have different observed and unobserved character - istics from those of individuals who equally improved their sense of mastery in the control condition” ( p . 317 ) . Sensitivity analysis is an effective method for probing the plau - sibility of a nonrefutable assumption and thus is an important element of our approach . The goal of sensitivity analysis is to quantify the degree to which the key identiﬁcation assumption must be violated for a researcher’s original conclusion to be reversed . If an inference is sensitive , a slight violation of the assumption may lead to substantively different conclusions . The degree of sensitivity can be calibrated either in comparison to other studies ( Rosenbaum , 2002 , p . 325 ) or in conjunction with expert opinion ( e . g . , White , Carpenter , Evans , & Schroter , 2007 ) . Given the importance of sequential ignorability , we argue that a media - tion analysis is not complete without a sensitivity analysis . Our software , mediation , also allows users to conduct sensitivity anal - yses with only a single additional line of syntax , as illustrated in Imai et al . ( 2010a ) . The Linear Structural Equation Models In the context of the standard LSEM framework , Imai , Keele , and Yamamoto ( 2010 ) proposed a sensitivity analysis for causal mediation analysis based on the correlation between the error for the mediation model , (cid:20) i 2 , and the error for the outcome model , (cid:20) i 3 . They denoted this correlation across the two error terms as (cid:21) , which serves as the sensitivity parameter . Such a correlation can arise if there exist omitted variables that affect both mediator and outcome variables because these omitted variables will be part of the two error terms . Thus , under sequential ignorability , (cid:21) equals zero , and nonzero values of (cid:21) imply departures from the ignor - ability assumption . Imai et al . showed that it is possible to express the average causal mediation effect as a function of (cid:21) and model parameters that can be consistently estimated even though (cid:21) is nonzero . With this fact , the proposed sensitivity analysis asks the ques - tion of how large does (cid:21) have to be for the causal mediation effect to go away . If small departures from zero in (cid:21) produce an average causal mediation effect that is substantively different from the estimate obtained under sequential ignorability , this suggests that the study is sensitive to the potential violation of the sequential ignorability assumption . Moreover , we can also observe whether Table 1 Estimated Causal Effects of Interest Based on the Product of Coefﬁcients and Instrumental Variables Methods Using the Job Search Intervention Study Data Averageeffect Product of coefﬁcients Instrumentalvariable No interaction With interaction Under treatment ( t (cid:1) 1 ) Under control ( t (cid:1) 0 ) Mediation (cid:2) . 016 (cid:2) . 014 (cid:2) . 021 (cid:2) . 047 (cid:6) (cid:1) ( t ) [ (cid:2) . 03 , (cid:2) . 002 ] [ (cid:2) . 026 , (cid:2) . 001 ] [ (cid:2) . 040 , (cid:2) . 002 ] [ (cid:2) . 120 , . 024 ] Direct (cid:2) . 032 (cid:2) . 027 (cid:2) . 034 . 000 a (cid:7) (cid:1) ( t ) [ (cid:2) . 107 , . 046 ] [ (cid:2) . 115 , . 048 ] [ (cid:2) . 114 , . 046 ] Total (cid:2) . 047 (cid:2) . 047 (cid:2) . 047 (cid:8) (cid:1) [ (cid:2) . 120 , . 023 ] [ (cid:2) . 120 , . 024 ] [ (cid:2) . 120 , . 023 ] Note . The outcome variable is a measure of depression for each worker , and the mediator represents the level of workers’ job search self - efﬁcacy . Each cell shows a point estimate and its corresponding 95 % conﬁdence intervals . The average treatment effect on the mediator is estimated to be . 100 with the 95 % conﬁdence interval [ . 018 , . 182 ] ( based on the delta method ) . The results in Columns 2 – 4 are based on the product of coefﬁcients method without and with the interaction between the treatment and the mediator . a Assumed to be zero . 7 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 the conﬁdence interval for the mediation effect contains zero , which provides a more nuanced analysis . Here we extend the result in Imai , Keele , and Yamamoto ( 2010 ) to the LSEM with the no - interaction assumption relaxed . As such , we derive the mediation effect as a function of (cid:21) and other quantities that can be consistently estimated . Theorem 2 ( Identiﬁcation With a Given Error Correlation ) : Consider the LSEM deﬁned in Equations 6 and 8 . Suppose that Equation 3 of Assumption 1 holds but Equation 4 may not . Assume that the correlation between (cid:20) 2 i and (cid:20) 3 i , that is , (cid:21) , is given ( and is assumed to be constant across the treatment and control groups ) where (cid:2) 1 (cid:13) (cid:21) (cid:13) 1 . Then , the average causal mediation effects are identiﬁed and given by (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:15) 2 (cid:22) 1 t (cid:22) 2 t (cid:5) (cid:21) ˜ t (cid:1) (cid:21) (cid:6) (cid:3) 1 (cid:1) (cid:21) ˜ t 2 (cid:4) / (cid:3) 1 (cid:1) (cid:21) 2 (cid:4) (cid:7) , where (cid:22) jt 2 (cid:23) Var ( (cid:20) ij (cid:1) T i (cid:1) t ) and (cid:21) ˜ t (cid:23) Corr ( (cid:20) i 1 , (cid:20) i 2 (cid:1) T i (cid:1) t ) for j (cid:1) 1 , 2 and t (cid:1) 0 , 1 . A proof is given in Appendix C . Theorem 2 establishes the linkage between the average causal mediation effect and the degree of correlation of the two error terms given the identiﬁable model parameters . 6 The iterative procedure described in Imai , Keele , and Yamamoto ( 2010 ) can be used to obtain the conﬁdence intervals under various values of (cid:21) . 7 How small is small enough for researchers to conclude the resulting conclusion is valid ? Unfortunately , there is no absolute threshold . In principle , the magnitude of (cid:21) from one study can be interpreted only relative to the corresponding (cid:21) of another study . However , Imai , Keele , and Yamamoto ( 2010 ) showed that the magnitude of (cid:21) from one study can be interpreted independently via the coefﬁcients of determination , or R 2 . This alternative pa - rameterization facilitates the interpretation because one can under - stand the inﬂuence of potential omitted variables in terms of its explanatory power . We discuss and extend this alternative param - eterization later in this article in the context of nonlinear models . Empirical Illustration We return to the example with continuous outcome and medi - ator measures and ask whether the ﬁnding is sensitive to a potential violation of sequential ignorability . Here we relax the no - interac - tion assumption for the sensitivity analysis . We ﬁnd (cid:6) (cid:1) ( 1 ) (cid:1) 0 when (cid:21) is equal to (cid:2) . 165 and (cid:6) (cid:1) ( 0 ) (cid:1) 0 when (cid:21) is (cid:2) . 245 . Figure 1 graphically illustrates this point by plotting the estimated average mediation effects and their 95 % conﬁdence intervals as a function of (cid:21) . We ﬁnd that for (cid:6) (cid:1) ( 0 ) the conﬁdence intervals include zero for a (cid:21) value of (cid:2) . 09 and for (cid:6) (cid:1) ( 1 ) at (cid:2) . 06 , which further underscores the sensitivity of the estimate . Imai , Keele , and Yamamoto ( 2010 ) found in another study that the mediation effects are zero for a (cid:21) value of . 48 . Thus , the estimated mediation effects here are con - siderably more sensitive than in that study . This means that it would take a smaller unobserved confounder to overturn the con - clusion obtained under sequential ignorability for the JOBS II study . Generalization to Nonlinear Models In this section , we show that the above methodology can be generalized to nonlinear models . The difﬁculty with the LSEM approach is that it does not readily extend to nonlinear models . For example , suppose that in the JOBS II study the outcome variable of interest is a binary measure about whether a subject is employed or not . The LSEM approach using the product of coefﬁcients no longer generalizes in a straightforward way if researchers wish to use the logistic regression to model the outcome variable . As we demonstrate below , our generalization can accommodate linear and nonlinear relationships , parametric and nonparametric models , continuous and discrete mediators , and various types of outcome variables ( for related methods , see Glynn , 2008 ; Huang , Sivaganesan , Succop , & Goodman , 2004 ; VanderWeele , 2009 ; Wang & Taylor , 2002 ) . This is possible because our methodology is not tied to speciﬁc statistical models . Using the nonparametric identiﬁcation result of Theorem 1 , we ﬁrst develop two algorithms based on Monte Carlo simulation to estimate causal mediation effects that are applicable to any statistical models . We then demonstrate how these algorithms and sensitivity analysis can be applied to some frequently used nonlinear models . The Estimation Algorithms Recall that for each subject we observe Y i ( T i , M i ( T i ) ) but we need to infer the following counterfactual quantity : Y i ( T i , M i ( 1 (cid:2) T i ) ) . Theorem 1 suggests that researchers can obtain one Monte Carlo draw of the potential outcome Y i ( t , M i ( t (cid:12) ) ) for any t , t (cid:12) using model predictions given the subject’s pretreatment covariates X i (cid:1) x . To do this , we ﬁrst sample M i ( t (cid:12) ) from the selected mediator model , f ( M i (cid:1) T i (cid:1) t (cid:12) , X i (cid:1) x ) , and then given this draw of the mediator , sample Y i ( t , M i ( t (cid:12) ) ) from the outcome model , f ( Y i (cid:1) T i (cid:1) t , M i ( t (cid:12) ) , X i (cid:1) x ) . Our nonparametric identiﬁcation result implies that this procedure need not change regardless of statistical models used for the mediator and the outcome . Once we obtain these Monte Carlo draws of potential outcomes , we can compute the relevant quan - tities of interest that are functions of these potential outcomes . 8 This observation leads to the following two general algorithms that can accommodate many situations researchers encounter in practice . First , we describe an algorithm for parametric inference in which parametric models ( e . g . , probit or logit ) are speciﬁed for the mediator and the outcome variable . To make the exposition 6 Thus , for t (cid:1) 0 , 1 , (cid:6) (cid:1) ( t ) becomes zero when (cid:21) is equal to the correlation between (cid:20) i 1 and (cid:20) i 2 among those with T i (cid:1) t , which is denoted by (cid:21) ˜ t and can be estimated by the sample correlation of the corresponding residuals . 7 This use of residuals differs from the structural equation modeling tradition in that residuals are not being used to access the ﬁt of statistical models as discussed in Mulaik ( 2007 ) . Instead , they are used to assess the violation of the key identiﬁcation assumption . Although others have pointed to assumptions about residuals ( Bullock , Green , & Ha , 2010 ; MacKinnon et al . , 2002 ; Mulaik , 2009 ) and the consequences of omitted variables ( James et al . , 1982 , pp . 71 – 80 ) , to our knowledge these scholars propose no formal sensitivity analysis about the identifying assumption . See VanderWeele ( 2010 ) for an alternative approach . 8 This is true as long as they do not involve the joint distribution of Y i ( t , M i ( 1 ) ) and Y i ( t , M i ( 0 ) ) because only marginal distributions are iden - tiﬁed under sequential ignorability . 8 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn6 Fn7 F1 Fn8 concrete , we describe the algorithm to estimate the average causal mediation effects . The proposed algorithm is based on the quasi - Bayesian Monte Carlo approximation of King , Tomz , and Witten - berg ( 2000 ) , in which the posterior distribution of quantities of interest is approximated by their sampling distribution . A similar idea has been used for speciﬁc models ( see Bauer , Preacher , & Gil , 2006 ; MacKinnon , Lockwood , & Williams , 2004 ) . Our algorithm , in contrast , applies to any parametric statistical model of research - ers’ choice ( see below for an algorithm that can be applied to nonparametric models ) . Here we provide an outline of the algo - rithms ( their details are given in Appendix D ) . Algorithm 1 ( Parametric Inference ) : This algorithm can be used for any parametric model . Step 1 . Fit models for the observed outcome and mediator variables . Step 2 . Simulate model parameters from their sampling dis - tribution . Step 3 . Repeat the following three steps : ( a ) simulate the potential values of the mediator , ( b ) simulate the potential outcomes given the simulated values of the mediator , ( c ) compute the causal mediation effects . Step 4 . Compute summary statistics such as point estimates and conﬁdence intervals . The generality of this algorithm is attractive because the same algorithm can be applied to any parametric statistical model . This allows us to develop easy - to - use statistical software that computes point and uncertainty estimates under various statistical models . Imai et al . ( 2010a ) illustrated the use of this software with the exact syntax used to produce the empirical results of this article . In these examples , we ﬁnd that 1 , 000 simulations for each step ( the default number of simulations in the software ) are sufﬁcient . However , for other applications with a smaller data set and / or more complex models , a greater number of simulations may be required . Finally , our nonparametric identiﬁcation result also permits the use of more complex models such as non - or semiparametric models and quantile regression models . For these models , we propose using a nonparametric bootstrap procedure to obtain a distribution of causal mediation effects . Although this algo - rithm is applicable to parametric inference as well , Algorithm 1 is typically much more computationally efﬁcient . Each step of Algorithm 2 corresponds to that of Algorithm 1 . Again , we outline the proposed algorithm here and provide the details in Appendix D . Algorithm 2 ( Nonparametric Inference ) : The following algo - rithm is applicable to both parametric and nonparametric models . Step 1 . For each of the bootstrapped samples , repeat the following steps : ( a ) ﬁt models for the observed and mediator variables , ( b ) simulate the potential values of the mediator , ( c ) simulate the potential outcomes given the simulated values of the mediator , ( d ) compute the causal mediation effects . Step 2 . Compute summary statistics such as point estimates and conﬁdence intervals . We evaluate our algorithms using two sets of simulations with varying sample sizes . In one set of simulations , we use a popula - tion model in which the mediator has a nonlinear effect on the outcome . We then compare the performance of a semiparametric model with that of a linear model with and without a quadratic term of the mediator . In the other set of simulations , we consider −1 . 0 −0 . 5 0 . 0 0 . 5 1 . 0 − 0 . 2 − 0 . 1 0 . 0 0 . 1 0 . 2 Sensitivity Parameter : ρρ A v e r age M ed i a t i on E ff e c t : δ ( 0 ) −1 . 0 −0 . 5 0 . 0 0 . 5 1 . 0 − 0 . 2 − 0 . 1 0 . 0 0 . 1 0 . 2 Sensitivity Parameter : ρρ A v e r age M ed i a t i on E ff e c t : δ ( 1 ) A B Figure 1 . Sensitivity analysis with continuous outcome and mediator . Figure 1A is for the estimated average mediation effect under the control , and Figure 1B is for treatment . The dashed line represents the estimated mediation effect for (cid:21) (cid:1) 0 . The gray areas represent the 95 % conﬁdence interval for the mediation effects at each value of (cid:21) . The solid line represents the estimated average mediation effect at different values of (cid:21) . 9 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 the case in which the mediator is continuous but the outcome is binary . We examine the performance of the probit model against the product of coefﬁcients method . In both simulations , as ex - pected , we ﬁnd that our methods recover the population parameters with little bias . The results and details of the simulations are reported in Appendix E . Next , we illustrate how our methods can handle a variety of situations that often arise in causal mediation analysis by applying them to the JOBS II study . This helps illustrate the generality of our methods . We also show theoretically how our methods relate to the existing approaches in the literature . Quantile Causal Mediation Effects We have shown that the methods based on the LSEM frame - work provide the average causal mediation effects under sequen - tial ignorability . However , in some cases , researchers may be interested in distributional features of the outcome variable other than the average . In the JOBS II example , policymakers might be concerned about individuals with high levels of depression rather than those with the average level of depression . It might also be true that a few individuals respond to the intervention in dramatic fashion , making the average a poor description of how these individuals respond to the treatment . In such instances , quantile causal mediation effects , which represent the difference between a certain quantile ( e . g . , median ) of two relevant potential outcomes , may be of interest . 9 In this context , quantile regression allows for a convenient way to model the quantiles of the outcome distribution while adjusting for a variety of covariates ( Koenker , 2005 ) . Speciﬁcally , we re - place Equation 7 with the quantile regression model . The usual product of coefﬁcients method is not applicable here , but Algo - rithm 2 can be used . Using the JOBS II data , we examine whether the job training program directly affected subjects’ levels of depression and whether job search self - efﬁcacy mediated the relationship between the outcome and the treatment . Figure 2 presents the estimated quantile causal mediation and direct effects and their 95 % conﬁ - dence intervals under Algorithm 2 . Both direct and indirect effects in the ﬁgure are averaged over the observed pretreatment covari - ates included in the quantile regression models . Figure 2A dem - onstrates the effect of the intervention that occurs through the mediator job search self - efﬁcacy . Figure 2B shows how the inter - vention affects quantiles of depression directly . One can see that the magnitude of the estimated mediation effects increases slightly as one moves from lower to higher quantiles , but the change is small , implying that the effects are relatively constant across the distribution . In contrast , the estimated direct effects vary substan - tially across the quantiles , although the conﬁdence intervals are wide and always include zero . Nonparametric and Semiparametric Regressions In the LSEM framework , the estimation of the average causal mediation effects is based on a set of linear regressions . How might one relax the linearity assumption ? In the JOBS II study , the change in depression mediated by increased job search self - efﬁ - cacy may be very small among those with high levels of job search self - efﬁcacy . For these subjects , the program participation is un - likely to further increase the mediating effects because of a dimin - ishing effect of the treatment on the mediator . Conversely , medi - ation effects might be smallest among those with low job search skills , as they are unable to overcome societal and institutional thresholds that reinforce levels of depression . Instead of assuming linear relationships between variables , non - or semiparametric regressions may be used to avoid linear func - tional form assumptions ( e . g . , Keele , 2008 ) . These models attempt to recover the true relationship from the data while imposing much weaker functional form assumptions . Although one could use a quadratic term in the LSEM framework , it is well known that such transformation often provides a poor approximation in practice ( see the simulation in Appendix F ) . Moreover , the product of coefﬁcients method no longer applies to these and more complex situations . With Algorithm 2 , however , the analyst can use non - parametric or semiparametric regression models , and the causal mediation effects can be easily estimated . As an illustration , we allow the mediator to have a nonlinear effect on the outcome by applying a generalized additive model ( GAM ) to estimate the average causal mediation effects ( Hastie & Tibshirani , 1990 ) . We ﬁt the following regression equation instead of Equation 7 : Y i (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) s (cid:3) M i (cid:4) (cid:3) (cid:16) (cid:2) X i (cid:3) ε i 3 , ( 12 ) where s ( (cid:2) ) is a smooth and possibly nonlinear function that we estimate nonparametrically from the data ( e . g . , a spline ) . In the LSEM framework s ( (cid:2) ) is assumed to be a linear function . We also relax the no - interaction assumption by ﬁtting the following model , Y i (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) s 0 (cid:3) M i (cid:4)(cid:3) 1 (cid:1) T i (cid:4) (cid:3) s 1 (cid:3) M i (cid:4) T i (cid:3) (cid:16) (cid:2) X i (cid:3) ε i 3 , instead of Equation 8 . For the semiparametric regression model , we used the package mgcv in R ( Wood , 2006 ) . Figure 3 plots the estimated nonlinear relationship between the expected level of depression ( the average outcome ) and the level of job search self - efﬁcacy ( the mediator ) with and without the interaction between the treatment and the mediator . Figure 3A ( the no - interaction model ) shows that there is a mild threshold effect between job search self - efﬁcacy and depression . That is , self - efﬁcacy must exceed the midpoint of the scale before there is any attendant decrease in depression . Figures 3B and 3C plot the estimated nonlinear relationships for the control and treatment groups separately under the model with the interaction . For both groups , the estimation is somewhat imprecise but is consistent with Figures 3B and 3C in that there is a negative relationship at higher levels of the mediator . For the treatment group , the pattern closely mirrors that observed in the no - interaction model , though the width of the conﬁdence intervals must temper any decisive conclusions . Table 2 presents the estimated average causal mediation effects based on the GAM and Algorithm 2 with 10 , 000 bootstrap resa - mples . First , we assume no interaction between the mediator and the treatment . Under this model ( in the left column ) , we ﬁnd a 9 Formally , (cid:14) - quantile causal mediation effects are deﬁned as (cid:6) ˜ (cid:14) ( t ) (cid:23) q t 1 ( (cid:14) ) (cid:2) q t 0 ( (cid:14) ) , for t (cid:1) 0 , 1 and 0 (cid:13) (cid:14) (cid:13) 1 , where q tt (cid:12) ( (cid:14) ) (cid:23) inf { y ; F ( Y i ( t , M i ( t (cid:12) ) ) (cid:4) y ) (cid:5) (cid:14) } is the quantile function for the distribution of Y i ( t , M i ( t (cid:12) ) ) . Similarly , we can deﬁne quantile direct and total effects as (cid:7) ˜ (cid:14) ( t ) (cid:23) q 1 t ( (cid:14) ) (cid:2) q 0 t ( (cid:14) ) . 10 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn9 F2 F3 T2 small , but statistically signiﬁcant , negative mediation effect . This effect is estimated to be slightly larger in magnitude compared with that in Table 1 , though the difference is not statistically signiﬁcant . The second and third columns of the table present the results without the no - interaction assumption . As in Table 1 , the difference between the mediation effect for the treatment and control groups is small and is not statistically signiﬁcant . Finally , as in Table 1 , the estimated average direct and total effects for each speciﬁcation are not statistically distinguishable from zero . In general , we ﬁnd that modeling nonlinearity in the relationship does little to change our inference with the JOBS data , but the larger point is that Algorithm 2 allows us to relax basic model assump - tions and still produce well - deﬁned direct , mediation , and total effects under sequential ignorability . Discrete Mediator Next , consider the situation in which the mediator is discrete—a common occurrence for many applications in psychology in which the measure for the mediator is often an ordered scale or binary . In this case , Algorithm 1 can be simpliﬁed . 10 Modeling the mediator with either a probit – logit or ordered probit – logit model allows for straight - forward parametric adjustment of pretreatment covariates . With these models , the proposed algorithms will provide the estimates of the average causal mediation effects and their estimation uncertainty . This is an important area of application because discrete and binary measures are extremely common , and yet the standard methods based on the LSEM framework are not directly applicable . We demonstrate the ﬂexibility of Algorithm 1 using the JOBS II data . The mediating variable in the original study , job search self - efﬁcacy , is a continuous scale , as we noted previously . For demonstration purposes , we recoded the worker’s job search self - efﬁcacy into two discrete measures . In the ﬁrst measure , we recoded the measure to be binary by splitting responses at the sample median . In a second measure , we recoded the scale to be a four - category ordered variable . Otherwise , we use the same set of variables as in Table 1 . Here we perform two analyses . In the ﬁrst , we model the binary mediator with a probit model and estimate the average causal mediation effects with and without the no - interaction assumption . Table 3 presents the results that are largely consistent with the prior analysis when the mediator was measured with a continuous scale . One can see that the treatment decreased depression by increasing job search self - efﬁcacy , but it had little direct causal effect . One can also see little differences in the average causal mediation effect across treatment status . 11 Next , we use the four - category measure for the mediator and ﬁt an ordered probit model for the mediator . Table 4 presents the 10 First note that in this case Theorem 1 reduces to h ( Y i ( t , M i ( t (cid:12) ) ) (cid:1) X i (cid:1) x ) (cid:1) (cid:3) m (cid:1) (cid:2) g ( Y i (cid:1) M i (cid:1) m , T i (cid:1) t , X i (cid:1) x ) Pr ( M i (cid:1) m (cid:1) T i (cid:1) t (cid:12) , X i (cid:1) x ) . When the mediator is binary and the quantity of interest is the average causal mediation effect , the equation simpliﬁes further to (cid:6) (cid:1) ( t ) (cid:1) (cid:9) (cid:1) (cid:3) Y i (cid:1) M i (cid:2) 1 , T i (cid:2) t (cid:4) (cid:1) (cid:1) (cid:3) Y i (cid:1) M i (cid:2) 0 , T i (cid:2) t (cid:4)(cid:10) { Pr ( M i (cid:1) 1 (cid:1) T i (cid:1) 1 ) (cid:2) Pr ( M i (cid:1) 1 (cid:1) T i (cid:1) 0 ) } , which equals the expression derived by Li et al . ( 2007 ) . If the support of the mediator distribution , (cid:2) , is bounded , then Step 3 of Algorithm 1 can be done with the following single calculation : For each j (cid:1) 1 , 2 , . . . , J draw from the model sampling distributions , compute (cid:6) (cid:1) (cid:3) j (cid:4) (cid:3) t (cid:4) (cid:2) 1 n (cid:3) i (cid:1) 1 n (cid:3) m (cid:1) (cid:2) (cid:1) (cid:3) j (cid:4) (cid:3) Y i (cid:1) t , m , X i (cid:4) (cid:6) (cid:9) f (cid:3) j (cid:4) (cid:3) M i (cid:2) m (cid:1) T i (cid:2) 1 , X i (cid:4) (cid:1) f (cid:3) j (cid:4) (cid:3) M i (cid:2) m (cid:1) T i (cid:2) 0 , X i (cid:4)(cid:10) . Thus , we can complete Step 3 without sampling either M i ( t ) or Y i ( t , M i ( t (cid:12) ) ) . 11 Nonlinear models with no interaction term can produce numerical estimates that differ for (cid:6) (cid:1) ( 0 ) and (cid:6) (cid:1) ( 1 ) due to the nonlinear link function . For simplicity we report (cid:6) (cid:1) ( 1 ) for these models . 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 − 0 . 2 − 0 . 1 0 . 0 0 . 1 0 . 2 Quantile M ed i a t i on E ff e c t Quantile Mediation Effects 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 − 0 . 2 − 0 . 1 0 . 0 0 . 1 0 . 2 Quantile D i r e c t E ff e c t Quantile Direct Effects A B Figure 2 . Estimated quantile causal mediation and direct effects based on the JOBS II data . The outcome variable is a measure of depression for each worker , and the mediator represents the level of workers’ job search self - efﬁcacy . The ﬁgure presents the estimated quantile mediation effect ( A ) and the estimated quantile direct effect ( B ) , along with 95 % conﬁdence intervals . The quantile mediation effects are estimated to be negative and statistically signiﬁcant , whereas the quantile direct effects have much wider conﬁdence intervals . 11 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn10 T3 Fn11 T4 results . First , we assume no interaction between the mediator and the treatment . In line with the results given in Table 1 , there is a small negative average mediation effect . We also relax the no - interaction assumption by including an interaction term , T i M i , in the outcome regression model . The second and third columns of the table present the results . As before , there is little evidence of an interaction effect . We have shown that altering the model for the mediator presents no complications for Algorithm 1 , which en - ables the estimation of the quantities of interest and provides estimates of statistical uncertainty . Binary Outcome One situation that has attracted the attention of many researchers is the case with the binary outcome and the continuous mediator . Many approaches have been proposed for such situations ( e . g . , Ditlevsen , Christensen , Lynch , Damsgaard , & Keiding , 2005 ; Freedman , Graubard , & Schatzkin , 1992 ; MacKinnon , 2008 ; MacKinnon et al . , 2007 , 2002 ; Wang & Taylor , 2002 ) . One im - portant criticism of existing methods is that they lack a causal interpretation ( Kaufman , MacLehose , Kaufman , & Greenland , 2005 ) . Here we derive analytical expressions for causal mediation effects when the outcome is binary . We show that our general approach can easily accommodate binary outcomes and examine the exact relationship between our proposed method and some of the existing approaches . Analytical expressions for the average causal mediation ef - fects . For the sake of notational and algebraic simplicity , we consider the following simple model without the pretreatment confounders . In Appendix F , we show that all our analytical results will hold for the model with the observed pretreatment covariates with some notational complexity . The model is given by Table 2 Estimated Causal Quantities of Interest Based on the Generalized Additive Model Averageeffect No interaction With interaction Under treatment ( t (cid:1) 1 ) Under control ( t (cid:1) 0 ) Mediation (cid:2) . 022 (cid:2) . 021 (cid:2) . 025 (cid:6) (cid:1) ( t ) [ (cid:2) . 041 , (cid:2) . 004 ] [ (cid:2) . 042 , (cid:2) . 004 ] [ (cid:2) . 048 , (cid:2) . 004 ] Direct (cid:2) . 022 (cid:2) . 012 (cid:2) . 015 (cid:7) (cid:1) ( t ) [ (cid:2) . 093 , . 048 ] [ (cid:2) . 081 , . 058 ] [ (cid:2) . 085 , . 055 ] Total (cid:2) . 044 (cid:2) . 037 (cid:8) (cid:1) [ (cid:2) . 116 , . 028 ] [ (cid:2) . 111 , . 036 ] Note . The setup is identical to that of Table 1 except that the generalized additive model is used to model the outcome variable . Ninety - ﬁve percent conﬁdence intervals are based on nonparametric bootstrap . The second column displays the results under the no - interaction assumption , whereas the third and fourth columns display the results without this assumption . Table 3 Estimated Causal Quantities of Interest With the Binary Mediator Averageeffect No interaction With interaction Under treatment ( t (cid:1) 1 ) Under control ( t (cid:1) 0 ) Mediation (cid:2) . 019 (cid:2) . 019 (cid:2) . 018 (cid:6) (cid:1) ( t ) [ (cid:2) . 033 , (cid:2) 0 . 007 ] [ (cid:2) . 035 , (cid:2) . 006 ] [ (cid:2) . 027 , (cid:2) . 005 ] Direct (cid:2) . 026 (cid:2) . 031 (cid:2) . 029 (cid:7) (cid:1) ( t ) [ (cid:2) . 098 , . 045 ] [ (cid:2) . 096 , . 040 ] [ (cid:2) . 099 , (cid:2) . 039 ] Total (cid:2) . 045 (cid:2) . 048 (cid:8) (cid:1) [ (cid:2) . 117 , . 027 ] [ (cid:2) . 118 , . 022 ] Note . The setup is identical to that of Table 1 except that a probit model is used to model the mediator . Ninety - ﬁve percent conﬁdence intervals are based on Algorithm 1 with 1 , 000 Monte Carlo draws . The second column displays the results under the no - interaction assumption , whereas the third and fourth columns display the results without this assumption . 1 2 3 4 5 − 1 0 1 2 3 All Observations Job−search Self−efficacy ( M ) E x pe c t ed Le v e l o f D ep r e ss i on s ( M ) No Interaction 1 2 3 4 5 − 1 0 1 2 3 Control Group Job−search Self−efficacy ( M ) s 0 With Interaction 1 2 3 4 5 − 1 0 1 2 3 Treatment Group Job−search Self−efficacy ( M ) s 1 A B C Figure 3 . Generalized additive models and estimated nonlinear relationships between the mediator ( job search self - efﬁcacy ) and the outcome ( depression level ) . Figure 3A assumes no interaction between the treatment and the mediator , whereas Figures 3B and 3C allow for the interaction . The solid lines represent the estimated nonlinear relationships between the mediator ( the horizontal axis ) and the expected outcome ( the vertical axis ) . Ninety - ﬁve percent conﬁdence intervals ( dashed lines ) are based on nonparametric bootstrap . With the no - interaction assumption , changes in job search self - efﬁcacy at lower levels have little effect on depression , though these effects are imprecisely estimated . Changes in the mediator have a negative effect at higher levels and are precisely estimated . When the interaction is allowed , the effect of the mediator is steadily decreasing in the control group , whereas for the treatment group the effect stays relatively constant . 12 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 M i (cid:2) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:20) 2 i , ( 13 ) Y i (cid:2) 1 (cid:9) Y i (cid:3) (cid:7) 0 (cid:10) where Y i (cid:3) (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:20) 3 i , ( 14 ) where (cid:20) 2 i and (cid:20) 3 i are independently and identically distributed ( i . i . d . ) random variables with zero mean and Var ( (cid:20) 2 i ) (cid:1) (cid:22) 2 2 and Var ( (cid:20) 3 i ) (cid:1) (cid:22) 3 2 . The observed outcome variable Y i is equal to 1 or 0 depending on whether the value of the latent variable Y i (cid:3) is greater than zero . Note that under Assumption 1 , we have the independence between two error terms . If (cid:20) 2 i is an i . i . d . standard normal ( logistic ) random variate , then the model for the outcome variable is a probit ( logistic ) regression . Although a more compli - cated model ( such as a model with interactions and a nonparamet - ric model ) is easily used within our general framework , this simple model establishes the clear relationship between our approach and the existing methods . Here we focus on the estimation of the average causal me - diation effects and brieﬂy state the analytical results for the interested reader . The important point is that our general ap - proach readily incorporates the calculation of causal mediation effects with binary outcome variables . Given the above model and Assumption 1 , we can derive the analytical expression for the average causal mediation effects ( see Appendix F for a proof ) . The functional form differs , depending on whether a probit or logit model is ﬁtted to the outcome measure . This is due to the fact that different nonlinear link functions are used in each of these models . First , consider a logit model . This implies that (cid:20) 3 i is an i . i . d . logistic random variable and ε 2 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) . The average causal mediation effects can be written as (cid:6) (cid:1) (cid:3) t ) (cid:1) H ( (cid:14) 3 (cid:11) (cid:15) 3 t (cid:11) (cid:17) ( (cid:14) 2 (cid:11) (cid:15) 2 ) ) (cid:2) H ( (cid:14) 3 (cid:11) (cid:15) 3 t (cid:11) (cid:17)(cid:14) 2 ) , ( 15 ) where H ( (cid:2) ) represents the following distribution function for (cid:20) 1 i (cid:1) (cid:17)(cid:20) 2 i (cid:11) (cid:20) 3 i : H (cid:3) ε 1 i (cid:4) (cid:2) (cid:4) (cid:2)(cid:24) (cid:24) (cid:25) (cid:9) ε 1 i (cid:1) ε 3 i (cid:17)(cid:22) (cid:10) exp (cid:3) ε 3 i (cid:4) (cid:9) 1 (cid:3) exp (cid:3) ε 3 i (cid:4)(cid:10) 2 d ε 3 i . This quantity can be computed with a standard numerical integra - tion technique . The average total effect , on the other hand , equals (cid:8) (cid:1) (cid:1) H ( (cid:14) 3 (cid:11) (cid:15) 3 (cid:11) (cid:17) ( (cid:14) 2 (cid:11) (cid:15) 2 ) ) (cid:2) H ( (cid:14) 3 (cid:11) (cid:17)(cid:14) 2 ) . Next , suppose a probit model is used for the outcome variable and hence ε 3 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) and ε 2 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) . Then , a similar calcu - lation yields (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:25) (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) (cid:1) (cid:25) (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17)(cid:14) 2 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) , ( 16 ) for t (cid:1) 0 , 1 and where (cid:25) ( (cid:2) ) represents the standard normal cumulative density function . As in the LSEM case , we obtain the average total effect by ﬁtting the probit model , Pr (cid:3) Y i (cid:2) 1 (cid:1) T i (cid:4) (cid:2) (cid:25)(cid:3)(cid:14) 1 (cid:3) (cid:15) 1 T i (cid:4) , ( 17 ) where (cid:14) 1 (cid:2) (cid:3)(cid:14) 3 (cid:3) (cid:17)(cid:14) 2 (cid:4) / (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 and (cid:15) 1 (cid:2) (cid:3)(cid:17)(cid:15) 2 (cid:3) (cid:15) 3 (cid:4) / (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 . Then , the average total effect is given by (cid:8) (cid:1) (cid:1) (cid:25) ( (cid:14) 1 (cid:11) (cid:15) 1 ) (cid:2) (cid:25) ( (cid:14) 1 ) . Analytical investigation of the relationship with the existing methods . Currently , there are two commonly used methods for computing average mediation effects with binary outcomes . First , Freedman et al . ( 1992 ) suggested the difference of coefﬁcients method , which is based on the difference between (cid:15) 1 from Equa - tion 17 and (cid:15) 3 from Equation 14 . Second , MacKinnon et al . ( 2007 ) advocated the product of coefﬁcients method in which the (cid:17) parameter from Equation 14 is multiplied by (cid:15) 2 from Equation 13 . There exist SPSS and SAS macros ( SOBEL and INDIRECT ) that implement the product of coefﬁcients method for the binary out - come . Unfortunately , as MacKinnon et al . ( 2007 ) correctly pointed out , because probit and logistic regressions are nonlinear models , the difference of coefﬁcients and product of coefﬁcients methods give different estimates . Indeed , the nonlinearity of those models im - plies that unlike in the case of the LSEM , neither of the two methods consistently estimates the average causal mediation ef - fects given in Equations 15 and 16 . In Appendix E , we show via a simulation study that the bias of product of coefﬁcients method can be substantial in certain situations . This illustrates the impor - tant advantage of our proposed approach over the existing meth - ods . Proportion mediated . Another quantity of interest consid - ered in the literature is the proportion mediated , or the magnitude of the average causal mediation effects relative to the average total effect . Using our notation , we can deﬁne this quantity as (cid:26) (cid:2) (cid:9)(cid:6) (cid:1) (cid:3) 0 (cid:4) (cid:3) (cid:6) (cid:1) (cid:3) 1 (cid:4)(cid:10) / 2 (cid:8) , ( 18 ) which is the average causal mediation effect divided by the average total effect . Clearly , this quantity makes sense only when the sign of the sum of the two average causal mediation effects ( i . e . , the numerator ) is the same as the sign of the average total effect ( i . e . , the denominator ) . In the literature , the following measure of the proportion mediated has been pro - posed ( e . g . , Ditlevsen et al . , 2005 ; Freedman & Graubard , 1992 ; MacKinnon et al . , 2007 ) : Table 4 Estimated Causal Quantities of Interest With the Discrete Mediator Averageeffect No interaction With interaction Under treatment ( t (cid:1) 1 ) Under control ( t (cid:1) 0 ) Mediation (cid:2) . 013 (cid:2) . 017 (cid:2) . 011 (cid:6) (cid:1) ( t ) [ (cid:2) . 029 , . 003 ] [ (cid:2) . 040 , . 004 ] [ (cid:2) . 027 , . 004 ] Direct (cid:2) . 032 (cid:2) . 029 (cid:2) . 036 (cid:7) (cid:1) ( t ) [ (cid:2) . 098 , . 037 ] [ (cid:2) . 104 , . 045 ] [ (cid:2) . 111 , . 036 ] Total (cid:2) . 044 (cid:2) . 047 (cid:8) (cid:1) [ (cid:2) . 115 , . 028 ] [ (cid:2) . 122 , . 028 ] Note . The setup is identical to that of Table 1 except that an ordered probit model is used to model the mediator . Ninety - ﬁve percent conﬁdence intervals are based on Algorithm 1 with 1 , 000 Monte Carlo draws . The second column displays the results under the no - interaction assumption , whereas the third and fourth columns display the results without this assumption . 13 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 (cid:26) ˜ (cid:2) (cid:17)(cid:15) 2 (cid:17)(cid:15) 2 (cid:3) (cid:15) 3 . ( 19 ) It can be shown that (cid:26) ˜ is equal to (cid:17)(cid:15) 2 / (cid:9)(cid:15) 1 (cid:6) (cid:17) 2 (cid:22) 22 (cid:3) 1 (cid:10) when the probit regression is used to model the outcome and is equal to (cid:17)(cid:15) 2 / (cid:9)(cid:15) ˜ 1 (cid:6) (cid:17) 2 (cid:27) 2 / 3 (cid:3) 1 (cid:10) when the logistic regression of the form , logit (cid:2) 1 ( Pr ( Y i (cid:1) 1 (cid:1) T i ) ) (cid:1) (cid:14) ˜ 1 (cid:11) (cid:15) ˜ 1 T i , is used . As shown by Wang and Taylor ( 2002 ) , (cid:26) ˜ is a valid measure of the proportion mediated on the latent variable scale ( logit or probit ) , that is , Y i (cid:3) . However , it does not generally equal (cid:26) , which represents the relative magnitude of the average causal mediation effect with respect to the average causal effect . Nevertheless , it is interesting to note that as shown in Appendix G , when the direct effect is small , (cid:26) ˜ may approximate (cid:26) well whether or not the logistic or probit regression is used and whether or not the pretreatment covariates are included in the model . In Appendix G , we also empirically examine the mag - nitude of bias for the existing measure (cid:26) ˜ using the JOBS II study . Empirical illustration . In the JOBS II study , a key question of interest is whether the program participation leads to a better employment outcome by increasing job search self - efﬁcacy . Here we use our approach to estimate the average causal mediation effects when the outcome is a binary variable , indicating whether subjects were working more than 20 hr a week 6 months after the job training program . We use the model with and without the interaction term and include the same set of pretreatment covari - ates to bolster the credibility of sequential ignorability . The results are given in Table 5 . Under the no - interaction assumption , unlike what was observed for the depression out - come , the estimated average mediation effect is small , and the 95 % conﬁdence interval contains zero . The estimated average direct effect is larger than the estimated average mediation effect but is not statistically signiﬁcant , either . As a result , the estimated proportion mediated is a mere 6 % . A statistical test of the no - interaction assumption reveals that the mediation effect does not vary across levels of the treatment , and the results mirror those estimated under the no - interaction assumption . As illustrated in this example , our algorithms easily extend to the binary outcome case and provide a principled method for esti - mating causal quantities of interest along with their statistical uncertainty . Nonbinary Treatment Our proposed approach so far has assumed that the treatment variable is binary . Similarly , other research tends to consider the cases of binary treatment variables , regardless of whether it is based on the potential outcomes framework ( e . g . , Albert , 2008 ; Jo , 2008 ) or not ( e . g . , Ditlevsen et al . , 2005 ; MacKinnon et al . , 2007 ; Wang & Taylor , 2002 ) . Fortunately , our approach can be extended to the case of nonbinary treatment only at the cost of notational complexity . For example , the causal mediation effects can be deﬁned for any two levels of the treatment : (cid:6) i (cid:3) t ; t 1 , t 0 (cid:4) (cid:2) Y i (cid:3) t , M i (cid:3) t 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) t , M i (cid:3) t 0 (cid:4)(cid:4) , ( 20 ) where t 1 (cid:5) t 0 . This equals the deﬁnition given in Equation 1 when t 1 (cid:1) 1 and t 0 (cid:1) 0 . The corresponding average causal mediation effect is deﬁned as (cid:6) (cid:1) ( t ; t 1 , t 0 ) (cid:23) (cid:1) ( (cid:6) i ( t ; t 1 , t 0 ) ) . Because the values of t , t 0 , and t 1 need to be selected in order to compute (cid:6) (cid:1) ( t ; t 1 , t 0 ) , a more comprehensive approach would be to choose the baseline treatment level ( t 0 (cid:1) 0 ) ﬁrst and then compute the average causal mediation effects for different treatment values with respect to this baseline . One can further plot the estimated value of the average causal mediation effects ( relative to the baseline treatment level , say , t 0 (cid:1) 0 ) averaged over the distribution of the observed treatment , that is , (cid:28)(cid:6) (cid:1) (cid:3) t ; t 1 , 0 (cid:4) dF T i (cid:3) t (cid:4) , against each chosen value of t 1 in order to investigate how the average causal mediation effects change as the function of the treatment intensity . Because the validity of Theorem 1 does not depend on the distribution of the treatment , the algorithms presented previously can be used to make infer - ences about this and other quantities of interest . Sensitivity Analysis for Nonlinear Models Finally , we show that sensitivity analysis discussed earlier can also be generalized to some of the most commonly used nonlinear models . Unlike our estimation algorithms , sensitivity analysis must be devel - oped in the context of a speciﬁc statistical model . However , the same idea is applicable across models , and here we show that the extension is possible for the cases of binary mediator and binary outcome variables . We also discuss an alternative parameterization , which can facilitate the interpretation of sensitivity analysis . Binary Mediator First , we extend the sensitivity analysis to the situation in which the mediator is binary . We consider the latent binary variable model deﬁned by M i (cid:2) 1 (cid:9) M i (cid:3) (cid:7) 0 (cid:10) where M i (cid:3) (cid:2) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:16) 2 (cid:2) X i (cid:3) ε i 2 , where ε i 2 (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) and the outcome is continuous and deﬁned as in Equation 8 and hence an interaction between the treatment and Table 5 Estimated Causal Quantities of Interest With a Binary Outcome Average effect No interaction With interaction Under treatment ( t (cid:1) 1 ) Under control ( t (cid:1) 0 ) Mediation . 004 . 003 . 007 (cid:6) (cid:1) ( t ) [ (cid:2) . 001 , . 012 ] [ (cid:2) . 002 , . 020 ] [ (cid:2) . 001 , . 020 ] Direct . 057 . 054 . 059 (cid:7) (cid:1) ( t ) [ (cid:2) . 008 , . 124 ] [ (cid:2) . 009 , . 118 ] [ (cid:2) . 005 , . 121 ] Total . 061 . 062 (cid:8) (cid:1) [ (cid:2) . 006 , . 128 ] [ (cid:2) . 003 , . 125 ] Proportion mediated . 058 . 072 (cid:26) (cid:1) [ (cid:2) . 104 , . 300 ] [ (cid:2) . 145 , . 402 ] Note . Outcome is whether a respondent was working more than 20 hr per week after the training sessions . Ninety - ﬁve percent conﬁdence intervals are based on Algorithm 2 with 1 , 000 resamples . The second column displays the results under the no - interaction assumption , whereas the third and fourth columns display the results without this assumption . 14 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 T5 the mediator is allowed . The process , though more complex in its mechanics , is essentially identical to the case for the LSEM . We simply derive the mediation effects as a function of (cid:21) and other quantities that can be consistently estimated when (cid:21) is nonzero . We assume ( (cid:20) i 2 , (cid:20) i 3 ) are i . i . d . bivariate normal random variables with mean zero and covariance (cid:21)(cid:22) 3 , and (cid:21) remains the correlation between the two error terms . As before , we can identify the expectation and variance of the outcome variable when (cid:21) is non - zero . Furthermore , the additional model parameters necessary for calculating the average causal mediation effect can be estimated for each value of (cid:21) . 12 We now demonstrate the sensitivity analysis for the binary mediator example analyzed earlier . We ask how sensitive this estimate is to the possible existence of an unobserved confounder that might explain the association between the mediating variable and the outcome . For the sensitivity analysis , we estimate the average causal mediation effect , that is , { (cid:6) (cid:1) ( 1 ) (cid:11) (cid:6) (cid:1) ( 0 ) } / 2 , under a series of (cid:21) values and use Algorithm 1 to compute 95 % conﬁdence intervals . Figure 4 presents the result . We ﬁnd that the estimated average mediation effect is zero when (cid:21) (cid:1) (cid:2) . 24 and that the 95 % conﬁdence interval contains zero for (cid:21) greater than (cid:2) . 09 . Binary Outcome Finally , we extend the sensitivity analysis to binary outcomes . Here we assume a mediator model as deﬁned by Equation 6 and outcome model deﬁned as Y i (cid:2) 1 (cid:9) Y i (cid:3) (cid:7) 0 (cid:10) where Y i (cid:3) (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) X i (cid:3) ε i 3 , ( 21 ) where ε i 3 (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) . For the sake of simplicity , we do not include the interaction term between the treatment and the mediator , but a similar sensitivity analysis can be developed for the model with the interaction term . As before , the sensitivity parameter (cid:21) represents the correlation between the two error terms , and ( (cid:20) i 2 , (cid:20) i 3 ) follows the bivariate normal distribution with the mean zero and the covariance (cid:21)(cid:22) 2 . The result , given in Appendix H , parallels closely with the sensitivity analysis for LSEM . For example , taking the partial derivative with respect to (cid:21) shows that (cid:6) (cid:1) ( t ) is monotonically decreasing ( increasing ) with respect to (cid:21) when (cid:15) 2 (cid:29) 0 ( (cid:15) 2 (cid:13) 0 ) . Moreover , when (cid:15) 2 (cid:5) 0 , we have (cid:6) (cid:1) ( t ) (cid:1) 0 if and only if (cid:17) (cid:1) 0 or equivalently (cid:21) (cid:1) (cid:21) ˜ , the same condition as for LSEM ( see Theorem 4 of Imai , Keele , & Yamamoto , 2010 ) . Because the average total effect , (cid:8) (cid:1) (cid:2) (cid:1) (cid:9)(cid:25)(cid:3)(cid:14) 1 (cid:3) (cid:15) 1 (cid:3) (cid:16) 1 (cid:2) X i (cid:4) (cid:1) (cid:25)(cid:3)(cid:14) 1 (cid:3) (cid:16) 1 (cid:2) X i (cid:4)(cid:10) , is identiﬁed , we can use this result to conduct sensitivity analysis for the proportion mediated . We omit an empirical illustration , although the analysis would proceed as in the last two examples . Sensitivity Analysis Based on the Coefﬁcients of Determination Despite its simplicity , researchers may ﬁnd it difﬁcult to inter - pret the magnitude of the sensitivity parameter (cid:21) . Here we present an alternative method for the interpretation of (cid:21) . In the case of the LSEM , Imai , Keele , and Yamamoto ( 2010 ) showed how to inter - pret the same sensitivity analysis using the following decomposi - tion of the error terms for Equations 6 and 7 : (cid:20) ij (cid:2) (cid:30) j U i (cid:3) (cid:20)(cid:12) ij , for j (cid:1) 2 , 3 , where U i is an unobserved pretreatment confounder ( or linear combinations of confounders ) that inﬂuences both the mediator and the outcome , and (cid:30) j represents an unknown coefﬁ - cient for each equation . Such omitted variables lead to the viola - tion of the sequential ignorability assumption . Under this assumption , (cid:21) can be written as a function of the coefﬁcients of determination ( i . e . , R 2 ) . This allows for the sensi - tivity analysis to be based on the magnitude of an effect of the omitted variable . This can be done in two ways . First , (cid:21) can be expressed as a function of the proportions of previously unex - plained variances in the mediator and outcome regressions , that is , R M (cid:3) 2 (cid:23) 1 (cid:2) Var ( (cid:20)(cid:12) i 2 ) / Var ( (cid:20) i 2 ) and R Y (cid:3) 2 (cid:23) 1 (cid:2) Var ( (cid:20)(cid:12) i 3 ) / Var ( (cid:20) i 3 ) , respectively . We can now express the sensitivity parameter as a function of these two quantities : (cid:21) (cid:1) sgn ( (cid:30) 2 (cid:30) 3 ) R M (cid:3) R Y (cid:3) , where sgn ( x ) is the sign function ( which equals 1 if x is positive , equals 0 if x is zero , and equals (cid:2) 1 if it is negative ) . Thus , sensitivity analysis can be conducted once researchers specify the direction of the effects 12 When (cid:21) is nonzero , the expectation and variance of the outcome are (cid:1) (cid:3) Y i (cid:1) T i (cid:2) t , M i (cid:2) m , X i (cid:2) x (cid:4) (cid:2) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17) m (cid:3) (cid:18) tm (cid:3) (cid:16) 3 (cid:2) x (cid:3) (cid:21)(cid:22) 3 (cid:19) m (cid:3) t , x (cid:4) and Var ( Y i (cid:1) T i (cid:1) t , M i (cid:1) m , X i (cid:1) x ) (cid:1) (cid:22) 32 { 1 (cid:2) (cid:21) 2 (cid:19) m ( t , x ) ( (cid:19) m ( t , x ) (cid:11) (cid:14) 2 (cid:11) (cid:15) 2 t (cid:11) (cid:16) 2 (cid:2) x ) } , where (cid:19) 1 (cid:3) t , x (cid:4) (cid:2) (cid:31)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) x (cid:4) / (cid:25)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) x (cid:4) and (cid:19) 0 (cid:3) t , x (cid:4) (cid:2) (cid:2)(cid:31)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) x (cid:4) / (cid:25) ( (cid:2)(cid:14) 2 (cid:1) (cid:15) 2 t (cid:1) (cid:16) 2 (cid:2) x ) are the inverse Mills ratios . Because ( (cid:14) 2 , (cid:15) 2 , (cid:16) 2 ) can be estimated from a probit regression of M i on ( 1 , T i , X i ) , the parameters ( (cid:14) 3 , (cid:15) 3 , (cid:17) , (cid:18) , (cid:16) 3 , (cid:22) 3 ) can be consistently estimated with feasible generalized least squares with a known value for (cid:21) . Finally , once these model parameters are estimated , the average causal mediation effect is calculated as a function of (cid:21) and other consistently estimated parameters : (cid:6) (cid:1) ( t ) (cid:1) (cid:3)(cid:17) (cid:3) (cid:18) t (cid:4) (cid:1) (cid:9)(cid:25)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4) (cid:1) (cid:25)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4)(cid:10) . As in the sample selection model of Heckman ( 1979 ) , (cid:21) is actually identiﬁed given the nonlinearity of the model , but we will not use this fact because it only hinges on the functional form assumption . Using these results , one can conduct a sensitivity analysis for the case with a binary mediator , which is done automatically with our software . −1 . 0 −0 . 5 0 . 0 0 . 5 1 . 0 − 0 . 10 − 0 . 05 0 . 00 0 . 05 Sensitivity Parameter : ρρ A v e r age M ed i a t i on E ff e c t : δ ( t ) Figure 4 . Sensitivity analysis with continuous outcome and binary me - diator . The dashed line represents the estimated mediation effect . The gray areas represent the 95 % conﬁdence interval for the mediation effects at each value of (cid:21) . 15 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn12 F4 of the unobserved confounder U i in the mediator and outcome models , sgn ( (cid:30) 2 (cid:30) 3 ) , 13 as well as the relative magnitude of those effects , R M * 2 and R Y * 2 . Similarly , the sensitivity analysis can be based on the propor - tions of original variances that are explained by the unobserved confounder in the mediator and outcome regressions , that is , R˜ M 2 (cid:23) { Var ( (cid:20) i 2 ) (cid:2) Var ( (cid:20)(cid:12) i 2 ) } / Var ( M i ) and R˜ Y 2 (cid:23) { Var ( (cid:20) i 3 ) (cid:2) Var ( (cid:20)(cid:12) i 3 ) } / Var ( Y i ) , respectively . In this case , the expression for (cid:21) is given by sgn ( (cid:30) 2 (cid:30) 3 ) R˜ M R˜ Y / (cid:6) (cid:3) 1 (cid:1) R M 2 (cid:4)(cid:3) 1 (cid:1) R Y 2 (cid:4) , where R M 2 and R Y 2 are the usual coefﬁcients of determination for the mediator and outcome regres - sions . When the mediator or the outcome variable is binary , we use the pseudo - R 2 of McKelvey and Zavoina ( 1975 ) . For example , in the binary mediator case , we redeﬁne R˜ M 2 (cid:1) { 1 (cid:2) Var ( (cid:20)(cid:12) i 2 ) } / { Var ( Mˆ i (cid:3) ) (cid:11) 1 } and R M 2 (cid:1) Var ( Mˆ i (cid:3) ) / { Var ( Mˆ i (cid:3) ) (cid:11) 1 } in the above formula , where Mˆ i (cid:3) represents the predicted value of the latent mediator variable for the probit regression . Thus , in all cases considered here we can interpret (cid:21) using two alternative coefﬁ - cients of determination . This value can then be used to compare across studies or evaluated in reference to subject speciﬁc knowl - edge about the likely magnitude of effect from the confounding variable . Next , we present an empirical example of a sensitivity analysis in terms of the coefﬁcients of determination for the case of a continuous outcome ( depression 6 months following the treatment ) and a dichotomous mediator . The model used here is the same as the one that produces the results given in Table 3 except that for the purpose of illustration we use an alternative mediator that is a dichotomized index of several psychological measures such as the original job search self - efﬁcacy variable and the internal locus of self - control . We call this variable mastery . The resulting estimate of the average mediation effect is (cid:2) . 031 , with the 95 % conﬁdence interval of [ (cid:2) . 050 , (cid:2) . 007 ] . How sensitive is this result to an unobserved confounder that inﬂuences both the mediator and the outcome ? Consider the so - called ability bias in which participants with greater ability are likely to respond to the training , thereby increasing the level of their mastery , and yet they are also likely to have a relatively lower level of depression . Under this scenario , we assume the sign of the product of coefﬁcients for the unobserved confounder is negative , that is , sgn ( (cid:30) 2 (cid:30) 3 ) (cid:2) 1 , because their effects are expected to operate in the opposite directions . Figure 5 presents our sensitivity analysis based on the coefﬁ - cients of determination , R˜ M 2 and R˜ Y 2 , which represent the propor - tions of original variances explained by the unobserved con - founder for the mediator and the outcome , respectively . In the ﬁgure , the contour line of 0 corresponds to values of R˜ M 2 and R˜ Y 2 that yield zero average causal mediation effect . For example , when R˜ M 2 (cid:1) . 6 and R˜ Y 2 (cid:1) . 3 , the estimated mediation effect would be approximately zero . This means that the unobserved confounder , ability , would have to explain 60 % of the original variance in the ( latent ) mastery variable and 30 % of the original variance in the depression variable for the estimate to be zero . At higher values of both R˜ M 2 and R˜ Y 2 , the estimated average causal mediation effect would be positive , whereas at lower values the sign of the estimate remains negative . This implies that the values of R˜ M 2 and R˜ Y 2 must be relatively high for the original conclusion to be reversed . Concluding Remarks In this article , we proposed a general approach to causal medi - ation analysis . Our approach consisted of the following four ele - ments : ( a ) general deﬁnitions of causal mediation effects given within the counterfactual framework , ( b ) nonparametric identiﬁ - cation based on the sequential ignorability assumption , ( c ) estima - tion algorithms for parametric and nonparametric models , and ( d ) sensitivity analyses to assess the robustness of empirical results . The proposed approach is general because it is developed without any reference to a particular statistical model and therefore is applicable to a wide range of situations . In doing so , we developed easy - to - use software , mediation ( Imai et al . , 2010a ) , and give researchers access to estimation strategies that can handle a variety of data . Furthermore , our approach straightforwardly calculates estimates of uncertainty that allow for hypothesis testing and conﬁdence interval construction . We also believe it is important to probe the extent to which an unveriﬁable assumption drives the results of the analysis . Thus , as a part of our general approach , we have developed a sensitivity analysis that allows researchers to quantify the exact degree of departure from the key identiﬁcation assumption that is required for the original results to no longer hold . We emphasize that in our approach each component is closely linked together . The potential outcomes deﬁnition of causal me - diation effects allows us to conduct the nonparametric identiﬁca - tion analysis , which reveals the key assumption required for re - searchers to interpret mediation effects as causal . The result of this identiﬁcation analysis implies the general estimation algorithms that are applicable across a variety of statistical models . Further - 13 For example , if the omitted variable affects the mediator and outcome variable in the same direction , then sgn ( (cid:30) 2 (cid:30) 3 ) (cid:1) 1 . −0 . 03 − 0 . 02 − 0 . 01 0 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 R ~ M2 R ~ Y 2 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 Figure 5 . Sensitivity analysis with continuous outcome and binary me - diator . The plot contains contour lines that represent estimated average mediation effect corresponding to unobserved pretreatment confounders of various magnitudes . These magnitudes are measured by the coefﬁcients of determination , R˜ M 2 and R˜ Y 2 , each of which represents the proportion of original variance explained by the unobserved confounder for the mediator and the outcome , respectively . Here we assume that the unobserved con - founder , ability , inﬂuences the mediator and the outcome in the opposite directions . 16 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn13 F5 more , the potential violation of the key identiﬁcation assumption motivates the development of the sensitivity analysis within the context of statistical models commonly used by applied research - ers . Future research should extend this general framework to more complex situations such as panel data , multilevel models , and multiple mediators . Like much of the existing literature , we have focused on the statistical methods that are applicable to either standard randomized experiments ( in which the treatment is ran - domized ) or observational studies in cross - section settings . How - ever , we do not consider alternative experimental designs in which the mediator is either directly or indirectly manipulated by re - searchers . In our ongoing work ( Imai , Tingley , & Yamamoto , 2009 ) , we evaluated the advantages and disadvantages of the existing experimental designs and developed new experimental designs that may more effectively identify causal mediation ef - fects . We also showed how these experimental designs can serve as templates for observational studies so that causal mediation analysis can be conducted with less stringent assumptions than sequential ignorability ( Imai , Keele , Tingley , & Yamamoto , 2010b ) . References Albert , J . M . ( 2008 ) . Mediation analysis via potential outcomes models . Statistics in Medicine , 27 , 1282 – 1304 . Angrist , J . D . , Imbens , G . W . , & Rubin , D . B . ( 1996 ) . Identiﬁcation of causal effects using instrumental variables . Journal of the American Statistical Association , 91 ( 434 ) , 444 – 455 . Avin , C . , Shpitser , I . , & Pearl , J . ( 2005 ) . Identiﬁability of path - speciﬁc effects . In L . P . Kaelbling & A . Safﬁotti ( Eds . ) , Proceedings of the 19th International Joint Conference on Artiﬁcial Intelligence ( pp . 357 – 363 ) . San Francisco , CA : Morgan Kaufmann . Baron , R . M . , & Kenny , D . A . ( 1986 ) . The moderator – mediator variable distinction in social psychological research : Conceptual , strategic , and statistical considerations . Journal of Personality and Social Psychology , 51 , 1173 – 1182 . Bauer , D . J . , Preacher , K . J . , & Gil , K . M . ( 2006 ) . Conceptualizing and testing random indirect effects and moderated mediation in multilevel models : New procedures and recommendations . Psychological Meth - ods , 11 , 142 – 163 . Bohrnstedt , G . W . , & Goldberger , A . S . ( 1969 ) . On the exact covariance of products of random variables . Journal of the American Statistical As - sociation , 64 ( 328 ) , 1439 – 1442 . Bullock , J . G . , Green , D . P . , & Ha , S . E . ( 2010 ) . Yes , but what’s the mechanism ? ( Don’t expect an easy answer ) . Journal of Personality and Social Psychology , 98 , 550 – 558 . Cole , D . A . , & Maxwell , S . E . ( 2003 ) . Testing mediational models with longitudinal data : Questions and tips in the use of structural equation modeling . Journal of Abnormal Psychology , 112 , 558 – 577 . Ditlevsen , S . , Christensen , U . , Lynch , J . , Damsgaard , M . T . , & Keiding , N . ( 2005 ) . The mediation proportion : A structural equation approach for estimating the proportion of exposure effect on outcome explained by an intermediate variable . Epidemiology , 16 ( 1 ) , 114 – 120 . Freedman , L . S . , Graubard , B . , & Schatzkin , A . ( 1992 ) . Statistical valida - tion of intermediate endpoints for chronic diseases . Statistics in Medi - cine , 11 , 167 – 178 . Gallop , R . , Small , D . S . , Lin , J . Y . , Elliot , M . R . , Joffe , M . , & Ten Have , T . R . ( 2009 ) . Mediation analysis with principal stratiﬁcation . Statistics in Medicine , 28 , 1108 – 1130 . Glynn , A . N . ( 2008 ) . Estimating and bounding mechanism speciﬁc causal effects . Paper presented at the 25th annual summer meeting of the Society for Political Methodology , Ann Arbor , Michigan . Goodman , L . A . ( 1960 ) . On the exact variance of products . Journal of the American Statistical Association , 55 ( 292 ) , 708 – 713 . Hastie , T . J . , & Tibshirani , R . ( 1990 ) . Generalized additive models . Lon - don , England : Chapman & Hall . Heckman , J . J . ( 1979 ) . Sample selection bias as a speciﬁcation error . Econometrica , 47 ( 1 ) , 153 – 161 . Holland , P . W . ( 1986 ) . Statistics and causal inference . Journal of the American Statistical Association , 81 ( 396 ) , 945 – 960 . Huang , B . , Sivaganesan , S . , Succop , P . , & Goodman , E . ( 2004 ) . Statistical assessment of mediational effects for logistic mediational models . Sta - tistics in Medicine , 23 , 2713 – 2728 . Hyman , H . ( 1955 ) . Survey design and analysis : Principles , cases , and procedures . New York , NY : Free Press . Imai , K . , Keele , L . , & Tingley , D . ( 2010 ) . Replication data for : A general approach to causal mediation analysis . Retrieved from http : / / hdl . handle . net / 1902 . 1 / 14801 Imai , K . , Keele , L . , Tingley , D . , & Yamamoto , T . ( 2010a ) . Advances in social science research using R . In H . D . Vinod ( Ed . ) , Causal mediation analysis using R ( pp . 129 – 154 ) . New York , NY : Springer . Imai , K . , Keele , L . , Tingley , D . , & Yamamoto , T . ( 2010b ) . Unpacking the black box : Learning about causal mechanisms from experimental and observational studies . Retrieved from http : / / imai . princeton . edu / research / mediationP . html Imai , K . , Tingley , D . , & Yamamoto , T . ( 2009 ) . Experimental designs for identifying causal mechanisms . Retrieved from http : / / imai . princeton . edu / research / Design . html Imai , K . , Keele , L . , & Yamamoto , T . ( 2010 ) . Identiﬁcation , inference , and sensitivity analysis for causal mediation effects . Statistical Science , 25 , 51 – 71 . James , L . R . , Mulaik , S . A . , & Brett , J . M . ( 1982 ) . Causal analysis : Assumptions , models , and data . Beverly Hills , CA : Sage . Jo , B . ( 2008 ) . Causal inference in randomized experiments with media - tional processes . Psychological Methods , 13 , 314 – 336 . Judd , C . M . , & Kenny , D . A . ( 1981 ) . Process analysis : Estimating medi - ation in treatment evaluations . Evaluation Review , 5 , 602 – 619 . Kaufman , J . S . , MacLehose , R . F . , Kaufman , S . , & Greenland , S . ( 2005 ) . The mediation proportion . Epidemiology , 16 ( 5 ) , 710 . Keele , L . J . ( 2008 ) . Semiparametric regression for the social sciences . Chichester , England : Wiley . King , G . , Tomz , M . , & Wittenberg , J . ( 2000 ) . Making the most of statis - tical analyses : Improving interpretation and presentation . American Journal of Political Science , 44 , 341 – 355 . Koenker , R . ( 2005 ) . Quantile regression . New York , NY : Cambridge University Press . Kraemer , H . C . , Kiernan , M . , Essex , M . , & Kupfer , D . J . ( 2008 ) . How and why criteria deﬁning moderators and mediators differ between the Baron & Kenny and MacArthur approaches . Health Psychology , 27 , S101 – S108 . Kraemer , H . C . , Wilson , G . T . , Fairburn , C . G . , & Agras , W . S . ( 2002 ) . Mediators and moderators of treatment effects in randomized clinical trials . Archives of General Psychiatry , 59 , 877 – 883 . Krull , J . L . , & MacKinnon , D . P . ( 1999 ) . Multilevel mediation modeling in group - based intervention studies . Evaluation Review , 23 , 418 – 444 . Li , Y . , Schneider , J . A . , & Bennett , D . A . ( 2007 ) . Estimation of the mediation effect with a binary mediator . Statistics in Medicine , 26 , 3398 – 3414 . Little , R . J . , & Yau , L . H . Y . ( 1998 ) . Statistical techniques for analyzing data from prevention trials : Treatment of no - shows using Rubin’s causal model . Psychological Methods , 3 , 147 – 159 . MacKinnon , D . P . ( 2000 ) . Contrasts in multiple mediator models . In J . S . Rose , L . Chassin , C . C . Presson , & S . J . Sherman ( Eds . ) , Multivariate 17 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 applications in substance use research : New methods for new questions ( pp . 141 – 160 ) . Mahwah , NJ : Erlbaum . MacKinnon , D . P . ( 2008 ) . Introduction to statistical mediation analysis . New York , NY : Routledge . MacKinnon , D . P . , & Dwyer , J . H . ( 1993 ) . Estimating mediated effects in prevention studies . Evaluation Review , 17 , 144 – 158 . MacKinnon , D . , & Fairchild , A . ( 2009 ) . Current directions in mediation analysis . Current Directions in Psychological Sciences , 18 ( 1 ) , 16 – 20 . MacKinnon , D . P . , Lockwood , C . M . , Brown , C . H . , Wang , W . , & Hoffman , J . M . ( 2007 ) . The intermediate endpoint effect in logistic and probit regression . Clinical Trials , 4 , 499 – 513 . MacKinnon , D . P . , Lockwood , C . M . , Hoffman , J . M . , West , S . G . , & Sheets , V . ( 2002 ) . A comparison of methods to test mediation and other intervening variable effects . Psychological Methods , 7 , 83 – 104 . MacKinnon , D . P . , Lockwood , C . M . , & Williams , J . ( 2004 ) . Conﬁdence limits for the indirect effect : Distribution of the product and resampling methods . Multivariate Behavioral Research , 39 , 99 – 128 . Manski , C . F . ( 2007 ) . Identiﬁcation for prediction and decision . Cam - bridge , MA : Harvard University Press McKelvey , R . D . , & Zavoina , W . ( 1975 ) . A statistical model for the analysis of ordinal level dependent variable . Journal of Mathematical Sociology , 4 , 103 – 120 . Mulaik , S . ( 2007 ) . There is a place for approximate ﬁt in structural equation modelling . Personality and Individual Differences , 42 , 883 – 891 . Mulaik , S . ( 2009 ) . Linear causal modeling with structural equations . Boca Raton , FL : CRC Press . Pearl , J . ( 2001 ) . Direct and indirect effects . In J . Breese & D . Koller ( Eds . ) , Proceedings of the 17th Conference on Uncertainty in Artiﬁcial Intel - ligence ( pp . 411 – 420 ) . San Francisco , CA : Morgan Kaufmann . Preacher , K . J . , & Hayes , A . F . ( 2008 ) . Asymptotic and resampling strategies for assessing and comparing indirect effects in multiple me - diator models . Behavioral Research Methods , 40 , 879 – 891 . Preacher , K . J . , Rucker , D . D . , & Hayes , A . F . ( 2007 ) . Addressing mod - erated mediation hypotheses : Theory , methods , and prescriptions . Mul - tivariate Behavioral Research , 42 , 185 – 227 . R Development Core Team . ( 2009 ) . R : A language and environment for statistical computing . Vienna , Austria : R Foundation for Statistical Computing . Robins , J . M . ( 2003 ) . Semantics of causal DAG models and the identiﬁ - cation of direct and indirect effects . In P . J . Green , N . L . Hjort , & S . Richardson ( Eds . ) , Highly structured stochastic systems ( pp . 70 – 81 ) . New York , NY : Oxford University Press . Robins , J . M . , & Greenland , S . ( 1992 ) . Identiﬁability and exchangeability for direct and indirect effects . Epidemiology , 3 ( 2 ) , 143 – 155 . Rosenbaum , P . R . ( 2002 ) . Covariance adjustment in randomized experi - ments and observational studies : Rejoinder . Statistical Science , 17 ( 3 ) , 321 – 327 . Schafer , J . L . , & Kang , J . ( 2008 ) . Average causal effects from nonrandom - ized studies : A practical guide and simulated example . Psychological Methods , 13 , 279 – 313 . Sobel , M . E . ( 2008 ) . Identiﬁcation of causal parameters in randomized studies with mediating variables . Journal of Educational and Behav - ioral Statistics , 33 ( 2 ) , 230 – 251 . VanderWeele , T . J . ( 2009 ) . Marginal structural models for the estimation of direct and indirect effects . Epidemiology , 20 ( 1 ) , 18 – 26 . VanderWeele , T . J . ( 2010 ) . Bias formulas for sensitivity analysis for direct and indirect effects . Epidemiology , 21 ( 4 ) , 540 – 551 . Vinokur , A . D . , Price , R . H . , & Schul , Y . ( 1995 ) . Impact of the JOBS intervention on unemployed workers varying in risk for depression . American Journal of Community Psychology , 23 ( 1 ) , 39 – 74 . Vinokur , A . D . , & Schul , Y . ( 1997 ) . Mastery and inoculation against setbacks as active ingredients in the JOBS intervention for the unem - ployed . Journal of Consulting and Clinical Psychology , 65 , 867 – 877 . Wang , Y . , & Taylor , J . M . G . ( 2002 ) . A measure of the proportion of treatment effect explained by a surrogate marker . Biometrics , 58 , 803 – 812 . White , I . R . , Carpenter , J . , Evans , S . , & Schroter , S . ( 2007 ) . Eliciting and using expert opinions about dropout bias in randomized controlled trials . Clinical Trials , 4 ( 2 ) , 125 – 139 . Wood , S . N . ( 2006 ) . Generalized additive models : An introduction with R . Boca Raton , FL : Chapman & Hall / CRC . ( Appendices follow ) 18 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Appendix A Asymptotic Variance Under the Model With the Interaction Using the delta method and noting the independence between (cid:15) ˆ 2 and ( (cid:17) ˆ , (cid:18) ˆ ) , we can write the asymptotic variance of estima - ted average causal mediation effect in Equation 9 as Var ( (cid:15) ˆ 2 ( (cid:17) ˆ (cid:11) (cid:18) ˆ t ) (cid:1) T , X ) ( (cid:17) (cid:11) t (cid:18) ) 2 Var ( (cid:15) ˆ 2 (cid:1) T , X ) (cid:11) (cid:15) 22 { Var ( (cid:17) ˆ (cid:1) T , X ) (cid:11) t 2 Var ( (cid:18) ˆ (cid:1) T , X ) (cid:11) 2 t Cov ( (cid:17) ˆ , (cid:18) ˆ (cid:1) T , X ) } for t (cid:1) 0 , 1 ( Preacher , Rucker , & Hayes , 2007 ) . On the basis of this asymptotic variance , one can conduct the statistical test with the null hypothesis of the form (cid:6) (cid:1) ( t ) (cid:1) 0 for t (cid:1) 0 , 1 . To derive the asymptotic variance for the estimated direct effect given in Equation 10 , we ﬁrst rewrite the variance as Var (cid:3)(cid:15) ˆ 3 (cid:3) (cid:18) ˆ (cid:9)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:10) (cid:1) T , X (cid:4) (cid:2) Var (cid:3)(cid:15) ˆ 3 (cid:1) X , T (cid:4) (cid:3) Var (cid:3)(cid:18) ˆ (cid:9)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:10) (cid:1) T , X (cid:4) (cid:3) 2Cov (cid:3)(cid:15) ˆ 3 , (cid:18) ˆ (cid:9)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:10) (cid:1) T , X (cid:4) . Noting the independence between ( (cid:15) ˆ 3 , (cid:18) ˆ ) and ( (cid:14) ˆ 2 , (cid:15) ˆ 2 , (cid:16) ˆ 2 ) and using the result of Goodman ( 1960 ) , we can write the second term of the above equation as Var (cid:3)(cid:18) ˆ (cid:9)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:10) (cid:1) T , X (cid:4) (cid:2) (cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) X (cid:4) 2 Var (cid:3)(cid:18) ˆ (cid:1) T , X (cid:4) (cid:3) (cid:18) 2 Var (cid:3)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:1) T , X (cid:4) (cid:3) Var (cid:3)(cid:18) ˆ (cid:1) T , X (cid:4) Var (cid:3)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:1) T , X (cid:4) , where Var (cid:3)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:1) T , X (cid:4) (cid:2) Var (cid:3)(cid:14) ˆ 2 (cid:1) T , X (cid:4) (cid:3) t 2 Var (cid:3)(cid:15) ˆ 2 (cid:1) T , X (cid:4) (cid:3) X (cid:2) Var (cid:3)(cid:16) ˆ 2 (cid:1) T , X (cid:4) X (cid:3) 2 t Cov (cid:3)(cid:14) ˆ 2 , (cid:15) ˆ 2 (cid:1) T , X (cid:4) (cid:3) 2 tX (cid:2) Cov (cid:3)(cid:15) ˆ 2 , (cid:16) ˆ 2 (cid:1) T , X (cid:4) (cid:3) 2 X (cid:2) Cov (cid:3)(cid:14) ˆ 2 , (cid:16) ˆ 2 (cid:1) T , X (cid:4) . Finally , using the result of Bohrnstedt and Goldberger ( 1969 ) and noting the independence again , we write the ﬁnal covariance term as Cov (cid:3)(cid:15) ˆ 3 , (cid:18) ˆ (cid:9)(cid:14) ˆ 2 (cid:3) (cid:15) ˆ 2 t (cid:3) (cid:16) ˆ 2 (cid:2) X (cid:10) (cid:1) T , X (cid:4) (cid:2) (cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:3) (cid:16) 2 (cid:2) X (cid:4) Cov (cid:3)(cid:15) ˆ 3 , (cid:18) ˆ (cid:1) T , X (cid:4) . Finally , the variance for the estimated total effect is given by Var (cid:3)(cid:15) ˆ 1 (cid:3) (cid:19) ˆ (cid:2) X (cid:1) T , X (cid:4) (cid:2) Var (cid:3)(cid:15) ˆ 1 (cid:1) T , X (cid:4) (cid:3) X (cid:2) Var (cid:3)(cid:19) ˆ (cid:1) T , X (cid:4) X (cid:3) 2 X (cid:2) Cov (cid:3)(cid:15) ˆ 1 , (cid:19) ˆ (cid:1) T , X (cid:4) . Appendix B The Assumption of Instrumental Variables Estimation Assumption 2 ( Instrumental Variables Assumption ; Angrist et al . , 1996 ) : The assumption consists of the following three parts : 1 . Ignorability of treatment assignment : { Y i ( t (cid:12) , m ) , M i ( t ) } T i (cid:1) X i (cid:1) x and 0 (cid:13) Pr ( T i (cid:1) t (cid:1) X i (cid:1) x ) for t , t (cid:12) (cid:1) 0 , 1 and all x (cid:1) (cid:1) ; 2 . Monotonic treatment effect on the mediator : M i ( 1 ) (cid:5) M i ( 0 ) ( or M i ( 1 ) (cid:4) M i ( 0 ) ) for all i (cid:1) 1 , 2 , . . . , n ; 3 . No direct effect ( exclusion restriction ) : Y i ( 1 , m ) (cid:1) Y i ( 0 , m ) for all m (cid:1) (cid:2) . Like Assumption 1 , Assumption 2 requires that the treatment assignment is ignorable given the observed pretreatment covari - ates . As noted before , the ignorability of treatment assignment is satisﬁed in experiments in which the treatment is randomized , a typical setting where causal mediation analysis is employed . More importantly , the instrumental variables method replaces the sequential ignorability assumption about the mediator with two alternative as - sumptions . Although allowing for the possibility that there may exist unobserved variables that confound the relationship between the out - come and mediating variables , the instrumental variables method assumes that the treatment monotonically affects the mediator and that the treatment has no direct effect on the outcome . Like the ignorability of the mediator , these two assumptions are not directly testable because we never observe M i ( 1 ) and M i ( 0 ) ( or Y i ( 1 , m ) and Y i ( 0 , m ) ) jointly for any given unit . Although these assumptions are not refutable , we can probe their plausibility . The monotonicity assumption may be plausible in some cases . In the context of the JOB II study , for example , the assumption implies that the program participation would help every worker in the study by improving his or her level of self - conﬁdence in the search for a job . However , the assumption is violated if there are some workers whose self - conﬁdence level is negatively affected by the job training program . Thus , the mono - tonicity assumption rules out any job seeker having a negative - ( Appendices continue ) 19 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 reaction to the training programming and thus being less effective at ﬁnding a job . The assumption of no direct effect for every unit is more problematic , as the main goal of causal mediation analysis is to test alternative causal mechanisms . This assumption implies that there is no other causal pathway other than through the mediator of interest . In the JOBS II study , the assumption is difﬁcult to justify because the increase in the level of job search self - efﬁcacy is probably not the only reason why the job training program reduces the depressive symptoms . Thus , although Assumption 2 has an advantage of allowing for the existence of unobserved confound - ers , it a priori excludes the possibility of a direct effect from the treatment to the outcome . If the instrumental variables assumption is maintained , there is no need to use the product of coefﬁcients as the average mediation effect . Indeed , all one needs to do is to estimate the average total effect of the treatment that under the no - direct - effect assumption equals the average mediation effect . Speciﬁcally , under Assumption 2 , (cid:15) 3 in Equation 7 is assumed to equal zero , and the average causal mediation effect is identiﬁed as (cid:6) (cid:1) (cid:1) (cid:15) 2 (cid:17) (cid:1) (cid:15) 1 , where (cid:15) 1 is given in Equation 5 . Thus , the estimated average causal mediation effect and its variance are easily obtained by regressing Y i on T i and X i . Appendix C Proof of Theorem 2 Equations 6 and 8 imply Y i (cid:1) ( (cid:14) 2 (cid:17) (cid:11) (cid:14) 3 ) (cid:11) { (cid:15) 3 (cid:11) ( (cid:17) (cid:11) (cid:18) ) (cid:15) 2 (cid:11) (cid:14) 2 (cid:18) } T i (cid:3) (cid:3)(cid:17)(cid:16) 2 (cid:3) (cid:16) 3 (cid:4) (cid:2) X i (cid:3) (cid:18)(cid:16) 2 (cid:2) T i X i (cid:3) (cid:3)(cid:17) (cid:3) (cid:18) T i (cid:4) ε i 2 (cid:3) ε i 3 . Let ε i 1 (cid:1) ( (cid:17) (cid:11) (cid:18) T i ) ε i 2 (cid:11) ε i 3 . Then , (cid:1) (cid:3)(cid:20) i 1 (cid:1) T i (cid:4) (cid:2) (cid:3)(cid:17) (cid:3) (cid:18) T i (cid:4) (cid:1) (cid:3)(cid:20) i 2 (cid:1) T i (cid:4) (cid:3) (cid:1) (cid:3)(cid:20) i 3 (cid:1) T i (cid:4) (cid:2) 0 , where the second equality fol - lows from Equation 3 of Assumption 1 ( for details , see proof of Theorem 2 in Imai , Keele , & Yamamoto , 2010 ) . Thus , the iden - tiﬁable parameters are ( (cid:14) 1 , (cid:15) 1 , (cid:16) 1 , (cid:14) 2 , (cid:15) 2 , (cid:16) 2 , (cid:18)(cid:16) 2 , (cid:22) 1 t 2 , (cid:22) 2 t 2 , (cid:21) ˜ t ) for t (cid:1) 0 , 1 , where (cid:14) 1 (cid:1) (cid:14) 2 (cid:17) (cid:11) (cid:14) 3 , (cid:15) 1 (cid:1) (cid:15) 3 (cid:11) ( (cid:17) (cid:11) (cid:18) ) (cid:15) 2 (cid:11) (cid:14) 2 (cid:18) , and (cid:16) 1 (cid:1) (cid:17)(cid:16) 2 (cid:11) (cid:16) 3 . This means that if we identify ( (cid:17) , (cid:18) ) , then ( (cid:14) 3 , (cid:15) 3 , (cid:16) 3 ) is also identiﬁable . To identify ( (cid:17) , (cid:18) ) , we solve the following system of equations ( note that (cid:18) can also be identiﬁed from (cid:18)(cid:16) 2 as long as there is no interaction term between X i and T i in the outcome regression ; for the sake of generality , however , we do not pursue this identiﬁcation strategy here ) : (cid:22) 1 t 2 (cid:2) (cid:3)(cid:17) (cid:3) t (cid:18)(cid:4) 2 (cid:22) 2 t 2 (cid:3) 2 (cid:3)(cid:17) (cid:3) t (cid:18)(cid:4)(cid:21)(cid:22) 2 t 2 (cid:22) 3 t 2 (cid:3) (cid:22) 3 t 2 (cid:21) ˜ t 2 (cid:22) 1 t (cid:22) 2 t (cid:2) (cid:3)(cid:17) (cid:3) t (cid:18)(cid:4)(cid:22) 2 t 2 (cid:3) (cid:21)(cid:22) 2 t (cid:22) 3 t , where ( (cid:21) t , (cid:22) 1 t 2 , (cid:22) 2 t 2 ) is identiﬁable from the data and ( (cid:17) , (cid:18) , (cid:22) 3 t 2 ) is the set of unknown parameters for t (cid:1) 0 , 1 . The number of equations is four and is equal to the number of parameters , and thus one can express (cid:18) and (cid:17) as the functions of identiﬁable parameters . Thus , with Equation 9 , the desired expression results . Appendix D The Estimation Algorithms Parametric Inference Suppose that the quantity of interest is the average causal mediation effect , (cid:6) (cid:1) ( t ) . Step 1 : Fit models for the observed outcome and mediator variables . Fit a parametric model , f ! M (cid:3) M i (cid:1) T i , X i (cid:4) , for the media - tor and another parametric model , f ! Y (cid:3) Y i (cid:1) T i , M i , X i (cid:4) , for the out - come where ! M and ! Y represent model parameters . Step 2 : Simulate model parameters from their sampling distribution . Sample J copies of ! M and ! Y from their sampling distributions and denote them ! M ( j ) and ! Y ( j ) , respectively . We use the approximation based on the multivariate normal distribution ( with mean and variance equal to the estimated parameters and their estimated asymptotic covariance matrix , respectively ) . Step 3 . For each j (cid:1) 1 , . . . , J , repeat the following three steps : 1 . Simulate the potential values of the mediator . For each t (cid:1) 0 , 1 and each i (cid:1) 1 , . . . , n , sample K copies of M i ( t ) from f ! M (cid:3) j (cid:4) (cid:3) M i (cid:1) t , X i (cid:4) and denote them as M i ( jk ) ( t ) for k (cid:1) 1 , . . . , K . That is , we generate two potential values of the mediator each based on the mediator model , one under the treatment condition and the other under the control condition . ( Appendices continue ) 20 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 2 . Simulate the potential outcomes given the simulated values of the mediator . For each t (cid:1) 0 , 1 and each i (cid:1) 1 , . . . , n , sample one copy of Y i ( t , M i ( jk ) ( t (cid:12) ) ) from f ! M (cid:3) j (cid:4) (cid:3) Y i (cid:1) t , M i (cid:3) jk (cid:4) (cid:3) t (cid:12)(cid:4) , X i (cid:4) and denote it as Y i ( jk ) ( t , M ijk ( t (cid:12) ) ) for k (cid:1) 1 , . . . , K . That is , for each treatment status , we generate two potential outcomes , again using model predictions , one using the mediator status generated under the treatment condition and the other using the mediator value under the control condition . 3 . Compute the causal mediation effects . Compute the aver - age causal mediation effect as (cid:6) (cid:1) (cid:3) j (cid:4) (cid:3) t (cid:4) (cid:2) 1 nK (cid:3) i (cid:1) 1 n (cid:3) k (cid:1) 1 K (cid:9) Y i (cid:3) jk (cid:4) (cid:3) t , M i (cid:3) jk (cid:4) (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) jk (cid:4) (cid:3) t , M i (cid:3) jk (cid:4) (cid:3) 0 (cid:4)(cid:4)(cid:10) . That is , we simply take the difference across the two outcome predictions under treatment and the two outcome predictions under control and average across the predictions for each of the N units in the study . This provides us with (cid:6) (cid:1) ( j ) ( t ) , which is one Monte Carlo draw of the average mediation effect . Step 4 : Compute summary statistics . Finally , we compute the point estimate of (cid:6) (cid:1) ( t ) and its uncertainty estimates from the distribution of mediation effects : (cid:6) (cid:1) ( j ) ( t ) . For example , the sample median and the sample standard deviation of the distribution can be used as the point estimate of (cid:6) (cid:1) ( t ) and its standard error , whereas percentiles of this distribution can serve as conﬁdence intervals for (cid:6) (cid:1) ( t ) . In principle , one can modify Step 3 . 3 of the above algorithm to accommodate any quantities other than the average causal medi - ation effects . For example , the (cid:14) - quantile average causal media - tion effects deﬁned in Footnote 9 can be estimated by computing the sample quantile of Y i ( jk ) ( t , M i ( jk ) ( t (cid:12) ) ) across treatment and con - trol . Although the proposed algorithm is applicable for any para - metric model , algorithms speciﬁcally tailored for a particular model are typically more computationally efﬁcient because , de - pending on the models chosen by researchers , further simpliﬁca - tions of Algorithm 1 may be possible . 14 Nonparametric Inference Suppose that the quantity of interest is the average causal mediation effect , (cid:6) (cid:1) ( t ) . Step 1 . Take a random sample with replacement of size n from the original data J times . For each of the J bootstrapped samples , repeat the following steps : 1 . Fit models for the observed and mediator variables . Fit a possibly nonparametric model , f ( M i (cid:1) T i , X i ) , for the mediator and another possibly nonparametric model , f ( Y i (cid:1) T i , M i , X i ) , for the outcome . Denote the estimates as f ( j ) ( M i (cid:1) T i , X i ) and f ( j ) ( Y i (cid:1) T i , M i , X i ) . Again , these are simply the mediator and outcome models that are now allowed to be nonparametric or semiparametric models . 2 . Simulate the potential values of the mediator . For each t (cid:1) 0 , 1 and each i (cid:1) 1 , 2 , . . . , n , sample K copies of M i ( t ) from f ( j ) ( M i (cid:1) t , X i ) and denote them as M i ( jk ) ( t ) for k (cid:1) 1 , 2 , . . . , K . Once again , we generate a set of predictions for the mediator under each treatment status . 3 . Simulate the potential outcomes given the simulated values of the mediator . For each t (cid:1) 0 , 1 and each i (cid:1) 1 , 2 , . . . , n , sample one copy of Y i ( t , M i ( jk ) ( t (cid:12) ) ) from f ( j ) ( Y i (cid:1) t , M i ( jk ) ( t (cid:12) ) , X i ) and denote it as Y i ( jk ) ( t , M i ( jk ) ( t (cid:12) ) ) for k (cid:1) 1 , 2 , . . . , K . Potential outcome predictions are generated for each treatment status and two medi - ator predictions . 4 . Compute the causal mediation effects . Compute the aver - age causal mediation effect as (cid:6) (cid:1) (cid:3) j (cid:4) (cid:3) t (cid:4) (cid:2) 1 nK (cid:3) i (cid:1) 1 n (cid:3) k (cid:1) 1 K (cid:9) Y i (cid:3) jk (cid:4) (cid:3) t , M i (cid:3) jk (cid:4) (cid:3) 1 (cid:4)(cid:4) (cid:1) Y i (cid:3) jk (cid:4) (cid:3) t , M i (cid:3) jk (cid:4) (cid:3) 0 (cid:4)(cid:4)(cid:10) , which is the difference between the two outcome predictions under each treatment status . Step 2 : Compute summary statistics . Compute the point estimate of (cid:6) (cid:1) ( t ) and its uncertainty estimates using the J estimates from the bootstrap sampling distribution . The sample median and the sample standard deviation of (cid:6) (cid:1) ( j ) ( t ) can be used as the point estimate of (cid:6) (cid:1) ( t ) and its standard error . Percentiles may be used as conﬁdence intervals . As before , in some cases , the simpliﬁcation of Algorithm 2 is possible , though we do not describe the details here . 14 For example , there is no need to simulate the mediator and the outcome as well as model parameters in the LSEM framework , although point and uncertainty estimates will be approximately equal . Moreover , if the quantities of interest can be derived analytically from the selected parametric model for the outcome variable , f ! M (cid:3) Y i (cid:1) T i , M i , X i (cid:4) , then Step 3 . 2 can be skipped and Step 3 . 3 can be modiﬁed to compute the average causal mediation effect for each unit directly given a Monte Carlo draw M i ( jk ) ( t ) for t (cid:1) 0 , 1 as follows : (cid:6) (cid:1) ( j ) ( t ) (cid:1) 1 nK (cid:3) i (cid:1) 1 n (cid:3) k (cid:1) 1 K (cid:9) (cid:1) ! Y (cid:3) j (cid:4) (cid:3) Y i (cid:1) t , M i (cid:3) jk (cid:4) (cid:3) 1 (cid:4) , X i (cid:4) (cid:1) (cid:1) ! Y (cid:3) j (cid:4) (cid:3) Y i (cid:1) t , M i (cid:3) jk (cid:4) (cid:3) 0 (cid:4) , X i (cid:4)(cid:10) . One situation in which this simpliﬁcation is possible is when the outcome variable is binary and modeled with logistic regression . ( Appendices continue ) 21 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 Fn14 Appendix E Simulation Studies Here we conduct a series of Monte Carlo simulations to dem - onstrate the superiority of our method over the existing methods based on the LSEM . Although there exist a variety of situations one can examine , we focus on two speciﬁc scenarios : ( a ) when nonlinearity is present in the outcome model and ( b ) when the outcome is binary . Nonlinear Model We begin by conducting a simulation study with nonlinearity in the outcome model . In such a situation , one common strategy is to add quadratic and / or cubic terms as additional linear predictors within the LSEM framework . For more complex forms of nonlin - earity , however , this strategy can perform poorly especially in a large sample . Thus , we also examine the performance of the semiparametric model discussed in the section Nonparametric and Semiparametric Regressions . Speciﬁcally , we generate data from Equations 6 and 7 but make the relationship between the outcome and mediator variables nonlinear as shown in Figure E1 . Thus , a quadratic model is a reasonable but incorrect approximation . We do not include any additional covariates in the assumed models beyond the binary treatment and the mediator . We simulate the error terms as independent normal random variables so that se - quential ignorability holds . Within these basic settings , we conduct two Monte Carlo sim - ulations each with two different sample sizes ( 100 and 500 ) for a total of four sets of scenarios . Several population parameters were held constant across all four sets of results : The population values of (cid:14) 2 , (cid:15) 2 , (cid:14) 3 , and (cid:15) 3 were all set to 0 . 25 . In the ﬁrst set of simulations , the amount of the total effect that was mediated is approximately 25 % . In the second set of simulations , the amount of the total effect that was mediated is higher and about 75 % . In sum , we compare how well each method performs when the mediation effects are large or small with two sample sizes ( small and moderate ) . For each of the four data - generating processes , we compare three estimation methods . The ﬁrst method uses the GAM and Algorithm 2 as discussed in the main text . The second method we use is Algorithm 1 based on the LSEM , which includes the square term of the mediator as an additional linear predictor in the outcome model . Finally , we estimate average causal mediation effects using the standard product of coefﬁcients method . The results are reported in Table E1 and are based on 2 , 500 simula - tions . We compute both bias and the root - mean - squared error ( RMSE ) for each method . ( Appendices continue ) 0 . 0 0 . 2 0 . 4 0 . 6 0 . 8 1 . 0 0 2 4 6 8 10 The Value of the Mediator A v e r ag e P o t en t i a l O u t c o m e , E ( Y i ( t , , m ) ) Figure E1 . Nonlinear relationship used for a Monte Carlo study . The solid line represents the average potential outcome , (cid:1) (cid:3) Y i (cid:3) t , m (cid:4)(cid:4) , as a func - tion of the mediator while the treatment variable is held constant . Table E1 Simulation Results With the Nonlinear Outcome Model by Sample Size Method Large effect size Small effect size Bias RMSE Bias RMSE N (cid:1) 100 GAM (cid:2) 0 . 53 3 . 67 (cid:2) 0 . 11 0 . 72 Quadratic (cid:2) 4 . 29 4 . 63 (cid:2) 0 . 25 0 . 69 Linear (cid:2) 6 . 26 6 . 45 (cid:2) 0 . 32 0 . 37 N (cid:1) 500 GAM (cid:2) 0 . 47 2 . 08 (cid:2) 0 . 09 0 . 39 Quadratic (cid:2) 7 . 19 7 . 40 (cid:2) 0 . 35 0 . 49 Linear (cid:2) 6 . 66 6 . 71 (cid:2) 0 . 33 0 . 34 Note . In the generalized additive model ( GAM ) , the estimation of the average causal mediation effect is based on Algorithm 2 . The quadratic or linear structural equation model includes the square term of the mediator as an additional linear predictor in the outcome model . The estimation of the average causal mediation effect for this model is based on Algorithm 1 . The linear model represents the standard product of coefﬁcients method . The true average causal mediation effect is 4 . 4 for large effect size and 0 . 22 for small effect size . RMSE (cid:1) root - mean - squared error . 22 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 FE1 TE1 We ﬁrst review the results when the average causal mediation effect is large and the sample size is small . Here conventional methods perform very poorly , with the bias being nearly an order of magnitude higher compared with the semiparametric model . This same basic pattern holds for the larger sample size as well . The parametric models fare better in terms of RMSE when the sample size is small . This is not surprising , as nonparametric methods tend to have higher levels of variance in small samples . Regardless , the RMSE for the GAM is signiﬁcantly smaller . Once the sample size is moderate , the difference becomes more stark , as the RMSE for the parametric models is more than twice that of the GAM . When the mediation effect is small , the GAM results again clearly outperform conventional models in terms of bias . The bias for the mediation effect is typically 3 times smaller when the GAM is used . As expected , the RMSE is actually worse for small sample sizes but improves markedly for the large sample sizes . Together , this simulation exercise demonstrates why the generality of our proposed approach is valuable . Nonparametric and semiparametric regression models allow for robust and ﬂexible modeling of non - linearity , and our proposed method can accommodate these models in a straightforward manner . Binary Outcome In our second example , we study whether our estimation algo - rithm can accurately recover the average causal mediation effect in a case with a binary outcome and a continuous mediator . As in the previous simulation , we use two effect sizes . To make the data - generating process realistic , we set the parameters ( (cid:14) 2 , (cid:14) 3 , (cid:15) 3 , (cid:17) ) equal to the values generated from regression analysis of the JOBS II data with the dichotomous employment outcome variable ( pro - bit ) and continuous job search self - efﬁcacy mediator ( ordinary least squares ; i . e . , 3 . 9 , (cid:2) 0 . 9 , 0 . 15 , 0 . 19 ) . For the sake of simplicity , we do not use covariates , though our approach easily accommo - dates them . We set (cid:15) 2 (cid:1) 3 in our ﬁrst simulation and (cid:15) 2 (cid:1) 1 . 5 in our second simulation so as to produce a larger ( about 0 . 1 ) and smaller ( about 0 . 05 ) average causal mediation effect , where (cid:15) 2 is deﬁned in Equation 6 . We vary the sample size from a relatively small ( 50 ) to a relatively large sample ( 1 , 000 ) . We compare our method ( Algorithm 1 ) against the product of coefﬁcients method in terms of bias and RMSE for the estimated average causal mediation effect . As before , each Monte Carlo experiment is based upon 2 , 000 simulations with our mediation software . Table E2 presents the results from our simulations . The bias and RMSE of our method are small even with a sample size of only 50 and steadily decline as the sample size increases . Conversely , using the product of coefﬁcients method to estimate the average causal mediation effect produces substantial bias and a large RMSE for all cases we examine . This demonstrates that blindly applying the product of coefﬁcients method in practice can yield highly misleading inferences . ( Appendices continue ) Table E2 Performance of the Proposed Method With Binary Outcome Variable Relative to the Product of Coefﬁcients Method Sample size Large effect size Small effect size Proposed method Product of coefﬁcients Proposed method Product of coefﬁcients Bias RMSE Bias RMSE Bias RMSE Bias RMSE 50 0 . 014 0 . 172 0 . 213 0 . 682 0 . 002 0 . 097 0 . 092 0 . 349 100 0 . 008 0 . 127 0 . 198 0 . 451 0 . 000 0 . 068 0 . 092 0 . 228 500 0 . 001 0 . 065 0 . 184 0 . 257 (cid:2) 0 . 002 0 . 032 0 . 089 0 . 127 1 , 000 (cid:2) 0 . 001 0 . 046 0 . 180 0 . 218 (cid:2) 0 . 001 0 . 023 0 . 090 0 . 110 Note . The data - generating processes are based on the probit outcome ( binary measure of employment ) regression and the linear mediation ( continuous measure of job search self - efﬁcacy ) regression from the Job Search Intervention Study example . No covariates are used for this simulation experiment . The true average causal mediation effect is 0 . 106 for large effect size and 0 . 052 for small effect size . RMSE (cid:1) root - mean - squared error . 23 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 TE2 Appendix F The Average Causal Mediation Effects With Binary Outcome We derive the general expression for the average causal mediation effects using the following model with the pretreatment confounders . The result given in the main text is a special case of this general result . M i (cid:1) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:16) 2 (cid:2) X i (cid:3) (cid:20) 2 i , Y i (cid:1) 1 { Y i (cid:3) (cid:29) 0 } where Y i (cid:3) (cid:1) (cid:14) 3 (cid:11) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:20) 3 i , where ε 2 i and ε 3 i are different i . i . d . random variables with zero mean and Var ( ε 2 i ) (cid:1) (cid:22) 22 and Var ( ε 3 i ) (cid:1) (cid:22) 32 . Under Assumption 1 , we have (cid:28) (cid:1) (cid:3) Y i (cid:1) T i (cid:2) t , M i , X i (cid:2) x (cid:4) dF (cid:3) M i (cid:1) T i (cid:2) t (cid:12) , X i (cid:2) x (cid:4) (cid:2) (cid:28) Pr (cid:3)(cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) x (cid:3) (cid:20) 3 i (cid:7) 0 (cid:4) dF (cid:3) M i (cid:1) T i (cid:2) t (cid:12) , X i (cid:2) x (cid:4) (cid:2) (cid:28) Pr (cid:9)(cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) x (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:12) (cid:3) (cid:16) 2 (cid:2) x (cid:3) (cid:20) 2 i (cid:4) (cid:3) (cid:20) 3 i (cid:7) 0 (cid:10) (cid:6) dF (cid:3)(cid:20) 2 i (cid:4) (cid:2) (cid:28)(cid:28) 1 (cid:9)(cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) x (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:12) (cid:3) (cid:16) 2 (cid:2) x (cid:3) (cid:20) 2 i (cid:4) (cid:3) (cid:20) 3 i (cid:7) 0 (cid:10) (cid:6) dF (cid:3)(cid:20) 3 i (cid:4) dF (cid:3)(cid:20) 2 i (cid:4) (cid:2) 1 (cid:1) Pr (cid:9)(cid:17)(cid:20) 2 i (cid:3) (cid:20) 3 i (cid:4) (cid:1) (cid:14) 3 (cid:1) (cid:15) 3 t (cid:1) (cid:16) 3 (cid:2) x (cid:1) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:12) (cid:3) (cid:16) 2 (cid:2) x (cid:4)(cid:10) , where the second equality follows from the change of variables formula as well as the fact that T i ε 2 i , and the fourth equality follows from the independence between ε 2 i and ε 3 i . Suppose ε 3 i is an i . i . d . logistic random variable and ε 2 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) . Using the results derived above , we obtain (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:1) (cid:9) H (cid:3)(cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4)(cid:4) (cid:1) H (cid:3)(cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4)(cid:4)(cid:10) , (cid:8) (cid:1) (cid:2) (cid:1) (cid:9) H (cid:3)(cid:14) 3 (cid:3) (cid:15) 3 (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4)(cid:4) (cid:1) H (cid:3)(cid:14) 3 (cid:3) (cid:17)(cid:3)(cid:6) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4)(cid:4)(cid:10) . Next , suppose ε 3 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) and ε 2 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) . Then , we have (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:1) (cid:5) (cid:25) (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) (cid:1) (cid:25) (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 (cid:2) X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 (cid:2) X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10)(cid:7) , (cid:8) (cid:1) (cid:2) (cid:1) (cid:9)(cid:25)(cid:3)(cid:14) 1 (cid:3) (cid:15) 1 (cid:3) (cid:16) 1 (cid:2) X i (cid:4) (cid:1) (cid:25)(cid:3)(cid:14) 1 (cid:3) (cid:16) 1 (cid:2) X i (cid:4)(cid:10) . Appendix G The Proportion Mediated With Binary Outcome Without Covariates Suppose that the probit regression is used to model the binary outcome variable without pretreatment covariates , that is , the model deﬁned in Equations 13 and 14 , where ε i 3 (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) and ε i 3 (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) . We derive the condition under which the common measure used in the literature , (cid:26) ˜ in Equation 19 , approximates the true proportion mediated , (cid:26) . First , we use the following linear approximation to the average causal mediation effect : (cid:6) (cid:1) (cid:3) t (cid:4) (cid:11) (cid:6) (cid:6) t (cid:12)(cid:25) (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:15) 2 t (cid:12)(cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) (cid:12) t (cid:12)(cid:1) 0 (cid:2) " (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:17)(cid:14) 2 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) (cid:17)(cid:15) 2 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 , for t (cid:1) 0 , 1 . Similarly , we can approximate the average total effect , (cid:8) (cid:1) (cid:11) " (cid:9) (cid:14) 3 (cid:3) (cid:17)(cid:14) 2 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10) (cid:17)(cid:15) 2 (cid:3) (cid:15) 3 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 . With these results , the proportion mediated is approximated by (cid:26) (cid:11) 1 2 (cid:5) 1 (cid:3) exp (cid:9) (cid:2)(cid:15) 3 (cid:9)(cid:15) 3 (cid:3) 2 (cid:3)(cid:14) 3 (cid:3) (cid:17)(cid:14) 2 (cid:4)(cid:10) 2 (cid:3)(cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:4) (cid:10) (cid:7) (cid:17)(cid:15) 2 (cid:15) 3 (cid:3) (cid:17)(cid:15) 2 . Thus , one condition under which (cid:26) ˜ approximately equals (cid:26) is that the average direct effect is small . This result extends to the situation in which the logit regression is used , that is , the model deﬁned in Equations 13 and 14 , where ε i 3 (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) and (cid:20) i 3 is an i . i . d . standard logistic random variable . ( Appendices continue ) 24 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 The calculation similar to the above yields the following approx - imation to the true proportion mediated : (cid:26) (cid:11) 1 2 (cid:5) 1 (cid:3) (cid:4) (cid:2)(cid:24) (cid:24) exp (cid:9) (cid:2)(cid:15) 3 (cid:9)(cid:15) 3 (cid:3) 2 (cid:3)(cid:14) 3 (cid:3) (cid:17)(cid:14) 2 (cid:1) ε 3 i (cid:4)(cid:10) 2 (cid:17) 2 (cid:22) 22 (cid:10) (cid:6) exp (cid:3) ε 3 i (cid:4) (cid:9) 1 (cid:3) exp (cid:3) ε 3 i (cid:4)(cid:10) d ε 3 i (cid:7) (cid:17)(cid:15) 2 (cid:15) 3 (cid:3) (cid:17)(cid:15) 2 . Thus , when the average direct effect is small , the standard measure approximates the true proportion mediated well . With Covariates The above result can be generalized to the model with the observed pretreatment covariates . Because the analytical calculation is similar , we present the probit case , that is , M i (cid:2) (cid:14) 2 (cid:3) (cid:15) 2 T i (cid:3) (cid:16) 2 (cid:2) X i (cid:3) ε 2 i , with ε 2 i (cid:8) i . i . d . (cid:3) (cid:3) 0 , (cid:22) 22 (cid:4) and Pr (cid:3) Y i (cid:1) T i , M i , X i (cid:4) (cid:2) (cid:25)(cid:3)(cid:14) 3 (cid:3) (cid:15) 3 T i (cid:3) (cid:17) M i (cid:3) (cid:16) 3 (cid:2) X i (cid:4) . Using the same linear approximation as before , we obtain (cid:6) (cid:1) (cid:3) t (cid:4) (cid:11) (cid:1) (cid:5) " (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 t (cid:3) (cid:16) 3 X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10)(cid:7) (cid:17)(cid:15) 2 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 , (cid:8) (cid:1) (cid:11) (cid:1) (cid:5) " (cid:9) (cid:14) 3 (cid:3) (cid:16) 3 X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10)(cid:7) (cid:17)(cid:15) 2 (cid:3) (cid:15) 3 (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 , for t (cid:1) 0 , 1 . Thus , the proportion mediated is approximately equal to the following expression : (cid:26) (cid:11) 1 2 (cid:13) 1 (cid:3) (cid:1) (cid:5) " (cid:9) (cid:14) 3 (cid:3) (cid:15) 3 (cid:3) (cid:16) 3 X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10)(cid:7) (cid:14) (cid:1) (cid:5) " (cid:9) (cid:14) 3 (cid:3) (cid:16) 3 X i (cid:3) (cid:17)(cid:3)(cid:14) 2 (cid:3) (cid:16) 2 X i (cid:4) (cid:6) (cid:22) 22 (cid:17) 2 (cid:3) 1 (cid:10)(cid:7)(cid:15) (cid:17)(cid:15) 2 (cid:15) 3 (cid:3) (cid:17)(cid:15) 2 . Thus , again , one condition under which # approximately equals (cid:26) ˜ is that the direct effect is small . An Example from the JOBS II Study The difference between the proportion mediated measure used in the literature , (cid:26) ˜ , and the true proportion mediated , (cid:26) , becomes larger as (cid:15) 3 increases in magnitude . To illustrate this difference , we again use the JOBS II data and use the dichot - omous outcome measure of whether someone was employed 6 months following the treatment . We ﬁrst estimate the mediation and outcome models with our full set of covariates using linear and probit regression , respectively . For our illustration , we use these estimates , except that we ﬁx the mediation effect to be 1 because the mediation effect in the JOBS data is quite small . Next , we calculate the proportion mediated at different values of (cid:15) 3 , beginning with the estimated value from the sample , . 171 , and plot the difference between (cid:26) ˜ and (cid:26) in Figure G1 . Consistent with the analytical result derived above , the estimate based on the product of coefﬁcients method diverges from the true proportion as (cid:15) 3 becomes larger . ( Appendices continue ) 0 . 5 1 . 0 1 . 5 2 . 0 2 . 5 0 . 05 0 . 15 0 . 25 Treatment coefficient in the outcome regression ββ 3 P r opo r t i on M ed i a t ed True proportion υυ Product of coefficients method υυ ~ Figure G1 . The bias of the product of coefﬁcients method for estimating proportion mediated . The bias is calculated based on the JOBS II data . The outcome variable is whether someone ﬁnds employment , and the mediator represents the level of job search self - efﬁcacy . The ﬁgure compares the true proportion mediated ( solid line ) , (cid:26) deﬁned in Equation 18 , with the estimate based on the product of coefﬁcients method ( dashed line ) , (cid:26) ˜ deﬁned in Equation 19 . The bias increases as the coefﬁcient for the treatment in the outcome regression , (cid:15) 3 , becomes greater . 25 CAUSAL MEDIATION ANALYSIS tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 G1 Appendix H The Details of the Sensitivity Analysis for Binary Outcome For the binary outcome model given in Equation 21 , identiﬁca - tion of the average causal mediation effects under nonzero values of (cid:21) requires several steps . For t (cid:1) 0 , 1 , we can write the average causal mediation effects with nonzero (cid:21) as (cid:6) (cid:1) (cid:3) t (cid:4) (cid:2) (cid:1) (cid:5) (cid:25) (cid:9) (cid:14) 1 (cid:3) (cid:15) 1 t (cid:3) (cid:16) 1 (cid:2) X i (cid:3) (cid:17)(cid:15) 2 (cid:3) 1 (cid:1) t (cid:4) (cid:6) (cid:17) 2 (cid:22) 22 (cid:3) 2 (cid:17)(cid:21)(cid:22) 2 (cid:3) 1 (cid:10) (cid:1) (cid:25) (cid:9) (cid:14) 1 (cid:3) (cid:15) 1 t (cid:3) (cid:16) 1 (cid:2) X i (cid:1) (cid:17)(cid:15) 2 t (cid:6) (cid:17) 2 (cid:22) 22 (cid:3) 2 (cid:17)(cid:21)(cid:22) 2 (cid:3) 1 (cid:10)(cid:7) . In the expression above , (cid:15) 2 and (cid:22) 22 can be consistently estimated via the regression of M i on ( 1 , T i , X i ) . The four parameters in this expression that we still need to identify are (cid:14) 2 , (cid:15) 1 , (cid:16) 1 , and (cid:17) . The ﬁrst step toward identiﬁcation requires estimating the probit re - gression : Y i (cid:1) 1 { Y i (cid:3) (cid:29) 0 } with Y i (cid:3) (cid:2) (cid:14) 1 (cid:3) (cid:15) 1 T i (cid:3) (cid:16) 1 (cid:2) X i (cid:3) ε i 1 , where we assume ε i 1 (cid:8) i . i . d . (cid:3) (cid:3) 0 , 1 (cid:4) . Second , we deﬁne (cid:21) ˜ (cid:1) Corr ( (cid:20) i 1 , (cid:20) i 2 ) , which identiﬁes (cid:17) as (cid:17) (cid:2) (cid:2)(cid:21) (cid:3) (cid:21) ˜ (cid:6) (cid:3) 1 (cid:1) (cid:21) 2 (cid:4) / (cid:3) 1 (cid:1) (cid:21) ˜ 2 (cid:4) (cid:22) 2 . Next we estimate Equation 21 , which gives a set of biased estimates when (cid:21) is nonzero . We denote (cid:17) ˜ as the biased coefﬁcient for M i in this probit model of the outcome , and we use it to obtain a consistent estimate of (cid:21) ˜ (cid:2) (cid:22) 2 (cid:17) ˜ / (cid:6) 1 (cid:3) (cid:22) 22 (cid:17) ˜ 2 . In fact , we can also obtain (cid:14) 1 and (cid:15) 1 from this probit equation : (cid:14) 1 (cid:1) (cid:14) ˜ 3 (cid:6) 1 (cid:2) (cid:21) ˜ 2 (cid:11) (cid:14) 2 (cid:21) ˜ / (cid:22) 2 , (cid:15) 1 (cid:2) (cid:15) ˜ 3 (cid:6) 1 (cid:1) (cid:21) ˜ 2 (cid:3) (cid:15) 2 (cid:21) ˜ / (cid:22) 2 , and (cid:16) 1 (cid:1) (cid:16) ˜ 3 (cid:6) 1 (cid:2) (cid:21) ˜ 2 (cid:11) (cid:16) 2 (cid:21) ˜ / (cid:22) 2 , where ( (cid:14) ˜ 3 , (cid:15) ˜ 3 , (cid:16) ˜ 3 ) are the intercept and the coefﬁcients for T i and X i , respectively . We now have consistent estimates for all the quantities needed to estimate the average causal mediation effects when (cid:21) is nonzero . Received August 5 , 2009 Revision received May 28 , 2010 Accepted June 14 , 2010 (cid:3) 26 IMAI , KEELE , AND TINGLEY tapraid5 / met - met / met - met / met00410 / met2124d10z xppws S (cid:1) 1 10 / 4 / 10 10 : 15 Art : 2009 - 0090 JOBNAME : AUTHOR QUERIES PAGE : 1 SESS : 1 OUTPUT : Mon Oct 4 10 : 15 : 22 2010 / tapraid5 / met (cid:1) met / met (cid:1) met / met00410 / met2124d10z AUTHOR QUERIES AUTHOR PLEASE ANSWER ALL QUERIES 1
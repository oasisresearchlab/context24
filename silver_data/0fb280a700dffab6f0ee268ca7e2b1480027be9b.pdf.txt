Design and Validation of a Tool for Neurite Tracing and Analysis in Fluorescence Microscopy Images E . Meijering , M . Jacob , J . - C . F . Sarria , P . Steiner , H . Hirling , M . Unser Cytometry , 2004 , in press Background : For the investigation of the molecular mechanisms involved in neurite outgrowth and differentiation , accurate and reproducible segmentation and quantiﬁcation of neuronal processes is a prerequisite . To facilitate this task , we developed a semiautomatic neurite tracing technique . This paper describes the design and validation of the technique . Methods : The technique was compared to fully manual delineation . Four observers repeatedly traced selected neurites in 20 ﬂuorescence microscopy images of cells in culture , using both methods . Ac - curacy and reproducibility were determined by comparing the tracings to high - resolution reference tracings , using two error measures . Labor intensiveness was measured in numbers of mouse clicks re - quired . The signiﬁcance of the results was determined by a Student t - test and by analysis of variance . Results : Both methods slightly underestimated the true neurite length , but the differences were not unanimously signiﬁcant . The average deviation from the true neurite centerline was a factor 2 . 6 smaller with the developed technique compared to fully manual tracing . Intraobserver variability in the respec - tive measures was reduced by a factor 6 . 0 and 23 . 2 . Interobserver variability was reduced by a factor 2 . 4 and 8 . 8 , respectively , and labor intensiveness by a factor 3 . 3 . Conclusions : Providing similar accuracy in measuring neurite length , signiﬁcantly improved accuracy in neurite centerline extraction , and signiﬁcantly improved reproducibility and reduced labor intensive - ness , the developed technique may replace fully manual tracing methods . Keywords : Cell culture , neurite outgrowth , ﬂuorescence microscopy , neurite tracing , interactive seg - mentation , pattern recognition , computer - assisted image analysis , software validation . INTRODUCTION The development of the nervous system is an intricate process involving many different factors ( 1 ) . The molecular mechanisms regulating neurite outgrowth , differentiation , synapse formation and plasticity are still being vigorously studied . In order to cope with the ever increasing amount of image data gen - erated for such studies , accurate and user - friendly image analysis tools are indispensable . Of particular importance is the ability , prior to morphometric analysis , to make accurate representations of the neu - ronal processes present in the images . Early attempts to automate this task were not very successful , and since then neurite tracing has been done primarily by the labor - intensive process of manual delin - eation ( 2 ) . In the past decade , despite the considerable progress in computer technology , only a handful of renewed efforts towards automated neurite tracing have been published . Notable techniques devel - oped recently are those based on vectorial tracking ( 3 ) —reminiscent of earlier techniques for tracing chromosomes ( 4 ) , or retinal vasculature ( 5 ) —and multiscale feature analysis ( 6 ) . Both techniques were developed for application to 3D confocal microscopy image stacks . In this paper we are concerned with the problem of accurately detecting and tracing individual neu - rites in 2D ﬂuorescence microscopy images of cells in culture . Whereas the computational cost of digital image processing techniques for this task can be expected to be smaller in 2D than in 3D , from a morpho - logical perspective the problem is in fact more complicated . The reason for this , inherent to 2D imaging A TOOL FOR NEURITE TRACING AND ANALYSIS 2 of 3D structures , is that the images may contain ambiguities regarding the branching or crossing of neu - rites . In addition , the neurites may sometimes be out of focus , have very low contrast , or even contain large gaps . And when composed of several scans to increase the ﬁeld of view , the images may show dis - continuities in background intensity , as illustrated in Fig . 1 . It is clear that automated procedures based on intensity thresholding and skeletonization ( 7 – 10 ) would fail to yield correct results for such images . Several authors have abandoned tracing altogether and have resorted to heuristic approaches to estimate the morphometric features of interest ( 11 – 13 ) . An alternative , vectorial - tracking technique , published just before completion of our paper , was successfully applied to images of retinal explants ( 14 ) , but does not address the just mentioned problems seen in our type of images . Because of the complexity of the problem it is not surprising that in practice nothing much has changed since the early days , as our recent literature survey revealed . A search in the PubMed database ( National Library of Medicine , Bethesda , MD ) for papers published from 2001 till present containing , in the title , the keyword ‘outgrowth’ combined with any of ‘neuron’ , ‘neurite’ , ‘axon’ , ‘dendrite’ , or their adjectives , yielded 190 responses . Of these 190 papers we studied 102 that were electronically accessible through our library and in which it was stated explicitly that neurite length was measured . In 64 of these , no details whatsoever were given as to how the measurements were carried out or what image analysis tools were used , and it seems reasonable to suspect that neurites were traced fully manually . In 20 cases , use was made of commercial image analysis software tools—in total , 10 different tools were mentioned . In the remaining 18 cases , use was made of personally developed or public domain image analysis software , with NIH - Image ( National Institutes of Health , Bethesda , MD ) and its variants being by far most popular . To our knowledge , none of the reported software tools , whether commercial or not , provides an automated and scientiﬁcally validated neurite tracing facility . Based on this observation and our own experiences with the burden and poor reproducibility of fully manual approaches , we conclude that there is still a great need for image analysis tools facilitating neurite tracing and possibly leading to more accurate and more consistent measurements . It will be clear , from what has just been said , that the design of fully automated techniques for our purpose will remain a difﬁcult problem and it seems likely that some form of user interaction will always be required to resolve ambiguities . Accepting this fact and attempting to meet at least part of the needs , we have developed an interactive neurite tracing technique . It exploits the expertise of the user in resolving ambiguities but greatly simpliﬁes the task of tracing long stretches of manifest neurites . In this paper we describe the design of our technique and present the results of validation experiments revealing the potential improvement in accuracy and reproducibility and the reduction in user interaction of the technique compared to fully manual delineation . MATERIALS AND METHODS Tracing Technique Neurite tracing using our technique consists of ( i ) a detection phase , in which every individual pixel in the image is assigned a value indicating its likelihood of belonging to a neurite , and ( ii ) the actual tracing phase , in which consecutive pixels that are most likely to represent the centerlines of the neurites are linked together to constitute the tracings . The former is a preprocessing step and is carried out fully automatically , the latter requires user interaction . Here we outline the respective algorithms developed for performing the two tasks . Details are given in the Appendix . Our approach to detection is based on the observation that in ﬂuorescence microscopy images , neu - rites are bright , elongated structures superimposed on a dark , noisy background . When representing images as gray - level landscapes , such structures manifest themselves as ridges . It is known ( 15 – 18 ) that ridge - like image structures are well detected by means of second - order differential operators . Speciﬁ - cally , the local principal ridge directions at any point in an image are given by the eigenvectors of the second - derivative matrix computed from the intensity values around that point . Due to the symmetry of this matrix , the eigenvectors are orthogonal , with the eigenvector corresponding to the smaller absolute A TOOL FOR NEURITE TRACING AND ANALYSIS 3 eigenvalue pointing in the longitudinal direction of the ridge . Comparing the eigenvalue magnitudes , the algorithm computes for each pixel in the image a measure of “neuriteness” . In addition , it stores for each pixel the local ridge orientation as indicated by the mentioned eigenvector . The output of this detector when applied to the image in Fig . 1 is shown in Fig . 2 . Our approach to linking of consecutive ridge pixels derives from the so - called live - wire segmentation paradigm ( 19 – 22 ) . It consists in the selection of a starting point by the user followed by the application of a search algorithm to ﬁnd the optimal paths from that point to all other points in the image , where ‘optimal’ means having a globally minimal cumulative cost according to a predeﬁned function . Once computed and stored , the paths can be displayed in real time as the user moves the cursor towards the end of the neurite of interest , until the presented path starts to deviate too much from what is considered the optimal tracing by the user . The tracing can then be ﬁxed up to that point by a single mouse click , after which the algorithm proceeds by presenting optimal paths from that point . The process is iterated until the entire neurite has been traced and can be repeated to trace multiple neurites . In cases where the user is not completely satisﬁed with the paths presented , which may sometimes occur in regions with very low neurite contrast , it is possible to switch to manual delineation . Cell Images The images used for the validation of our neurite tracing technique were taken from a previously pub - lished study ( 23 ) into the involvement of the neuronal sec1 , or murine unc18a ( nSec1 / Munc18a ) protein in neurite formation . In brief , this study was carried out in culture by overexpression of nSec1 / Munc18a and of Munc18b in PC12 cells followed by nerve growth factor differentiation , and in primary hippocam - pal neurons prepared from postnatal day - zero rats . For details regarding the experimental procedures we refer to the mentioned paper . Fluorescence images of the cells after immunostaining for the transfected proteins ( in the case of GFP - tagged proteins , their intrinsic ﬂuorescence was used ) were acquired by using a 10 × objective on an Axioplan microscope ( Carl Zeiss , Germany ) in combination with a DC100 digital camera ( Leica Microsystems , Germany ) . For many cells , to increase the ﬁeld of view , multiple images were taken to capture all of the cell’s outgrowth . In these cases , composite images were created by matching the individual images visually , using Photoshop ( Adobe Systems Inc . , San Jose , CA ) . From the total of about 170 cell images , we selected , prior to our validation experiments , 20 representative sample images , one of which is shown in Fig . 1 . Per image we selected a single neurite or neurite seg - ment of interest . The neurites were chosen to include all potential sources of tracing errors , such as varying noise and contrast , background intensity discontinuities , and complexities in shape . Validation Setup The neurite tracing technique was implemented in the Java programming language ( Sun Microsystems Inc . , Santa Clara , CA ) in the form of a plugin for ImageJ ( National Institutes of Health , Bethesda , MD ) , the computer - platform independent public domain image analysis program inspired by NIH - Image . Af - ter initial , visual experimentation with the technique applied to a small number of cell images , not included in the sample set used for the validation , the different parameters of the detection and tracing algorithms were ﬁxed to the values given in Table 1 . As a representative instance of the fully manual tracing methods encountered in the literature we used the “segmented line selections” tool of ImageJ . Similar to our semiautomatic technique , this tracing tool requires indicating points on the neurite of interest . Contrary to our technique , however , the points are connected simply by straight lines . Four observers ( two expert cell biologists and two expert computer scientists ) participated in the validation experiments , which consisted of three sessions . The sessions were carried out separately and independently by the four observers . In the ﬁrst session the observers traced the neurites of interest by means of the usual fully manual method . The start and end positions of the neurites were indicated by crosshair pointers , the coordinates of which were loaded automatically along with the images . Upon completion , the tracings were stored automatically along with information on the amount of user inter - A TOOL FOR NEURITE TRACING AND ANALYSIS 4 action required . The session was carried out three times to allow for variability analyses . In the second session , also carried out in triple , the observers repeated the experiments , but now using the described semiautomatic neurite tracing technique . For both sessions , the observers were asked to minimize user interaction , as measured by the number of mouse clicks , while at the same time attaining a sufﬁcient degree of tracing accuracy , according to their own visual judgment . In order to obtain accurate reference tracings , required for the quantitative analyses described here - after , high - resolution versions of the original images were generated by scaling up with a factor of 10 using a high - quality interpolation method : cubic spline interpolation ( 24 , 25 ) . In the third session , the observers were asked to perform fully manual tracing once again to delineate the neurites of interest in these high - resolution images . The motto for this session was to be as accurate as possible , regardless of the amount of interaction required . After completion of this session the resulting tracings were mapped back to the original images to yield reference tracings with a precision of 1 / 10th of a pixel . It will be clear that this approach to neurite tracing is infeasible in practice due to the 100 - fold increase in the required storage capacity as well as a substantial increase in user interaction . For this study , however , the extra efforts allowed us to obtain very precise reference tracings , which we believe may reliably be taken as the “gold standard” in the quantitative analyses . Quantitative Analyses The accuracy of the tracings from the ﬁrst two sessions was determined by comparison with the corre - sponding reference tracings from the third session , using two different error measures . As a ﬁrst measure we used the difference in length between the tracing and the actual neurite , as given by the reference tracing , divided by the length of the latter . A value larger or smaller than zero for this ratio indicates , respectively , an over - or underestimation of the true length . While relevant for studies measuring neurite length only , this measure does not , however , give an indication of how well the tracings really follow the neurite , since any two tracings may have the same length and yet be completely different . As a second , complementary measure , therefore , we used the average deviation of the tracing from the neurite , as given by the reference tracing , over the full length . Speciﬁcally , this measure was computed by adding the areas spanned by the segments of the tracing and the reference tracing between any two subsequent intersections of the tracings , and dividing by the length of the reference tracing . For each of the 480 tracings ( 4 observers × 2 sessions × 3 rounds × 20 neurites ) , the values for the two error measures were computed by comparing the tracing to each of the observers’ reference tracing for the corresponding neurite . For each of the two measures , the resulting four error values were averaged to yield a consensus error . The variability in the consensus errors was computed both per observer and between observers . Denoting by ε ( o , s , r , n ) the consensus error ( either length difference ratio , ε L , or average deviation , ε D ) for any observer ( o ) , session ( s ) , round ( r ) , and neurite ( n ) , we computed the intraobserver variability from the three rounds as VAR ε intra ( o , s , n ) = 1 3 3 (cid:1) i = 1 3 (cid:1) j = i + 1 | ε ( o , s , r i , n ) − ε ( o , s , r j , n ) | . The interobserver variability was computed by comparing the consensus errors ( again , either length difference ratios or average deviations ) from the three rounds of all four observers as VAR ε inter ( s , n ) = 1 54 4 (cid:1) k = 1 4 (cid:1) l = k + 1 3 (cid:1) i = 1 3 (cid:1) j = 1 | ε ( o k , s , r i , n ) − ε ( o l , s , r j , n ) | . The labor intensiveness of semiautomatic versus fully manual tracing was analyzed by comparing the number of mouse clicks required per tracing . A TOOL FOR NEURITE TRACING AND ANALYSIS 5 Finally , the statistical signiﬁcance of the outcome of each comparison of the two techniques was determined by means of a two - sided paired Student t - test ( 26 ) . Speciﬁcally , for each of the measures separately , the test was applied to the corresponding 20 pairs of ﬁgures resulting from the 20 neurites ( n ) traced in each of the two sessions ( s ) . Except for the interobserver variability , which combines the effects of all observers , the test was carried out separately for each observer ( o ) . For the accuracy and labor intensiveness measures , the ﬁgures per neurite were ﬁrst averaged over the three rounds ( r ) . The null hypothesis for the test was that the two techniques would give similar results . The probability of this hypothesis being true was analyzed at levels p < 0 . 05 , p < 0 . 01 , and p < 0 . 001 . In order to assess the overall signiﬁcance of the different factors involved , we applied a full - factorial univariate analysis of variance ( ANOVA ) , with ‘sessions’ as ﬁxed factor ( corresponding to the two techniques being compared ) and ‘observers’ , ‘rounds’ , and ‘neurites’ as random factors . The analyses were carried out using the statistical software package SPSS ( SPSS Inc . , Chicago , IL ) . RESULTS The results of the validation experiments are presented graphically in Fig . 3 . The graphs show , for each measure of comparison and for each of the observers , the full range and the mean of the observed values , as well as the statistical signiﬁcance of the differences between the results of fully manual tracing and our semiautomatic tracing technique according to the paired t - test . From the results with the length differ - ence ratio measure , shown in the top - left graph , it follows that both techniques tend to underestimate the true neurite length—our semiautomatic technique even slightly more so than the fully manual method . Averaging over all observers , we found that the deviation from the true length was about − 1 . 0 % for the fully manual method and about − 1 . 5 % for our semiautomatic technique . The differences between the two techniques were , however , not unanimously signiﬁcant , which suggests that overall , our technique performs comparable to fully manual tracing when it comes to measuring lengths only . Indeed , the re - sults of ANOVA indicated that the factor ‘sessions’ was not signiﬁcant ( p > 0 . 05 ) for this measure . Nor were any of the other main factors signiﬁcant . We did , however , ﬁnd a signiﬁcant interaction between ‘sessions’ and ‘observers’ ( p < 0 . 01 ) and between ‘sessions’ and ‘neurites’ ( p < 0 . 001 ) , which suggests that the accuracy of length measurements with our technique is dependent on the user and also on the shape of the neurites being traced , as was to be expected . All other measures of comparison yielded values larger than or equal to zero , in accordance with their deﬁnitions , with smaller values indicating better performance . From the results with these mea - sures , presented in the remaining graphs of Fig . 3 , it follows that our semiautomatic technique outper - forms the fully manual method . In virtually all cases the differences between the two techniques were found to be very signiﬁcant ( p < 0 . 001 ) according to the paired t - test . This is in agreement with the results of the ANOVA , which indicated that with the average deviation and labor intensiveness mea - sures , the factor ‘sessions’ had a very signiﬁcant effect ( p < 0 . 001 ) on the outcome . Here too , we found signiﬁcant interactions between ‘sessions’ and ‘observers’ ( p < 0 . 05 ) and between ‘sessions’ and ‘neu - rites’ ( p < 0 . 001 ) . In addition , with the latter measure , we found a signiﬁcant effect for the main factors ‘observers’ ( p < 0 . 05 ) and ‘neurites’ ( p < 0 . 001 ) , as well as for the three - way interaction between ‘sessions’ , ‘observers’ , and ‘neurites’ ( p < 0 . 001 ) , which conﬁrms that with our technique , the amount of interaction required depends on the user and on the neurites being traced . The improvement ratio per measure and per observer can be deduced from the mean values indicated in the graphs . Alternatively , computing the ratios on a per - neurite basis and then taking averages over all observers , we found that the reduction in errors with our semiautomatic tracing technique compared to fully manual tracing was a factor 2 . 6 for the average deviation measure , a factor 6 . 0 and 23 . 2 for the intraobserver variability of , respectively , the length difference and average deviation measure , and a factor 2 . 4 and 8 . 8 for the interobserver variability of the respective measures . User interaction was reduced by a factor 3 . 3 . To compare : the interaction was a factor 15 . 5 less than what was required for creating the high - resolution reference tracings . A TOOL FOR NEURITE TRACING AND ANALYSIS 6 DISCUSSION From the validation results we conclude that the semiautomatic neurite tracing technique described in this paper yields a signiﬁcant improvement over fully manual tracing methods in terms of true neurite centerline representation , reproducibility , and user interaction . In terms of length measurement , how - ever , it follows that overall , the differences between the two are not signiﬁcant . Analyzing the tracings afterwards we found that the underestimation of length may be ascribed to the fact that both techniques tend to shortcut strongly wiggling or sharply bending neurites . With fully manual tracing , shortcutting is inevitable when trying to limit the amount of user interaction . With our semiautomatic technique , short - cutting occurs mainly when the contrast is relatively low , which causes shorter routes to have a lower cumulative cost . In both cases , the inﬂuence on the results is user controllable . The results suggest , therefore , that the observers were not biased towards either technique in performing the experiments : while showing signiﬁcantly larger variability , the results with fully manual tracing were on average quite accurate . Notice that , incidentally , this latter observation seems to justify the use of fully man - ual tracing methods in studies involving large numbers of neurite measurements—a result that , to our knowledge , has never been demonstrated before in the literature . Because our technique employs a so - called global optimization algorithm and second - order image feature analysis , it is very robust against noise , varying or discontinuous background intensities , and varying or even locally diminishing neurite contrast , as illustrated by the sample tracings in Fig . 4 . As a result , it can be applied to a wide range of images without changing its parameters . The number of parameters to be set by the user is very small . More importantly , the parameters do not in any way rep - resent hard thresholds—the algorithms are free of user - controllable binary decisions . A disadvantage of the technique is that it still requires user interaction , which limits its applicability to images containing manageable amounts of neurites only . Although , for reasons mentioned in the introduction , it seems impossible to eliminate all user interaction , it remains a challenge to further automate the technique and to investigate its potential for other applications . One possibility to reduce the number of mouse clicks , for example , would be to automatically compute landmarks to serve as input for the optimization algo - rithm . Since the algorithm appears to have no problems with tracing neurite segments whose orientation changes only gradually from point to point , a logical approach would be to choose high - curvature and branch points for this purpose . This will be a topic for future research . To facilitate the use of our technique , we have worked the algorithms into a full - ﬂedged software tool . Due to our choice for the speciﬁc programming language and image processing environment described earlier , the tool is in principle computer - platform independent . By optimizing the implemen - tation of the algorithms we have been able to achieve acceptable processing speeds , even when using a normal personal computer : for an image or region of size 800 × 800 pixels , the preprocessing time re - quired for detecting the neurites and computing their orientations , and the time required for recomputing optimal paths after each mouse click , are both in the order of 1 second with a 2 . 4GHz Intel Pentium IV processor . By analogy with its hosting application , we have named our tool ‘NeuronJ’ . Apart from implementing the necessary ways and means to interact with the mentioned algorithms , the tool also provides the possibility to label and color tracings , to store them to and load them from disk , and to compute and display the dimensions of individual tracings as well as the statistics of measurements on selected or all tracings . In our institutes , NeuronJ has been received very positively and has replaced the labor intensive fully manual tracing tools . The software is freely available for non - commercial purposes from http : / / www . imagescience . org / meijering / software / neuronj / . ACKNOWLEDGMENTS The research described in this paper was initiated while the primary author was with the Biomedical Imaging Group of the Swiss Federal Institute of Technology in Lausanne ( EPFL ) , Switzerland , and was A TOOL FOR NEURITE TRACING AND ANALYSIS 7 completed while he was with the Biomedical Imaging Group Rotterdam of the Erasmus MC—University Medical Center Rotterdam , in the Netherlands . The validation study was carried out in collaboration with the Laboratory of Cellular Neurobiology of the EPFL . LITERATURE CITED 1 . Levitan IB , Kaczmarek LK . The Neuron : Cell and Molecular Biology . 3rd edition . Oxford : Oxford University Press ; 2002 . 2 . Capowski JJ . Computer Techniques in Neuroanatomy . New York , NY : Plenum Press ; 1989 . 3 . Al - Kofahi KA , Lasek S , Szarowski DH , Pace CJ , Nagy G , Turner JN , Roysam B . Rapid automated three - dimensional tracing of neurons from confocal image stacks . IEEE Trans Inf Technol Biomed 2002 ; 6 : 171 – 187 . 4 . Houtsmuller AB , Smeulders AWM , Voort HTM van der , Oud JL , Nanninga N . The homing cursor : a tool for three - dimensional chromosome analysis . Cytometry 1993 ; 14 : 501 – 509 . 5 . Can A , Shen H , Turner JN , Tanenbaum HL , Roysam B . Rapid automated tracing and feature extraction from retinal fundus images using direct exploratory algorithms . IEEE Trans Inf Technol Biomed 1999 ; 3 : 125 – 138 . 6 . Dima A , Scholz M , Obermayer K . Automatic segmentation and skeletonization of neurons from confocal microscopy images based on the 3 - D wavelet transform . IEEE Trans Image Process 2002 ; 11 : 790 – 801 . 7 . Jap Tjoen San ERA , Schmidt - Michels MH , Spruijt BM , Oestreicher AB , Schotman P , Gispen WH . Quanti - tation of the growth - associated protein B - 50 / GAP - 43 and neurite outgrowth in PC12 cells . J Neurosci Res 1991 ; 29 : 149 – 154 . 8 . Malgrange B , Delr´ee P , Rigo JM , Baron H , Moonen G . Image analysis of neuritic regeneration by adult rat dorsal root ganglion neurons in culture : quantiﬁcation of the neurotoxicity of anticancer agents and of its prevention by nerve growth factor or basic ﬁbroblast growth factor but not brain - derived neurotrophic factor or neurotrophin - 3 . J Neurosci Methods 1994 ; 53 : 111 – 122 . 9 . Kim J , Gillies D . Automatic morphometric analysis of neural cells . Mach Graph Vis 1998 ; 7 : 693 – 709 . 10 . Bilsland J , Rigby M , Young L , Harper S . A rapid method for semi - quantitative analysis of neurite outgrowth from chick DRG explants using image analysis . J Neurosci Methods 1999 ; 92 : 75 – 85 . 11 . Ventimiglia R , Jones BE , Møller A . A quantitative method for morphometric analysis in neuronal cell culture : unbiased estimation of neuron area and number of branch points . J Neurosci Methods 1995 ; 57 : 63 – 66 . 12 . Isaacs KR , Hanbauer I , Jacobowitz DM . A method for the rapid analysis of neuronal proportions and neurite morphology in primary cultures . Exp Neurol 1998 ; 149 : 464 – 467 . 13 . Rønn LCB , Ralets I , Hartz BP , Bech M , Berezin A , Berezin V , Møller A , Bock E . A simple procedure for quantiﬁcation of neurite outgrowth based on stereological principles . J Neurosci Methods 2000 ; 100 : 25 – 32 . 14 . Weaver CM , Pinezich JD , Lindquist WB , Vazquez ME . An algorithm for neurite outgrowth reconstruction . J Neurosci Methods 2003 ; 124 : 197 – 205 . 15 . Sato Y , Nakajima S , Shiraga N , Atsumi H , Yoshida S , Koller T , Gerig G , Kikinis R . Three - dimensional multi - scale line ﬁlter for segmentation and visualization of curvilinear structures in medical images . Med Image Anal 1998 ; 2 : 143 – 168 . 16 . Frangi AF , Niessen WJ , Hoogeveen RM , Walsum T van , Viergever MA . Model - based quantitation of 3 - D magnetic resonance angiographic images . IEEE Trans Med Imaging 1999 ; 18 : 946 – 956 . 17 . Geusebroek JM , Smeulders AWM . A minimum cost approach for segmenting networks of lines . Int J Comput Vis 2001 ; 43 : 99 – 111 . 18 . Wink O , Frangi AF , Verdonck B , Viergever MA , Niessen WJ . 3D MRA coronary axis determination using a minimum cost path approach . Magn Reson Med 2002 ; 47 : 1169 – 1175 . 19 . Barrett WA , Mortensen EN . Interactive live - wire boundary extraction . Med Image Anal 1996 ; 1 : 331 – 341 . A TOOL FOR NEURITE TRACING AND ANALYSIS 8 20 . Mortensen EN , Barrett WA . Interactive segmentation with intelligent scissors . Graph Models Image Process 1998 ; 60 : 349 – 384 . 21 . Falc˜ao AX , Udupa JK , Samarasekera S , Sharma S . User - steered image segmentation paradigms : live wire and live lane . Graph Models Image Process 1998 ; 60 : 233 – 260 . 22 . Falc˜ao AX , Udupa JK , Miyazawa FK . An ultra - fast user - steered image segmentation paradigm : live wire on the ﬂy . IEEE Trans Med Imaging 2000 ; 19 : 55 – 62 . 23 . Steiner P , Sarria JCF , Huni B , Marsault R , Catsicas S , Hirling H . Overexpression of neuronal sec1 enhances axonal branching in hippocampal neurons . Neuroscience 2002 ; 113 : 893 – 905 . 24 . Th´evenaz P , Blu T , Unser M . Interpolation revisited . IEEE Trans Med Imaging 2000 ; 19 : 739 – 758 . 25 . Meijering EHW , Niessen WJ , Viergever MA . Quantitative evaluation of convolution - based methods for med - ical image interpolation . Med Image Anal 2001 ; 5 : 111 – 126 . 26 . Altman DG . Practical Statistics for Medical Research . London : Chapman & Hall ; 1991 . 27 . Lindeberg T . Scale - Space Theory in Computer Vision . Dordrecht : Kluwer Academic Publishers ; 1994 . 28 . Strang G . Linear Algebra and Its Applications . 3rd edition . San Diego , CA : Harcourt Brace Jovanovich ; 1988 . 29 . Freeman WT , Adelson EH . The design and use of steerable ﬁlters . IEEE Trans Pattern Anal Mach Intell 1991 ; 13 : 891 – 906 . 30 . Cormen TH , Leiserson CE , Rivest RL , Stein C . Introduction to Algorithms . 2nd edition . Cambridge , MA : MIT Press ; 2001 . APPENDIX Details of the Neurite Detection and Tracing Algorithms In the implementation of our neurite detector , the required second - order image derivatives are computed by convolution with the second - order derivatives of the Gaussian kernel ( 27 ) . Mathematically this means that if f denotes the image and G the normalized Gaussian , we compute f ij ( x ) = ( f ∗ G ij ) ( x ) , with G ij ( x ) (cid:1) (cid:2) ∂ 2 ∂i∂j G (cid:3) ( x ) , where ‘ ∗ ’ denotes spatial convolution , x = ( x , y ) denotes the pixel position , and the derivative directions i and j can be x or y . The eigenvectors and eigenvalues are computed in our algorithm , not from the standard second - derivative matrix , but from the slightly modiﬁed matrix given by H (cid:1) f ( x ) = (cid:4) f xx ( x ) + αf yy ( x ) ( 1 − α ) f xy ( x ) ( 1 − α ) f xy ( x ) f yy ( x ) + αf xx ( x ) (cid:5) , where α is a parameter whose optimal value will be given in the sequel . Denoting the normalized eigenvectors of this matrix by v (cid:1) i ( x ) and the eigenvalues by λ (cid:1) i ( x ) , we compute them as (cid:6) v (cid:1) 1 ( x ) = v 1 ( x ) v (cid:1) 2 ( x ) = v 2 ( x ) and (cid:6) λ (cid:1) 1 ( x ) = λ 1 ( x ) + αλ 2 ( x ) , λ (cid:1) 2 ( x ) = λ 2 ( x ) + αλ 1 ( x ) , where the v i ( x ) and λ i ( x ) are , respectively , the normalized eigenvectors and the eigenvalues of the standard second - derivative matrix , or Hessian ( 28 ) , at pixel position x . The suitability of the matrix H (cid:1) f for neurite detection can be appreciated by analyzing the ﬁlter implicitly used in the computations . It is a fact from linear algebra ( 28 ) that λ i = v T i · H f · v i , where the right - hand side is equal to f ∗ ( v i ·∇ ) 2 G , the second - order image derivative in the direction v i . From the relations just given and the orthogonality of the eigenvectors , it follows that , implicitly , the eigenvalues A TOOL FOR NEURITE TRACING AND ANALYSIS 9 are computed as λ (cid:1) i = f ∗ h (cid:1) i , where the h (cid:1) i are instances of the ﬁlter h (cid:1) = (cid:7) ( r · ∇ ) 2 + α ( r ⊥ · ∇ ) 2 (cid:8) G corresponding to r = v i , which are the directions of maximum and minimum response . The parameter α is chosen in our algorithm such that h (cid:1) , which happens to be a steerable ﬁlter ( 29 ) , is maximally ﬂat in its longitudinal direction . This translates into the criterion lim x → 0 ( r ⊥ · ∇ ) 2 h (cid:1) ( x ) = 0 . Working out the details , we ﬁnd that the left - hand side of this equation is equal to ( 1 + 3 α ) (cid:3) r (cid:3) 4 / σ 4 , with σ the standard deviation of the Gaussian kernel , from which it follows that the optimal value for the free parameter is α = − 1 / 3 . Visual impressions of the shape of the ﬁlter are given in Fig . 5 . Based on the just described eigenvalue analysis , the algorithm assigns to each pixel in the image a measure of “neuriteness” according to the formula ρ ( x ) = (cid:6) λ ( x ) / λ min if λ ( x ) < 0 , 0 if λ ( x ) ≥ 0 , where λ is the larger in magnitude of the two eigenvalues and λ min denotes the smallest λ over all pixels , which in practice will always be smaller than zero . In addition , the algorithm stores for each pixel the local ridge orientation as indicated by v , the normalized eigenvector corresponding to the smaller absolute eigenvalue . Notice that dark line - like structures , for which λ ≥ 0 , are ignored by the detector . Also notice that since we are using a second - order detector , responses to ﬁrst - order structures , such as background intensity discontinuities , are suppressed . Moreover , since the Gaussian kernel involved in the computations is a scalable function , with scale parameter σ , the detector can be tuned to neurites of speciﬁc width , while at the same time suppressing noise . In our implementation of the live - wire segmentation algorithm , the function used for computing the cost of moving from any pixel x to an eight - connected neighboring pixel y is computed as C ( x , y ) = γ C λ ( y ) + ( 1 − γ ) C v ( x , y ) , where γ ∈ [ 0 , 1 ] is a user - deﬁned parameter determining the relative weight of the two normalized cost components , C λ and C v . The former of these is computed from the eigenvalues at y as C λ ( y ) = 1 − ρ ( y ) . The second component is computed from the eigenvectors at x and y as C v ( x , y ) = 12 (cid:9)(cid:10) 1 − ϕ ( x , y ) + (cid:10) 1 − ϕ ( y , x ) (cid:11) , where ϕ ( x , y ) = | v ( x ) · d ( x , y ) | with d ( x , y ) = ( y − x ) / (cid:3) y − x (cid:3) the unit “link vector” from x to y . By taking the absolute values of the inner products , the algorithm ignores the actual directions of the eigenvectors and considers only their orientations . Optimal paths based on this cost function are computed by a version of Dijkstra’s shortest - path algorithm ( 30 ) based on a discretization of the cost values and the use of a circular priority queue ( 19 , 20 , 22 ) . The placing of starting points is facilitated by applying “local snapping” , which implies that the cursor is always moved to the locally lowest cost point in a small window , of size w × w pixels , around the actual cursor position . The smoothness of the paths computed by the algorithm is improved by application of a uniform postﬁlter , of size 2 p + 1 , to the subsequent coordinates of the path pixels , after which they are subsampled with a factor s . A TOOL FOR NEURITE TRACING AND ANALYSIS 10 FIGURES AND TABLES F IG . 1 . Representative example of the type of images aimed at in this paper . The image shows a hippocampal neuron in culture and was compiled from multiple ﬂuorescence microscopy scans to capture all of the neuron’s outgrowth . Typical features include ambiguities regarding the branching or crossing of neurites ( as in the regions indicated by the letter ‘A’ ) , discontinuities in background intensity ( as in the regions indicated by ‘B’ ) , and varying neurite contrast ( compare the segments indicated by ‘C’ ) . The former problem makes it virtually impossible to develop fully automated approaches to neurite tracing for such images . Problems such as noise and varying neurite contrast and background intensity are tackled by the technique described in this paper . A TOOL FOR NEURITE TRACING AND ANALYSIS 11 F IG . 2 . Output of the neurite detection algorithm applied to the image in Fig . 1 . The top image shows , for every pixel , the “probability” of belonging to a neurite , as computed by the algorithm , where bright and dark values correspond to a high and a low probability , respectively . The bottom image shows a zoom of a region in the middle - lower part of the top image , superimposed with the local neurite orientations ( white dashes ) computed by the algorithm . The algorithm is designed to suppress dark line - like structures and backgroundintensity discontinuities . Moreover , it is tunable to neurites of speciﬁc width while it also reduces noise . A TOOL FOR NEURITE TRACING AND ANALYSIS 12 - 6 - 5 - 4 - 3 - 2 - 1 0 1 2 3 4 O1 O2 O3 O4 * * * * ε L ( pe r c en t ) 0 0 . 5 1 1 . 5 2 2 . 5 3 3 . 5 4 O1 O2 O3 O4 * * * * * * * * * * * * ε D ( p i x e l s ) 0 0 . 5 1 1 . 5 2 2 . 5 3 3 . 5 4 O1 O2 O3 O4 * * * * * * * * * * VA R ε L i n t r a ( pe r c en t ) 0 0 . 2 0 . 4 0 . 6 0 . 8 1 1 . 2 1 . 4 1 . 6 O1 O2 O3 O4 * * * * * * * * * * * * VA R ε D i n t r a ( p i x e l s ) 0 0 . 5 1 1 . 5 2 2 . 5 O1234 * * * VA R ε L i n t e r ( pe r c en t ) 0 0 . 2 0 . 4 0 . 6 0 . 8 1 O1234 * * * VA R ε D i n t e r ( p i x e l s ) 0 10 20 30 40 50 60 O1 O2 O3 O4 * * * * * * * * * * * * I n t e r a c t i on ( c li cks ) F IG . 3 . Graphical presentation of the results of the validation experiments comparing fully manual tracing ( solid bars ) and our semiautomatic tracing technique ( dotted bars ) . The graphs show , from top left to bottom right , the length difference ratio ( ε L ) , the average deviation ( ε D ) , the intraobserver variability for ε L and ε D , the interobserver variability for ε L and ε D , and the amount of user interaction required ( see the main text for details on these measures ) . The bars show the full range of observed values for each of the observers , with the black circle around the middle of each bar indicating the mean value . The four observers ( denoted by O1 , O2 , O3 , and O4 , where the ﬁrst two were cell biologists and the latter two computer scientists ) are indicated at the bottom of the graphs . The asterisks on top of each graph indicate for each observer the probability for the null hypothesis of equivalence to be true based on the paired t - test applied to the data presented . The different levels of probability considered are p < 0 . 001 ( * * * ) , p < 0 . 01 ( * * ) , p < 0 . 05 ( * ) , and any probability larger than 0 . 05 ( no asterisk ) . A TOOL FOR NEURITE TRACING AND ANALYSIS 13 F IG . 4 . Representative sample neurite tracings ( red curves ) from the validation experiments , illustrating the per - formance of our technique in the case of high ( top left ) or low ( top right ) neurite contrast , background intensity discontinuities ( middle left ) , very low neurite contrast and the nearby presence of bright spots ( middle right ) , and wiggling ( bottom left ) or sharply bending ( bottom right ) neurites . In the latter two type of cases the tracing algo - rithm has the tendency to shortcut , resulting in an underestimation of the true neurite length . The problem may be reduced to some extent by decreasing the parameters pertaining to the path coordinates smoothing ﬁlter ( the last two rows of Table 1 ) . Alternatively , the problem can be avoided simply by additional user input . The magenta crosshairs in the top - left and middle - right images are examples of the pointers used in the experiments to indicate the start and end positions of the neurites of interest . A TOOL FOR NEURITE TRACING AND ANALYSIS 14 F IG . 5 . Visual impressions of the steerable convolution ﬁlter implicitly used in our neurite detection algorithm . On the left , the ﬁlter is displayed in vertical orientation and at arbitrary scale as an image , in which the intensity at the borders corresponds to zero , brighter intensities correspond to positive and darker intensities to negative values . The graph on the right depicts the same ﬁlter as an inverted landscape . The ﬁlter is more elongated than the ﬁlter normally found in the literature on detection of line - like image structures . Parameter Value Description σ 2 . 0 Gaussian smoothing scale γ 0 . 7 Cost components weight factor w 9 Snapping window size p 5 Path coordinates postﬁlter size s 5 Path coordinates subsampling factor T ABLE 1 . Parameters of the neurite detection and tracing algorithms and their values as used in the validation experiments . The parameters are listed in the order of their ﬁrst appearance in the Appendix .
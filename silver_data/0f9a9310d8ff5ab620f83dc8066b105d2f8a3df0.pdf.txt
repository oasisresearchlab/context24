Vol . 30 no . 16 2014 , pages 2389 – 2390 BIOINFORMATICS APPLICATIONS NOTE doi : 10 . 1093 / bioinformatics / btu202 Bioimage informatics Advance Access publication April 25 , 2014 ThunderSTORM : a comprehensive ImageJ plug - in for PALM and STORM data analysis and super - resolution imaging Martin Ovesny´ , Pavel Krˇı´zˇek , Josef Borkovec , Zdeneˇk Sˇvindrych and Guy M . Hagen * Institute of Cellular Biology and Pathology , First Faculty of Medicine , Charles University in Prague , Prague 12800 , Czech Republic Associate Editor : Jonathan Wren ABSTRACT Summary : ThunderSTORM is an open - source , interactive and modu - lar plug - in for ImageJ designed for automated processing , analysis and visualization of data acquired by single - molecule localization mi - croscopy methods such as photo - activated localization microscopy and stochastic optical reconstruction microscopy . ThunderSTORM offers an extensive collection of processing and post - processing methods so that users can easily adapt the process of analysis to their data . ThunderSTORM also offers a set of tools for creation of simulated data and quantitative performance evaluation of localization algorithms using Monte Carlo simulations . Availability and implementation : ThunderSTORM and the online documentation are both freely accessible at https : / / code . google . com / p / thunder - storm / Contact : guy . hagen @ lf1 . cuni . cz Supplementary information : Supplementary data are available at Bioinformatics online . Received on February 4 , 2014 ; revised on April 9 , 2014 ; accepted on April 13 , 2014 1 INTRODUCTION Single - molecule localization microscopy ( SMLM ) methods such as stochastic optical reconstruction microscopy ( STORM ; Rust et al . , 2006 ) and photo - activated localization microscopy ( PALM ; Betzig et al . , 2006 ) have recently emerged to overcome the diffraction barrier , offering (cid:2) 10 times higher lateral reso - lution and the possibility of 3D imaging by various approaches . In SMLM , a super - resolution image is reconstructed from a se - quence of diffraction - limited images of sparsely distributed single photoswitchable molecules . As the sequence is usually long ( thousands of images ) and the positions of the molecules have to be estimated systematically with sub - diffraction precision , it is crucial to use specialized software for processing the data . We present ThunderSTORM , an open - source , interactive , modular and platform - independent software , which provides a complete set of tools for automated processing , analysis and visualization of data acquired by SMLM methods . Our philoso - phy in developing ThunderSTORM has been to offer an exten - sive collection of processing and post - processing methods , which were developed based on extensive testing with both real and simulated data . We also provide a detailed description of the implemented methods and algorithms ( Supplementary Note ) , as well as a user’s guide . 2 FEATURES AND METHODS Most software tools currently available for SMLM data processing typically use only one particular algorithm for detection and localization of molecules . ThunderSTORM offers many different processing and post - processing methods so that users can adapt the analysis to their data . This approach can lead to higher quality results than existing solutions . Experienced users may use any combination of the available methods ; however , we have designed the software’s default settings to produce good results on many of the datasets we have experimented with . 2 . 1 Raw data processing Approximate molecular positions can be determined , in combination with a variety of feature - enhancing low - pass and band - pass filters ( Krˇı´zˇek et al . , 2011 ; Izeddin et al . , 2012 ) , by detection of local maxima , non - maximum suppression or calculation of the centroid of connected components of segmented objects . A feature exclusively unique to ThunderSTORM is the possibility of specifying the threshold for detec - tion of molecules using a mathematical expression with quantities based on raw or filtered images . This allows computing the threshold value systematically for unknown input images with , for example , low signal to noise ratio , or where the global intensity slowly fluctuates . ThunderSTORM also offers a preview function to help visualize the de - tected molecules with the chosen combination of data processing settings . Sub - diffraction localization of molecules is accomplished by comput - ing the centroid of local neighborhoods , by a radial symmetry approach ( Parthasarathy , 2012 ) , or by fitting a suitable PSF model using standard or weighted non - linear least - squares methods , or using maximum - likelihood estimation ( Mortensen et al . , 2010 ) . Users may also choose not to use any of the methods , thereby using the approximate localiza - tions from the previous step . The uncertainty of the localization of mol - ecules is calculated according to Thompson et al . ( 2002 ) , or according to Quan et al . ( 2010 ) if EMCCD cameras are used . Super - resolution 3D imaging is accomplished by an astigmatism approach ( Huang et al . , 2008 ) . An integral part of this feature is the software’s calibration tool , in which a Z - stack of astigmatic images of sub - diffraction fluorescent beads is used to establish parameters for deter - mining the axial position of each molecule . Efforts to accelerate the acquisition process in SMLM have involved increasing the density of photoactivated fluorophores . In this case , ThunderSTORM uses an algorithm based on fitting of multiple emitters ( Huang et al . , 2011 ) . * To whom correspondence should be addressed . (cid:2) The Author 2014 . Published by Oxford University Press . This is an Open Access article distributed under the terms of the Creative Commons Attribution Non - Commercial License ( http : / / creativecommons . org / licenses / by - nc / 3 . 0 / ) , which permits non - commercial re - use , distribution , and reproduction in any medium , provided the original work is properly cited . For commercial re - use , please contact journals . permissions @ oup . com D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o i n f o r m a t i cs / a r t i c l e - ab s t r a c t / 30 / 16 / 2389 / 2748167 b y gu e s t on 24 O c t obe r 2018 2 . 2 Post - processing and visualization Post - processing routines offered by ThunderSTORM can eliminate mol - ecules with poor localization or other user - defined criteria , merge mol - ecules reappearing in subsequent frames , remove duplicated molecules obtained in multiple emitter analysis ( Huang et al . , 2011 ) , correct mo - lecular positions for lateral drift of the sample using fiducial markers or using cross - correlation methods ( Mlodzianoski et al . , 2011 ) and correct the absolute axial position of the molecules when the data were acquired in multiple Z - stage positions ( Huang et al . , 2008 ) . Users can also select a region of interest to export only the localized molecules and their param - eters from the region . Post - processing includes a live preview . Visualization involves creation of a new high - resolution image based on the previously obtained sub - diffraction molecular coordinates . Several methods have been implemented for visualization such as Gaussian ren - dering and a 2D histogram with an option of jittering ( Krˇı´zˇek et al . , 2011 ) . ThunderSTORM also introduces a new visualization method based on an average shifted histogram approach ( Scott , 1985 ) . This method provides similar results as the Gaussian rendering , but is orders of magnitude faster . 2 . 3 Simulation engine and performance evaluation ThunderSTORM is capable of generating realistic sequences of SMLM - like images in which the ground - truth positions of the molecules are known . A grayscale mask can be used to vary the spatial density of molecules [ Fig . 1 ( a – c ) ] . When the localization data and the ground - truth positions of molecules are available , ThunderSTORM can quanti - tatively evaluate the performance of localization algorithms ( see Supplementary Note Sections 8 and 9 ) . This allows users to perform sophisticated Monte Carlo simulations ( Krˇı´zˇek et al . , 2011 ) ( see User’s Guide Sections 8 – 10 ) . 3 SUMMARY ThunderSTORM introduces several new features and concepts for 2D and 3D SMLM data analysis . The software combines several algorithms for SMLM analysis into one comprehensive environment . One of the main features is the ability to process the data using any combination of the implemented feature - enhancing , spot detection and fitting methods . An important feature in ThunderSTORM is the possibility of specifying the threshold for detection of molecules using mathematical expres - sions . This allows users to systematically maximize the efficiency of molecule detection in the raw data by searching for the opti - mum combination , which may vary from experiment to experi - ment . ThunderSTORM also offers a much higher degree of user interactivity during data post - processing compared with other SMLM software packages , and introduces a new and fast visu - alization method that creates high - quality results . A realistic data generator within ThunderSTORM allows users to run multidimensional Monte Carlo simulations to evaluate the per - formance of localization methods . We have found ThunderSTORM’s flexibility and performance to be of critical importance when analyzing data with low molecular brightness , which we encountered when imaging A431 cells expressing mCitrine - erbB33 ( Krˇı´zˇek et al . , 2011 ) [ Fig . 1 ( d – f ) ] . Funding : This work was supported by the Czech Science Foundation [ P304 / 09 / 1047 , P205 / 12 / P392 , P302 / 12 / G157 , 14 - 15272P ] ; Charles University [ Prvouk / 1LF / 1 , UNCE 204022 ] ; the European Regional Development Fund [ OPPK CZ . 2 . 16 / 3 . 1 . 00 / 24010 , BIOCEV CZ . 1 . 05 / 1 . 1 . 00 / 02 . 0109 ] ; and the European Social Fund [ OPVK CZ . 1 . 07 / 2 . 3 . 00 / 30 . 0030 ] . Conflict of Interest : none declared . REFERENCES Betzig , E . et al . ( 2006 ) Imaging intracellular fluorescent proteins at nanometer reso - lution . Science , 313 , 1642 – 1645 . Huang , B . et al . ( 2008 ) Three - dimensional super - resolution imaging by stochastic optical reconstruction microscopy . Science , 319 , 810 – 813 . Huang , F . et al . ( 2011 ) Simultaneous multiple - emitter fitting for single molecule super - resolution imaging . Biomed . Opt . Express , 2 , 1377 – 1393 . Izeddin , I . et al . ( 2012 ) Wavelet analysis for single molecule localization microscopy . Opt . Express , 20 , 2081 – 2095 . Krˇı´zˇek , P . et al . ( 2011 ) Minimizing detection errors in single molecule localization microscopy . Opt . Express , 19 , 3226 – 3235 . Mlodzianoski , M . J . et al . ( 2011 ) Sample drift correction in 3D fluorescence photo - activation localization microscopy . Opt . Express , 19 , 15009 – 15019 . Mortensen , K . I . et al . ( 2010 ) Optimized localization analysis for single - molecule tracking and super - resolution microscopy . Nat . Methods , 7 , 377 – 381 . Parthasarathy , R . ( 2012 ) Rapid , accurate particle tracking by calculation of radial symmetry centers . Nat . Methods , 9 , 724 – 726 . Quan , T . et al . ( 2010 ) Localization capability and limitation of electron - multiplying charge - coupled , scientific complementary metal - oxide semiconductor , and charge - coupled devices for superresolution imaging . J . Biomed . Opt . , 15 , 066005 . Rust , M . J . et al . ( 2006 ) Sub - diffraction - limit imaging by stochastic optical recon - struction microscopy ( STORM ) . Nat . Methods , 3 , 793 – 795 . Scott , D . W . ( 1985 ) Averaged shifted histograms : effective nonparametric density estimators in several dimensions . Ann . Stat . , 13 , 1024 – 1040 . Thompson , R . E . et al . ( 2002 ) Precise nanometer localization analysis for individual fluorescent probes . Biophys . J . , 82 , 2775 – 2783 . Fig . 1 . Simulations and SMLM reconstruction with ThunderSTORM . ( a ) Example of a mask used for generating simulated SMLM data . The gray - scale intensity values are interpreted as molecular densities within a user - specified range . ( b ) SMLM reconstruction of a simulated dataset . ( c ) Detail of b . ( d ) Widefield fluorescence image of an A431 epidermoid carcinoma cell expressing the membrane protein mCitrine - erbB3 . ( e ) SMLM reconstruction using the default settings . ( f ) Detail of e . SMLM imaging was performed as previously described ( Krˇı´zˇek et al . , 2011 ) 2390 M . Ovesny´ et al . D o w n l oaded f r o m h tt p s : / / a c ade m i c . oup . c o m / b i o i n f o r m a t i cs / a r t i c l e - ab s t r a c t / 30 / 16 / 2389 / 2748167 b y gu e s t on 24 O c t obe r 2018